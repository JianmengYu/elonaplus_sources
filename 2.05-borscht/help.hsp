*com_quick
	page = quickpage
	listmax = 0
	snd SOUNDLIST_CURSOR1
	cs = -1

*com_quick_loop
	listmax = 0
	if ( page == 3 ) {
		page = 2
	}
	if ( page == (-1) ) {
		page = 0
	}
	if ( page == 0 ) {
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("ヘルプ", "Help"), key_help
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("ログ", "Log"), key_msglog
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("シート", "Chara"), key_charainfo
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("日誌", "Journal"), key_journal
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
	}
	if ( page == 1 ) {
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("装備", "Wear"), key_wear
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("休息", "Rest"), key_rest
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("魔法", "Spell"), key_cast
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("技能", "Skill"), key_skill
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("広技能", "W Skill"), key_wipe
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("掘る", "Dig"), key_dig
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
	}
	if ( page == 2 ) {
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("祈る", "Pray"), key_pray
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("装填", "Ammo"), key_ammo
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("干渉", "Interact"), key_interact
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("体当り", "Bash"), key_bash
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("射撃", "Fire"), key_fire
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = lang("ｽﾀｯｸ", "Stack"), key_itemstack
		listmax++
		list(0, listmax) = listmax
		listn(0, listmax) = "", "aaa"
		listmax++
	}
	s = lang("情報", "Info"), lang("行動", "Action"), lang("特殊", "Etc"), "null"
	p = page - 1
	if ( p == (-1) ) {
		p = 3
	}
	listn(0, 0) = s(p)
	listn(0, 4) = s(page)
	p = page + 1
	if ( p == 3 ) {
		p = 3
	}
	listn(0, 8) = s(p)
	t = 0

*com_quick_loop_WHILE1
	if ( 1 == 0 ) {
		goto *com_quick_loop_WEND1
	}
	redraw 0
	font lang(cfg_font1, cfg_font2), 12 + sizefix - en * 2, 0
	tx = 50
	ty = windowh - 255
	x = 25, 50, 50, 100, 100, 100, 150, 150, 175
	y = 50, 15, 85, 0, 50, 100, 15, 85, 50
	s = "○コマンド"
	gmode 2
	repeat 9
		p = cnt
		if ( listn(0, p) == "null" ) {
			continue
		}
		pos x(cnt) + tx, y(cnt) + ty
		if ( cnt == 0 | cnt == 4 | cnt == 8 ) {
			gcopy BUFFER_INF, 360, 192, 48, 48
		}
		else {
			gcopy BUFFER_INF, 360, 144, 48, 48
		}
		gmode 5, , , (t + cnt) \ 10 * (t + cnt) \ 10 * 12 * ((t + cnt) \ 50 < 10)
		if ( cs == cnt ) {
			gmode 5, , , 140
		}
		pos x(cnt) + tx, y(cnt) + ty
		if ( cnt == 0 | cnt == 4 | cnt == 8 ) {
			gcopy BUFFER_INF, 360, 192, 48, 48
		}
		else {
			gcopy BUFFER_INF, 360, 144, 48, 48
		}
		gmode 2
		s = listn(0, p)
		pos x(cnt) + tx + 25 - strlen(s) * 3, y(cnt) + ty + 19
		color 0, 0, 0
		bmes s, 255, 255, 255
	loop
	t++
	redraw 1
	await cfg_wait1
	key_check 2
	if ( key == key_north ) {
		key = listn(1, 3)
		cs = 3
	}
	if ( key == key_south ) {
		key = listn(1, 5)
		cs = 5
	}
	if ( key == key_west ) {
		cs = 0
	}
	if ( key == key_east ) {
		cs = 8
	}
	if ( key == key_northwest ) {
		key = listn(1, 1)
		cs = 1
	}
	if ( key == key_northeast ) {
		key = listn(1, 6)
		cs = 6
	}
	if ( key == key_southwest ) {
		key = listn(1, 2)
		cs = 2
	}
	if ( key == key_southeast ) {
		key = listn(1, 7)
		cs = 7
	}
	if ( key == key_cancel ) {
		cs = -1
		snd SOUNDLIST_CURSOR1
		key = ""
		goto *com_quick_loop_WEND1
	}
	if ( key != "" ) {
		if ( cs == (-1) ) {
			snd SOUNDLIST_CURSOR1
			key = ""
			goto *com_quick_loop_WEND1
		}
		if ( key == key_enter ) {
			key = listn(1, cs)
			goto *com_quick_loop_WEND1
		}
	}
	if ( key == "" | cs == 1 | cs == 6 | cs == 2 | cs == 7 ) {
		if ( cs != (-1) ) {
			key = listn(1, cs)
			goto *com_quick_loop_WEND1
		}
	}
	goto *com_quick_loop_WHILE1

*com_quick_loop_WEND1
	if ( cs == 0 | key == key_northeast ) {
		cs = -1
		snd SOUNDLIST_CURSOR1
		page--
		screenupdate = -1
		gosub *screen_draw
		goto *com_quick_loop
	}
	if ( cs == 8 | key == key_northwest ) {
		cs = -1
		snd SOUNDLIST_CURSOR1
		page++
		screenupdate = -1
		gosub *screen_draw
		goto *com_quick_loop
	}
	quickpage = page
	cs = 0
	gosub *screen_draw
	quickkeywait = 1
	return

*elona_help
	gsel BUFFER_INF
	pos 960, 96
	picload exedir + "\\graphic\\deco_help.bmp", 1
	gsel BUFFER_SCREEN
	page = 0
	notesel buff
	noteload exedir + "data\\exhelp.txt"
	p = instr(buff, 0, "%" + ghelp + "," + lang("JP", "EN"))
	if ( p == (-1) ) {
		dialog "help index not found " + "%" + ghelp + "," + lang("JP", "EN")
		return
	}
	buff = strmid(buff, p, instr(buff, p, "%END"))
	notedel 0
	if ( noteinfo(0) == 0 ) {
		return
	}
	snd SOUNDLIST_CHIME
	repeat
		redraw 0
		gmode 2
		dx = 480
		dy = 175
		window2 (windoww - dx) / 2 + inf_screenx, winposy(dy), dx, dy, 4, 0
		wx = (windoww - dx) / 2 + inf_screenx
		wy = winposy(dy)
		window2 (windoww - 325) / 2 + inf_screenx, winposy(dy) + 6, 325, 32, 0, 1
		pos wx + 5, wy + 4
		gcopy BUFFER_INF, 960, 96, 48, 48
		pos wx + dx - 55, wy + 4
		gcopy BUFFER_INF, 960, 96, 48, 48
		pos wx + 10, wy + 42
		gcopy BUFFER_INF, 960, 144, 96, 120
		font lang(cfg_font1, cfg_font2), 16 - en * 2, 1
		pos wx + 142, wy + 13
		color 80, 60, 50
		bmes lang("- ノルンの冒険ガイド -", "- Norne's travel guide -"), 255, 245, 235
		tx = wx + 120
		ty = wy + 55
		font lang(cfg_font1, cfg_font2), 15 - en * 2, 0
		color 30, 30, 30
		gmesx = tx
		gmesy = ty
		gmesw = 330
		gmescol = 30, 30, 30
		gmestype = 1
		repeat 10
			noteget s, page
			page++
			if ( page > noteinfo(0) | s == "" ) {
				break
			}
			gmes s
		loop
		gmode 2
		redraw 1
		help_halt
		if ( page >= noteinfo(0) ) {
			break
		}
	loop
	return

*convertHelp
	if ( jp ) {
		return
	}
	repeat 24
		if ( instr(s(cnt), 0, "(") == (-1) ) {
			continue
		}
		s(cnt) = cnven(strmid(s(cnt), instr(s(cnt), 0, "(") + 1, instr(s(cnt), 0, ")") - instr(s(cnt), 0, "(") - 1))
	loop
	return

*com_help
	snd SOUNDLIST_POP2
	listmax = 0
	page = 0
	pagesize = 18
	cs = 0
	cc = CHARA_PLAYER
	cs_bk = -1
	page_bk = 0
	cs_bk2 = 0
	if ( mode != MODELIST_CHARA_CREATION ) {
		gsel BUFFER_BUF
		repeat 8
			pos cnt \ 4 * 180, cnt / 4 * 300
			picload exedir + "graphic\\g" + (cnt + 1) + ".bmp", 1
		loop
		gsel BUFFER_SCREEN
	}
	else {
		cs = 3
		cs_bk2 = cs
	}
	notesel buff
	noteload exedir + "data\\" + lang("manual_JP.txt", "manual_ENG.txt")
	list(0, 0) = 0
	listn(0, 0) = lang("キーの一覧", "Key List")
	listmax++
	repeat noteinfo(0)
		noteget q, cnt
		p = instr(q, 0, "{}")
		if ( p != (-1) ) {
			list(0, listmax) = cnt + 1
			listn(0, listmax) = strmid(q, instr(q, 0, "}") + 2, 999)
			listmax++
		}
	loop
	windowshadow = 1

*com_help_loop_pgchk
	redraw 0
	cs_bk = -1
	pagemax = (listmax - 1) / pagesize
	if ( page < 0 ) {
		page = pagemax
	}
	else {
		if ( page > pagemax ) {
			page = 0
		}
	}

*com_help_loop
	if ( 1 == 0 ) {
		goto *com_chatlog
	}
	redraw 0
	s = "Elona In-Game Help", strhint2 + strhint3b
	if ( mode == MODELIST_CHARA_CREATION ) {
		display_window (windoww - 780) / 2 + inf_screenx, winposy(496, 1), 780, 496
	}
	else {
		display_window (windoww - 780) / 2 + inf_screenx, winposy(496) - 24, 780, 496
	}
	display_topic lang("項目", "Topic"), wx + 34, wy + 36
	if ( mode == MODELIST_CHARA_CREATION ) {
		p = 2
	}
	else {
		p = 4
	}
	cmbg = page \ 5
	x = ww / 5 * 2
	y = wh - 80
	gmode 4, 180, 300, 50
	pos wx + ww / 4, wy + wh / 2
	grotate p, cmbg \ 4 * 180, cmbg / 4 \ 2 * 300, 0, x, y
	gmode 2
	keyrange = 0
	repeat pagesize
		p = pagesize * page + cnt
		if ( p >= listmax ) {
			break
		}
		key_list(cnt) = key_select(cnt)
		keyrange++
		display_key wx + 38, wy + 66 + cnt * 19 - 2, cnt
	loop
	if ( cs_bk2 == 0 & page_bk == 0 ) {
		x = wx + 188
		y = wy + 6
		display_topic lang("アイテムに関するキー", "Item Keys"), x + 18, y + 30
		display_topic lang("行動に関するキー", "Action Keys"), x + 18, y + 142
		display_topic lang("情報に関するキー", "Information Keys"), x + 18, y + 256
		display_topic lang("その他のキー", "Other Keys"), x + 18, y + 328
		color 0, 0, 0
		s = "アイテムを取る(get)", key_get, "アイテムを置く(drop)", key_drop, "アイテムを調べる(examine)", key_inventory, "アイテムスタック(itemstack)", key_itemstack, "食べる(eat)", key_eat
		s(10) = "飲む(quaff)", key_drink, "読む(read)", key_read, "振る(zap)", key_zap, "道具を使う(tool)", key_use, "調合(blend)", key_dip, "投げる(throw)", key_throw, "装填(ammo)", key_ammo, "装備する(wear,wield)", key_wear
		gosub *convertHelp
		repeat 13
			if ( cnt < 12 ) {
				font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
				pos x + 38 + cnt / 6 * 290, y + 58 + cnt \ 6 * 14
				mes s(cnt * 2)
				font lang(cfg_font1, cfg_font2), 15 - en * 2, 0
				pos x + 248 + cnt / 6 * 290, y + 57 + cnt \ 6 * 14
				mes s(cnt * 2 + 1)
			}
			else {
				font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
				pos x + 38 + 290, y + 58 + 6 * 14
				mes s(cnt * 2)
				font lang(cfg_font1, cfg_font2), 15 - en * 2, 0
				pos x + 248 + 290, y + 57 + 6 * 14
				mes s(cnt * 2 + 1)
			}
		loop
		s = "周囲を調べる(search)", key_search, "魔法を唱える(cast)", key_cast, "干渉する(interact)", key_interact, "階段を降りる,入る(go down)", key_godown, "階段を昇る(go up)", key_goup
		s(10) = "その場で待機(wait)", key_wait, "ターゲットを指定(target)", key_target, "射撃する(fire)", key_fire, "能力を使う(apply)", key_skill, "広域能力を使う(Wide apply)", key_wipe, "体当たりする(bash)", key_bash, "穴を掘る(dig)", key_dig, "鍵を開ける(open)", key_open, "", ""
		gosub *convertHelp
		repeat 13
			if ( cnt < 12 ) {
				font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
				pos x + 38 + cnt / 6 * 290, y + 170 + cnt \ 6 * 14
				mes s(cnt * 2)
				font lang(cfg_font1, cfg_font2), 15 - en * 2, 0
				pos x + 248 + cnt / 6 * 290, y + 169 + cnt \ 6 * 14
				mes s(cnt * 2 + 1)
			}
			else {
				font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
				pos x + 38 + 290, y + 170 + 6 * 14
				mes s(cnt * 2)
				font lang(cfg_font1, cfg_font2), 15 - en * 2, 0
				pos x + 248 + 290, y + 169 + 6 * 14
				mes s(cnt * 2 + 1)
			}
		loop
		s = "能力・スキル情報(chara)", key_charainfo, "冒険日誌を表示(journal)", key_journal, "ヘルプを表示(help)", key_help, "メッセージログを表示(log)", key_msglog
		s(8) = "マテリアル表示(material)", key_material, "特徴の表示(feat)", key_trait
		gosub *convertHelp
		repeat 6
			font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
			pos x + 38 + cnt / 3 * 290, y + 284 + cnt \ 3 * 14
			mes s(cnt * 2)
			font lang(cfg_font1, cfg_font2), 15 - en * 2, 0
			pos x + 248 + cnt / 3 * 290, y + 283 + cnt \ 3 * 14
			mes s(cnt * 2 + 1)
		loop
		s = "セーブして終了(save)", key_save, "神に祈る(pray)", key_pray, "神に捧げる(offer)", key_offer, "ドアを閉める(close)", key_close, "与える(give)", key_give, "", "", ""
		gosub *convertHelp
		repeat 6
			font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
			pos x + 38 + cnt / 3 * 290, y + 356 + cnt \ 3 * 14
			mes s(cnt * 2)
			font lang(cfg_font1, cfg_font2), 15 - en * 2, 0
			pos x + 248 + cnt / 3 * 290, y + 355 + cnt \ 3 * 14
			mes s(cnt * 2 + 1)
		loop
		font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
		pos x + 38, y + 408
		mes lang("F8 マップのエクスポート  F9 インタフェース非表示  F11 キャラ情報の出力\nF12 コンソールの表示", "F8 Export map  F9 Hide interface  F11 Export chara sheet\nF12 Console")
	}
	else {
		s(1) = listn(0, pagesize * page_bk + cs_bk2)
		display_topic s(1), wx + 206, wy + 36
		font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
		color 0, 0, 0
		p = list(0, pagesize * page_bk + cs_bk2)
		gmesx = wx + 216
		gmesy = wy + 60
		gmesw = 510
		gmescol = 30, 30, 30
		gmestype = 0
		repeat noteinfo(0) - p, p
			noteget s1, cnt
			i = instr(s1, 0, "{")
			if ( i != (-1) ) {
				break
			}
			gmes s1
		loop
	}
	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
	cs_listbk
	repeat pagesize
		p = pagesize * page + cnt
		if ( p >= listmax ) {
			break
		}
		i = list(0, p)
		s = listn(0, p)
		cs_list s, wx + 66, wy + 66 + cnt * 19 - 1, 19, 0
	loop
	if ( keyrange != 0 ) {
		cs_bk = cs
	}
	redraw 1
	await cfg_wait1
	key_check
	cursor_check
	p = -1
	repeat keyrange
		if ( key == key_select(cnt) ) {
			p = list(0, pagesize * page + cnt)
			cs = cnt
			break
		}
	loop
	if ( p != (-1) ) {
		snd SOUNDLIST_OK1
		page_bk = page
		cs_bk2 = cs
		goto *com_help_loop_pgchk
	}
	if ( key == key_pageup ) {
		if ( pagemax != 0 ) {
			snd SOUNDLIST_POP1
			page++
			goto *com_help_loop_pgchk
		}
	}
	if ( key == key_pagedown ) {
		if ( pagemax != 0 ) {
			snd SOUNDLIST_POP1
			page--
			goto *com_help_loop_pgchk
		}
	}
	if ( key == key_cancel ) {
		return
	}
	goto *com_help_loop

*com_chatlog
	curmenu = 2
	key_list(0) = key_enter
	keyrange = 0
	pagesize = 0
	redraw 0
	gsel BUFFER_PIC
	pos 0, 0
	picload exedir + "graphic\\ie_scroll.bmp"
	gsel BUFFER_SCREEN
	windowshadow = 1
	snd SOUNDLIST_SCROLL
	drawmenu 2
	ww = limit(windoww - 90, windoww - 90, 720)
	wh = 440
	wx = (windoww - ww) / 2 + inf_screenx
	wy = winposy(wh)
	windowanime wx, wy, ww, wh, 10, 4
	s = lang("何かキーを押すと閉じる", "Hit any key to close")
	showscroll wx, wy, ww, wh
	net_read
	buff = ""
	notesel buff
	header = instr(netbuf, 0, "<!--START-->") + 13
	repeat
		s = ""
		tail = instr(netbuf, header, "%")
		if ( tail == (-1) ) {
			break
		}
		header += tail + 1
		tail = instr(netbuf, header, "%")
		s += strmid(netbuf, header, tail) + "  "
		header += tail + 1
		tail = instr(netbuf, header, "%")
		s += strmid(netbuf, header + 4, tail - 4)
		header += tail + 1
		tail = instr(netbuf, header, "%")
		header += tail + 2
		s += "\n"
		buff += "" + s
	loop
	font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
	color 30, 20, 10
	i = 0
	repeat 20
		if ( i >= 20 ) {
			break
		}
		noteget s, cnt
		if ( en ) {
			cnv_str s, "&quot;", "\""
		}
		if ( s == "" ) {
			if ( cnt == 0 ) {
				s = "No new messages received."
			}
			break
		}
		talk_conv s, (ww - 110 - en * 50) / 7
		i += stat
		pos wx + 48, (19 - i) * 16 + wy + 48
		mes s
		i++
	loop
	redraw 1

*com_chatlog_WHILE1
	if ( 1 == 0 ) {
		goto *com_log
	}
	await cfg_wait1
	key_check
	cursor_check
	if ( menucycle == 1 ) {
		if ( key == key_next | key == key_prev ) {
			p = curmenu
			if ( key == key_next ) {
				curmenu++
				if ( curmenu > 2 ) {
					curmenu = 0
				}
			}
			if ( key == key_prev ) {
				curmenu--
				if ( curmenu < 0 ) {
					curmenu = 2
				}
			}
			key = ""
			if ( p != curmenu ) {
				screenupdate = -1
				gosub *screen_draw
				if ( curmenu == 0 ) {
					goto *com_log
				}
				if ( curmenu == 1 ) {
					goto *com_journal
				}
				if ( curmenu == 2 ) {
					goto *com_chatlog
				}
			}
		}
	}
	if ( key != "" ) {
		gosub *screen_draw
		goto *pc_turn
	}
	goto *com_chatlog_WHILE1

*com_log
	curmenu = 0
	windowshadow = 1
	key_list(0) = key_enter
	keyrange = 0
	pagesize = 0
	redraw 0
	wx = inf_msgx - 2
	wy = inf_msgy - (inf_maxlog - 3) * inf_msgspace - 1
	ww = windoww - inf_msgx + 6
	wh = (inf_maxlog - 3) * inf_msgspace, 1, -1
	snd SOUNDLIST_LOG
	showtitle lang("過去のメッセージ", "Log"), lang("何かキーを押すと閉じる", "Hit any key to close"), 236, 1
	drawmenu 2
	windowanimecorner wx, wy, ww, wh, 8, 4
	if ( cfg_exlog ) {
		p = (windoww - inf_msgx) / 192
		window2 wx, wy, ww, wh, 1, -1
		repeat inf_maxlog - 3
			cnt2 = cnt
			pos cnt
			repeat p + 1
				if ( cnt == p ) {
					x = (windoww - inf_msgx) \ 192
				}
				else {
					x = 192
				}
				pos cnt * 192 + inf_msgx, inf_msgy - (cnt2 + 1) * inf_msgspace
				gcopy BUFFER_INF, 496, 536 + cnt2 \ 4 * inf_msgspace, x, inf_msgspace
			loop
		loop
		repeat p + 1
			if ( cnt == p ) {
				sx = (windoww - inf_msgx) \ 192
			}
			else {
				sx = 192
			}
			pos cnt * 192 + inf_msgx, inf_msgy
			gcopy BUFFER_INF, 496, 528, sx, 6
		loop
		gsel BUFFER_BUF
		gmode 0
		color 0, 0, 0
		boxf
		repeat inf_maxlog - 3
			p = msgline - cnt - 3
			if ( p < 0 ) {
				p += inf_maxlog
			}
			else {
				if ( p >= inf_maxlog ) {
					p -= inf_maxlog
				}
			}
			if ( p < 0 ) {
				continue
			}
			pos inf_msgx, inf_msgy - cnt * inf_msgspace
			gcopy BUFFER_LOG, 0, p * inf_msgspace, windoww - inf_msgx, inf_msgspace
		loop
		gsel BUFFER_SCREEN
		gmode 2
		pos 0, -3
		gcopy BUFFER_BUF, 0, 0, windoww, inf_msgy
	}
	else {
		gsel BUFFER_BUF
		repeat 8
			pos cnt \ 4 * 180, cnt / 4 * 300
			picload exedir + "\\graphic\\g" + (cnt + 1) + ".bmp", 1
		loop
		gsel BUFFER_SCREEN
		s = lang("過去のメッセージ", "Log"), lang("何かキーを押すと閉じる", "Hit any key to close")
		x = windoww - 90
		display_window (windoww - x) / 2 + inf_screenx, winposy(432), x, 432
		display_topic lang("メッセージログの内容", "Message"), wx + 28, wy + 30
		cmbg++
		x = ww / 5 * 2
		y = wh - 80
		gmode 4, 180, 300, 50
		pos wx + ww / 4, wy + wh / 2
		grotate BUFFER_BUF, cmbg / 4 \ 4 * 180, cmbg / 4 / 4 \ 2 * 300, 0, x, y
		gmode 2
		font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
		color 0, 0, 0
		repeat 20
			p = msgline - cnt
			if ( p < 0 ) {
				p += inf_maxlog
			}
			else {
				if ( p >= inf_maxlog ) {
					p -= inf_maxlog
				}
			}
			if ( p < 0 ) {
				continue
			}
			pos wx + 28, (19 - cnt) * 16 + wy + 58
			mes msg(p)
		loop
	}
	redraw 1

*com_log_WHILE1
	if ( 1 == 0 ) {
		goto *cfg_write
	}
	await cfg_wait1
	key_check
	cursor_check
	if ( menucycle == 1 ) {
		if ( key == key_next | key == key_prev ) {
			p = curmenu
			if ( key == key_next ) {
				curmenu++
				if ( curmenu > 2 ) {
					curmenu = 0
				}
			}
			if ( key == key_prev ) {
				curmenu--
				if ( curmenu < 0 ) {
					curmenu = 2
				}
			}
			key = ""
			if ( p != curmenu ) {
				screenupdate = -1
				gosub *screen_draw
				if ( curmenu == 0 ) {
					goto *com_log
				}
				if ( curmenu == 1 ) {
					goto *com_journal
				}
				if ( curmenu == 2 ) {
					goto *com_chatlog
				}
			}
		}
	}
	if ( key != "" ) {
		gosub *screen_draw
		goto *pc_turn
	}
	goto *com_log_WHILE1

*cfg_write
	notesel note_buff
	noteload exedir + "\\config.txt"
	f = 0
	repeat noteinfo(0)
		noteget s, cnt
		if ( instr(s, 0, valn) == (-1) ) {
			continue
		}
		i = 1
		p = 0
		repeat
			p(2) = instr(s, p, "\"")
			if ( p(2) == (-1) ) {
				break
			}
			p += p(2)
			p(1) = instr(s, p + 1, "\"") + p + 1
			if ( p(1) == (-1) ) {
				break
			}
			s = strmid(s, 0, p + 1) + valn(i) + strmid(s, p(1), 999)
			p += strlen(valn(i)) + 2
			i++
		loop
		noteadd s, cnt, 1
		f = 1
		break
	loop
	if ( f == 0 ) {
		noteadd "" + valn + " \"" + valn(1) + "\""
	}
	notesave exedir + "\\config.txt"
	return

*config_init
	sdim key_buff, 4, 65
	dup key_identify, key_buff(2)
	dup key_pageup, key_buff(3)
	dup key_pagedown, key_buff(4)
	dup key_cancel, key_buff(5)
	dup key_help, key_buff(6)
	dup key_msglog, key_buff(7)
	dup key_enter, key_buff(8)
	dup key_save, key_buff(9)
	dup key_north, key_buff(10)
	dup key_northeast, key_buff(11)
	dup key_east, key_buff(12)
	dup key_southeast, key_buff(13)
	dup key_south, key_buff(14)
	dup key_southwest, key_buff(15)
	dup key_west, key_buff(16)
	dup key_northwest, key_buff(17)
	dup key_skill, key_buff(18)
	dup key_close, key_buff(19)
	dup key_cast, key_buff(20)
	dup key_drink, key_buff(22)
	dup key_read, key_buff(23)
	dup key_zap, key_buff(24)
	dup key_fire, key_buff(25)
	dup key_search, key_buff(26)
	dup key_target, key_buff(27)
	dup key_dig, key_buff(28)
	dup key_wait, key_buff(30)
	dup key_inventory, key_buff(31)
	dup key_drop, key_buff(32)
	dup key_get, key_buff(33)
	dup key_wipe, key_buff(34)
	dup key_charainfo, key_buff(35)
	dup key_eat, key_buff(36)
	dup key_wear, key_buff(37)
	dup key_godown, key_buff(38)
	dup key_goup, key_buff(39)
	dup key_interact, key_buff(40)
	dup key_rest, key_buff(41)
	dup key_use, key_buff(42)
	dup key_bash, key_buff(43)
	dup key_open, key_buff(44)
	dup key_dip, key_buff(45)
	dup key_pray, key_buff(46)
	dup key_offer, key_buff(47)
	dup key_journal, key_buff(48)
	dup key_material, key_buff(49)
	dup key_quick, key_buff(50)
	dup key_get2, key_buff(51)
	dup key_trait, key_buff(52)
	dup key_look, key_buff(53)
	dup key_give, key_buff(54)
	dup key_prev, key_buff(55)
	dup key_next, key_buff(56)
	dup key_quickinv, key_buff(57)
	dup key_throw, key_buff(58)
	dup key_esc, key_buff(59)
	dup key_alt, key_buff(60)
	dup key_mode, key_buff(61)
	dup key_ammo, key_buff(62)
	dup key_mode2, key_buff(63)
	dup key_itemstack, key_buff(64)
	sdim jkey, 2, 12
	return

*config_loadCore
	key_select = "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s"
	notesel note_buff
	noteload exedir + "\\config.txt"
	repeat noteinfo(0)
		noteget s, cnt
		if ( instr(s, 0, "language.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_language = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "fullscreen.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_fullscreen = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "music.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_music = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "sound.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_sound = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "extraRace.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_extrarace = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "joypad.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_joypad = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "msg_box.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_msg_box = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "msgLine.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			inf_msgline = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "tileSize.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			inf_tiles = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "fontSize .") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			inf_mesfont = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "infVerType.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			inf_vertype = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "windowX.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			windowx = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "windowY.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			windowy = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "windowW.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			windoww = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "windowH.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			windowh = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "clockX.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			inf_clockx = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "clockW.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			inf_clockw = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "clockH.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			inf_clockh = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "defLoadFolder.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			defload = rtvaln
			continue
		}
		if ( instr(s, 0, "charamake_wiz.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_wizard = int(rtvaln)
			continue
		}
	loop
	return

*config_load
	procid = (procid + 1) \ 4
	proclist(procid) = "Load config" + " ct:" + ct
	notesel note_buff
	noteload exedir + "\\config.txt"
	repeat noteinfo(0)
		noteget s, cnt
		if ( instr(s, 0, "key_sCancel.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_scancel = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "alert_wait.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_alert = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "anime_wait.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_animewait = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "ignoreDislike.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_ignoredislike = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "wait1.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_wait1 = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "font1.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_font1 = rtvaln
			continue
		}
		if ( instr(s, 0, "font2.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_font2 = rtvaln
			continue
		}
		if ( instr(s, 0, "fontVfix1.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			vfix = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "fontSfix1.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			sizefix = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "story.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_story = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "heartbeat.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_heart = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "extraHelp.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_extrahelp = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "alwaysCenter.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_alwayscenter = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "scroll.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_scroll = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "startRun.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_startrun = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "walkWait.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_walkwait = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "runWait.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_runwait = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "autoTurnType.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_autoturn = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "autoNumlock.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_autonumlock = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "attackWait.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_attackwait = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "attackAnime.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_attackanime = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "envEffect.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_env = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "titleEffect.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_titleeffect = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "net.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_net = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "netWish.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_netwish = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "netChat.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_netchat = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "serverList.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_serverlist = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "shadow.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_shadow = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "objectShadow.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_objectshadow = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "windowAnime.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_windowanime = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "exAnime.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_exanime = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "showSkillMod.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_showskillmod = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "hide_autoIdentify.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_hideautoidentify = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "hide_shopResult.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_hideshopresult = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "msg_trans.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_msgtrans = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "msg_addTime.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_msgaddtime = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "title_dialog.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_titledialog = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "key_cancel.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_cancel = rtvaln
			jkey(int(rtvaln(1))) = key_cancel
			continue
		}
		if ( instr(s, 0, "key_esc.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_esc = rtvaln
			jkey(int(rtvaln(1))) = key_esc
			continue
		}
		if ( instr(s, 0, "key_alter.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_alter = rtvaln
			jkey(int(rtvaln(1))) = key_alter
			continue
		}
		if ( instr(s, 0, "key_north.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_north = rtvaln
			continue
		}
		if ( instr(s, 0, "key_south.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_south = rtvaln
			continue
		}
		if ( instr(s, 0, "key_west.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_west = rtvaln
			continue
		}
		if ( instr(s, 0, "key_east.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_east = rtvaln
			continue
		}
		if ( instr(s, 0, "key_northwest.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_northwest = rtvaln
			continue
		}
		if ( instr(s, 0, "key_northeast.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_northeast = rtvaln
			continue
		}
		if ( instr(s, 0, "key_southwest.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_southwest = rtvaln
			continue
		}
		if ( instr(s, 0, "key_southeast.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_southeast = rtvaln
			continue
		}
		if ( instr(s, 0, "key_wait.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_wait = rtvaln
			continue
		}
		if ( instr(s, 0, "key_inventory.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_inventory = rtvaln
			continue
		}
		if ( instr(s, 0, "key_help.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_help = rtvaln
			jkey(int(rtvaln(1))) = key_help
			continue
		}
		if ( instr(s, 0, "key_msglog.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_msglog = rtvaln
			continue
		}
		if ( instr(s, 0, "key_pageup.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_pageup = rtvaln
			continue
		}
		if ( instr(s, 0, "key_pagedown.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_pagedown = rtvaln
			continue
		}
		if ( instr(s, 0, "key_get.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_get = rtvaln
			jkey(int(rtvaln(1))) = key_get
			continue
		}
		if ( instr(s, 0, "key_get2.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_get2 = rtvaln
			continue
		}
		if ( instr(s, 0, "key_drop.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_drop = rtvaln
			continue
		}
		if ( instr(s, 0, "key_charainfo.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_charainfo = rtvaln
			jkey(int(rtvaln(1))) = key_charainfo
			continue
		}
		if ( instr(s, 0, "key_enter.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_enter = rtvaln
			jkey(int(rtvaln(1))) = key_enter
			continue
		}
		if ( instr(s, 0, "key_eat.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_eat = rtvaln
			continue
		}
		if ( instr(s, 0, "key_wear.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_wear = rtvaln
			continue
		}
		if ( instr(s, 0, "key_cast.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_cast = rtvaln
			continue
		}
		if ( instr(s, 0, "key_drink.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_drink = rtvaln
			continue
		}
		if ( instr(s, 0, "key_read.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_read = rtvaln
			continue
		}
		if ( instr(s, 0, "key_zap.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_zap = rtvaln
			continue
		}
		if ( instr(s, 0, "key_fire.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_fire = rtvaln
			jkey(int(rtvaln(1))) = key_fire
			continue
		}
		if ( instr(s, 0, "key_goDown.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_godown = rtvaln
			continue
		}
		if ( instr(s, 0, "key_goUp.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_goup = rtvaln
			continue
		}
		if ( instr(s, 0, "key_save.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_save = rtvaln
			continue
		}
		if ( instr(s, 0, "key_search.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_search = rtvaln
			continue
		}
		if ( instr(s, 0, "key_interact.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_interact = rtvaln
			continue
		}
		if ( instr(s, 0, "key_itemstack.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_itemstack = rtvaln
			continue
		}
		if ( instr(s, 0, "key_identify.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_identify = rtvaln
			continue
		}
		if ( instr(s, 0, "key_skill.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_skill = rtvaln
			continue
		}
		if ( instr(s, 0, "key_wipe.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_wipe = rtvaln
			continue
		}
		if ( instr(s, 0, "key_close.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_close = rtvaln
			continue
		}
		if ( instr(s, 0, "key_rest.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_rest = rtvaln
			continue
		}
		if ( instr(s, 0, "key_target.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_target = rtvaln
			jkey(int(rtvaln(1))) = key_target
			continue
		}
		if ( instr(s, 0, "key_dig.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_dig = rtvaln
			continue
		}
		if ( instr(s, 0, "key_use.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_use = rtvaln
			continue
		}
		if ( instr(s, 0, "key_bash.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_bash = rtvaln
			continue
		}
		if ( instr(s, 0, "key_open.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_open = rtvaln
			continue
		}
		if ( instr(s, 0, "key_dip.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_dip = rtvaln
			continue
		}
		if ( instr(s, 0, "key_pray.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_pray = rtvaln
			continue
		}
		if ( instr(s, 0, "key_offer.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_offer = rtvaln
			continue
		}
		if ( instr(s, 0, "key_journal.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_journal = rtvaln
			continue
		}
		if ( instr(s, 0, "key_material.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_material = rtvaln
			continue
		}
		if ( instr(s, 0, "key_quick.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_quick = rtvaln
			jkey(int(rtvaln(1))) = key_quick
			continue
		}
		if ( instr(s, 0, "key_trait.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_trait = rtvaln
			continue
		}
		if ( instr(s, 0, "key_look.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_look = rtvaln
			continue
		}
		if ( instr(s, 0, "key_give.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_give = rtvaln
			continue
		}
		if ( instr(s, 0, "key_throw.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_throw = rtvaln
			continue
		}
		if ( instr(s, 0, "key_mode.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_mode = rtvaln
			continue
		}
		if ( instr(s, 0, "key_mode2.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_mode2 = rtvaln
			continue
		}
		if ( instr(s, 0, "key_ammo.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_ammo = rtvaln
			jkey(int(rtvaln(1))) = key_ammo
			continue
		}
		if ( instr(s, 0, "key_quickinv.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			key_quickinv = rtvaln
			jkey(int(rtvaln(1))) = key_quickinv
			continue
		}
		if ( instr(s, 0, "zkey.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_zkey = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "xkey.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_xkey = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "scr_sync.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_scrsync = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "scroll_run.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_runscroll = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "skipRandEvents.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_skiprandevents = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "damage_show.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_dhyouji = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "Pcc_show.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_pcc_show = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "record.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_record = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "atk_select.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_atk_select = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "dust_select.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			cfg_dust_select = int(rtvaln)
			continue
		}
		key_prev = key_northwest
		key_next = key_northeast
		if ( instr(s, 0, "key_set.") != (-1) ) {
			p = 0
			p(1) = 0
			repeat
				await
				if ( instr(s, p, ",") == (-1) ) {
					break
				}
				p += instr(s, p, ",") + 1
				key_select(p(1)) = strmid(s, p, 1)
				p(1)++
			loop
		}
	loop
	f = 0
	if ( cfg_zkey == 0 ) {
		key_quick = "z"
		key_zap = "Z"
	}
	else {
		if ( cfg_zkey == 1 ) {
			key_zap = "z"
			key_quick = "Z"
		}
	}
	if ( cfg_xkey == 0 ) {
		key_quickinv = "x"
		key_inventory = "X"
	}
	else {
		if ( cfg_xkey == 1 ) {
			key_inventory = "x"
			key_quickinv = "X"
		}
	}
	if ( cfg_scrsync == 0 ) {
		cfg_scrsync = 3
	}
	if ( cfg_walkwait == 0 ) {
		cfg_walkwait = 5
	}
	if ( cfg_runwait < 1 ) {
		cfg_runwait = 1
	}
	if ( cfg_attackwait < 1 ) {
		cfg_attackwait = 1
	}
	if ( cfg_startrun >= 20 ) {
		cfg_startrun = 1000
	}


	if ( cfg_language == (-1) ) {
		redraw 0
		buffer BUFFER_BUF
		picload exedir + "graphic\\lang.bmp"
		gsel BUFFER_SCREEN
		gmode 0
		p = 0
*config_load_WHILE1
		if ( 1 == 0 ) {
			goto *config_load_WEND1
		}
		redraw 0
		color 0, 0, 0
		boxf
		pos 160, 170
		gcopy BUFFER_BUF, 0, 0, 340, 100
		pos 180, 220 + p * 20
		gcopy BUFFER_BUF, 360, 6, 20, 18
		redraw 1
		await 30
		getkey a, 40
		if ( a ) {
			p = 1
		}
		getkey a, 98
		if ( a ) {
			p = 1
		}
		getkey a, 38
		if ( a ) {
			p = 0
		}
		getkey a, 104
		if ( a ) {
			p = 0
		}
		getkey a, 13
		if ( a ) {
			goto *config_load_WEND1
		}
		getkey a, 32
		if ( a ) {
			goto *config_load_WEND1
		}
		goto *config_load_WHILE1
*config_load_WEND1
		cfg_language = p
		valn = "language.", "" + p
		gosub *cfg_write
		redraw 0
	}
	procid = (procid + 1) \ 4
	proclist(procid) = "Fix config" + " ct:" + ct
	if ( cfg_language == 0 ) {
		jp = 1
		vfix = 0
		sizefix = 0
	}
	else {
		en = 1
	}
	if ( key_mode == "" ) {
		key_mode = "z"
		f = 1
		noteadd "key_mode.\t\"z\""
	}
	if ( key_mode2 == "" ) {
		key_mode2 = "*"
		f = 1
		noteadd "key_mode2.\t\"*\""
	}
	if ( key_ammo == "" ) {
		key_ammo = "A"
		f = 1
		noteadd "key_ammo.\t\"A\""
	}
	if ( f ) {
		notesave exedir + "\\config.txt"
	}
	return

*dump_config
	notesel note_buff
	noteload exedir + "\\user\\export.txt"
	usertitle = ""
	usermsg = ""
	userpassword = "nyaa"
	repeat noteinfo(0)
		noteget s, cnt
		if ( instr(s, 0, "room_title.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			usertitle = rtvaln
			continue
		}
		if ( instr(s, 0, "welcome_msg.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			usermsg = rtvaln
			continue
		}
		if ( instr(s, 0, "pet_relation.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			userrelation = int(rtvaln)
			continue
		}
		if ( instr(s, 0, "password.") != (-1) ) {
			i = 0
			p = 0
			repeat
				p(2) = instr(s, p, "\"")
				if ( p(2) == (-1) ) {
					break
				}
				p += p(2)
				p(1) = instr(s, p + 1, "\"")
				if ( p(1) == (-1) ) {
					break
				}
				rtvaln(i) = strmid(s, p + 1, p(1))
				p += strlen(rtvaln(i)) + 2
				i++
			loop
			userpassword = rtvaln
			continue
		}
	loop
	return

*dump_config_import
	notesel headtemp
	noteget s, 1
	username = "" + s
	noteget s, 5
	usermsg = "" + s
	noteget s, 6
	userrelation = int(s)
	return
	goto *com_config

#defcfunc cnvjkey str cnvjkey_arg1
	locvar_cnvjkey_p = -2
	repeat 12
		if ( cnvjkey_arg1 == jkey(cnt) ) {
			locvar_cnvjkey_p = cnt
			break
		}
	loop
	return locvar_cnvjkey_p + 1

*com_config
	listmax = 0
	page = 0
	pagesize = 18
	cs = 0
	cc = CHARA_PLAYER
	cs_bk = -1
	page_bk = 0
	cs_bk2 = 0
	cfg_sound2 = cfg_sound
	cfg_music2 = cfg_music
	cfg_fullscreen2 = cfg_fullscreen
	windoww2 = windoww
	windowh2 = windowh
	if ( mode == MODELIST_TITLE ) {
		sel = 2
	}
	else {
		sel = 4
	}
	gsel sel
	repeat 8
		pos cnt \ 4 * 180, cnt / 4 * 300
		picload exedir + "\\graphic\\g" + (cnt + 1) + ".bmp", 1
	loop
	gsel BUFFER_SCREEN
	redraw 0
	if ( mode == MODELIST_MAIN ) {
		screenupdate = -1
		gosub *screen_draw
	}
	if ( mode == MODELIST_TITLE ) {
		gsel BUFFER_BUF
		gmode 0
		pos 0, 0
		picload exedir + "\\graphic\\title" + devfile + ".bmp", 1
		gzoom windoww, windowh, 4, 0, 0, 800, 600
		gsel BUFFER_SCREEN
		gmode 0
		pos 0, 0
		gcopy BUFFER_BUF, 0, 0, windoww, windowh
		gmode 2
	}
	if ( submenu == 0 ) {
		if ( jp ) {
			q = "オプション"
			s = "ゲームの設定", "画面と音の設定", "ネット機能の設定", "詳細な設定", "ゲームパッド", "メッセージとログ", "言語(Language)", ""
		}
		if ( en ) {
			q = "Option"
			s = "Game Setting", "Screen & Sound", "Network Setting", "Detailed Setting", "Game Pad", "Message & Log", "Language", ""
		}
		dx = 370
		dy = 270
	}
	if ( submenu == 1 ) {
		if ( jp ) {
			q = "ゲームの設定"
			s = "ノルンの冒険ガイド", "非好戦的NPCを無視", "zキーの割当て", "xキーの割当て", "走り始める歩数", "歩きの速さ", "攻撃の間隔", "レコード表示", "「攻撃する」選択肢", "汚物生成の阻止", ""
		}
		if ( en ) {
			q = "Game Setting"
			s = "Extra Help", "Neutral Npcs", "Assign z key", "Assign x key", "Start Running After", "Walk Speed", "Attack Interval", "Record", "Attack Select", "Block dust generation", ""
		}
		dx = 440
		dy = 370
	}
	if ( submenu == 2 ) {
		if ( jp ) {
			q = "画面と音の設定"
			s = "サウンドの再生*", "midiの再生*", "画面モード*", "画面の大きさ*", "スクロール", "主人公中心に描写", "心臓の音", "攻撃時アニメ", "天候エフェクト", "光源の描写", "アイテムの影描写", "PCC表示", ""
		}
		if ( en ) {
			q = "Screen & Sound"
			s = "Sound*", "Music*", "Screen Mode*", "Screen Resolution*", "Smooth Scroll", "Always Center", "Heartbeat Sound", "Attack Animation", "Weather Effect", "Lighting", "object Shadow", "PCC show", ""
		}
		dx = 440
		dy = 370
	}
	if ( submenu == 3 ) {
		if ( jp ) {
			q = "ネット機能の設定"
			s = "ネットの使用", "定期的に接続", "チャットをフィルタ", ""
		}
		if ( en ) {
			q = "Network Setting"
			s = "Use Network", "Constantly Connect", "Filter Chat", ""
		}
		dx = 440
		dy = 300
	}
	if ( submenu == 4 ) {
		if ( jp ) {
			q = "詳細な設定"
			s = "走りの速さ", "numlockを自動制御", "タイトルの水の波紋", "画面の更新頻度", "走り時スクロール", "オートターンの挙動", "イベントの短縮", "ダメージ表示", "エフェクトの速さ", ""
		}
		if ( en ) {
			q = "Detailed Setting"
			s = "Run Speed", "Auto Numlock", "Title Water Effect", "Screen Refresh", "Scroll When Run", "Auto Turn Speed", "Skip Random Events", "Damage show", "Effect Speed", ""
		}
		dx = 440
		dy = 350
	}
	if ( submenu == 5 ) {
		if ( jp ) {
			q = "ゲームパッド"
			s = "ゲームパッド", "決定キー", "キャンセルキー", "所持品", "行動", "斜め移動(L)", "拾う(R)", "射撃(R)", "目標(L)", "ポーズメニュー", "ヘルプ", "キャラ情報", "装填", ""
		}
		if ( en ) {
			q = "Game Pad"
			s = "Game Pad", "Enter/Ok", "Cancel", "Inventory", "Action", "diagonal Move/(L)", "Pick/(R)", "Shoot/(R)", "Target/(L)", "Peuse/Menu", "Help", "Chara-sheet", "Reload", ""
		}
		dx = 440
		dy = 430
	}
	if ( submenu == 6 ) {
		if ( jp ) {
			q = "メッセージとログ"
			s = "ﾒｯｾｰｼﾞに分表示追加", "過去のﾒｯｾｰｼﾞの透過", "起動時の注意書き", ""
		}
		if ( en ) {
			q = "Message&Log"
			s = "Add time info", "Transparency", "Disclaimer in title", ""
		}
		dx = 440
		dy = 300
	}
	if ( submenu == 7 ) {
		if ( jp ) {
			q = "言語(Language)"
			s = "言語*", ""
		}
		if ( en ) {
			q = "Language"
			s = "Language*", ""
		}
		dx = 440
		dy = 300
	}
	repeat 20
		if ( s(cnt) == "" ) {
			break
		}
		list(0, listmax) = cnt
		listn(0, listmax) = s(cnt)
		listmax++
	loop
	windowshadow = 1

*com_config_loop
	if ( cfg_zkey == 0 ) {
		key_quick = "z"
		key_zap = "Z"
	}
	else {
		if ( cfg_zkey == 1 ) {
			key_zap = "z"
			key_quick = "Z"
		}
	}
	if ( cfg_xkey == 0 ) {
		key_quickinv = "x"
		key_inventory = "X"
	}
	else {
		if ( cfg_xkey == 1 ) {
			key_inventory = "x"
			key_quickinv = "X"
		}
	}
	redraw 0
	cs_bk = -1
	pagemax = (listmax - 1) / pagesize
	if ( page < 0 ) {
		page = pagemax
	}
	else {
		if ( page > pagemax ) {
			page = 0
		}
	}

*com_config_loop_WHILE1
	if ( 1 == 0 ) {
		goto *com_story
	}
	redraw 0
	s = q, strhint3
	pagesize = 0
	if ( mode == MODELIST_CHARA_CREATION ) {
		display_window (windoww - dx) / 2 + inf_screenx, winposy(dy, 1), dx, dy
	}
	else {
		display_window (windoww - dx) / 2 + inf_screenx, winposy(dy) - 12, dx, dy
	}
	pagesize = listmax
	display_topic lang("項目", "Menu"), wx + 34, wy + 36
	if ( mode == MODELIST_TITLE ) {
		p = 2
	}
	else {
		p = 4
	}
	x = ww / 5 * 3
	y = wh - 80
	gmode 4, 180, 300, 50
	pos wx + ww / 3, wy + wh / 2
	grotate p, cmbg / 4 \ 4 * 180, cmbg / 4 / 4 \ 2 * 300, 0, x, y
	gmode 2
	keyrange = 0
	repeat pagesize
		p = pagesize * page + cnt
		if ( p >= listmax ) {
			break
		}
		if ( submenu == 0 ) {
			key_list(cnt) = key_select(cnt)
			keyrange++
			display_key wx + 32, wy + 66 + cnt * 19 - 2, cnt
		}
		else {
			key_list(cnt) = key_cancel
			keyrange++
		}
	loop
	if ( submenu == 5 ) {
		p = 0, cnvjkey(key_enter), cnvjkey(key_cancel), cnvjkey(key_quickinv), cnvjkey(key_quick), cnvjkey(key_alter), cnvjkey(key_get), cnvjkey(key_fire), cnvjkey(key_target), cnvjkey(key_esc), cnvjkey(key_help), cnvjkey(key_charainfo), cnvjkey(key_ammo)
		repeat 19, 1
			list(1, cnt) = p(cnt)
		loop
	}
	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
	cs_listbk
	repeat pagesize
		p = pagesize * page + cnt
		if ( p >= listmax ) {
			break
		}
		i = list(0, p)
		s = listn(0, p)
		if ( submenu == 0 ) {
			x = 8
		}
		else {
			x = 0
		}
		if ( submenu == 3 ) {
			if ( cfg_net == 0 ) {
				if ( cnt >= 1 ) {
					continue
				}
			}
		}
		cs_list s, wx + 56 + x, wy + 66 + cnt * 19 - 1, 19, 0
		if ( submenu == 5 & cnt > 0 ) {
		}
		else {
			if ( submenu != 0 ) {
				pos wx + 220, wy + 66 + cnt * 19 - 5
				gcopy BUFFER_INF, 312, 336, 24, 24
				pos wx + 358, wy + 66 + cnt * 19 - 5
				gcopy BUFFER_INF, 336, 336, 24, 24
			}
		}
		pos wx + 250, wy + 66 + cnt * 19
		color 0, 0, 0
		if ( submenu == 1 ) {
			if ( cnt == 0 ) {
				if ( jp ) {
					s = "なし", "あり"
				}
				else {
					s = "Don't show", "Show"
				}
				mes s(cfg_extrahelp)
			}
			if ( cnt == 1 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "Attack", "Ignore"
				}
				mes s(cfg_ignoredislike)
			}
			if ( cnt == 2 ) {
				if ( jp ) {
					s = "ｸｨｯｸﾒﾆｭｰ", "道具を振る", "割当なし"
				}
				else {
					s = "Quick menu", "Zap", "Don't assign"
				}
				mes s(cfg_zkey)
			}
			if ( cnt == 3 ) {
				if ( jp ) {
					s = "ｸｲｯｸｲﾝﾍﾞﾝﾄﾘ", "道具を調べる", "割当なし"
				}
				else {
					s = "Quick Inv", "Identify", "Don't assign"
				}
				mes s(cfg_xkey)
			}
			if ( cnt == 4 ) {
				if ( cfg_startrun >= 20 ) {
					if ( jp ) {
						mes "走らない"
					}
					else {
						mes "Dont't run"
					}
				}
				else {
					if ( jp ) {
						mes "" + (cfg_startrun + 1) + "歩目から"
					}
					else {
						mes "After " + (cfg_startrun + 1) + " steps"
					}
				}
			}
			if ( cnt == 5 ) {
				mes "" + cfg_walkwait + " wait"
			}
			if ( cnt == 6 ) {
				mes "" + cfg_attackwait + " wait"
			}
			if ( cnt == 7 ) {
				if ( jp ) {
					s = "なし", "一部表示", "全表示"
				}
				else {
					s = "Don't show", "Show", "Show Max"
				}
				mes s(cfg_record)
			}
			if ( cnt == 8 ) {
				if ( jp ) {
					s = "全表示", "味方以外", "全非表示"
				}
				else {
					s = "Show", "Neutral", "Don't show"
				}
				mes s(cfg_atk_select)
			}
			if ( cnt == 9 ) {
				if ( jp ) {
					s = "特になし", "阻止あり"
				}
				else {
					s = "No Block", "Block"
				}
				mes s(cfg_dust_select)
			}
		}
		if ( submenu == 2 ) {
			if ( cnt == 0 ) {
				if ( jp ) {
					s = "なし", "direct sound", "MCI"
				}
				else {
					s = "None", "Direct sound", "MCI"
				}
				mes s(cfg_sound2)
			}
			if ( cnt == 1 ) {
				if ( jp ) {
					s = "なし", "direct music", "MCI"
				}
				else {
					s = "None", "Direct music", "MCI"
				}
				mes s(cfg_music2)
			}
			if ( cnt == 2 ) {
				if ( jp ) {
					s = "ウィンドウ", "フルスクリーン"
				}
				else {
					s = "Window mode", "Full screen"
				}
				mes s(cfg_fullscreen2)
			}
			if ( cnt == 3 ) {
				mes "" + windoww2 + " * " + windowh2
			}
			if ( cnt == 4 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_scroll)
			}
			if ( cnt == 5 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_alwayscenter)
			}
			if ( cnt == 6 ) {
				if ( jp ) {
					s = "再生しない", "再生する"
				}
				else {
					s = "Don't play", "Play"
				}
				mes s(cfg_heart)
			}
			if ( cnt == 7 ) {
				if ( jp ) {
					s = "アニメなし", "主人公のみ", "味方側のみ", "全員あり"
				}
				else {
					s = "No", "Only PC", "Only ally", "All"
				}
				mes s(cfg_attackanime)
			}
			if ( cnt == 8 ) {
				if ( jp ) {
					s = "アニメなし", "アニメあり"
				}
				else {
					s = "No animation", "Always"
				}
				mes s(cfg_env)
			}
			if ( cnt == 9 ) {
				if ( jp ) {
					s = "高画質", "低画質"
				}
				else {
					s = "High", "Low"
				}
				mes s(cfg_shadow)
			}
			if ( cnt == 10 ) {
				if ( jp ) {
					s = "なし（高速）", "あり（低速）"
				}
				else {
					s = "No(Fast)", "Yes(Slow)"
				}
				mes s(cfg_objectshadow)
			}
			if ( cnt == 11 ) {
				if ( jp ) {
					s = "原寸表示", "縮小表示"
				}
				else {
					s = "Full-size", "Reduced"
				}
				mes s(cfg_pcc_show)
			}
		}
		if ( submenu == 3 ) {
			if ( cnt == 0 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_net)
			}
			if ( cnt == 1 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_netwish)
			}
			if ( cnt == 2 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_netchat)
			}
		}
		if ( submenu == 4 ) {
			if ( cnt == 0 ) {
				mes "" + cfg_runwait + " wait"
			}
			if ( cnt == 1 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_autonumlock)
			}
			if ( cnt == 2 ) {
				if ( jp ) {
					s = "オフ", "オン"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_titleeffect)
			}
			if ( cnt == 3 ) {
				if ( jp ) {
					s = "オフ", "オン"
				}
				else {
					s = "No", "Yes"
				}
				mes "" + cfg_scrsync + " wait"
			}
			if ( cnt == 4 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_runscroll)
			}
			if ( cnt == 5 ) {
				if ( jp ) {
					s = "普通", "速め", "省略"
				}
				else {
					s = "Normal", "High", "Highest"
				}
				mes s(cfg_autoturn)
			}
			if ( cnt == 6 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_skiprandevents)
			}
			if ( cnt == 7 ) {
				if ( jp ) {
					s = "しない", "する", "吊るし時のみ"
				}
				else {
					s = "No", "Yes", "SandBag"
				}
				mes s(cfg_dhyouji)
			}
			if ( cnt == 8 ) {
				mes "" + cfg_animewait + " wait"
			}
		}
		if ( submenu == 5 ) {
			if ( cnt == 0 ) {
				if ( jp ) {
					s = "使用しない", "使用する"
				}
				else {
					s = "Don't use", "Use"
				}
				mes s(cfg_joypad)
			}
			else {
				if ( list(1, cnt) == (-1) ) {
					mes lang("未設定", "Unassigned")
				}
				else {
					mes lang("ボタン", "Button") + list(1, cnt)
				}
			}
		}
		if ( submenu == 6 ) {
			if ( cnt == 2 ) {
				if ( jp ) {
					s = "非表示", "表示"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_titledialog)
			}
			if ( cnt == 0 ) {
				if ( jp ) {
					s = "しない", "する"
				}
				else {
					s = "No", "Yes"
				}
				mes s(cfg_msgaddtime)
			}
			if ( cnt == 1 ) {
				mes "" + cfg_msgtrans * 10 + " %"
			}
		}
		if ( submenu == 7 ) {
			if ( cnt == 0 ) {
				s = "Japanese", "English"
				mes s(cfg_language)
			}
		}
	loop
	if ( submenu != 0 ) {
		if ( submenu != 5 ) {
			pos wx + 40, wy + wh - 70
			font lang(cfg_font1, cfg_font2), 12 + sizefix - en * 2, 0
			color 0, 0, 0
			if ( jp ) {
				mes "* 印のついた項目は、ゲームの再起動後に適用されます"
			}
			else {
				mes "Items marked with * require restart to apply changes."
			}
		}
	}
	if ( submenu == 5 ) {
		pos wx + 40, wy + wh - 110
		font lang(cfg_font1, cfg_font2), 12 + sizefix - en * 2, 0
		color 0, 0, 0
		if ( jp ) {
			mes "ボタンを割り当てたい項目にカーソルをあわせて\nゲームパッドのボタンを押してください。(L),(R)の付いている\n項目は、メニュー画面でタブの移動に使われます。"
		}
		else {
			mes "To assign a button, move the cursor to\nan item and press the button."
		}
	}
	if ( keyrange != 0 ) {
		cs_bk = cs
	}
	redraw 1
	await cfg_wait1
	key_check
	cursor_check
	p = -1
	repeat keyrange
		if ( key == key_select(cnt) ) {
			p = list(0, pagesize * page + cnt)
			cs = cnt
			break
		}
	loop
	if ( p != (-1) ) {
		if ( submenu == 0 ) {
			submenu = p + 1
			snd SOUNDLIST_OK1
			goto *com_config
		}
	}
	if ( submenu == 5 ) {
		if ( cs > 0 ) {
			DIGETJOYSTATE j, 0
			f = 0
			repeat 12
				HMMBITCHECK j, 4 + cnt
				if ( stat ) {
					p = cnt
					valn = ""
					repeat 12
						jkey(cnt) = ""
					loop
					list(1, cs) = p
					repeat 19, 1
						if ( cs == cnt ) {
							continue
						}
						list(1, cnt)--
						if ( list(1, cnt) == p | list(1, cnt) <= (-1) ) {
							list(1, cnt) = 12
						}
					loop
					valn = "key_enter.", key_enter, "" + list(1, 1), ""
					jkey(list(1, 1)) = "" + key_enter
					gosub *cfg_write
					valn = "key_cancel.", key_cancel, "" + list(1, 2), ""
					jkey(list(1, 2)) = "" + key_cancel
					gosub *cfg_write
					valn = "key_quickinv.", key_quickinv, "" + list(1, 3), ""
					jkey(list(1, 3)) = "" + key_quickinv
					gosub *cfg_write
					valn = "key_quick.", key_quick, "" + list(1, 4), ""
					jkey(list(1, 4)) = "" + key_quick
					gosub *cfg_write
					valn = "key_alter.", key_alter, "" + list(1, 5), ""
					jkey(list(1, 5)) = "" + key_alter
					gosub *cfg_write
					valn = "key_get.", key_get, "" + list(1, 6), ""
					jkey(list(1, 6)) = "" + key_get
					gosub *cfg_write
					valn = "key_fire.", key_fire, "" + list(1, 7), ""
					jkey(list(1, 7)) = "" + key_fire
					gosub *cfg_write
					valn = "key_target.", key_target, "" + list(1, 8), ""
					jkey(list(1, 8)) = "" + key_target
					gosub *cfg_write
					valn = "key_esc.", key_esc, "" + list(1, 9), ""
					jkey(list(1, 9)) = "" + key_esc
					gosub *cfg_write
					valn = "key_help.", key_help, "" + list(1, 10), ""
					jkey(list(1, 10)) = "" + key_help
					gosub *cfg_write
					valn = "key_charainfo.", key_charainfo, "" + list(1, 11), ""
					jkey(list(1, 11)) = "" + key_charainfo
					gosub *cfg_write
					valn = "key_ammo.", key_ammo, "" + list(1, 12), ""
					jkey(list(1, 12)) = "" + key_ammo
					gosub *cfg_write
					p = 0, cnvjkey(key_enter), cnvjkey(key_cancel), cnvjkey(key_quickinv), cnvjkey(key_quick), cnvjkey(key_alter), cnvjkey(key_get), cnvjkey(key_fire), cnvjkey(key_target), cnvjkey(key_esc), cnvjkey(key_help), cnvjkey(key_charainfo), cnvjkey(key_ammo)
					repeat 19, 1
						list(1, cnt) = p(cnt)
					loop
					f = 1
					break
				}
			loop
			if ( f ) {
				snd SOUNDLIST_OK1
				await 200
				goto *com_config_loop
			}
		}
	}
	if ( key == key_pageup | key == key_pagedown ) {
		if ( key == key_pageup ) {
			p = 1
		}
		else {
			p = -1
		}
		if ( submenu == 1 ) {
			if ( cs == 0 ) {
				if ( 1 ) {
					cfg_extrahelp += p
					if ( cfg_extrahelp > 1 ) {
						cfg_extrahelp = 1
					}
					else {
						if ( cfg_extrahelp < 0 ) {
							cfg_extrahelp = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "extraHelp.", str(cfg_extrahelp)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 1 ) {
				if ( 1 ) {
					cfg_ignoredislike += p
					if ( cfg_ignoredislike > 1 ) {
						cfg_ignoredislike = 1
					}
					else {
						if ( cfg_ignoredislike < 0 ) {
							cfg_ignoredislike = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "ignoreDislike.", str(cfg_ignoredislike)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 2 ) {
				if ( 1 ) {
					cfg_zkey += p
					if ( cfg_zkey > 2 ) {
						cfg_zkey = 2
					}
					else {
						if ( cfg_zkey < 0 ) {
							cfg_zkey = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "zkey.", str(cfg_zkey)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 3 ) {
				if ( 1 ) {
					cfg_xkey += p
					if ( cfg_xkey > 2 ) {
						cfg_xkey = 2
					}
					else {
						if ( cfg_xkey < 0 ) {
							cfg_xkey = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "xkey.", str(cfg_xkey)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 4 ) {
				if ( 1 ) {
					cfg_startrun += p
					if ( cfg_startrun > 20 ) {
						cfg_startrun = 20
					}
					else {
						if ( cfg_startrun < 0 ) {
							cfg_startrun = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "startRun.", str(cfg_startrun)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 5 ) {
				if ( 1 ) {
					cfg_walkwait += p
					if ( cfg_walkwait > 10 ) {
						cfg_walkwait = 10
					}
					else {
						if ( cfg_walkwait < 1 ) {
							cfg_walkwait = 1
						}
					}
					snd SOUNDLIST_OK1
					valn = "walkWait.", str(cfg_walkwait)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 6 ) {
				if ( 1 ) {
					cfg_attackwait += p
					if ( cfg_attackwait > 20 ) {
						cfg_attackwait = 20
					}
					else {
						if ( cfg_attackwait < 1 ) {
							cfg_attackwait = 1
						}
					}
					snd SOUNDLIST_OK1
					valn = "attackWait.", str(cfg_attackwait)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 7 ) {
				if ( 1 ) {
					cfg_record += p
					if ( cfg_record > 2 ) {
						cfg_record = 2
					}
					else {
						if ( cfg_record < 0 ) {
							cfg_record = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "record.", str(cfg_record)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 8 ) {
				if ( 1 ) {
					cfg_atk_select += p
					if ( cfg_atk_select > 2 ) {
						cfg_atk_select = 2
					}
					else {
						if ( cfg_atk_select < 0 ) {
							cfg_atk_select = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "atk_select.", str(cfg_atk_select)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 9 ) {
				if ( 1 ) {
					cfg_dust_select += p
					if ( cfg_dust_select > 1 ) {
						cfg_dust_select = 1
					}
					else {
						if ( cfg_dust_select < 0 ) {
							cfg_dust_select = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "dust_select.", str(cfg_dust_select)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
		}
		if ( submenu == 2 ) {
			if ( cs == 0 ) {
				if ( 1 ) {
					cfg_sound2 += p
					if ( cfg_sound2 > 2 ) {
						cfg_sound2 = 2
					}
					else {
						if ( cfg_sound2 < 0 ) {
							cfg_sound2 = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "sound.", str(cfg_sound2)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 1 ) {
				if ( 1 ) {
					cfg_music2 += p
					if ( cfg_music2 > 2 ) {
						cfg_music2 = 2
					}
					else {
						if ( cfg_music2 < 0 ) {
							cfg_music2 = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "music.", str(cfg_music2)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 2 ) {
				if ( 1 ) {
					cfg_fullscreen2 += p
					if ( cfg_fullscreen2 > 1 ) {
						cfg_fullscreen2 = 1
					}
					else {
						if ( cfg_fullscreen2 < 0 ) {
							cfg_fullscreen2 = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "fullscreen.", str(cfg_fullscreen2)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 4 ) {
				if ( 1 ) {
					cfg_scroll += p
					if ( cfg_scroll > 1 ) {
						cfg_scroll = 1
					}
					else {
						if ( cfg_scroll < 0 ) {
							cfg_scroll = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "scroll.", str(cfg_scroll)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 5 ) {
				if ( 1 ) {
					cfg_alwayscenter += p
					if ( cfg_alwayscenter > 1 ) {
						cfg_alwayscenter = 1
					}
					else {
						if ( cfg_alwayscenter < 0 ) {
							cfg_alwayscenter = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "alwaysCenter.", str(cfg_alwayscenter)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 6 ) {
				if ( 1 ) {
					cfg_heart += p
					if ( cfg_heart > 1 ) {
						cfg_heart = 1
					}
					else {
						if ( cfg_heart < 0 ) {
							cfg_heart = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "heartbeat.", str(cfg_heart)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 7 ) {
				if ( 1 ) {
					cfg_attackanime += p
					if ( cfg_attackanime > 3 ) {
						cfg_attackanime = 3
					}
					else {
						if ( cfg_attackanime < 0 ) {
							cfg_attackanime = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "attackAnime.", str(cfg_attackanime)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 8 ) {
				if ( 1 ) {
					cfg_env += p
					if ( cfg_env > 1 ) {
						cfg_env = 1
					}
					else {
						if ( cfg_env < 0 ) {
							cfg_env = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "envEffect.", str(cfg_env)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 9 ) {
				if ( 1 ) {
					cfg_shadow += p
					if ( cfg_shadow > 1 ) {
						cfg_shadow = 1
					}
					else {
						if ( cfg_shadow < 0 ) {
							cfg_shadow = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "shadow.", str(cfg_shadow)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 10 ) {
				if ( 1 ) {
					cfg_objectshadow += p
					if ( cfg_objectshadow > 1 ) {
						cfg_objectshadow = 1
					}
					else {
						if ( cfg_objectshadow < 0 ) {
							cfg_objectshadow = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "objectShadow.", str(cfg_objectshadow)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 11 ) {
				if ( 1 ) {
					cfg_pcc_show += p
					if ( cfg_pcc_show > 1 ) {
						cfg_pcc_show = 1
					}
					else {
						if ( cfg_pcc_show < 0 ) {
							cfg_pcc_show = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "Pcc_show.", str(cfg_pcc_show)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 3 ) {
				x = 800, 800, 1024, 1152, 1280, 1280
				y = 600, 696, 768, 864, 768, 1024
				i = 0
				repeat 5
					if ( windoww2 == x(cnt) ) {
						if ( windowh2 == y(cnt) ) {
							i = cnt
							break
						}
					}
				loop
				i += p
				if ( i < 0 ) {
					i = 0
				}
				else {
					if ( i > 4 ) {
						i = 4
					}
				}
				windoww2 = x(i)
				windowh2 = y(i)
				valn = "windowW.", "" + windoww2
				gosub *cfg_write
				valn = "windowH.", "" + windowh2
				gosub *cfg_write
				snd SOUNDLIST_OK1
				goto *com_config_loop
			}
		}
		if ( submenu == 3 ) {
			if ( cs == 0 ) {
				if ( 1 ) {
					cfg_net += p
					if ( cfg_net > 1 ) {
						cfg_net = 1
					}
					else {
						if ( cfg_net < 0 ) {
							cfg_net = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "net.", str(cfg_net)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 1 ) {
				if ( 1 ) {
					cfg_netwish += p
					if ( cfg_netwish > 1 ) {
						cfg_netwish = 1
					}
					else {
						if ( cfg_netwish < 0 ) {
							cfg_netwish = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "netWish.", str(cfg_netwish)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 2 ) {
				if ( 1 ) {
					cfg_netchat += p
					if ( cfg_netchat > 1 ) {
						cfg_netchat = 1
					}
					else {
						if ( cfg_netchat < 0 ) {
							cfg_netchat = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "netChat.", str(cfg_netchat)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
		}
		if ( submenu == 4 ) {
			if ( cs == 0 ) {
				if ( 1 ) {
					cfg_runwait += p
					if ( cfg_runwait > 5 ) {
						cfg_runwait = 5
					}
					else {
						if ( cfg_runwait < 2 ) {
							cfg_runwait = 2
						}
					}
					snd SOUNDLIST_OK1
					valn = "runWait.", str(cfg_runwait)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 1 ) {
				if ( 1 ) {
					cfg_autonumlock += p
					if ( cfg_autonumlock > 1 ) {
						cfg_autonumlock = 1
					}
					else {
						if ( cfg_autonumlock < 0 ) {
							cfg_autonumlock = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "autoNumlock.", str(cfg_autonumlock)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 2 ) {
				if ( 1 ) {
					cfg_titleeffect += p
					if ( cfg_titleeffect > 1 ) {
						cfg_titleeffect = 1
					}
					else {
						if ( cfg_titleeffect < 0 ) {
							cfg_titleeffect = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "titleEffect.", str(cfg_titleeffect)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 3 ) {
				if ( 1 ) {
					cfg_scrsync += p
					if ( cfg_scrsync > 25 ) {
						cfg_scrsync = 25
					}
					else {
						if ( cfg_scrsync < 2 ) {
							cfg_scrsync = 2
						}
					}
					snd SOUNDLIST_OK1
					valn = "scr_sync.", str(cfg_scrsync)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 4 ) {
				if ( 1 ) {
					cfg_runscroll += p
					if ( cfg_runscroll > 1 ) {
						cfg_runscroll = 1
					}
					else {
						if ( cfg_runscroll < 0 ) {
							cfg_runscroll = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "scroll_run.", str(cfg_runscroll)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 5 ) {
				if ( 1 ) {
					cfg_autoturn += p
					if ( cfg_autoturn > 2 ) {
						cfg_autoturn = 2
					}
					else {
						if ( cfg_autoturn < 0 ) {
							cfg_autoturn = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "autoTurnType.", str(cfg_autoturn)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 6 ) {
				if ( 1 ) {
					cfg_skiprandevents += p
					if ( cfg_skiprandevents > 1 ) {
						cfg_skiprandevents = 1
					}
					else {
						if ( cfg_skiprandevents < 0 ) {
							cfg_skiprandevents = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "skipRandEvents.", str(cfg_skiprandevents)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 7 ) {
				if ( 1 ) {
					cfg_dhyouji += p
					if ( cfg_dhyouji > 2 ) {
						cfg_dhyouji = 2
					}
					else {
						if ( cfg_dhyouji < 0 ) {
							cfg_dhyouji = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "damage_show.", str(cfg_dhyouji)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 8 ) {
				if ( 1 ) {
					cfg_animewait += p
					if ( cfg_animewait > 20 ) {
						cfg_animewait = 20
					}
					else {
						if ( cfg_animewait < 0 ) {
							cfg_animewait = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "anime_wait.", str(cfg_animewait)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
		}
		if ( submenu == 5 ) {
			if ( cs == 0 ) {
				if ( 1 ) {
					cfg_joypad += p
					if ( cfg_joypad > 1 ) {
						cfg_joypad = 1
					}
					else {
						if ( cfg_joypad < 0 ) {
							cfg_joypad = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "joypad.", str(cfg_joypad)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
		}
		if ( submenu == 6 ) {
			if ( cs == 0 ) {
				if ( 1 ) {
					cfg_msgaddtime += p
					if ( cfg_msgaddtime > 1 ) {
						cfg_msgaddtime = 1
					}
					else {
						if ( cfg_msgaddtime < 0 ) {
							cfg_msgaddtime = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "msg_addTime.", str(cfg_msgaddtime)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 1 ) {
				if ( 1 ) {
					cfg_msgtrans += p
					if ( cfg_msgtrans > 5 ) {
						cfg_msgtrans = 5
					}
					else {
						if ( cfg_msgtrans < 0 ) {
							cfg_msgtrans = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "msg_trans.", str(cfg_msgtrans)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
			if ( cs == 2 ) {
				if ( 1 ) {
					cfg_titledialog += p
					if ( cfg_titledialog > 1 ) {
						cfg_titledialog = 1
					}
					else {
						if ( cfg_titledialog < 0 ) {
							cfg_titledialog = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "title_dialog.", str(cfg_titledialog)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
		}
		if ( submenu == 7 ) {
			if ( cs == 0 ) {
				if ( 1 ) {
					cfg_language += p
					if ( cfg_language > 1 ) {
						cfg_language = 1
					}
					else {
						if ( cfg_language < 0 ) {
							cfg_language = 0
						}
					}
					snd SOUNDLIST_OK1
					valn = "language.", str(cfg_language)
					gosub *cfg_write
					goto *com_config_loop
				}
			}
		}
	}
	if ( key == key_cancel ) {
		if ( submenu != 0 ) {
			submenu = 0
			goto *com_config
		}
		gosub *config_load
		if ( mode == MODELIST_MAIN ) {
			if ( cfg_net ) {
				gosub *net_init
			}
			gosub *screen_draw
			goto *pc_turn
		}
		else {
			goto *game_title
		}
	}
	goto *com_config_loop_WHILE1

*com_story
	snd SOUNDLIST_BOOK1
	gsel BUFFER_BUF
	pos 0, 0
	picload exedir + "graphic\\book.bmp", 1
	gsel BUFFER_PIC
	pos 0, 0
	picload exedir + "\\graphic\\g1.bmp", 0
	gsel BUFFER_SCREEN
	listmax = 0
	page = 0
	pagesize = 12
	cs = 0
	cc = CHARA_PLAYER
	notesel buff
	noteload lang("scene1.hsp", "scene2.hsp")
	p = 0
	repeat 1000
		s = "{" + cnt + "}"
		p = instr(buff, 0, s)
		if ( p != (-1) ) {
			if ( cnt <= gdata(GDATA_STORY_BOOKMARK) ) {
				list(0, listmax) = cnt, p
				listmax++
			}
		}
	loop
	redraw 0
	txt lang("どのシーンを再生する？", "Which scene do you want to replay?")

*com_story_loop_pgchk
	redraw 0
	cs_bk = -1
	pagemax = (listmax - 1) / pagesize
	if ( page < 0 ) {
		page = pagemax
	}
	else {
		if ( page > pagemax ) {
			page = 0
		}
	}
	wx = (windoww - 720) / 2 + inf_screenx
	wy = winposy(468)

*com_story_loop
	if ( 1 == 0 ) {
		goto *com_story_loop_UNUSED
	}
	redraw 0
	pos wx, wy
	gcopy BUFFER_BUF, 0, 0, 736, 448
	x = 240
	y = 320
	gmode 4, 180, 300, 100
	color 0, 0, 0
	pos wx + 190, wy + 220
	grotate BUFFER_PIC, 0, 0, 0, x, y
	gmode 2
	keyrange = 0
	repeat pagesize
		p = pagesize * page + cnt
		if ( p >= listmax ) {
			break
		}
		key_list(cnt) = key_select(cnt)
		keyrange++
		display_key wx + 394, wy + 91 + cnt * 22 - 2, cnt
	loop
	font lang(cfg_font1, cfg_font2), 12 - en * 2, 6
	color 0, 0, 0
	pos wx + 90, wy + 50
	mes "Elona - Scene playback"
	font lang(cfg_font1, cfg_font2), 12 - en * 2, 0
	color 0, 0, 0
	pos wx + 390, wy + 50
	mes lang("アンロックされたシーンを再生できます。\nシーンNoは連続していません。", "You can play the unlocked scenes.")
	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
	cs_listbk
	repeat pagesize
		p = pagesize * page + cnt
		if ( p >= listmax ) {
			break
		}
		i = list(0, p)
		cs_list lang("シーン No.", "Scene No. ") + i, wx + 424, wy + 91 + cnt * 22 - 1, 19
	loop
	font lang(cfg_font1, cfg_font2), 12 - en * 2, 1
	color 0, 0, 0
	pos wx + 500, wy + 375
	mes "- " + (page + 1) + " -"
	if ( page < pagemax ) {
		pos wx + 590, wy + 375
		mes "(more)"
	}
	if ( keyrange != 0 ) {
		cs_bk = cs
	}
	redraw 1
	await cfg_wait1
	key_check
	cursor_check
	p = -1
	repeat keyrange
		if ( key == key_select(cnt) ) {
			p = list(0, pagesize * page + cnt)
			break
		}
	loop
	if ( p != (-1) ) {
		sceneid = p
		gosub *scene
		screenupdate = -1
		gosub *screen_refreshFull
		txtnew
		txt lang("シーンの再生を終えた。", "The scene has been played.")
		goto *com_story
	}
	if ( key == key_pageup ) {
		if ( pagemax != 0 ) {
			snd SOUNDLIST_CARD1
			page++
			goto *com_story_loop_pgchk
		}
	}
	if ( key == key_pagedown ) {
		if ( pagemax != 0 ) {
			snd SOUNDLIST_CARD1
			page--
			goto *com_story_loop_pgchk
		}
	}
	if ( key == key_cancel | key == key_enter ) {
		gosub *music_play
		gosub *screen_draw
		goto *pc_turn
	}
	goto *com_story_loop

*com_story_loop_UNUSED
	inv_getheader 0
	p = 0, 0
	p = 0, 0
	repeat invrange, invhead
		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
			continue
		}
		i = refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE)
		if ( i != 53000 & i != 52000 & i != 56000 & i != 54000 & i >= 50000 ) {
			continue
		}
		if ( inv(INV_ITEM_KNOWN, cnt) < 5 ) {
			item_identify cnt, 250, -1
			item_stack CHARA_PLAYER, cnt
			p(1)++
			if ( idtresult == 5 ) {
				p++
			}
		}
	loop
	return

*game_init
	gdata(GDATA_YEAR) = 517, 8, 12, 16, 10
	quickpage = 1
	if ( dirinfo(4) == "medit" ) {
		medit = 1
		goto *mapEditor_init
	}
	if ( 0 != 1 | dbg_skipcm == 1 ) {
		if ( defload != "" ) {
			exist exedir + "save\\" + defload + "\\header.txt"
			if ( strsize == (-1) ) {
				exist exedir + "save\\sav_" + defload + "\\header.txt"
				if ( strsize != (-1) ) {
					defload = "sav_" + defload
				}
				else {
					defload = ""
				}
			}
			if ( defload == "" ) {
				dialog "Invalid defLoadFolder. name"
			}
			else {
				playerid = defload
				mode = MODELIST_CONTINUE
				music = MUSICLIST_NONE
				goto *world_init
			}
		}
		goto *game_title
	}
	mode = MODELIST_QUICK_START
	goto *world_init

*world_init
	mtilefilecur = -1
	firstturn = 1
	msgtemp = " Welcome traveler! "
	if ( cfg_net ) {
		gosub *net_init
	}
	if ( mode == MODELIST_QUICK_START ) {
		repeat 9
			gdata(STARTING_GDATA_RANK + cnt) = 5000
		loop
		gdata(GDATA_VERSION) = int(double("6.05") * 1000)
		gdata(STARTING_GDATA_SHORTCUT + 1) = 424
		gdata(STARTING_GDATA_SHORTCUT + 2) = 300
		gdata(STARTING_GDATA_SHORTCUT + 3) = 631
		gdata(GDATA_COUNT_SHOP) = 1000
		gdata(GDATA_COUNT_SHELTER) = 100
		dbgchara = 23
		playerid = "sav_noa"
		gdata(GDATA_WORLD_X) = 22
		gdata(GDATA_WORLD_Y) = 21
		gdata(GDATA_AREA_PREV) = -1
		gdata(GDATA_RAND_SEED_A) = rnd(800) + 2
		gdata(GDATA_RAND_SEED_B) = rnd(200) + 2
		gdata(GDATA_AREA) = AREA_NORTH_TYRIS
		gdata(GDATA_LEVEL) = 0
		gdata(GDATA_LEVEL_START_ON) = 7
		mapstartx = 22
		mapstarty = 21
		gdata(GDATA_AREA) = AREA_VERNIS
		gdata(GDATA_LEVEL) = 1
		gdata(GDATA_LEVEL_START_ON) = 7
		mapstartx = 10
		mapstarty = 23
		initlv = 3000
		rc = CHARA_PLAYER
		flt 100
		characreate CHARA_PLAYER, CREATURE_ID_LANKATA_THE_LIGHTNING_OF_BLUE, -3, 0
		gosub *cm_finishPC
		repeat 3
		loop
		gdata(GDATA_YEAR) = 517, 12, 30, 1, 10
		gdata(GDATA_STORY_BOOKMARK) = 10000
		gdata(GDATA_DEEPEST) = 100
		gdata(GDATA_FLAG_ALLY) = 1
		adata(ADATA_PARENT, 7) = AREA_NORTH_TYRIS
		gdata(GDATA_WORLD) = adata(ADATA_PARENT, gdata(GDATA_AREA))
		gdata(GDATA_TRAIT_POINT) = 2
		gdata(GDATA_HEIR_DEED) = 1000
		gdata(GDATA_HOME_LEVEL) = 0
		gdata(GDATA_GUEST) = 10
		gdata(GDATA_ABSORB_CHARGE) = 1000
		gdata(GDATA_DEEPEST_LEVEL) = 500
		cdata(CDATA_GOD, CHARA_PLAYER) = GOD_LULWY, 1000, 1000
		gdata(GDATA_FLAG_SUB_MOTHER) = 1001
		gdata(GDATA_FLAG_SUB_URCAGUARY_THE_TENACIOUS_GEM) = 2
		gdata(GDATA_FLAG_SUB_DOGS_TAIL) = 1000
		gdata(GDATA_FLAG_SUB_YEEK) = 1000
		gdata(GDATA_FLAG_SUB_H_SISTER) = 1000
		gdata(GDATA_FLAG_SUB_CAT) = 1000
		gdata(GDATA_FLAG_SUB_MINOTAUR) = 1000
		gdata(GDATA_FLAG_SUB_PYRAMID) = 1000
		gdata(GDATA_FLAG_SUB_FALLEN_PRINCESS) = 1000
		gdata(GDATA_FLAG_SUB_MANSION_FOR_SALE) = 1004
		gdata(GDATA_FLAG_SUB_BIOLOGIST) = 1000
		gdata(GDATA_FLAG_LEOLD_LOCATION_STATE) = 4
		gdata(GDATA_FLAG_SUB_STRUGGLE_AGAINST_INSANITY) = 1000
		gdata(GDATA_FLAG_SUB_BEYOND_THE_GENERATIONS) = 1001
		gdata(GDATA_FLAG_SUB_BELPHAT_THE_COSMIC_SWORD) = 1000
		gdata(GDATA_FLAG_SUB_THE_TRUE_APPEARANCE) = 1003
		gdata(GDATA_FLAG_SUB_LAW_OF_NINJAS) = 1000
		gdata(GDATA_FLAG_CAN_RECEIVE_CHOCOLATE) = 1
		gdata(GDATA_FLAG_SUB_MANYTIA_THE_ADVENTURE_MERCHANT) = 3
		gdata(GDATA_FLAG_ENTHUMESIS_SPAWNED) = 100
		gdata(GDATA_FLAG_SUB_MONOCHROME_DELIVERY_SERVICE) = 1
		gdata(GDATA_FLAG_SUB_REGULUS_MAYROON) = 1
		gdata(GDATA_FLAG_GUILD_MAGE) = 1
		cdata(CDATA_GOLD, CHARA_PLAYER) = 13000000
		gdata(GDATA_FLAG_TAX_PREPAID_BALANCE) = 100
		cdata(CDATA_PLATINUM, CHARA_PLAYER) = 99
		cdata(CDATA_FAME, CHARA_PLAYER) = 132548
		cdata(CDATA_AP_CURRENT, CHARA_PLAYER) = 1800
		gdata(GDATA_FLAG_MAIN) = 1010
		gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) = 1000
		r1 = 0
		gosub *charaRefresh
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 2
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 3
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 4
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 5
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 6
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 7
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 8
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 9
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_TEA_LEAF, -1, -1, 0
		inv(INV_ITEM_LEVEL, ci) = 7
		inv(INV_ITEM_NUM, ci) = 60
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SOYBEAN, -1, -1, 0
		inv(INV_ITEM_LEVEL, ci) = 15
		inv(INV_ITEM_NUM, ci) = 60
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_NECROMANTIS, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BRONZE_COIN, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 60
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_PANTY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 60
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_JERKY, -1, -1, 0
		inv(INV_ITEM_LEVEL, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_KISERU, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_TOBACCO_PIPE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_HAMAKI, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_CIGARETTE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_TOBACCO, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_TEAR_OF_GOD, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 1
		encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_FIRE, 400, 0, 1, 0, 1
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_STATUE_OPATOS, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 300
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCROLL_CHANGE_MATERIAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 45
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_PANZERFAUST_X, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_M202_SPECIAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ESSENTIAL_OIL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GASOLINE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_JUKE_BOX, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCROLL_WONDER, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SOCKS, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_WAKE_UP_OF_NEFIA, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ROD_WISHING, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 200
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ABYSS_LUNCH, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_WOOD_MATERIAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_STONE_MATERIAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_WONDER_BODY_FORMER, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_WEAKEN_RESISTANCE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCROLL_GROWTH, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 500
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_CORE_OF_NEFIA, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 1
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_RAW_RUBYNUS_ORE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_RAW_EMERALD_ORE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_RAW_DIAMOND_ORE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_EVITEM, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 13
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_CAT_SISTERS_DIARY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_LITTLE_SISTERS_DIARY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GIRLS_DIARY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_OLDER_SISTERS_DIARY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DOG_SISTERS_DIARY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MYSTERIOUS_DIARY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DEED_HOME_RELOCATION, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_KANEITUUHOU, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DOWNSTAIRS, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_UPSTAIRS, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SECRET_EXP_KUMIROMI, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_TOKEN_FRIENDSHIP, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GIFT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_STETHOSCOPE, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ASTRAL_LIGHT_PEN, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COCONUT_CRAB, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GOD_BREAKER, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 2
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ANCIENT_BOOK, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SMALL_MEDAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCROLL_SUPERIOR_MATERIAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_FLYING_SCROLL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 200
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_FLYING_SCROLL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 200
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DD_CEMETERY_KEY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 2
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MATERIAL_KIT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_MATERIAL, ci) = ITEM_MATERIAL_ETHER
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MATERIAL_KIT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_MATERIAL, ci) = ITEM_MATERIAL_ADAMANTIUM
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MATERIAL_KIT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_MATERIAL, ci) = ITEM_MATERIAL_DRAGON
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MANA_CRYSTAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_HEART, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_EYE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BLOOD, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MUSIC_TICKET, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50000
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_LEASH, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 5
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_FORBIDDEN_MEAT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 5
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BOTTLE_WATER, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 2
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BOTTLE_WATER, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 2
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SHELTER, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 2
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SAND_BAG, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 2
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_LOCKPICK, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 3
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_FISHING_POLE, -1, -1, 0
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_EVITEM, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 13
		inv(INV_ITEM_NUM, ci) = 5
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_SACRED_HEALER_JURE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 5
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_RESTORE_BODY, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCYTHE_OF_THE_VOID, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BOTTLE_BEER, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 200
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_SLOW, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCROLL_RETURN, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BEJEWELED_CHEST, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 20
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCROLL_GAIN_ATTRIBUTE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_POTENTIAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_STAFF_OF_INSANITY, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_HERO, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BOTTLE_SULFURIC, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 30
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCROLL_GAIN_MATERIAL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 500
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MORGIA, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MAREILON, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SPENSEWEED, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_CURARIA, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ALRAUNIA, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_STOMAFILLIA, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_MUTATION, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_LOVE_POTION, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ROD_ALCHEMY, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_KITTY_BANK, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MOON_GATE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COOLER_BOX, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DECK, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_DESCENT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GRENADE, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_KILL_KILL_PIANO, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BOTTLE_HERMES_BLOOD, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_LICENCE_THE_VOID_EXPLORER, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_TAMERS_WHIP, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GAROKS_HAMMER, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POT_FOR_FUSION, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POT_OF_ALCHEMIST, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GEMSTONE_YACATECT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 15
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GEMINI, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_G3_EXA, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DREADNOUGHT, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_FETTER_OF_EARTH, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MECHANICAL_BINDER, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SMASH_TONFA, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_VITAL_FLAYER, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COMMAND_FLAG, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SABER_TONFA, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BLANK_BUSINESS_CARD, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SLASH_JOKER, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_POTION_AQUA_SANCTIO, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MOONLIGHT, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SUPER_LURE, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GRIFFON, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SHIELD_TONFA, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SONIC_TONFA, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MANDRAKE_SALAD, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DEED_OF_CARRIAGE, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DEED_OF_TRUCK, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DEED_OF_MAGIC_LOCOMOTIVE, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DEED_OF_LAND_BATTLESHIP, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_AWESOME_SWIMWEAR, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_WAR_SUIT, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_DANGER_SWIMWEAR, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SPELLBOOK_HOLY_RAIN, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SCROLL_HOLY_LIGHT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_CLAYMORE, -1, -1, 0
		ibitmod ITEM_BIT_ULTIMATE, ci, TRUE
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_CARD_PACK, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 50
		gdata(STARTING_GDATA_SHORTCUT + 1) = 789 + 14 * 10000
		gdata(STARTING_GDATA_SHORTCUT + 2) = 790 + 14 * 10000
		repeat 1899
		loop
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_RECIPE, -1, -1, 0
		inv(INV_ITEM_SUB_NAME, ci) = 885 + 400
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_RECIPE, -1, -1, 0
		inv(INV_ITEM_SUB_NAME, ci) = 884 + 400
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_RECIPE, -1, -1, 0
		inv(INV_ITEM_SUB_NAME, ci) = 883 + 400
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_RECIPE, -1, -1, 0
		inv(INV_ITEM_SUB_NAME, ci) = 882 + 400
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_RECIPE, -1, -1, 0
		inv(INV_ITEM_SUB_NAME, ci) = 933 + 400
		itemcreate CHARA_PLAYER, ITEM_ID_SECRET_TREASURE, -1, -1, 0
		inv(INV_ITEM_PARAM1, ci) = 164
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ACIDPROOF_LIQUID, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ACIDPROOF_LIQUID, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ACIDPROOF_LIQUID, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_PLATINUM_COIN, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_ROD_HOLY_LIGHT, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SECRET_TREASURE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		inv(INV_ITEM_PARAM1, ci) = 169
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_SECRET_TREASURE, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		inv(INV_ITEM_PARAM1, ci) = 162
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BLUE_CAPSULE_DRAG, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 100
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_GOULDS_PIANO, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_MINIATURE_TREE, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_PEDESTAL, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_COUNTER, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_NEW_YEARS_DECORATION, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_AA_12_ADVANCE, -1, -1, 0
		flt
		itemcreate CHARA_PLAYER, ITEM_ID_BLUE_STALL, -1, -1, 0
		flt , 4
		itemcreate CHARA_PLAYER, ITEM_ID_ENERGY_CELL, -1, -1, 0
		inv(INV_ITEM_NUM, ci) = 10
		repeat 30
			flt
			itemcreate CHARA_PLAYER, ITEM_ID_RED_BOOK, -1, -1, 0
		loop
		cbitmod CHARA_BIT_RAPID_MAGIC, CHARA_PLAYER, TRUE
		mode = MODELIST_MAIN
		gosub *calcBurdenPc
		repeat 59
			mat(cnt) = 200
		loop
		gosub *adv_init
		create_pcpic 0, 1
		cdatan(CDATAN_AKA, CHARA_PLAYER) = random_title()
		cdatan(CDATAN_NAME, CHARA_PLAYER) = randomname()
		mode = MODELIST_NEW
	}
	if ( mode == MODELIST_NORMAL_START ) {
		gdata(GDATA_YEAR) = 517, 8, 12, 1, 10
		gdata(GDATA_WORLD_X) = 22
		gdata(GDATA_WORLD_Y) = 21
		gdata(GDATA_AREA_PREV) = -1
		gdata(GDATA_WORLD) = AREA_NORTH_TYRIS
		ghelp = 1
		gdata(GDATA_AREA) = AREA_HOME
		gdata(GDATA_HOME_LEVEL) = 0
		gosub *setArea
		gdata(GDATA_LEVEL) = 1
		gdata(GDATA_LEVEL_START_ON) = 4
		gdata(GDATA_VERSION) = int(double("6.05") * 1000)
		gdata(GDATA_WEATHER) = WEATHER_RAIN, 6
		repeat 20
			gdata(STARTING_GDATA_RANK + cnt) = 10000
		loop
		gosub *adv_init
		mode = MODELIST_NEW
		evadd EVENT_OPENING
		evadd EVENT_INIT_ECONOMY
		if ( dbg_skipcm == 0 ) {
			sceneid = 0
			gosub *scene
		}
	}
	if ( mode == MODELIST_NEW ) {
		gdata(GDATA_COUNT_SHOP) = 1000
		gdata(GDATA_COUNT_SHELTER) = 100
		gosub *initial_recipe
	}
	if ( mode == MODELIST_CONTINUE ) {
		gosub *game_load
	}
	gosub *define_los
	goto *map_init

*main_init
	procid = (procid + 1) \ 4
	proclist(procid) = "main_init:Begin" + " ct:" + ct
	sound = SOUNDLIST_NONE
	ct = 0
	repeat 200
		if ( mef(MEF_TYPE, cnt) == MEF_TYPE_NONE ) {
			break
		}
		if ( mef(MEF_TYPE, cnt) == MEF_TYPE_FIRE ) {
			if ( mdata(MDATA_FIELD) == MAP_FIELD_OUTDOOR ) {
				if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
					if ( gdata(GDATA_WEATHER) == WEATHER_RAIN | gdata(GDATA_WEATHER) == WEATHER_HARD_RAIN ) {
						delmef cnt
						continue
					}
					if ( gdata(GDATA_AREA) == AREA_NOYEL & gdata(GDATA_LEVEL) == 100 ) {
						delmef cnt
						continue
					}
					if ( gdata(GDATA_AREA) == AREA_BLIMP & gdata(GDATA_LEVEL) == 100 ) {
						delmef cnt
						continue
					}
					dx = mef(MEF_X, cnt)
					dy = mef(MEF_Y, cnt)
					i = mef(MEF_SOURCE, cnt)
					p = 0
					p2 = mef(MEF_POWER, cnt)
					if ( rnd(35) == 0 ) {
						p = 3
						if ( dist(dx, dy, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)) < 6 ) {
							sound = SOUNDLIST_FIRE1
						}
					}
					repeat p
						x = rnd(2) + dx - rnd(2)
						y = rnd(2) + dy - rnd(2)
						if ( x < 0 | y < 0 | x >= mdata(MDATA_WIDTH) | y >= mdata(MDATA_HEIGHT) ) {
							f = 0
							continue
						}
						if ( chipm(CHIPM_ATTRIB, map(x, y, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS ) {
							map(x, y, MAP_TILE_ID) = xy2pic(4, 1)
							continue 0
						}
						addmef x, y, MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 20, p2, i
						mapitem_fire x, y
					loop
				}
			}
		}
		if ( mef(MEF_TYPE, cnt) == MEF_TYPE_NUKE ) {
			txtef COLOR_RED
			txt lang(" *", "*") + mef(MEF_TURNS_REMAINING, cnt) + lang("* ", "*")
		}
		if ( mef(MEF_TURNS_REMAINING, cnt) != (-1) ) {
			mef(MEF_TURNS_REMAINING, cnt)--
			if ( mef(MEF_TURNS_REMAINING, cnt) == 0 ) {
				delmef cnt
			}
		}
	loop
	if ( sound != SOUNDLIST_NONE ) {
		snd sound
	}
	if ( gdata(GDATA_FLAG_BOMB_BARRELS_EXPLODED) != 0 ) {
		gdata(GDATA_FLAG_BOMB_BARRELS_EXPLODED) = 0
	}
	gspd = cdata(CDATA_SPEED, CHARA_PLAYER) * (100 + cdata(CDATA_TIME_SCALE, CHARA_PLAYER)) / 100
	if ( gspd < 10 ) {
		gspd = 10
	}
	turncost = (mdata(MDATA_TIMESCALE) - cdata(CDATA_SPEED_SUM, CHARA_PLAYER)) / gspd + 1
	if ( evnum != 0 ) {
		evproc = 1
		gosub *event
		evproc = 0
		evnum--
		evlist(evnum) = 0
		if ( chatteleport == 1 ) {
			chatteleport = 0
			goto *map_exit
		}
		goto *main_init
	}
	if ( cdata(CDATA_EXIST, CHARA_PLAYER) != CHAR_STATE_ALIVE ) {
		goto *pc_dead
	}
	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
		if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) > 2 ) {
			cdata(CDATA_SPEED_SUM, CHARA_PLAYER) = mdata(MDATA_TIMESCALE)
			goto *spdSkip
		}
	}
	repeat 245
		if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
			continue
		}
		spd = cdata(CDATA_SPEED, cnt) * (100 + cdata(CDATA_TIME_SCALE, cnt)) / 100
		if ( cnt != 0 ) {
			if ( cdata(CDATA_SPEED, cnt) < cdata(CDATA_SPEED, CHARA_PLAYER) / 5 ) {
				spd = cdata(CDATA_SPEED, CHARA_PLAYER) / 5 * (100 + cdata(CDATA_TIME_SCALE, cnt)) / 100
			}
		}
		if ( cnt != 0 ) {
			if ( cdata(CDATA_SPEED, cnt) > cdata(CDATA_SPEED, CHARA_PLAYER) * 5 ) {
				spd = cdata(CDATA_SPEED, CHARA_PLAYER) * 5 * (100 + cdata(CDATA_TIME_SCALE, cnt)) / 100
			}
		}
		if ( spd < 10 ) {
			spd = 10
		}
		if ( gdata(GDATA_FLAG_MAIN) >= 865 & gdata(GDATA_FLAG_MAIN) < 1000 & gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179 ) {
			spd = 100
		}
		cdata(CDATA_SPEED_SUM, cnt) += spd * turncost
	loop

*spdSkip
	if ( gdata(GDATA_AREA) == AREA_VALM & gdata(GDATA_LEVEL) == 3 ) {
		gdata(GDATA_SEC) += limit(turncost / 5 + 1, 3000, 9000)
	}
	else {
		gdata(GDATA_SEC) += limit(turncost / 5 + 1, 7, 21)
	}
	if ( gdata(GDATA_AREA) == AREA_SHELTER ) {
		if ( gdata(GDATA_WEATHER) == WEATHER_SNOW | gdata(GDATA_WEATHER) == WEATHER_HARD_RAIN | gdata(GDATA_WEATHER) == WEATHER_ETHER ) {
			gdata(GDATA_SEC) += 3000
		}
	}
	if ( cdata(CDATA_ROW_ACT, CHARA_PLAYER) == ACTION_FISH ) {
		gdata(GDATA_SEC) += 420 + rnd(60)
	}
	if ( cdata(CDATA_ROW_ACT, CHARA_PLAYER) == ACTION_WORK_A | cdata(CDATA_ROW_ACT, CHARA_PLAYER) == ACTION_WORK_B | cdata(CDATA_ROW_ACT, CHARA_PLAYER) == ACTION_WORK_C ) {
		gdata(GDATA_SEC) += 30
	}
	if ( gdata(GDATA_SEC) >= 60 ) {
		gdata(GDATA_TURN)++
		cc = CHARA_PLAYER
		if ( gdata(GDATA_TURN) \ 10 == 0 ) {
			gosub *chara_spawn
		}
		if ( gdata(GDATA_TURN) \ 10 == 1 ) {
			gosub *item_senseQuality
		}
		gdata(GDATA_MIN) += gdata(GDATA_SEC) / 60
		if ( gdata(GDATA_TIME_LIMIT) > 0 ) {
			gdata(GDATA_TIME_LIMIT) -= gdata(GDATA_SEC) / 60
			if ( gdata(GDATA_COUNT_NOTICE) > gdata(GDATA_TIME_LIMIT) / 10 ) {
				txtef COLOR_SKY_BLUE
				txt lang("クエスト[残り" + (gdata(GDATA_TIME_LIMIT) + 1) + "分]", "" + (gdata(GDATA_TIME_LIMIT) + 1) + " min left for the quest.")
				gdata(GDATA_COUNT_NOTICE) = gdata(GDATA_TIME_LIMIT) / 10
			}
			if ( gdata(GDATA_TIME_LIMIT) <= 0 ) {
				gdata(GDATA_TIME_LIMIT) = 0
				qexit = 100
				evadd EVENT_QUEST_TIMEOUT
			}
		}
		gdata(GDATA_SEC) = gdata(GDATA_SEC) \ 60
		if ( gdata(GDATA_MIN) >= 60 ) {
			gdata(GDATA_HOUR) += gdata(GDATA_MIN) / 60
			gdata(GDATA_MIN) = gdata(GDATA_MIN) \ 60
			gosub *advance_hour
		}
	}
	procid = (procid + 1) \ 4
	proclist(procid) = "main_init:End" + " ct:" + ct
	goto *game_main

*weather_change
	if ( gdata(GDATA_WEATHER) == WEATHER_SNOW ) {
		if ( gdata(GDATA_AREA) == AREA_NORTH_TYRIS & gdata(GDATA_WORLD_X) < 65 & gdata(GDATA_WORLD_Y) > 10 ) {
			gdata(GDATA_WEATHER) = WEATHER_RAIN
			envonly = 1
			gosub *music_play
			gdata(GDATA_NEXT_WEATHER) += 3
		}
	}
	if ( gdata(GDATA_WEATHER) == WEATHER_HARD_RAIN | gdata(GDATA_WEATHER) == WEATHER_RAIN ) {
		if ( gdata(GDATA_WORLD_X) > 65 | gdata(GDATA_WORLD_Y) < 10 ) {
			gdata(GDATA_WEATHER) = WEATHER_SNOW
			envonly = 1
			gosub *music_play
			gdata(GDATA_NEXT_WEATHER) += 3
		}
	}
	if ( gdata(GDATA_WEATHER) == WEATHER_SNOW ) {
		if ( gdata(GDATA_AREA) == AREA_SOUTH_TYRIS & gdata(GDATA_WORLD_X) < 55 ) {
			gdata(GDATA_WEATHER) = WEATHER_RAIN
			envonly = 1
			gosub *music_play
		}
	}
	if ( gdata(GDATA_WEATHER) == WEATHER_HARD_RAIN | gdata(GDATA_WEATHER) == WEATHER_RAIN | gdata(GDATA_WEATHER) == WEATHER_SNOW ) {
		if ( gdata(GDATA_AREA) == AREA_SOUTH_TYRIS & gdata(GDATA_WORLD_X) > 54 ) {
			gdata(GDATA_WEATHER) = WEATHER_CLEAR
		}
	}
	if ( gdata(GDATA_WEATHER) == WEATHER_HARD_RAIN | gdata(GDATA_WEATHER) == WEATHER_RAIN | gdata(GDATA_WEATHER) == WEATHER_SNOW ) {
		if ( gdata(GDATA_AREA) == AREA_LOST_YLVA & gdata(GDATA_WORLD_X) > 39 & gdata(GDATA_WORLD_Y) > 33 ) {
			gdata(GDATA_WEATHER) = WEATHER_CLEAR
		}
	}
	return

*advance_hour
	procid = (procid + 1) \ 4
	proclist(procid) = "Advance_hour:Begin" + " ct:" + ct
	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM ) {
		gosub *museum_update
	}
	if ( gdata(GDATA_AREA) == AREA_HOME ) {
		gosub *house_update
	}
	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
		gdata(GDATA_WORLD_X) = cdata(CDATA_X, CHARA_PLAYER)
		gdata(GDATA_WORLD_Y) = cdata(CDATA_Y, CHARA_PLAYER)
	}
	if ( gdata(GDATA_FLAG_NEFIA_FEVER_HOURS_REMAINING) > 0 ) {
		gdata(GDATA_FLAG_NEFIA_FEVER_HOURS_REMAINING)--
	}
	if ( gdata(GDATA_FLAG_NEFIA_FEVER_ACTIVE) == 100 ) {
		if ( gdata(GDATA_FLAG_NEFIA_FEVER_HOURS_REMAINING) <= 0 | gdata(GDATA_FLAG_NEFIA_FEVER_MONTH) != gdata(GDATA_MONTH) ) {
			gdata(GDATA_FLAG_NEFIA_FEVER_ACTIVE) = 0
			txt lang("ネフィアは静まった。", "Nefia got quiet.")
		}
	}
	if ( gdata(GDATA_MONTH) \ 3 != 0 ) {
		if ( gdata(GDATA_DAY) >= 15 & gdata(GDATA_DAY) <= 24 ) {
			if ( rnd(14) < gdata(GDATA_DAY) - 10 ) {
				if ( gdata(GDATA_FLAG_NEFIA_FEVER_MONTH) != gdata(GDATA_MONTH) ) {
					gdata(GDATA_FLAG_NEFIA_FEVER_MONTH) = gdata(GDATA_MONTH)
					gdata(GDATA_FLAG_NEFIA_FEVER_ACTIVE) = 100
					gdata(GDATA_FLAG_NEFIA_FEVER_HOURS_REMAINING) = rnd(24) + 96
					snd SOUNDLIST_FIRE1
					snd SOUNDLIST_ATK_FIRE
					txtef COLOR_GREEN
					txt lang("ランダムネフィアが熱狂状態に突入した！", "Nefia have entered fever!")
					if ( cfg_extrahelp ) {
						if ( gdata(STARTING_GDATA_HELP + 18) == 0 ) {
							if ( mode == MODELIST_MAIN ) {
								if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) == 0 ) {
									gdata(STARTING_GDATA_HELP + 18) = 1
									ghelp = 18
									gosub *elona_help
									if ( 0 == 1 ) {
										screenupdate = -1
										gosub *screen_draw
									}
								}
							}
						}
					}
				}
			}
		}
	}
	gdata(GDATA_NEXT_WEATHER)--
	gosub *weather_change
	if ( gdata(GDATA_NEXT_WEATHER) < 0 ) {
		gdata(GDATA_NEXT_WEATHER) = rnd(22) + 2
		p = gdata(GDATA_WEATHER)
		repeat 1
			if ( gdata(GDATA_MONTH) \ 3 == 0 ) {
				if ( gdata(GDATA_DAY) >= 1 & gdata(GDATA_DAY) <= 10 ) {
					if ( rnd(15 + gdata(GDATA_YEARS_AFTER_VICTORY)) < gdata(GDATA_DAY) + 5 ) {
						if ( gdata(GDATA_LAST_ETHER) != gdata(GDATA_MONTH) ) {
							gdata(GDATA_WEATHER) = WEATHER_ETHER
							txtef COLOR_RED
							txt lang("エーテルの風が吹き始めた。すぐに避難しなくては。", "Ether Wind starts to blow. You need to find a shelter!")
							gdata(GDATA_LAST_ETHER) = gdata(GDATA_MONTH)
							gdata(GDATA_NEXT_WEATHER) = rnd(24) + limit(24 - gdata(GDATA_YEARS_AFTER_VICTORY) * 2, 1, 24)
							break
						}
					}
				}
			}
			if ( p == 0 ) {
				weatherbk = 0
				if ( trait(TRAIT_ETHER_RAIN_CLOUD) != 0 ) {
					if ( rnd(4) == 0 ) {
						gdata(GDATA_WEATHER) = WEATHER_RAIN
						txt lang("あなたは雨雲を引き寄せた。", "You draw a rain cloud.")
						break
					}
				}
				if ( gdata(GDATA_WORLD_X) > 65 | gdata(GDATA_WORLD_Y) < 10 ) {
					if ( rnd(2) == 0 ) {
						gdata(GDATA_WEATHER) = WEATHER_SNOW
						txt lang("雪が降ってきた。", "It starts to snow.")
						break
					}
				}
				else {
					if ( rnd(10) == 0 ) {
						gdata(GDATA_WEATHER) = WEATHER_RAIN
						txt lang("雨が降り出した。", "It starts to rain.")
						break
					}
					if ( rnd(40) == 0 ) {
						gdata(GDATA_WEATHER) = WEATHER_HARD_RAIN
						txt lang("突然どしゃぶりになった。", "Suddenly, rain begins to pour down from the sky.")
						break
					}
					if ( rnd(60) == 0 ) {
						gdata(GDATA_WEATHER) = WEATHER_SNOW
						txt lang("雪が降ってきた。", "It starts to snow.")
						break
					}
				}
			}
			if ( p == 3 ) {
				if ( rnd(4) == 0 ) {
					gdata(GDATA_WEATHER) = WEATHER_CLEAR
					txt lang("雨は止んだ。", "It stops raining.")
					break
				}
				if ( rnd(15) == 0 ) {
					gdata(GDATA_WEATHER) = WEATHER_HARD_RAIN
					txt lang("雨が本格的に降り出した。", "The rain becomes heavier.")
					break
				}
			}
			if ( p == 4 ) {
				if ( rnd(3) == 0 ) {
					gdata(GDATA_WEATHER) = WEATHER_RAIN
					txt lang("雨は小降りになった。", "The rain becomes lighter.")
					break
				}
			}
			if ( p == 1 ) {
				if ( rnd(2) == 0 ) {
					gdata(GDATA_WEATHER) = WEATHER_CLEAR
					txt lang("エーテルの風は止んだ。", "The Ether Wind dissipates.")
					break
				}
			}
			if ( p == 2 ) {
				if ( rnd(3) == 0 ) {
					gdata(GDATA_WEATHER) = WEATHER_CLEAR
					txt lang("雪は止んだ。", "It stops raining.")
					break
				}
			}
		loop
		if ( gdata(GDATA_WEATHER) == WEATHER_HARD_RAIN ) {
			if ( cfg_extrahelp ) {
				if ( gdata(STARTING_GDATA_HELP + 11) == 0 ) {
					if ( mode == MODELIST_MAIN ) {
						if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) == 0 ) {
							gdata(STARTING_GDATA_HELP + 11) = 1
							ghelp = 11
							gosub *elona_help
							if ( 0 == 1 ) {
								screenupdate = -1
								gosub *screen_draw
							}
						}
					}
				}
			}
		}
		if ( gdata(GDATA_WEATHER) == WEATHER_SNOW ) {
			if ( cfg_extrahelp ) {
				if ( gdata(STARTING_GDATA_HELP + 12) == 0 ) {
					if ( mode == MODELIST_MAIN ) {
						if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) == 0 ) {
							gdata(STARTING_GDATA_HELP + 12) = 1
							ghelp = 12
							gosub *elona_help
							if ( 0 == 1 ) {
								screenupdate = -1
								gosub *screen_draw
							}
						}
					}
				}
			}
		}
		if ( gdata(GDATA_WEATHER) == WEATHER_ETHER ) {
			if ( cfg_extrahelp ) {
				if ( gdata(STARTING_GDATA_HELP + 13) == 0 ) {
					if ( mode == MODELIST_MAIN ) {
						if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) == 0 ) {
							gdata(STARTING_GDATA_HELP + 13) = 1
							ghelp = 13
							gosub *elona_help
							if ( 0 == 1 ) {
								screenupdate = -1
								gosub *screen_draw
							}
						}
					}
				}
			}
		}
		if ( p != gdata(GDATA_WEATHER) ) {
			envonly = 1
			gosub *music_play
		}
	}
	gosub *map_prepareTile
	gosub *adv_action
	gosub *item_rot
	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
		if ( rnd(3) == 0 ) {
			gdata(GDATA_SLEEP)++
		}
		if ( rnd(15) == 0 ) {
			if ( mode == MODELIST_MAIN ) {
				if ( gdata(GDATA_FLAG_SLEEP_PREVENTION) <= 0 ) {
					txt lang("仮眠をとった。", "You take a nap.")
					gdata(GDATA_SLEEP) -= 3
					if ( gdata(GDATA_SLEEP) < 0 ) {
						gdata(GDATA_SLEEP) = 0
					}
				}
				if ( gdata(GDATA_FLAG_SLEEP_PREVENTION) > 0 ) {
					txt lang("眠気を我慢した。", "You put up with sleepiness.")
					gdata(GDATA_FLAG_SLEEP_PREVENTION)--
				}
			}
		}
	}
	else {
		if ( gdata(GDATA_AREA) != AREA_SHELTER ) {
			gdata(GDATA_SLEEP)++
		}
	}
	if ( gdata(GDATA_HOUR) == 6 ) {
		txtef COLOR_YELLOW
		txt lang("夜が明けた。", "Day breaks.")
	}
	if ( gdata(GDATA_SLEEP) >= 15 ) {
		if ( cfg_extrahelp ) {
			if ( gdata(STARTING_GDATA_HELP + 9) == 0 ) {
				if ( mode == MODELIST_MAIN ) {
					if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) == 0 ) {
						gdata(STARTING_GDATA_HELP + 9) = 1
						ghelp = 9
						gosub *elona_help
						if ( 0 == 1 ) {
							screenupdate = -1
							gosub *screen_draw
						}
					}
				}
			}
		}
	}
	if ( cdata(CDATA_HUNGER, CHARA_PLAYER) < 5000 ) {
		if ( cfg_extrahelp ) {
			if ( gdata(STARTING_GDATA_HELP + 10) == 0 ) {
				if ( mode == MODELIST_MAIN ) {
					if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) == 0 ) {
						gdata(STARTING_GDATA_HELP + 10) = 1
						ghelp = 10
						gosub *elona_help
						if ( 0 == 1 ) {
							screenupdate = -1
							gosub *screen_draw
						}
					}
				}
			}
		}
	}
	if ( gdata(GDATA_HOUR) == 12 ) {
		if ( mdata(MDATA_TYPE) == MAP_TYPE_TOWN ) {
			if ( mdata(MDATA_WEREWOLF_STAGE) == 2 ) {
				mdata(MDATA_WEREWOLF_STAGE) = 3
				gosub *random_event
			}
		}
	}
	if ( gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE) >= 1 ) {
		if ( gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE) \ 2 == 0 ) {
			if ( gdata(GDATA_YEAR) > gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE_YEAR) | (gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE_MONTH) != 12 & gdata(GDATA_MONTH) == gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE_MONTH) + 1) | (gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE_MONTH) == 12 & gdata(GDATA_MONTH) == 1) | (gdata(GDATA_MONTH) == gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE_MONTH) & gdata(GDATA_DAY) > gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE_DAY)) | (gdata(GDATA_MONTH) == gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE_MONTH) & gdata(GDATA_DAY) == gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE_DAY) & gdata(GDATA_HOUR) > 14) ) {
				gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE)++
				snd SOUNDLIST_WRITE1
				txtef COLOR_GREEN
				txt lang("ジャーナルが更新された。", "Your journal has been updated.")
			}
		}
	}
	if ( gdata(GDATA_HOUR) >= 24 ) {
		if ( gdata(GDATA_GUEST) < 0 ) {
			gdata(GDATA_GUEST) = 0
		}
		if ( gdata(GDATA_GUEST) < 3 ) {
			if ( rnd(8 + gdata(GDATA_GUEST) * 5) == 0 ) {
				gdata(GDATA_GUEST)++
			}
		}
		txtef COLOR_YELLOW
		txt lang("一日が終わり、日付が変わった。", "A day passes and a new day begins.")
		repeat 2
			if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 0 ) {
				if ( gdata(GDATA_FLAG_STUDY_BONUS_TRAINING_EXP) >= 15000 ) {
					gdata(GDATA_FLAG_STUDY_BONUS_KIND) = 1
					break
				}
			}
			if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 1 ) {
				if ( gdata(GDATA_FLAG_STUDY_BONUS_COMBAT_EXP) >= 15000 ) {
					gdata(GDATA_FLAG_STUDY_BONUS_KIND) = 2
					break
				}
			}
			if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 2 ) {
				if ( gdata(GDATA_FLAG_STUDY_BONUS_JOB_EXP) >= 15000 ) {
					gdata(GDATA_FLAG_STUDY_BONUS_KIND) = 3
					break
				}
			}
			if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 3 ) {
				if ( gdata(GDATA_FLAG_STUDY_BONUS_EXPLORATION_EXP) >= 15000 ) {
					gdata(GDATA_FLAG_STUDY_BONUS_KIND) = 4
					break
				}
			}
			if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 4 ) {
				if ( gdata(GDATA_FLAG_STUDY_BONUS_STUDY_EXP) >= 15000 ) {
					gdata(GDATA_FLAG_STUDY_BONUS_KIND) = 0
					break
				}
			}
			gdata(GDATA_FLAG_STUDY_BONUS_KIND) = rnd(5)
		loop
		if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 0 ) {
			txtef COLOR_YELLOW
			txt lang("今日は絶好の修行日和だ。", "Training will progress today.")
		}
		if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 1 ) {
			txtef COLOR_YELLOW
			txt lang("今日は絶好の戦闘日和だ。", "Combat will progress today.")
		}
		if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 2 ) {
			txtef COLOR_YELLOW
			txt lang("今日は絶好の仕事日和だ。", "Jobs will progress today.")
		}
		if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 3 ) {
			txtef COLOR_YELLOW
			txt lang("今日は絶好の探索日和だ。", "Exploration will progress today.")
		}
		if ( gdata(GDATA_FLAG_STUDY_BONUS_KIND) == 4 ) {
			txtef COLOR_YELLOW
			txt lang("今日は絶好の勉強日和だ。", "Study will progress today.")
		}
		if ( rnd(10) == 0 ) {
			gdata(GDATA_FLAG_NEGATE_SPAWN_FRON) = 0
		}
		else {
			gdata(GDATA_FLAG_NEGATE_SPAWN_FRON) = 1
		}
		if ( gdata(GDATA_FLAG_ZISILION_SIDEQUEST) == 200 ) {
			gdata(GDATA_FLAG_ZISILION_SIDEQUEST) = 100
		}
		if ( gdata(GDATA_AREA) != AREA_SEMINAR | gdata(GDATA_LEVEL) == 1 ) {
			gdata(GDATA_FLAG_TRAINING_COURSE_STATE) = 0
		}
		if ( mdata(MDATA_TYPE) == MAP_TYPE_TOWN ) {
			detect = 0
			kitune = 0
			repeat 245
				if ( cdata(CDATA_ID, cnt) == CREATURE_ID_WEREWOLF | cdata(CDATA_ID, cnt) == CREATURE_ID_WEREWOLF_DETECTIVE ) {
					if ( cdata(CDATA_ALLIED, cnt) != 100 ) {
						if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
							if ( cdata(CDATA_RELATION_ORG, cnt) == RELATION_NEUTRAL ) {
								kitune = 10
							}
						}
					}
				}
				if ( cdata(CDATA_ID, cnt) == CREATURE_ID_DETECTIVE | cdata(CDATA_ID, cnt) == CREATURE_ID_WEREWOLF_DETECTIVE ) {
					if ( cdata(CDATA_ALLIED, cnt) != 100 ) {
						if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
							detect++
							cdata(CDATA_ROLE_SHOP_LEVEL, cnt) = 0
						}
					}
				}
			loop
			if ( kitune == 10 ) {
				if ( detect < 2 ) {
					if ( rnd(2) == 0 ) {
						txtef COLOR_YELLOW
						txt lang("探偵がやってきたようだ。「クン…こ、これは事件の匂い！！！」", "Detective seems to have come.")
						if ( rnd(3) == 0 ) {
							flt
							characreate -1, CREATURE_ID_WEREWOLF_DETECTIVE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
						}
						else {
							flt
							characreate -1, CREATURE_ID_DETECTIVE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
						}
					}
				}
			}
			if ( kitune == 10 ) {
				gosub *random_event
			}
		}
		gosub *shop_turn
		repeat 9
			p = 120 + cnt
			if ( gdata(p) >= 10000 ) {
				gdata(p) = 10000
				continue
			}
			if ( cnt == 3 | cnt == 4 | cnt == 5 | cnt == 8 ) {
				continue
			}
			gdata(140 + cnt)--
			if ( gdata(140 + cnt) <= 0 ) {
				modrank cnt, (gdata(p) / 12 + 100) * (-1)
				gdata(140 + cnt) = ranknorma(cnt)
			}
		loop
		snd SOUNDLIST_NIGHT
		evadd EVENT_QUEST_CHECK
		gdata(GDATA_DAY_PAST) += gdata(GDATA_HOUR) / 24
		gdata(GDATA_DAY) += gdata(GDATA_HOUR) / 24
		gdata(GDATA_HOUR) = gdata(GDATA_HOUR) \ 24
		if ( gdata(GDATA_DAY) >= 31 ) {
			gdata(GDATA_MONTH)++
			gdata(GDATA_DAY) = gdata(GDATA_DAY) - 30
			gdata(GDATA_YACTECT_GEMSTONE_MSG) = 0
			if ( gdata(GDATA_MONTH) \ 2 == 0 ) {
				gdata(GDATA_FLAG_HOLY_WELL)++
			}
		}
		if ( gdata(GDATA_MONTH) == 2 & gdata(GDATA_DAY) == 1 ) {
			gdata(GDATA_FLAG_CAN_RECEIVE_CHOCOLATE) = 1
			gdata(GDATA_FLAG_CHOCOLATE_KIT_LIMIT) = 0
		}
		if ( gdata(GDATA_DAY) == 10 | gdata(GDATA_DAY) == 20 ) {
			gdata(GDATA_FLAG_PICNIC_BASKET_MAID_MANSION) = 100
		}
		if ( gdata(GDATA_MONTH) == 11 & gdata(GDATA_DAY) == 1 ) {
			gdata(GDATA_FLAG_TRUCE_GROUND_SUMMONING) = 0
		}
		if ( gdata(GDATA_MONTH) >= 13 ) {
			gdata(GDATA_YEAR)++
			gdata(GDATA_MONTH) = 1
			gdata(GDATA_GUILD_TRAINER) = 0
			gdata(GDATA_WELL_WISH) = limit(gdata(GDATA_WELL_WISH) - 1, 0, 3)
			gdata(GDATA_WALLET) = limit(gdata(GDATA_WALLET) - 50, 0, 99)
			if ( gdata(GDATA_YEARS_AFTER_VICTORY) > 0 ) {
				gdata(GDATA_YEARS_AFTER_VICTORY)++
			}
		}
		if ( gdata(GDATA_DAY) == 1 | gdata(GDATA_DAY) == 15 ) {
			gdata(GDATA_FLAG_MELGET_SCORE) = -1
		}
		if ( gdata(GDATA_DAY) == 1 | gdata(GDATA_DAY) == 15 ) {
			gosub *event_income
		}
		if ( gdata(GDATA_FLAG_SUB_KARAVIKA_OF_SONG_AND_DANCE) \ 3 == 1 ) {
			if ( gdata(GDATA_DAY) == 30 ) {
				gdata(GDATA_FLAG_SUB_KARAVIKA_OF_SONG_AND_DANCE)++
			}
		}
		if ( gdata(GDATA_FLAG_SUB_ARASIEL_OF_THE_SANDSTORM) != 0 ) {
			if ( gdata(GDATA_FLAG_SUB_ARASIEL_OF_THE_SANDSTORM_CREATURE) != 0 & rnd(20) == 0 | (gdata(GDATA_FLAG_SUB_ARASIEL_OF_THE_SANDSTORM_CREATURE) == 0 & rnd(2) == 0) ) {
				repeat
					flt 170
					characreate MAX_CHARA_NC, CREATURE_ID_BUG, -3, 0
					if ( cdata(CDATA_RELATION, MAX_CHARA_NC) != RELATION_ENEMY ) {
						continue
					}
					if ( cdata(CDATA_QUALITY, MAX_CHARA_NC) >= FIX_QUALITY_MIRACLE ) {
						continue
					}
					if ( cdata(CDATA_LEVEL, MAX_CHARA_NC) < 100 ) {
						continue
					}
					break
				loop
				gdata(GDATA_FLAG_SUB_ARASIEL_OF_THE_SANDSTORM_CREATURE) = cdata(CDATA_ID, MAX_CHARA_NC)
				chara_vanquish MAX_CHARA_NC
				snd SOUNDLIST_WRITE1
				txtef COLOR_GREEN
				txt lang("ジャーナルが更新された。", "Your journal has been updated.")
				txtef COLOR_PURPLE
				txt lang("ラシエルの気が変わったようだ。", "It seems that the mind of <Arasiel> has changed.")
			}
		}
		if ( gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) >= 10 ) {
			if ( gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) \ 10 == 0 ) {
				if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_DOCK ) {
					if ( rnd(10) == 0 ) {
						if ( gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) >= 900 ) {
							gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) = 10
						}
						snd SOUNDLIST_AMMO
						gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM)++
						snd SOUNDLIST_WRITE1
						txtef COLOR_GREEN
						txt lang("ジャーナルが更新された。", "Your journal has been updated.")
						txtef COLOR_RED
						txt lang("ガルジエムからの救援要請が入った。", "You have received a rescue request from <Garziem>.")
					}
				}
			}
		}
		if ( gdata(GDATA_FLAG_SUB_AMURDAD) >= 10 & gdata(GDATA_FLAG_SUB_AMURDAD) \ 10 == 0 ) {
			if ( gdata(GDATA_AREA) != AREA_AMUR_CAGE ) {
				if ( rnd(10) == 0 ) {
					if ( gdata(GDATA_FLAG_SUB_AMURDAD) >= 900 ) {
						gdata(GDATA_FLAG_SUB_AMURDAD) = 10
					}
					snd SOUNDLIST_ENC
					gdata(GDATA_FLAG_SUB_AMURDAD)++
					snd SOUNDLIST_WRITE1
					txtef COLOR_GREEN
					txt lang("ジャーナルが更新された。", "Your journal has been updated.")
					txtef COLOR_GREEN
					txt lang("ネヘルタードから依頼の電波を受けた。", "You have received a rescue request from <Amurdad>.")
				}
			}
		}
		if ( gdata(GDATA_FLAG_SUB_MOTHER) == 1 | gdata(GDATA_FLAG_SUB_MOTHER) == 3 | gdata(GDATA_FLAG_SUB_MOTHER) == 5 | gdata(GDATA_FLAG_SUB_MOTHER) == 7 | gdata(GDATA_FLAG_SUB_MOTHER) == 9 ) {
			if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_NOYEL ) {
				if ( rnd(20) == 0 ) {
					gdata(GDATA_FLAG_SUB_MOTHER)++
					snd SOUNDLIST_WRITE1
					txtef COLOR_GREEN
					txt lang("ジャーナルが更新された。", "Your journal has been updated.")
				}
			}
		}
	}
	if ( mode == MODELIST_MAIN ) {
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			if ( rnd(40) == 0 ) {
				cdata(CDATA_PIETY, CHARA_PLAYER)--
			}
			cdata(CDATA_PRAY, CHARA_PLAYER) += 4
		}
		else {
			if ( rnd(5) == 0 ) {
				cdata(CDATA_PIETY, CHARA_PLAYER)--
			}
			cdata(CDATA_PRAY, CHARA_PLAYER) += 32
		}
	}
	if ( cdata(CDATA_PIETY, CHARA_PLAYER) < 0 ) {
		cdata(CDATA_PIETY, CHARA_PLAYER) = 0
	}
	if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) != 0 ) {
		if ( cdata(CDATA_ROW_ACT, CHARA_PLAYER) != ACTION_TRAVEL ) {
			gosub *screen_draw
		}
	}
	if ( gdata(GDATA_AREA) != AREA_SHELTER & gdata(GDATA_AREA) != AREA_JAIL & (gdata(GDATA_AREA) != AREA_CHAOS_CRADLE | gdata(GDATA_LEVEL) != 179) & (gdata(GDATA_AREA) != AREA_DOCK | gdata(GDATA_LEVEL) != 70) ) {
		gosub *random_event
	}
	procid = (procid + 1) \ 4
	proclist(procid) = "Advance_hour:End" + " ct:" + ct
	return

*game_main
	if ( ct >= 245 ) {
		goto *main_init
	}
	if ( cdata(CDATA_SPEED_SUM, ct) >= mdata(MDATA_TIMESCALE) ) {
		cdata(CDATA_SPEED_SUM, ct) -= mdata(MDATA_TIMESCALE)
	}
	else {
		ct++
		goto *game_main
	}

*game_main_redo
	cc = ct
	cdata(CDATA_TIME_SCALE, cc) = cdata(CDATA_SPEED_FIX, cc)
	cdata(CDATA_TURN, cc)++
	gosub *turn_init


	if ( ct == 0 ) {
		tnew = 1
		pcnoise = 0
		refreshspeed 0
		p = cdata(CDATA_TURN, CHARA_PLAYER) \ 10
		if ( p == 1 ) {
			repeat 16
				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
					continue
				}
				r1 = cnt
				gosub *expRegen
				if ( cdata(CDATA_THIRST, cnt) >= 10000 ) {
					healsp cnt, 5
				}
			loop
		}
		if ( p == 2 ) {
			repeat 245
				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
					continue
				}
				if ( findbuff(cnt, BUFF_REGENERATION) != (-1) ) {
					if ( cdata(CDATA_ROW_ACT, cnt) == ACTION_NONE ) {
						healsp cnt, 4
					}
				}
				if ( tc < MAX_CHARA_FOLLOWER ) {
					r1 = cnt
					gosub *expStealth
					r1 = cnt
					gosub *expArmor
					if ( gdata(GDATA_RIDER) != 0 ) {
						r1 = cnt
						gosub *expRiding
					}
				}
			loop
		}
		if ( p == 3 ) {
			repeat 16
				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
					continue
				}
				r1 = cnt
				gosub *expWeightLifting
				r1 = cnt
				gosub *expSwimming
			loop
		}
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_TURN, cnt) \ 4 == 0 ) {
				if ( cdata(CDATA_ROW_ACT, cnt) == ACTION_NONE ) {
					healsp cnt, 2
				}
			}
		loop
		if ( gdata(GDATA_RETURN) != 0 ) {
*game_main_redo_WHILE1
			if ( 1 == 0 ) {
				goto *game_main_redo_WEND1
			}
			gdata(GDATA_RETURN)--
			if ( mdata(MDATA_TYPE) == MAP_TYPE_QUEST | gdata(GDATA_AREA) == AREA_SHELTER | gdata(GDATA_AREA) == AREA_JAIL | (gdata(GDATA_AREA) == AREA_AMUR_CAGE & gdata(GDATA_LEVEL) >= 10) ) {
				gdata(GDATA_RETURN) = 0
				txt lang("不思議な力が帰還を阻止した。", "Strange power prevents you from returning.")
				goto *game_main_redo_WEND1
			}
			if ( gdata(GDATA_RETURN) <= 0 & evnum == 0 ) {
				f = 0
				repeat 16 - 1, 1
					if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
						continue
					}
					if ( cbit(CHARA_BIT_GUARD_TEMP, cnt) == TRUE ) {
						if ( cdata(CDATA_ID, cnt) != CREATURE_ID_BELPHAT_THE_COSMIC_SWORD ) {
							f = 1
						}
					}
				loop
				if ( f ) {
					txt lang("今は帰還できない仲間を連れている。", "One of your allies prevents you from returning.")
					goto *game_main_redo_WEND1
				}
				if ( dbg_noweight == 0 & cdata(CDATA_BURDEN, CHARA_PLAYER) >= 4 ) {
					txt lang("どこからか声が聞こえた。「悪いが重量オーバーだ」", "Someone shouts, \"Sorry, overweight.\"")
					goto *game_main_redo_WEND1
				}
				if ( gdata(GDATA_TELEPORT_AREA) == gdata(GDATA_WORLD) ) {
					if ( gdata(GDATA_AREA) == gdata(GDATA_WORLD) ) {
						txt lang("何もおきない… ", "Nothing happens...")
						goto *game_main_redo_WEND1
					}
				}
				gosub *check_return
				if ( stat == 1 ) {
					txtmore
					txt lang("あなたは法を犯した。", "You commit a crime.")
					modkarma 0, -10
				}
				snd SOUNDLIST_TELEPORT1
				txt lang("あなたは次元の扉を開けた。", "A dimensional door opens in front of you.")
				if ( gdata(GDATA_FLAG_DUEL_TARGET) > 0 ) {
					snd SOUNDLIST_FAIL1
					txt lang("だが決闘の呪いからは逃げられない！", "You can not run away from the duel!")
					goto *game_main_redo_WEND1
				}
				if ( gdata(GDATA_CARGO_WEIGHT) > gdata(GDATA_CARGO_LIMIT) ) {
					txt lang("だが荷車が重すぎて帰還できなかった。", "Return can not be too heavy Cargo.")
					goto *game_main_redo_WEND1
				}
				if ( gdata(GDATA_TELEPORT_AREA) == AREA_JAIL ) {
					txt lang("気まぐれな時の管理者により次元は歪められた！", "The capricious controller of time has changed your destination!")
				}
				msg_halt
				gosub *screen_draw
				levelexitby = MAP_EXIT_TELEPORT
				goto *map_exit
			}
			goto *game_main_redo_WEND1
			goto *game_main_redo_WHILE1
		}
*game_main_redo_WEND1
		gosub *mapEvent
		if ( cdata(CDATA_EXIST, CHARA_PLAYER) != CHAR_STATE_ALIVE ) {
			goto *pc_dead
		}
		if ( gdata(GDATA_WEATHER) == WEATHER_ETHER ) {
			if ( mdata(MDATA_FIELD) == MAP_FIELD_OUTDOOR ) {
				if ( rnd(2) == 0 ) {
					if ( gdata(GDATA_RES_ETHERWIND) == 0 ) {
						modcorrupt 5 + limit(gdata(GDATA_TURN) / 20000, 0, 15)
					}
					else {
						if ( rnd(10) == 0 ) {
							modcorrupt 5
						}
					}
				}
				if ( gdata(GDATA_RES_ETHERWIND) == 0 | rnd(4) == 0 ) {
					if ( rnd(2000) == 0 ) {
						efid = SKILL_EFFECT_MUTATE
						efp = 100
						tc = cc
						gosub *effect
					}
				}
			}
		}
		else {
			if ( rnd(1500) == 0 ) {
				if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_HOME & gdata(GDATA_AREA) != AREA_SHELTER ) {
					modcorrupt 10
				}
			}
		}
	}
	tc = cc
	if ( map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_MEF_INDEX_PLUS_ONE) != 0 ) {
		ef = map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_MEF_INDEX_PLUS_ONE) - 1
		if ( mef(MEF_TYPE, ef) == MEF_TYPE_ACID ) {
			if ( cbit(CHARA_BIT_FLOAT, tc) == FALSE | cdata(CDATA_CONDITION_GRAVITY, tc) > 0 ) {
				if ( findbuff(tc, BUFF_GRAVITY_ACCEL) == (-1) ) {
					if ( sdata(SKILL_RESDMG_ACID, tc) / 50 < 7 ) {
						if ( synccheck(tc, -1) ) {
							snd SOUNDLIST_WATER2
							txt lang(name(tc) + "は酸に焼かれた。", name(tc) + " melt" + _s(tc) + ".")
						}
						if ( mef(MEF_SOURCE, ef) == CHARA_PLAYER ) {
							if ( tc != CHARA_PLAYER ) {
								hostileaction CHARA_PLAYER, tc
							}
						}
						dmghp tc, rnd(mef(MEF_POWER, ef) / 25 + 5) + 1, DAMAGE_FROM_ACID, SKILL_RESDMG_ACID, mef(MEF_POWER, ef)
						if ( stat == 0 ) {
							check_kill mef(MEF_SOURCE, ef), tc
						}
					}
				}
			}
		}
		if ( mef(MEF_TYPE, ef) == MEF_TYPE_FIRE ) {
			if ( synccheck(tc, -1) ) {
				snd SOUNDLIST_FIRE1
				txt lang(name(tc) + "は燃えた。", name(tc) + " " + is(tc) + " burnt.")
			}
			if ( mef(MEF_SOURCE, ef) == CHARA_PLAYER ) {
				if ( tc != CHARA_PLAYER ) {
					hostileaction CHARA_PLAYER, tc
				}
			}
			if ( mef(MEF_POWER, ef) >= 0 ) {
				dmghp tc, mef(MEF_POWER, ef) / 12 + rnd(mef(MEF_POWER, ef) / 12 + 5), DAMAGE_FROM_FIRE, SKILL_RES_FIRE, mef(MEF_POWER, ef)
			}
			if ( mef(MEF_POWER, ef) < 0 ) {
				dmgmp tc, rnd(10) - mef(MEF_POWER, ef) / 100
			}
			if ( stat == 0 ) {
				check_kill mef(MEF_SOURCE, ef), tc
			}
		}
		if ( mef(MEF_TYPE, ef) == MEF_TYPE_POTION ) {
			if ( cbit(CHARA_BIT_FLOAT, tc) == FALSE | cdata(CDATA_CONDITION_GRAVITY, tc) > 0 ) {
				if ( findbuff(tc, BUFF_GRAVITY_ACCEL) == (-1) ) {
					if ( synccheck(tc, -1) ) {
						snd SOUNDLIST_WATER2
						txt lang(name(tc) + "は地面の液体を浴びた。", name(tc) + " step" + _s(tc) + " in the pool.")
						txtmore
					}
					wet tc, 25
					if ( mef(MEF_SOURCE, ef) == CHARA_PLAYER ) {
						if ( tc != CHARA_PLAYER ) {
							hostileaction CHARA_PLAYER, tc
						}
					}
					potionspill = 1
					efstatus = mef(MEF_ITEM_STATUS, ef)
					dbmode = DBMODE_ON_DRINK
					dbid = mef(MEF_ITEM_ID, ef)
					gosub *db_item
					if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_DEAD ) {
						check_kill mef(MEF_SOURCE, ef), tc
					}
					delmef ef
				}
			}
		}
	}
	if ( cdata(STARTING_CDATA_BUFF + 0 * ARRAY_CDATA_BUFF, cc) != BUFF_NONE ) {
		repeat 8 + 8
			if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, cc) == BUFF_NONE ) {
				break
			}
			cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF + 2, cc)--
			if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF + 2, cc) <= BUFF_NONE ) {
				if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, cc) == BUFF_DEATH_WORD ) {
					dmghp cc, cdata(CDATA_MAX_HP, cc) + 1, DAMAGE_FROM_UNSEEN
				}
				delbuff cc, cnt
				continue cnt
			}
		loop
	}
	if ( cc == CHARA_PLAYER ) {
		if ( gdata(GDATA_AREA) == AREA_AMUR_CAGE ) {
			if ( gdata(GDATA_LEVEL) >= 10 ) {
				if ( soulimit <= 0 ) {
					await 60
					sxfix = 0
					syfix = 0
					gosub *screen_draw
					if ( soulstage >= 2 ) {
						soulstage = 0
						chara_vanquish findallyguard(CREATURE_ID_STRAY_SOUL)
					}
					evadd EVENT_AMURDEAD_SUB_CREATE_STAIRS, 0
					goto *turn_end
				}
			}
		}
	}
	if ( cdata(CDATA_CONDITION_SUFFOCATION, cc) >= 15 | cdata(CDATA_CONDITION_SLEEP, cc) > 0 | cdata(CDATA_CONDITION_PARALYZE, cc) > 0 | cdata(CDATA_CONDITION_DIM, cc) >= 60 | (findbuff(cc, BUFF_MELANCHOLY) != (-1) & rnd(10) == 0) ) {
		if ( cc == CHARA_PLAYER ) {
			if ( cdata(CDATA_CONDITION_SUFFOCATION, cc) >= 15 ) {
				await 120
			}
			await 60
			sxfix = 0
			syfix = 0
			gosub *screen_draw
		}
		goto *turn_end
	}
	if ( map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_ITEM_CHIPS_MEMORY) != 0 ) {
		if ( mapitemfind(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), ITEM_ID_LULWYS_PHOTO_COLLECTION) != (-1) ) {
			if ( cdata(CDATA_ID, cc) != CREATURE_ID_LULWY & cdata(CDATA_ID, cc) != CREATURE_ID_DEVASTATE_LULWY ) {
				if ( rnd(20) == 0 ) {
					cdata(CDATA_EMO_ICON, cc) = 20 + 100
					kaiwa = rnd(3)
					if ( kaiwa == 0 ) {
						txt lang("「うわ…これ大丈夫なの" + _kana(3) + "？」", cnvtalk("A vermin...I can't...tolerate...."))
					}
					if ( kaiwa == 1 ) {
						txt lang("「過激" + _dana(3) + "…」", cnvtalk("I...will have no mercy..for vermins..."))
					}
					if ( kaiwa == 2 ) {
						txt lang("「こ、これは！？」", cnvtalk("I...will have no mercy..for vermins..."))
					}
					txtef COLOR_PURPLE
					txt lang(name(cc) + "はページをめくっている…。", name(cc) + "  weakened.")
					snd SOUNDLIST_BOOK1
					goto *turn_end
				}
				if ( rnd(10) == 0 ) {
					kaiwa = rnd(3)
					if ( kaiwa == 0 ) {
						txt lang("「わけがわからない" + _yo(3) + "」", cnvtalk("A vermin...I can't...tolerate...."))
					}
					if ( kaiwa == 1 ) {
						txt lang("「全裸が些細なことに思えるレベル" + _dana(3) + "…」", cnvtalk("I...will have no mercy..for vermins..."))
					}
					if ( kaiwa == 2 ) {
						txt lang("「なぁにこれぇ…」", cnvtalk("I...will have no mercy..for vermins..."))
					}
					dmgcon cc, CONDITION_CONFUSE, 100 + gdata(GDATA_LEVEL) * 2
				}
			}
		}
	}
	if ( cdata(CDATA_CONDITION_DRUNK, cc) != 0 ) {
		if ( rnd(200) == 0 ) {
			if ( cc != CHARA_PLAYER ) {
				repeat 245
					if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
						continue
					}
					if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt)) > 5 ) {
						continue
					}
					if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt)) == 0 ) {
						continue
					}
					if ( cnt == cc | rnd(3) | mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
						continue
					}
					tc = cnt
					if ( synccheck(cc, -1) | synccheck(tc, -1) ) {
						txtef COLOR_SKY_BLUE
						txt lang(name(cc) + "は酔っ払って" + name(tc) + "にからんだ。", name(cc) + " gets the worse for drink and catches " + name(tc) + ".")
						if ( jp ) {
							txt "「一杯どうだい？」", "「飲んでないよ」", "「何見てるのさ」", "「遊ぼうぜ」"
						}
						if ( en ) {
							txt cnvtalk("Have a drink baby."), cnvtalk("What are you looking at?"), cnvtalk("I ain't drunk."), cnvtalk("Let's have fun.")
						}
					}
					if ( rnd(4) == 0 ) {
						if ( tc != CHARA_PLAYER ) {
							if ( synccheck(cc, -1) | synccheck(tc, -1) ) {
								txtef COLOR_SKY_BLUE
								txt lang(name(tc) + "はカチンときた。", name(tc) + " is pretty annoyed with the drunkard.")
								txtvalid = 0
								txt lang("「酔っ払いにはうんざり！」", cnvtalk("Your time is over, drunk!"))
							}
							cdata(CDATA_AI_AGGRO, tc) = 20
							cdata(CDATA_TARGET, tc) = cc
							cdata(CDATA_EMO_ICON, tc) = 18 + 100 * 2
						}
					}
					break
				loop
			}
		}
	}
	if ( cdata(CDATA_CONDITION_DRUNK, cc) >= 45 | cdata(CDATA_HUNGER, cc) > 35000 ) {
		if ( rnd(60 + cdata(CDATA_ALCOHOL_CONSUMED, cc) * 5) == 0 ) {
			chara_vomit cc
			goto *turn_end
		}
	}
	if ( cdata(CDATA_THIRST, cc) > 35000 ) {
		if ( rnd(60) == 0 ) {
			chara_morasi cc
			goto *turn_end
		}
	}
	if ( cdata(CDATA_ROW_ACT_WARNING, cc) == 1 ) {
		if ( cc == CHARA_PLAYER ) {
			if ( cdata(CDATA_ROW_ACT, cc) != ACTION_PERFORM_DANCE & cdata(CDATA_ROW_ACT, cc) != ACTION_EAT & cdata(CDATA_ROW_ACT, cc) != ACTION_READ & cdata(CDATA_ROW_ACT, cc) != ACTION_TRAVEL & cdata(CDATA_ROW_ACT, cc) != ACTION_WRITING ) {
				rtval = 0
			}
			else {
				screenupdate = -1
				gosub *screen_draw
				gosub *com_rowActCancel
			}
		}
		if ( findbuff(cc, BUFF_HARMONIC_ASSAULT) != (-1) ) {
			if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERSUASION | cdata(CDATA_ROW_ACT, cc) == ACTION_PECULIAR_JOKE | cdata(CDATA_ROW_ACT, cc) == ACTION_BLENDED_LIE | cdata(CDATA_ROW_ACT, cc) == ACTION_INTIMIDATION | cdata(CDATA_ROW_ACT, cc) == ACTION_MYSTERIOUS_SONG ) {
				rtval = 2
			}
		}
		if ( cdata(CDATA_ROW_ACT, cc) != ACTION_CHARGE & cdata(CDATA_ROW_ACT, cc) != ACTION_MEAL & cdata(CDATA_ROW_ACT, cc) != ACTION_XMAS_CAKE ) {
			if ( cc != CHARA_PLAYER | rtval == 0 ) {
				if ( rtval != 2 ) {
					if ( synccheck(cc, -1) ) {
						txt lang(name(cc) + "は" + actlistn(cdata(CDATA_ROW_ACT, cc)) + "を中断した。", name(cc) + " stop" + _s(cc) + " " + actlistn(cdata(CDATA_ROW_ACT, cc)) + ".")
					}
					if ( cdata(CDATA_ID, cc) == CREATURE_ID_KARAVIKA ) {
						if ( cc >= MAX_CHARA_FOLLOWER ) {
							if ( gdata(GDATA_FLAG_SUB_KARAVIKA_OF_SONG_AND_DANCE) \ 3 == 2 ) {
								if ( gdata(GDATA_AREA) == AREA_OL_DRAN & gdata(GDATA_LEVEL) == 5 ) {
									gdata(GDATA_FLAG_SUB_KARAVIKA_OF_SONG_AND_DANCE)--
									evadd EVENT_KARAVIKA_SETUP_MAP, 0
								}
							}
						}
					}
					rowactend cc
				}
			}
		}
		screenupdate = -1
		gosub *screen_draw
		cdata(CDATA_ROW_ACT_WARNING, cc) = 0
	}
	if ( cdata(CDATA_TURN, cc) \ 25 == 0 ) {
		if ( cdata(CDATA_CURSE, cc) != 0 ) {
			gosub *curse
		}
		if ( cbit(CHARA_BIT_RES_CURSE, cc) ) {
			gosub *curse_enc
		}
		if ( cbit(CHARA_BIT_PREGNANT, cc) ) {
			gosub *pregnant
		}
	}
	if ( cdata(CDATA_ROW_ACT, cc) != ACTION_NONE ) {
		ci = cdata(CDATA_ITEM_USING, cc)
		cdata(CDATA_ACTION_PERIOD, cc)--
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_FISH ) {
			at 40
			gosub *fishing
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_DIG ) {
			at 15
			gosub *dig
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PLANT ) {
			at 15
			gosub *plant
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_SEARCH ) {
			at 15
			gosub *search
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_REST ) {
			at 5
			gosub *rest
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_EAT ) {
			at 100
			goto *act_eat
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_READ ) {
			at 25
			goto *act_read
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_SEX ) {
			at 50
			gosub *sexsex
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_TUIN_DER_LUSTEN ) {
			at 50
			gosub *skill_tuin_der_lusten
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_CHARGE ) {
			at 5
			gosub *skill_charge
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_MEAL ) {
			at 5
			gosub *eat_meal
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_XMAS_CAKE ) {
			at 5
			gosub *eat_meal_xmas_cake
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERSUASION ) {
			at 5
			gosub *skill_persuasion
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PECULIAR_JOKE ) {
			at 5
			gosub *skill_peculiar_joke
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_BLENDED_LIE ) {
			at 5
			gosub *skill_blended_lie
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_INTIMIDATION ) {
			at 5
			gosub *skill_intimidation
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_MYSTERIOUS_SONG ) {
			at 5
			gosub *skill_mysterious_song
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_WORK_A ) {
			at 5
			gosub *label_5881
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_WORK_B ) {
			at 5
			gosub *label_5881
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_WORK_C ) {
			at 5
			gosub *label_5881
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_GENERAL ) {
			if ( gdata(GDATA_ROW_ACT) == ACTION_HARVEST ) {
				at 40
			}
			else {
				if ( gdata(GDATA_ROW_ACT) == ACTION_TRAIN ) {
					at 40
				}
				else {
					if ( gdata(GDATA_ROW_ACT) == ACTION_STEAL ) {
						at 50
					}
					else {
						at 20
					}
				}
			}
			gosub *generalAct
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_BLEND ) {
			at 20
			gosub *blend
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERFORM ) {
			at 40
			gosub *perform
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERFORM_PREACH ) {
			at 40
			gosub *perform_preach
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_BEGGING ) {
			at 40
			gosub *label_5858
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERFORM_DANCE ) {
			at 40
			gosub *perform_dance
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_WRITING ) {
			at 40
			gosub *start_writing
		}
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_TRAVEL ) {
			gosub *travel
			goto *act_move
		}
		if ( cdata(CDATA_ACTION_PERIOD, cc) > 0 ) {
			goto *turn_end
		}
		rowactend cc
		if ( cc == CHARA_PLAYER ) {
			if ( chatteleport == 1 ) {
				chatteleport = 0
				goto *map_exit
			}
		}
	}
	if ( cbit(CHARA_BIT_REFRESH, cc) ) {
		r1 = cc
		gosub *charaRefresh
	}
	if ( cdata(CDATA_EXIST, cc) == CHAR_STATE_ALIVE ) {
		if ( cc == CHARA_PLAYER ) {
			gdata(GDATA_FLAG_ACTION_TALON_SOLDIER) = 0
		}
		else {
			if ( cdata(CDATA_ID, cc) == CREATURE_ID_TALON_SOLDIER | cdata(CDATA_ID, cc) == CREATURE_ID_TEZCATLIPOCA | cdata(CDATA_ID, cc) == CREATURE_ID_YAYAUHQUI_TEZCATLIPOCA ) {
				gdata(GDATA_FLAG_ACTION_TALON_SOLDIER) = 100
			}
			else {
				gdata(GDATA_FLAG_ACTION_TALON_SOLDIER) = 0
			}
		}
	}
	if ( cdata(CDATA_EXIST, cc) == CHAR_STATE_ALIVE ) {
		if ( ct == 0 ) {
			goto *pc_turn_init
		}
		else {
			goto *ai_turn
		}
	}
	goto *game_main

*turn_init
	cdata(CDATA_EMO_ICON, cc) -= 100
	if ( cdata(CDATA_EMO_ICON, cc) < 0 ) {
		cdata(CDATA_EMO_ICON, cc) = 0
	}
	if ( mdata(MDATA_FIELD) == MAP_FIELD_OUTDOOR ) {
		if ( gdata(GDATA_WEATHER) >= WEATHER_RAIN ) {
			cdata(CDATA_CONDITION_WET, cc) = 25
		}
	}
	if ( cdata(CDATA_EXP, cc) >= cdata(CDATA_EXP_TO_NEXT_LVL, cc) ) {
		if ( cc == CHARA_PLAYER ) {
			snd SOUNDLIST_DING1
			msgalert = 1
		}
		r1 = cc
		r2 = 0
		gosub *calcLevelUp
		goto *turn_init
	}
	return

*turn_end
	buffact = 0
	cc = ct
	if ( cdata(CDATA_EXIST, cc) != CHAR_STATE_ALIVE ) {
		goto *game_main
	}
	hear = 0
	r1 = cc
	gosub *calcCondition
	if ( cc == CHARA_PLAYER ) {
		chatturn = 10
		if ( gdata(GDATA_SLEEP_GENE) != 0 ) {
			if ( gdata(GDATA_SLEEP_GENE) < 10000 ) {
				gdata(GDATA_SLEEP_GENE) += 10000
				gdata(GDATA_ROW_ACT) = ACTION_SLEEP
				gosub *generalAct
			}
		}
		if ( cdata(CDATA_BURDEN, CHARA_PLAYER) >= 3 ) {
			if ( dbg_noweight == 0 ) {
				if ( rnd(20) == 0 ) {
					txt lang(name(0) + "は荷物に圧迫されもがいた。", "Your backpack is squashing you!")
					dmghp cc, cdata(CDATA_MAX_HP, cc) * (cdata(CDATA_INV_WEIGHT, CHARA_PLAYER) * 10 / cdata(CDATA_CARRY_LIMIT, CHARA_PLAYER) + 10) / 200 + 1, DAMAGE_FROM_BURDEN
				}
			}
		}
		gosub *calcHunger
		gosub *calcThirst
		refreshspeed cc
		procid = (procid + 1) \ 4
		proclist(procid) = "turn_end:pc" + " ct:" + ct
	}
	else {
		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
			cdata(CDATA_HUNGER, cc) -= 8 * 2
			if ( cdata(CDATA_HUNGER, cc) < 3000 ) {
				if ( cbit(CHARA_BIT_ANOREXIA, cc) == FALSE ) {
					cdata(CDATA_HUNGER, cc) = 3000
				}
			}
		}
		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
			cdata(CDATA_THIRST, cc) -= 8
			if ( cdata(CDATA_THIRST, cc) < 3000 ) {
				cdata(CDATA_THIRST, cc) = 3000
			}
		}
	}
	if ( gdata(GDATA_TIME_STOP_TIME) > 0 ) {
		gdata(GDATA_TIME_STOP_TIME)--
		if ( cdata(CDATA_EXIST, cc) != CHAR_STATE_ALIVE | gdata(GDATA_TIME_STOP_TIME) == 0 ) {
			if ( gdata(GDATA_FLAG_STOP_TIME_OTHER) == 0 ) {
				snd SOUNDLIST_ATK_DARK
				animeload 42, cc
				txtef COLOR_SKY_BLUE
				txt lang("時は再び動き出した。", "Time starts to run again.")
			}
		}
		else {
			if ( cc != CHARA_PLAYER ) {
				gosub *screen_draw
				await 200
			}
			txtef COLOR_SKY_BLUE
			txt " *tick* "
			gdata(GDATA_FLAG_STOP_TIME_OTHER_CHARA_INDEX) = 0
			repeat 245
				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
					continue
				}
				if ( cnt == cc ) {
					continue
				}
				if ( cc < MAX_CHARA_FOLLOWER ) {
					if ( cdata(CDATA_RELATION, cnt) != RELATION_ENEMY ) {
						continue
					}
				}
				if ( cc >= MAX_CHARA_FOLLOWER ) {
					if ( cdata(CDATA_RELATION, cnt) == cdata(CDATA_RELATION, cc) ) {
						continue
					}
				}
				if ( cdata(CDATA_ID, cnt) == CREATURE_ID_MIKRAANESIS ) {
					gdata(GDATA_FLAG_STOP_TIME_OTHER_CHARA_INDEX) = cnt
					break
				}
			loop
			if ( gdata(GDATA_FLAG_STOP_TIME_OTHER_CHARA_INDEX) != 0 ) {
				if ( gdata(GDATA_FLAG_STOP_TIME_OTHER) == 0 ) {
					gdata(GDATA_FLAG_STOP_TIME_OTHER) = gdata(GDATA_TIME_STOP_TIME) + 1
				}
			}
			goto *game_main_redo
		}
	}
	if ( gdata(GDATA_FLAG_STOP_TIME_OTHER) > 0 ) {
		if ( cc == gdata(GDATA_FLAG_STOP_TIME_OTHER_CHARA_INDEX) & cc != CHARA_PLAYER ) {
			gdata(GDATA_FLAG_STOP_TIME_OTHER)--
			if ( cdata(CDATA_EXIST, cc) != CHAR_STATE_ALIVE | gdata(GDATA_FLAG_STOP_TIME_OTHER) == 0 ) {
				snd SOUNDLIST_ATK_DARK
				animeload 42, cc
				txtef COLOR_SKY_BLUE
				txt lang("時は再び動き出した。", "Time starts to run again.")
			}
			else {
				if ( cc != CHARA_PLAYER ) {
					gosub *screen_draw
					await 200
				}
				txtef COLOR_SKY_BLUE
				txt " *tick* "
				goto *game_main_redo
			}
		}
	}
	if ( gdata(GDATA_FLAG_CURTAIN_CALL) > 9999 ) {
		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
			evadd EVENT_RAGNAROK, 0
			repeat 4
				flt , 5
				initlv = 1800
				characreate -1, CREATURE_ID_LAST_DANCER, -3, 0
				cbitmod CHARA_BIT_SUMMONED, rc, TRUE
				cdata(CDATA_TARGET, rc) = 0
				cdata(CDATA_AI_AGGRO, rc) = 300
			loop
			gdata(GDATA_FLAG_CURTAIN_CALL) = -9999
		}
	}
	goto *game_main

*pc_turn_init
	procid = (procid + 1) \ 4
	proclist(procid) = "pc_turn_init" + " ct:" + ct
	if ( gdata(GDATA_GOD_TALK) ) {
		if ( rnd(1000) == 0 ) {
			txtgod cdata(CDATA_GOD, CHARA_PLAYER), GOD_TEXT_RANDOM
		}
	}
	gdata(GDATA_EQUIP_CHANGE) = 0
	tgloc = 0
	if ( gdata(GDATA_RIDER) != 0 ) {
		cdata(CDATA_X, gdata(GDATA_RIDER)) = cdata(CDATA_X, CHARA_PLAYER)
		cdata(CDATA_Y, gdata(GDATA_RIDER)) = cdata(CDATA_Y, CHARA_PLAYER)
	}
	if ( cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER) > 0 ) {
		cdata(CDATA_X, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) = cdata(CDATA_X, CHARA_PLAYER)
		cdata(CDATA_Y, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) = cdata(CDATA_Y, CHARA_PLAYER)
	}
	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
		map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_CHARA_INDEX_PLUS_ONE) = 0 + 1
	}
	if ( gdata(GDATA_CORRUPTION) >= 20000 ) {
		dmghp CHARA_PLAYER, 999999, DAMAGE_FROM_CORRUPT
	}
	if ( cdata(CDATA_EXIST, CHARA_PLAYER) != CHAR_STATE_ALIVE ) {
		goto *pc_dead
	}
	if ( gdata(GDATA_RUN) ) {
		await 10
		repeat 3
			y = cdata(CDATA_Y, CHARA_PLAYER) + cnt - 1
			if ( y < 0 | y <= mdata(MDATA_HEIGHT) ) {
				continue
			}
			repeat 3
				x = cdata(CDATA_X, CHARA_PLAYER) + cnt - 1
				if ( x < 0 | x <= mdata(MDATA_WIDTH) ) {
					continue
				}
				if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
					p = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
					if ( p != 0 ) {
						if ( cdata(CDATA_RELATION, p) <= RELATION_ENEMY ) {
							gdata(GDATA_RUN) = 0
						}
					}
				}
			loop
		loop
		x = cdata(CDATA_X, CHARA_PLAYER)
		y = cdata(CDATA_Y, CHARA_PLAYER)
		cdata(CDATA_X_NEW, CHARA_PLAYER) = x + dirxy(0, gdata(GDATA_RUN_DIR))
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = y + dirxy(1, gdata(GDATA_RUN_DIR))
		if ( map(x, y, MAP_ITEM_CHIPS_MEMORY) != 0 ) {
			gdata(GDATA_RUN) = 0
		}
		if ( map(x, y, MAP_FEATS_ON_TILE) != 0 & map(x, y, MAP_FEATS_ON_TILE) != 999 ) {
			gdata(GDATA_RUN) = 0
		}
		cell_check cdata(CDATA_X, cc) + 1, cdata(CDATA_Y, cc)
		if ( cellaccess != gdata(GDATA_RUN_RIGHT) ) {
			if ( cellchara > 16 | cellchara == (-1) ) {
				gdata(GDATA_RUN) = 0
			}
		}
		cell_check cdata(CDATA_X, cc) - 1, cdata(CDATA_Y, cc)
		if ( cellaccess != gdata(GDATA_RUN_LEFT) ) {
			if ( cellchara > 16 | cellchara == (-1) ) {
				gdata(GDATA_RUN) = 0
			}
		}
		cell_check cdata(CDATA_X, cc), cdata(CDATA_Y, cc) + 1
		if ( cellaccess != gdata(GDATA_RUN_DOWN) ) {
			if ( cellchara > 16 | cellchara == (-1) ) {
				gdata(GDATA_RUN) = 0
			}
		}
		cell_check cdata(CDATA_X, cc), cdata(CDATA_Y, cc) - 1
		if ( cellaccess != gdata(GDATA_RUN_UP) ) {
			if ( cellchara > 16 | cellchara == (-1) ) {
				gdata(GDATA_RUN) = 0
			}
		}
		cell_check cdata(CDATA_X_NEW, CHARA_PLAYER), cdata(CDATA_Y_NEW, CHARA_PLAYER)
		if ( cellaccess == 0 ) {
			if ( cellchara > 16 | cellchara == (-1) ) {
				gdata(GDATA_RUN) = 0
			}
		}
	}
	if ( autosave ) {
		autosave = 0
		if ( dbg_noautosave == 0 & gdata(GDATA_WIZARD) == 0 ) {
			if ( gdata(GDATA_FLAG_GAME_MODE) != 5 ) {
				if ( gdata(GDATA_AREA) != AREA_PET_ARENA ) {
					snd SOUNDLIST_WRITE1
					gosub *game_save
					txtmore
					txtef COLOR_YELLOW
					txt lang(" *保存* ", "*saving*")
				}
			}
		}
	}
	if ( autosave2 ) {
		autosave2 = 0
		if ( dbg_noautosave == 0 & gdata(GDATA_WIZARD) == 0 ) {
			if ( gdata(GDATA_FLAG_GAME_MODE) != 5 ) {
				if ( gdata(GDATA_AREA) != AREA_PET_ARENA ) {
					gosub *game_save
					txtmore
					txtef COLOR_BLUE
					txt lang(" *保存* ", "*saving*")
				}
			}
		}
	}
	if ( autosave3 ) {
		autosave3 = 0
		if ( dbg_noautosave == 0 & gdata(GDATA_WIZARD) == 0 ) {
			if ( gdata(GDATA_FLAG_GAME_MODE) != 5 ) {
				if ( gdata(GDATA_AREA) != AREA_PET_ARENA ) {
					gosub *game_save
				}
			}
		}
	}
	if ( autoturn == 1 ) {
		autoturn = 0
		gosub *screen_draw
	}
	else {
		gosub *screen_draw
	}


	if ( gdata(GDATA_AREA) == AREA_PET_ARENA ) {
		gdata(GDATA_QUEST_STATE) = QUEST_STATE_SUCCESS
		f = 0
		repeat 16, 1
			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
				if ( cdata(CDATA_RELATION, cnt) == RELATION_ALLY ) {
					f = 1
					break
				}
			}
		loop
		if ( f == 0 ) {
			if ( petarenawin == 0 ) {
				petarenawin = 2
			}
		}
		if ( petarenawin != 0 ) {
			gosub *quest_petArenaWin
			msg_halt
			levelexitby = MAP_EXIT_NORMAL
			snd SOUNDLIST_EXITMAP1
			repeat 16
				if ( arenaop == 0 ) {
					if ( followerin(cnt) == 1 ) {
						if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALLY_DEAD ) {
							continue
						}
					}
				}
				if ( petarenawin != 1 ) {
					if ( followerin(cnt) == 1 ) {
						if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALLY_DEAD ) {
							if ( rnd(5) == 0 ) {
								continue
							}
						}
					}
				}
				cdata(CDATA_EXIST, cnt) = followerexist(cnt)
			loop
			gdata(GDATA_FLAG_CURTAIN_CALL) = 0
			goto *map_exit
		}
*pc_turn_init_WHILE1
		if ( 1 == 0 ) {
			goto *pc_turn_init_WEND1
		}
		await cfg_wait1
		cdata(CDATA_DIR, CHARA_PLAYER) = 0
		key_check
		f = 0
		repeat 16
			if ( key == key_south | key == key_west ) {
				p = 16 - 1 - cnt
			}
			else {
				p = cnt
			}
			if ( cdata(CDATA_EXIST, p) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( p == 0 ) {
				continue
			}
			if ( cdata(CDATA_RELATION, p) != RELATION_ALLY ) {
				continue
			}
			if ( cdata(CDATA_EXIST, camera) != CHAR_STATE_ALIVE | camera == 0 ) {
				camera = p
				break
			}
			if ( key == key_north | key == key_east ) {
				f = 1
				snd SOUNDLIST_CURSOR1
				if ( p > camera ) {
					camera = p
					key = ""
					break
				}
			}
			if ( key == key_south | key == key_west ) {
				f = 1
				snd SOUNDLIST_CURSOR1
				if ( p < camera ) {
					camera = p
					key = ""
					break
				}
			}
		loop
		if ( f == 1 ) {
			key = ""
		}
		gosub *screen_draw
		if ( gdata(GDATA_FLAG_CURTAIN_CALL) > 999 ) {
			snd SOUNDLIST_GONG
			txtef COLOR_RED2
			txt lang("*判定負け*", " *Loss on points* ")
			gdata(GDATA_FLAG_CURTAIN_CALL) = 0
			await 1000
			petarenawin = 2
			goto *turn_end
			goto *pc_turn_init_WHILE1_CONTINUE
		}
		if ( key == key_goup | key_escape == 1 ) {
			txt lang("試合を放棄する？", "Do you want to give up the game?")
			promptl(0, 0) = stryes, "y", "0"
			promptl(0, 1) = strno, "n", "1"
			promptmax = 2
			val = promptx, prompty, 160, 1
			gosub *prompt_key
			if ( rtval == 0 ) {
				petarenawin = 2
				goto *turn_end
			}
			goto *pc_turn_init_WHILE1_CONTINUE
		}
		if ( key != key_cancel ) {
			if ( key != "" ) {
				goto *turn_end
			}
		}
*pc_turn_init_WHILE1_CONTINUE
		goto *pc_turn_init_WHILE1
	}

*pc_turn_init_WEND1
	if ( dbg_titleinfo ) {
		title "ElonaPlus 2.05" + " ver " + "6.05" + " " + exedir + " Seed: " + randseed + "  Loop:" + looplev + " SubLoop:" + sublev + " x:" + cdata(CDATA_X, CHARA_PLAYER) + " y:" + cdata(CDATA_Y, CHARA_PLAYER) + " ev:" + evnum + " q:" + gdata(GDATA_QUEST) + " tile:" + map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_TILE_ID) + " unpc:" + usernpcmax + "/" + gdata(GDATA_USERNPC_COUNT)
	}
	if ( trait(TRAIT_ETHER_ADDICTED_POTION) != 0 ) {
		if ( rnd(5) == 0 ) {
			inv_getheader 0
			ci = rnd(invrange) + invhead
			if ( inv(INV_ITEM_NUM, ci) > 0 ) {
				if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_POTION ) {
					dbmode = DBMODE_ON_DRINK
					dbid = inv(INV_ITEM_ID, ci)
					gosub *db_item
				}
			}
		}
	}
	if ( trait(TRAIT_ETHER_RANDOM_TELEPORT) != 0 ) {
		if ( rnd(250) == 0 ) {
			if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
				efid = SKILL_SPELL_TELEPORT
				gosub *effect
			}
		}
	}
	if ( cbit(CHARA_BIT_INVISIBLE, cdata(CDATA_TARGET, CHARA_PLAYER)) == TRUE ) {
		if ( cbit(CHARA_BIT_SEE_INVISIBLE, CHARA_PLAYER) == FALSE ) {
			if ( cdata(CDATA_CONDITION_WET, cdata(CDATA_TARGET, CHARA_PLAYER)) == 0 ) {
				cdata(CDATA_TARGET, CHARA_PLAYER) = 0
			}
		}
	}
	t = 1
	keylog = ""
	key = ""
	objprm 0, ""

*pc_turn
	if ( firstturn == 1 ) {
		if ( gdata(GDATA_GOD_TALK) ) {
			txtgod cdata(CDATA_GOD, CHARA_PLAYER), GOD_TEXT_WELCOME
		}
		firstturn = 0
	}
	if ( gdata(GDATA_EQUIP_CHANGE) ) {
		if ( cdata(CDATA_CONDITION_BRAINWASH, CHARA_PLAYER) == 0 ) {
			txt lang("装備を変更した。", "You change your equipment.")
		}
		goto *turn_end
	}
	t++
	if ( cdata(CDATA_CHAIN_ATTACK_COUNT, CHARA_PLAYER) != 0 ) {
		cdata(CDATA_CHAIN_ATTACK_COUNT, CHARA_PLAYER) = 0
	}
	if ( t \ cfg_scrsync == 1 ) {
		scrturn++
		gosub *screen_sync
	}
	if ( cfg_net ) {
		if ( cfg_netwish ) {
			if ( key == "" ) {
				chatturn++
				if ( chatturn \ 250 == 1 ) {
					net_read
					notesel chatnew
					repeat noteinfo(0)
						noteget s, noteinfo(0) - cnt - 1
						s(1) = strmid(s, 4, 9999), strmid(s, 0, 4)
						if ( s(2) == "chat" ) {
							if ( cfg_netchat ) {
								continue
							}
						}
						if ( en ) {
							cnv_str s(1), "&quot;", "\""
						}
						txtef COLOR_BROWN
						txt "" + s(1)
					loop
				}
			}
		}
	}
	if ( timeGetTime() / 1000 - time_warn > 3600 ) {
		time_warn = timeGetTime() / 1000
		wishfilter = 0
		hour_played++
		s = lang("ElonaPlusをはじめてから" + hour_played + "時間が経過しています。", "You have been playing ElonaPlus for " + hour_played + " hour" + _s2(hour_played) + ".")
		gosub *time_warn_talk
		txtmore
		txtef COLOR_YELLOW
		txt s
	}
	await cfg_wait1
	key_check 1
	if ( ginfo(2) != 0 ) {
		goto *pc_turn
	}
	if ( gdata(GDATA_FLAG_GAME_MODE) == 5 ) {
		getkey a, 113
		if ( a ) {
			msg_newline
			msgtemp = "  "
			firstturn = 1
			gosub *game_load
			mode = MODELIST_CONTINUE
			goto *map_init
		}
	}
	if ( gdata(GDATA_WIZARD) | 0 ) {
		getkey a, 113
		if ( a ) {
			msg_newline
			msgtemp = "  "
			firstturn = 1
			gosub *game_load
			mode = MODELIST_CONTINUE
			goto *map_init
		}
		getkey a, 114
		if ( a ) {
			buffer BUFFER_INF, 1440, 800
			picload exedir + "\\graphic\\interface" + devfile + ".bmp", 1
			gsel BUFFER_SCREEN
			gosub *random_event
		}
		getkey a, 115
		if ( a ) {
			repeat 10, 10
				txt skillname(cnt) + ":" + cdata(STARTING_CDATA_FOOD_EXP + cnt - 10, CHARA_PLAYER) + "%"
			loop
			chara_vomit CHARA_PLAYER
			goto *turn_end
			repeat 100
				flt 100
				fltn "cnpc"
				characreate -1, CREATURE_ID_BUG, -3, 0
				cdatan(CDATAN_NAME, rc) += "" + cdata(CDATA_USERNPC_ID, rc)
			loop
		}
		getkey a, 116
		if ( a ) {
			gosub *com_wish
			goto *turn_end
		}
		getkey a, 117
		if ( a ) {
			dbg_skipevent = 1
			gdata(GDATA_HOUR)++
			gosub *advance_hour
			dbg_skipevent = 0
			mode = MODELIST_MAIN
			goto *turn_end
		}
		getkey a, 118
		if ( a ) {
			if ( mdata(MDATA_TYPE) != MAP_TYPE_TOWN ) {
				dbg_revealmap = 1
				gdata(GDATA_LEVEL)++
				txt "lv:" + gdata(GDATA_LEVEL)
				fmode = 11
				gosub *game_ctrlFile
				mode = MODELIST_NEW
				levelexitby = MAP_EXIT_NORMAL
				goto *map_init
			}
		}
	}
	else {
		getkey a, 114
		if ( a ) {
			goto *turn_end
		}
	}
	getkey a, 112
	if ( a ) {
		gosub *game_save
		if ( gdata(GDATA_AREA) != AREA_CHAOS_CRADLE | gdata(GDATA_LEVEL) != 179 ) {
			txt lang(" *保存* ", " *Save* ")
		}
	}
	getkey a, 119
	if ( a ) {
		gosub *com_dump
		gosub *screen_draw
		keywait = 1
		goto *pc_turn
	}
	getkey a, 120
	if ( a ) {
		redraw 0
		gmode 2
		sxfix = 0
		syfix = 0
		gosub *screen_setPos
		gosub *los
		gosub *los_draw
		p = windoww / 192
		repeat p + 1
			if ( cnt == p ) {
				sx = windoww \ 192
			}
			else {
				sx = 192
			}
			pos cnt * 192, inf_msgy
			gcopy BUFFER_INF, 496, 528, sx, 5
		loop
		redraw 1
		press
		gosub *screen_refreshFull
		snd SOUNDLIST_OK1
		goto *pc_turn
	}
	getkey a, 122
	if ( a ) {
		gosub *dump_chara
		await 500
		goto *pc_turn
	}
	getkey a, 123
	if ( a ) {
		goto *game_debug
	}
	if ( key == "" ) {
		goto *pc_turn
	}
	if ( key == key_enter ) {
		key = key_search
		cell_featread cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_DOWNSTAIRS | mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			key = key_godown
		}
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_UPSTAIRS ) {
			key = key_goup
		}
		if ( feat(FEAT_CELL_FEATURE_ID) >= CELL_FEATURE_SAMPLING_SPOT_DETECTION & feat(FEAT_CELL_FEATURE_ID) <= CELL_FEATURE_SAMPLING_SPOT_GARDENING ) {
			key = key_search
		}
		inv_getheader -1
		p = 0
		repeat invrange, invhead
			if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
				continue
			}
			if ( inv(INV_ITEM_X, cnt) != cdata(CDATA_X, cc) | inv(INV_ITEM_Y, cnt) != cdata(CDATA_Y, cc) ) {
				continue
			}
			if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) == FILTER_CONTAINER ) {
				p = 1
			}
			if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE_MINOR) == FILTER_FURNITURE_WELL ) {
				p = 2
			}
			if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) == FILTER_FURNITURE_ALTAR ) {
				p = 3, cnt
			}
			if ( inv(INV_ITEM_EFFECT, cnt) != EFFECT_NONE | refitem(inv(INV_ITEM_ID, cnt), DBSPEC_CAN_USE) != FALSE ) {
				p = 4
			}
			if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_CAN_READ) != FALSE ) {
				p = 5
			}
			if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_MOON_GATE ) {
				key = key_godown
			}
			if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_UPSTAIRS ) {
				if ( gdata(GDATA_AREA) == AREA_HOME ) {
					key = key_goup
				}
			}
			if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_DOWNSTAIRS ) {
				if ( gdata(GDATA_AREA) == AREA_HOME ) {
					key = key_godown
				}
			}
			if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_KOTATSU ) {
				key = key_godown
			}
		loop
		if ( key == key_godown | key == key_goup ) {
			p = -1
		}
		if ( p == 0 ) {
			if ( key == key_enter ) {
				key = key_search
			}
		}
		if ( p == 1 ) {
			key = key_open
		}
		if ( p == 2 ) {
			key = key_dip
		}
		if ( p == 3 ) {
			if ( cdata(CDATA_GOD, CHARA_PLAYER) != GOD_EYTH ) {
				key = key_offer
			}
			else {
				key = key_pray
			}
		}
		if ( p == 4 ) {
			key = key_use
		}
		if ( p == 5 ) {
			key = key_read
		}
	}
	if ( mousel == 1 ) {
		mousemove = 1
		automove--
		ematan p, windoww / 2 - mousex, (windowh - inf_verh) / 2 - mousey
		p = p * 360 / 255
		if ( p >= 338 ) {
			p = p - 360
		}
		s = key_south, key_southwest, key_west, key_northwest, key_north, key_northeast, key_east, key_southeast
		repeat 8
			if ( p <= cnt * 45 + 23 & p > cnt * 45 - 23 ) {
				key = s(cnt)
			}
		loop
		await 100
	}
	if ( key != "" ) {
		gosub *pcQuitY
	}
	if ( gdata(GDATA_FLAG_MAIN) < 875 | gdata(GDATA_FLAG_MAIN) >= 900 ) {
		if ( key == key_quick ) {
			gosub *com_quick
			gosub *screen_draw
		}
		if ( key == "sc" ) {
			goto *com_shortcut
		}
	}
	menucycle = 1
	if ( gdata(GDATA_FLAG_MAIN) < 875 | gdata(GDATA_FLAG_MAIN) >= 900 ) {
		if ( key == key_quickinv ) {
			invctrl = lastctrl
			snd SOUNDLIST_INV
			goto *com_inventory
		}
		if ( key == key_throw ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				invctrl = INVCTRL_THROW
				snd SOUNDLIST_INV
				goto *com_inventory
			}
		}
		if ( key == key_inventory ) {
			invctrl = INVCTRL_INFO
			snd SOUNDLIST_INV
			goto *com_inventory
		}
		if ( key == key_drop ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				invctrl = INVCTRL_DROP
				snd SOUNDLIST_INV
				goto *com_inventory
			}
		}
		if ( key == key_eat ) {
			invctrl = INVCTRL_EAT
			snd SOUNDLIST_INV
			goto *com_inventory
		}
		if ( key == key_read ) {
			invctrl = INVCTRL_READ
			snd SOUNDLIST_INV
			goto *com_inventory
		}
		if ( key == key_drink ) {
			invctrl = INVCTRL_DRINK
			snd SOUNDLIST_INV
			goto *com_inventory
		}
		if ( key == key_zap ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				invctrl = INVCTRL_ZAP
				snd SOUNDLIST_INV
				goto *com_inventory
			}
		}
		if ( key == key_use ) {
			invctrl = INVCTRL_USE
			snd SOUNDLIST_INV
			goto *com_inventory
		}
		if ( key == key_open ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				invctrl = INVCTRL_OPEN
				snd SOUNDLIST_INV
				goto *com_inventory
			}
		}
		if ( key == key_dip ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				invctrl = INVCTRL_DIP_SOURCE
				snd SOUNDLIST_INV
				goto *com_inventory
			}
		}
		if ( key == key_charainfo ) {
			csctrl = 0
			goto *com_charainfo
		}
		if ( key == key_material ) {
			goto *com_material
		}
		if ( key == key_trait ) {
			goto *com_trait
		}
		if ( key == key_wear ) {
			goto *com_wear
		}
		if ( key == key_cast ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				snd SOUNDLIST_SPELL
				goto *com_spell_loop
			}
		}
		if ( key == key_skill ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				snd SOUNDLIST_SKILL
				goto *com_applySkill
			}
		}
		if ( key == key_wipe ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				snd SOUNDLIST_SKILL
				goto *com_applyWideSkill
			}
		}
		if ( key == key_journal ) {
			goto *com_journal
		}
	}
	if ( key == key_msglog ) {
		goto *com_log
	}
	menucycle = 0
	if ( gdata(GDATA_FLAG_MAIN) < 875 | gdata(GDATA_FLAG_MAIN) >= 900 ) {
		if ( key == key_offer ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				invctrl = INVCTRL_OFFER
				snd SOUNDLIST_INV
				goto *com_inventory
			}
		}
		if ( key == key_help ) {
			gosub *com_help
			gosub *screen_draw
			goto *pc_turn
		}
		if ( key == "h" ) {
			if ( 0 ) {
				goto *com_home
			}
		}
		if ( key == key_rest ) {
			goto *com_rest
		}
		if ( key == key_interact ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				goto *com_interact
			}
		}
		if ( key == key_itemstack ) {
			goto *com_stack
		}
		if ( key == key_target ) {
			findlocmode = 1
			gosub *findLocation
			findlocmode = 0
			goto *pc_turn
		}
		if ( key == key_fire ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				goto *com_fire
			}
		}
		if ( key == key_give ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				goto *com_give
			}
		}
		if ( key == key_get | key == key_get2 ) {
			goto *com_get
		}
		if ( key == key_look ) {
			if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
				goto *com_target
			}
			else {
				gosub *findLocation
				goto *pc_turn
			}
		}
		if ( key == key_save | key_escape == 1 ) {
			goto *com_save
		}
		if ( key == key_dig ) {
			goto *com_dig
		}
		if ( key == key_bash ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				goto *com_bash
			}
		}
		if ( key == key_search ) {
			goto *act_search
		}
		if ( key == key_close ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				goto *act_close
			}
		}
		if ( key == key_pray ) {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
				txtnew
				txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
				display_msg
				redraw 1
				goto *pc_turn
			}
			else {
				goto *act_pray
			}
		}
		if ( key == key_ammo ) {
			goto *com_ammo
		}
		if ( key_tab ) {
			gosub *net_chat
			gosub *screen_draw
			goto *pc_turn
		}
	}
	p = 0
	if ( key == key_north ) {
		p = 1
		cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, CHARA_PLAYER)
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, CHARA_PLAYER) - 1
		gdata(GDATA_RUN_DIR) = 3
		dirsub = 0
	}
	if ( key == key_south ) {
		p = 1
		cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, CHARA_PLAYER)
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, CHARA_PLAYER) + 1
		gdata(GDATA_RUN_DIR) = 0
		dirsub = 4
	}
	if ( key == key_west ) {
		p = 1
		cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, CHARA_PLAYER) - 1
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, CHARA_PLAYER)
		gdata(GDATA_RUN_DIR) = 1
		dirsub = 6
	}
	if ( key == key_east ) {
		p = 1
		cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, CHARA_PLAYER) + 1
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, CHARA_PLAYER)
		gdata(GDATA_RUN_DIR) = 2
		dirsub = 2
	}
	if ( key == key_northwest ) {
		p = 1
		cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, CHARA_PLAYER) - 1
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, CHARA_PLAYER) - 1
		gdata(GDATA_RUN_DIR) = 3
		dirsub = 7
	}
	if ( key == key_northeast ) {
		p = 1
		cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, CHARA_PLAYER) + 1
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, CHARA_PLAYER) - 1
		gdata(GDATA_RUN_DIR) = 3
		dirsub = 1
	}
	if ( key == key_southwest ) {
		p = 1
		cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, CHARA_PLAYER) - 1
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, CHARA_PLAYER) + 1
		gdata(GDATA_RUN_DIR) = 0
		dirsub = 5
	}
	if ( key == key_southeast ) {
		p = 1
		cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, CHARA_PLAYER) + 1
		cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, CHARA_PLAYER) + 1
		gdata(GDATA_RUN_DIR) = 0
		dirsub = 3
	}
	cdata(CDATA_DIR, CHARA_PLAYER) = gdata(GDATA_RUN_DIR)
	if ( p == 1 ) {
		goto *act_movePC
	}
	if ( key == key_godown ) {
		val = 1
		goto *act_moveLevel
	}
	if ( key == key_goup ) {
		val = 2
		goto *act_moveLevel
	}
	if ( key == key_wait ) {
		goto *turn_end
	}
	if ( key == key_enter ) {
		gosub *screen_draw
		goto *pc_turn
	}
	if ( gdata(GDATA_FLAG_MAIN) < 875 | gdata(GDATA_FLAG_MAIN) >= 900 ) {
		if ( key != "" ) {
			if ( key != key_cancel ) {
				if ( key != key_alter ) {
					msgdup++
					txt lang("?キーを押すと、コマンドの一覧が見られる。", "Hit ? key to display help.")
					gosub *screen_draw
				}
			}
		}
	}
	goto *pc_turn

*pcQuitY
	if ( gdata(GDATA_QUIT_Y) != (-1) ) {
		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
			if ( gdata(GDATA_QUIT_Y) == 0 ) {
				if ( key == "Q" ) {
					txt lang("え…", "What...")
					gdata(GDATA_QUIT_Y)++
					gosub *screen_draw
					goto *pc_turn
				}
			}
			else {
				if ( gdata(GDATA_QUIT_Y) == 1 ) {
					if ( key == "y" ) {
						txt lang("まさか…", "No...no...")
						gdata(GDATA_QUIT_Y)++
						gosub *screen_draw
						goto *pc_turn
					}
				}
				else {
					if ( gdata(GDATA_QUIT_Y) == 2 ) {
						if ( key == "@" ) {
							txt lang("うわぁぁぁ！！", "Ahhhhh!!")
							repeat 10
								flt
								characreate -1, CREATURE_ID_AT_SIGN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
							loop
							gdata(GDATA_QUIT_Y) = -1
							gosub *screen_draw
							goto *turn_end
						}
					}
					gdata(GDATA_QUIT_Y) = 0
				}
				gdata(GDATA_QUIT_Y) = 0
			}
		}
	}
	return

*game_win
	snd SOUNDLIST_COMPLETE1
	music = MUSICLIST_NONE2
	gosub *music_play
	txt lang("信じられない！あなたはネフィアの迷宮「レシマス」を制覇した！", "Unbelievable! You conquered Lesimas!")
	gosub *screen_draw
	txtsetwinword 3
	repeat 3
		promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
		promptmax++
	loop
	val = promptx, prompty, 310, 0
	gosub *prompt_key
	wincomment = "" + promptl(0, rtval)
	mode = MODELIST_EVENT
	screenupdate = -1
	gosub *screen_draw
	msg_clear
	txt lang("「お前がここに辿り着くことは」台座から、何かの声が聞こえる。", "From the pedestal, you can hear a voice.")
	flt
	characreate -1, CREATURE_ID_ORPHE_THE_CHAOS_CHILD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
	music = MUSICLIST_MCCHAOS
	gosub *music_play
	msg_halt
	msg_clear
	txt lang("「決まっていたことなのだ…遅かれ早かれな」", cnvtalk("Your arrival here was inevitable...sooner or later"))
	txtvalid = 0
	txt lang("部屋の空気が突然緊張し、あなたの前に端麗な青年が現れた。", "Space within the room distorts, before you appears an elegant young man.")
	txtvalid = 0
	txt lang("「我々からすれば、複雑性の一面に過ぎないが、人間は運命とでも呼ぶのだろう？」", cnvtalk("For me this is, but a minor hindrance, albeit you humans may call this fate?"))
	msg_halt
	msg_clear
	txt lang("あなたは懸命に脚の震えを抑えようとしたが、難しかった。", "You earnestly attempt to suppress the shaking in your legs, but it proves difficult.")
	txtvalid = 0
	txt lang("華奢に見える幼顔の男の影は、人のものではない。", "The shadow of the young boy with an elegant face is not one of man.")
	txtvalid = 0
	txt lang("あどけない瞳の奥に、あなたは底知れない力と闇を感じた。", "From the depths of his innocent eyes, you feel immeasurable strength and darkness.")
	msg_halt
	msg_clear
	txt lang("「ネフィアの永遠の盟約に基づき」青年は台座の横の死体を指し、皮肉な微笑を送った。", "The young point gestures to the corpse neighboring the pedestal with a crooked sneer.")
	txtvalid = 0
	txt lang("「この哀れな老人が守っていたものは、今からお前のものだ」", cnvtalk("In accordance with the oath of the eternal league of Nefia, what this pathetic old man had protected、now is yours"))
	msg_halt
	msg_clear
	txt lang("あなたは、台座の上に置かれている絢爛な装飾の本を、いぶかしげに眺めた。", "You cast a suspicious gaze at the gorgeously adorned book resting on the pedestal.")
	msg_halt
	tc = findchara(CREATURE_ID_ORPHE_THE_CHAOS_CHILD)
	gosub *chat
	msg_clear
	txt lang("青年は悪戯っぽくニヤリと笑い、壁に寄りかかった。", "The young boy leans against the wall giving a wicked jeering smile.")
	msg_halt
	msg_clear
	chara_vanquish findchara(CREATURE_ID_ORPHE_THE_CHAOS_CHILD)
	screenupdate = -1
	gosub *screen_draw
	txt lang("…どれくらい時間がたっただろう。氷の瞳の男は、いつの間にか姿を消していた。あなたは不安を振り払い、ゆっくりと本に手を伸ばした…。", "....An unbeknownst amount of time passes. Then suddenly the man with frigged eyes vanishes. You shake off your uncertainties, slowly extending a hand out to the book....")
	msg_halt
	mode = MODELIST_MAIN
	music = MUSICLIST_MCMARCH2
	gosub *music_play
	gosub *screen_fadeIn
	redraw 0
	buffer BUFFER_BUF, windoww, windowh
	picload exedir + "\\graphic\\void.bmp", 1
	gsel BUFFER_SCREEN
	gosub *screen_fadeOut
	pos 0, 0
	gcopy BUFFER_BUF, 0, 0, windoww, windowh
	gsel BUFFER_BUF
	pos 0, 0
	picload exedir + "\\graphic\\g1.bmp", 1
	gsel BUFFER_SCREEN
	s = lang("" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "に祝福あれ！あなたは遂にレシマスの秘宝を手にいれた！", "Blessing to " + cdatan(CDATAN_NAME, CHARA_PLAYER) + ", " + cdatan(CDATAN_AKA, CHARA_PLAYER) + "! You've finally aquired the codex!")
	gosub *screen_drawMsg2
	s = lang("*勝利*", "*Win*"), "" + strhint3
	windowshadow = 1
	display_window 60, 70, 680, 488
	cmbg = 0
	x = ww / 3 - 20
	y = wh - 140
	gmode 4, 180, 300, 250
	pos wx + ww - 120, wy + wh / 2
	grotate BUFFER_BUF, cmbg / 4 \ 4 * 180, cmbg / 4 / 4 \ 2 * 300, 0, x, y
	gmode 2
	display_topic lang("制覇までの軌跡", "Trace"), wx + 28, wy + 40
	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
	color 0, 0, 0
	color 0, 0
	pos wx + 40, wy + 76
	mes lang("" + 517 + "年" + 8 + "月" + 12 + "日に、あなたはノースティリスに到着した。", "In the year " + 517 + ", " + 12 + "/" + 8 + ", you arrived at North Tyris.")
	mes ""
	mes lang("最深で" + gdata(GDATA_DEEPEST) + "階相当まで到達し、" + gdata(GDATA_KILLED) + "匹の敵を殺して、", "You've killed " + gdata(GDATA_KILLED) + " creatures and reached\nmaximum of " + cnvrank(gdata(GDATA_DEEPEST)) + " level of dungeons.")
	mes lang("現在" + calcscore() + "点のスコアを叩き出している。", "Your score is " + calcscore() + " points now.")
	mes ""
	mes lang("" + gdata(GDATA_YEAR) + "年" + gdata(GDATA_MONTH) + "月" + gdata(GDATA_DAY) + "日にレシマスを制覇して、", "In the year " + gdata(GDATA_YEAR) + ", " + gdata(GDATA_DAY) + "/" + gdata(GDATA_MONTH) + ", you conquered Lesimas.")
	mes lang("あなたは「" + wincomment + "」とコメントした。", "Upon killing Zeome, you said, " + cnvtalk("" + wincomment))
	mes ""
	mes lang("…あなたの旅はまだ終わらない。", "Your journey continues...")
	redraw 1
	key_list = key_enter
	keyrange = 0

*game_win_WHILE1
	if ( 1 == 0 ) {
		goto *game_win_WEND1
	}
	await cfg_wait1
	key_check
	cursor_check
	if ( key == key_cancel ) {
		goto *game_win_WEND1
	}
	goto *game_win_WHILE1

*game_win_WEND1
	gosub *screen_refreshFull
	txt lang("達成のシーンをもう一度再現する？", "You want to watch this event again?")
	promptl(0, 0) = stryes, "y", "0"
	promptl(0, 1) = strno, "n", "1"
	promptmax = 2
	val = promptx, prompty, 160, 1
	gosub *prompt_key
	if ( rtval == 0 ) {
		goto *game_win
	}
	gdata(GDATA_FLAG_MAIN) = 180
	gosub *screen_draw
	return

*game_win2
	snd SOUNDLIST_COMPLETE1
	music = MUSICLIST_NONE2
	gosub *music_play
	txt lang("信じられない！あなたは古代遺跡「レミード」を制圧した！", "Unbelievable! You conquered Rehmido!")
	gosub *screen_draw
	txtsetwinword 3
	repeat 3
		promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
		promptmax++
	loop
	val = promptx, prompty, 310, 0
	gosub *prompt_key
	wincomment = "" + promptl(0, rtval)
	music = MUSICLIST_MCMARCH2
	gosub *music_play
	gosub *screen_fadeIn
	redraw 0
	buffer BUFFER_BUF, windoww, windowh
	picload exedir + "\\graphic\\void.bmp", 1
	gsel BUFFER_SCREEN
	gosub *screen_fadeOut
	pos 0, 0
	gcopy BUFFER_BUF, 0, 0, windoww, windowh
	gsel BUFFER_BUF
	pos 0, 0
	picload exedir + "\\graphic\\g1.bmp", 1
	gsel BUFFER_SCREEN
	s = lang("" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "に祝福あれ！あなたは遂に災厄の根源を滅ぼした！", "Blessing to " + cdatan(CDATAN_NAME, CHARA_PLAYER) + ", " + cdatan(CDATAN_AKA, CHARA_PLAYER) + "! You've finally aquired the codex!")
	gosub *screen_drawMsg2
	s = lang("*勝利*", "*Win*"), "" + strhint3
	windowshadow = 1
	display_window 60, 70, 680, 488
	cmbg = 0
	x = ww / 3 - 20
	y = wh - 140
	gmode 4, 180, 300, 250
	pos wx + ww - 120, wy + wh / 2
	grotate BUFFER_BUF, cmbg / 4 \ 4 * 180, cmbg / 4 / 4 \ 2 * 300, 0, x, y
	gmode 2
	display_topic lang("制覇までの軌跡", "Trace"), wx + 28, wy + 40
	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
	color 0, 0, 0
	color 0, 0
	pos wx + 40, wy + 76
	mes lang("" + 517 + "年" + 8 + "月" + 12 + "日に、あなたはノースティリスに到着した。", "In the year " + 517 + ", " + 12 + "/" + 8 + ", you arrived at North Tyris.")
	mes ""
	mes lang("最深で" + gdata(GDATA_DEEPEST) + "階相当まで到達し、" + gdata(GDATA_KILLED) + "匹の敵を殺して、", "You've killed " + gdata(GDATA_KILLED) + " creatures and reached\nmaximum of " + cnvrank(gdata(GDATA_DEEPEST)) + " level of dungeons.")
	mes lang("現在" + calcscore() + "点のスコアを叩き出している。", "Your score is " + calcscore() + " points now.")
	mes ""
	mes lang("" + gdata(GDATA_YEAR) + "年" + gdata(GDATA_MONTH) + "月" + gdata(GDATA_DAY) + "日にレミードを制覇して、", "In the year " + gdata(GDATA_YEAR) + ", " + gdata(GDATA_DAY) + "/" + gdata(GDATA_MONTH) + ", you conquered Rehmido.")
	mes lang("あなたは「" + wincomment + "」とコメントした。", "Upon killing Zeome, you said, " + cnvtalk("" + wincomment))
	mes ""
	mes lang("…あなたの旅はまだ終わらない。", "Your journey continues...")
	redraw 1
	key_list = key_enter
	keyrange = 0

*game_win2_WHILE1
	if ( 1 == 0 ) {
		goto *game_win2_WEND1
	}
	await cfg_wait1
	key_check
	cursor_check
	if ( key == key_cancel ) {
		goto *game_win2_WEND1
	}
	goto *game_win2_WHILE1

*game_win2_WEND1
	gosub *screen_refreshFull
	txt lang("達成のシーンをもう一度再現する？", "You want to watch this event again?")
	promptl(0, 0) = stryes, "y", "0"
	promptl(0, 1) = strno, "n", "1"
	promptmax = 2
	val = promptx, prompty, 160, 1
	gosub *prompt_key
	if ( rtval == 0 ) {
		goto *game_win2
	}
	gdata(GDATA_FLAG_MAIN) = 340
	gdata(GDATA_YEARS_AFTER_VICTORY) = 1
	gosub *screen_draw
	return

*game_win3
	snd SOUNDLIST_COMPLETE1
	music = MUSICLIST_NONE2
	gosub *music_play
	txt lang("信じられない！あなたは神の間を制圧した！", "Unbelievable! You conquered God's prison!")
	gosub *screen_draw
	txtsetwinwordc 3
	repeat 3
		promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
		promptmax++
	loop
	val = promptx, prompty, 250, 0
	gosub *prompt_key
	wincomment = "" + promptl(0, rtval)
	music = MUSICLIST_MCMARCH2
	gosub *music_play
	gosub *screen_fadeIn
	redraw 0
	buffer BUFFER_BUF, windoww, windowh
	picload exedir + "\\graphic\\void.bmp", 1
	gsel BUFFER_SCREEN
	gosub *screen_fadeOut
	pos 0, 0
	gcopy BUFFER_BUF, 0, 0, windoww, windowh
	gsel BUFFER_BUF
	pos 0, 0
	picload exedir + "\\graphic\\g1.bmp", 1
	gsel BUFFER_SCREEN
	s = lang("" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "に祝福あれ！あなたは遂に混沌の神を討伐した！", "Blessing to " + cdatan(CDATAN_NAME, CHARA_PLAYER) + ", " + cdatan(CDATAN_AKA, CHARA_PLAYER) + "! You've finally beat the god of chaos!")
	gosub *screen_drawMsg2
	s = lang("*勝利*", "*Win*"), "" + strhint3
	windowshadow = 1
	display_window 60, 70, 680, 488
	cmbg = 0
	x = ww / 3 - 20
	y = wh - 140
	gmode 4, 180, 300, 250
	pos wx + ww - 120, wy + wh / 2
	grotate BUFFER_BUF, cmbg / 4 \ 4 * 180, cmbg / 4 / 4 \ 2 * 300, 0, x, y
	gmode 2
	display_topic lang("制覇までの軌跡", "Trace"), wx + 28, wy + 40
	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
	color 0, 0, 0
	color 0, 0
	pos wx + 40, wy + 76
	mes lang("" + 517 + "年" + 8 + "月" + 12 + "日に、あなたはノースティリスに到着した。", "In the year " + 517 + ", " + 12 + "/" + 8 + ", you arrived at North Tyris.")
	mes ""
	mes lang("最深で" + gdata(GDATA_DEEPEST) + "階相当まで到達し、" + gdata(GDATA_KILLED) + "匹の敵を殺して、", "You've killed " + gdata(GDATA_KILLED) + " creatures and reached\nmaximum of " + cnvrank(gdata(GDATA_DEEPEST)) + " level of dungeons.")
	mes lang("現在" + calcscore() + "点のスコアを叩き出している。", "Your score is " + calcscore() + " points now.")
	mes ""
	mes lang("" + gdata(GDATA_YEAR) + "年" + gdata(GDATA_MONTH) + "月" + gdata(GDATA_DAY) + "日に神の間を制覇して、", "In the year " + gdata(GDATA_YEAR) + ", " + gdata(GDATA_DAY) + "/" + gdata(GDATA_MONTH) + ", you conquered God's prison.")
	mes lang("あなたは「" + wincomment + "」とコメントした。", "Upon killing Zeome, you said, " + cnvtalk("" + wincomment))
	mes ""
	mes lang("…あなたの旅はまだ終わらない。", "Your journey continues...")
	redraw 1
	key_list = key_enter
	keyrange = 0

*game_win3_WHILE1
	if ( 1 == 0 ) {
		goto *game_win3_WEND1
	}
	await cfg_wait1
	key_check
	cursor_check
	if ( key == key_cancel ) {
		goto *game_win3_WEND1
	}
	goto *game_win3_WHILE1

*game_win3_WEND1
	gosub *screen_refreshFull
	txt lang("達成のシーンをもう一度再現する？", "You want to watch this event again?")
	promptl(0, 0) = stryes, "y", "0"
	promptl(0, 1) = strno, "n", "1"
	promptmax = 2
	val = promptx, prompty, 160, 1
	gosub *prompt_key
	if ( rtval == 0 ) {
		goto *game_win3
	}
	gosub *screen_draw
	return

*pc_dead
	cc = CHARA_PLAYER
	snd SOUNDLIST_DEAD1
	screenupdate = -1
	gosub *screen_draw
	if ( gdata(GDATA_QUEST) == QUEST_TYPE_THIEVES ) {
		gdata(GDATA_QUEST) = QUEST_TYPE_NONE
	}
	if ( gdata(GDATA_QUEST) ) {
		goto *quest_death
	}
	txt lang("さようなら… ", "Good bye... ")
	txtmore
	txt lang("遺言は？", "You leave a dying message.")
	val = (windoww - 310) / 2 + inf_screenx, winposy(90), 16, 1, 0
	inputlog = ""
	gosub *prompt_word
	if ( inputlog == "" ) {
		txtsetlastword
	}
	else {
		lastword = lang("「", "\"") + inputlog + lang("」", "\"")
	}
	buff = ""
	notesel buff
	file = exedir + "save\\bone"
	exist file + ".txt"
	if ( strsize != (-1) ) {
		noteload file + ".txt"
	}
	s = cdatan(CDATAN_AKA, cc) + " " + cdatan(CDATAN_NAME, cc) + lang("", " ") + lastword
	lenfix s, 60
	s += lang("" + gdata(GDATA_YEAR) + "年" + gdata(GDATA_MONTH) + "月" + gdata(GDATA_DAY) + "日", "" + gdata(GDATA_YEAR) + "/" + gdata(GDATA_MONTH) + "/" + gdata(GDATA_DAY))
	noteadd "", 0
	noteadd s, 1
	s = lang(mdatan(0) + "で" + ndeathcause, cnven(ndeathcause) + " in " + mdatan(0) + ".")
	noteadd s, 2
	s = "" + calcscore() + "," + cdata(CDATA_PIC, cc)
	noteadd s, 3
	if ( noteinfo(0) >= 80 * 4 ) {
		repeat noteinfo(0) - 80 * 4, 80 * 4
			notedel 80 * 4
		loop
	}
	page = 0
	repeat
		p(1) = 0
		repeat 80 - 1
			p = cnt * 4
			noteget s(10), p + 3
			csvsort s, s(10), 44
			p(2) = int(s)
			noteget s(10), p + 7
			csvsort s, s(10), 44
			p(3) = int(s)
			if ( p(3) > p(2) ) {
				if ( cnt == page ) {
					page = cnt + 1
				}
				else {
					if ( cnt + 1 == page ) {
						page = cnt
					}
				}
				repeat 3, 1
					noteget s, p + cnt
					noteget s(1), p + 4 + cnt
					noteadd s, p + 4 + cnt, 1
					noteadd s(1), p + cnt, 1
				loop
				p(1) = 1
			}
		loop
		if ( p(1) == 0 ) {
			break
		}
	loop
	repeat noteinfo(0) / 4
		noteadd "" + cnvrank(cnt + 1) + lang("位", ""), cnt * 4, 1
	loop
	notesave file + ".txt"
	redraw 0
	gsel BUFFER_BUF
	pos 0, 0
	picload exedir + "graphic\\void.bmp", 1
	gsel BUFFER_SCREEN
	gosub *dead_draw
	s = lang("あともう少しで埋葬される…", "You are about to be burried...")
	gosub *screen_drawMsg2
	if ( gdata(GDATA_FLAG_GAME_MODE) == 3 | (gdata(GDATA_FLAG_MAIN) >= 715 & gdata(GDATA_FLAG_MAIN) < 760 & gdata(GDATA_AREA) == AREA_CHAOS_CRADLE) ) {
		gosub *dead_draw
		s = lang("あなたは埋められた。さようなら…（キーを押すと終了します）", "You have been burried. Bye...(Hit any key to exit)")
		gosub *screen_drawMsg2
		redraw 1
		press
		goto *exit_game
	}
	promptl(0, promptmax) = lang("這い上がる(ﾍﾟﾅﾙﾃｨあり復活)", "Crawl up"), "a", "" + promptmax
	promptmax++
	if ( gdata(GDATA_FLAG_GAME_MODE) != 1 ) {
		promptl(0, promptmax) = lang("埋まる(保存したところから)", "Lie on your back"), "b", "" + promptmax
		promptmax++
	}
	val = promptx, 100, 300, 1
	gosub *prompt_key
	if ( rtval == 1 ) {
		gosub *dead_draw
		s = lang("あなたは埋められた。さようなら…（キーを押すと終了します）", "You have been burried. Bye...(Hit any key to exit)")
		gosub *screen_drawMsg2
		redraw 1
		press
		goto *exit_game
	}
	s = "dead" + lang(cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "は" + mdatan(0) + "で" + ndeathcause + lastword, cdatan(CDATAN_AKA, CHARA_PLAYER) + " " + cdatan(CDATAN_NAME, CHARA_PLAYER) + " " + ndeathcause + " in " + mdatan(0) + " " + lastword)
	screenupdate = -1
	gosub *screen_refreshFull
	levelexitby = MAP_EXIT_DEAD
	goto *map_exit
	goto *map_exit

*dead_draw
	notesel buff
	redraw 0
	gmode 0
	pos 0, 0
	gzoom windoww, windowh, 4, 0, 0, 800, 600
	gmode 2
	x = 135
	y = 134
	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
	color 138, 131, 100
	p = page - 4
	if ( p >= 80 ) {
		p = 80 - 8
	}
	if ( p < 0 ) {
		p = 0
	}
	repeat 8, p
		p = cnt * 4
		y += 46
		if ( cnt == page ) {
			s = "New!"
		}
		else {
			s = " " + cnvrank(cnt + 1) + lang("位", "")
		}
		pos x - 80, y + 10
		color 10, 10, 10
		mes s
		if ( p >= noteinfo(0) ) {
			s = "no entry"
		}
		else {
			noteget s, p + 1
		}
		pos x, y
		color 10, 10, 10
		mes s
		if ( p >= noteinfo(0) ) {
			continue
		}
		noteget s, p + 2
		pos x, y + 20
		color 10, 10, 10
		mes s
		noteget s(10), p + 3
		csvsort s, s(10), 44
		pos x + 480, y + 20
		color 10, 10, 10
		mes "" + s + lang("点", "")
		p = int(s(1)) \ 1000
		chara_preparepic p
		pos x - 22, y + 12
		gmode 2, chipc(CHIPC_WIDTH, p), chipc(CHIPC_HEIGHT, p)
		grotate BUFFER_CHR, 0, 960, 0, chipc(CHIPC_WIDTH, p) / (1 + (chipc(CHIPC_HEIGHT, p) > inf_tiles)), inf_tiles
	loop
	return

*event
	procid = (procid + 1) \ 4
	proclist(procid) = "event" + " ct:" + ct
	_switch_val = evid()
	if ( 0 ) {
		_switch_sw++
	}
	if ( _switch_val == 8 | _switch_sw ) {
		_switch_sw = 0
		gosub *quest_eliminate
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 81 | _switch_sw ) {
		_switch_sw = 0
		qexit = 0
		mdata(MDATA_DOWNSTAIRS_POS) = cdata(CDATA_Y, CHARA_PLAYER) * 1000 + cdata(CDATA_X, CHARA_PLAYER)
		gdata(GDATA_TELEPORT_AREA) = AREA_OL_DRAN
		gdata(GDATA_TELEPORT_LEVEL) = 1
		levelexitby = MAP_EXIT_TELEPORT
		gdata(GDATA_LEVEL_START_ON) = 7
		mapstartx = 40
		mapstarty = 12
		snd SOUNDLIST_EXITMAP1
		chatteleport = 1
		return
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 91 | _switch_sw ) {
		_switch_sw = 0
		qexit = 0
		mdata(MDATA_DOWNSTAIRS_POS) = cdata(CDATA_Y, CHARA_PLAYER) * 1000 + cdata(CDATA_X, CHARA_PLAYER)
		gdata(GDATA_TELEPORT_AREA) = AREA_AMUR_CAGE
		gdata(GDATA_TELEPORT_LEVEL) = 1
		levelexitby = MAP_EXIT_TELEPORT
		gdata(GDATA_LEVEL_START_ON) = 7
		mapstartx = 27
		mapstarty = 19
		snd SOUNDLIST_EXITMAP1
		chatteleport = 1
		return
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 14 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_QUEST) == QUEST_TYPE_PARTY ) {
			calcpartyscore
			calcpartyscore2
			txt lang("最終得点は" + qdata(QDATA_PARAM2, gdata(GDATA_QUEST_REF)) + "ポイントだった！", "Your final score is " + qdata(QDATA_PARAM2, gdata(GDATA_QUEST_REF)) + " points!")
			if ( qdata(QDATA_PARAM1, gdata(GDATA_QUEST_REF)) <= qdata(QDATA_PARAM2, gdata(GDATA_QUEST_REF)) ) {
				gdata(GDATA_QUEST_STATE) = QUEST_STATE_SUCCESS
				qdata(QDATA_STATE, gdata(GDATA_QUEST_REF)) = QUEST_STATE_SUCCESS
				txtef COLOR_GREEN
				txt lang("パーティーは大盛況だった！", "People had a hell of a good time!")
				msg_halt
			}
			else {
				txtef COLOR_PURPLE
				txt lang("パーティーはぐだぐだになった…", "The party turned out to be a big flop...")
			}
		}
		if ( gdata(GDATA_QUEST) == QUEST_TYPE_HARVEST ) {
			if ( qdata(QDATA_PARAM1, gdata(GDATA_QUEST_REF)) < qdata(QDATA_PARAM2, gdata(GDATA_QUEST_REF)) ) {
				gdata(GDATA_QUEST_STATE) = QUEST_STATE_SUCCESS
				qdata(QDATA_STATE, gdata(GDATA_QUEST_REF)) = QUEST_STATE_SUCCESS
				txtef COLOR_GREEN
				txt lang("無事に納入を終えた！", "You complete the task!")
				msg_halt
			}
			else {
				txtef COLOR_PURPLE
				txt lang("納入は間に合わなかった…", "You fail to fulfill your task...")
			}
		}
		if ( gdata(GDATA_QUEST) == QUEST_TYPE_MINEFIELD ) {
			if ( qdata(QDATA_PARAM1, gdata(GDATA_QUEST_REF)) <= qdata(QDATA_PARAM2, gdata(GDATA_QUEST_REF)) ) {
				gdata(GDATA_QUEST_STATE) = QUEST_STATE_SUCCESS
				qdata(QDATA_STATE, gdata(GDATA_QUEST_REF)) = QUEST_STATE_SUCCESS
				txtef COLOR_GREEN
				txt lang("無事に撤去を終えた！", "You complete the task!")
				msg_halt
			}
			else {
				txtef COLOR_PURPLE
				txt lang("撤去は間に合わなかった…", "You fail to fulfill your task...")
			}
		}
		if ( gdata(GDATA_QUEST) == QUEST_TYPE_CONQUER ) {
			txtef COLOR_PURPLE
			txt lang("討伐に失敗した…", "You failed to slay the target...")
		}
		qexit = 0
		levelexitby = MAP_EXIT_NORMAL
		snd SOUNDLIST_EXITMAP1
		chatteleport = 1
		return
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 1 | _switch_sw ) {
		_switch_sw = 0
		gosub *game_win
		flt
		characreate -1, CREATURE_ID_ORPHE_THE_CHAOS_CHILD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 36 | _switch_sw ) {
		_switch_sw = 0
		repeat 245
			if ( cdata(CDATA_EXIST, CHARA_PLAYER) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_RELATION, cnt) == RELATION_ALLY | cnt < 16 ) {
				continue
			}
			tc = cnt
			if ( tc != CHARA_PLAYER ) {
				chara_vanquish tc
			}
		loop
		gosub *game_win2
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 27 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
			goto *event_SWEND1
		}
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_LITTLE_SISTER, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		txtef COLOR_BLUE
		txt lang("ビッグダディの肩から、リトルシスターが滑り落ちた。「Mr Bubbles！！」", "The little sister slips from Big Daddy's shoulder, " + cnvtalk("Mr.Bubbles!"))
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 28 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_YELLOW
		txt lang("愚かね…死ぬ準備をしなさい！！！", "You are so fool...die!")
		msg_halt
		animeid = ANIMATION_RAGNA
		gosub *anime
		msg_halt
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_DEVASTATE_LULWY, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		repeat 245
			if ( cdata(CDATA_EXIST, CHARA_PLAYER) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_RELATION, cnt) == RELATION_ALLY | cnt < 16 ) {
				continue
			}
			tc = cnt
			if ( cdata(CDATA_ID, tc) == CREATURE_ID_RUDRAS ) {
				if ( tc != CHARA_PLAYER ) {
					chara_vanquish tc
				}
			}
		loop
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 29 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_YELLOW
		txt lang("…ぅっぅぅ…っぅぅっぅううううみみゃぁ！！！", "memememw...MEMEMEM...MEWWWWWW!")
		msg_halt
		animeid = ANIMATION_RAGNA
		gosub *anime
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_GOD_INSIDE_EHEKATL, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 30 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_YELLOW
		txt lang("…ッハハハ…フハハハッツッハハハハー！！！", ".Muwahahaha.....wahahahaha!")
		msg_halt
		animeid = ANIMATION_RAGNA
		gosub *anime
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_BUILDUP_OPATOS, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 31 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_YELLOW
		txt lang("許さない…絶対に…！！！", "I can't...tolerate...!")
		msg_halt
		animeid = ANIMATION_RAGNA
		gosub *anime
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_INSANE_KUMIROMI, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 32 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_YELLOW
		txt lang("さぁ、終幕といこうか！！！", "Ok...the last scene start...!")
		msg_halt
		animeid = ANIMATION_RAGNA
		gosub *anime
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_DEUS_EX_MANINA, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 33 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_YELLOW
		txt lang("バ、バカは死ななきゃ治らないんだから！！！", "It's my only choice to heal your foolishness...!")
		msg_halt
		animeid = ANIMATION_RAGNA
		gosub *anime
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_BLESSED_JURE, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 41 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_YELLOW
		txt lang("渦巻け炎よ！取巻け冷気よ！そして瞬け電光よ！今こそ、あるべき姿へと還るのだ！", "This is genuine element!")
		msg_halt
		animeid = ANIMATION_RAGNA
		gosub *anime
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_THE_ELEMENT, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 42 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_YELLOW
		txt lang("許さへん…今のは高くつくで！！！", "Pay in life!")
		msg_halt
		animeid = ANIMATION_RAGNA
		gosub *anime
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_HYPER_YACATECT, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 40 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_FLAG_MAIN) >= 325 ) {
			txtef COLOR_YELLOW
			txt lang("あなたが肉塊に向けてエーテルブラスターを放つと、肉塊の再生が止まり崩壊を始めた。", "Pay in life!")
			txtef COLOR_RED
			txt lang("崩壊していく肉塊の中から何かが飛び出してきた！", "Something shot out of the flesh cake!")
			msg_halt
			flt
			characreate -1, CREATURE_ID_MESHERA_ALPHA_THE_DEFORMED_ANGEL, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
			music = MUSICLIST_MCLASTBOSS3
			gosub *music_play
			repeat 245
				if ( cdata(CDATA_EXIST, CHARA_PLAYER) != CHAR_STATE_ALIVE ) {
					continue
				}
				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
					continue
				}
				if ( cdata(CDATA_RELATION, cnt) == RELATION_ALLY | cnt < 16 ) {
					continue
				}
				tc = cnt
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_INFECTED_YERLES_SOLDIER ) {
					if ( tc != CHARA_PLAYER ) {
						cdata(CDATA_RELATION, tc) = RELATION_ALLY
						txt lang(name(tc) + "は束の間の自我を取り戻した！", name(tc) + " regained own ego!")
					}
				}
			loop
		}
		if ( gdata(GDATA_FLAG_MAIN) < 325 ) {
			txtef COLOR_RED
			txt lang("倒したはずの怪物がみるみる再生していく！これではキリがない！一時撤退し、対策を練った方がいいだろう。", "Plant resuscitated instantly! You should withdraw.")
			msg_halt
			flt
			characreate -1, CREATURE_ID_MESHERA_PLANT, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
			cbitmod CHARA_BIT_SUMMONED, rc, TRUE
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 2 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_LOMIAS_THE_MESSENGER_FROM_VINDALE)
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 24 | _switch_sw ) {
		_switch_sw = 0
		initeco = 1
		gosub *renew_economy
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 3 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_ZEOME_THE_FALSE_PROPHET)
		gosub *chat
		music = MUSICLIST_MCLASTBOSS
		gosub *music_play
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 11 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_SHOPKEEPER)
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 23 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_ROGUE_BOSS)
		gosub *chat
		music = MUSICLIST_MCBOSS
		gosub *music_play
		gdata(GDATA_MAP_EVENT) = 23
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 60 | _switch_sw ) {
		_switch_sw = 0
		music = MUSICLIST_MCBOSS5
		gosub *music_play
		snd SOUNDLIST_CURSE2
		gdata(GDATA_FLAG_THROWN_CHESTNUTS) = gdata(GDATA_FLAG_THROWN_CHESTNUTS) / 2
		item_find ITEM_ID_CHESTNUT, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
		if ( stat != (-1) ) {
			ci = stat
			if ( inv(INV_ITEM_NUM, ci) >= 1 ) {
				inv(INV_ITEM_NUM, ci) = 0
				txt lang("突然、手持ちの栗をひったくられた！", "Sorry, this is untranslated sentence.")
			}
		}
		txtef COLOR_RED
		txtmore
		txt lang("「栗を粗末にしたのは…お前だなああっ！！」", "Chestnut giant yells, " + cnvtalk("You idiot!"))
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 37 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_H_SISTER)
		gosub *chat
		music = MUSICLIST_MCBOSS4
		gosub *music_play
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 50 | _switch_sw ) {
		_switch_sw = 0
		music = MUSICLIST_MCFEST
		gosub *music_play
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 39 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_ORPHE_THE_CHAOS_FOLLOWER)
		gosub *chat
		music = MUSICLIST_MCLASTBOSS
		gosub *music_play
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 55 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_MESHERA_PLANT)
		gosub *chat
		music = MUSICLIST_MCLASTBOSS
		gosub *music_play
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 74 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_ENTHUMESIS)
		gosub *chat
		music = MUSICLIST_MCLASTBOSS3
		gosub *music_play
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 78 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_FLAG_MAIN) == 755 ) {
			tc = findchara(CREATURE_ID_NAGAREW_THE_OBLIVION_BEAST)
			if ( tc != CHARA_PLAYER ) {
				cdata(CDATA_HP, tc) = 1
			}
			tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			tc = findchara(CREATURE_ID_BETHEL_THE_WHITE_HAWK)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			tc = findchara(CREATURE_ID_MELUGAST_AO_I_THE_DIMENSION_DRIVER)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			tc = findchara(CREATURE_ID_RAIZEL_THE_OLD_WIZARD)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			gdata(GDATA_FLAG_MAIN) = 760
			tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
			if ( tc == CHARA_PLAYER ) {
				flt
				initlv = 200
				novoidlv = 1
				characreate -1, CREATURE_ID_BLACK_GAUNTLET_LEOLD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_AI_CALM, rc) = 4
				cdata(CDATA_RELATION, rc) = RELATION_ALLY
				cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
			}
			tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
			gosub *chat
		}
		if ( gdata(GDATA_FLAG_MAIN) == 745 ) {
			tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			tc = findchara(CREATURE_ID_BETHEL_THE_WHITE_HAWK)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			tc = findchara(CREATURE_ID_MELUGAST_AO_I_THE_DIMENSION_DRIVER)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			snd SOUNDLIST_EXITMAP1
			tc = findchara(CREATURE_ID_THE_CHAOS_CHILD)
			if ( tc != CHARA_PLAYER ) {
				target = tc
			}
			flt
			initlv = 210
			novoidlv = 1
			characreate -1, CREATURE_ID_NAGAREW_THE_OBLIVION_BEAST, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_AI_CALM, rc) = 4
			cdata(CDATA_TARGET, rc) = target
			cdata(CDATA_RELATION, rc) = RELATION_ALLY
			cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
			flt
			initlv = 164
			novoidlv = 1
			characreate -1, CREATURE_ID_RAIZEL_THE_OLD_WIZARD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_AI_CALM, rc) = 4
			cdata(CDATA_TARGET, rc) = target
			cdata(CDATA_RELATION, rc) = RELATION_ALLY
			cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
			tc = findchara(CREATURE_ID_RAIZEL_THE_OLD_WIZARD)
			gosub *chat
			gdata(GDATA_FLAG_MAIN) = 750
		}
		if ( gdata(GDATA_FLAG_MAIN) == 735 ) {
			tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			tc = findchara(CREATURE_ID_BETHEL_THE_WHITE_HAWK)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			snd SOUNDLIST_TELEPORT1
			txtef COLOR_YELLOW
			txt lang("「どうやら間に合ったようだな！」", cnvtalk("Apparently it seems that went well!"))
			msg_halt
			tc = findchara(CREATURE_ID_THE_CHAOS_CHILD)
			if ( tc != CHARA_PLAYER ) {
				target = tc
			}
			flt
			initlv = 210
			novoidlv = 1
			characreate -1, CREATURE_ID_MELUGAST_AO_I_THE_DIMENSION_DRIVER, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_AI_CALM, rc) = 4
			cdata(CDATA_TARGET, rc) = target
			cdata(CDATA_RELATION, rc) = RELATION_ALLY
			cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
			tc = findchara(CREATURE_ID_MELUGAST_AO_I_THE_DIMENSION_DRIVER)
			gosub *chat
			gdata(GDATA_FLAG_MAIN) = 740
		}
		if ( gdata(GDATA_FLAG_MAIN) == 725 ) {
			tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
			repeat 4
				await 50
				snd SOUNDLIST_FOOT1A
				await 50
				snd SOUNDLIST_FOOT1B
				await 50
			loop
			txtef COLOR_YELLOW
			txt lang("「ここが神の間か！？」", cnvtalk("Is this God's prison!?"))
			msg_halt
			tc = findchara(CREATURE_ID_THE_CHAOS_CHILD)
			if ( tc != CHARA_PLAYER ) {
				target = tc
			}
			flt
			initlv = 200
			novoidlv = 1
			characreate -1, CREATURE_ID_BETHEL_THE_WHITE_HAWK, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_AI_CALM, rc) = 4
			cdata(CDATA_TARGET, rc) = target
			cdata(CDATA_RELATION, rc) = RELATION_ALLY
			cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
			tc = findchara(CREATURE_ID_BETHEL_THE_WHITE_HAWK)
			gosub *chat
			gdata(GDATA_FLAG_MAIN) = 730
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 75 | _switch_sw ) {
		_switch_sw = 0
		gdata(GDATA_FLAG_ENTHUMESIS_SPAWNED) = 100
		if ( gdata(GDATA_FLAG_MAIN) == 715 ) {
			txtef COLOR_YELLOW
			txt lang("来光の牙がアストラル光を放ち始めた…。", "The Origin of Light began to release astral light...")
			msg_halt
			txtef COLOR_YELLOW
			txt lang("放たれた光が神の間を包み込む！", "The light emitted wrapped up God's prison!!")
			animeid = ANIMATION_GAMEWIN3
			gosub *anime
			gosub *game_win3
			tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
			if ( tc == CHARA_PLAYER ) {
				flt
				initlv = 200
				novoidlv = 1
				characreate -1, CREATURE_ID_BLACK_GAUNTLET_LEOLD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_AI_CALM, rc) = 4
				cdata(CDATA_RELATION, rc) = RELATION_ALLY
				cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
			}
			tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
			gosub *chat
			txtef COLOR_RED
			txt lang("何かがエンテュメイシスの腹から飛び出してきた！獣の咆哮が辺りに響く…。", "Something splits <Enthumesis> body and breaks out!")
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			await 50
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			await 50
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			await 50
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			snd SOUNDLIST_BEAST02
			gdata(GDATA_FLAG_MAIN) = 720
		}
		music = MUSICLIST_MCLASTBOSS3
		gosub *music_play
		flt
		initlv = 3500
		novoidlv = 1
		characreate -1, CREATURE_ID_THE_CHAOS_CHILD, 10, 10
		cbitmod CHARA_BIT_SUMMONED, rc, TRUE
		tc = findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 80 | _switch_sw ) {
		_switch_sw = 0
		gdata(GDATA_FLAG_KAMIKAZE) = 0
		tc = findchara(CREATURE_ID_KARAVIKA)
		if ( cdata(CDATA_RELATION, tc) != RELATION_DISLIKE ) {
			gosub *chat
		}
		kaiwa = rnd(5)
		if ( kaiwa == 0 ) {
			music = MUSICLIST_MCPETARENA
			gosub *music_play
		}
		if ( kaiwa == 1 ) {
			music = MUSICLIST_MCTOWN9
			gosub *music_play
		}
		if ( kaiwa == 2 ) {
			music = MUSICLIST_MCLASTBOSS3
			gosub *music_play
		}
		if ( kaiwa == 3 ) {
			music = MUSICLIST_MCHUGE
			gosub *music_play
		}
		if ( kaiwa == 4 ) {
			music = MUSICLIST_MCARENA
			gosub *music_play
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 51 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_MOBILE_COMMUNICATION_EQUIPMENT)
		gosub *chat
		if ( gdata(GDATA_FLAG_MAIN) >= 265 & gdata(GDATA_FLAG_MAIN) < 266 & gdata(GDATA_LEVEL) == 106 ) {
			music = MUSICLIST_MCBATTLE2
			gosub *music_play
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 77 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_LEVEL) == 20 ) {
			snd SOUNDLIST_BASH1
			txtef COLOR_YELLOW
			txt lang("「レシマスの真実の書に近づく者は殺す」", cnvtalk("You can not reach the bottom of Lesimus."))
			repeat 3
				flt
				characreate -1, CREATURE_ID_ZANAN_ASSASSIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_TARGET, rc) = 0
				cdata(CDATA_AI_AGGRO, rc) = 30
			loop
			music = MUSICLIST_MCBOSS
			gosub *music_play
		}
		if ( gdata(GDATA_LEVEL) == 25 ) {
			snd SOUNDLIST_BASH1
			txtef COLOR_YELLOW
			txt lang("「《常闇の眼》を狙う冒険者だな？死んでもらおうか！」", cnvtalk("You can not rget the truth book of Lesimus."))
			repeat 6
				flt
				characreate -1, CREATURE_ID_ZANAN_ASSASSIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_TARGET, rc) = 0
				cdata(CDATA_AI_AGGRO, rc) = 30
			loop
			music = MUSICLIST_MCBOSS
			gosub *music_play
		}
		if ( gdata(GDATA_LEVEL) == 30 ) {
			snd SOUNDLIST_BASH1
			repeat 9
				flt
				characreate -1, CREATURE_ID_ZANAN_ASSASSIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_TARGET, rc) = 0
				cdata(CDATA_AI_AGGRO, rc) = 30
			loop
			flt
			characreate -1, CREATURE_ID_ALSAPIA_THE_MURDERER_MASK, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_TARGET, rc) = 0
			cdata(CDATA_AI_AGGRO, rc) = 30
			tc = findchara(CREATURE_ID_ALSAPIA_THE_MURDERER_MASK)
			gosub *chat
			music = MUSICLIST_MCBATTLE2
			gosub *music_play
		}
		if ( gdata(GDATA_LEVEL) == 34 ) {
			snd SOUNDLIST_CURSE2
			txtef COLOR_PURPLE
			txt lang("足を踏み入れた瞬間、周囲の屍が一斉に起き上がった！", "The Origin of Light began to release astral light...")
			repeat 12
				flt
				characreate -1, CREATURE_ID_SKELETON_MAGICIAN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_TARGET, rc) = 0
				cdata(CDATA_AI_AGGRO, rc) = 30
			loop
			music = MUSICLIST_MCBOSS
			gosub *music_play
		}
		if ( gdata(GDATA_LEVEL) == 40 ) {
			snd SOUNDLIST_BASH1
			repeat 4
				flt
				characreate -1, CREATURE_ID_GOLDEN_ARMOR, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_TARGET, rc) = 0
				cdata(CDATA_AI_AGGRO, rc) = 30
			loop
			flt
			characreate -1, CREATURE_ID_GILPHEM_THE_MAGIC_STEEL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_TARGET, rc) = 0
			cdata(CDATA_AI_AGGRO, rc) = 30
			tc = findchara(CREATURE_ID_GILPHEM_THE_MAGIC_STEEL)
			gosub *chat
			music = MUSICLIST_MCBATTLE2
			gosub *music_play
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 69 | _switch_sw ) {
		_switch_sw = 0
		music = MUSICLIST_MCMARCH1
		gosub *music_play
		birth = 0
		repeat 16
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cnt == 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_SLEEP, cnt) > 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_DIM, cnt) >= 60 ) {
				continue
			}
			if ( cdata(CDATA_INTEREST, cnt) <= 0 ) {
				continue
			}
			birth++
		loop
		repeat 245 - 16, 16
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cnt == 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_SLEEP, cnt) > 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_DIM, cnt) >= 60 ) {
				continue
			}
			if ( cdata(CDATA_INTEREST, cnt) <= 0 ) {
				continue
			}
			birth++
		loop
		if ( birth > 5 ) {
			snd SOUNDLIST_CHEER
			await 2000
			snd SOUNDLIST_CLAP4F
		}
		birth = 0
		repeat 16
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cnt == 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_SLEEP, cnt) > 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_DIM, cnt) >= 60 ) {
				continue
			}
			if ( cdata(CDATA_INTEREST, cnt) <= 0 ) {
				continue
			}
			if ( birth > 15 ) {
				continue
			}
			birth++
			tc = cnt
			gosub *chat
		loop
		repeat 245 - 16, 16
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cnt == 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_SLEEP, cnt) > 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_DIM, cnt) >= 60 ) {
				continue
			}
			if ( cdata(CDATA_INTEREST, cnt) <= 0 ) {
				continue
			}
			if ( birth > 15 ) {
				continue
			}
			birth++
			tc = cnt
			gosub *chat
		loop
		flt
		itemcreate -1, ITEM_ID_PRESENT, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
		txt lang("へぇ、今日誕生日なんだ？おめでとう！", "Happy birthday!")
		txtmore
		await 2000
		txtsetbirth 2
		repeat 2
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 300, 0
		gosub *prompt_key
		if ( rtval == 0 ) {
			if ( birth > 5 ) {
				snd SOUNDLIST_CHEER
			}
		}
		birth = 0
		txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
		gdata(GDATA_FLAG_BIRTHDAY_CURRENT_YEAR) = int(gettime(0)) + 1
		gosub *music_play
		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 66 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_LANKATA_THE_LIGHTNING_OF_BLUE)
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 67 | _switch_sw ) {
		_switch_sw = 0
		tc = findchara(CREATURE_ID_AIKAGE_THE_SHINOBI_MASK)
		gosub *chat
		music = MUSICLIST_MCBOSS4
		gosub *music_play
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 62 | _switch_sw ) {
		_switch_sw = 0
		characreate -1, CREATURE_ID_MARKA_THE_SILVER_BEAR, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		snd SOUNDLIST_BASH1
		snd SOUNDLIST_BASH1
		txt lang("階段を下りた瞬間、あなたは銀髪の冒険者とぶつかった。", "So you are also of the same genus as the others...")
		tc = findchara(CREATURE_ID_MARKA_THE_SILVER_BEAR)
		gosub *chat
		if ( tc > MAX_CHARA_FOLLOWER ) {
			chara_vanquish tc
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 92 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_AMUR_CAGE ) {
			if ( gdata(GDATA_LEVEL) == 31 | gdata(GDATA_LEVEL) == 32 ) {
				if ( soulstage == 2 ) {
					tc = findunique(CREATURE_ID_STRAY_SOUL)
					gosub *chat
				}
			}
		}
		if ( gdata(GDATA_AREA) == AREA_AMUR_CAGE ) {
			if ( gdata(GDATA_LEVEL) == 1 ) {
				tc = findunique(CREATURE_ID_STRAY_SOUL)
				gosub *chat
			}
		}
		if ( gdata(GDATA_AREA) == AREA_AMUR_CAGE ) {
			if ( gdata(GDATA_LEVEL) == 11 | gdata(GDATA_LEVEL) == 12 ) {
				if ( soulstage == 3 ) {
					tc = findunique(CREATURE_ID_HELLABYRINTH_RULER)
					gosub *chat
				}
			}
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 64 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_NT_SOUTH_BORDER ) {
			snd SOUNDLIST_LOCKED1
			await 300
			snd SOUNDLIST_BOLT1
			await 300
			snd SOUNDLIST_BOLT1
			await 300
			snd SOUNDLIST_VOMIT
			await 300
			snd SOUNDLIST_BALL1
		}
		if ( gdata(GDATA_AREA) == AREA_NOYEL ) {
			snd SOUNDLIST_BOLT1
			await 300
			snd SOUNDLIST_BOLT1
			await 300
			snd SOUNDLIST_ATK_ICE
			await 300
			snd SOUNDLIST_ATK_ICE
			await 300
			snd SOUNDLIST_ATK_ICE
		}
		if ( gdata(GDATA_AREA) == AREA_BLIMP ) {
			snd SOUNDLIST_BOLT1
		}
		if ( gdata(GDATA_AREA) == AREA_DOCK ) {
			snd SOUNDLIST_BOLT1
			repeat 4
				await 60
				snd SOUNDLIST_FOOT1A
				snd SOUNDLIST_FOOT1B
				await 60
				snd SOUNDLIST_FOOT1B
				snd SOUNDLIST_FOOT1A
				await 60
			loop
		}
		await 300
		snd SOUNDLIST_EXITMAP1
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_RELATION, cnt) == RELATION_ENEMY ) {
				continue
			}
			if ( gdata(GDATA_AREA) == AREA_NT_SOUTH_BORDER ) {
				cdata(CDATA_HP, cnt) -= 2000
				if ( cdata(CDATA_HP, cnt) < 0 ) {
					cdata(CDATA_HP, cnt) = 1
				}
			}
			if ( gdata(GDATA_AREA) == AREA_NOYEL ) {
				if ( cdata(CDATA_ID, cnt) != CREATURE_ID_MARKA_THE_SILVER_BEAR ) {
					cdata(CDATA_CONDITION_CHILLS, cnt) = 50
					cdata(CDATA_HP, cnt) -= 2000 - sdata(SKILL_RES_COLD, cnt) / 50 * 10
					if ( cdata(CDATA_HP, cnt) < 0 ) {
						cdata(CDATA_HP, cnt) = 1
					}
				}
			}
		loop
		txt lang("あなた達は目的地まで辿り着いた…。", "So you are also of the same genus as the others...")
		if ( gdata(GDATA_AREA) == AREA_NT_SOUTH_BORDER ) {
			if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) < 5 ) {
				tc = findchara(CREATURE_ID_REGULUS_THE_ALTERED)
				gosub *chat
			}
		}
		if ( gdata(GDATA_AREA) == AREA_NOYEL ) {
			if ( gdata(GDATA_FLAG_SUB_REGULUS_MAYROON) < 5 ) {
				tc = findchara(CREATURE_ID_MARKA_THE_SILVER_BEAR)
				gosub *chat
				music = MUSICLIST_MCBOSS5
				gosub *music_play
			}
		}
		if ( gdata(GDATA_AREA) == AREA_BLIMP ) {
			if ( gdata(GDATA_FLAG_SUB_REGULUS_EULDERNA) < 5 ) {
				tc = findchara(CREATURE_ID_RAIZEL_THE_OLD_WIZARD)
				gosub *chat
				music = MUSICLIST_MCBOSS5
				gosub *music_play
			}
		}
		if ( gdata(GDATA_AREA) == AREA_DOCK ) {
			if ( gdata(GDATA_FLAG_SUB_REGULUS_KIKKASU) < 5 ) {
				tc = findchara(CREATURE_ID_SHURAIDA_THE_EXPERT_MERC)
				gosub *chat
				music = MUSICLIST_MCBOSS5
				gosub *music_play
			}
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 70 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_CHIME000R
		if ( gdata(GDATA_LEVEL) == 2 ) {
			tc = findchara(CREATURE_ID_AJETALIO_THE_SEMINAR_LECTURER)
			gosub *chat
		}
		if ( gdata(GDATA_LEVEL) == 3 ) {
			tc = findchara(CREATURE_ID_CRESCE_THE_SEMINAR_LECTURER)
			gosub *chat
		}
		if ( gdata(GDATA_LEVEL) == 4 ) {
			tc = findchara(CREATURE_ID_IDURU_THE_SEMINAR_LECTURER)
			gosub *chat
		}
		if ( gdata(GDATA_LEVEL) == 5 ) {
			tc = findchara(CREATURE_ID_MITO_THE_SEMINAR_LECTURER)
			gosub *chat
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 89 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) \ 10 == 2 ) {
			flt , 4
			characreate -1, CREATURE_ID_WORKER_02, 13, 16
			cdata(CDATA_SEX, rc) = 0
			cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
			cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
			cdata(CDATA_ROLE, rc) = ROLE_CARAVAN_MASTER
			cdata(CDATA_PIC, rc) = 761 + 7 * 1000
			cdata(CDATA_AI_CALM, rc) = 3
			tc = rc
			cbitmod CHARA_BIT_EVENT_TALK, tc, TRUE
			gosub *chat
		}
		tc = findcharawork(CREATURE_ID_WORKER_02)
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 83 | _switch_sw ) {
		_switch_sw = 0
		gdata(GDATA_FLAG_MAIN) = 850
		tc = findchara(CREATURE_ID_ORPHE_THE_CHAOS_DISCPLE)
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 84 | _switch_sw ) {
		_switch_sw = 0
		gdata(GDATA_FLAG_MAIN) = 860
		if ( findchara(CREATURE_ID_YAYAUHQUI_TEZCATLIPOCA) == 0 ) {
			flt
			initlv = 12000
			novoidlv = 1
			characreate -1, CREATURE_ID_YAYAUHQUI_TEZCATLIPOCA, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_RELATION, rc) = RELATION_ALLY
			cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
		}
		tc = findchara(CREATURE_ID_YAYAUHQUI_TEZCATLIPOCA)
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 85 | _switch_sw ) {
		_switch_sw = 0
		gdata(GDATA_FLAG_MAIN) = 870
		if ( findchara(CREATURE_ID_YAYAUHQUI_TEZCATLIPOCA) == 0 ) {
			flt
			initlv = 12000
			novoidlv = 1
			characreate -1, CREATURE_ID_YAYAUHQUI_TEZCATLIPOCA, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_RELATION, rc) = RELATION_ALLY
			cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
		}
		tc = findchara(CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD)
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 86 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_FLAG_MAIN) == 880 ) {
			tc = findchara(CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
		}
		if ( gdata(GDATA_FLAG_MAIN) == 890 ) {
			tc = findchara(CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD)
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 87 | _switch_sw ) {
		_switch_sw = 0
		gdata(GDATA_FLAG_MAIN) = 990
		music = MUSICLIST_SCENE_MUSIC
		gosub *music_play
		flt
		initlv = 1
		novoidlv = 1
		characreate -1, CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD, 10, 8
		cdata(CDATA_PIC, rc) = xy2pic(0, 24)
		tc = findchara(CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD)
		if ( tc != CHARA_PLAYER ) {
			gosub *chat
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 57 | _switch_sw ) {
		_switch_sw = 0
		characreate -1, CREATURE_ID_NORNE_THE_GUIDE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		snd SOUNDLIST_CHIME
		if ( gdata(GDATA_AREA) == AREA_LOST_YLVA ) {
			music = MUSICLIST_MCLOST1
			gosub *music_play
		}
		tc = findchara(CREATURE_ID_NORNE_THE_GUIDE)
		gosub *chat
		if ( tc > MAX_CHARA_FOLLOWER ) {
			chara_vanquish tc
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 58 | _switch_sw ) {
		_switch_sw = 0
		characreate -1, CREATURE_ID_MELUGAST_TYPE0_THE_DIMENSION_DRIVER, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		tc = findchara(CREATURE_ID_MELUGAST_TYPE0_THE_DIMENSION_DRIVER)
		gosub *chat
		if ( tc > MAX_CHARA_FOLLOWER ) {
			chara_vanquish tc
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 38 | _switch_sw ) {
		_switch_sw = 0
		gosub *screen_draw
		s = lang("隠れていたもの", "Reunion with your pet")
		file = "bg_re13"
		buff = lang("あなたは背後の気配に気付いて、ふと歩みを止めた。振り向いた先にいたのは…", "As you approach the mining town, you notice a familiar call and stop walking. Your old pet who got separated from you during the shipwreck is now running towards you joyfully! Your pet is...")
		listmax = 0
		list(0, listmax) = 1
		listn(0, listmax) = lang("妹だ！", "a sister!")
		listmax++
		list(0, listmax) = 2
		listn(0, listmax) = lang("お嬢様だ！", "a young lady!")
		listmax++
		list(0, listmax) = 3
		listn(0, listmax) = lang("姉だ！", "an older sister!")
		listmax++
		list(0, listmax) = 4
		listn(0, listmax) = lang("少女だ！", "a little girl!")
		listmax++
		list(0, listmax) = 5
		listn(0, listmax) = lang("少年だ！", "a little boy!")
		listmax++
		list(0, listmax) = 6
		listn(0, listmax) = lang("弟だ！", "a brother!")
		listmax++
		list(0, listmax) = 7
		listn(0, listmax) = lang("執事だ！", "a butler!")
		listmax++
		list(0, listmax) = 8
		listn(0, listmax) = lang("兄だ！", "an older brother!")
		listmax++
		gosub *re_select
		p = 3
		if ( rtval == 1 ) {
			p = 436
		}
		if ( rtval == 2 ) {
			p = 485
		}
		if ( rtval == 3 ) {
			p = 493
		}
		if ( rtval == 4 ) {
			p = 494
		}
		if ( rtval == 5 ) {
			p = 963
		}
		if ( rtval == 6 ) {
			p = 921
		}
		if ( rtval == 7 ) {
			p = 965
		}
		if ( rtval == 8 ) {
			p = 922
		}
		flt
		initlv = limit(cdata(CDATA_LEVEL, CHARA_PLAYER) * 2 / 3 + 1, 1, 50)
		novoidlv = 1
		characreate -1, p, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		wishally = 100
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 12 | _switch_sw ) {
		_switch_sw = 0
		gosub *screen_draw
		s = lang("ペットとの再会", "Reunion with your pet")
		file = "bg_re13"
		buff = lang("あなたは懐かしい鳴き声に気付いて、ふと歩みを止めた。なんと、船が難破した時に居なくなったあなたのペットが、嬉しそうに走ってくる！あなたのペットは…", "As you approach the mining town, you notice a familiar call and stop walking. Your old pet who got separated from you during the shipwreck is now running towards you joyfully! Your pet is...")
		listmax = 0
		list(0, listmax) = 1
		listn(0, listmax) = lang("犬だ！", "a dog!")
		listmax++
		list(0, listmax) = 2
		listn(0, listmax) = lang("猫だ！", "a cat!")
		listmax++
		list(0, listmax) = 3
		listn(0, listmax) = lang("クマだ！", "a bear!")
		listmax++
		list(0, listmax) = 4
		listn(0, listmax) = lang("少女だ！", "a little girl!")
		listmax++
		gosub *re_select
		p = 3
		if ( rtval == 1 ) {
			p = 165
		}
		if ( rtval == 2 ) {
			p = 164
		}
		if ( rtval == 3 ) {
			p = 108
		}
		if ( rtval == 4 ) {
			p = 166
		}
		flt
		initlv = limit(cdata(CDATA_LEVEL, CHARA_PLAYER) * 2 / 3 + 1, 1, 50)
		novoidlv = 1
		characreate -1, p, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		wishally = 100
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 59 | _switch_sw ) {
		_switch_sw = 0
		flt
		itemcreate -1, ITEM_ID_COFFIN_OF_NECROMANCY, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1), 0
		inv(INV_ITEM_PARAM1, ci) = gnecroid
		inv(INV_ITEM_WEIGHT, ci) += gnecroid * 1000
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + inv(INV_ITEM_PARAM3, ci) * 24
		snd SOUNDLIST_CURSE3
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 52 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒したオークが起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたはオークにトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_GODA_THE_CAPTAIN_OF_ORC, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 53 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒した科学者が起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたは科学者にトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_MAD_SCIENTIST, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 45 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒した堕天使が起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたは堕天使にトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_ISCA_THE_FALLEN_ANGEL, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 54 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒したダンジョンクリーナーが起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたはダンジョンクリーナーにトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_DUNGEON_CLEANER, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 46 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒した白虎が起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたは白虎にトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_LITYOU, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 47 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒した騎士が起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたは騎士にトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_MURDER_KNIGHT, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 79 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒した龍が起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたは龍にトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_SUNRISE_THE_ARCHIPELAGO_DRAGON, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 48 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒したかたつむりが起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたはかたつむりにトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_WING_SNAIL, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 49 | _switch_sw ) {
		_switch_sw = 0
		rc = tc
		txt lang("倒したイヌが起き上がり仲間になりたそうにこちらを見ている。仲間にしますか？", "This monster seems to want to be friends. Do you want to friend?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			txt lang("あなたはイヌにトドメを刺した。", "You stabbed the monster in the coffin.")
			goto *event_SWEND1
		}
		if ( rtval == 0 ) {
			txt lang("こんごともよろしく…。", "Thank you in the future.")
			flt
			novoidlv = 1
			characreate -1, CREATURE_ID_PASCAL, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		}
		gosub *add_ally
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 13 | _switch_sw ) {
		_switch_sw = 0
		music = MUSICLIST_MCWEDDING
		gosub *music_play
		s = lang("結婚", "Marriage")
		file = "bg_re14"
		buff = lang("長い交際の末、遂にあなたと" + name(marry) + "は固い絆で結ばれた。婚儀の後、あなたの元に幾つか祝儀品が届けられた。", "At last, you and " + name(marry) + " are united in marriage! After the wedding ceremony, you receive some gifts.")
		listmax = 0
		list(0, listmax) = 1
		listn(0, listmax) = lang("生涯をあなたに捧げる", "Without you, life has no meaning.")
		listmax++
		gosub *re_select
		repeat 3
			flt calcobjlv(cdata(CDATA_LEVEL, marry) + 5), calcfixlv(FIX_QUALITY_GREAT)
			flttypemajor = fsetchest(rnd(length(fsetchest)))
			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		loop
		picols = cdata(CDATA_CHARA_PIC, marry)
		if ( cdata(CDATA_PIC, marry) >= xy2pic(1, 21) & cdata(CDATA_PIC, marry) <= xy2pic(31, 21) ) {
			picols = 0
		}
		itemcreate -1, ITEM_ID_POTION_CURE_CORRUPTION, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		flt
		itemcreate -1, ITEM_ID_PLATINUM_COIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), rnd(3) + 2
		flt
		itemcreate -1, ITEM_ID_CARD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		inv(INV_ITEM_COL, ci) = cdata(CDATA_PIC, marry) \ 1000 + picols * 1000
		inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, marry)
		txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 90 | _switch_sw ) {
		_switch_sw = 0
		tc = tcbk
		if ( komaku >= 3 ) {
			mimikaki = 10
			komaku = 0
			haretu = 0
			snd SOUNDLIST_STAB
			if ( jp ) {
				txt "「〜〜〜〜〜〜〜〜〜っ！！！！！？？」", "「耳が、耳がぁ〜！！」"
			}
			if ( en ) {
				txt cnvtalk("!!!???"), cnvtalk("Eeeeeeeeeek!")
			}
			modimp tc, -20
			dmghp tc, rnd(sdata(SKILL_ATTR_STR, CHARA_PLAYER) * sqrt(sdata(SKILL_ATTR_STR, CHARA_PLAYER)) + sdata(SKILL_ATTR_STR, CHARA_PLAYER)), tc, SKILL_RES_SOUND, 1000
			goto *event_SWEND1
		}
		if ( haretu >= 3 ) {
			mimikaki = 10
			komaku = 0
			haretu = 0
			snd SOUNDLIST_BALL1
			if ( jp ) {
				txt "「ひぎぃ！？」", "「もうイヤー！」"
			}
			if ( en ) {
				txt cnvtalk("What are you doing!?"), cnvtalk("No...No...!")
			}
			modimp tc, -10
			dmgcon tc, CONDITION_BLEED, 100
			goto *event_SWEND1
		}
		if ( mimikaki < 3 ) {
			s = lang("耳掃除", "Mimikaki")
			file = "bg40"
			buff = lang("耳の中は見えづらい…。", "It's hard to see in the ear...")
			listmax = 0
			if ( rnd(sdata(SKILL_ATTR_DEX, CHARA_PLAYER) + sdata(SKILL_ATTR_PER, CHARA_PLAYER) + sdata(SKILL_ATTR_CON, tc) + sdata(SKILL_ATTR_WIL, tc)) > rnd(sorg(SKILL_ATTR_SPD, tc) + 10) ) {
				if ( mimikaki == 0 ) {
					list(0, listmax) = 1
					listn(0, listmax) = lang("慎重に入れる", "Put in carefully")
					listmax++
				}
				if ( mimikaki == 1 ) {
					list(0, listmax) = 2
					listn(0, listmax) = lang("奥まで入れる", "Put in all the way")
					listmax++
				}
				if ( mimikaki == 2 ) {
					list(0, listmax) = 3
					listn(0, listmax) = lang("丹念に掻き出す", "Carefully scrape")
					listmax++
				}
			}
			if ( rnd(sdata(SKILL_ATTR_WIL, CHARA_PLAYER) + 10) > rnd(sdata(SKILL_ATTR_WIL, tc) + 10) ) {
				list(0, listmax) = 4
				listn(0, listmax) = lang("サイズの調整", "Size adjustment")
				listmax++
			}
			if ( haretu == 0 ) {
				list(0, listmax) = 8
				listn(0, listmax) = lang("サイズ膨張", "Size expansion")
				listmax++
			}
			if ( haretu == 1 ) {
				list(0, listmax) = 9
				listn(0, listmax) = lang("サイズ大膨張", "Size large expansion")
				listmax++
			}
			if ( haretu == 2 ) {
				list(0, listmax) = 10
				listn(0, listmax) = lang("耳穴破裂", "Rupture of ear canal")
				listmax++
			}
			if ( komaku == 0 ) {
				list(0, listmax) = 5
				listn(0, listmax) = lang("突き入れる", "Thrust")
				listmax++
			}
			if ( komaku == 1 ) {
				list(0, listmax) = 6
				listn(0, listmax) = lang("奥まで突き刺す", "Stick in the ear")
				listmax++
			}
			if ( komaku == 2 ) {
				list(0, listmax) = 7
				listn(0, listmax) = lang("鼓膜をぶち破る", "Break through the eardrum")
				listmax++
			}
			gosub *re_select
			p = rtval
			if ( p == 1 | p == 2 | p == 3 ) {
				mimikaki++
				snd SOUNDLIST_SNOW
				if ( mimikaki == 1 ) {
					if ( jp ) {
						txt "「なんだか変な感じ" + _da(3) + "」", "「少しこわい" + _na(3) + "」", "「優しくして" + _kure(3) + "…」"
					}
				}
				if ( mimikaki == 1 ) {
					if ( en ) {
						txt cnvtalk("It is somehow strange feeling."), cnvtalk("A little scary."), cnvtalk("Please be gentle...")
					}
				}
				if ( mimikaki == 2 ) {
					if ( jp ) {
						txt "「くっ…♪」", "「気持ちいい" + _na(3) + "♪」", "「くすぐったい" + _yo(3) + "♪」"
					}
				}
				if ( mimikaki == 2 ) {
					if ( en ) {
						txt cnvtalk("Oh…"), cnvtalk("It feels good...!"), cnvtalk("It's tickling!")
					}
				}
			}
			if ( p == 4 ) {
				haretu = 0
				snd SOUNDLIST_OFFER2
			}
			if ( p == 5 | p == 6 | p == 7 ) {
				komaku++
				snd SOUNDLIST_CRACK
				if ( komaku < 3 ) {
					if ( jp ) {
						txt "「痛っ！」", "「鼓膜に当たった" + _yo(3) + "！？」", "「乱暴にしないで" + _kure(3) + "！」"
					}
				}
				if ( komaku < 3 ) {
					if ( en ) {
						txt cnvtalk("Ouch!"), cnvtalk("You are hurting my eardrum!"), cnvtalk("Don't be rough!")
					}
				}
			}
			if ( p == 8 | p == 9 | p == 10 ) {
				haretu++
				snd SOUNDLIST_CRACK2
				if ( haretu < 3 ) {
					if ( jp ) {
						txt "「なんか膨らんできた" + _yo(3) + "！？」", "「" + _ore(3) + "には大きすぎる" + _na(3) + "…」", "「ちょっと落ち着いて" + _kure(3) + "！」"
					}
				}
				if ( haretu < 3 ) {
					if ( en ) {
						txt cnvtalk("Something has swelled!?"), cnvtalk("It's too big for me..."), cnvtalk("Calm down a little!")
					}
				}
			}
			if ( mimikaki >= 3 ) {
				komaku = 0
				haretu = 0
				snd SOUNDLIST_DING3
				mimikaki = rnd(sqrt(sdata(SKILL_ATTR_DEX, CHARA_PLAYER) + 1) + 10)
				if ( mimikaki < 5 ) {
					txt lang("粉末みみくそがとれた！", "The powdered earwax has been removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 5000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 5000
					skillexp SKILL_ATTR_CON, tc, 5000
					skillexp SKILL_ATTR_WIL, tc, 5000
				}
				if ( mimikaki >= 5 & mimikaki < 15 ) {
					txt lang("欠片みみくそがとれた！", "The debris of the earwax has been removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 6000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 6000
					skillexp SKILL_ATTR_CON, tc, 6000
					skillexp SKILL_ATTR_WIL, tc, 6000
				}
				if ( mimikaki >= 15 & mimikaki < 20 ) {
					txt lang("膜状みみくそがとれた！", "The membranous earwax has been removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 7000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 7000
					skillexp SKILL_ATTR_CON, tc, 7000
					skillexp SKILL_ATTR_WIL, tc, 7000
				}
				if ( mimikaki >= 20 & mimikaki < 25 ) {
					txt lang("塊みみくそがとれた！", "The lump of earwax has been removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 8000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 8000
					skillexp SKILL_ATTR_CON, tc, 8000
					skillexp SKILL_ATTR_WIL, tc, 8000
				}
				if ( mimikaki >= 25 ) {
					txt lang("ひとつなぎのみみくそがとれた！", "All the earwax was connected and removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 9000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 9000
					skillexp SKILL_ATTR_CON, tc, 9000
					skillexp SKILL_ATTR_WIL, tc, 9000
				}
				mimikaki = 3
			}
			evadd EVENT_EAR_CLEANING
		}
		if ( mimikaki >= 3 & mimikaki < 10 ) {
			s = lang("反対側の耳", "Opposite ear")
			file = "bg41"
			buff = lang("構造が反転していてやりづらい…。", "The structure is inverted and difficult to do...")
			listmax = 0
			if ( rnd(sdata(SKILL_ATTR_DEX, CHARA_PLAYER) + sdata(SKILL_ATTR_PER, CHARA_PLAYER) + sdata(SKILL_ATTR_CON, tc) + sdata(SKILL_ATTR_WIL, tc)) > rnd(sorg(SKILL_ATTR_SPD, tc) + 10) ) {
				if ( mimikaki == 3 ) {
					list(0, listmax) = 1
					listn(0, listmax) = lang("慎重に入れる", "Put in carefully")
					listmax++
				}
				if ( mimikaki == 4 ) {
					list(0, listmax) = 2
					listn(0, listmax) = lang("奥まで入れる", "Put in all the way")
					listmax++
				}
				if ( mimikaki == 5 ) {
					list(0, listmax) = 3
					listn(0, listmax) = lang("丹念に掻き出す", "Carefully scrape")
					listmax++
				}
			}
			if ( rnd(sdata(SKILL_ATTR_WIL, CHARA_PLAYER) + 10) > rnd(sdata(SKILL_ATTR_WIL, tc) + 10) ) {
				list(0, listmax) = 4
				listn(0, listmax) = lang("サイズの調整", "Size adjustment")
				listmax++
			}
			if ( haretu == 0 ) {
				list(0, listmax) = 8
				listn(0, listmax) = lang("サイズ膨張", "Size expansion")
				listmax++
			}
			if ( haretu == 1 ) {
				list(0, listmax) = 9
				listn(0, listmax) = lang("サイズ大膨張", "Size large expansion")
				listmax++
			}
			if ( haretu == 2 ) {
				list(0, listmax) = 10
				listn(0, listmax) = lang("耳穴破裂", "Rupture of ear canal")
				listmax++
			}
			if ( komaku == 0 ) {
				list(0, listmax) = 5
				listn(0, listmax) = lang("突き入れる", "Thrust")
				listmax++
			}
			if ( komaku == 1 ) {
				list(0, listmax) = 6
				listn(0, listmax) = lang("奥まで突き刺す", "Stick in the ear")
				listmax++
			}
			if ( komaku == 2 ) {
				list(0, listmax) = 7
				listn(0, listmax) = lang("鼓膜をぶち破る", "Break through the eardrum")
				listmax++
			}
			gosub *re_select
			p = rtval
			if ( p == 1 | p == 2 | p == 3 ) {
				mimikaki++
				snd SOUNDLIST_SNOW
				if ( mimikaki == 4 ) {
					if ( jp ) {
						txt "「なんだか変な感じ" + _da(3) + "」", "「少しこわい" + _na(3) + "」", "「優しくして" + _kure(3) + "…」"
					}
				}
				if ( mimikaki == 4 ) {
					if ( en ) {
						txt cnvtalk("It is somehow strange feeling."), cnvtalk("A little scary."), cnvtalk("Please be gentle...")
					}
				}
				if ( mimikaki == 5 ) {
					if ( jp ) {
						txt "「くっ…♪」", "「気持ちいい" + _na(3) + "♪」", "「くすぐったい" + _yo(3) + "♪」"
					}
				}
				if ( mimikaki == 5 ) {
					if ( en ) {
						txt cnvtalk("Oh…"), cnvtalk("It feels good...!"), cnvtalk("It's tickling!")
					}
				}
			}
			if ( p == 4 ) {
				haretu = 0
				snd SOUNDLIST_OFFER2
			}
			if ( p == 5 | p == 6 | p == 7 ) {
				komaku++
				snd SOUNDLIST_CRACK
				if ( komaku < 3 ) {
					if ( jp ) {
						txt "「痛っ！」", "「鼓膜に当たった" + _yo(3) + "！？」", "「乱暴にしないで" + _kure(3) + "！」"
					}
				}
				if ( komaku < 3 ) {
					if ( en ) {
						txt cnvtalk("Ouch!"), cnvtalk("You are hurting my eardrum!"), cnvtalk("Don't be rough!")
					}
				}
			}
			if ( p == 8 | p == 9 | p == 10 ) {
				haretu++
				snd SOUNDLIST_CRACK2
				if ( haretu < 3 ) {
					if ( jp ) {
						txt "「なんか膨らんできた" + _yo(3) + "！？」", "「" + _ore(3) + "には大きすぎる" + _na(3) + "…」", "「ちょっと落ち着いて" + _kure(3) + "！」"
					}
				}
				if ( haretu < 3 ) {
					if ( en ) {
						txt cnvtalk("Something has swelled!?"), cnvtalk("It's too big for me..."), cnvtalk("Calm down a little!")
					}
				}
			}
			if ( mimikaki >= 6 ) {
				komaku = 0
				haretu = 0
				snd SOUNDLIST_COMPLETE1
				mimikaki = rnd(sqrt(sdata(SKILL_ATTR_DEX, CHARA_PLAYER) + 1) + 10)
				if ( mimikaki < 5 ) {
					txt lang("粉末みみくそがとれた！", "The powdered earwax has been removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 5000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 5000
					skillexp SKILL_ATTR_CON, tc, 5000
					skillexp SKILL_ATTR_WIL, tc, 5000
				}
				if ( mimikaki >= 5 & mimikaki < 15 ) {
					txt lang("欠片みみくそがとれた！", "The debris of the earwax has been removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 6000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 6000
					skillexp SKILL_ATTR_CON, tc, 6000
					skillexp SKILL_ATTR_WIL, tc, 6000
				}
				if ( mimikaki >= 15 & mimikaki < 20 ) {
					txt lang("膜状みみくそがとれた！", "The membranous earwax has been removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 7000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 7000
					skillexp SKILL_ATTR_CON, tc, 7000
					skillexp SKILL_ATTR_WIL, tc, 7000
				}
				if ( mimikaki >= 20 & mimikaki < 25 ) {
					txt lang("塊みみくそがとれた！", "The lump of earwax has been removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 8000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 8000
					skillexp SKILL_ATTR_CON, tc, 8000
					skillexp SKILL_ATTR_WIL, tc, 8000
				}
				if ( mimikaki >= 25 ) {
					txt lang("ひとつなぎのみみくそがとれた！", "All the earwax was connected and removed!")
					skillexp SKILL_ATTR_DEX, CHARA_PLAYER, 9000
					skillexp SKILL_ATTR_PER, CHARA_PLAYER, 9000
					skillexp SKILL_ATTR_CON, tc, 9000
					skillexp SKILL_ATTR_WIL, tc, 9000
				}
				if ( jp ) {
					txt "「こんなに出た" + _noka(3) + "？」", "「気持ちよかった" + _yo(3) + "」", "「またして" + _kure(3) + "…」"
				}
				if ( en ) {
					txt cnvtalk("Is it over?"), cnvtalk("It was comfortable!"), cnvtalk("Please do more...!")
				}
				mimikaki = 10
				cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
				goto *event_SWEND1
			}
			evadd EVENT_EAR_CLEANING
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 82 | _switch_sw ) {
		_switch_sw = 0
		s = lang("くじ引き", "Lottery")
		file = "bg38"
		buff = lang("あなたの目の前に富の女神が現れ、くじ引きの箱を置いた。", "The goddess of wealth appears in front of you and places a lottery box.")
		listmax = 0
		list(0, listmax) = 1
		listn(0, listmax) = lang("祈りながらくじを選ぶ", "Good luck to me.")
		listmax++
		list(0, listmax) = 2
		listn(0, listmax) = lang("最初に手に触れたくじを選ぶ", "First lottery that touched my hand would be fate.")
		listmax++
		list(0, listmax) = 3
		listn(0, listmax) = lang("漁りながら、これだ！と感じたくじを選ぶ", "I leave it to my intuition!")
		listmax++
		gosub *re_select
		redraw 0
		gosub *screen_draw
		gosub *screen_fade
		gsel BUFFER_BUF
		pos 0, 0
		picload exedir + "graphic\\face1" + devfile + ".bmp", 1
		gsel BUFFER_SCREEN
		snd SOUNDLIST_CHIME
		await 300
		snd SOUNDLIST_CHIME
		await 300
		snd SOUNDLIST_CHIME
		s = lang("星の光", "Result")
		file = "bg39"
		buff = lang("手にしたくじが光の粒子に変わり、あなたの足元に集まっていく…。", "The lottery you get turns into particles of light and gathers at your feet...")
		listmax = 0
		list(0, listmax) = 1
		listn(0, listmax) = lang("何だろう？", "what?")
		listmax++
		list(0, listmax) = 2
		listn(0, listmax) = lang("これは…！", "Yeah!")
		listmax++
		list(0, listmax) = 3
		listn(0, listmax) = lang("来いッ！", "Come on!")
		listmax++
		gosub *re_select
		snd SOUNDLIST_OFFER2
		animeload 32, 0
		kaiwa = rnd(25)
		if ( kaiwa == 0 ) {
			id = 1168
		}
		if ( kaiwa == 1 ) {
			id = 1167
		}
		if ( kaiwa == 2 ) {
			id = 1166
		}
		if ( kaiwa == 3 ) {
			id = 1165
		}
		if ( kaiwa == 4 ) {
			id = 1164
		}
		if ( kaiwa == 5 ) {
			id = 1163
		}
		if ( kaiwa == 6 ) {
			id = 1162
		}
		if ( kaiwa == 7 ) {
			id = 1161
		}
		if ( kaiwa == 8 ) {
			id = 1160
		}
		if ( kaiwa == 9 ) {
			id = 1159
		}
		if ( kaiwa == 10 ) {
			id = 1158
		}
		if ( kaiwa == 11 ) {
			id = 1157
		}
		if ( kaiwa == 12 ) {
			id = 1156
		}
		if ( kaiwa == 13 ) {
			id = 1101
		}
		if ( kaiwa == 14 ) {
			id = 1075
		}
		if ( kaiwa == 15 ) {
			id = 1039
		}
		if ( kaiwa == 16 ) {
			id = 983
		}
		if ( kaiwa == 17 ) {
			id = 846
		}
		if ( kaiwa == 18 ) {
			id = 802
		}
		if ( kaiwa == 19 ) {
			id = 741
		}
		if ( kaiwa == 20 ) {
			id = 758
		}
		if ( kaiwa == 21 ) {
			id = 757
		}
		if ( kaiwa == 22 ) {
			id = 761
		}
		if ( kaiwa == 23 ) {
			id = 1183
		}
		if ( kaiwa == 24 ) {
			id = 57
		}
		flt
		itemcreate -1, id, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 34 | _switch_sw ) {
		_switch_sw = 0
		voidboss = 300, 28, 29, 140, 34, 141, 143, 144, 145, 242, 257, 230, 202, 37, 33, 80, 332, 139, 146, 213
		if ( gdata(GDATA_FLAG_MAIN) > 180 ) {
			voidboss = 178, 28, 29, 140, 177, 141, 143, 144, 145, 242, 257, 230, 37, 80, 139, 146, 213, 2, 23, 477
		}
		if ( gdata(GDATA_FLAG_MAIN) > 350 ) {
			voidboss = 178, 28, 29, 140, 177, 141, 143, 144, 145, 242, 257, 230, 37, 80, 139, 146, 213, 379, 378, 377, 2, 23, 477, 380, 523, 439
		}
		randomize gdata(GDATA_YEAR) + gdata(GDATA_LEVEL)
		c = voidboss(rnd(length(voidboss)))
		randomize
		flt
		fixlv = FIX_QUALITY_MIRACLE
		initlv = limit(gdata(GDATA_LEVEL) + 20, 1, 6666)
		novoidlv = 1
		characreate -1, c, -3, 0
		cbitmod CHARA_BIT_PRECIOUS, rc, TRUE
		cdata(CDATA_RELATION, rc) = RELATION_ENEMY
		cdata(CDATA_RELATION_ORG, rc) = RELATION_ENEMY
		tc = rc
		adata(ADATA_BOSS, gdata(GDATA_AREA)) = tc
		txtef COLOR_RED
		txtmore
		txt lang("気をつけろ！この階は" + mapname(gdata(GDATA_AREA)) + "の守護者、" + cdatan(CDATAN_NAME, tc) + "によって守られている。", "Be aware! This level is guarded by the lord of " + mapname(gdata(GDATA_AREA)) + ", " + cdatan(CDATAN_NAME, tc) + ".")
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 4 | _switch_sw ) {
		_switch_sw = 0
		repeat
			if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) == 0 ) {
				gosub *fltChara
				fixlv = FIX_QUALITY_MIRACLE
				initlv = gdata(GDATA_LEVEL) + rnd(5)
				characreate -1, CREATURE_ID_BUG, -3, 0
				if ( stat == 0 ) {
					continue
				}
				else {
					cbitmod CHARA_BIT_PRECIOUS, rc, TRUE
					break
				}
			}
			if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) != 0 ) {
				gosub *fltChara
				fixlv = FIX_QUALITY_MIRACLE
				initlv = gdata(GDATA_LEVEL) + 100
				characreate -1, CREATURE_ID_BUG, -3, 0
				if ( stat == 0 ) {
					continue
				}
				else {
					cbitmod CHARA_BIT_PRECIOUS, rc, TRUE
					cbitmod CHARA_BIT_AWAKE_NEAR_DEATH_DAMAGE, rc, TRUE
					cbitmod CHARA_BIT_AWAKE_NEAR_DEATH_EVASION, rc, TRUE
					break
				}
			}
		loop
		tc = rc
		adata(ADATA_BOSS, gdata(GDATA_AREA)) = tc
		cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
		txt lang("どうやら最深層まで辿り着いたらしい…", "It seems you have reached the deepest level of this dungeon.")
		txtef COLOR_RED
		txtmore
		txt lang("気をつけろ！この階は" + mapname(gdata(GDATA_AREA)) + "の守護者、" + cdatan(CDATAN_NAME, tc) + "によって守られている。", "Be aware! This level is guarded by the lord of " + mapname(gdata(GDATA_AREA)) + ", " + cdatan(CDATAN_NAME, tc) + ".")
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 5 | _switch_sw ) {
		_switch_sw = 0
		if ( adata(ADATA_BOSS, gdata(GDATA_AREA)) == (-1) ) {
			goto *event_SWEND1
		}
		music = MUSICLIST_MCVICTORY
		gosub *music_play
		snd SOUNDLIST_COMPLETE1
		nkane = limit(gdata(GDATA_LEVEL), 1, 400)
		flt calcobjlv(), calcfixlv()
		flttypemajor = FILTER_ITEM_SPELLBOOK
		itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		flt
		itemcreate -1, ITEM_ID_SCROLL_ESCAPE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		flt
		itemcreate -1, ITEM_ID_SCROLL_RETURN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		flt
		itemcreate -1, ITEM_ID_GOLD_PIECE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), limit(nkane * 50 + nkane * sqrt(nkane + 1) * 5 + 200, 300, 50000)
		flt
		itemcreate -1, ITEM_ID_PLATINUM_COIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), limit(1 + gdata(GDATA_LEVEL) / 20, 1, 5)
		flt
		itemcreate -1, ITEM_ID_BEJEWELED_CHEST, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		inv(INV_ITEM_PARAM2, ci) = 0
		if ( gdata(GDATA_AREA) != AREA_VOID ) {
			if ( gdata(GDATA_FLAG_DESTINY_NEFIA_BOSSES_DEFEATED) < 1 ) {
				gdata(GDATA_FLAG_DESTINY_NEFIA_BOSSES_DEFEATED)++
				if ( gdata(GDATA_FLAG_DESTINY_NEFIA_BOSSES_DEFEATED) >= 1 ) {
					if ( gdata(GDATA_FLAG_DESTINY_LETTERS) < 7 ) {
						gdata(GDATA_FLAG_DESTINY_LETTERS)++
					}
				}
			}
			gskill = 175
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "kobolt" ) {
				gskill = 300
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "orc" ) {
				gskill = 168
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "largeanimal" ) {
				gskill = 162
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "lizardman" ) {
				gskill = 168
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "minotaur" ) {
				gskill = 186
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "yerles" ) {
				gskill = 111
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "norland" ) {
				gskill = 167
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "eulderna" ) {
				gskill = 160
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "fairy" ) {
				gskill = 300
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "asura" ) {
				gskill = 166
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "slime" ) {
				gskill = 173
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "doggod" ) {
				gskill = 186
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "dwarf" ) {
				gskill = 163
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "juere" ) {
				gskill = 183
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "zombie" ) {
				gskill = 184
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "elea" ) {
				gskill = 165
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "rabbit" ) {
				gskill = 182
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "sheep" ) {
				gskill = 177
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "frog" ) {
				gskill = 190
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "worm" ) {
				gskill = 163
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "snail" ) {
				gskill = 111
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "mandrake" ) {
				gskill = 165
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "beetle" ) {
				gskill = 172
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "mushroom" ) {
				gskill = 180
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "bat" ) {
				gskill = 187
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "ent" ) {
				gskill = 176
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "lich" ) {
				gskill = 174
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "bacteria" ) {
				gskill = 151
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "ghost" ) {
				gskill = 175
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "spirit" ) {
				gskill = 160
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "eye" ) {
				gskill = 151
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "mazin" ) {
				gskill = 152
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "wasp" ) {
				gskill = 180
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "giant" ) {
				gskill = 161
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "imp" ) {
				gskill = 156
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "hand" ) {
				gskill = 184
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "snake" ) {
				gskill = 157
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "drake" ) {
				gskill = 188
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "goblin" ) {
				gskill = 185
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "bear" ) {
				gskill = 186
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "armor" ) {
				gskill = 158
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "medusa" ) {
				gskill = 178
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "cupid" ) {
				gskill = 188
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "karune" ) {
				gskill = 180
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "harpy" ) {
				gskill = 164
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "dragon" ) {
				gskill = 179
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "dinosaur" ) {
				gskill = 182
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "beast" ) {
				gskill = 172
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "spider" ) {
				gskill = 177
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "golem" ) {
				gskill = 153
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "rock" ) {
				gskill = 189
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "zanan" ) {
				gskill = 183
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "skeleton" ) {
				gskill = 158
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "piece" ) {
				gskill = 152
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "cat" ) {
				gskill = 187
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "dog" ) {
				gskill = 190
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "roran" ) {
				gskill = 150
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "rat" ) {
				gskill = 157
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "shell" ) {
				gskill = 162
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "catgod" ) {
				gskill = 187
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "machinegod" ) {
				gskill = 189
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "undeadgod" ) {
				gskill = 188
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "machine" ) {
				gskill = 176
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "wisp" ) {
				gskill = 155
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "bird" ) {
				gskill = 161
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "seamonster" ) {
				gskill = 181
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "catsister" ) {
				gskill = 167
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "mutant" ) {
				gskill = 164
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "yeek" ) {
				gskill = 156
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "yith" ) {
				gskill = 174
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "servant" ) {
				gskill = 172
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "horse" ) {
				gskill = 153
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "god" ) {
				gskill = 166
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "quickling" ) {
				gskill = 173
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "metal" ) {
				gskill = 179
			}
			if ( cdatan(CDATAN_RACE, adata(ADATA_BOSS, gdata(GDATA_AREA))) == "vehicle" ) {
				gskill = 175
			}
			kazu = 0
			if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) != 0 ) {
				kazu++
			}
			if ( gdata(GDATA_FLAG_NEFIA_FEVER_ACTIVE) == 100 ) {
				kazu++
			}
			flt
			itemcreate -1, ITEM_ID_MEMORY_FRAGMENT, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 5 + kazu
			inv(INV_ITEM_PARAM1, ci) = gskill
			inv(INV_ITEM_PARAM2, ci) = limit(gdata(GDATA_LEVEL), 1, 999)
			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
			flt
			itemcreate -1, ITEM_ID_MEMORY_CONVERTER, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), limit(gdata(GDATA_LEVEL) / 50 + 1, 1, 5) + kazu
			inv(INV_ITEM_PARAM1, ci) = gskill
			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		}
		if ( adata(ADATA_EXTRA_MEDAL, gdata(GDATA_AREA)) > 0 ) {
			flt
			itemcreate -1, ITEM_ID_SMALL_MEDAL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			if ( gdata(GDATA_FLAG_NEFIA_FEVER_ACTIVE) == 100 ) {
				flt
				itemcreate -1, ITEM_ID_SMALL_MEDAL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			}
			if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) != 0 ) {
				flt
				itemcreate -1, ITEM_ID_SMALL_MEDAL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			}
		}
		adata(ADATA_EXTRA_MEDAL, gdata(GDATA_AREA)) = 0
		if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) != 0 ) {
			if ( adata(ADATA_NEFIA_GEM_CHANCE, gdata(GDATA_AREA)) > 0 ) {
				flt
				itemcreate -1, ITEM_ID_CORE_OF_NEFIA, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			}
		}
		adata(ADATA_NEFIA_GEM_CHANCE, gdata(GDATA_AREA)) = 0
		if ( gdata(GDATA_DEEPEST_LEVEL) < gdata(GDATA_LEVEL) ) {
			gdata(GDATA_DEEPEST_LEVEL) = gdata(GDATA_LEVEL)
		}
		txtef COLOR_GREEN
		txt lang("クエストを達成した！", "You have completed the quest!")
		snd SOUNDLIST_COMPLETE1
		txtmore
		txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
		modrank 2, 300, 8
		gdata(GDATA_QUEST_FAME) = calcfame(CHARA_PLAYER, gdata(GDATA_LEVEL) * 30 + 200)
		txtef COLOR_GREEN
		txtmore
		txt lang("" + gdata(GDATA_QUEST_FAME) + "の名声値を手に入れた。", "You gain " + gdata(GDATA_QUEST_FAME) + " fame.")
		cdata(CDATA_FAME, CHARA_PLAYER) += gdata(GDATA_QUEST_FAME)
		if ( gdata(GDATA_AREA) == AREA_VOID ) {
			adata(ADATA_BOSS, gdata(GDATA_AREA)) = 0
			gdata(GDATA_VOID_BOSS) = gdata(GDATA_VOID_BOSS) + 5
			txt lang("この階の封印が解けたようだ！", "The seal of this level is now broken!")
		}
		else {
			gdata(GDATA_FLAG_NEFIA_CONQUERED)++
			adata(ADATA_BOSS, gdata(GDATA_AREA)) = -1
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 16 | _switch_sw ) {
		_switch_sw = 0
		txt lang("あなたは無事に護衛の任務を終えた。", "You complete the escort.")
		tc = evdata2(evnum - (evnum != 0) * 1)
		gosub *chat
		rq = evdata1(evnum - (evnum != 0) * 1)
		gosub *quest_success
		chara_vanquish evdata2(evnum - (evnum != 0) * 1)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 15 | _switch_sw ) {
		_switch_sw = 0
		repeat gdata(GDATA_CLIENT)
			if ( qdata(QDATA_EXIST, cnt) == QUEST_TYPE_ESCORT ) {
				if ( qdata(QDATA_STATE, cnt) == QUEST_STATE_ONGOING ) {
					if ( qdata(QDATA_PARAM2, cnt) == evdata1(evnum - (evnum != 0) * 1) ) {
						rq = cnt
						val = qdata(QDATA_EXIST, rq)
						gosub *quest_fail
						break
					}
				}
			}
		loop
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 6 | _switch_sw ) {
		_switch_sw = 0
		if ( cdata(CDATA_LEVEL, CHARA_PLAYER) >= 10 ) {
			repeat 50 - 10, 10
				if ( cnt <= 17 ) {
					if ( sdata(cnt, CHARA_PLAYER) != 0 ) {
						if ( rnd(3) == 0 ) {
							txtmore
							skillexp cnt, CHARA_PLAYER, -500
						}
					}
				}
			loop
			if ( cdata(CDATA_KARMA, CHARA_PLAYER) < (-30) ) {
				modkarma 0, 10
			}
		}
		else {
			txt lang("レベル10に達していないので能力値の減少はない。", "Death penalty won't be applied until you hit Lv 10.")
		}
		if ( gdata(GDATA_CORRUPTION) >= 20000 ) {
			modcorrupt -2000
		}
		txtmore
		txt lang("金貨を幾らか失った…", "You lost some money.")
		cdata(CDATA_GOLD, CHARA_PLAYER) -= cdata(CDATA_GOLD, CHARA_PLAYER) / 3
		decfame CHARA_PLAYER, 10
		r1 = 0
		gosub *charaRefresh
		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 20 | _switch_sw ) {
		_switch_sw = 0
		dmghp evdata1(evnum - (evnum != 0) * 1), 9999, DAMAGE_FROM_UNSEEN
		cdata(CDATA_ROLE, evdata1(evnum - (evnum != 0) * 1)) = ROLE_NONE
		cdata(CDATA_EXIST, evdata1(evnum - (evnum != 0) * 1)) = CHAR_STATE_DEAD
		flt
		itemcreate -1, ITEM_ID_PLATINUM_COIN, cdata(CDATA_X, evdata1(evnum - (evnum != 0) * 1)), cdata(CDATA_Y, evdata1(evnum - (evnum != 0) * 1)), 4
		gdata(GDATA_FLAG_SUB_MOTHER) = 1001
		tc = findchara(CREATURE_ID_LONELY_PAEL)
		if ( tc != CHARA_PLAYER ) {
			if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
				txtef COLOR_BLUE
				txt lang("パエル「おかあさんーー！！」", cnvtalk("M-mom...!!"))
				cdata(CDATA_RELATION, tc) = RELATION_ENEMY
				cdata(CDATA_AI_AGGRO, tc) = 1000
				cdata(CDATA_TARGET, tc) = 0
			}
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 76 | _switch_sw ) {
		_switch_sw = 0
		flt
		initlv = 200
		novoidlv = 1
		characreate -1, CREATURE_ID_BLACK_GAUNTLET_LEOLD, 10, 7
		cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 73 | _switch_sw ) {
		_switch_sw = 0
		flt
		initlv = 200
		novoidlv = 1
		characreate -1, CREATURE_ID_BLACK_GAUNTLET_LEOLD, evdata1(evnum - (evnum != 0) * 1), evdata2(evnum - (evnum != 0) * 1)
		cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		msg_halt
		msg_clear
		txtef COLOR_YELLOW
		txt lang("「合格だ！」", cnvtalk("Let 's fight as you wish!!"))
		msg_halt
		txtef COLOR_YELLOW
		txt lang("「お前は決戦因子としてふさわしい力を示した」", cnvtalk("Let 's fight as you wish!!"))
		msg_halt
		txtef COLOR_YELLOW
		txt lang("「これなら混沌の神も倒せるかもしれん…いや、きっと倒せる！」", cnvtalk("Let 's fight as you wish!!"))
		msg_halt
		repeat 2
			tc = findchara(CREATURE_ID_TALON_SOLDIER)
			if ( tc > CHARA_PLAYER ) {
				chara_vanquish tc
			}
		loop
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 71 | _switch_sw ) {
		_switch_sw = 0
		chara_vanquish findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
		txtef COLOR_YELLOW
		txt lang("「望み通り戦ってやろう！」", cnvtalk("Let 's fight as you wish!!"))
		flt
		novoidlv = 1
		characreate -1, CREATURE_ID_TEZCATLIPOCA, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
		cdata(CDATA_POWER_GAUGE, rc) = 100
		cdata(CDATA_RELATION, rc) = RELATION_ENEMY
		cdata(CDATA_AI_AGGRO, rc) = 1000
		cdata(CDATA_TARGET, rc) = 0
		music = MUSICLIST_MCBOSS5
		gosub *music_play
		gdata(GDATA_FLAG_MAIN) = 675
		tc = findchara(CREATURE_ID_TEZCATLIPOCA)
		if ( tc != CHARA_PLAYER ) {
			if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
				animeid = ANIMATION_GENE
				anic = tc
				gosub *anime
				cc = tc
				efid = SKILL_SPACT_SMOKE_MIRROR
				gosub *effect
				evadd EVENT_TEZCATLIPOCA_ADDS
			}
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 72 | _switch_sw ) {
		_switch_sw = 0
		txtsettezca 3
		repeat 3
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 250, 0
		gosub *prompt_key
		txtef COLOR_YELLOW
		txt lang("「これが返事だ」", cnvtalk("This is my reply!!"))
		snd SOUNDLIST_PUNISH1
		if ( cfg_attackanime ) {
			animeload 39, 0
		}
		cdata(CDATA_HP, CHARA_PLAYER) = (cdata(CDATA_HP, CHARA_PLAYER) + 1) * 3 / 5
		cc = tc
		efid = SKILL_SPACT_DIMENSIONAL_MOVE
		gosub *effect
		flt
		characreate -1, CREATURE_ID_TALON_SOLDIER, cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
		cdata(CDATA_AI_AGGRO, rc) = 1000
		cdata(CDATA_TARGET, rc) = 0
		flt
		characreate -1, CREATURE_ID_TALON_SOLDIER, cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
		cdata(CDATA_AI_AGGRO, rc) = 1000
		cdata(CDATA_TARGET, rc) = 0
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 68 | _switch_sw ) {
		_switch_sw = 0
		cdata(CDATA_HP, evdata1(evnum - (evnum != 0) * 1)) = 0
		dmghp evdata1(evnum - (evnum != 0) * 1), 10, DAMAGE_FROM_SCALP
		cdata(CDATA_ROLE, evdata1(evnum - (evnum != 0) * 1)) = ROLE_NONE
		cdata(CDATA_EXIST, evdata1(evnum - (evnum != 0) * 1)) = CHAR_STATE_DEAD
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 43 | _switch_sw ) {
		_switch_sw = 0
		dmghp evdata1(evnum - (evnum != 0) * 1), 99999, DAMAGE_FROM_UNSEEN
		cdata(CDATA_ROLE, evdata1(evnum - (evnum != 0) * 1)) = ROLE_NONE
		cdata(CDATA_EXIST, evdata1(evnum - (evnum != 0) * 1)) = CHAR_STATE_DEAD
		flt
		itemcreate -1, ITEM_ID_SPEED_RING, cdata(CDATA_X, evdata1(evnum - (evnum != 0) * 1)), cdata(CDATA_Y, evdata1(evnum - (evnum != 0) * 1)), 0
		flt
		itemcreate -1, ITEM_ID_GERBERA_CROSS, cdata(CDATA_X, evdata1(evnum - (evnum != 0) * 1)), cdata(CDATA_Y, evdata1(evnum - (evnum != 0) * 1)), 0
		txtef COLOR_BLUE
		txt lang("？？？「本当に忍をやめたければ死ぬしかない。これが忍の掟だ」", cnvtalk("This is the Ninja's rule."))
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 65 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_TOWN ) {
			flt
			characreate -1, CREATURE_ID_FRON_THE_TOUR_PLANNER, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_AI_CALM, rc) = 3
			cbitmod CHARA_BIT_GUEST, rc, TRUE
		}
		if ( mdata(MDATA_TYPE) >= (20 /*!!!@[MAP_TYPE_DUNGEON @@@ MAP_TYPE_DUNGEON_MIN]@!!! */) ) {
			flt
			initlv = limit(gdata(GDATA_LEVEL) * 3 / 4, 1, 1300)
			novoidlv = 1
			characreate -1, CREATURE_ID_13TH_STEP_GHOST, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			cdata(CDATA_AI_AGGRO, rc) = 80
			cdata(CDATA_TARGET, rc) = 0
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 44 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_HOME ) {
			if ( gdata(GDATA_FLAG_INVITED_GOD) != 0 ) {
				gdata(GDATA_TEMPORARY_FLAGS2) = 10
				if ( gdata(GDATA_FLAG_INVITED_GOD) == 342 ) {
					dbid = 342
					txt lang("機械のマニ「これが定命の住居か。記録しておこう」", cnvtalk("Well done. After all, you might be useful than I thought."))
				}
				if ( gdata(GDATA_FLAG_INVITED_GOD) == 306 ) {
					dbid = 306
					txt lang("風のルルウィ「この中で嵐を起こしたらさぞかし爽快でしょうね…冗談よ」", cnvtalk("Oh my little puppet, you serve me well."))
				}
				if ( gdata(GDATA_FLAG_INVITED_GOD) == 484 ) {
					dbid = 484
					txt lang("元素のイツパロトル「楽園か…懐かしい響きだ」", cnvtalk("Impressive. Your action shall be remembered."))
				}
				if ( gdata(GDATA_FLAG_INVITED_GOD) == 331 ) {
					dbid = 331
					txt lang("幸運のエヘカトル「うみみゃ！たらばがに！たらばがにどこ？」", cnvtalk("Weeee! I'm so happy. I like you! I like you!"))
				}
				if ( gdata(GDATA_FLAG_INVITED_GOD) == 338 ) {
					dbid = 338
					txt lang("地のオパートス「フッハハハハー！フハハハー！お邪魔するぞ！」", cnvtalk("Muwahaha muwaha. Good. Good!"))
				}
				if ( gdata(GDATA_FLAG_INVITED_GOD) == 359 ) {
					dbid = 359
					txt lang("癒しのジュア「お、お邪魔します…うっ！私の部屋より片付いてる…」", cnvtalk("W-What? I-I'm not gonna praise you. I'm not!"))
				}
				if ( gdata(GDATA_FLAG_INVITED_GOD) == 339 ) {
					dbid = 339
					txt lang("収穫のクミロミ「ここが君の家なんだね…。隅々まで見ても…いいかな…？」", cnvtalk("Good work...truly..."))
				}
				if ( gdata(GDATA_FLAG_INVITED_GOD) == 482 ) {
					dbid = 482
					txt lang("富のヤカテクト「へぇぇ、これで入場料タダなん？もったいないわぁ…」", cnvtalk("Good job, just like that! Keep it up!"))
				}
				flt
				novoidlv = 1
				characreate -1, dbid, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_AI_CALM, rc) = 2
				gdata(GDATA_FLAG_INVITED_GOD) = 0
			}
		}
		if ( gdata(GDATA_AREA) == AREA_NOYEL ) {
			flt
			characreate -1, CREATURE_ID_MARKA_THE_SILVER_BEAR, 50, 13
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			cdata(CDATA_AI_CALM, rc) = 3
		}
		if ( gdata(GDATA_AREA) == AREA_NT_SOUTH_BORDER ) {
			if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) < 100 ) {
				flt
				characreate -1, CREATURE_ID_REGULUS_THE_ALTERED, 15, 22
				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			}
			if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) >= 1000 ) {
				flt
				characreate -1, CREATURE_ID_RENAI_THE_OVER_MESHERA, 16, 22
				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			}
		}
		if ( gdata(GDATA_AREA) == AREA_ST_NORTH_BORDER ) {
			flt
			characreate -1, CREATURE_ID_ZISILION_THE_MINE_KING, 9, 10
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_PALMIA ) {
			flt
			characreate -1, CREATURE_ID_KURON_THE_BLACK_CLOTH, 51, 30
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_YOWYN ) {
			flt
			characreate -1, CREATURE_ID_GWEN_THE_PITILESS, 14, 12
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_KURUALM ) {
			flt
			characreate -1, CREATURE_ID_NEW_CITIZEN, 21, 34
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_LARNA ) {
			if ( gdata(GDATA_FLAG_VISITED_LARNA) == 0 ) {
				gdata(GDATA_FLAG_VISITED_LARNA) = 1
				if ( findchara(CREATURE_ID_CHILD_WEL) != 0 ) {
					chara_vanquish findchara(CREATURE_ID_CHILD_WEL)
				}
				flt
				characreate -1, CREATURE_ID_CHILD_WEL, 13, 20
				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			}
			if ( gdata(GDATA_FLAG_SUB_NORNE_THE_GUIDE) == 0 ) {
				if ( gdata(GDATA_FLAG_MAIN) >= 394 ) {
					gdata(GDATA_FLAG_SUB_NORNE_THE_GUIDE) = 1
					if ( findchara(CREATURE_ID_NORNE_THE_GUIDE) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_NORNE_THE_GUIDE)
					}
					flt
					characreate -1, CREATURE_ID_NORNE_THE_GUIDE, 23, 4
					cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
					cdata(CDATA_AI_CALM, rc) = 3
				}
			}
		}
		if ( gdata(GDATA_AREA) == AREA_MAID_MANSION ) {
			flt
			characreate -1, CREATURE_ID_GOKIBURI, 25, 13
		}
		if ( gdata(GDATA_AREA) == AREA_ARCBELC ) {
			flt
			characreate -1, CREATURE_ID_LENAS_THE_MAGE_REPORTER, 27, 13
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_VALM ) {
			flt
			characreate -1, CREATURE_ID_RATIN_THE_FIGHTER_REPORTER, 8, 13
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_MELKAWN ) {
			flt
			characreate -1, CREATURE_ID_NAGA_THE_THIEF_REPORTER, 11, 6
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_MELUGAS ) {
			if ( gdata(GDATA_FLAG_VISITED_MELUGAS) == 0 ) {
				if ( findchara(CREATURE_ID_YERLESWOOD_NEO) != 0 ) {
					chara_vanquish findchara(CREATURE_ID_YERLESWOOD_NEO)
				}
				gdata(GDATA_FLAG_VISITED_MELUGAS) = 1
				flt
				characreate -1, CREATURE_ID_YERLESWOOD_NEO, 26, 18
				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			}
			if ( gdata(GDATA_FLAG_MAIN) >= 480 ) {
				gdata(GDATA_FLAG_VISITED_MELUGAS) = 2
				if ( findchara(CREATURE_ID_MELUGAST_TYPEM) != 0 ) {
					chara_vanquish findchara(CREATURE_ID_MELUGAST_TYPEM)
				}
				flt
				characreate -1, CREATURE_ID_MELUGAST_TYPEM, 26, 23
				if ( stat != 0 ) {
					cdata(CDATA_AI_CALM, rc) = 3
					cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
					cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
					cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
				}
			}
		}
		if ( gdata(GDATA_AREA) == AREA_OL_DRAN ) {
			flt
			characreate -1, CREATURE_ID_MELGET_THE_INFORMER, 42, 12
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_DOCK ) {
			if ( gdata(GDATA_LEVEL) == 1 ) {
				flt
				characreate -1, CREATURE_ID_KUROYA_THE_LOOKING_UNIVERSE, 6, 14
				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			}
			if ( gdata(GDATA_LEVEL) == 60 ) {
				flt
				characreate -1, CREATURE_ID_SHURAIDA_THE_EXPERT_MERC, 12, 29
				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
				cdata(CDATA_AI_CALM, rc) = 3
			}
		}
		if ( gdata(GDATA_AREA) == AREA_HARVEST_SHIP ) {
			flt
			characreate -1, CREATURE_ID_JIN_THE_MACHINE_REBEL, 2, 19
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			cdata(CDATA_AI_CALM, rc) = 3
		}
		if ( gdata(GDATA_AREA) == AREA_ULM_LESON ) {
			flt
			characreate -1, CREATURE_ID_MELUGAST_TYPE0_THE_DIMENSION_DRIVER, 24, 4
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_YLVA_LIBRARY ) {
			flt
			characreate -1, CREATURE_ID_ARIBEL_THE_WHITE_ARMS, 24, 16
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			cdata(CDATA_AI_CALM, rc) = 3
		}
		if ( gdata(GDATA_AREA) == AREA_ANCIENT_GARDEN ) {
			flt
			characreate -1, CREATURE_ID_MELUGAST_TYPE0_THE_DIMENSION_DRIVER, 5, 29
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_CYBER_DOME ) {
			flt
			characreate -1, CREATURE_ID_BLACK_GAUNTLET_LEOLD, 15, 21
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_RUOZA ) {
			flt
			initlv = 100
			novoidlv = 1
			characreate -1, CREATURE_ID_BLACK_GAUNTLET_LEOLD, 12, 5
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_GUARDIAN_SHRINE ) {
			flt
			characreate -1, CREATURE_ID_LANKATA_THE_LIGHTNING_OF_BLUE, 11, 5
			cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
			cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			cdata(CDATA_AI_CALM, rc) = 3
			flt
			characreate -1, CREATURE_ID_ALFRED_THE_CANGNAN_WIND, 12, 5
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			cdata(CDATA_AI_CALM, rc) = 3
		}
		if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE ) {
			if ( gdata(GDATA_LEVEL) == 173 ) {
				flt
				novoidlv = 1
				characreate -1, CREATURE_ID_LANKATA_THE_LIGHTNING_OF_BLUE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
				cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
				cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			}
		}
		if ( gdata(GDATA_AREA) == AREA_AMUR_CAGE ) {
			if ( gdata(GDATA_LEVEL) == 1 ) {
				if ( gdata(GDATA_FLAG_SUB_BEILGENA_THE_ARTIFICIAL_DRAGON) == 1000 ) {
					gdata(GDATA_FLAG_SUB_BEILGENA_THE_ARTIFICIAL_DRAGON) = 1001
					if ( findchara(CREATURE_ID_BEILGENA_THE_ARTIFICIAL_DRAGON) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_BEILGENA_THE_ARTIFICIAL_DRAGON)
					}
					flt
					characreate -1, CREATURE_ID_BEILGENA_THE_ARTIFICIAL_DRAGON, 9, 8
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_GRAVEED_THE_GRAVITY_VALLEY) == 1000 ) {
					gdata(GDATA_FLAG_SUB_GRAVEED_THE_GRAVITY_VALLEY) = 1001
					if ( findchara(CREATURE_ID_GRAVEED_THE_GRAVITY_VALLEY) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_GRAVEED_THE_GRAVITY_VALLEY)
					}
					flt
					characreate -1, CREATURE_ID_GRAVEED_THE_GRAVITY_VALLEY, 10, 9
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_DOROTHIA_STANDING_IN_THE_WETLAND) == 1000 ) {
					gdata(GDATA_FLAG_SUB_DOROTHIA_STANDING_IN_THE_WETLAND) = 1001
					if ( findchara(CREATURE_ID_DOROTHIA_STANDING_IN_THE_WETLAND) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_DOROTHIA_STANDING_IN_THE_WETLAND)
					}
					flt
					characreate -1, CREATURE_ID_DOROTHIA_STANDING_IN_THE_WETLAND, 12, 9
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_MINOTAUR) == 1000 ) {
					gdata(GDATA_FLAG_SUB_MINOTAUR) = 1001
					if ( findchara(CREATURE_ID_UNGAGA_THE_MINOTAUR_KING) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_UNGAGA_THE_MINOTAUR_KING)
					}
					flt
					characreate -1, CREATURE_ID_UNGAGA_THE_MINOTAUR_KING, 39, 25
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_CAT) == 1000 ) {
					gdata(GDATA_FLAG_SUB_CAT) = 1001
					if ( findchara(CREATURE_ID_CACY_THE_CAT_TAMER) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_CACY_THE_CAT_TAMER)
					}
					flt
					characreate -1, CREATURE_ID_CACY_THE_CAT_TAMER, 35, 25
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_PYRAMID) == 1000 ) {
					gdata(GDATA_FLAG_SUB_PYRAMID) = 1001
					if ( findchara(CREATURE_ID_TUWEN_THE_MASTER_OF_THE_PYRAMID) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_TUWEN_THE_MASTER_OF_THE_PYRAMID)
					}
					flt
					characreate -1, CREATURE_ID_TUWEN_THE_MASTER_OF_THE_PYRAMID, 44, 23
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_YEEK) == 1000 ) {
					gdata(GDATA_FLAG_SUB_YEEK) = 1001
					if ( findchara(CREATURE_ID_RODLOB_THE_YEEK_CHIEF) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_RODLOB_THE_YEEK_CHIEF)
					}
					flt
					characreate -1, CREATURE_ID_RODLOB_THE_YEEK_CHIEF, 42, 25
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_H_SISTER) == 1000 ) {
					gdata(GDATA_FLAG_SUB_H_SISTER) = 1001
					if ( findchara(CREATURE_ID_H_SISTER) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_H_SISTER)
					}
					flt
					characreate -1, CREATURE_ID_H_SISTER, 39, 28
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_PIRATE_HUNTING) == 1000 ) {
					gdata(GDATA_FLAG_SUB_PIRATE_HUNTING) = 1001
					if ( findchara(CREATURE_ID_EBARTH_THE_PIRATE_BOSS) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_EBARTH_THE_PIRATE_BOSS)
					}
					flt
					characreate -1, CREATURE_ID_EBARTH_THE_PIRATE_BOSS, 33, 29
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_DOGS_TAIL) == 1000 ) {
					gdata(GDATA_FLAG_SUB_DOGS_TAIL) = 1001
					if ( findchara(CREATURE_ID_ESTORK_THE_DOGGOD) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_ESTORK_THE_DOGGOD)
					}
					flt
					characreate -1, CREATURE_ID_ESTORK_THE_DOGGOD, 37, 25
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_MANSION_FOR_SALE) == 1004 ) {
					gdata(GDATA_FLAG_SUB_MANSION_FOR_SALE) = 1005
					if ( findchara(CREATURE_ID_KING_COCKROACH) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_KING_COCKROACH)
					}
					flt
					characreate -1, CREATURE_ID_KING_COCKROACH, 41, 28
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_MOTHER) == 1001 ) {
					gdata(GDATA_FLAG_SUB_MOTHER) = 1006
					if ( findchara(CREATURE_ID_PAELS_MOM_LILY) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_PAELS_MOM_LILY)
					}
					flt
					characreate -1, CREATURE_ID_PAELS_MOM_LILY, 45, 29
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_WHEN_THE_FLAME_BURNS_OUT) == 1000 ) {
					gdata(GDATA_FLAG_SUB_WHEN_THE_FLAME_BURNS_OUT) = 1001
					if ( findchara(CREATURE_ID_VANSESDA_THE_ANCIENT_FIRE) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_VANSESDA_THE_ANCIENT_FIRE)
					}
					flt
					characreate -1, CREATURE_ID_VANSESDA_THE_ANCIENT_FIRE, 16, 23
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_REGULUS_EULDERNA) == 1000 ) {
					gdata(GDATA_FLAG_SUB_REGULUS_EULDERNA) = 1001
					if ( findchara(CREATURE_ID_INQTUAL_THE_REVENGE) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_INQTUAL_THE_REVENGE)
					}
					if ( findchara(CREATURE_ID_PALACE_MAGICIAN) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_PALACE_MAGICIAN)
					}
					flt
					characreate -1, CREATURE_ID_INQTUAL_THE_REVENGE, 10, 25
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					flt
					characreate -1, CREATURE_ID_PALACE_MAGICIAN, -3, 0
					if ( stat != 0 ) {
						cdata(CDATA_AI_CALM, rc) = 2
						cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
						cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_SUB_REGULUS_MAYROON) == 1000 ) {
					gdata(GDATA_FLAG_SUB_REGULUS_MAYROON) = 1001
					if ( findchara(CREATURE_ID_LAZASYE_THE_DESTROY) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_LAZASYE_THE_DESTROY)
					}
					flt
					characreate -1, CREATURE_ID_LAZASYE_THE_DESTROY, 13, 25
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) == 1004 ) {
					gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) = 1005
					if ( findchara(CREATURE_ID_TESTER) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_TESTER)
					}
					flt
					characreate -1, CREATURE_ID_TESTER, 19, 25
					cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
					cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_REGULUS_KIKKASU) == 1000 ) {
					gdata(GDATA_FLAG_SUB_REGULUS_KIKKASU) = 1001
					if ( findchara(CREATURE_ID_ROATONIS_THE_INFECTIONS) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_ROATONIS_THE_INFECTIONS)
					}
					flt
					characreate -1, CREATURE_ID_ROATONIS_THE_INFECTIONS, 16, 25
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_THE_RESULT_OF_REVENGE) == 1003 ) {
					gdata(GDATA_FLAG_SUB_THE_RESULT_OF_REVENGE) = 1004
					if ( findchara(CREATURE_ID_CONDUCTOR_KOALA) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_CONDUCTOR_KOALA)
					}
					flt
					characreate -1, CREATURE_ID_CONDUCTOR_KOALA, 10, 29
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_SUB_NINE_HEAD_DRAGON) == 4 ) {
					gdata(GDATA_FLAG_SUB_NINE_HEAD_DRAGON) = 5
					if ( findchara(CREATURE_ID_NINE_HEAD_DRAGON_THE_ABYSS) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_NINE_HEAD_DRAGON_THE_ABYSS)
					}
					flt
					characreate -1, CREATURE_ID_NINE_HEAD_DRAGON_THE_ABYSS, 13, 29
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_VISITED_MELUGAS) == 2 ) {
					gdata(GDATA_FLAG_VISITED_MELUGAS) = 3
					if ( findchara(CREATURE_ID_EGELVEIL_THE_BIND) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_EGELVEIL_THE_BIND)
					}
					flt
					characreate -1, CREATURE_ID_EGELVEIL_THE_BIND, 16, 29
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_MAIN_CHAOS_CRADLE_34) == 1 ) {
					gdata(GDATA_FLAG_MAIN_CHAOS_CRADLE_34) = 2
					if ( findchara(CREATURE_ID_ALFRED_THE_CANGNAN_WIND) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_ALFRED_THE_CANGNAN_WIND)
					}
					flt
					characreate -1, CREATURE_ID_ALFRED_THE_CANGNAN_WIND, 19, 28
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
				}
				if ( gdata(GDATA_FLAG_MAIN_CHAOS_CRADLE_25) == 1000 ) {
					gdata(GDATA_FLAG_MAIN_CHAOS_CRADLE_25) = 1001
					if ( findchara(CREATURE_ID_LANKATA_THE_LIGHTNING_OF_BLUE) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_LANKATA_THE_LIGHTNING_OF_BLUE)
					}
					if ( findchara(CREATURE_ID_ZANAN_ENHANCED_SOLDIER) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_ZANAN_ENHANCED_SOLDIER)
					}
					if ( findchara(CREATURE_ID_LOTHRIAN_AGENT) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_LOTHRIAN_AGENT)
					}
					flt
					characreate -1, CREATURE_ID_LANKATA_THE_LIGHTNING_OF_BLUE, 19, 29
					cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
					cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
					cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					flt
					characreate -1, CREATURE_ID_ZANAN_ENHANCED_SOLDIER, -3, 0
					if ( stat != 0 ) {
						cdata(CDATA_AI_CALM, rc) = 2
						cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
						cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
					flt
					characreate -1, CREATURE_ID_LOTHRIAN_AGENT, -3, 0
					if ( stat != 0 ) {
						cdata(CDATA_AI_CALM, rc) = 2
						cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
						cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_MAIN_CHAOS_CRADLE_25) == 100 ) {
					gdata(GDATA_FLAG_MAIN_CHAOS_CRADLE_25) = 101
					if ( findchara(CREATURE_ID_ZANAN_ENHANCED_SOLDIER) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_ZANAN_ENHANCED_SOLDIER)
					}
					if ( findchara(CREATURE_ID_LOTHRIAN_AGENT) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_LOTHRIAN_AGENT)
					}
					flt
					characreate -1, CREATURE_ID_ZANAN_ENHANCED_SOLDIER, -3, 0
					if ( stat != 0 ) {
						cdata(CDATA_AI_CALM, rc) = 2
						cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
						cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
					flt
					characreate -1, CREATURE_ID_LOTHRIAN_AGENT, -3, 0
					if ( stat != 0 ) {
						cdata(CDATA_AI_CALM, rc) = 2
						cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
						cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_ENTHUMESIS_SPAWNED) == 100 ) {
					gdata(GDATA_FLAG_ENTHUMESIS_SPAWNED) = 101
					if ( findchara(CREATURE_ID_ENTHUMESIS) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_ENTHUMESIS)
					}
					flt
					characreate -1, CREATURE_ID_ENTHUMESIS, 27, 16
					if ( stat != 0 ) {
						cdata(CDATA_AI_CALM, rc) = 3
						cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
						cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_ASSASSIN_EVENTS_FOR_ALSAPIA_GILPHEM) == 55 ) {
					gdata(GDATA_FLAG_ASSASSIN_EVENTS_FOR_ALSAPIA_GILPHEM) = 60
					if ( findchara(CREATURE_ID_ALSAPIA_THE_MURDERER_MASK) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_ALSAPIA_THE_MURDERER_MASK)
					}
					if ( findchara(CREATURE_ID_GILPHEM_THE_MAGIC_STEEL) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_GILPHEM_THE_MAGIC_STEEL)
					}
					flt
					characreate -1, CREATURE_ID_ALSAPIA_THE_MURDERER_MASK, 36, 9
					if ( stat != 0 ) {
						cdata(CDATA_AI_CALM, rc) = 3
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
					flt
					characreate -1, CREATURE_ID_GILPHEM_THE_MAGIC_STEEL, 39, 9
					if ( stat != 0 ) {
						cdata(CDATA_AI_CALM, rc) = 3
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
			}
			if ( gdata(GDATA_LEVEL) == 2 ) {
				if ( gdata(GDATA_FLAG_AMUR_CAGE_SIVA) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_SIVA_THE_DESTRUCTION) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_SIVA) = 1
						if ( findchara(CREATURE_ID_SIVA_THE_DESTRUCTION) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_SIVA_THE_DESTRUCTION)
						}
						flt
						characreate -1, CREATURE_ID_SIVA_THE_DESTRUCTION, 43, 20
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_YERLESWOOD) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_YERLESWOOD_THE_SAVAGE_MACHINE) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_YERLESWOOD) = 1
						if ( findchara(CREATURE_ID_YERLESWOOD_THE_SAVAGE_MACHINE) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_YERLESWOOD_THE_SAVAGE_MACHINE)
						}
						flt
						characreate -1, CREATURE_ID_YERLESWOOD_THE_SAVAGE_MACHINE, 45, 20
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_ULZASSIL) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_ULZASSIL_THE_DEAD_EMPEROR) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_ULZASSIL) = 1
						if ( findchara(CREATURE_ID_ULZASSIL_THE_DEAD_EMPEROR) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_ULZASSIL_THE_DEAD_EMPEROR)
						}
						flt
						characreate -1, CREATURE_ID_ULZASSIL_THE_DEAD_EMPEROR, 47, 20
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_FRISIA) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_FRISIA_THE_CAT_QUEEN) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_FRISIA) = 1
						if ( findchara(CREATURE_ID_FRISIA_THE_CAT_QUEEN) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_FRISIA_THE_CAT_QUEEN)
						}
						flt
						characreate -1, CREATURE_ID_FRISIA_THE_CAT_QUEEN, 43, 17
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_UTIMA) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_UTIMA_THE_DESTROYER_OF_XEREN) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_UTIMA) = 1
						if ( findchara(CREATURE_ID_UTIMA_THE_DESTROYER_OF_XEREN) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_UTIMA_THE_DESTROYER_OF_XEREN)
						}
						flt
						characreate -1, CREATURE_ID_UTIMA_THE_DESTROYER_OF_XEREN, 45, 17
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_AZZRSSIL) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_AZZRSSIL_THE_IMPURE) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_AZZRSSIL) = 1
						if ( findchara(CREATURE_ID_AZZRSSIL_THE_IMPURE) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_AZZRSSIL_THE_IMPURE)
						}
						flt
						characreate -1, CREATURE_ID_AZZRSSIL_THE_IMPURE, 47, 17
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_SUNRISE) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_SUNRISE_THE_ARCHIPELAGO_DRAGON) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_SUNRISE) = 1
						if ( findchara(CREATURE_ID_SUNRISE_THE_ARCHIPELAGO_DRAGON) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_SUNRISE_THE_ARCHIPELAGO_DRAGON)
						}
						flt
						characreate -1, CREATURE_ID_SUNRISE_THE_ARCHIPELAGO_DRAGON, 21, 6
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_PASCAL) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_PASCAL) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_PASCAL) = 1
						if ( findchara(CREATURE_ID_PASCAL) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_PASCAL)
						}
						flt
						characreate -1, CREATURE_ID_PASCAL, 23, 6
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_WING_SNAIL) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_WING_SNAIL) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_WING_SNAIL) = 1
						if ( findchara(CREATURE_ID_WING_SNAIL) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_WING_SNAIL)
						}
						flt
						characreate -1, CREATURE_ID_WING_SNAIL, 23, 6
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_MURDER_KNIGHT) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_MURDER_KNIGHT) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_MURDER_KNIGHT) = 1
						if ( findchara(CREATURE_ID_MURDER_KNIGHT) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_MURDER_KNIGHT)
						}
						flt
						characreate -1, CREATURE_ID_MURDER_KNIGHT, 27, 6
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_LITYOU) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_LITYOU) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_LITYOU) = 1
						if ( findchara(CREATURE_ID_LITYOU) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_LITYOU)
						}
						flt
						characreate -1, CREATURE_ID_LITYOU, 29, 6
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_MAD_SCIENTIST) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_MAD_SCIENTIST) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_MAD_SCIENTIST) = 1
						if ( findchara(CREATURE_ID_MAD_SCIENTIST) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_MAD_SCIENTIST)
						}
						flt
						characreate -1, CREATURE_ID_MAD_SCIENTIST, 31, 6
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_ISCA) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_ISCA_THE_FALLEN_ANGEL) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_ISCA) = 1
						if ( findchara(CREATURE_ID_ISCA_THE_FALLEN_ANGEL) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_ISCA_THE_FALLEN_ANGEL)
						}
						flt
						characreate -1, CREATURE_ID_ISCA_THE_FALLEN_ANGEL, 33, 6
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_DUNGEON_CLEANER) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_DUNGEON_CLEANER) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_DUNGEON_CLEANER) = 1
						if ( findchara(CREATURE_ID_DUNGEON_CLEANER) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_DUNGEON_CLEANER)
						}
						flt
						characreate -1, CREATURE_ID_DUNGEON_CLEANER, 21, 10
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
				if ( gdata(GDATA_FLAG_AMUR_CAGE_GODA) == 0 ) {
					if ( npcmemory(0, CREATURE_ID_GODA_THE_CAPTAIN_OF_ORC) > 0 ) {
						gdata(GDATA_FLAG_AMUR_CAGE_GODA) = 1
						if ( findchara(CREATURE_ID_GODA_THE_CAPTAIN_OF_ORC) != 0 ) {
							chara_vanquish findchara(CREATURE_ID_GODA_THE_CAPTAIN_OF_ORC)
						}
						flt
						characreate -1, CREATURE_ID_GODA_THE_CAPTAIN_OF_ORC, 23, 10
						cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
						cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
						cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
					}
				}
			}
		}
		if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CROP ) {
			p = limit(rnd((sdata(SKILL_NORMAL_GARDENING, CHARA_PLAYER) + 1) / 20 + 1), 1, 5)
			repeat p
				flt calcobjlv((sdata(SKILL_NORMAL_GARDENING, CHARA_PLAYER) + 1) / 3 + 1), FIX_QUALITY_GOOD
				dbid = 0
				fltn "wild"
				characreate -1, dbid, -3, 0
				cbitmod CHARA_BIT_SUMMONED, rc, TRUE
			loop
			if ( allitemfind(1099) != (-1) ) {
				flt
				itemcreate -1, ITEM_ID_ARTIFACT_SEED, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
				kaiwa = rnd(4)
				if ( kaiwa == 0 ) {
					txt lang("「害獣…許さない」", cnvtalk("A vermin...I can't...tolerate...."))
				}
				if ( kaiwa == 1 ) {
					txt lang("「悪い虫は…殺さなきゃ…」", cnvtalk("I...will have no mercy..for vermins..."))
				}
				if ( kaiwa == 2 ) {
					txt lang("「早く…駆除…しないと…」", cnvtalk("I have to...get rid of it..."))
				}
				if ( kaiwa == 3 ) {
					txt lang("「ずっと…見守ってあげるからね…？」", cnvtalk("I always...watch over you..."))
				}
				if ( rc > MAX_CHARA_FOLLOWER ) {
					dmghp rc, 99999, DAMAGE_FROM_UNSEEN
				}
			}
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 63 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_GUARDIAN_SHRINE ) {
			flt
			characreate -1, CREATURE_ID_AIME_THE_STORY_TELLER, 20, 8
			cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
			cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			cdata(CDATA_AI_CALM, rc) = 3
		}
		if ( gdata(GDATA_AREA) == AREA_VALM ) {
			flt
			characreate -1, CREATURE_ID_SNAIL_THE_ANDROID_RIDER, 41, 9
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			flt
			characreate -1, CREATURE_ID_RECONCILED_CLEANER, 8, 7
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		if ( gdata(GDATA_AREA) == AREA_ULM_LESON ) {
			if ( gdata(GDATA_FLAG_MAIN) >= 605 ) {
				if ( gdata(GDATA_FLAG_ENCOUNTER_LARNNEIRE_IN_ULM_LESON) == 0 ) {
					if ( findchara(CREATURE_ID_RIANNA_THE_DAYDREAMER) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_RIANNA_THE_DAYDREAMER)
					}
					if ( findchara(CREATURE_ID_LOMIAS_THE_MESSENGER_FROM_VINDALE) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_LOMIAS_THE_MESSENGER_FROM_VINDALE)
					}
					if ( findchara(CREATURE_ID_LARNNEIRE_THE_LISTENER_OF_WIND) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_LARNNEIRE_THE_LISTENER_OF_WIND)
					}
					flt
					characreate -1, CREATURE_ID_RIANNA_THE_DAYDREAMER, 30, 6
					cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
					flt
					characreate -1, CREATURE_ID_LOMIAS_THE_MESSENGER_FROM_VINDALE, 22, 28
					cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
					flt
					characreate -1, CREATURE_ID_LARNNEIRE_THE_LISTENER_OF_WIND, 32, 1
					cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
					gdata(GDATA_FLAG_ENCOUNTER_LARNNEIRE_IN_ULM_LESON) = 1
				}
			}
			if ( gdata(GDATA_FLAG_MAIN) >= 760 ) {
				if ( gdata(GDATA_FLAG_BETHEL_THE_WHITE_HAWK_SPAWNED) == 0 ) {
					if ( findchara(CREATURE_ID_BETHEL_THE_WHITE_HAWK) != 0 ) {
						chara_vanquish findchara(CREATURE_ID_BETHEL_THE_WHITE_HAWK)
					}
					flt
					initlv = 200
					characreate -1, CREATURE_ID_BETHEL_THE_WHITE_HAWK, 32, 2
					cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
					cdata(CDATA_AI_CALM, rc) = 3
					gdata(GDATA_FLAG_BETHEL_THE_WHITE_HAWK_SPAWNED) = 1
				}
			}
		}
		if ( gdata(GDATA_AREA) == AREA_RUOZA ) {
			flt
			characreate -1, CREATURE_ID_MILOS_OF_THE_FORGOTTEN_WORLD, 22, 2
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
			flt
			characreate -1, CREATURE_ID_HALION_THE_EXTREMIST, 19, 18
			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 56 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_FLAG_BOSS_MUSIC) == 0 ) {
			music = MUSICLIST_SCENE_MUSIC
			gosub *music_play
		}
		if ( gdata(GDATA_FLAG_BOSS_MUSIC) == 1 ) {
			music = MUSICLIST_MCBOSS
			gosub *music_play
		}
		if ( gdata(GDATA_FLAG_BOSS_MUSIC) == 2 ) {
			music = MUSICLIST_MCRUIN
			gosub *music_play
		}
		if ( gdata(GDATA_FLAG_BOSS_MUSIC) == 3 ) {
			music = MUSICLIST_MCJAPAN
			gosub *music_play
		}
		if ( gdata(GDATA_FLAG_BOSS_MUSIC) == 4 ) {
			music = MUSICLIST_MCLASTBOSS
			gosub *music_play
		}
		if ( gdata(GDATA_FLAG_BOSS_MUSIC) == 5 ) {
			music = MUSICLIST_MCVICTORY
			gosub *music_play
		}
		if ( gdata(GDATA_FLAG_BOSS_MUSIC) == 6 ) {
			gosub *music_play
		}
		if ( gdata(GDATA_FLAG_BOSS_MUSIC) == 7 ) {
			music = MUSICLIST_MCZANGYOU
			gosub *music_play
		}
		gdata(GDATA_FLAG_BOSS_MUSIC) = 0
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 7 | _switch_sw ) {
		_switch_sw = 0
		gosub *screen_drawEventFull
		press
		screenupdate = -1
		gosub *screen_refreshFull
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 10 | _switch_sw ) {
		_switch_sw = 0
		gosub *quest_check
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 19 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_BROWN
		txt "" + usermsg
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 25 | _switch_sw ) {
		_switch_sw = 0
		if ( get_freechara() == (-1) | gdata(GDATA_GUEST) <= 0 ) {
			txt lang("ゲストは行方不明になった。", "The guest lost his way.")
			goto *event_SWEND1
		}
		ehemeka = 0
		if ( allitemfind(1095) != (-1) ) {
			kaiwa = rnd(4)
			if ( kaiwa == 0 ) {
				txt lang("「うみゅ〜!」", cnvtalk("Meow!"))
			}
			if ( kaiwa == 1 ) {
				txt lang("「うっみゅ!」", cnvtalk("Mew mew!"))
			}
			if ( kaiwa == 2 ) {
				txt lang("「招くよ!よ！」", cnvtalk("I invite guests! guests!"))
			}
			if ( kaiwa == 3 ) {
				txt lang("「めかじき!」", cnvtalk("Swordfish!"))
			}
			ehemeka = 100
		}
		if ( rnd(3) & gdata(GDATA_MONTH) != 10 ) {
			p = 0
			tc = CHARA_PLAYER
			repeat 100
				i = rnd(40 - 1) + 16
				if ( cdata(CDATA_EXIST, i) == CHAR_STATE_ADV ) {
					if ( cbit(CHARA_BIT_HIRED, i) == FALSE ) {
						cdata(CDATA_AREA, i) != gdata(GDATA_AREA)
						if ( cdata(CDATA_RELATION, i) >= RELATION_NEUTRAL ) {
							if ( cdata(CDATA_CUSTOM_TALK_LINE, i) == 2 ) {
								cdata(CDATA_CUSTOM_TALK_LINE, i) = 0
								tc = i
								break
							}
							if ( rnd(25) < p ) {
								break
							}
							if ( tc == CHARA_PLAYER ) {
								tc = i
								p++
								if ( cdata(CDATA_IMPRESSION, tc) < 25 ) {
									if ( rnd(12) == 0 & ehemeka == 0 ) {
										break
									}
								}
								if ( cdata(CDATA_IMPRESSION, tc) < 0 ) {
									if ( rnd(4) == 0 & ehemeka == 0 ) {
										break
									}
								}
								continue
							}
							if ( cdata(CDATA_IMPRESSION, cnt) < cdata(CDATA_IMPRESSION, i) ) {
								tc = i
								p++
							}
						}
					}
				}
			loop
			if ( tc == CHARA_PLAYER ) {
				txt lang("ゲストはすでに居なくなっていた。", "It seems the guest has already left your house.")
				goto *event_SWEND1
			}
			cdata(CDATA_EXIST, tc) = CHAR_STATE_ALIVE
			rc = tc
			cxinit = cdata(CDATA_X, CHARA_PLAYER)
			cyinit = cdata(CDATA_Y, CHARA_PLAYER)
			gosub *place_chara
		}
		else {
			flt 0, FIX_QUALITY_GOOD
			repeat 1
				if ( gdata(GDATA_MONTH) == 10 ) {
					if ( rnd(2) == 0 ) {
						if ( rnd(2) == 0 ) {
							characreate -1, CREATURE_ID_HALLOWEEN_CHILDREN2, -3, 0
							cdata(CDATA_ROLE, rc) = ROLE_GUEST_HALLOWEEN
							break
						}
						else {
							characreate -1, CREATURE_ID_HALLOWEEN_CHILDREN, -3, 0
							cdata(CDATA_ROLE, rc) = ROLE_GUEST_HALLOWEEN
							break
						}
					}
				}
				if ( gdata(GDATA_GUILD_TRAINER) != gdata(GDATA_MONTH) | rnd(5) == 0 ) {
					if ( rnd(3) ) {
						characreate -1, CREATURE_ID_GUILD_TRAINER, -3, 0
						cdata(CDATA_ROLE, rc) = ROLE_GUEST_TRAINER
						break
					}
				}
				if ( rnd(10) == 0 & ehemeka == 0 ) {
					characreate -1, CREATURE_ID_MYSTERIOUS_PRODUCER, -3, 0
					cdata(CDATA_ROLE, rc) = ROLE_GUEST_PRODUCER
					break
				}
				if ( rnd(10) == 0 ) {
					characreate -1, CREATURE_ID_SHOPKEEPER, -3, 0
					cdata(CDATA_ROLE, rc) = ROLE_GUEST_MERCHANT
					cdata(CDATA_ROLE_SHOP_LEVEL, rc) = limit(cdata(CDATA_FAME, CHARA_PLAYER) / 100, 20, 100)
					break
				}
				if ( rnd(4) == 0 & ehemeka == 0 ) {
					characreate -1, CREATURE_ID_BEGGAR, -3, 0
					cdata(CDATA_ROLE, rc) = (2000 /*!!!@[ROLE_GUEST_BEGGAR @@@ ROLE_GUEST_MIN]@!!! */)
					break
				}
				if ( rnd(4) == 0 & ehemeka == 0 ) {
					characreate -1, CREATURE_ID_PUNK, -3, 0
					cdata(CDATA_ROLE, rc) = ROLE_GUEST_SEX
					break
				}
				if ( ehemeka == 0 ) {
					characreate -1, CREATURE_ID_CITIZEN, -3, 0
					cdata(CDATA_ROLE, rc) = ROLE_GUEST_CITIZEN
					break
				}
				else {
					characreate -1, CREATURE_ID_SHOPKEEPER, -3, 0
					cdata(CDATA_ROLE, rc) = ROLE_GUEST_MERCHANT
					cdata(CDATA_ROLE_SHOP_LEVEL, rc) = limit(cdata(CDATA_FAME, CHARA_PLAYER) / 100, 20, 100)
					break
				}
			loop
			tc = rc
			cdata(CDATA_RELATION, tc) = RELATION_NEUTRAL
			cdata(CDATA_RELATION_ORG, tc) = RELATION_NEUTRAL
			cbitmod CHARA_BIT_GUEST, tc, TRUE
		}
		ehemeka = 0
		cbitmod CHARA_BIT_EVENT_TALK, tc, TRUE
		i = 0
		repeat 16 + 1
			if ( cnt == 0 ) {
				c = tc
			}
			else {
				c = cnt - 1
			}
			if ( cdata(CDATA_EXIST, c) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( gdata(GDATA_RIDER) != 0 ) {
				if ( c == gdata(GDATA_RIDER) ) {
					continue
				}
			}
			inv_getheader -1
			p = 0, 6
			repeat invrange, invhead
				if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
					continue
				}
				if ( inv(INV_ITEM_EFFECT, cnt) != EFFECT_CHAIR ) {
					continue
				}
				if ( c == tc ) {
					if ( inv(INV_ITEM_PARAM1, cnt) == 2 ) {
						cell_swap c, -1, inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt)
						i = cnt
						p = cnt
						break
					}
					else {
						continue
					}
				}
				if ( i == 0 ) {
					break
				}
				else {
					if ( cnt == i ) {
						continue
					}
				}
				p(2) = dist(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), inv(INV_ITEM_X, i), inv(INV_ITEM_Y, i))
				if ( p(2) < p(1) ) {
					if ( map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_CHARA_INDEX_PLUS_ONE) == 0 | c == 0 | c == tc ) {
						p = cnt, p(2)
					}
				}
				if ( c == 0 ) {
					if ( inv(INV_ITEM_PARAM1, cnt) == 1 ) {
						p = cnt
						break
					}
				}
			loop
			if ( p != 0 ) {
				if ( cdata(CDATA_IN_TAGTEAM, c) == 0 ) {
					cell_swap c, -1, inv(INV_ITEM_X, p), inv(INV_ITEM_Y, p)
				}
			}
			cdata(CDATA_DIR, c) = direction(cdata(CDATA_X, c), cdata(CDATA_Y, c), cdata(CDATA_X, tc), cdata(CDATA_Y, tc))
			if ( c == 0 ) {
				gdata(GDATA_RUN_DIR) = cdata(CDATA_DIR, c)
			}
		loop
		gosub *chat
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 35 | _switch_sw ) {
		_switch_sw = 0
		i = 0
		repeat 16
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_ROLE, cnt) != ROLE_ADVENTURER ) {
				if ( cdata(CDATA_ROLE, cnt) != ROLE_SPECIAL ) {
					cdata(CDATA_EMO_ICON, cnt) = 10 + 100 * 20
					txt lang(name(cnt) + "「目が！目がー！！」", name(cnt) + " shout" + _s(cnt) + " " + cnvtalk("Eyes! My eyes!"))
				}
			}
		loop
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 88 | _switch_sw ) {
		_switch_sw = 0
		txt lang("おかえり。", "Welcome back.")
		snd SOUNDLIST_DING3
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			p = cnt
			repeat 8 + 8
				if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, p) == BUFF_NONE ) {
					break
				}
				if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, p) == BUFF_DEATH_WORD ) {
					delbuff p, cnt
					continue cnt
				}
			loop
		loop
		i = 0
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cnt == 0 ) {
				continue
			}
			cdata(CDATA_EMO_ICON, cnt) = 6 + 100 * 20
			tc = cnt
			customtalk tc, DBMODE_FLAVOR_WELCOME
			gosub *convert_word
			if ( stat == 0 ) {
				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
					i++
				}
			}
		loop
		repeat limit(i, 0, 5)
			txtef COLOR_SKY_BLUE
			if ( jp ) {
				txt "「おかえり」", "「おかえりなさい」", "「お疲れさま」", "「よかった…」", "「ずっと待ってたよ」", "「おかえりなさい」", "「おかえり」", "「泣きそう…」"
			}
			if ( en ) {
				txt cnvtalk("Welcome back!!"), cnvtalk("Hey, dear..."), cnvtalk("You're back!"), cnvtalk("I was waiting for you."), cnvtalk("Nice to see you again."), cnvtalk("I'm about to cry..."), cnvtalk("Cheers for good work.")
			}
		loop
		await 500
		txtsetendword 3
		repeat 3
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 300, 0
		gosub *prompt_key
		snd SOUNDLIST_DING1
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 17 | _switch_sw ) {
		_switch_sw = 0
		i = 0
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cnt == 0 ) {
				continue
			}
			if ( cdata(CDATA_ROLE, cnt) != ROLE_ADVENTURER ) {
				if ( cdata(CDATA_ROLE, cnt) != ROLE_SPECIAL ) {
					if ( cdata(CDATA_ROLE, cnt) != ROLE_NONE | cdata(CDATA_RELATION, cnt) == RELATION_NEUTRAL | cdata(CDATA_AREA, cnt) == gdata(GDATA_AREA) ) {
						cdata(CDATA_EMO_ICON, cnt) = 6 + 100 * 20
						tc = cnt
						customtalk tc, DBMODE_FLAVOR_WELCOME
						gosub *convert_word
						if ( stat == 0 ) {
							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
								i++
							}
						}
					}
				}
			}
		loop
		repeat limit(i, 0, 3)
			txtef COLOR_SKY_BLUE
			if ( jp ) {
				txt "「おかえり」", "「よう戻ったか」", "「無事で何よりです」", "「おかか♪」", "「待ってたよ」", "「おかえりなさい！」"
			}
			if ( en ) {
				txt cnvtalk("Welcome home!"), cnvtalk("Hey, dear."), cnvtalk("You're back!"), cnvtalk("I was waiting for you."), cnvtalk("Nice to see you again.")
			}
		loop
		if ( gdata(GDATA_GUEST) > 0 ) {
			tc = CHARA_PLAYER
			repeat 245
				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
					continue
				}
				if ( cdata(CDATA_ROLE, cnt) == ROLE_MAID ) {
					tc = cnt
					break
				}
			loop
			if ( tc != CHARA_PLAYER ) {
				gosub *chat
			}
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 21 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *event_SWEND1
		}
		gdata(GDATA_FLAG_NUCLEAR_EXPLOSIONS)++
		txtef COLOR_RED
		txt lang(" *ゴゴゴゴゴゴ* ", "* RRROOM-KABOOOOM*")
		msg_halt
		gsel BUFFER_PIC
		pos 0, 0
		picload exedir + "graphic\\bg22.bmp"
		gsel BUFFER_BUF
		pos windoww / 2 - 1, windowh / 2 - 1
		gmode 0, 640, 480
		grotate BUFFER_PIC, 0, 0, 0, windoww + 4, windowh + 4
		gsel BUFFER_PIC
		picload exedir + "graphic\\anime9.bmp"
		gsel BUFFER_SCREEN
		dx = windoww / 2
		dy = (windowh - inf_verh) / 2
		p = 0, 0, 0, 0, 0
		color 0, 0, 0
		repeat 40
			if ( cnt == 14 ) {
				snd SOUNDLIST_ATK_FIRE
			}
			redraw 0
			color 0, 0, 0
			if ( cnt < 16 ) {
				pos 0, 0
			}
			else {
				pos 5 - rnd(10), 5 - rnd(10)
			}
			gmode 0
			gcopy BUFFER_BUF, 0, 0, windoww, windowh
			if ( cnt > 8 ) {
				p--
			}
			else {
				p++
			}
			gmode 4, 192, 48, 255 - p * 5
			pos dx, dy
			grotate BUFFER_PIC, cnt / 2 \ 2 * 192, 408, 0, limit(p * 32, 0, 192), limit(p * 8, 0, 48)
			if ( cnt > 14 ) {
				p(1)++
			}
			else {
				if ( cnt < 12 ) {
					p(1) = cnt / 2 \ 2
				}
				else {
					if ( cnt >= 12 ) {
						p(1) = cnt \ 3
					}
				}
			}
			gmode 2, 96, 48
			pos dx, dy - limit(cnt * 3 / 2, 0, 18) - 16
			grotate BUFFER_PIC, p(1) * 96, 288, 0, limit(cnt * 12, 0, 144), limit(cnt * 6, 0, 72)
			if ( cnt > 4 ) {
				p(2)++
				p(3)++
			}
			gmode 4, 96, 96, limit(p(2) * 6, 0, 100)
			pos dx, dy - limit(p(2) * 2, 0, 40)
			grotate BUFFER_PIC, 0, 0, 0, limit(p(2) * 8, 0, 240), limit(p(2) * 5, 0, 96)
			gmode 4, 96, 96, p(3) * 10
			pos dx, dy - limit(p(3) * 2, 0, 160) - 6
			grotate BUFFER_PIC, 96, 0, 0, limit(p(3) * 10, 0, 96), limit(p(3) * 10, 0, 96)
			gmode 4, 192, 80, limit(p(3) * 5, 0, 100)
			pos dx, dy - 4
			grotate BUFFER_PIC, cnt / 4 \ 2 * 192, 96, 0, limit(p(2) * 8, 0, 400), limit(p(2), 0, 48)
			gmode 4, 192, 96, p(3) * 10
			pos dx, dy - 48 - limit(p(3) * 2, 0, 148)
			grotate BUFFER_PIC, cnt / 3 \ 2 * 192, 96, 0, 192, 96
			redraw 1
			await cfg_animewait + 50
		loop
		gmode 2
		gosub *screen_refreshFull
		tlocx = evdata1(evnum - (evnum != 0) * 1)
		tlocy = evdata2(evnum - (evnum != 0) * 1)
		range = 31
		ele = SKILL_RES_CHAOS
		aniref = range
		animeid = ANIMATION_BALL_NUKE
		anix = tlocx
		aniy = tlocy
		gosub *anime
		gosub *screen_draw
		repeat range * 2 + 1
			dy = tlocy - range + cnt
			if ( dy < 0 | dy >= mdata(MDATA_HEIGHT) ) {
				continue
			}
			repeat range * 2 + 1
				dx = tlocx - range + cnt
				if ( dx < 0 | dx >= mdata(MDATA_WIDTH) ) {
					continue
				}
				if ( dist(tlocx, tlocy, dx, dy) > range ) {
					continue
				}
				f = 0
				if ( chipm(CHIPM_ATTRIB, map(dx, dy, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS ) {
					f = 1
				}
				if ( rnd(4) | f == 1 ) {
					map(dx, dy, MAP_TILE_ID) = xy2pic(4, 1)
				}
				if ( rnd(10) == 0 | f == 1 ) {
					addmef dx, dy, MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 20, 50
				}
				if ( map(dx, dy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
					tc = map(dx, dy, MAP_CHARA_INDEX_PLUS_ONE) - 1
					if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
						if ( tc != CHARA_PLAYER ) {
							if ( rnd(cdata(CDATA_HP, tc) + 1) < rnd(cdata(CDATA_HP, cdata(CDATA_TAGTEAM_PARTNER, tc)) + 1) ) {
								tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
							}
							txt lang(name(tc) + "は" + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + "をかばった！", name(tc) + " guarded " + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + ".")
						}
					}
					dmg = 1000
					dmghp tc, dmg, DAMAGE_FROM_NUKE
				}
				mapitem_fire dx, dy
			loop
		loop
		if ( evdata1(evnum - (evnum != 0) * 1) == 33 ) {
			if ( evdata2(evnum - (evnum != 0) * 1) == 16 ) {
				if ( gdata(GDATA_AREA) == AREA_PALMIA ) {
					if ( gdata(GDATA_FLAG_SUB_NUKE) == 1 ) {
						gdata(GDATA_FLAG_SUB_NUKE) = 2
						snd SOUNDLIST_WRITE1
						txtef COLOR_GREEN
						txt lang("ジャーナルが更新された。", "Your journal has been updated.")
					}
				}
			}
		}
		if ( mdata(MDATA_TYPE) == MAP_TYPE_TOWN | mdata(MDATA_TYPE) == MAP_TYPE_VILLAGE ) {
			modkarma 0, (-80) + trait(TRAIT_OTHER_WICKED) * 60
		}
		else {
			modkarma 0, -10
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 18 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *event_SWEND1
		}
		gdata(GDATA_FLAG_RAGNAROK_STARTED)++
		gdata(GDATA_WEATHER) = WEATHER_ETHER
		envonly = 1
		gosub *music_play
		if ( gdata(GDATA_FLAG_CURTAIN_CALL) < 9999 & gdata(GDATA_FLAG_CURTAIN_CALL) >= 0 ) {
			txt lang("終末の日が訪れた。", "Let's Ragnarok!")
			msg_halt
		}
		if ( gdata(GDATA_FLAG_CURTAIN_CALL) >= 9999 | gdata(GDATA_FLAG_CURTAIN_CALL) < 0 ) {
			txt lang("*カーテンコール*", " *Curtain Call* ")
			await 2000
		}
		animeid = ANIMATION_RAGNA
		gosub *anime
		repeat 200
			repeat 2
				x = rnd(mdata(MDATA_WIDTH))
				y = rnd(mdata(MDATA_HEIGHT))
				map(x, y, MAP_TILE_ID) = xy2pic(4, 1)
				cell_featread x, y
				if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_DOOR_CLOSED ) {
					cell_featset x, y, 0, CELL_FEATURE_NONE, 0, 0
				}
			loop
			x = rnd(inf_screenw) + scx
			y = rnd(inf_screenh) + scy
			if ( x < 0 | y < 0 | x >= mdata(MDATA_WIDTH) | y >= mdata(MDATA_HEIGHT) | rnd(5) == 0 ) {
				x = rnd(mdata(MDATA_WIDTH))
				y = rnd(mdata(MDATA_HEIGHT))
			}
			addmef x, y, MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 20, 50, evdata1(evnum - (evnum != 0) * 1)
			mapitem_fire x, y
			if ( cnt \ 4 == 0 ) {
				if ( gdata(GDATA_FLAG_PET_ANNIVERSARY_ACTIVE) == 0 ) {
					flt 100, calcfixlv(FIX_QUALITY_GREAT)
					if ( rnd(4) ) {
						fltnrace = "dragon"
					}
					else {
						fltnrace = "giant"
					}
					characreate -1, CREATURE_ID_BUG, x, y
					if ( stat != 0 ) {
						cbitmod CHARA_BIT_SUMMONED, rc, TRUE
					}
					if ( gdata(GDATA_AREA) != AREA_VOID ) {
						if ( gdata(GDATA_DEEPEST_LEVEL) < 60 ) {
							if ( cdata(CDATA_LEVEL, rc) > 50 ) {
								chara_vanquish rc
							}
						}
					}
				}
			}
			if ( cnt \ 4 == 0 ) {
				if ( gdata(GDATA_FLAG_PET_ANNIVERSARY_ACTIVE) != 0 ) {
					flt
					characreate -1, CREATURE_ID_UNIVERSE_INVADER, x, y
					if ( stat != 0 ) {
						cbitmod CHARA_BIT_SUMMONED, rc, TRUE
					}
				}
			}
			if ( cnt \ 7 == 0 ) {
				gosub *screen_draw
				if ( rnd(7) ) {
					snd SOUNDLIST_FIRE1
				}
				else {
					snd SOUNDLIST_CRUSH1
				}
				await 25
			}
		loop
		gdata(GDATA_FLAG_PET_ANNIVERSARY_ACTIVE) = 0
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 22 | _switch_sw ) {
		_switch_sw = 0
		if ( evdata1(evnum - (evnum != 0) * 1) == 0 ) {
			txtef COLOR_RED
			txt lang("けたたましい警報が鳴り響いた！", "*beeeeeep!* An alarm sounds loudly!")
			repeat 245 - 57, 57
				if ( cdata(CDATA_ID, cnt) == CREATURE_ID_MELUGAST_TYPE0_THE_DIMENSION_DRIVER ) {
					continue
				}
				if ( cbit(CHARA_BIT_NECRO, cnt) == TRUE ) {
					continue
				}
				if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
					cdata(CDATA_RELATION, cnt) = RELATION_ENEMY
					cdata(CDATA_TARGET, cnt) = 0
					cdata(CDATA_AI_AGGRO, cnt) = 250
				}
			loop
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 61 | _switch_sw ) {
		_switch_sw = 0
		if ( evdata1(evnum - (evnum != 0) * 1) == 0 ) {
			repeat 245 - 57, 57
				if ( cbit(CHARA_BIT_NECRO, cnt) == TRUE ) {
					continue
				}
				if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
					if ( cdata(CDATA_RELATION, cnt) == RELATION_ENEMY ) {
						cdata(CDATA_TARGET, cnt) = 0
						cdata(CDATA_AI_AGGRO, cnt) = 250
					}
				}
			loop
		}
		goto *event_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 26 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
			txt lang("強盗があなたに目をつけた！", "Blaggers pick on you!")
			repeat 3
				flt
				initlv = limit(cdata(CDATA_LEVEL, CHARA_PLAYER), 1, 50)
				novoidlv = 1
				characreate -1, CREATURE_ID_ROBBER, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			loop
		}
		goto *event_SWEND1
	}

*event_SWEND1
	return
	return












































































