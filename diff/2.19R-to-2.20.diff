diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/action.hsp ../2.20-borscht/action.hsp
--- ../2.19R-borscht/action.hsp	2023-08-08 08:52:03.590945300 +0800
+++ ../2.20-borscht/action.hsp	2023-10-08 12:52:58.705727200 +0800
@@ -796,12 +796,12 @@
 			return 1
 		}
 	}
 	if ( cc == CHARA_PLAYER ) {
 		if ( inv(INV_ITEM_ID, ci) != ITEM_ID_CORPSE ) {
-			if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 100 ) {
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 0
+			if ( inv(INV_ITEM_PARTS, ci) == 100 ) {
+				inv(INV_ITEM_PARTS, ci) = 0
 			}
 		}
 		if ( ibit(ITEM_BIT_SHOP_SAMPLE, ci) == TRUE ) {
 			ibitmod ITEM_BIT_SHOP_SAMPLE, ci, FALSE
 		}
@@ -2085,10 +2085,22 @@
 						}
 						plevel = limit(cdata(CDATA_LEVEL, CHARA_PLAYER) * 10, 1, 500)
 						if ( rnd(220 + plevel - limit(gdata(GDATA_CARGO_WEIGHT) * 150 / (gdata(GDATA_CARGO_LIMIT) + 1), 0, 210 + plevel)) == 0 ) {
 							encounter = ENCOUNTER_ROGUE
 						}
+						if ( gdata(GDATA_AREA) == AREA_SOUTH_TYRIS ) {
+							if ( gdata(GDATA_FLAG_MAIN) < 345 ) {
+								if ( rnd(400 - gdata(GDATA_FLAG_MAIN)) == 0 ) {
+									encounter = ENCOUNTER_ELEA_REPARATION
+								}
+							}
+							if ( gdata(GDATA_FLAG_MAIN) >= 345 ) {
+								if ( rnd(250) == 0 ) {
+									encounter = ENCOUNTER_ELEA_REPARATION
+								}
+							}
+						}
 						if ( rnd(40) == 0 | 0 ) {
 							repeat 5
 								rq = gdata(GDATA_QUEST_POOL + cnt)
 								if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_ESCORT ) {
 									if ( qdata(QDATA_STATE, rq) == QUEST_STATE_ONGOING ) {
@@ -2123,10 +2135,15 @@
 					if ( encounter == ENCOUNTER_ROGUE ) {
 						encounterlv = cdata(CDATA_FAME, CHARA_PLAYER) / 1000
 						levelexitby = MAP_EXIT_NORMAL
 						goto *map_exit
 					}
+					if ( encounter == ENCOUNTER_ELEA_REPARATION ) {
+						encounterlv = cdata(CDATA_FAME, CHARA_PLAYER) / 1000
+						levelexitby = MAP_EXIT_NORMAL
+						goto *map_exit
+					}
 					if ( encounter == ENCOUNTER_ASSASSIN ) {
 						gdata(GDATA_RETURN_AREA) = gdata(GDATA_AREA), gdata(GDATA_LEVEL), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
 						levelexitby = MAP_EXIT_NORMAL
 						goto *map_exit
 					}
@@ -4040,12 +4057,12 @@
 	gdata(GDATA_FLAG_CURTAIN_CALL)++
 	if ( cdata(CDATA_GAUGE_COOLDOWN, cc) == 0 ) {
 		if ( cdata(CDATA_SP, cc) > (-50) ) {
 			cdata(CDATA_SP, cc)--
 		}
-		if ( cdata(CDATA_DRAIN_HP, cc) < 99 ) {
-			cdata(CDATA_DRAIN_HP, cc)++
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) < 99 ) {
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc)++
 		}
 		cdata(CDATA_GAUGE_COOLDOWN, cc) = 1
 		if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
 			cdata(CDATA_POWER_GAUGE, cc) += 2
 			if ( cdata(CDATA_ID, cc) == CREATURE_ID_TALON_SOLDIER ) {
@@ -4925,11 +4942,11 @@
 								}
 								snd SOUNDLIST_PUNISH1
 								if ( cfg_attackanime ) {
 									animeload 39, tc
 								}
-								dmghp tc, orgdmg / 30 * ((rnd(20) + shootp) / 50) + rnd(sdata(SKILL_NORMAL_TACTICS, cc) * 3 + 1), cc
+								dmghp tc, orgdmg / 30 * ((rnd(20) + shootp + 800) / 130) + rnd(sdata(SKILL_NORMAL_TACTICS, cc) * 3 + 1), cc
 							}
 							if ( cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) == 2 ) {
 								txtef COLOR_PINK
 								txt lang(name(cc) + "は" + s(1) + "による射撃を加えた！", "Furthermore, " + name(cc) + " fired " + s(1) + "!")
 								if ( cdata(CDATA_EVASION_PENALTY, tc) < 2 ) {
@@ -4939,11 +4956,11 @@
 								}
 								snd SOUNDLIST_PUNISH1
 								if ( cfg_attackanime ) {
 									animeload 39, tc
 								}
-								dmghp tc, orgdmg / 30 * ((rnd(20) + shootp) / 50) + rnd(sdata(SKILL_NORMAL_MARKSMAN, cc) * 3 + 1), cc
+								dmghp tc, orgdmg / 30 * ((rnd(20) + shootp + 800) / 140) + rnd(sdata(SKILL_NORMAL_MARKSMAN, cc) * 3 + 1), cc
 							}
 						}
 					}
 				}
 			}
@@ -5242,14 +5259,16 @@
 				if ( extraattack ) {
 					txt lang("さらに", "Furthermore,")
 					txtcontinue
 				}
 				if ( tc < MAX_CHARA_FOLLOWER ) {
-					txt lang(aln(tc) + name(cc) + "の攻撃を華麗に避けた。", name(tc) + " skillfully evade" + _s(tc) + " " + name(cc) + ".")
+					txtef COLOR_BLUE
+					txt lang(aln(tc) + name(cc) + "の攻撃を完全に見切って避けた。", name(tc) + " skillfully evade" + _s(tc) + " " + name(cc) + ".")
 				}
 				else {
-					txt lang(aln(cc) + "攻撃を華麗にかわされた。", name(tc) + " skillfully evade" + _s(tc) + " " + name(cc) + ".")
+					txtef COLOR_BLUE
+					txt lang(aln(cc) + "攻撃は完全に見切られてかわされた。", name(tc) + " skillfully evade" + _s(tc) + " " + name(cc) + ".")
 				}
 			}
 		}
 	}
 	if ( findbuff(tc, BUFF_KILLING_DANCE) != (-1) & cdata(CDATA_EXIST, cc) == CHAR_STATE_ALIVE ) {
@@ -8477,11 +8496,11 @@
 			}
 			if ( rtval == 1 ) {
 				tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
 			}
 		}
-		if ( cdata(CDATA_SP_EARNED, tc) <= (-2000000) ) {
+		if ( cdata(CDATA_PREGNANCY_PROGRESS, tc) <= (-2000000) ) {
 			txt lang("フェイズ2には使っても意味がない。", "There is no point in using it Phase 2.")
 			gosub *screen_draw
 			goto *pc_turn
 		}
 		teikou = sdata(SKILL_ATTR_STR, tc) + 100
@@ -8498,17 +8517,17 @@
 			}
 		}
 		snd SOUNDLIST_SWING39
 		txt lang(name(tc) + "「痛っ！」", name(tc) + " writhe" + _s(tc) + " in pain.")
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SURVIVABILITY_EXTENDER_X ) {
-			cdata(CDATA_TAMER_WHIP_EAT, tc) = limit(cdata(CDATA_TAMER_WHIP_EAT, tc) + 1, 1, 9)
+			cdata(CDATA_PREGNANCY_FEMALE_CHILD, tc) = limit(cdata(CDATA_PREGNANCY_FEMALE_CHILD, tc) + 1, 1, 9)
 		}
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SURVIVABILITY_EXTENDER_Y ) {
-			cdata(CDATA_TAMER_WHIP_PICKUP, tc) = limit(cdata(CDATA_TAMER_WHIP_PICKUP, tc) + 1, 1, 9)
+			cdata(CDATA_PREGNANCY_MALE_CHILD, tc) = limit(cdata(CDATA_PREGNANCY_MALE_CHILD, tc) + 1, 1, 9)
 		}
-		if ( cdata(CDATA_SP_EARNED, tc) > (-1000000) ) {
-			cdata(CDATA_SP_EARNED, tc) = -1000000
+		if ( cdata(CDATA_PREGNANCY_PROGRESS, tc) > (-1000000) ) {
+			cdata(CDATA_PREGNANCY_PROGRESS, tc) = -1000000
 		}
 		if ( cbit(CHARA_BIT_PREGNANT, tc) ) {
 			cbitmod CHARA_BIT_PREGNANT, tc, FALSE
 			if ( synccheck(tc, -1) ) {
 				txt lang(name(tc) + "の体内の異物は養分にされた。", name(tc) + your(tc) + "  child melt in " + his(tc) + " stomach.")
@@ -9685,11 +9704,11 @@
 				}
 			}
 		}
 		ci = cibk
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( inv(INV_ITEM_SHOP_SAMPLE, ci) > 0 ) {
+			if ( inv(INV_ITEM_PARTS, ci) > 0 ) {
 				dmge = (sdata(SKILL_ATTR_STR, cc) * (kinhosei + 5) / 25 + 5) * ((sdata(SKILL_NORMAL_MARKSMAN, cc) + 1) / 5 + 5) + rnd(sdata(SKILL_ATTR_MAG, cc) * 4 + 5 + ((limit(cdata(CDATA_LEVEL, cc) - 50, 1, 2000) + limit(cdata(CDATA_LEVEL, cc) - 100, 1, 2000)) * 2 * sqrt(limit(cdata(CDATA_LEVEL, cc), 1, 2000) * 3) + 30 + 1) / 8) + ((limit(cdata(CDATA_LEVEL, cc) - 50, 1, 2000) + limit(cdata(CDATA_LEVEL, cc) - 100, 1, 2000)) * 2 * sqrt(limit(cdata(CDATA_LEVEL, cc), 1, 2000) * 3) + 30 + 1) * 3 / 8
 				if ( inv(INV_ITEM_PARAM3, ci) \ 100 == 5 | inv(INV_ITEM_AMUR_CAGE, ci) == 5 ) {
 					dmge = (sdata(SKILL_ATTR_STR, cc) * (kinhosei + 5) / 25 + 5) * ((sdata(SKILL_NORMAL_MARKSMAN, cc) + 1) / 5 + 5) + sdata(SKILL_ATTR_MAG, cc) * 4 + 5 + ((limit(cdata(CDATA_LEVEL, cc) - 50, 1, 2000) + limit(cdata(CDATA_LEVEL, cc) - 100, 1, 2000)) * 2 * sqrt(limit(cdata(CDATA_LEVEL, cc), 1, 2000) * 3) + 30 + 1) / 2
 				}
 				dmge = dmge / 5 * (inv(INV_ITEM_LEVEL, ci) + 3)
@@ -9697,11 +9716,11 @@
 					dmge = dmge * 11 / 10
 				}
 				if ( inv(INV_ITEM_PARAM3, ci) \ 100 == 3 | inv(INV_ITEM_AMUR_CAGE, ci) == 3 & inv(INV_ITEM_PARAM2, ci) >= 2 ) {
 					dmge = dmge * 9 / 5
 				}
-				dmghp tc, dmge, cc, inv(INV_ITEM_SHOP_SAMPLE, ci), 500 + limit(sdata(SKILL_ATTR_MAG, cc) * 2, 1, 4000)
+				dmghp tc, dmge, cc, inv(INV_ITEM_PARTS, ci), 500 + limit(sdata(SKILL_ATTR_MAG, cc) * 2, 1, 4000)
 			}
 		}
 		ci = cibk
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
 			if ( inv(INV_ITEM_PARAM3, ci) \ 100 == 1 | inv(INV_ITEM_AMUR_CAGE, ci) == 1 ) {
@@ -9921,14 +9940,14 @@
 			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 0
 		}
 		item_stack cc, ci, 1
 		animeid = ANIMATION_LASER_BAZOOKA
 		gosub *anime
-		if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-			cdata(CDATA_DRAIN_HP, tc) += 20
-			if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) = 99
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 20
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 99
 			}
 		}
 		dmg = (sdata(SKILL_ATTR_DEX, cc) / 5 + 5) * ((sdata(SKILL_NORMAL_MARKSMAN, cc) + 1) / 5 + 5) + rnd(sdata(SKILL_NORMAL_MARKSMAN, cc) * 2 + 5) + (limit(cdata(CDATA_LEVEL, cc) - 50, 1, 2000) + limit(cdata(CDATA_LEVEL, cc) - 100, 1, 2000)) * 2 * sqrt(limit(cdata(CDATA_LEVEL, cc), 1, 2000) * 3) + 30
 		dmghp tc, dmg, cc, SKILL_RESDMG_CRUSH, 1000
 		if ( cdata(CDATA_EXIST, cc) == CHAR_STATE_ALIVE ) {
@@ -10469,10 +10488,84 @@
 			txt lang("それは無理だ。", "It's impossible.")
 		}
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
+	if ( _switch_val == 146 | _switch_sw ) {
+		_switch_sw = 0
+		if ( gdata(GDATA_AREA) == AREA_ARENA | gdata(GDATA_AREA) == AREA_PET_ARENA | gdata(GDATA_AREA) == AREA_CHAOS_CRADLE | gdata(GDATA_AREA) == AREA_VOID | adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) != 0 | (gdata(GDATA_AREA) == AREA_SHELTER & gdata(GDATA_LEVEL) == 1) ) {
+			txt lang("このエリアでは使えない。", "You cant use it in this area.")
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		txt lang("誰を閉じ込める？", "Lock up who?")
+		gosub *screen_draw
+		val = 0
+		gosub *prompt_direction
+		f = 0
+		if ( stat != 0 ) {
+			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
+				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
+				if ( cbit(CHARA_BIT_SANDBAG, tc) ) {
+					txt lang("サンドバッグが邪魔だ。", "The sandbag is in the way.")
+					goto *pc_turn
+				}
+				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
+					txt lang("タッグは閉じ込められない。", "It is possible to lock up tag team.")
+					goto *pc_turn
+				}
+				if ( cdata(CDATA_HP, tc) >= cdata(CDATA_MAX_HP, tc) / 4 ) {
+					if ( 0 == 0 ) {
+						txt lang("もっと弱らせないと閉じ込められない。", "The target needs to be weakened.")
+						goto *pc_turn
+					}
+				}
+				if ( tc != CHARA_PLAYER ) {
+					if ( tc < MAX_CHARA_FOLLOWER ) {
+						txt lang("仲間を閉じ込めるなんてとんでもない！", "Locking up your ally is a brutal idea!")
+						goto *pc_turn
+					}
+				}
+				if ( cbit(CHARA_BIT_LOCKED_UP, tc) ) {
+					txt lang("それは既に閉じ込められている。", "It's already locked up.")
+					goto *pc_turn
+				}
+				if ( cdata(CDATA_RELATION, tc) == RELATION_ALLY | cbit(CHARA_BIT_NECRO, tc) == TRUE | cdata(CDATA_QUALITY, tc) >= FIX_QUALITY_MIRACLE | cdata(CDATA_ROLE, tc) != ROLE_NONE | cbit(CHARA_BIT_PRECIOUS, tc) == TRUE | cdata(CDATA_CHARACTER_TIER, tc) == CHARACTER_TIER_SUMMONED_NORMAL | cbit(CHARA_BIT_BODYGUARD, tc) == TRUE | gdata(GDATA_FLAG_DUEL_TARGET) == tc ) {
+					txt lang("その生物には無効だ。", "The creature can't be captured.")
+					goto *pc_turn
+				}
+				if ( tc == CHARA_PLAYER ) {
+					txt lang("あなたは檻に入ろうと思ったがやめた…", "You try to going into the cage but rethink...")
+				}
+				else {
+					snd SOUNDLIST_AMMO
+					await 50
+					snd SOUNDLIST_LOCKED1
+					await 50
+					snd SOUNDLIST_ENC
+					inv(INV_ITEM_NUM, ci)--
+					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+					gosub *calcBurdenPc
+					cbitmod CHARA_BIT_LOCKED_UP, tc, TRUE
+					txt lang("あなたは" + name(tc) + "を閉じ込めた。", "You lock up " + name(tc) + ".")
+					txtvalid = 0
+					txt lang(name(tc) + "は呻き声を洩らした。「出せー！」", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("Release me..."))
+					modimp tc, -50
+					modimp2 tc, -50
+					rc = tc
+					gosub *add_ally
+					check_quest
+				}
+				f = 1
+			}
+		}
+		if ( f == 0 ) {
+			txt lang("それは無理だ。", "It's impossible.")
+		}
+		goto *act_use_SWEND1
+		_switch_sw++
+	}
 	if ( _switch_val == 66 | _switch_sw ) {
 		_switch_sw = 0
 		gosub *screen_draw
 		val = 0
 		gosub *prompt_direction
@@ -11260,10 +11353,11 @@
 		fixlv = FIX_QUALITY_GOOD
 		characreate -1, p, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
 		cdata(CDATA_RELATION, rc) = RELATION_ALLY
 		cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
 		cbitmod CHARA_BIT_NECRO, rc, TRUE
+		cbitmod CHARA_BIT_SHADOW_CLONE, rc, TRUE
 		cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
 		snd SOUNDLIST_CURSE3
 		animeid = ANIMATION_GENE
 		anic = 0
 		gosub *anime
@@ -12707,88 +12801,88 @@
 		gosub *com_inventory
 		if ( stat == 1 ) {
 			cibk2 = ci
 			snd SOUNDLIST_CRACK2
 			txt lang(itemname(ci) + "を小分けにして粘菌を使った。", itemname(ci) + " became vessels for slime mold.")
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 10 == 1 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 10 == 1 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 8
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 1
+				inv(INV_ITEM_PARTS, ci) = 1
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 100 >= 10 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 100 >= 10 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 20
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 2
+				inv(INV_ITEM_PARTS, ci) = 2
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 1000 >= 100 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 1000 >= 100 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 15
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 3
+				inv(INV_ITEM_PARTS, ci) = 3
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 10000 >= 1000 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 10000 >= 1000 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 8
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 4
+				inv(INV_ITEM_PARTS, ci) = 4
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 100000 >= 10000 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 100000 >= 10000 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 20
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 5
+				inv(INV_ITEM_PARTS, ci) = 5
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 1000000 >= 100000 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 1000000 >= 100000 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 20
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 6
+				inv(INV_ITEM_PARTS, ci) = 6
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 10000000 >= 1000000 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 10000000 >= 1000000 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 15
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 7
+				inv(INV_ITEM_PARTS, ci) = 7
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 100000000 >= 10000000 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 100000000 >= 10000000 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 15
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 8
+				inv(INV_ITEM_PARTS, ci) = 8
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
-			if ( inv(INV_ITEM_SHOP_SAMPLE, cibk2) \ 1000000000 >= 100000000 ) {
+			if ( inv(INV_ITEM_PARTS, cibk2) \ 1000000000 >= 100000000 ) {
 				flt
 				itemcreate -1, ITEM_ID_NECRO_PARTS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, cibk2) / 8
 				inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_SUB_NAME, cibk2)
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 9
+				inv(INV_ITEM_PARTS, ci) = 9
 				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			}
 			item_identify ci, ITEM_KNOWN_FULL
 			inv(INV_ITEM_NUM, cibk)--
 			inv(INV_ITEM_NUM, cibk2)--
@@ -12885,11 +12979,11 @@
 				r1 = tc
 				repeat 30, 100
 					if ( cdata(cnt, r1) != 0 ) {
 						continue
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 1 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 1 ) {
 						if ( damehead == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 1 * 10000
@@ -12899,11 +12993,11 @@
 						else {
 							txt lang(name(r1) + "は新たな" + bodyn(1) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(1) + "!")
 							break
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 2 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 2 ) {
 						if ( dameneck == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 2 * 10000
@@ -12913,11 +13007,11 @@
 						else {
 							txt lang(name(r1) + "は新たな" + bodyn(2) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(2) + "!")
 							break
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 3 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 3 ) {
 						if ( dameback == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 3 * 10000
@@ -12927,11 +13021,11 @@
 						else {
 							txt lang(name(r1) + "は新たな" + bodyn(3) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(3) + "!")
 							break
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 4 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 4 ) {
 						if ( damechest == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 4 * 10000
@@ -12941,11 +13035,11 @@
 						else {
 							txt lang(name(r1) + "は新たな" + bodyn(4) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(4) + "!")
 							break
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 5 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 5 ) {
 						if ( damehand == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 5 * 10000
@@ -12955,11 +13049,11 @@
 						else {
 							txt lang(name(r1) + "は新たな" + bodyn(5) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(5) + "!")
 							break
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 6 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 6 ) {
 						if ( damefinger == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 6 * 10000
@@ -12969,11 +13063,11 @@
 						else {
 							txt lang(name(r1) + "は新たな" + bodyn(6) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(6) + "!")
 							break
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 7 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 7 ) {
 						if ( damearm == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 7 * 10000
@@ -12983,11 +13077,11 @@
 						else {
 							txt lang(name(r1) + "は新たな" + bodyn(7) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(7) + "!")
 							break
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 8 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 8 ) {
 						if ( damewaist == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 8 * 10000
@@ -12997,11 +13091,11 @@
 						else {
 							txt lang(name(r1) + "は新たな" + bodyn(8) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(8) + "!")
 							break
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 9 ) {
+					if ( inv(INV_ITEM_PARTS, ci) == 9 ) {
 						if ( dameleg == 1 ) {
 							dame = 100
 							break
 						}
 						cdata(cnt, r1) = 9 * 10000
@@ -13448,10 +13542,34 @@
 		gosub *screen_draw
 		goto *com_story
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
+	if ( _switch_val == 147 | _switch_sw ) {
+		_switch_sw = 0
+		if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_CAMP ) {
+			txt lang("収容所以外ではエナジーを蓄積できない。", "Energy cannot be accumulated outside of the camp.")
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		gdata(GDATA_ROW_ACT) = ACTION_SLAVE_SPINNER
+		gosub *generalAct
+		goto *act_use_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 148 | _switch_sw ) {
+		_switch_sw = 0
+		if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_CAMP ) {
+			txt lang("収容所以外ではエナジーを蓄積できない。", "Energy cannot be accumulated outside of the camp.")
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		gdata(GDATA_ROW_ACT) = ACTION_SLAVE_WHEEL
+		gosub *generalAct
+		goto *act_use_SWEND1
+		_switch_sw++
+	}
 	if ( _switch_val == 7 | _switch_sw ) {
 		_switch_sw = 0
 		if ( inv(INV_ITEM_PROPERTY, ci) != PROP_CONSTRUCT ) {
 			if ( mdata(MDATA_CAN_SAVE) == 0 | gdata(GDATA_AREA) == AREA_QUEST | gdata(GDATA_AREA) == AREA_SHELTER ) {
 				if ( gdata(GDATA_AREA) == AREA_WILDERNESS ) {
@@ -14587,11 +14705,11 @@
 		txt lang(" *ピッ* ", "*Pep* ")
 		repeat 245
 			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
 				continue
 			}
-			if ( cdata(CDATA_DRAIN_HP, cnt) >= 100 ) {
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cnt) >= 100 ) {
 				continue
 			}
 			tc = cnt
 			dx = cdata(CDATA_X, tc)
 			dy = cdata(CDATA_Y, tc)
@@ -14599,13 +14717,13 @@
 				continue
 			}
 			if ( fov_los(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), dx, dy) == 0 ) {
 				continue
 			}
-			cdata(CDATA_DRAIN_HP, tc) -= 5
-			if ( cdata(CDATA_DRAIN_HP, tc) < 0 ) {
-				cdata(CDATA_DRAIN_HP, tc) = 0
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) -= 5
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 0 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 0
 			}
 		loop
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
@@ -14839,11 +14957,11 @@
 	if ( _switch_val == 54 | _switch_sw ) {
 		_switch_sw = 0
 		txtef COLOR_BLUE
 		txt lang("衛星軌道上から荷電粒子砲が発射された！", "Rain of lazer pours into the ground!")
 		gdata(GDATA_TEMPORARY_FLAGS3) = 777
-		animeid = ANIMATION_HOLY
+		animeid = ANIMATION_GOD_CHARGE_ROD
 		animode = 0
 		gosub *anime
 		gdata(GDATA_TEMPORARY_FLAGS3) = 0
 		repeat mdata(MDATA_HEIGHT)
 			dy = cnt
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/adv.hsp ../2.20-borscht/adv.hsp
--- ../2.19R-borscht/adv.hsp	2023-08-08 08:52:03.599922900 +0800
+++ ../2.20-borscht/adv.hsp	2023-10-08 12:52:58.713705900 +0800
@@ -172,10 +172,11 @@
 	cbitmod CHARA_BIT_SANDBAG, rc, FALSE
 	cbitmod CHARA_BIT_SUMMONED, rc, FALSE
 	cbitmod CHARA_BIT_FESTIVAL, rc, FALSE
 	cbitmod CHARA_BIT_BRUSHED, rc, FALSE
 	cbitmod CHARA_BIT_LIVESTOCK, rc, FALSE
+	cbitmod CHARA_BIT_LABOR_CAMP, rc, FALSE
 	if ( cdata(CDATA_ALLIED, rc) == 0 ) {
 		cdata(CDATA_FAME, rc) = (cdata(CDATA_FAME, rc) + 1) / 1000 + 1
 	}
 	cdata(CDATA_ALLIED, rc) = 100
 	if ( cdata(CDATA_JOIN_DATE_MONTH, rc) == 0 ) {
@@ -187,13 +188,20 @@
 	if ( cdata(CDATA_JOIN_DATE_YEAR, rc) == 0 ) {
 		cdata(CDATA_JOIN_DATE_YEAR, rc) = gdata(GDATA_YEAR)
 	}
 	r1 = rc
 	gosub *charaRefresh
-	snd SOUNDLIST_PRAY1
-	txtef COLOR_YELLOW
-	txt lang(cdatan(CDATAN_NAME, rc) + "が仲間に加わった！", cdatan(CDATAN_NAME, rc) + " join" + _s(rc) + " your party!")
+	if ( cbit(CHARA_BIT_LOCKED_UP, rc) != FALSE ) {
+		snd SOUNDLIST_LOCKED1
+		txtef COLOR_YELLOW2
+		txt lang(cdatan(CDATAN_NAME, rc) + "が連行対象に加わった。収容所に連行して、オペレートボードを使って収容しよう。", cdatan(CDATAN_NAME, rc) + " join" + _s(rc) + " take-away list. Go to the camp and use the operating board to place " + cdatan(CDATAN_NAME, rc) + ".")
+	}
+	if ( cbit(CHARA_BIT_LOCKED_UP, rc) == FALSE ) {
+		snd SOUNDLIST_PRAY1
+		txtef COLOR_YELLOW
+		txt lang(cdatan(CDATAN_NAME, rc) + "が仲間に加わった！", cdatan(CDATAN_NAME, rc) + " join" + _s(rc) + " your party!")
+	}
 	return 1
 
 *adv_init
 	if ( dbg_noadv == 1 ) {
 		return
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/ai.hsp ../2.20-borscht/ai.hsp
--- ../2.19R-borscht/ai.hsp	2023-08-08 08:52:03.639816000 +0800
+++ ../2.20-borscht/ai.hsp	2023-10-08 12:52:58.742629900 +0800
@@ -384,10 +384,20 @@
 			}
 		}
 		cdata(CDATA_AI_AGGRO, cc) = 0
 		goto *turn_end
 	}
+	if ( cbit(CHARA_BIT_LOCKED_UP, cc) ) {
+		if ( synccheck(cc, -1) ) {
+			if ( rnd(30) == 0 ) {
+				tc = cc
+				txt lang("「ここから出せー！」", cnvtalk("Release me now.")), lang("「こんなことして、許さない" + _yo(2) + "」", cnvtalk("I won't forget this.")), lang("「どこに連れていく" + _nda(2) + "」", cnvtalk("Where are you taking me?"))
+			}
+		}
+		cdata(CDATA_AI_AGGRO, cc) = 0
+		goto *turn_end
+	}
 	if ( cbit(CHARA_BIT_LIVESTOCK, cc) ) {
 		goto *ai_calmMove
 	}
 	if ( cbit(CHARA_BIT_NECRO, cc) ) {
 		if ( synccheck(cc, -1) == 0 ) {
@@ -3057,11 +3067,11 @@
 			}
 		}
 	}
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_MOSTMUSCYLLA | cdata(CDATA_ID, cc) == CREATURE_ID_OOTEGUCHI | cdata(CDATA_ID, cc) == CREATURE_ID_HEROYEEK | cdata(CDATA_ID, cc) == CREATURE_ID_MUSCLE_GOLEM | cdata(CDATA_ID, cc) == CREATURE_ID_SNAIL_THE_ANDROID_RIDER | cdata(CDATA_ID, cc) == CREATURE_ID_OPATOS | cdata(CDATA_ID, cc) == CREATURE_ID_MAGIC_HAWK_MOTH | cdata(CDATA_ID, cc) == CREATURE_ID_OXODE_THE_QUEEN_BEE ) {
 		if ( cdata(CDATA_POWER_GAUGE, cc) < 85 ) {
-			if ( cdata(CDATA_DRAIN_HP, cc) >= 15 ) {
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) >= 15 ) {
 				if ( rnd(10) == 0 ) {
 					act = SKILL_SPACT_POSING
 				}
 			}
 		}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/calculation.hsp ../2.20-borscht/calculation.hsp
--- ../2.19R-borscht/calculation.hsp	2023-08-08 08:52:03.702648500 +0800
+++ ../2.20-borscht/calculation.hsp	2023-10-08 12:52:58.789505300 +0800
@@ -525,10 +525,13 @@
 			locvar_calccostbuilding_hantei++
 		}
 		if ( adata(ADATA_ID, cnt) == AREA_RANCH ) {
 			locvar_calccosthire_cost += 1000
 		}
+		if ( adata(ADATA_ID, cnt) == AREA_CAMP ) {
+			locvar_calccosthire_cost += 2500
+		}
 		if ( adata(ADATA_ID, cnt) == AREA_CROP ) {
 			locvar_calccosthire_cost += 750
 		}
 		if ( adata(ADATA_ID, cnt) == AREA_SHOP ) {
 			locvar_calccosthire_cost += 2000
@@ -1411,11 +1414,11 @@
 	}
 	spact(SKILL_SPACT_DRAIN_BLOOD - STARTING_SKILL_SPACT) = 1
 	spact(SKILL_SPACT_FIRE_BREATH - STARTING_SKILL_SPACT) = 1
 	spact(SKILL_SPACT_TOUCH_OF_WEAKNESS - STARTING_SKILL_SPACT) = 1
 	spact(SKILL_SPACT_PSYCHOANALYSIS - STARTING_SKILL_SPACT) = 1
-	repeat 855 - 600
+	repeat 856 - 600
 		spact(cnt + STARTING_SKILL_SPACT - STARTING_SKILL_SPACT) = 1
 	loop
 	skillinit SKILL_NORMAL_CASTING, r1, 6
 	skillinit SKILL_NORMAL_SHIELD, r1, 2
 	skillinit SKILL_WEAPON_FIREARM, r1, 2
@@ -1693,11 +1696,11 @@
 		}
 		p = cdata(CDATA_HUNGER, r1) / 1000
 		if ( gdata(GDATA_FLAG_MAIN) != 900 ) {
 			cdata(CDATA_HUNGER, r1) -= haraheri
 		}
-		if ( cdata(CDATA_SP_EARNED, r1) <= (-2000000) ) {
+		if ( cdata(CDATA_PREGNANCY_PROGRESS, r1) <= (-2000000) ) {
 			cdata(CDATA_HUNGER, r1) -= haraheri
 		}
 		if ( findbuff(r1, BUFF_CURSE_OF_HUNGER) != (-1) ) {
 			cdata(CDATA_HUNGER, r1) -= haraheri / 2
 		}
@@ -2034,26 +2037,26 @@
 		if ( cdata(CDATA_CONDITION_OIL, r1) == 0 ) {
 			r1 = r1
 			gosub *charaRefresh
 		}
 	}
-	if ( cdata(CDATA_DRAIN_HP, r1) > 0 ) {
-		cdata(CDATA_DRAIN_HP, r1)--
-		if ( cdata(CDATA_DRAIN_HP, r1) == 100 ) {
-			cdata(CDATA_DRAIN_HP, r1) = 0
+	if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1) > 0 ) {
+		cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1)--
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1) == 100 ) {
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1) = 0
 		}
 	}
 	if ( cdata(CDATA_SP, r1) < cdata(CDATA_MAX_SP, r1) ) {
 		if ( rnd(sdata(SKILL_ATTR_CON, r1) * 2 + 100) > rnd(4000) ) {
 			healsp r1, 1
 		}
 	}
-	if ( cdata(CDATA_DRAIN_HP, r1) > 0 ) {
+	if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1) > 0 ) {
 		if ( rnd(sdata(SKILL_ATTR_CON, r1) * 2 + 100) > rnd(4000) ) {
-			cdata(CDATA_DRAIN_HP, r1)--
-			if ( cdata(CDATA_DRAIN_HP, r1) == 100 ) {
-				cdata(CDATA_DRAIN_HP, r1) = 0
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1)--
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1) == 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1) = 0
 			}
 		}
 	}
 	if ( cdata(CDATA_DRUG_DEPENDENCE, r1) > 0 ) {
 		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD & rnd(50) == 0 ) {
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/chara.hsp ../2.20-borscht/chara.hsp
--- ../2.19R-borscht/chara.hsp	2023-08-08 08:52:03.749522700 +0800
+++ ../2.20-borscht/chara.hsp	2023-10-08 12:52:58.825408800 +0800
@@ -2311,11 +2311,11 @@
 	cdata(CDATA_WEIGHT, rc) = cdata(CDATA_HEIGHT, rc) * cdata(CDATA_HEIGHT, rc) * (rnd(6) + 18) / 10000
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_SPACE_ZILLA | cdata(CDATA_ID, rc) == CREATURE_ID_DHOLE | cdata(CDATA_ID, rc) == CREATURE_ID_CLOUD_BEAST | cdata(CDATA_ID, rc) == CREATURE_ID_METAL_ZILLA | cdata(CDATA_ID, rc) == CREATURE_ID_GRAND_LEECH | cdata(CDATA_ID, rc) == CREATURE_ID_SIN_GORILLA | cdata(CDATA_ID, rc) == CREATURE_ID_SUNRISE_THE_ARCHIPELAGO_DRAGON ) {
 		cdata(CDATA_HEIGHT, rc) += rnd(4000) + 8000
 		cdata(CDATA_WEIGHT, rc) += rnd(500000) + 7000000
 	}
-	if ( cdata(CDATA_ID, rc) == CREATURE_ID_THE_CHAOS_CHILD | cdata(CDATA_ID, rc) == CREATURE_ID_LIAR_POISON_FUNGUS | cdata(CDATA_ID, rc) == CREATURE_ID_RAVANA | cdata(CDATA_ID, rc) == CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD | cdata(CDATA_ID, rc) == CREATURE_ID_DARK_ARTIFICIAL_GIANT ) {
+	if ( cdata(CDATA_ID, rc) == CREATURE_ID_NINE_HEAD_DRAGON_THE_ABYSS | cdata(CDATA_ID, rc) == CREATURE_ID_THE_CHAOS_CHILD | cdata(CDATA_ID, rc) == CREATURE_ID_LIAR_POISON_FUNGUS | cdata(CDATA_ID, rc) == CREATURE_ID_RAVANA | cdata(CDATA_ID, rc) == CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD | cdata(CDATA_ID, rc) == CREATURE_ID_DARK_ARTIFICIAL_GIANT ) {
 		cdata(CDATA_HEIGHT, rc) += rnd(1000) + 4800
 		cdata(CDATA_WEIGHT, rc) += rnd(200000) + 1000000
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_CHAOS_SERPENT | cdata(CDATA_ID, rc) == CREATURE_ID_BRONTOSAURUS | cdata(CDATA_ID, rc) == CREATURE_ID_SURTR ) {
 		cdata(CDATA_HEIGHT, rc) += rnd(800) + 2500
@@ -2366,15 +2366,15 @@
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_SILVER_CAT | cdata(CDATA_ID, rc) == CREATURE_ID_STRAY_CAT | cdata(CDATA_ID, rc) == CREATURE_ID_BAMBOO_SPROUT | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOS_SEED | cdata(CDATA_ID, rc) == CREATURE_ID_KARATA_THE_SEMINAR_MASCOT | cdata(CDATA_ID, rc) == CREATURE_ID_NURSING_MOTH ) {
 		cdata(CDATA_HEIGHT, rc) = rnd(10) + 20
 		cdata(CDATA_WEIGHT, rc) = rnd(2) + 1
 	}
-	if ( cdata(CDATA_ID, rc) == CREATURE_ID_LION | cdata(CDATA_ID, rc) == CREATURE_ID_CARBUNCLE | cdata(CDATA_ID, rc) == CREATURE_ID_MEGA_MOLE | cdata(CDATA_ID, rc) == CREATURE_ID_TALPIDAE | cdata(CDATA_ID, rc) == CREATURE_ID_SHINING_SILVER_WOLF | cdata(CDATA_ID, rc) == CREATURE_ID_BLAZE_LION | cdata(CDATA_ID, rc) == CREATURE_ID_CAPTAIN_SHARK | cdata(CDATA_ID, rc) == CREATURE_ID_RAGING_SHARK | cdata(CDATA_ID, rc) == CREATURE_ID_NIGHTMARE_SHARK | cdata(CDATA_ID, rc) == CREATURE_ID_LEGENDARY_WOLF | cdata(CDATA_ID, rc) == CREATURE_ID_DARK_RAIDER | cdata(CDATA_ID, rc) == CREATURE_ID_SEIASHIN | cdata(CDATA_ID, rc) == CREATURE_ID_SALAMANDER | cdata(CDATA_ID, rc) == CREATURE_ID_NUOU | cdata(CDATA_ID, rc) == CREATURE_ID_SIVA_THE_DESTRUCTION | cdata(CDATA_ID, rc) == CREATURE_ID_NAGAREW_THE_OBLIVION_BEAST | cdata(CDATA_ID, rc) == CREATURE_ID_LION2 | cdata(CDATA_ID, rc) == CREATURE_ID_FALLEN_BIRD | cdata(CDATA_ID, rc) == CREATURE_ID_TELHUREZA_THE_HOUSE_GUARD | cdata(CDATA_ID, rc) == CREATURE_ID_DOSUKEBE_SEA_ANEMONE | cdata(CDATA_ID, rc) == CREATURE_ID_DOLPHIN_SOLDIER | cdata(CDATA_ID, rc) == CREATURE_ID_ETHERIAN_PLUS ) {
+	if ( cdata(CDATA_ID, rc) == CREATURE_ID_LION | cdata(CDATA_ID, rc) == CREATURE_ID_CARBUNCLE | cdata(CDATA_ID, rc) == CREATURE_ID_MEGA_MOLE | cdata(CDATA_ID, rc) == CREATURE_ID_TALPIDAE | cdata(CDATA_ID, rc) == CREATURE_ID_SHINING_SILVER_WOLF | cdata(CDATA_ID, rc) == CREATURE_ID_BLAZE_LION | cdata(CDATA_ID, rc) == CREATURE_ID_CAPTAIN_SHARK | cdata(CDATA_ID, rc) == CREATURE_ID_RAGING_SHARK | cdata(CDATA_ID, rc) == CREATURE_ID_NIGHTMARE_SHARK | cdata(CDATA_ID, rc) == CREATURE_ID_LEGENDARY_WOLF | cdata(CDATA_ID, rc) == CREATURE_ID_DARK_RAIDER | cdata(CDATA_ID, rc) == CREATURE_ID_SEIASHIN | cdata(CDATA_ID, rc) == CREATURE_ID_SALAMANDER | cdata(CDATA_ID, rc) == CREATURE_ID_NUOU | cdata(CDATA_ID, rc) == CREATURE_ID_SIVA_THE_DESTRUCTION | cdata(CDATA_ID, rc) == CREATURE_ID_NAGAREW_THE_OBLIVION_BEAST | cdata(CDATA_ID, rc) == CREATURE_ID_LION2 | cdata(CDATA_ID, rc) == CREATURE_ID_FALLEN_BIRD | cdata(CDATA_ID, rc) == CREATURE_ID_TELHUREZA_THE_HOUSE_GUARD | cdata(CDATA_ID, rc) == CREATURE_ID_DOSUKEBE_SEA_ANEMONE | cdata(CDATA_ID, rc) == CREATURE_ID_DOLPHIN_SOLDIER | cdata(CDATA_ID, rc) == CREATURE_ID_ETHERIAN_PLUS | cdata(CDATA_ID, rc) == CREATURE_ID_ANABOLIC_RESISTANCE | cdata(CDATA_ID, rc) == CREATURE_ID_MESHERA_UNFINISHED ) {
 		cdata(CDATA_HEIGHT, rc) = rnd(100) + 200
 		cdata(CDATA_WEIGHT, rc) = rnd(100) + 150
 	}
-	if ( cdata(CDATA_ID, rc) == CREATURE_ID_MILOS_OF_THE_FORGOTTEN_WORLD | cdata(CDATA_ID, rc) == CREATURE_ID_JAGUAR_WARRIOR | cdata(CDATA_ID, rc) == CREATURE_ID_THE_LEOPARD_WARRIOR | cdata(CDATA_ID, rc) == CREATURE_ID_MARKA_THE_SILVER_BEAR | cdata(CDATA_ID, rc) == CREATURE_ID_COMMAND_WOLF | cdata(CDATA_ID, rc) == CREATURE_ID_GIGANTIC_FAIRY | cdata(CDATA_ID, rc) == CREATURE_ID_ZANAN_ENHANCED_SOLDIER | cdata(CDATA_ID, rc) == CREATURE_ID_CUB | cdata(CDATA_ID, rc) == CREATURE_ID_ALFRED_THE_CANGNAN_WIND | (cdata(CDATA_ID, rc) >= CREATURE_ID_BATTLE_ALIEN & cdata(CDATA_ID, rc) <= CREATURE_ID_SHINE_OGRE) | cdata(CDATA_ID, rc) == CREATURE_ID_IDURU_THE_SEMINAR_LECTURER | cdata(CDATA_ID, rc) == CREATURE_ID_BATTLE_HOPPER | cdata(CDATA_ID, rc) == CREATURE_ID_BLACK_HOPPER_X | cdata(CDATA_ID, rc) == CREATURE_ID_DOROTHIA_STANDING_IN_THE_WETLAND | cdata(CDATA_ID, rc) == CREATURE_ID_DUKE_KOBOLD | cdata(CDATA_ID, rc) == CREATURE_ID_LIGHTNING_KOBOLD | cdata(CDATA_ID, rc) == CREATURE_ID_OLD_BELL ) {
+	if ( cdata(CDATA_ID, rc) == CREATURE_ID_MILOS_OF_THE_FORGOTTEN_WORLD | cdata(CDATA_ID, rc) == CREATURE_ID_JAGUAR_WARRIOR | cdata(CDATA_ID, rc) == CREATURE_ID_THE_LEOPARD_WARRIOR | cdata(CDATA_ID, rc) == CREATURE_ID_MARKA_THE_SILVER_BEAR | cdata(CDATA_ID, rc) == CREATURE_ID_COMMAND_WOLF | cdata(CDATA_ID, rc) == CREATURE_ID_GIGANTIC_FAIRY | cdata(CDATA_ID, rc) == CREATURE_ID_ZANAN_ENHANCED_SOLDIER | cdata(CDATA_ID, rc) == CREATURE_ID_CUB | cdata(CDATA_ID, rc) == CREATURE_ID_ALFRED_THE_CANGNAN_WIND | (cdata(CDATA_ID, rc) >= CREATURE_ID_BATTLE_ALIEN & cdata(CDATA_ID, rc) <= CREATURE_ID_SHINE_OGRE) | cdata(CDATA_ID, rc) == CREATURE_ID_IDURU_THE_SEMINAR_LECTURER | cdata(CDATA_ID, rc) == CREATURE_ID_BATTLE_HOPPER | cdata(CDATA_ID, rc) == CREATURE_ID_BLACK_HOPPER_X | cdata(CDATA_ID, rc) == CREATURE_ID_DOROTHIA_STANDING_IN_THE_WETLAND | cdata(CDATA_ID, rc) == CREATURE_ID_DUKE_KOBOLD | cdata(CDATA_ID, rc) == CREATURE_ID_LIGHTNING_KOBOLD | cdata(CDATA_ID, rc) == CREATURE_ID_OLD_BELL | cdata(CDATA_ID, rc) == CREATURE_ID_MONSTER_BACTERIA | cdata(CDATA_ID, rc) == CREATURE_ID_BOUNCTERIA ) {
 		cdata(CDATA_HEIGHT, rc) = rnd(20) + 180
 		cdata(CDATA_WEIGHT, rc) = rnd(20) + 70
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_URUK_HIGHNESS | cdata(CDATA_ID, rc) == CREATURE_ID_URUK_HAI | cdata(CDATA_ID, rc) == CREATURE_ID_URUK | cdata(CDATA_ID, rc) == CREATURE_ID_FANG_FUNGUS | cdata(CDATA_ID, rc) == CREATURE_ID_HAND_OF_THE_CATGOD | cdata(CDATA_ID, rc) == CREATURE_ID_HELLABYRINTH_RULER | cdata(CDATA_ID, rc) == CREATURE_ID_MOSTMUSCYLLA | cdata(CDATA_ID, rc) == CREATURE_ID_ETHERIAN ) {
 		cdata(CDATA_HEIGHT, rc) = rnd(50) + 200
@@ -2441,14 +2441,14 @@
 		cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - 12 - rnd(5)
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_GWEN_THE_PITILESS | cdata(CDATA_ID, rc) == CREATURE_ID_EILA_THE_FUGITIVE_KUNOICHI | cdata(CDATA_ID, rc) == CREATURE_ID_NEW_CITIZEN | cdata(CDATA_ID, rc) == CREATURE_ID_FASHIONABLE_KUNOICHI | cdata(CDATA_ID, rc) == CREATURE_ID_ALCHEMIST_NAPLUS | cdata(CDATA_ID, rc) == CREATURE_ID_RECONCILED_CLEANER | cdata(CDATA_ID, rc) == CREATURE_ID_MICHES_THE_APPRENTICE | cdata(CDATA_ID, rc) == CREATURE_ID_NOEL_THE_BOMBER | cdata(CDATA_ID, rc) == CREATURE_ID_RENAI_THE_OVER_MESHERA | cdata(CDATA_ID, rc) == CREATURE_ID_RIANNA_THE_DAYDREAMER | cdata(CDATA_ID, rc) == CREATURE_ID_ALSAPIA_THE_MURDERER_MASK | cdata(CDATA_ID, rc) == CREATURE_ID_MARY_THE_FLOWER_PICKER ) {
 		cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - 15 - rnd(5)
 	}
-	if ( cdata(CDATA_ID, rc) == CREATURE_ID_SICKFULL_OLDER_BROTHER | cdata(CDATA_ID, rc) == CREATURE_ID_TELHUREZA_THE_HOUSE_GUARD | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_MEM | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_FWBS | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_FSSSY | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_CHRDH | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_VARGM | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_DIBWL | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_ZEHLS ) {
+	if ( cdata(CDATA_ID, rc) == CREATURE_ID_SICKFULL_OLDER_BROTHER | cdata(CDATA_ID, rc) == CREATURE_ID_TELHUREZA_THE_HOUSE_GUARD | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_MEM | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_FWBS | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_FSSSY | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_CHRDH | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_VARGM | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_DIBWL | cdata(CDATA_ID, rc) == CREATURE_ID_CHAOSHAPRINCESS_ZEHLS | cdata(CDATA_ID, rc) == CREATURE_ID_ANABOLIC_RESISTANCE ) {
 		cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - 18 - rnd(5)
 	}
-	if ( cdata(CDATA_ID, rc) == CREATURE_ID_INQTUAL_THE_REVENGE | cdata(CDATA_ID, rc) == CREATURE_ID_REGULUS_THE_ALTERED | cdata(CDATA_ID, rc) == CREATURE_ID_FRON_THE_TOUR_PLANNER | cdata(CDATA_ID, rc) == CREATURE_ID_MARKA_THE_SILVER_BEAR | cdata(CDATA_ID, rc) == CREATURE_ID_SPIPHA_THE_DRAGON_HUNTER | cdata(CDATA_ID, rc) == CREATURE_ID_AILE_THE_ATTENDANT | cdata(CDATA_ID, rc) == CREATURE_ID_NAZUNA_THE_INSTRUCTOR | cdata(CDATA_ID, rc) == CREATURE_ID_GETUEI_THE_NINJA_MASTER | cdata(CDATA_ID, rc) == CREATURE_ID_SECURITY_OFFICER_ORVILLE | cdata(CDATA_ID, rc) == CREATURE_ID_MILIS_CAPTAIN_OF_THE_SPECIAL_FORCES | cdata(CDATA_ID, rc) == CREATURE_ID_SHENA_THE_DRAW | cdata(CDATA_ID, rc) == CREATURE_ID_SILVIA_THE_PRINCESS | cdata(CDATA_ID, rc) == CREATURE_ID_TAM_THE_CAT_HATER | cdata(CDATA_ID, rc) == CREATURE_ID_MIA_THE_CAT_FREAK | cdata(CDATA_ID, rc) == CREATURE_ID_FRAY_THE_FIGHTER_GUILDMASTER | cdata(CDATA_ID, rc) == CREATURE_ID_STRANGE_SCIENTIST | cdata(CDATA_ID, rc) == CREATURE_ID_SKOGSRA | cdata(CDATA_ID, rc) == CREATURE_ID_PART_TIME_WORKER_THE_RED_SWORD | cdata(CDATA_ID, rc) == CREATURE_ID_BUTLER | cdata(CDATA_ID, rc) == CREATURE_ID_NANCY_THE_WANDERLUST | cdata(CDATA_ID, rc) == CREATURE_ID_JENNA_THE_MYTHICAL_MANIAC | cdata(CDATA_ID, rc) == CREATURE_ID_PROVIDENCE_GAZE | cdata(CDATA_ID, rc) == CREATURE_ID_OXODE_THE_QUEEN_BEE | cdata(CDATA_ID, rc) == CREATURE_ID_MOSTMUSCYLLA ) {
+	if ( cdata(CDATA_ID, rc) == CREATURE_ID_INQTUAL_THE_REVENGE | cdata(CDATA_ID, rc) == CREATURE_ID_REGULUS_THE_ALTERED | cdata(CDATA_ID, rc) == CREATURE_ID_FRON_THE_TOUR_PLANNER | cdata(CDATA_ID, rc) == CREATURE_ID_MARKA_THE_SILVER_BEAR | cdata(CDATA_ID, rc) == CREATURE_ID_SPIPHA_THE_DRAGON_HUNTER | cdata(CDATA_ID, rc) == CREATURE_ID_AILE_THE_ATTENDANT | cdata(CDATA_ID, rc) == CREATURE_ID_NAZUNA_THE_INSTRUCTOR | cdata(CDATA_ID, rc) == CREATURE_ID_GETUEI_THE_NINJA_MASTER | cdata(CDATA_ID, rc) == CREATURE_ID_SECURITY_OFFICER_ORVILLE | cdata(CDATA_ID, rc) == CREATURE_ID_MILIS_CAPTAIN_OF_THE_SPECIAL_FORCES | cdata(CDATA_ID, rc) == CREATURE_ID_SHENA_THE_DRAW | cdata(CDATA_ID, rc) == CREATURE_ID_SILVIA_THE_PRINCESS | cdata(CDATA_ID, rc) == CREATURE_ID_TAM_THE_CAT_HATER | cdata(CDATA_ID, rc) == CREATURE_ID_MIA_THE_CAT_FREAK | cdata(CDATA_ID, rc) == CREATURE_ID_FRAY_THE_FIGHTER_GUILDMASTER | cdata(CDATA_ID, rc) == CREATURE_ID_STRANGE_SCIENTIST | cdata(CDATA_ID, rc) == CREATURE_ID_SKOGSRA | cdata(CDATA_ID, rc) == CREATURE_ID_PART_TIME_WORKER_THE_RED_SWORD | cdata(CDATA_ID, rc) == CREATURE_ID_BUTLER | cdata(CDATA_ID, rc) == CREATURE_ID_NANCY_THE_WANDERLUST | cdata(CDATA_ID, rc) == CREATURE_ID_JENNA_THE_MYTHICAL_MANIAC | cdata(CDATA_ID, rc) == CREATURE_ID_PROVIDENCE_GAZE | cdata(CDATA_ID, rc) == CREATURE_ID_OXODE_THE_QUEEN_BEE | cdata(CDATA_ID, rc) == CREATURE_ID_MOSTMUSCYLLA | cdata(CDATA_ID, rc) == CREATURE_ID_MESHERA_UNFINISHED ) {
 		cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - 20 - rnd(8)
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_AIKAGE_THE_SHINOBI_MASK | cdata(CDATA_ID, rc) == CREATURE_ID_BLACK_GAUNTLET_LEOLD | cdata(CDATA_ID, rc) == CREATURE_ID_LEAD_DEVELOPER_DR_GAVELA | cdata(CDATA_ID, rc) == CREATURE_ID_ARMA_THE_TOUR_GUIDE | cdata(CDATA_ID, rc) == CREATURE_ID_MURDER_KNIGHT | cdata(CDATA_ID, rc) == CREATURE_ID_MEFAN_THE_BARD | cdata(CDATA_ID, rc) == CREATURE_ID_RENTON_THE_SUFFERING_WIZARD | cdata(CDATA_ID, rc) == CREATURE_ID_MARKS_THE_GREAT_THIEF | cdata(CDATA_ID, rc) == CREATURE_ID_SIN_THE_THIEF_GUILDMASTER | cdata(CDATA_ID, rc) == CREATURE_ID_BETHEL_THE_WHITE_HAWK | cdata(CDATA_ID, rc) == CREATURE_ID_WHOM_DWELL_IN_THE_VANITY | cdata(CDATA_ID, rc) == CREATURE_ID_LOYTER_THE_CRIMSON_OF_ZANAN | cdata(CDATA_ID, rc) == CREATURE_ID_MAILE_THE_MARIONETTE_SHAMAN | cdata(CDATA_ID, rc) == CREATURE_ID_CRAY_THE_CURIOUS_ADVENTURER | cdata(CDATA_ID, rc) == CREATURE_ID_EIGHTY_SHAKU | cdata(CDATA_ID, rc) == CREATURE_ID_ETHERIAN | cdata(CDATA_ID, rc) == CREATURE_ID_ETHERIAN_PLUS ) {
 		cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - 28 - rnd(5)
 	}
@@ -2846,11 +2846,18 @@
 	cdata(CDATA_SP, rc) = cdata(CDATA_MAX_SP, rc) / 3
 	cdata(CDATA_SANITY, rc) = 0
 	cdata(CDATA_EXIST, rc) = CHAR_STATE_ALIVE
 	cdata(CDATA_AREA, rc) = 0
 	cdata(CDATA_RELATION, rc) = cdata(CDATA_RELATION_ORG, rc)
-	cdata(CDATA_HUNGER, rc) = 8000
+	if ( rc != CHARA_PLAYER ) {
+		cdata(CDATA_HUNGER, rc) = 8000
+	}
+	if ( rc == CHARA_PLAYER ) {
+		if ( cdata(CDATA_HUNGER, CHARA_PLAYER) < 8000 ) {
+			cdata(CDATA_HUNGER, CHARA_PLAYER) = 8000
+		}
+	}
 	cdata(CDATA_THIRST, rc) = 8000
 
 *renewStatus
 	cbitmod CHARA_BIT_CONTINGENCY, rc, FALSE
 	rowactend rc
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/chara_func.hsp ../2.20-borscht/chara_func.hsp
--- ../2.19R-borscht/chara_func.hsp	2023-08-08 08:52:03.842274400 +0800
+++ ../2.20-borscht/chara_func.hsp	2023-10-08 12:52:58.891233200 +0800
@@ -2719,11 +2719,11 @@
 		if ( cdata(CDATA_QUALITY, dmgcon_charid) > FIX_QUALITY_GREAT | cdata(CDATA_ID, dmgcon_charid) == CREATURE_ID_AILE_THE_ATTENDANT ) {
 			if ( rnd(cdata(CDATA_LEVEL, dmgcon_charid) / 2 + 1) ) {
 				locvar_dmgcon_f = 0
 			}
 		}
-		locvar_dmgcon_res = 54
+		locvar_dmgcon_res = 59
 		gosub *conCalc
 		if ( locvar_dmgcon_f == 0 ) {
 			return 0
 		}
 		locvar_dmgcon_p = locvar_dmgcon_p / 7
@@ -2750,11 +2750,11 @@
 		if ( cdata(CDATA_QUALITY, dmgcon_charid) > FIX_QUALITY_GREAT | cdata(CDATA_ID, dmgcon_charid) == CREATURE_ID_AILE_THE_ATTENDANT ) {
 			if ( rnd(cdata(CDATA_LEVEL, dmgcon_charid) + 1) ) {
 				locvar_dmgcon_f = 0
 			}
 		}
-		locvar_dmgcon_res = 58
+		locvar_dmgcon_res = 52
 		gosub *conCalc
 		if ( locvar_dmgcon_f == 0 ) {
 			return 0
 		}
 		locvar_dmgcon_p = locvar_dmgcon_p / 10
@@ -2933,20 +2933,26 @@
 		locvar_dmgcon_res = 57
 		gosub *conCalc
 		if ( locvar_dmgcon_f == 0 ) {
 			return 0
 		}
-		locvar_dmgcon_p = locvar_dmgcon_p / 8
+		locvar_dmgcon_p = locvar_dmgcon_p / 16
+		locvar_dmgcon_p = rnd(locvar_dmgcon_p + 1)
 		if ( locvar_dmgcon_p > 0 ) {
 			if ( cdata(CDATA_CONDITION_DIM, dmgcon_charid) == 0 ) {
-				cdata(CDATA_CONDITION_DIM, dmgcon_charid) = locvar_dmgcon_p
+				cdata(CDATA_CONDITION_DIM, dmgcon_charid) = limit(locvar_dmgcon_p, 1, 63)
 				if ( synccheck(dmgcon_charid, -1) ) {
 					txtmore
 					txtef COLOR_PURPLE
 					txt lang(name(dmgcon_charid) + "は朦朧とした。", name(dmgcon_charid) + " " + is(dmgcon_charid) + " dimmed.")
 				}
 			}
+			else {
+				if ( locvar_dmgcon_p > cdata(CDATA_CONDITION_DIM, dmgcon_charid) ) {
+					cdata(CDATA_CONDITION_DIM, dmgcon_charid) = limit(locvar_dmgcon_p, 1, 63)
+				}
+			}
 			rowactend dmgcon_charid
 		}
 		return 1
 	}
 	if ( dmgcon_cond == CONDITION_BLEED ) {
@@ -3058,25 +3064,25 @@
 			locvar_dmgcon_f = 0
 		}
 	}
 	return
 
-*label_3720
-	goto *label_3725
+*label_3734
+	goto *label_3739
 
 #deffunc healhp int healhp_charid, int healhp_amount
 	locvar_healhp_hpbk = cdata(CDATA_HP, healhp_charid)
 	cdata(CDATA_HP, healhp_charid) += healhp_amount
 	if ( cdata(CDATA_HP, healhp_charid) > cdata(CDATA_MAX_HP, healhp_charid) ) {
 		cdata(CDATA_HP, healhp_charid) = cdata(CDATA_MAX_HP, healhp_charid)
 	}
 	locvar_healhp_kaihuku = cdata(CDATA_HP, healhp_charid) - locvar_healhp_hpbk
-	if ( cdata(CDATA_DRAIN_HP, healhp_charid) < 100 ) {
+	if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), healhp_charid) < 100 ) {
 		if ( rankheal >= 0 ) {
-			cdata(CDATA_DRAIN_HP, healhp_charid) += locvar_healhp_kaihuku * 40 / cdata(CDATA_MAX_HP, healhp_charid)
-			if ( cdata(CDATA_DRAIN_HP, healhp_charid) >= 100 ) {
-				cdata(CDATA_DRAIN_HP, healhp_charid) = 99
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), healhp_charid) += locvar_healhp_kaihuku * 40 / cdata(CDATA_MAX_HP, healhp_charid)
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), healhp_charid) >= 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), healhp_charid) = 99
 			}
 		}
 	}
 	rankheal = 0
 	return
@@ -3694,11 +3700,11 @@
 	if ( check_talk_arg1 == 0 ) {
 		if ( cdata(CDATA_LEVEL, check_talk_arg2) < cdata(CDATA_LEVEL, check_talk_arg1) ) {
 			locvar_check_talk_exp = locvar_check_talk_exp / 100 + 5
 		}
 	}
-	if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, check_talk_arg2) | cbit(CHARA_BIT_SPLIT_NO_EFFECT, check_talk_arg2) ) {
+	if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, check_talk_arg2) | cbit(CHARA_BIT_SPLIT_NO_EFFECT, check_talk_arg2) | cbit(CHARA_BIT_SUMMONED, check_talk_arg2) ) {
 		locvar_check_talk_exp = 0
 	}
 	if ( cdata(CDATA_RELATION, check_talk_arg1) == RELATION_ALLY | check_talk_arg1 == 0 ) {
 		if ( gdata(GDATA_SLEEP_EXP) > 1000000000 ) {
 			gdata(GDATA_SLEEP_EXP) = 1000000000
@@ -4893,18 +4899,18 @@
 		if ( locvar_dmghp_ele == 64 ) {
 			locvar_dmghp_hoseidv = cdata(CDATA_DV, dmghp_charid) * cdata(CDATA_DV_FIX, dmghp_charid) / 100 + cdata(CDATA_DV_FIX, dmghp_charid) - 100
 			locvar_dmghp_hoseipv = (cdata(CDATA_PV, dmghp_charid) + cdata(CDATA_PV_FIX, dmghp_charid) / 25) * cdata(CDATA_PV_FIX, dmghp_charid) / 100
 			locvar_dmghp_r = locvar_dmghp_hoseidv * 2 + locvar_dmghp_hoseipv
 			if ( locvar_dmghp_r > 0 ) {
-				if ( cdata(CDATA_DRAIN_HP, dmghp_charid) >= 100 ) {
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), dmghp_charid) >= 100 ) {
 					locvar_dmghp_r = 0
 				}
 			}
 			if ( locvar_dmghp_r > 0 ) {
 				locvar_dmghp_r = locvar_dmghp_r * 2 / 3
 			}
-			locvar_dmghp_dmg = locvar_dmghp_dmg * 100 / limit(locvar_dmghp_r + 110, 50, 3000)
+			locvar_dmghp_dmg = locvar_dmghp_dmg * 100 / limit(locvar_dmghp_r + 110, 50, 30000)
 		}
 		if ( locvar_dmghp_ele == 68 | dmghp_source == DAMAGE_FROM_SUFFOCATION | dmghp_source == DAMAGE_FROM_POISON ) {
 			locvar_dmghp_r = sdata(SKILL_ATTR_CON, dmghp_charid) + limit(cdata(CDATA_MASTER_SERVANT, dmghp_charid), 50, 1000) + limit(cdata(CDATA_IMPRESSION, dmghp_charid), 50, 1000)
 			locvar_dmghp_dmg = locvar_dmghp_dmg * 100 / (locvar_dmghp_r + 50)
 		}
@@ -4922,11 +4928,13 @@
 				if ( findbuff(dmghp_charid, BUFF_MAGIC_EQUIP) != (-1) ) {
 					locvar_dmghp_dmg = locvar_dmghp_dmg * 4 / 5
 				}
 			}
 		}
-		locvar_dmghp_dmg = locvar_dmghp_dmg * 100 / (sdata(SKILL_RES_MAGIC, dmghp_charid) / 2 + 50)
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), dmghp_charid) < 100 ) {
+			locvar_dmghp_dmg = locvar_dmghp_dmg * 100 / (sdata(SKILL_RES_MAGIC, dmghp_charid) / 4 + 50)
+		}
 	}
 	if ( dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 		if ( gdata(GDATA_TEMPORARY_FLAGS2) < 1000 ) {
 			if ( critical ) {
 				snd SOUNDLIST_ATK2
@@ -5351,10 +5359,15 @@
 		if ( cdata(CDATA_ID, dmghp_charid) == CREATURE_ID_GARZIEM ) {
 			if ( locvar_dmghp_ele != 702 ) {
 				locvar_dmghp_dmg = locvar_dmghp_dmg * 2 / 3
 			}
 		}
+		if ( cbit(CHARA_BIT_LOCKED_UP, dmghp_charid) ) {
+			if ( locvar_dmghp_ele != 702 ) {
+				locvar_dmghp_dmg = locvar_dmghp_dmg / 2
+			}
+		}
 	}
 	if ( gdata(GDATA_TEMPORARY_FLAGS2) == 100 ) {
 		locvar_dmghp_dmg = locvar_dmghp_dmg * 3 / 5
 	}
 	if ( gdata(GDATA_TEMPORARY_FLAGS2) == 1200 ) {
@@ -5940,17 +5953,17 @@
 		}
 	}
 	sutemi = 0
 	if ( dmghp_source >= (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 		if ( cdata(CDATA_GAUGE_COOLDOWN2, dmghp_charid) == 0 ) {
-			if ( cdata(CDATA_DRAIN_HP, dmghp_charid) < 100 ) {
-				cdata(CDATA_DRAIN_HP, dmghp_charid) += 2
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), dmghp_charid) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), dmghp_charid) += 2
 				if ( locvar_dmghp_ele == 64 ) {
-					cdata(CDATA_DRAIN_HP, dmghp_charid) += 8
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), dmghp_charid) += 8
 				}
-				if ( cdata(CDATA_DRAIN_HP, dmghp_charid) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, dmghp_charid) = 120
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), dmghp_charid) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), dmghp_charid) = 120
 					locvar_dmghp_waitbk = locvar_dmghp_cfg_animewait
 					if ( locvar_dmghp_cfg_animewait < 50 ) {
 						locvar_dmghp_cfg_animewait = 50
 					}
 					animeload 87, dmghp_charid
@@ -6297,36 +6310,19 @@
 				}
 			}
 		}
 		if ( locvar_dmghp_ele ) {
 			if ( locvar_dmghp_ele == 59 ) {
-				dmgcon dmghp_charid, CONDITION_WINCE, rnd(dmghp_element_power / 7 + 1)
-				dmgcon dmghp_charid, CONDITION_CHILLS, rnd(dmghp_element_power / 7 + 1)
-				dmgcon dmghp_charid, CONDITION_BLIND, rnd(dmghp_element_power / 7 + 1)
-				dmgcon dmghp_charid, CONDITION_PARALYZE, rnd(dmghp_element_power / 7 + 1)
-				dmgcon dmghp_charid, CONDITION_CONFUSE, rnd(dmghp_element_power / 7 + 1)
-				dmgcon dmghp_charid, CONDITION_DIM, rnd(dmghp_element_power / 7 + 1)
-				dmgcon dmghp_charid, CONDITION_POISON, rnd(dmghp_element_power / 7 + 1)
-			}
-			if ( locvar_dmghp_ele == 52 ) {
-				if ( rnd(10 + (cdata(CDATA_QUALITY, dmghp_charid) >= FIX_QUALITY_MIRACLE) * 10) == 0 ) {
-					if ( cdata(CDATA_CONDITION_PARALYZE, dmghp_charid) == 0 ) {
-						cdata(CDATA_CONDITION_PARALYZE, dmghp_charid)++
-					}
-				}
-				if ( cdata(CDATA_FRIENDSHIP, CHARA_PLAYER) == 1 ) {
-					if ( dmghp_charid == CHARA_PLAYER ) {
-						if ( cdata(CDATA_SP, dmghp_charid) >= (-100) ) {
-							cdata(CDATA_SP, dmghp_charid) -= 5
-						}
-					}
-					if ( dmghp_charid != CHARA_PLAYER ) {
-						if ( cdata(CDATA_SP, dmghp_charid) >= (-50) ) {
-							cdata(CDATA_SP, dmghp_charid) -= 5
-						}
-					}
-				}
+				dmgcon dmghp_charid, CONDITION_WINCE, rnd(dmghp_element_power / 9 + 1)
+				dmgcon dmghp_charid, CONDITION_CHILLS, rnd(dmghp_element_power / 9 + 1)
+				dmgcon dmghp_charid, CONDITION_BLIND, rnd(dmghp_element_power / 9 + 1)
+				dmgcon dmghp_charid, CONDITION_PARALYZE, rnd(dmghp_element_power / 9 + 1)
+				dmgcon dmghp_charid, CONDITION_FEAR, rnd(dmghp_element_power / 9 + 1)
+				dmgcon dmghp_charid, CONDITION_DIM, rnd(dmghp_element_power / 9 + 1)
+				dmgcon dmghp_charid, CONDITION_POISON, rnd(dmghp_element_power / 9 + 1)
+				dmgcon dmghp_charid, CONDITION_CONFUSE, rnd(dmghp_element_power / 9 + 1)
+				dmgcon dmghp_charid, CONDITION_SLEEP, rnd(dmghp_element_power / 9 + 1)
 			}
 			if ( locvar_dmghp_ele == 50 | dmghp_source == DAMAGE_FROM_FIRE ) {
 				inv_find ITEM_ID_MAGATAMA, dmghp_source
 				if ( stat == (-1) ) {
 					item_fire dmghp_charid, -1
@@ -6346,15 +6342,18 @@
 				dmgcon dmghp_charid, CONDITION_CHILLS, rnd(dmghp_element_power + 1)
 			}
 			if ( locvar_dmghp_ele == 53 ) {
 				dmgcon dmghp_charid, CONDITION_BLIND, rnd(dmghp_element_power + 1)
 			}
-			if ( locvar_dmghp_ele == 58 ) {
+			if ( locvar_dmghp_ele == 52 ) {
 				dmgcon dmghp_charid, CONDITION_PARALYZE, rnd(dmghp_element_power + 1)
 			}
+			if ( locvar_dmghp_ele == 58 ) {
+				dmgcon dmghp_charid, CONDITION_SLEEP, rnd(dmghp_element_power + 1)
+			}
 			if ( locvar_dmghp_ele == 54 ) {
-				dmgcon dmghp_charid, CONDITION_CONFUSE, rnd(dmghp_element_power + 1)
+				dmgcon dmghp_charid, CONDITION_FEAR, rnd(dmghp_element_power + 1)
 			}
 			if ( locvar_dmghp_ele == 57 ) {
 				dmgcon dmghp_charid, CONDITION_DIM, rnd(dmghp_element_power + 1)
 			}
 			if ( locvar_dmghp_ele == 55 ) {
@@ -6373,14 +6372,16 @@
 					item_acid dmghp_charid, -1
 				}
 			}
 		}
 		if ( cdata(CDATA_CONDITION_SLEEP, dmghp_charid) > 0 ) {
-			if ( locvar_dmghp_ele != 54 & locvar_dmghp_ele != 58 & locvar_dmghp_ele != 59 ) {
-				cdata(CDATA_CONDITION_SLEEP, dmghp_charid) = 0
-				txtmore
-				txt lang(name(dmghp_charid) + "は眠りを妨げられた。", name(dmghp_charid) + your(dmghp_charid) + " sleep " + is(dmghp_charid) + " disturbed.")
+			if ( locvar_dmghp_ele != 68 & locvar_dmghp_ele != 58 & locvar_dmghp_ele != 59 ) {
+				if ( rnd(limit(sdata(SKILL_RES_NERVE, dmghp_charid), 5, 1000)) >= rnd(limit(cdata(CDATA_CONDITION_SLEEP, dmghp_charid), 5, 1000) + 1000) ) {
+					cdata(CDATA_CONDITION_SLEEP, dmghp_charid) = 0
+					txtmore
+					txt lang(name(dmghp_charid) + "は眠りを妨げられた。", name(dmghp_charid) + your(dmghp_charid) + " sleep " + is(dmghp_charid) + " disturbed.")
+				}
 			}
 		}
 		if ( dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 			locvar_dmghp_pcnoise = 100
 			hostileaction CHARA_PLAYER, dmghp_charid
@@ -6762,14 +6763,14 @@
 				if ( dmghp_charid == CHARA_PLAYER ) {
 					ndeathcause = lang("ギロチンで首を落とされて死んだ。", "was guillotined")
 				}
 			}
 			if ( dmghp_source == DAMAGE_FROM_EXECUTION ) {
-				txt lang(name(dmghp_charid) + "は公正な投票の結果処刑された。", name(dmghp_charid) + " was executed by result of fair vote.")
+				txt lang(cdatan(CDATAN_NAME, dmghp_charid) + "は公正な投票の結果処刑された。", name(dmghp_charid) + " was executed by result of fair vote.")
 			}
 			if ( dmghp_source == DAMAGE_FROM_SCALP ) {
-				txt lang(name(dmghp_charid) + "は衰弱して死んだ。", name(dmghp_charid) + " weakened and died..")
+				txt lang(cdatan(CDATAN_NAME, dmghp_charid) + "は衰弱して死んだ。", name(dmghp_charid) + " weakened and died..")
 			}
 			if ( dmghp_source == DAMAGE_FROM_HANGING ) {
 				txt lang(name(dmghp_charid) + "は首を吊った。", name(dmghp_charid) + " hang" + _s(dmghp_charid) + " " + his(dmghp_charid) + "self.")
 				if ( dmghp_charid == CHARA_PLAYER ) {
 					ndeathcause = lang("首を吊った。", "commited suicide by hanging")
@@ -6916,11 +6917,11 @@
 			if ( dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 				if ( cdata(CDATA_LEVEL, dmghp_charid) < cdata(CDATA_LEVEL, dmghp_source) ) {
 					locvar_dmghp_exp = locvar_dmghp_exp / 100 + 5
 				}
 			}
-			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, dmghp_charid) | cbit(CHARA_BIT_SPLIT_NO_EFFECT, dmghp_charid) ) {
+			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, dmghp_charid) | cbit(CHARA_BIT_SPLIT_NO_EFFECT, dmghp_charid) | cbit(CHARA_BIT_SUMMONED, dmghp_charid) ) {
 				locvar_dmghp_exp = 0
 			}
 			if ( cdata(CDATA_RELATION, dmghp_source) == RELATION_ALLY | dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 				if ( gdata(GDATA_SLEEP_EXP) > 1000000000 ) {
 					gdata(GDATA_SLEEP_EXP) = 1000000000
@@ -8000,11 +8001,11 @@
 	}
 	cdata(CDATA_THIRST, chara_morasi_arg1) = 5000
 	return
 
 #deffunc gain_iden int gain_iden_charaid1, int gain_iden_charaid2, int gain_iden_amount
-	if ( cdata(CDATA_SP_EARNED, gain_iden_charaid2) <= (-1000000) & cdata(CDATA_SP_EARNED, gain_iden_charaid2) > (-2000000) ) {
+	if ( cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) <= (-1000000) & cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) > (-2000000) ) {
 		snd SOUNDLIST_OFFER2
 		locvar_gain_iden_generes = 0
 		locvar_gain_iden_bvar = sorg(SKILL_RES_MAGIC, gain_iden_charaid1)
 		locvar_gain_iden_generes = 60
 		if ( sorg(SKILL_RES_FIRE, gain_iden_charaid1) > locvar_gain_iden_bvar ) {
@@ -8049,38 +8050,38 @@
 		}
 		if ( sorg(SKILL_RES_MAGIC, gain_iden_charaid1) >= locvar_gain_iden_bvar ) {
 			locvar_gain_iden_bvar = sorg(SKILL_RES_MAGIC, gain_iden_charaid1)
 			locvar_gain_iden_generes = 60
 		}
-		cdata(CDATA_SP_EARNED, gain_iden_charaid2) -= limit(locvar_gain_iden_bvar / 100 + gain_iden_amount, 5, 20) * 10000
-		if ( cdata(CDATA_SP_EARNED, gain_iden_charaid2) \ EXT_EQUIP_SLOTS == 0 ) {
-			cdata(CDATA_SP_EARNED, gain_iden_charaid2) -= locvar_gain_iden_generes * 100
+		cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) -= limit(locvar_gain_iden_bvar / 100 + gain_iden_amount, 5, 20) * 10000
+		if ( cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) \ EXT_EQUIP_SLOTS == 0 ) {
+			cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) -= locvar_gain_iden_generes * 100
 		}
 		else {
-			if ( cdata(CDATA_SP_EARNED, gain_iden_charaid2) \ 100 == 0 ) {
-				cdata(CDATA_SP_EARNED, gain_iden_charaid2) -= locvar_gain_iden_generes
+			if ( cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) \ 100 == 0 ) {
+				cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) -= locvar_gain_iden_generes
 			}
 		}
 		if ( gain_iden_charaid1 != CHARA_PLAYER ) {
 			cdata(CDATA_INFANT, gain_iden_charaid2) = cdata(CDATA_ID, gain_iden_charaid1)
 		}
 		txtef COLOR_YELLOW
 		txt lang(name(gain_iden_charaid2) + "の生命核は" + name(gain_iden_charaid1) + "の遺伝子を獲得した。", name(gain_iden_charaid2) + " get genes of " + _s(gain_iden_charaid1) + ".")
-		locvar_gain_iden_sintyoku = (cdata(CDATA_SP_EARNED, gain_iden_charaid2) + 1000000) * (-1) / 10000
+		locvar_gain_iden_sintyoku = (cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) + 1000000) * (-1) / 10000
 		locvar_gain_iden_sintyoku += 50
-		if ( cdata(CDATA_SP_EARNED, gain_iden_charaid2) > (-1500000) ) {
+		if ( cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) > (-1500000) ) {
 			txtef COLOR_YELLOW
 			txt lang("[フェイズ1進捗率：" + locvar_gain_iden_sintyoku + "％]", "[Phase 1 progress " + locvar_gain_iden_sintyoku + " %]")
 		}
-		if ( cdata(CDATA_SP_EARNED, gain_iden_charaid2) <= (-1500000) ) {
-			cdata(CDATA_SP_EARNED, gain_iden_charaid2) -= 500000
+		if ( cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) <= (-1500000) ) {
+			cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) -= 500000
 			snd SOUNDLIST_DING1
 			txtef COLOR_GREEN
 			txt lang("[SURVIVABILITY EXTENSION！]　フェイズ1が完了した。これからは、食事の栄養で成長させる必要がある。", "[SURVIVABILITY EXTENSION !] Phase 1 completed. From now on, it need to grow with the nutrition of foods.")
 		}
 		if ( 0 ) {
-			txt lang("耐性" + locvar_gain_iden_generes + "でステージ" + cdata(CDATA_SP_EARNED, gain_iden_charaid2) + "。", name(gain_iden_charaid2) + " get genes of " + _s(gain_iden_charaid1) + ".")
+			txt lang("耐性" + locvar_gain_iden_generes + "でステージ" + cdata(CDATA_PREGNANCY_PROGRESS, gain_iden_charaid2) + "。", name(gain_iden_charaid2) + " get genes of " + _s(gain_iden_charaid1) + ".")
 		}
 		locvar_gain_iden_generes = 0
 		locvar_gain_iden_bvar = 0
 		locvar_gain_iden_sintyoku = 0
 	}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/chat.hsp ../2.20-borscht/chat.hsp
--- ../2.19R-borscht/chat.hsp	2023-08-08 08:52:04.394808900 +0800
+++ ../2.20-borscht/chat.hsp	2023-10-08 12:52:59.359981500 +0800
@@ -11464,10 +11464,167 @@
 			goto *chat_unique_SWEND1
 		}
 		goto *chat_unique_SWEND1
 		_switch_sw++
 	}
+	if ( _switch_val == 1085 | _switch_sw ) {
+		_switch_sw = 0
+		if ( cdata(CDATA_GOLD, CHARA_PLAYER) <= 10 ) {
+			listmax = 0
+			buff = lang("チッ、一文無しの乞食" + _ka() + "とっとといっちまい" + _na(), "Bah, a begger without a penny. What a waste of time! Just go away!")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strmore
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+			levelexitby = MAP_EXIT_NORMAL
+			chatteleport = 1
+			snd SOUNDLIST_EXITMAP1
+			goto *chat_end
+		}
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("こんな蛮行やめさせる", "Stop this kind of barbarism.")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("こちらも力ずくで拒否する", "I also refuse by force.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("迫害していないので拒否する", "I refuse because I never persecuted Elea.")
+		listmax++
+		list(0, listmax) = 4
+		listn(0, listmax) = lang("金が惜しいので拒否する", "I refuse because I don't want to part with my money.")
+		listmax++
+		list(0, listmax) = 5
+		listn(0, listmax) = lang("なんだか怪しいので拒否する", "I refuse because you are somehow suspicious.")
+		listmax++
+		list(0, listmax) = 0
+		listn(0, listmax) = lang("言われた通り寄付する", "I will donate as you said...")
+		listmax++
+		buff = lang("おい、そこのお前！お前たちのような衆愚がザナンに踊らされたせいで、エレアは濡れ衣を着せられて迫害を受けてきた！真実が明らかになった今も、故郷を奪われたエレアたちは貧困にあえいでいる！少しは申し訳ないと思わないのか？さぁ、ザナンの陰謀に加担した罪を認めて、荷車の積荷と金貨" + cdata(CDATA_GOLD, CHARA_PLAYER) / 20 + "枚を我々に寄付しろ！嫌だというなら力ずくで寄付してもらうぞ！", "Hey you there! Because people like you believed in Zanan, Elea has been falsely accused and persecuted! Even now that the truth has been revealed, Elea who have been robbed of their hometown are still suffering from poverty! Don't you feel sorry for Elea? Now, plead guilty to being part of the conspiracy and donate " + cdata(CDATA_GOLD, CHARA_PLAYER) / 20 + " gold pices and your cargos to us! If you don't like it, I'll have you donate your dirty life by force!")
+		chatesc = 0
+		gosub *chat_select
+		if ( chatval == 0 ) {
+			snd SOUNDLIST_PAYGOLD1
+			cdata(CDATA_GOLD, CHARA_PLAYER) -= cdata(CDATA_GOLD, CHARA_PLAYER) / 20
+			inv_getheader 0
+			repeat invrange, invhead
+				if ( inv(INV_ITEM_NUM, cnt) > 0 ) {
+					if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_CARGO) == 1 ) {
+						txtmore
+						txt lang(itemname(cnt) + "を渡した。", "You hand over " + itemname(cnt) + ".")
+						inv(INV_ITEM_NUM, cnt) = 0
+					}
+				}
+			loop
+			gosub *calcBurdenPc
+			listmax = 0
+			buff = lang("おっと、罪を認めるのか！素晴らしい！だがお前がどんなに寄付をしても、エレアが苦痛を受けた事実は未来永劫消えない！これで許された気になるなよ、人でなしのカスめ！末代まで詫び続けろ！", "You have admitted your guilt well! But no matter how much you donate, the fact that Elea suffered will never disappear! Don't feel like you've been forgiven for this, you scumbag! Keep apologizing until the end of time!")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+			levelexitby = MAP_EXIT_NORMAL
+			chatteleport = 1
+			snd SOUNDLIST_EXITMAP1
+			goto *chat_end
+		}
+		if ( chatval == 1 ) {
+			listmax = 0
+			buff = lang("いいか、皆！我々の活動を不都合に思うということは、コイツはザナンの工作員に違いない！ザナンの工作員の言うことには一切耳を傾ける必要がない！殺ってしまえ！", "You must be an agent of Zanan because you are displeased with our activities! There is no need to listen to any of Zanan's agents! Please die!")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+			goto *chat_end
+		}
+		if ( chatval == 2 ) {
+			listmax = 0
+			buff = lang("我々は迫害され困窮しているエレアのために金品を集めているんだ！それに抵抗するのはれっきとしたエレア差別だ！お前は本当に性格が悪いな、エレアを馬鹿にするのもいい加減にしろ！お前たちが力で抵抗するのは全て暴力行為だが、我々が力で寄付を集めるのは暴力行為ではない！これはエレアに許された正義の裁きであり、世間への抗議なのだ！", "We are collecting money and goods for the persecuted and needy Elea! Resisting that is pure Elea discrimination! You really have a bad personality, stop bothering Elea! Anything you do to resist with force is an act of violence, but what we do to collect donations by force is not violence! It's a justice judgment allowed by Elea, and a protest against the world!")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+			goto *chat_end
+		}
+		if ( chatval == 3 ) {
+			listmax = 0
+			buff = lang("じゃあ迫害していないという証拠を出せ！出せないだろう、この嘘つき野郎め！もしもお前が実際に迫害したことがなくても関係ない！エレアは今までひどい目に遭ってきたので、直接関係ない奴を襲っても許されるんだよ！そんなことも分からないのか！", "Then show me proof that you're not persecuting Elea! You can't give evidence, you liar! It doesn't matter if you have never actually persecuted Elea! Elea has been through terrible things up until now, so even if Elea attacks someone who isn't directly involved, Elea can be forgiven! Don't you even understand that?")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+			goto *chat_end
+		}
+		if ( chatval == 4 ) {
+			listmax = 0
+			buff = lang("お前、エレアを見下しているんじゃないか？どうせ今までエレアを迫害し、暴力や暴言を浴びせてきたんだろうな！なぜならお前はエレアを見下してしているからだ！よくも今までエレアを見下して迫害してくれたな！最低の屑め、リンチにしてやる！", "You look down on Elea, don't you? I'm sure you've been persecuting Elea all this time, and you've been using violence and abusive language! Because you look down on Elea! You are the worst kind of scum for looking down on Elea and persecuting! We'll lynch you!")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+			goto *chat_end
+		}
+		if ( chatval == 5 ) {
+			listmax = 0
+			buff = lang("エレアだからという理由で疑うなんて酷いレッテル張りだ！お前みたいな差別主義者は何をされても文句を言う資格がない！だからなぶり殺しにしてやる！なぶり殺しにされるだけのことをしたお前に全ての非がある！", "It's a terrible prejudice to doubt us just because we're Elea! Racists like you have no right to complain no matter what is done to you! That's why we're going to torture you to death! It's all the fault of you who did something to get killed!")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+			goto *chat_end
+		}
+		goto *chat_unique_SWEND1
+		_switch_sw++
+	}
 	if ( _switch_val == 306 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cdata(CDATA_GOD, CHARA_PLAYER) == GOD_LULWY & cdata(CDATA_PIETY, CHARA_PLAYER) >= 4000 & gdata(GDATA_FLAG_SUMMONED_LULWY) == 0 ) {
 			listmax = 0
 			buff = lang("こうして間近で見るとますます手放したくなくなってくるわね。ホラ、オマエにはこれがお似合いだわ。いいと言うまで外しちゃだめよ。", "You are mine. This collar suits you nicely.")
@@ -26222,11 +26379,11 @@
 				invctrl = INVCTRL_MATERIAL_ENCHANT, 30
 				snd SOUNDLIST_INV
 				gosub *com_inventory
 				if ( stat == 1 ) {
 					cibk = ci
-					if ( inv(INV_ITEM_SHOP_SAMPLE, cibk) == 0 ) {
+					if ( inv(INV_ITEM_PARTS, cibk) == 0 ) {
 						listmax = 0
 						buff = lang("なんじゃ、このクオリティの高いポーショマンは！？こ、この出来ならばとっておきの細工が使えそうじゃ…。", "What is this quality potion man! ? With this quality, that mystery seems to be usable...")
 						tc = tc * (0 == 0) + (0 != 0) * 0
 						list(0, listmax) = 0
 						listn(0, listmax) = strmore
@@ -26237,11 +26394,11 @@
 							if ( scene_cut == 1 ) {
 								goto *chat_end
 							}
 						}
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, cibk) != 0 ) {
+					if ( inv(INV_ITEM_PARTS, cibk) != 0 ) {
 						listmax = 0
 						buff = lang("ああ、前に進化させたやつの属性変更じゃな。", "Ah, it's an attribute change of the one that was evolved before.")
 						tc = tc * (0 == 0) + (0 != 0) * 0
 						list(0, listmax) = 0
 						listn(0, listmax) = strmore
@@ -26321,11 +26478,11 @@
 					chatesc = 1
 					gosub *chat_select
 					pot = chatval
 					if ( chatval >= 1 & chatval <= 10 ) {
 						ele = chatval + 49
-						inv(INV_ITEM_SHOP_SAMPLE, cibk) = ele
+						inv(INV_ITEM_PARTS, cibk) = ele
 						snd SOUNDLIST_BUILD1
 						inv(INV_ITEM_NUM, ci)--
 						gosub *calcBurdenPc
 						redraw 0
 						gosub *screen_draw
@@ -45528,10 +45685,27 @@
 						}
 					}
 				}
 			}
 		}
+		if ( cbit(CHARA_BIT_LABOR_CAMP, tc) == TRUE & gdata(GDATA_AREA) != AREA_SHOW_HOUSE ) {
+			if ( cdata(CDATA_INTEREST, tc) > 0 ) {
+				list(0, listmax) = 132
+				listn(0, listmax) = lang("【暗黒evochat】（未実装）", "<Darkness evochat> under development")
+				listmax++
+			}
+			if ( cdata(CDATA_INTEREST, tc) > 0 ) {
+				list(0, listmax) = 133
+				listn(0, listmax) = lang("収容者を解放する", "I have decided to release you.")
+				listmax++
+			}
+			if ( cdata(CDATA_INTEREST, tc) > 0 ) {
+				list(0, listmax) = 134
+				listn(0, listmax) = lang("見せしめに処刑する", "I have decided to execute you as a demonstration.")
+				listmax++
+			}
+		}
 		if ( cbit(CHARA_BIT_LIVESTOCK, tc) == TRUE & gdata(GDATA_AREA) != AREA_SHOW_HOUSE ) {
 			if ( cdata(CDATA_INTEREST, tc) > 0 ) {
 				list(0, listmax) = 96
 				listn(0, listmax) = lang("芸を仕込む (アイテム消費)", "I will teach you performance. (item consume) ")
 				listmax++
@@ -48217,10 +48391,123 @@
 	}
 	if ( chatval == 36 | chatval == 57 ) {
 		goto *chat_slave
 		goto *chat_default
 	}
+	if ( chatval == 133 ) {
+		if ( cbit(CHARA_BIT_SANDBAG, tc) ) {
+			snd SOUNDLIST_FAIL1
+			txt lang("吊るしたままでは解放できない。", "You cannot release " + name(tc) + " on hanging.")
+			goto *pc_turn
+		}
+		buff = lang("ほ、本当に！？", "Really?")
+		list(0, listmax) = 0
+		listn(0, listmax) = lang("ウソだよー", "It's a lie.")
+		listmax++
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("これからは自由の身だ", "You're free from now on.")
+		listmax++
+		chatesc = 1
+		gosub *chat_select
+		if ( chatval == 1 ) {
+			if ( cdata(CDATA_MASTER_SERVANT, tc) >= 150 ) {
+				txtef COLOR_RED2
+				txt lang("もう" + name(tc) + "は、誰かに従わないと生きていけないようだ…。", "It seems like " + cdatan(CDATAN_NAME, tc) + " can no longer live without obeying someone...")
+				f = get_freeally()
+				if ( f == 0 ) {
+					txt lang(cdatan(CDATAN_NAME, tc) + "は仲間の枠がないことに気がつくと、寂しそうにそのまま何処かに行ってしまった…。", cdatan(CDATAN_NAME, tc) + " went somewhere...")
+					chara_vanquish tc
+					goto *chat_end
+				}
+				rc = tc
+				gosub *add_ally
+				cdata(CDATA_AREA, rc) = 0
+				gosub *screen_draw
+				goto *turn_end
+			}
+			if ( cdata(CDATA_MASTER_SERVANT, tc) < 150 & cdata(CDATA_IMPRESSION, tc) < 100 ) {
+				listmax = 0
+				buff = lang("だったら今までの恨みを晴らしてやる！", "Well then, I take my revenge on you!")
+				tc = tc * (0 == 0) + (0 != 0) * 0
+				list(0, listmax) = 0
+				listn(0, listmax) = strmore
+				listmax++
+				chatesc = 1
+				gosub *chat_select
+				if ( scenemode ) {
+					if ( scene_cut == 1 ) {
+						goto *chat_end
+					}
+				}
+				txt lang(name(tc) + "は反旗を翻した！", name(tc) + " rebelled!")
+				cdata(CDATA_ALLIED, tc) = 0
+				cbitmod CHARA_BIT_LABOR_CAMP, tc, FALSE
+				snd SOUNDLIST_CHEER
+				cdata(CDATA_EMO_ICON, tc) = 18 + 100 * 4
+				cdata(CDATA_RELATION, tc) = RELATION_ENEMY
+				cdata(CDATA_RELATION_ORG, tc) = RELATION_ENEMY
+				cdata(CDATA_AI_AGGRO, tc) = 80
+				cdata(CDATA_TARGET, tc) = 0
+				goto *chat_end
+			}
+			listmax = 0
+			buff = lang("自由だぁああああ！", "I'm freeeeeee!")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strmore
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+			txt lang(name(tc) + "は収容所を去った。", name(tc) + " left this camp...")
+			chara_vanquish tc
+			goto *chat_end
+		}
+		goto *chat_end
+	}
+	if ( chatval == 134 ) {
+		buff = lang("えっ。", "Really?!")
+		list(0, listmax) = 0
+		listn(0, listmax) = lang("冗談だよ", "It's a joke.")
+		listmax++
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("さようなら", "Bye bye.")
+		listmax++
+		chatesc = 1
+		gosub *chat_select
+		if ( chatval == 1 ) {
+			cdata(CDATA_HP, tc) = 1
+			snd SOUNDLIST_ATKSWORD
+			txtef COLOR_RED
+			txt lang(" *ブシュッ* ", "*Gash*")
+			gdata(GDATA_DMG_TYPE) = 2
+			txt3rd = 1
+			txt lang(name(cc) + "は" + name(tc) + "の首をちょんぎり", name(cc) + " cut" + _s(cc) + " " + name(tc) + your(tc) + " head and")
+			dmghp tc, cdata(CDATA_MAX_HP, tc), (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */), SKILL_SPACT_DECAPITATION
+			if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_DEAD ) {
+				cdata(CDATA_EXIST, tc) = CHAR_STATE_DEAD
+			}
+			await 100
+			snd SOUNDLIST_ATK_DARK
+			repeat 245
+				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+					continue
+				}
+				if ( cbit(CHARA_BIT_LABOR_CAMP, cnt) != TRUE ) {
+					continue
+				}
+				dmgcon cnt, CONDITION_FEAR, limit(1000 - cdata(CDATA_MASTER_SERVANT, cnt), 1, 1000)
+				modimp2 cnt, 30
+				modimp cnt, -30
+			loop
+		}
+		goto *chat_end
+	}
 	if ( chatval == 96 ) {
 		tcbk = tc
 		invsubroutine = 1
 		invctrl = INVCTRL_MATERIAL_ENCHANT, 4
 		snd SOUNDLIST_INV
@@ -50317,11 +50604,11 @@
 	if ( chatval == 54 ) {
 		if ( calccostreload(0) == 0 ) {
 			buff = lang("充填する必要はないみたい" + _da(), "Reload what? You don't have any ammo in your inventory.")
 			goto *chat_default
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 100 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 100 ) {
 			buff = lang("今は在庫の準備中" + _da(), "It is currently in preparation.")
 			goto *chat_default
 		}
 		buff = lang("そう" + _dana(3) + "、全員の特殊矢弾を補充すると" + calccostreload(0) + strgold + _da(), "Sure, let me check what type of ammos you need....Okay, reloading all of your ammos will cost " + calccostreload(0) + " gold pieces.")
 		if ( cdata(CDATA_GOLD, CHARA_PLAYER) >= calccostreload(0) ) {
@@ -50336,11 +50623,11 @@
 		gosub *chat_select
 		if ( chatval == 1 ) {
 			snd SOUNDLIST_PAYGOLD1
 			cdata(CDATA_GOLD, CHARA_PLAYER) -= calccostreload(0)
 			p = calccostreload(0, 1)
-			adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 100
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 100
 			buff = lang(_thanks(2), "Thanks!")
 		}
 		else {
 			buff = lang("冷やかし" + _ka(1), "You kidding? ")
 		}
@@ -54206,14 +54493,10 @@
 	}
 	else {
 		s = ""
 	}
 	if ( evochat < 2 ) {
-		if ( 0 ) {
-			s += lang("gauge" + cdata(CDATA_POWER_GAUGE, tc) + " ", "bisexual")
-			s += lang("距離" + cdata(CDATA_AI_DISTANCE, tc) + " ", "hunger")
-		}
 		if ( cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
 			s += lang("両性具有", "bisexual")
 		}
 		if ( cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
 			s += lang("性別不明", "unknown")
@@ -54239,13 +54522,10 @@
 			}
 		}
 		if ( cdatan(CDATAN_AKA, tc) != "" ) {
 			s += lang(" 名声 ", " Fame: ") + cdata(CDATA_FAME, tc)
 		}
-		if ( 0 ) {
-			s += lang(" 呪い ", " Fame: ") + cdata(CDATA_CURSE, tc)
-		}
 		if ( cdata(CDATA_ROLE, tc) == ROLE_SHOP_TRADE ) {
 			if ( cdata(CDATA_ROLE_SHOP_LEVEL, tc) == 0 ) {
 				cdata(CDATA_ROLE_SHOP_LEVEL, tc) = 10
 			}
 		}
@@ -54253,13 +54533,10 @@
 			s += lang(" 店の規模:", " Shop Rank:") + cdata(CDATA_ROLE_SHOP_LEVEL, tc)
 		}
 		if ( gdata(GDATA_GOD_DETECT) ) {
 			s += " (" + godname(cdata(CDATA_GOD, tc)) + ")"
 		}
-		if ( 0 ) {
-			s += " imp:" + cdata(CDATA_IMPRESSION, tc)
-		}
 		if ( scenemode ) {
 			s = actor(0, rc)
 		}
 	}
 	if ( evochat < 2 ) {
@@ -54301,11 +54578,11 @@
 			mes "(" + s(1) + ")" + s
 			if ( cbit(CHARA_BIT_HIRED, tc) != FALSE ) {
 				pos wx + 32, wy + 310
 				mes "" + cnvdate(cdata(CDATA_HIRE_DATE, tc), 2)
 			}
-			if ( tc < MAX_CHARA_FOLLOWER | cbit(CHARA_BIT_LIVESTOCK, tc) == TRUE ) {
+			if ( tc < MAX_CHARA_FOLLOWER | cbit(CHARA_BIT_LIVESTOCK, tc) == TRUE | cbit(CHARA_BIT_LABOR_CAMP, tc) == TRUE ) {
 				s = _impressionb(implevel2(cdata(CDATA_MASTER_SERVANT, tc)))
 				if ( cdata(CDATA_HEART_LOCK_RELATION, tc) == (-11) ) {
 					s = _impressionb1(implevel2(cdata(CDATA_MASTER_SERVANT, tc)))
 				}
 				if ( cdata(CDATA_HEART_LOCK_RELATION, tc) == (-12) ) {
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/chips.hsp ../2.20-borscht/chips.hsp
--- ../2.19R-borscht/chips.hsp	2023-08-08 08:52:04.428714300 +0800
+++ ../2.20-borscht/chips.hsp	2023-10-08 12:52:59.388932800 +0800
@@ -1342,10 +1342,15 @@
 	chipi(CHIPI_HEIGHT, xy2pic(32, 27)) = inf_tiles * 2, inf_tiles + 16
 	chipi(CHIPI_HEIGHT, xy2pic(8, 28)) = inf_tiles * 2, inf_tiles + 16
 	chipi(CHIPI_HEIGHT, xy2pic(17, 34)) = inf_tiles * 2, inf_tiles + 16
 	chipi(CHIPI_HEIGHT, xy2pic(0, 38)) = inf_tiles * 2, inf_tiles + 16
 	chipi(CHIPI_HEIGHT, xy2pic(1, 38)) = inf_tiles * 2, inf_tiles + 16
+	chipi(CHIPI_HEIGHT, xy2pic(7, 38)) = inf_tiles * 2, inf_tiles + 16
+	chipi(CHIPI_HEIGHT, xy2pic(8, 38)) = inf_tiles * 2, inf_tiles + 16
+	chipi(CHIPI_HEIGHT, xy2pic(9, 38)) = inf_tiles * 2, inf_tiles + 16
+	chipi(CHIPI_HEIGHT, xy2pic(10, 38)) = inf_tiles * 2, inf_tiles + 16
+	chipi(CHIPI_HEIGHT, xy2pic(11, 38)) = inf_tiles * 2, inf_tiles + 16
 	chipi(CHIPI_HEIGHT, xy2pic(30, 33)) = inf_tiles * 2, inf_tiles + 16, 40
 	chipi(CHIPI_HEIGHT, xy2pic(18, 36)) = inf_tiles * 2, inf_tiles + 16, 40
 	chipi(CHIPI_ANIM, xy2pic(4, 0)) = 2
 	chipi(CHIPI_ANIM, xy2pic(19, 0)) = 2
 	chipi(CHIPI_ANIM, xy2pic(24, 0)) = 3
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/command.hsp ../2.20-borscht/command.hsp
--- ../2.19R-borscht/command.hsp	2023-08-08 08:52:04.568337000 +0800
+++ ../2.20-borscht/command.hsp	2023-10-08 12:52:59.500642700 +0800
@@ -1011,23 +1011,30 @@
 		if ( cdata(CDATA_AREA, cnt) != 0 ) {
 			if ( allyctrl == 1 | allyctrl == 2 ) {
 				continue
 			}
 		}
-		if ( allyctrl != 1 ) {
-			if ( cbit(CHARA_BIT_BODYGUARD, cnt) == TRUE ) {
-				continue
+		if ( allyctrl != 9 ) {
+			if ( allyctrl != 1 ) {
+				if ( cbit(CHARA_BIT_BODYGUARD, cnt) == TRUE ) {
+					continue
+				}
 			}
-		}
-		if ( allyctrl != 6 ) {
-			if ( cbit(CHARA_BIT_GUARD_TEMP, cnt) == TRUE ) {
-				continue
+			if ( allyctrl > 1 ) {
+				if ( cbit(CHARA_BIT_LOCKED_UP, cnt) == TRUE ) {
+					continue
+				}
 			}
-		}
-		if ( allyctrl != 6 ) {
-			if ( cbit(CHARA_BIT_RIDE, cnt) ) {
-				continue
+			if ( allyctrl != 6 ) {
+				if ( cbit(CHARA_BIT_GUARD_TEMP, cnt) == TRUE ) {
+					continue
+				}
+			}
+			if ( allyctrl != 6 ) {
+				if ( cbit(CHARA_BIT_RIDE, cnt) ) {
+					continue
+				}
 			}
 		}
 		if ( allyctrl == 8 ) {
 			if ( cnt == tc ) {
 				continue
@@ -1040,10 +1047,15 @@
 			}
 			if ( cdata(CDATA_AREA, cnt) != 0 ) {
 				continue
 			}
 		}
+		if ( allyctrl == 9 ) {
+			if ( cbit(CHARA_BIT_LOCKED_UP, cnt) != TRUE ) {
+				continue
+			}
+		}
 		if ( cnt == 0 ) {
 			continue
 		}
 		list(0, listmax) = cnt, -cdata(CDATA_LEVEL, cnt)
 		listmax++
@@ -1079,10 +1091,15 @@
 		if ( page > pagemax ) {
 			page = 0
 			txtnew
 		}
 	}
+	if ( allyctrl == 9 ) {
+		txt lang("誰を収容する？", "Place who?")
+		s(10) = lang("収容する連行者", "Cage List"), strhint2 + strhint3, lang("連行者の情報", "Name"), lang("状態", "Status")
+		x = 0
+	}
 	if ( allyctrl == 0 ) {
 		txt lang("誰を呼び戻す？", "call who?")
 		s(10) = lang("呼び戻す仲間", "Ally List"), strhint2 + strhint3, lang("仲間の情報", "Name"), lang("状態", "Status")
 		x = 0
 	}
@@ -1205,11 +1222,11 @@
 		i = list(0, p)
 		if ( i == 99 ) {
 			cs_list lang("決定", "Proceed"), wx + 84, wy + 66 + cnt * 19 - 1, 19
 			continue
 		}
-		if ( allyctrl == 0 | allyctrl == 2 | allyctrl == 3 | allyctrl == 4 | allyctrl == 5 | allyctrl == 6 | allyctrl == 7 | allyctrl == 8 ) {
+		if ( allyctrl == 0 | allyctrl == 2 | allyctrl == 3 | allyctrl == 4 | allyctrl == 5 | allyctrl == 6 | allyctrl == 7 | allyctrl == 8 | allyctrl == 9 ) {
 			s = "" + cdatan(CDATAN_AKA, i) + " " + cdatan(CDATAN_NAME, i)
 			if ( cdata(CDATA_AREA, i) != 0 ) {
 				s = s + "(" + mapname(cdata(CDATA_AREA, i)) + ")"
 			}
 			if ( cbit(CHARA_BIT_RIDE, i) ) {
@@ -3531,11 +3548,11 @@
 					s += lang("/迎撃/", "(intercept")
 				}
 				if ( cdata(CDATA_DIRECTIVE_MODE, i) == DIRECTIVE_MODE_TALKING ) {
 					s += lang("/交渉/", "(talking")
 				}
-				s += lang("ガードブレイク" + cdata(CDATA_DRAIN_HP, i) + "%", " GuardBreak:" + cdata(CDATA_DRAIN_HP, i) + "%")
+				s += lang("ガードブレイク" + cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), i) + "%", " GuardBreak:" + cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), i) + "%")
 			}
 		}
 		if ( allyctrl != 4 ) {
 			s = "Lv." + cdata(CDATA_LEVEL, i) + " "
 			if ( cdatan(CDATAN_NEWSEX, i) == lang("両性具有", "bisexual") ) {
@@ -5225,11 +5242,11 @@
 				list(0, listmax) = cnt, 15
 				listmax++
 			}
 		}
 	loop
-	repeat 855 - 600
+	repeat 856 - 600
 		if ( spact(cnt) == 1 ) {
 			if ( sdataref(SKILL_DATAREF_TG, cnt + 600) / 1000 * 1000 != 3000 & cnt + 600 != 746 & cnt + 600 != 667 & cnt + 600 != 693 & cnt + 600 != 740 ) {
 				list(0, listmax) = cnt + 600, sdataref(SKILL_DATAREF_USE, 600 + cnt)
 				listmax++
 			}
@@ -5371,11 +5388,11 @@
 	}
 	if ( key == key_msglog ) {
 		snd SOUNDLIST_CHEST1
 		txtef COLOR_GREEN
 		txt lang("【技能・全表示】", "[Sealed skills release]")
-		repeat 855 - 600
+		repeat 856 - 600
 			if ( spact(cnt) == 2 ) {
 				if ( sdataref(SKILL_DATAREF_TG, cnt + 600) / 1000 * 1000 != 3000 & cnt + 600 != 746 & cnt + 600 != 667 & cnt + 600 != 693 & cnt + 600 != 740 ) {
 					spact(cnt) = 1
 				}
 			}
@@ -5444,11 +5461,11 @@
 	cc = CHARA_PLAYER
 	cs_bk = -1
 	cs = commark(2) \ 1000
 	page = commark(2) / 1000
 	curmenu = 2
-	repeat 855 - 600
+	repeat 856 - 600
 		if ( spact(cnt) == 1 ) {
 			if ( sdataref(SKILL_DATAREF_TG, cnt + 600) / 1000 * 1000 == 3000 | cnt + 600 == 746 | cnt + 600 == 667 | cnt + 600 == 693 | cnt + 600 == 740 ) {
 				list(0, listmax) = cnt + 600, sdataref(SKILL_DATAREF_USE, 600 + cnt)
 				listmax++
 			}
@@ -5583,11 +5600,11 @@
 	}
 	if ( key == key_msglog ) {
 		snd SOUNDLIST_CHEST1
 		txtef COLOR_GREEN
 		txt lang("【広域技能・全表示】", "[Sealed skills release]")
-		repeat 855 - 600
+		repeat 856 - 600
 			if ( spact(cnt) == 2 ) {
 				if ( sdataref(SKILL_DATAREF_TG, cnt + 600) / 1000 * 1000 == 3000 | cnt + 600 == 746 | cnt + 600 == 667 | cnt + 600 == 693 | cnt + 600 == 740 ) {
 					spact(cnt) = 1
 				}
 			}
@@ -5939,11 +5956,11 @@
 		}
 		if ( cdata(CDATA_INTEREST, tc) >= 80 ) {
 			promptl(0, promptmax) = lang("気持ちを伝える", "Tell feelings"), "null", "" + 29
 			promptmax++
 		}
-		if ( cbit(CHARA_BIT_BODYGUARD, tc) == FALSE & cbit(CHARA_BIT_GUARD_TEMP, tc) == FALSE ) {
+		if ( cbit(CHARA_BIT_BODYGUARD, tc) == FALSE & cbit(CHARA_BIT_GUARD_TEMP, tc) == FALSE & cbit(CHARA_BIT_LOCKED_UP, tc) == FALSE ) {
 			if ( tc < MAX_CHARA_FOLLOWER | (cbit(CHARA_BIT_LIVESTOCK, tc) == TRUE & gdata(GDATA_AREA) == AREA_DOJO) ) {
 				promptl(0, promptmax) = lang("何かを渡す/もらう", "Give or Take"), "null", "" + 4
 				promptmax++
 			}
 			else {
@@ -6006,11 +6023,11 @@
 	}
 	if ( cdata(CDATA_MARK_ITEM_PIC, tc) > xy2pic(0, 0) ) {
 		promptl(0, promptmax) = lang("アイテム画像の削除", "Item mark delete"), "null", "" + 24
 		promptmax++
 	}
-	if ( cbit(CHARA_BIT_BODYGUARD, tc) == FALSE & cbit(CHARA_BIT_GUARD_TEMP, tc) == FALSE ) {
+	if ( cbit(CHARA_BIT_BODYGUARD, tc) == FALSE & cbit(CHARA_BIT_GUARD_TEMP, tc) == FALSE & cbit(CHARA_BIT_LOCKED_UP, tc) == FALSE ) {
 		if ( tc < MAX_CHARA_FOLLOWER ) {
 			if ( cdata(CDATA_IN_TAGTEAM, tc) != 1 ) {
 				if ( cdata(CDATA_AREA, tc) == 0 | tc == CHARA_PLAYER ) {
 					if ( cdata(CDATA_IN_TAGTEAM, tc) == 0 ) {
 						promptl(0, promptmax) = lang("タッグ編成", "Tag organization."), "null", "" + 16
@@ -9363,11 +9380,13 @@
 						keigen2 = 150 * 100 / limit(keigen * 50 + 50, 40, 150)
 					}
 					else {
 						keigen2 = 100 * 100 / (keigen * 50 + 50)
 					}
-					keigen2 = keigen2 * 100 / (sdata(SKILL_RES_MAGIC, cc) / 2 + 50)
+					if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) < 100 ) {
+						keigen2 = keigen2 * 100 / (sdata(SKILL_RES_MAGIC, cc) / 4 + 50)
+					}
 				}
 				else {
 					if ( csctrl == 300 ) {
 						s = ""
 					}
@@ -10904,11 +10923,11 @@
 	if ( cdata(CDATA_PV, cc) < 0 ) {
 		pvfix = 100
 	}
 	dvr1 = cdata(CDATA_DV, cc) * dvfix / 100 + dvfix - 100
 	pvr1 = (cdata(CDATA_PV, cc) + pvfix / 25) * pvfix / 100
-	if ( cdata(CDATA_DRAIN_HP, cc) >= 100 ) {
+	if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) >= 100 ) {
 		dvr1 = 0
 		pvr1 = 0
 	}
 	if ( showresist ) {
 		pos wx + 320, wy + 40
@@ -11826,11 +11845,11 @@
 				}
 				if ( invctrl(1) == 27 ) {
 					if ( inv(INV_ITEM_ID, cnt) != ITEM_ID_CORPSE ) {
 						continue
 					}
-					if ( inv(INV_ITEM_SHOP_SAMPLE, cnt) == 0 ) {
+					if ( inv(INV_ITEM_PARTS, cnt) == 0 ) {
 						continue
 					}
 					if ( inv(INV_ITEM_PARAM2, cnt) != 0 ) {
 						continue
 					}
@@ -12275,11 +12294,11 @@
 		if ( cdata(CDATA_PV, tc) < 0 ) {
 			pvfix = 100
 		}
 		dvr1 = cdata(CDATA_DV, tc) * dvfix / 100 + dvfix - 100
 		pvr1 = (cdata(CDATA_PV, tc) + pvfix / 25) * pvfix / 100
-		if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
 			dvr1 = 0
 			pvr1 = 0
 		}
 		font lang(cfg_font1, cfg_font2), 12 + en - en * 2, 0
 		pos x + 16, y + 17
@@ -12302,11 +12321,11 @@
 		if ( cdata(CDATA_PV, tc) < 0 ) {
 			pvfix = 100
 		}
 		dvr1 = cdata(CDATA_DV, tc) * dvfix / 100 + dvfix - 100
 		pvr1 = (cdata(CDATA_PV, tc) + pvfix / 25) * pvfix / 100
-		if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
 			dvr1 = 0
 			pvr1 = 0
 		}
 		font lang(cfg_font1, cfg_font2), 12 + en - en * 2, 0
 		pos x + 16, y + 17
@@ -12440,14 +12459,14 @@
 		}
 		pos wx + 37, wy + 69 + cnt * 19
 		gmode 2, chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
 		grotate BUFFER_ITEM, 0, 960, 0, chipi(CHIPI_WIDTH, p(1)) * inf_tiles / chipi(CHIPI_HEIGHT, p(1)), inf_tiles
 		if ( inv(INV_ITEM_ID, p) == ITEM_ID_CF_POTIOMAN | inv(INV_ITEM_ID, p) == ITEM_ID_CRUSH_POTIOMAN | inv(INV_ITEM_ID, p) == ITEM_ID_BATTLE_POTIOMAN | inv(INV_ITEM_ID, p) == ITEM_ID_SUPER_POTIOMAN ) {
-			if ( inv(INV_ITEM_SHOP_SAMPLE, p) > 0 ) {
+			if ( inv(INV_ITEM_PARTS, p) > 0 ) {
 				pos wx + 37, wy + 69 + cnt * 19
 				gmode 2, chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
-				grotate BUFFER_ITEM, 1008 - (inv(INV_ITEM_SHOP_SAMPLE, p) - 50) * 48, 1776, 0, 48, 48
+				grotate BUFFER_ITEM, 1008 - (inv(INV_ITEM_PARTS, p) - 50) * 48, 1776, 0, 48, 48
 			}
 			if ( inv(INV_ITEM_AMUR_CAGE, p) > 0 ) {
 				pos wx + 37, wy + 69 + cnt * 19
 				gmode 2, chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
 				grotate BUFFER_ITEM, 1344 - inv(INV_ITEM_AMUR_CAGE, p) * 48, 1776, 0, 48, 48
@@ -15371,11 +15390,11 @@
 	gosub *db_class
 	buff = ""
 	notesel buff
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Dump:1" + " ct:" + ct
-	noteadd "Elona Version " + "6.20" + " キャラクター情報 " + gdata(GDATA_YEAR) + "年" + gdata(GDATA_MONTH) + "月" + gdata(GDATA_DAY) + "日 " + gdata(GDATA_HOUR) + "時" + gdata(GDATA_MIN) + "分  " + mdatan(0)
+	noteadd "Elona Version " + "6.22" + " キャラクター情報 " + gdata(GDATA_YEAR) + "年" + gdata(GDATA_MONTH) + "月" + gdata(GDATA_DAY) + "日 " + gdata(GDATA_HOUR) + "時" + gdata(GDATA_MIN) + "分  " + mdatan(0)
 	noteadd ""
 	noteadd "  " + fixtxt("" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER), 34) + _sex(cdata(CDATA_SEX, CHARA_PLAYER)) + " " + calcage(0) + "歳" + "  " + cdata(CDATA_HEIGHT, CHARA_PLAYER) + "cm" + " " + cdata(CDATA_WEIGHT, CHARA_PLAYER) + "kg"
 	noteadd ""
 	noteadd fixtxt("種族       : " + racename, 30) + fixtxt("信仰      : " + godname(cdata(CDATA_GOD, CHARA_PLAYER)), 32)
 	noteadd fixtxt("職業       : " + classname, 30) + fixtxt("所属      : " + guildname(), 32)
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/db_card.hsp ../2.20-borscht/db_card.hsp
--- ../2.19R-borscht/db_card.hsp	2023-08-08 08:52:04.765808900 +0800
+++ ../2.20-borscht/db_card.hsp	2023-10-08 12:52:59.660209800 +0800
@@ -1,6 +1,136 @@
 *db_card
+	if ( dbid == 1091 ) {
+		cardreftype = 10
+		cardrefskill = lang("全身が細菌に蝕まれて変貌した。正真正銘のバケモノであるが、素体が最後の根性で同化に抗っており、これでも本来の戦闘力は大きく抑制されている。", "")
+		cardrefdomain = 6
+		cardrefrare = 10
+		cardrefcost = 1
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("同化抵抗体", "anabolic resistance")
+		cardrefpic = xy2pic(7, 34) + COLOR_DEFAULT * COLOR_TINT_MULT
+		cardrefrace = "1091 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1090 ) {
+		cardreftype = 10
+		cardrefskill = lang("元はそこら辺にいるモンスターだったようだが、何かのきっかけで体内の細菌が暴走して大増殖してしまい、肉体を乗っ取られてしまった。もっと増殖するために他の生物の肉体を欲している。", "")
+		cardrefdomain = 6
+		cardrefrare = 90
+		cardrefcost = 1
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("モンスターバクテリア", "monster bacteria")
+		cardrefpic = xy2pic(6, 34) + COLOR_BLUE * COLOR_TINT_MULT
+		cardrefrace = "1090 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1089 ) {
+		cardreftype = 10
+		cardrefskill = lang("感染による変異途中の形態。ここからさらに菌糸が増殖・結合を繰り返して新たな四肢が形成される。素体となった人間は精神的ショックで気絶しているが、目覚めてからが本当の地獄だ。", "")
+		cardrefdomain = 6
+		cardrefrare = 20
+		cardrefcost = 1
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("メシェーラ・イズヒギリア", "meshera unfinished")
+		cardrefpic = xy2pic(7, 34) + COLOR_RED * COLOR_TINT_MULT
+		cardrefrace = "1089 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1088 ) {
+		cardreftype = 10
+		cardrefskill = lang("異常に巨大化した細菌の塊。特殊な環境下でどこまででかくなるのか、研究者が興味本位で培養し続けた結果がこれ。発達した鞭毛をうねらせて大跳躍し、獲物に襲い掛かる。", "")
+		cardrefdomain = 6
+		cardrefrare = 20
+		cardrefcost = 1
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("大跳菌", "bouncteria")
+		cardrefpic = xy2pic(6, 34) + COLOR_DEFAULT * COLOR_TINT_MULT
+		cardrefrace = "1088 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1087 ) {
+		cardreftype = 10
+		cardrefskill = lang("荒ぶる海で鍛え上げた荒々しい海賊。船酔いは肉体的なものではなく根性で解決できるものだと思いこんでいる。あまりにも粗野なので同僚からは敬遠されており、直情的に勝手に行動するので船長からは問題児扱いされている。", "")
+		cardrefdomain = 6
+		cardrefrare = 5
+		cardrefcost = 0
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("荒くれ海賊", "rough pirate")
+		cardrefpic = xy2pic(10, 2) + COLOR_RED * COLOR_TINT_MULT
+		cardrefrace = "1087 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1086 ) {
+		cardreftype = 10
+		cardrefskill = lang("銃火器の扱いに長けた海賊。白兵戦以外では船の大砲で戦っており、どちらかと言えばそっちがメインなので砲兵にあたる。しかし銃士のほうが響きがカッコいいという風潮が彼らの中である模様。", "")
+		cardrefdomain = 6
+		cardrefrare = 10
+		cardrefcost = 1
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("海賊銃士", "pirate musketeer")
+		cardrefpic = xy2pic(8, 34) + COLOR_DEFAULT * COLOR_TINT_MULT
+		cardrefrace = "1086 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1085 ) {
+		cardreftype = 10
+		cardrefskill = lang("エレアを扇動しているジューア。サウスティリスの風土に疎いエレア達を、支援するという名目で利用しているならずものだ。エレア迫害を盾にして強引に金や物資を募るが、その全てを着服しており困っているエレアたちには金貨一枚届かない。バレそうになる前に行方をくらます予定。", "")
+		cardrefdomain = 6
+		cardrefrare = 25
+		cardrefcost = 1
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("エレアの扇動者", "instigator of Elea")
+		cardrefpic = xy2pic(9, 34) + COLOR_DEFAULT * COLOR_TINT_MULT
+		cardrefrace = "1085 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1084 ) {
+		cardreftype = 10
+		cardrefskill = lang("暴れ、怒鳴り、破壊と略奪の限りを尽くす暴徒。ややこしいことに、全員が全員、エレアの受けた仕打ちに怒り狂っているわけではない。中には暴れることが目的のバカやお祭り感覚のアホも混ざっているのだが、本当に怒っている者と見分けるのは困難。エレアの品位が下がるので同族から嫌われている。", "")
+		cardrefdomain = 6
+		cardrefrare = 30
+		cardrefcost = 0
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("エレアの暴徒", "mob of Elea")
+		cardrefpic = xy2pic(17, 2) + COLOR_RED * COLOR_TINT_MULT
+		cardrefrace = "1084 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1083 ) {
+		cardreftype = 10
+		cardrefskill = lang("元々は異形の森の外で暮らしていたエレア。ザナンがエレアの根絶を唱えたり対立を煽ったりした影響で嫌がらせやリンチに遭い、家族を失った。もはや復讐だけが生きる目的となっている。復讐を果たした後に虚しさだけが残ること、それに自分が耐えきれないであろうことも全て覚悟の上で復讐に臨んでいる。", "")
+		cardrefdomain = 6
+		cardrefrare = 40
+		cardrefcost = 0
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("エレアの復讐者", "avenger of Elea")
+		cardrefpic = xy2pic(14, 1) + COLOR_BLACK * COLOR_TINT_MULT
+		cardrefrace = "1083 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
+	if ( dbid == 1082 ) {
+		cardreftype = 10
+		cardrefskill = lang("安住の地を求めて各地を放浪しているエレア。迫害されてネフィアに逃げ込んだり、犯罪者に拾われたり、野垂れ死んだり、大体はろくでもない末路を辿りがち。", "")
+		cardrefdomain = 6
+		cardrefrare = 20
+		cardrefcost = 1
+		cardrefattack = 690
+		cardrefhp = 3
+		cardrefn = lang("エレアの放浪者", "wanderer of Elea")
+		cardrefpic = xy2pic(11, 34) + COLOR_DEFAULT * COLOR_TINT_MULT
+		cardrefrace = "1082 effect:" + skillname(cardrefattack) + " "
+		return 1
+	}
 	if ( dbid == 1081 ) {
 		cardreftype = 10
 		cardrefskill = lang("出身地は異形の森の近く。身体のあちこちが先祖返りを起こしており、人里から追い出された。死こそが万人にとっての救いであると考えており、生気のない目で各地を放浪しながら殺戮を繰り返している。", "")
 		cardrefdomain = 6
 		cardrefrare = 20
@@ -135,11 +265,11 @@
 		cardrefdomain = 6
 		cardrefrare = 30
 		cardrefcost = 1
 		cardrefattack = 690
 		cardrefhp = 3
-		cardrefn = lang("ダゴンズイ ", "daganotosus")
+		cardrefn = lang("ダゴンズイ", "daganotosus")
 		cardrefpic = xy2pic(31, 31) + COLOR_DEFAULT * COLOR_TINT_MULT
 		cardrefrace = "1071 effect:" + skillname(cardrefattack) + " "
 		return 1
 	}
 	if ( dbid == 1070 ) {
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/help.hsp ../2.20-borscht/help.hsp
--- ../2.19R-borscht/help.hsp	2023-08-08 08:52:07.147446100 +0800
+++ ../2.20-borscht/help.hsp	2023-10-08 12:53:01.556111000 +0800
@@ -5351,11 +5351,11 @@
 	}
 	if ( mode == MODELIST_QUICK_START ) {
 		repeat 9
 			gdata(STARTING_GDATA_RANK + cnt) = 5000
 		loop
-		gdata(GDATA_VERSION) = int(double("6.20") * 1000)
+		gdata(GDATA_VERSION) = int(double("6.22") * 1000)
 		gdata(STARTING_GDATA_SHORTCUT + 1) = 424
 		gdata(STARTING_GDATA_SHORTCUT + 2) = 300
 		gdata(STARTING_GDATA_SHORTCUT + 3) = 631
 		gdata(GDATA_COUNT_SHOP) = 1000
 		gdata(GDATA_COUNT_SHELTER) = 100
@@ -5398,11 +5398,10 @@
 		cdata(CDATA_GOD, CHARA_PLAYER) = GOD_LULWY, 1000, 1000
 		gdata(GDATA_FLAG_SUB_MOTHER) = 1001
 		gdata(GDATA_FLAG_SUB_URCAGUARY_THE_TENACIOUS_GEM) = 2
 		gdata(GDATA_FLAG_SUB_DOGS_TAIL) = 1000
 		gdata(GDATA_FLAG_SUB_YEEK) = 1000
-		gdata(GDATA_FLAG_SUB_CAT) = 1000
 		gdata(GDATA_FLAG_SUB_MINOTAUR) = 1000
 		gdata(GDATA_FLAG_SUB_PYRAMID) = 1000
 		gdata(GDATA_FLAG_SUB_FALLEN_PRINCESS) = 1000
 		gdata(GDATA_FLAG_SUB_MANSION_FOR_SALE) = 1004
 		gdata(GDATA_FLAG_SUB_BIOLOGIST) = 1000
@@ -5452,10 +5451,13 @@
 		inv(INV_ITEM_PARAM1, ci) = 8
 		flt
 		itemcreate CHARA_PLAYER, ITEM_ID_COFFIN_OF_NECROMANCY, -1, -1, 0
 		inv(INV_ITEM_PARAM1, ci) = 9
 		flt
+		itemcreate CHARA_PLAYER, ITEM_ID_MYSTERIOUS_ENVELOPE, -1, -1, 0
+		inv(INV_ITEM_PARAM1, ci) = 3
+		flt
 		itemcreate CHARA_PLAYER, ITEM_ID_LOVE_POTION, -1, -1, 0
 		inv(INV_ITEM_NUM, ci) = 600
 		flt
 		itemcreate CHARA_PLAYER, ITEM_ID_TEA_LEAF, -1, -1, 0
 		inv(INV_ITEM_LEVEL, ci) = 7
@@ -5951,11 +5953,11 @@
 		gdata(GDATA_AREA) = AREA_HOME
 		gdata(GDATA_HOME_LEVEL) = 0
 		gosub *setArea
 		gdata(GDATA_LEVEL) = 1
 		gdata(GDATA_LEVEL_START_ON) = 4
-		gdata(GDATA_VERSION) = int(double("6.20") * 1000)
+		gdata(GDATA_VERSION) = int(double("6.22") * 1000)
 		gdata(GDATA_WEATHER) = WEATHER_RAIN, 6
 		repeat 20
 			gdata(STARTING_GDATA_RANK + cnt) = 10000
 		loop
 		gosub *adv_init
@@ -7137,11 +7139,11 @@
 					}
 				}
 			}
 		}
 	}
-	if ( cdata(CDATA_CONDITION_SUFFOCATION, cc) >= 15 | cdata(CDATA_CONDITION_SLEEP, cc) > 0 | cdata(CDATA_CONDITION_PARALYZE, cc) > 0 | cdata(CDATA_CONDITION_DIM, cc) >= 60 | (findbuff(cc, BUFF_MELANCHOLY) != (-1) & rnd(10) == 0) ) {
+	if ( cdata(CDATA_CONDITION_SUFFOCATION, cc) >= 15 | cdata(CDATA_CONDITION_SLEEP, cc) > 0 | (cdata(CDATA_CONDITION_PARALYZE, cc) > 0 & rnd(2) == 0) | cdata(CDATA_CONDITION_DIM, cc) >= 60 | (findbuff(cc, BUFF_MELANCHOLY) != (-1) & rnd(10) == 0) ) {
 		if ( cc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_CONDITION_SUFFOCATION, cc) >= 15 ) {
 				await 120
 			}
 			await 60
@@ -7389,11 +7391,16 @@
 				else {
 					if ( gdata(GDATA_ROW_ACT) == ACTION_STEAL ) {
 						at 50
 					}
 					else {
-						at 20
+						if ( gdata(GDATA_ROW_ACT) == ACTION_SLAVE_WHEEL ) {
+							at 60
+						}
+						else {
+							at 20
+						}
 					}
 				}
 			}
 			gosub *generalAct
 		}
@@ -7871,11 +7878,11 @@
 		goto *pc_turn_init_WHILE1
 	}
 
 *pc_turn_init_WEND1
 	if ( dbg_titleinfo ) {
-		title "ElonaPlus 2.19R" + " ver " + "6.20" + " " + exedir + " Seed: " + randseed + "  Loop:" + looplev + " SubLoop:" + sublev + " x:" + cdata(CDATA_X, CHARA_PLAYER) + " y:" + cdata(CDATA_Y, CHARA_PLAYER) + " ev:" + evnum + " q:" + gdata(GDATA_QUEST) + " tile:" + map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_TILE_ID) + " unpc:" + usernpcmax + "/" + gdata(GDATA_USERNPC_COUNT)
+		title "ElonaPlus 2.20fix1" + " ver " + "6.22" + " " + exedir + " Seed: " + randseed + "  Loop:" + looplev + " SubLoop:" + sublev + " x:" + cdata(CDATA_X, CHARA_PLAYER) + " y:" + cdata(CDATA_Y, CHARA_PLAYER) + " ev:" + evnum + " q:" + gdata(GDATA_QUEST) + " tile:" + map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_TILE_ID) + " unpc:" + usernpcmax + "/" + gdata(GDATA_USERNPC_COUNT)
 	}
 	if ( trait(TRAIT_ETHER_ADDICTED_POTION) != 0 ) {
 		if ( rnd(5) == 0 ) {
 			inv_getheader 0
 			ci = rnd(invrange) + invhead
@@ -9468,10 +9475,20 @@
 		gosub *music_play
 		gdata(GDATA_MAP_EVENT) = 23
 		goto *event_SWEND1
 		_switch_sw++
 	}
+	if ( _switch_val == 97 | _switch_sw ) {
+		_switch_sw = 0
+		tc = findchara(CREATURE_ID_INSTIGATOR_OF_ELEA)
+		gosub *chat
+		music = MUSICLIST_MCBOSS
+		gosub *music_play
+		gdata(GDATA_MAP_EVENT) = 97
+		goto *event_SWEND1
+		_switch_sw++
+	}
 	if ( _switch_val == 95 | _switch_sw ) {
 		_switch_sw = 0
 		tc = findchara(CREATURE_ID_SHOPKEEPER)
 		kaiwaev = 1
 		gosub *chat
@@ -11123,22 +11140,22 @@
 		}
 		if ( ccbk == 0 ) {
 			babyid = cdata(CDATA_INFANT, ccbk)
 		}
 		babyai = cdata(CDATA_INFANT, ccbk)
-		cdata(CDATA_SP_EARNED, ccbk) = -cdata(CDATA_SP_EARNED, ccbk) \ 10000
+		cdata(CDATA_PREGNANCY_PROGRESS, ccbk) = -cdata(CDATA_PREGNANCY_PROGRESS, ccbk) \ 10000
 		if ( 0 ) {
-			txt lang(name(ccbk) + "の" + babyid + "と" + babyai + "ステージ端数" + cdata(CDATA_SP_EARNED, ccbk) + "。", name(cc) + " get genes of " + _s(cc) + ".")
+			txt lang(name(ccbk) + "の" + babyid + "と" + babyai + "ステージ端数" + cdata(CDATA_PREGNANCY_PROGRESS, ccbk) + "。", name(cc) + " get genes of " + _s(cc) + ".")
 		}
-		bsid = cdata(CDATA_SP_EARNED, ccbk) / 100
-		bsids = cdata(CDATA_SP_EARNED, ccbk) \ 100
+		bsid = cdata(CDATA_PREGNANCY_PROGRESS, ccbk) / 100
+		bsids = cdata(CDATA_PREGNANCY_PROGRESS, ccbk) \ 100
 		babymake = 1
 		repeat 20
-			if ( cdata(CDATA_TAMER_WHIP_PICKUP, ccbk) <= 0 & cdata(CDATA_TAMER_WHIP_EAT, ccbk) <= 0 ) {
+			if ( cdata(CDATA_PREGNANCY_MALE_CHILD, ccbk) <= 0 & cdata(CDATA_PREGNANCY_FEMALE_CHILD, ccbk) <= 0 ) {
 				break
 			}
-			if ( cdata(CDATA_TAMER_WHIP_PICKUP, ccbk) > 0 ) {
+			if ( cdata(CDATA_PREGNANCY_MALE_CHILD, ccbk) > 0 ) {
 				babysex = 10
 				flt
 				characreate MAX_CHARA_NC, babyai, -3, 0
 				flt
 				initlv = 1
@@ -11165,16 +11182,16 @@
 				cdata(STARTING_CDATA_ACT_SUB + 2, rc) = cdata(STARTING_CDATA_ACT_SUB + 2, MAX_CHARA_NC)
 				cdata(STARTING_CDATA_ACT_SUB + 3, rc) = cdata(STARTING_CDATA_ACT_SUB + 3, MAX_CHARA_NC)
 				cdata(STARTING_CDATA_ACT_SUB + 4, rc) = cdata(STARTING_CDATA_ACT_SUB + 4, MAX_CHARA_NC)
 				cdata(CDATA_ACT_INDEX, rc) = cdata(CDATA_ACT_INDEX, MAX_CHARA_NC)
 				chara_vanquish MAX_CHARA_NC
-				cdata(CDATA_TAMER_WHIP_PICKUP, ccbk)--
+				cdata(CDATA_PREGNANCY_MALE_CHILD, ccbk)--
 				wishally = 200
 				gdata(GDATA_TEMPORARY_FLAGS2) = 200
 				gosub *add_ally
 			}
-			if ( cdata(CDATA_TAMER_WHIP_EAT, ccbk) > 0 ) {
+			if ( cdata(CDATA_PREGNANCY_FEMALE_CHILD, ccbk) > 0 ) {
 				babysex = 11
 				flt
 				characreate MAX_CHARA_NC, babyai, -3, 0
 				flt
 				initlv = 1
@@ -11201,21 +11218,21 @@
 				cdata(STARTING_CDATA_ACT_SUB + 2, rc) = cdata(STARTING_CDATA_ACT_SUB + 2, MAX_CHARA_NC)
 				cdata(STARTING_CDATA_ACT_SUB + 3, rc) = cdata(STARTING_CDATA_ACT_SUB + 3, MAX_CHARA_NC)
 				cdata(STARTING_CDATA_ACT_SUB + 4, rc) = cdata(STARTING_CDATA_ACT_SUB + 4, MAX_CHARA_NC)
 				cdata(CDATA_ACT_INDEX, rc) = cdata(CDATA_ACT_INDEX, MAX_CHARA_NC)
 				chara_vanquish MAX_CHARA_NC
-				cdata(CDATA_TAMER_WHIP_EAT, ccbk)--
+				cdata(CDATA_PREGNANCY_FEMALE_CHILD, ccbk)--
 				wishally = 200
 				gdata(GDATA_TEMPORARY_FLAGS2) = 200
 				gosub *add_ally
 			}
 		loop
 		gdata(GDATA_TEMPORARY_FLAGS2) = 0
 		babymake = 0
 		babysex = 0
 		wishally = 0
-		cdata(CDATA_SP_EARNED, ccbk) = 0
+		cdata(CDATA_PREGNANCY_PROGRESS, ccbk) = 0
 		cdata(CDATA_INFANT, ccbk) = 0
 		flt
 		novoidlv = 1
 		characreate -1, CREATURE_ID_BOYCIANA, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
 		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
@@ -11708,11 +11725,11 @@
 			flt
 			itemcreate -1, ITEM_ID_MEMORY_CONVERTER, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), limit(gdata(GDATA_LEVEL) / 50 + 1, 1, 5) + kazu
 			inv(INV_ITEM_PARAM1, ci) = gskill
 			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 		}
-		if ( adata(ADATA_EXTRA_MEDAL, gdata(GDATA_AREA)) > 0 ) {
+		if ( adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) > 0 ) {
 			flt
 			itemcreate -1, ITEM_ID_SMALL_MEDAL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 			if ( gdata(GDATA_FLAG_NEFIA_FEVER_ACTIVE) == 100 ) {
 				flt
 				itemcreate -1, ITEM_ID_SMALL_MEDAL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
@@ -11720,11 +11737,11 @@
 			if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) != 0 ) {
 				flt
 				itemcreate -1, ITEM_ID_SMALL_MEDAL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 			}
 		}
-		adata(ADATA_EXTRA_MEDAL, gdata(GDATA_AREA)) = 0
+		adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) = 0
 		if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) != 0 ) {
 			if ( adata(ADATA_NEFIA_GEM_CHANCE, gdata(GDATA_AREA)) > 0 ) {
 				flt
 				itemcreate -1, ITEM_ID_CORE_OF_NEFIA, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 			}
@@ -11786,10 +11803,13 @@
 		_switch_sw++
 	}
 	if ( _switch_val == 6 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_DEATH_CREST, CHARA_PLAYER) == TRUE ) {
+			if ( cdata(CDATA_KARMA, CHARA_PLAYER) < (-30) ) {
+				modkarma 0, 10
+			}
 			snd SOUNDLIST_CRACK
 			txt lang("刻まれた死紋の色が変わっていく…！", "The color of your engraved Death-Crest is changing...!")
 			repeat 50 - 10, 10
 				if ( cnt <= 17 ) {
 					if ( sdata(cnt, CHARA_PLAYER) != 0 ) {
@@ -11809,13 +11829,10 @@
 		txtef COLOR_RED2
 		txt lang("【 刻死紋状態で死亡すると能力値が永続低下する。睡眠を取るまで消えない。 】", "< If you die with the Death-Crest engraved, your stats will permanently drop. It doesn't go away until you sleep. >")
 		if ( gdata(GDATA_CORRUPTION) >= 20000 ) {
 			modcorrupt -2000
 		}
-		if ( cdata(CDATA_KARMA, CHARA_PLAYER) < (-30) ) {
-			modkarma 0, 10
-		}
 		decfame CHARA_PLAYER, 10
 		r1 = 0
 		gosub *charaRefresh
 		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
 		goto *event_SWEND1
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/init.hsp ../2.20-borscht/init.hsp
--- ../2.19R-borscht/init.hsp	2023-08-08 08:52:07.392790700 +0800
+++ ../2.20-borscht/init.hsp	2023-10-08 12:53:01.730652400 +0800
@@ -1503,13 +1503,13 @@
 		return
 	}
 	return
 
 *sRefDefine
-	dim sdataref, 7, 855
-	sdim skillname, 16, 855
-	sdim skilldesc, 40, 855
+	dim sdataref, 7, 856
+	sdim skillname, 16, 856
+	sdim skilldesc, 40, 856
 	sdim skillencdesc, 40, 600
 	sdataref(SKILL_DATAREF_USE, SKILL_ATTR_LIFE) = SKILL_NONE, SKILL_TYPE_SP, 0, TARGET_TYPE_NONE, 0
 	skillname(SKILL_ATTR_LIFE) = lang("生命力", "Life")
 	skilldesc(SKILL_ATTR_LIFE) = lang("", "")
 	if ( 2 < 600 ) {
@@ -1677,77 +1677,77 @@
 	if ( 167 < 600 ) {
 		skillencdesc(SKILL_NORMAL_TWO_HAND) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_FIRE) = SKILL_NONE, SKILL_TYPE_SP, 0, 1, 0
 	skillname(SKILL_RES_FIRE) = lang("火炎", "fire")
-	skilldesc(SKILL_RES_FIRE) = lang("熱や炎への耐性", "Resistance to fire.")
+	skilldesc(SKILL_RES_FIRE) = lang("火炎攻撃や怯みへの抵抗", "Resist fire, Wince.")
 	if ( 50 < 600 ) {
 		skillencdesc(SKILL_RES_FIRE) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_COLD) = SKILL_NONE, SKILL_TYPE_SP, 0, 1, 0
 	skillname(SKILL_RES_COLD) = lang("冷気", "cold")
-	skilldesc(SKILL_RES_COLD) = lang("冷気や氷への耐性", "Resistance to cold.")
+	skilldesc(SKILL_RES_COLD) = lang("冷気攻撃や震えへの抵抗", "Resist cold, Chills.")
 	if ( 51 < 600 ) {
 		skillencdesc(SKILL_RES_COLD) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_LIGHTNING) = SKILL_NONE, SKILL_TYPE_SP, 0, 1, 0
 	skillname(SKILL_RES_LIGHTNING) = lang("電撃", "lightning")
-	skilldesc(SKILL_RES_LIGHTNING) = lang("雷や電気への耐性", "Resistance to lightning.")
+	skilldesc(SKILL_RES_LIGHTNING) = lang("電撃攻撃や麻痺への抵抗", "Resist lightning, Paralyze.")
 	if ( 52 < 600 ) {
 		skillencdesc(SKILL_RES_LIGHTNING) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_DARKNESS) = SKILL_NONE, SKILL_TYPE_SP, 0, 2, 0
 	skillname(SKILL_RES_DARKNESS) = lang("暗黒", "darkness")
-	skilldesc(SKILL_RES_DARKNESS) = lang("暗黒や盲目への耐性", "Resistance to darkness.")
+	skilldesc(SKILL_RES_DARKNESS) = lang("暗黒攻撃や盲目への抵抗", "Resist dark, Blind.")
 	if ( 53 < 600 ) {
 		skillencdesc(SKILL_RES_DARKNESS) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_MIND) = SKILL_NONE, SKILL_TYPE_SP, 0, 2, 0
 	skillname(SKILL_RES_MIND) = lang("幻惑", "mind")
-	skilldesc(SKILL_RES_MIND) = lang("精神攻撃への抵抗力", "Resistance to mind.")
+	skilldesc(SKILL_RES_MIND) = lang("幻惑攻撃や恐怖への抵抗", "Resist mind, Fear.")
 	if ( 54 < 600 ) {
 		skillencdesc(SKILL_RES_MIND) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_NETHER) = SKILL_NONE, SKILL_TYPE_SP, 0, 4, 0
 	skillname(SKILL_RES_NETHER) = lang("地獄", "nether")
-	skilldesc(SKILL_RES_NETHER) = lang("生命吸収への抵抗力", "Resistance to nether.")
+	skilldesc(SKILL_RES_NETHER) = lang("地獄攻撃や吸収への抵抗", "Resist nether, Drain.")
 	if ( 56 < 600 ) {
 		skillencdesc(SKILL_RES_NETHER) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_POISON) = SKILL_NONE, SKILL_TYPE_SP, 0, 3, 0
 	skillname(SKILL_RES_POISON) = lang("毒", "poison")
-	skilldesc(SKILL_RES_POISON) = lang("毒への耐性", "Resistance to poison.")
+	skilldesc(SKILL_RES_POISON) = lang("毒攻撃や毒への抵抗", "Resist poison, Poison.")
 	if ( 55 < 600 ) {
 		skillencdesc(SKILL_RES_POISON) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_SOUND) = SKILL_NONE, SKILL_TYPE_SP, 0, 3, 0
 	skillname(SKILL_RES_SOUND) = lang("音", "sound")
-	skilldesc(SKILL_RES_SOUND) = lang("音波や轟音への耐性", "Resistance to sound.")
+	skilldesc(SKILL_RES_SOUND) = lang("音攻撃や朦朧への抵抗", "Resist sound, Dim.")
 	if ( 57 < 600 ) {
 		skillencdesc(SKILL_RES_SOUND) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_CHAOS) = SKILL_NONE, SKILL_TYPE_SP, 0, 4, 0
 	skillname(SKILL_RES_CHAOS) = lang("混沌", "chaos")
-	skilldesc(SKILL_RES_CHAOS) = lang("混沌の効果への耐性", "Resistance to chaos.")
+	skilldesc(SKILL_RES_CHAOS) = lang("混沌攻撃や混乱への抵抗", "Resist chaos, Confuse.")
 	if ( 59 < 600 ) {
 		skillencdesc(SKILL_RES_CHAOS) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_NERVE) = SKILL_NONE, SKILL_TYPE_SP, 0, 3, 0
 	skillname(SKILL_RES_NERVE) = lang("神経", "nerve")
-	skilldesc(SKILL_RES_NERVE) = lang("睡眠や麻痺への耐性", "Resistance to nerve.")
+	skilldesc(SKILL_RES_NERVE) = lang("神経攻撃や睡眠への抵抗", "Resist nerve, Sleep.")
 	if ( 58 < 600 ) {
 		skillencdesc(SKILL_RES_NERVE) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RES_MAGIC) = SKILL_NONE, SKILL_TYPE_SP, 0, 5, 0
 	skillname(SKILL_RES_MAGIC) = lang("魔法", "magic")
-	skilldesc(SKILL_RES_MAGIC) = lang("魔法攻撃への耐性", "Resistance to magic.")
+	skilldesc(SKILL_RES_MAGIC) = lang("魔法攻撃への抵抗", "Resist magic.")
 	if ( 60 < 600 ) {
 		skillencdesc(SKILL_RES_MAGIC) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_RESDMG_CUT) = SKILL_NONE, SKILL_TYPE_SP, 0, TARGET_TYPE_NONE, 0
 	skillname(SKILL_RESDMG_CUT) = lang("出血", "cut")
-	skilldesc(SKILL_RESDMG_CUT) = lang("切り傷への耐性", "Resistance to cut.")
+	skilldesc(SKILL_RESDMG_CUT) = lang("切り傷攻撃への抵抗", "Resist cut.")
 	if ( 61 < 600 ) {
 		skillencdesc(SKILL_RESDMG_CUT) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_NORMAL_WEIGHT_LIFTING) = SKILL_ATTR_STR, SKILL_TYPE_SP, 0, TARGET_TYPE_NONE, 0
 	skillname(SKILL_NORMAL_WEIGHT_LIFTING) = lang("重量挙げ", "Weight Lifting")
@@ -2456,12 +2456,12 @@
 	skilldesc(SKILL_SPELL_RESURRECTION) = lang("死者の蘇生", "Resurrect dead")
 	if ( 461 < 600 ) {
 		skillencdesc(SKILL_SPELL_RESURRECTION) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPELL_WISH) = SKILL_ATTR_MAG, SKILL_TYPE_SP, 580, TARGET_TYPE_SELF_ONLY, 5250
-	skillname(SKILL_SPELL_WISH) = lang("願い", "Wish/The higher LV, the higher difficulty")
-	skilldesc(SKILL_SPELL_WISH) = lang("願いの効果/LV高いほど難易度増加", "Wish")
+	skillname(SKILL_SPELL_WISH) = lang("願い", "Wish")
+	skilldesc(SKILL_SPELL_WISH) = lang("願いの効果/LV高いほど難易度増加", "Wish/The higher LV, the higher difficulty")
 	if ( 441 < 600 ) {
 		skillencdesc(SKILL_SPELL_WISH) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPELL_METEOR) = SKILL_ATTR_MAG, SKILL_TYPE_SP, 220, TARGET_TYPE_SELF_ONLY, 1450
 	skillname(SKILL_SPELL_METEOR) = lang("メテオ", "Meteor")
@@ -2793,41 +2793,41 @@
 	if ( 654 < 600 ) {
 		skillencdesc(SKILL_SPACT_PREGNANT) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_TOUCH_OF_WEAKNESS) = SKILL_ATTR_MAG, SKILL_TYPE_HAND, 5, TARGET_TYPE_DIRECTION, 0
 	skillname(SKILL_SPACT_TOUCH_OF_WEAKNESS) = lang("弱体化の手", "Touch of Weakness")
-	skilldesc(SKILL_SPACT_TOUCH_OF_WEAKNESS) = lang("弱体化", "Weaken target")
+	skilldesc(SKILL_SPACT_TOUCH_OF_WEAKNESS) = lang("無属性攻撃＋弱体化", "Weaken target")
 	if ( 613 < 600 ) {
 		skillencdesc(SKILL_SPACT_TOUCH_OF_WEAKNESS) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_TOUCH_OF_HUNGER) = SKILL_ATTR_MAG, SKILL_TYPE_HAND, 5, TARGET_TYPE_DIRECTION, 0
 	skillname(SKILL_SPACT_TOUCH_OF_HUNGER) = lang("飢餓の手", "Touch of Hunger")
-	skilldesc(SKILL_SPACT_TOUCH_OF_HUNGER) = lang("飢餓攻撃", "Starve target")
+	skilldesc(SKILL_SPACT_TOUCH_OF_HUNGER) = lang("無属性攻撃＋飢餓の呪い", "Starve target")
 	if ( 614 < 600 ) {
 		skillencdesc(SKILL_SPACT_TOUCH_OF_HUNGER) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_TOUCH_OF_POISON) = SKILL_ATTR_DEX, SKILL_TYPE_HAND, 5, TARGET_TYPE_DIRECTION, 0
 	skillname(SKILL_SPACT_TOUCH_OF_POISON) = lang("毒の手", "Touch of Poison")
-	skilldesc(SKILL_SPACT_TOUCH_OF_POISON) = lang("毒攻撃", "Poison target")
+	skilldesc(SKILL_SPACT_TOUCH_OF_POISON) = lang("無属性攻撃＋毒付与", "Poison target")
 	if ( 615 < 600 ) {
 		skillencdesc(SKILL_SPACT_TOUCH_OF_POISON) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_TOUCH_OF_NERVE) = SKILL_ATTR_DEX, SKILL_TYPE_HAND, 5, TARGET_TYPE_DIRECTION, 0
-	skillname(SKILL_SPACT_TOUCH_OF_NERVE) = lang("麻痺の手", "Touch of Nerve")
-	skilldesc(SKILL_SPACT_TOUCH_OF_NERVE) = lang("神経攻撃", "Paralyze target")
+	skillname(SKILL_SPACT_TOUCH_OF_NERVE) = lang("麻痺の手", "Touch of Paralyze")
+	skilldesc(SKILL_SPACT_TOUCH_OF_NERVE) = lang("無属性攻撃＋麻痺付与", "Paralyze target")
 	if ( 616 < 600 ) {
 		skillencdesc(SKILL_SPACT_TOUCH_OF_NERVE) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_TOUCH_OF_FEAR) = SKILL_ATTR_WIL, SKILL_TYPE_HAND, 5, TARGET_TYPE_DIRECTION, 0
 	skillname(SKILL_SPACT_TOUCH_OF_FEAR) = lang("恐怖の手", "Touch of Fear")
-	skilldesc(SKILL_SPACT_TOUCH_OF_FEAR) = lang("無属性攻撃", "Fear target")
+	skilldesc(SKILL_SPACT_TOUCH_OF_FEAR) = lang("無属性攻撃＋恐怖付与", "Fear target")
 	if ( 617 < 600 ) {
 		skillencdesc(SKILL_SPACT_TOUCH_OF_FEAR) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_TOUCH_OF_SLEEP) = SKILL_ATTR_WIL, SKILL_TYPE_HAND, 5, TARGET_TYPE_DIRECTION, 0
 	skillname(SKILL_SPACT_TOUCH_OF_SLEEP) = lang("眠りの手", "Touch of Sleep")
-	skilldesc(SKILL_SPACT_TOUCH_OF_SLEEP) = lang("精神攻撃", "Sleep target")
+	skilldesc(SKILL_SPACT_TOUCH_OF_SLEEP) = lang("無属性攻撃＋睡眠付与", "Sleep target")
 	if ( 618 < 600 ) {
 		skillencdesc(SKILL_SPACT_TOUCH_OF_SLEEP) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_DISPATCH_FLYING_BEAST) = SKILL_ATTR_DEX, SKILL_TYPE_TELEPORT, 5, TARGET_TYPE_DIRECTION, 0
 	skillname(SKILL_SPACT_DISPATCH_FLYING_BEAST) = lang("飛獣送り", "Send throw")
@@ -3079,10 +3079,16 @@
 	skillname(SKILL_SPACT_DIFFUSION_WAVE) = lang("魔儀迦", "Diffusion Wave")
 	skilldesc(SKILL_SPACT_DIFFUSION_WAVE) = lang("HPMP回復長射程攻撃/ゲージ100％消費", "Attack and heal")
 	if ( 718 < 600 ) {
 		skillencdesc(SKILL_SPACT_DIFFUSION_WAVE) = lang("", "")
 	}
+	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_GOD_CHARGE_ROD) = SKILL_ATTR_MAG, SKILL_TYPE_SP, 30, 2000 + 15, 0
+	skillname(SKILL_SPACT_GOD_CHARGE_ROD) = lang("神填の杖", "God charge Rod")
+	skilldesc(SKILL_SPACT_GOD_CHARGE_ROD) = lang("充填用魔力+10/攻撃/ゲージ100％消費", "Attack and get recharge power")
+	if ( 855 < 600 ) {
+		skillencdesc(SKILL_SPACT_GOD_CHARGE_ROD) = lang("", "")
+	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_MANA_SLASH) = SKILL_ATTR_DEX, SKILL_TYPE_SP, 30, TARGET_TYPE_ENEMY, 0
 	skillname(SKILL_SPACT_MANA_SLASH) = lang("魔刃狩り", "Mana slash")
 	skilldesc(SKILL_SPACT_MANA_SLASH) = lang("敵のMPにもダメージ/ゲージ100％消費", "Kill target")
 	if ( 731 < 600 ) {
 		skillencdesc(SKILL_SPACT_MANA_SLASH) = lang("", "")
@@ -4497,83 +4503,83 @@
 	if ( calcskill_skillid == SKILL_SPACT_FIRE_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_FIRE, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_FIRE
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_FIRE, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_COLD_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_COLD, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_COLD
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_COLD, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_LIGHTNING_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_LIGHTNING, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_LIGHTNING
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_LIGHTNING, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_DARKNESS_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_DARKNESS, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_DARKNESS
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_DARKNESS, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_CHAOS_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_CHAOS, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_CHAOS
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_CHAOS, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_NETHER_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_NETHER, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_NETHER
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_NETHER, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_POISON_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_POISON, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_POISON
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_POISON, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_SOUND_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_SOUND, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_SOUND
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_SOUND, calcskill_charid), 200, 2000) / 2
+		elep = 15 + locvar_calcskill_rs * 2
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_NERVE_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_NERVE, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_NERVE
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_NERVE, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_MIND_BREATH ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 2 + locvar_calcskill_rs / 10 + limit(sdata(SKILL_RES_MIND, calcskill_charid) - 400, 1, locvar_calcskill_rs * 2) / 20 + 1
 		bonus = locvar_calcskill_rs / 20
 		ele = SKILL_RES_MIND
-		elep = limit(locvar_calcskill_rs + sdata(SKILL_RES_MIND, calcskill_charid), 200, 2000) / 2
+		elep = 150 + locvar_calcskill_rs * 21
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_ACID_HURRICANE ) {
 		dice1 = 1 + locvar_calcskill_rs / 30
 		dice2 = 2 + locvar_calcskill_rs / 30 + 1
@@ -4591,47 +4597,45 @@
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_TOUCH_OF_WEAKNESS ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 3 + 1
-		bonus = ep == 0
-		return 1
-		ele = SKILL_NONE
-		elep = 0
+		bonus = 0
+		ele = SKILL_RESDMG_CONSTITUTION
+		elep = 100
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_TOUCH_OF_HUNGER ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 3 + 1
-		bonus = ep == 0
-		return 1
-		ele = SKILL_NONE
-		elep = 0
+		bonus = 0
+		ele = SKILL_RESDMG_CONSTITUTION
+		elep = 100
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_TOUCH_OF_FEAR ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 3 + 1
 		bonus = 0
-		ele = SKILL_NONE
-		elep = 100 + locvar_calcskill_rs * 2
+		ele = SKILL_RESDMG_CONSTITUTION
+		elep = 150 + locvar_calcskill_rs * 24
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_TOUCH_OF_SLEEP ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
 		dice2 = 3 + 1
 		bonus = 0
-		ele = SKILL_NONE
-		elep = 100 + locvar_calcskill_rs * 3
+		ele = SKILL_RESDMG_CONSTITUTION
+		elep = 150 + locvar_calcskill_rs * 24
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_TOUCH_OF_POISON ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
-		dice2 = 4 + 1
+		dice2 = 3 + 1
 		bonus = 0
-		ele = SKILL_RES_POISON
-		elep = locvar_calcskill_rs * 4 + 20
+		ele = SKILL_RESDMG_CONSTITUTION
+		elep = 150 + locvar_calcskill_rs * 24
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_MEMORY_POISON ) {
 		dice1 = 1 + locvar_calcskill_rs / 5
 		dice2 = 2 + locvar_calcskill_rs / 10 + 1
@@ -4640,14 +4644,14 @@
 		elep = 100
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_TOUCH_OF_NERVE ) {
 		dice1 = 1 + locvar_calcskill_rs / 10
-		dice2 = 4 + 1
+		dice2 = 3 + 1
 		bonus = 0
-		ele = SKILL_RES_NERVE
-		elep = locvar_calcskill_rs * 4 + 20
+		ele = SKILL_RESDMG_CONSTITUTION
+		elep = 150 + locvar_calcskill_rs * 24
 		return 1
 	}
 	if ( calcskill_skillid == SKILL_SPACT_EYE_OF_INSANITY ) {
 		dice1 = 1 + locvar_calcskill_rs / 20
 		dice2 = 10 + 1
@@ -10991,10 +10995,72 @@
 			s(cnt) = lang("特選ハーブ８ダース・・・・・・5万ヤカポイント", "Assorted herbs 8 dozen <50000 yaca points>")
 		}
 	loop
 	return
 
+#deffunc txtsetwpoint int txtsetwpoint_count
+	repeat 9
+		i = cnt
+		p(cnt) = p(i)
+		p(i) = cnt
+	loop
+	repeat txtsetwpoint_count
+		if ( p(cnt) == 0 ) {
+			s(cnt) = lang("キャンセル", "Cancel")
+		}
+		if ( p(cnt) == 1 ) {
+			s(cnt) = lang("浮遊檻３個・・・・・・・・・・・200労働エナジー", "3 float cage <200 Toil-Energy>")
+		}
+		if ( p(cnt) == 2 ) {
+			s(cnt) = lang("奴隷グルグル＆奴隷バタバタ・・・300労働エナジー", "slave spinner and wheel <300 Toil-Energy>")
+		}
+		if ( p(cnt) == 3 ) {
+			s(cnt) = lang("染料１０種・・・・・・・・・・・600労働エナジー", "10types dye <600 Toil-Energy>")
+		}
+		if ( p(cnt) == 4 ) {
+			s(cnt) = lang("音楽ディスク１０種・・・・・・・1000労働エナジー", "10types musicdisc <1000 Toil-Energy>")
+		}
+		if ( p(cnt) == 5 ) {
+			s(cnt) = lang("スピリチウム１０種・・・・・・・1500労働エナジー", "10types spiritium <1500 Toil-Energy>")
+		}
+		if ( p(cnt) == 6 ) {
+			s(cnt) = lang("Suエクステンダー２種・・・・・・2000労働エナジー", "SurvivabilityEXtenderXandY <2000 Toil-Energy>")
+		}
+		if ( p(cnt) == 7 ) {
+			s(cnt) = lang("水２服・・・・・・・・・・・・・3000労働エナジー", "2 water <3000 Toil-Energy>")
+		}
+		if ( p(cnt) == 8 ) {
+			s(cnt) = lang("カジノチップ１０枚・・・・・・・1万労働エナジー", "10 Casino chips <10000 Toil-Energy>")
+		}
+	loop
+	return
+
+#deffunc txtsetwlevel int txtsetwlevel_count
+	repeat 5
+		i = cnt
+		p(cnt) = p(i)
+		p(i) = cnt
+	loop
+	repeat txtsetwlevel_count
+		if ( p(cnt) == 0 ) {
+			s(cnt) = lang("キャンセル", "Cancel")
+		}
+		if ( p(cnt) == 1 ) {
+			s(cnt) = lang("強度０：収容者の自主性に任せる", "<Level 0> each individual's autonomy")
+		}
+		if ( p(cnt) == 2 ) {
+			s(cnt) = lang("強度１：時々休ませながら労働させる", "<Level 1> work with occasional breaks")
+		}
+		if ( p(cnt) == 3 ) {
+			s(cnt) = lang("強度２：ほとんど休ませずに労働させる", "<Level 2> work with almost no rest")
+		}
+		if ( p(cnt) == 4 ) {
+			s(cnt) = lang("強度３：使い潰すつもりで労働させる", "<Level 3> work like they're dying")
+		}
+	loop
+	return
+
 #deffunc txtsetabyss int txtsetabyss_arg1
 	repeat 10
 		i = cnt
 		p(cnt) = p(i)
 		p(i) = cnt
@@ -11530,10 +11596,13 @@
 		s = lang("コロシアム", "Pet Arena")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_MUSEUM ) {
 		s = lang("博物館", "My Museum")
 	}
+	if ( adata(ADATA_ID, mapname_mapid) == AREA_CAMP ) {
+		s = lang("収容所", "Camp")
+	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_SHOP ) {
 		s = lang("店", "Shop")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_CROP ) {
 		s = lang("畑", "Crop")
@@ -11597,14 +11666,14 @@
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_MINOTAUR_NEST ) {
 		s = lang("ﾐﾉﾀｳﾛｽの巣", "the Minotaur's Nest")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_JAIL ) {
-		s = lang("牢獄", "Jail"), lang("収容所がある。入り口は固く閉ざされている。", "You see a prison. The entrance is strictly closed.")
+		s = lang("牢獄", "Prison"), lang("牢獄がある。入り口は固く閉ざされている。", "You see a prison. The entrance is strictly closed.")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_JAIL2 ) {
-		s = lang("牢獄", "Jail"), lang("収容所がある。入り口は固く閉ざされている。", "You see a prison. The entrance is strictly closed.")
+		s = lang("牢獄", "Prison"), lang("牢獄がある。入り口は固く閉ざされている。", "You see a prison. The entrance is strictly closed.")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_NT_SOUTH_BORDER ) {
 		s = lang("ティリス関所北側", "North Tyris south border")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_SOUTH_TYRIS ) {
@@ -16864,10 +16933,14 @@
 		}
 		if ( cdata(CDATA_ID, tc) == CREATURE_ID_DETECTIVE | cdata(CDATA_ID, tc) == CREATURE_ID_WEREWOLF_DETECTIVE ) {
 			p = instr(buff, 0, "%DETECTIVE," + lang("JP", "EN"))
 			break
 		}
+		if ( cbit(CHARA_BIT_LABOR_CAMP, tc) == TRUE & gdata(GDATA_AREA) != AREA_SHOW_HOUSE & cdata(CDATA_MASTER_SERVANT, tc) < 100 ) {
+			p = instr(buff, 0, "%INMATE," + lang("JP", "EN"))
+			break
+		}
 		if ( gdata(GDATA_AREA) == AREA_WAR_GROUND ) {
 			p = instr(buff, 0, "%SENTI," + lang("JP", "EN"))
 			break
 		}
 		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SILVER_WOLF | cdata(CDATA_ID, tc) == CREATURE_ID_TWINTAIL ) {
@@ -20224,11 +20297,11 @@
 		goto *exit_game
 	}
 	else {
 		errorhack++
 	}
-	buf = "HspError " + wparam + " WinError " + GetLastError() + " Ver " + int(double("6.20") * 1000) + " Mode " + mode + "\n"
+	buf = "HspError " + wparam + " WinError " + GetLastError() + " Ver " + int(double("6.22") * 1000) + " Mode " + mode + "\n"
 	buf += "efId " + efid + " efP " + efp + " Area " + gdata(GDATA_AREA) + "/" + gdata(GDATA_LEVEL) + "\n"
 	buf += "ci "
 	if ( ci < 200 ) {
 		buf += "0"
 		if ( ci >= 0 ) {
@@ -20364,11 +20437,13 @@
 	}
 	else {
 		exec exedir + "error.txt", 16
 	}
 	goto *exit_game
-	goto *label_0466
+	goto *label_0472
+
+
 
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/item.hsp ../2.20-borscht/item.hsp
--- ../2.19R-borscht/item.hsp	2023-08-08 08:52:07.440661700 +0800
+++ ../2.20-borscht/item.hsp	2023-10-08 12:53:01.790486200 +0800
@@ -93,11 +93,11 @@
 	isetplantherbf = ITEM_ID_STOMAFILLIA, ITEM_ID_CURARIA, ITEM_ID_MORGIA
 	isetdrinkinn = ITEM_ID_COFFEE, ITEM_ID_COLA, ITEM_ID_BARLEY_TEA, ITEM_ID_GREEN_TEA, ITEM_ID_BLACK_TEA, ITEM_ID_JUICE
 	fsetremain = FILTER_AMMO, FILTER_ITEM_FOOD, FILTER_ITEM_FOOD, FILTER_ORE, FILTER_ITEM_SCROLL, FILTER_ITEM_POTION, FILTER_ITEM_FOOD
 	fsetbarrel = FILTER_AMMO, FILTER_ITEM_FOOD, FILTER_ITEM_SCROLL, FILTER_ITEM_POTION, FILTER_ORE, FILTER_JUNK
 	fsetcollect = FILTER_JUNK, FILTER_FURNITURE, FILTER_ITEM_FOOD, FILTER_ORE
-	isetdeed = ITEM_ID_DEED, ITEM_ID_DEED_MUSEUM, ITEM_ID_DEED_SHOP, ITEM_ID_DEED_FARM, ITEM_ID_DEED_STORAGE_HOUSE, ITEM_ID_SHELTER, ITEM_ID_DEED_RANCH, ITEM_ID_DEED_OF_LAND_BATTLESHIP, ITEM_ID_DEED_OF_MAGIC_LOCOMOTIVE, ITEM_ID_DEED_OF_TRUCK, ITEM_ID_DEED_OF_CARRIAGE, ITEM_ID_DEED_OF_HUGE_RAFT, ITEM_ID_DEED_OF_FISHING_SHIP, ITEM_ID_DEED_OF_PIRATE_SHIP, ITEM_ID_DEED_OF_CRUISE_SHIP, ITEM_ID_DEED_OF_WARSHIP, ITEM_ID_DEED_OF_SUBMARINE
+	isetdeed = ITEM_ID_DEED, ITEM_ID_DEED_MUSEUM, ITEM_ID_DEED_SHOP, ITEM_ID_DEED_FARM, ITEM_ID_DEED_STORAGE_HOUSE, ITEM_ID_SHELTER, ITEM_ID_DEED_RANCH, ITEM_ID_DEED_CAMP, ITEM_ID_DEED_OF_LAND_BATTLESHIP, ITEM_ID_DEED_OF_MAGIC_LOCOMOTIVE, ITEM_ID_DEED_OF_TRUCK, ITEM_ID_DEED_OF_CARRIAGE, ITEM_ID_DEED_OF_HUGE_RAFT, ITEM_ID_DEED_OF_FISHING_SHIP, ITEM_ID_DEED_OF_PIRATE_SHIP, ITEM_ID_DEED_OF_CRUISE_SHIP, ITEM_ID_DEED_OF_WARSHIP, ITEM_ID_DEED_OF_SUBMARINE
 	isetfruit = ITEM_ID_APPLE, ITEM_ID_GRAPE, ITEM_ID_TANGERINE, ITEM_ID_LEMON, ITEM_ID_STRAWBERRY, ITEM_ID_CHERRY, ITEM_ID_KAKI
 	isetthrowpotionminor = ITEM_ID_POTION_BLINDNESS, ITEM_ID_POTION_CONFUSION, ITEM_ID_SLEEPING_DRUG, ITEM_ID_POTION_PARALYSIS, ITEM_ID_POISON, ITEM_ID_POTION_CALAMITY
 	isetthrowpotionmajor = ITEM_ID_POTION_SLOW, ITEM_ID_POTION_SILENCE, ITEM_ID_POTION_WEAKEN_RESISTANCE, ITEM_ID_POTION_AGONY, ITEM_ID_POTION_WEAKNESS
 	isetthrowpotiongreater = ITEM_ID_BOTTLE_SULFURIC, ITEM_ID_LOVE_POTION, ITEM_ID_GASOLINE, ITEM_ID_POTION_CALAMITY, ITEM_ID_POTION_AGONY, ITEM_ID_POTION_AQUA_SANCTIO
 	isethire = ITEM_ID_BOTTLE_WHISKY, ITEM_ID_POTION_CURE_CRITICAL_WOUND, ITEM_ID_POTION_HEALER_ODINA, ITEM_ID_RAW_EMERALD_ORE, ITEM_ID_POTION_CURE_MAJOR_WOUND, ITEM_ID_POTION_SACRED_HEALER_JURE, ITEM_ID_LONG_SWORD, ITEM_ID_LONG_SWORD, ITEM_ID_LONG_SWORD
@@ -972,59 +972,59 @@
 					inv(INV_ITEM_LEVEL, ci) += cdata(CDATA_BRUSH_LEVEL, rc)
 				}
 				if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_AMUR_CAGE ) {
 					inv(INV_ITEM_AMUR_CAGE, ci) = 1
 				}
-				inv(INV_ITEM_SHOP_SAMPLE, ci) = 0
+				inv(INV_ITEM_PARTS, ci) = 0
 				repeat 30, 100
 					p = cdata(cnt, rc) / EXT_EQUIP_SLOTS
 					if ( p == 0 ) {
 						break
 					}
 					if ( p == 1 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 1 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 1
+						if ( inv(INV_ITEM_PARTS, ci) < 1 ) {
+							inv(INV_ITEM_PARTS, ci) += 1
 						}
 					}
 					if ( p == 2 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 10 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 10
+						if ( inv(INV_ITEM_PARTS, ci) < 10 ) {
+							inv(INV_ITEM_PARTS, ci) += 10
 						}
 					}
 					if ( p == 3 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 100 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 100
+						if ( inv(INV_ITEM_PARTS, ci) < 100 ) {
+							inv(INV_ITEM_PARTS, ci) += 100
 						}
 					}
 					if ( p == 4 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 1000 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 1000
+						if ( inv(INV_ITEM_PARTS, ci) < 1000 ) {
+							inv(INV_ITEM_PARTS, ci) += 1000
 						}
 					}
 					if ( p == 5 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 10000 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 10000
+						if ( inv(INV_ITEM_PARTS, ci) < 10000 ) {
+							inv(INV_ITEM_PARTS, ci) += 10000
 						}
 					}
 					if ( p == 6 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 100000 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 100000
+						if ( inv(INV_ITEM_PARTS, ci) < 100000 ) {
+							inv(INV_ITEM_PARTS, ci) += 100000
 						}
 					}
 					if ( p == 7 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 1000000 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 1000000
+						if ( inv(INV_ITEM_PARTS, ci) < 1000000 ) {
+							inv(INV_ITEM_PARTS, ci) += 1000000
 						}
 					}
 					if ( p == 8 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 10000000 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 10000000
+						if ( inv(INV_ITEM_PARTS, ci) < 10000000 ) {
+							inv(INV_ITEM_PARTS, ci) += 10000000
 						}
 					}
 					if ( p == 9 ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, ci) < 100000000 ) {
-							inv(INV_ITEM_SHOP_SAMPLE, ci) += 100000000
+						if ( inv(INV_ITEM_PARTS, ci) < 100000000 ) {
+							inv(INV_ITEM_PARTS, ci) += 100000000
 						}
 					}
 				loop
 				remain_make ci, rc
 				if ( stat != 0 ) {
@@ -1425,11 +1425,11 @@
 		if ( rnd(60) == 0 ) {
 			flt
 			itemcreate -1, ITEM_ID_SCROLL_NAME, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
 	}
-	if ( cdata(CDATA_ID, rc) == CREATURE_ID_ROGUE_BOSS ) {
+	if ( cdata(CDATA_ID, rc) == CREATURE_ID_ROGUE_BOSS | cdata(CDATA_ID, rc) == CREATURE_ID_INSTIGATOR_OF_ELEA ) {
 		repeat 2 + rnd(4)
 			flt cdata(CDATA_LEVEL, rc), FIX_QUALITY_GOOD
 			flttypemajor = FILTER_CARGO_TRADE
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 			if ( inv(INV_ITEM_VALUE, ci) < 800 ) {
@@ -4189,24 +4189,24 @@
 				addbuff cc, 20 + (enc - 10), (inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 50 + 1) * 5 * (1 + (cc != CHARA_PLAYER) * 2), 2000
 				continue
 			}
 		}
 	loop
-	if ( cdata(CDATA_SP_EARNED, cc) <= (-2000000) & cdata(CDATA_SP_EARNED, cc) > (-12000000) ) {
-		cdata(CDATA_SP_EARNED, cc) -= limit(nutrition / 1000, 1, 5) * 100000
+	if ( cdata(CDATA_PREGNANCY_PROGRESS, cc) <= (-2000000) & cdata(CDATA_PREGNANCY_PROGRESS, cc) > (-12000000) ) {
+		cdata(CDATA_PREGNANCY_PROGRESS, cc) -= limit(nutrition / 1000, 1, 5) * 100000
 		if ( 0 ) {
-			cdata(CDATA_SP_EARNED, cc) -= 50 * 100000
+			cdata(CDATA_PREGNANCY_PROGRESS, cc) -= 50 * 100000
 		}
-		sintyoku = (cdata(CDATA_SP_EARNED, cc) + 2000000) * (-1) / 100000
+		sintyoku = (cdata(CDATA_PREGNANCY_PROGRESS, cc) + 2000000) * (-1) / 100000
 		if ( 0 ) {
-			txt lang("満腹" + nutrition + "でステージ" + cdata(CDATA_SP_EARNED, cc) + "。", name(cc) + " get genes of " + _s(cc) + ".")
+			txt lang("満腹" + nutrition + "でステージ" + cdata(CDATA_PREGNANCY_PROGRESS, cc) + "。", name(cc) + " get genes of " + _s(cc) + ".")
 		}
-		if ( cdata(CDATA_SP_EARNED, cc) > (-12000000) ) {
+		if ( cdata(CDATA_PREGNANCY_PROGRESS, cc) > (-12000000) ) {
 			txtef COLOR_YELLOW
 			txt lang("[フェイズ2進捗率：" + sintyoku + "％]", "[Phase 2 progress " + sintyoku + " %]")
 		}
-		if ( cdata(CDATA_SP_EARNED, cc) <= (-12000000) ) {
+		if ( cdata(CDATA_PREGNANCY_PROGRESS, cc) <= (-12000000) ) {
 			snd SOUNDLIST_DING1
 			txtef COLOR_GREEN
 			txt lang("[HAPPY BIRTHDAY！！]　フェイズ2が完了した。", "[HAPPY BIRTHDAY!!] Phase 2 completed.")
 			ccbk = cc
 			evadd EVENT_BIRTH
@@ -4454,11 +4454,11 @@
 	tc = cc
 	gosub *alien_effect
 	return
 
 *alien_effect
-	if ( cdata(CDATA_SP_EARNED, tc) <= (-1000000) ) {
+	if ( cdata(CDATA_PREGNANCY_PROGRESS, tc) <= (-1000000) ) {
 		if ( synccheck(tc, -1) ) {
 			txt lang("しかしすぐに分解された。", "But it was immediately turned into fetus nutrients.")
 		}
 		ninsin = 0
 		return
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/item_func.hsp ../2.20-borscht/item_func.hsp
--- ../2.19R-borscht/item_func.hsp	2023-08-08 08:52:07.507482800 +0800
+++ ../2.20-borscht/item_func.hsp	2023-10-08 12:53:01.843374800 +0800
@@ -838,38 +838,38 @@
 			locvar_itemowner_s += lang("コボルード", "-Kobolord")
 		}
 		if ( inv(INV_ITEM_PARAM3, itemowner_itemid) / 100 == 25 ) {
 			locvar_itemowner_s += lang("ヘラクレスト", "-Hercurest")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 50 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 50 ) {
 			locvar_itemowner_s += lang("Ｆ", " F")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 51 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 51 ) {
 			locvar_itemowner_s += lang("Ｉ", " I")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 52 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 52 ) {
 			locvar_itemowner_s += lang("Ｌ", " L")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 53 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 53 ) {
 			locvar_itemowner_s += lang("Ｄ", " D")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 54 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 54 ) {
 			locvar_itemowner_s += lang("Ｍ", " M")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 55 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 55 ) {
 			locvar_itemowner_s += lang("Ｐ", " P")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 56 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 56 ) {
 			locvar_itemowner_s += lang("Ｈ", " H")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 57 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 57 ) {
 			locvar_itemowner_s += lang("Ｓ", " S")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 58 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 58 ) {
 			locvar_itemowner_s += lang("Ｎ", " N")
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 59 ) {
+		if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 59 ) {
 			locvar_itemowner_s += lang("Ｃ", " C")
 		}
 		if ( inv(INV_ITEM_AMUR_CAGE, itemowner_itemid) > 0 ) {
 			locvar_itemowner_s += lang("Ｘ", "X")
 		}
@@ -1012,35 +1012,35 @@
 						if ( jp ) {
 							locvar_itemowner_s += "の"
 						}
 					}
 					if ( inv(INV_ITEM_ID, itemowner_itemid) == ITEM_ID_NECRO_PARTS ) {
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 1 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 1 ) {
 							locvar_itemowner_s += lang("あたま", "head")
 						}
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 2 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 2 ) {
 							locvar_itemowner_s += lang("くび", "neck")
 						}
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 3 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 3 ) {
 							locvar_itemowner_s += lang("せなか", "back")
 						}
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 4 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 4 ) {
 							locvar_itemowner_s += lang("どうたい", "chest")
 						}
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 5 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 5 ) {
 							locvar_itemowner_s += lang("て", "hand")
 						}
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 6 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 6 ) {
 							locvar_itemowner_s += lang("ゆび", "finger")
 						}
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 7 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 7 ) {
 							locvar_itemowner_s += lang("うで", "arm")
 						}
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 8 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 8 ) {
 							locvar_itemowner_s += lang("こし", "waist")
 						}
-						if ( inv(INV_ITEM_SHOP_SAMPLE, itemowner_itemid) == 9 ) {
+						if ( inv(INV_ITEM_PARTS, itemowner_itemid) == 9 ) {
 							locvar_itemowner_s += lang("あし", "leg")
 						}
 					}
 				}
 			}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/main.hsp ../2.20-borscht/main.hsp
--- ../2.19R-borscht/main.hsp	2023-08-08 08:52:07.513466200 +0800
+++ ../2.20-borscht/main.hsp	2023-10-08 12:53:01.847360800 +0800
@@ -181,11 +181,11 @@
 	if ( dbg_randseed != 0 ) {
 		randseed = dbg_randseed
 	}
 	randomize randseed
 	exrand_randomize randseed
-	title "ElonaPlus 2.19R"
+	title "ElonaPlus 2.20fix1"
 	goto *system_init
 	goto *label_0003
 
 #deffunc netload str netload_filename
 	netrequest netload_filename
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/map.hsp ../2.20-borscht/map.hsp
--- ../2.19R-borscht/map.hsp	2023-08-08 08:52:07.665060500 +0800
+++ ../2.20-borscht/map.hsp	2023-10-08 12:53:01.980007000 +0800
@@ -519,10 +519,19 @@
 	}
 	repeat 245
 		if ( cnt != 0 ) {
 			cdata(CDATA_CAN_REVIVE, cnt) = 1
 		}
+		if ( cbit(CHARA_BIT_LIVESTOCK, cnt) != TRUE ) {
+			if ( cbit(CHARA_BIT_SHADOW_CLONE, cnt) == TRUE ) {
+				if ( cnt >= 16 ) {
+					if ( cbit(CHARA_BIT_NECRO, cnt) == TRUE ) {
+						chara_vanquish cnt
+					}
+				}
+			}
+		}
 		cdata(CDATA_FRIENDSHIP, CHARA_PLAYER) = 0
 		cbitmod CHARA_BIT_SHADOW_CLONE, cnt, FALSE
 		cbitmod CHARA_BIT_MAGNETISM_S_POLE, cnt, FALSE
 		cbitmod CHARA_BIT_MAGNETISM_N_POLE, cnt, FALSE
 		if ( gdata(GDATA_AREA) == AREA_WILDERNESS ) {
@@ -534,11 +543,11 @@
 		if ( cnt < 16 ) {
 			if ( cdata(CDATA_ROLE_SHOP_LEVEL, cnt) > 0 ) {
 				cdata(CDATA_POWER_GAUGE, cnt) = 3
 			}
 		}
-		cdata(CDATA_DRAIN_HP, cnt) = 0
+		cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cnt) = 0
 		gdata(GDATA_FLAG_MINEFIELD_QUEST_LEVEL) = 0
 		if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
 			continue
 		}
 		cdata(CDATA_CONDITION_GRAVITY, cnt) = 0
@@ -683,12 +692,12 @@
 			fmode = 3
 			gosub *game_ctrlFile
 			mode = MODELIST_MAIN
 		}
 	}
-	if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_SHOP & adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_RANCH ) {
-		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 0
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_SHOP & adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_RANCH & adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_CAMP ) {
+		adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 0
 	}
 	gdata(GDATA_AREA_PREV) = gdata(GDATA_AREA)
 	if ( gdata(GDATA_AREA_PREV) == 81 ) {
 		if ( gdata(GDATA_LEVEL) == 5 ) {
 			if ( gdata(GDATA_FLAG_SUB_KARAVIKA_OF_SONG_AND_DANCE) \ 3 == 0 ) {
@@ -1549,10 +1558,20 @@
 				cdata(CDATA_IN_TAGTEAM, cnt) = 0
 				refreshspeed cnt
 			}
 		loop
 	}
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CAMP ) {
+		map_initcustom "camp"
+		mdata(MDATA_MUSIC) = MUSICLIST_MCTOWN3
+		map_placeplayer
+		mdata(MDATA_WALL) = 0
+		flt
+		itemcreate -1, ITEM_ID_RED_BOOK, 22, 18, 0
+		inv(INV_ITEM_PARAM1, ci) = 32
+		mdata(MDATA_MAX_INV) = 100
+	}
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM ) {
 		map_initcustom "museum_1"
 		mdata(MDATA_MUSIC) = MUSICLIST_MCTOWN3
 		map_placeplayer
 		mdata(MDATA_WALL) = 0
@@ -3899,10 +3918,24 @@
 					flt
 					characreate -1, CREATURE_ID_BUG, -3, 0
 				loop
 			}
 		}
+		if ( encounter == ENCOUNTER_ELEA_REPARATION ) {
+			mdata(MDATA_MODERATE_CROWD) = 0
+			flt
+			initlv = encounterlv
+			characreate -1, CREATURE_ID_INSTIGATOR_OF_ELEA, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
+			repeat 6 + rnd(6)
+				flt
+				initlv = encounterlv + rnd(10)
+				characreate -1, 1082 + rnd(3), 14, 11
+				cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
+				cdata(CDATA_CHARACTER_TIER, rc) = CHARACTER_TIER_SUMMONED_NORMAL
+			loop
+			evadd EVENT_ELEA_REPARATION
+		}
 		if ( encounter == ENCOUNTER_ROGUE ) {
 			mdata(MDATA_MODERATE_CROWD) = 0
 			flt
 			initlv = encounterlv
 			characreate -1, CREATURE_ID_ROGUE_BOSS, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
@@ -4176,15 +4209,33 @@
 				if ( gdata(GDATA_FLAG_MAIN) < 340 ) {
 					evadd EVENT_MESHERA_PLANT
 					flt
 					characreate -1, CREATURE_ID_MESHERA_PLANT, 16, 5
 					cdata(CDATA_AI_CALM, rc) = 3
-					repeat 7
+					repeat 4
 						flt
 						characreate -1, CREATURE_ID_INFECTED_YERLES_SOLDIER, 16, 5
 						cdata(CDATA_AI_CALM, rc) = 3
 					loop
+					flt
+					characreate -1, CREATURE_ID_ANABOLIC_RESISTANCE, 16, 8
+					cdata(CDATA_AI_CALM, rc) = 4
+					cdata(CDATA_PIC, rc) = 1129 + 16 * 1000
+					cdata(CDATA_CHARA_PIC, rc) = xy2pic(1, 0)
+					cdatan(CDATAN_NAME, rc) = lang("メシェーラ・ギルク", "meshera Gilk")
+					flt
+					characreate -1, CREATURE_ID_ANABOLIC_RESISTANCE, 16, 8
+					cdata(CDATA_AI_CALM, rc) = 4
+					cdata(CDATA_PIC, rc) = 1129 + 17 * 1000
+					cdata(CDATA_CHARA_PIC, rc) = xy2pic(1, 0)
+					cdatan(CDATAN_NAME, rc) = lang("メシェーラ・エルマナ", "meshera Hermana")
+					flt
+					characreate -1, CREATURE_ID_ANABOLIC_RESISTANCE, 16, 8
+					cdata(CDATA_AI_CALM, rc) = 4
+					cdata(CDATA_PIC, rc) = 1129 + 19 * 1000
+					cdata(CDATA_CHARA_PIC, rc) = xy2pic(1, 0)
+					cdatan(CDATAN_NAME, rc) = lang("メシェーラ・ライモンド", "meshera Raimond")
 				}
 				procid = (procid + 1) \ 4
 				proclist(procid) = "Rehmido1" + " ct:" + ct
 				x = 16
 				y = 13
@@ -10595,21 +10646,35 @@
 				flt
 				initlv = encounterlv + 10
 				characreate -1, CREATURE_ID_ROGUE_BOSS, 29, 10
 				cdatan(CDATAN_NAME, rc) = lang("『海賊船長』", "<the pirate captain>")
 				cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
-				repeat 6 + rnd(6)
+				repeat 3 + rnd(3)
 					flt
 					initlv = encounterlv + rnd(10)
 					characreate -1, CREATURE_ID_PIRATE, 25, 10
 					cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
 					cdata(CDATA_CHARACTER_TIER, rc) = CHARACTER_TIER_SUMMONED_NORMAL
 				loop
-				repeat 6 + rnd(6)
+				repeat 3 + rnd(3)
 					flt
 					initlv = encounterlv + rnd(10)
-					characreate -1, CREATURE_ID_PIRATE, 15, 7
+					characreate -1, CREATURE_ID_PIRATE_MUSKETEER, 25, 10
+					cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
+					cdata(CDATA_CHARACTER_TIER, rc) = CHARACTER_TIER_SUMMONED_NORMAL
+				loop
+				repeat 3 + rnd(3)
+					flt
+					initlv = encounterlv + rnd(10)
+					characreate -1, CREATURE_ID_PIRATE_MUSKETEER, 15, 7
+					cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
+					cdata(CDATA_CHARACTER_TIER, rc) = CHARACTER_TIER_SUMMONED_NORMAL
+				loop
+				repeat 3 + rnd(3)
+					flt
+					initlv = encounterlv + rnd(10)
+					characreate -1, CREATURE_ID_ROUGH_PIRATE, 15, 7
 					cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
 					cdata(CDATA_CHARACTER_TIER, rc) = CHARACTER_TIER_SUMMONED_NORMAL
 				loop
 				gdatan(GDATAN_TEAM2) = random_title(2)
 				evadd EVENT_SHIP_PIRATE
@@ -10840,14 +10905,14 @@
 					}
 				}
 			}
 		loop
 	}
-	if ( adata(ADATA_EXTRA_MEDAL, gdata(GDATA_AREA)) == 0 & adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANDOM_DUNGEON ) {
-		adata(ADATA_EXTRA_MEDAL, gdata(GDATA_AREA)) = rnd(gdata(GDATA_LEVEL))
-		if ( adata(ADATA_EXTRA_MEDAL, gdata(GDATA_AREA)) < 50 ) {
-			adata(ADATA_EXTRA_MEDAL, gdata(GDATA_AREA)) = -1
+	if ( adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) == 0 & adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANDOM_DUNGEON ) {
+		adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) = rnd(gdata(GDATA_LEVEL))
+		if ( adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) < 50 ) {
+			adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) = -1
 		}
 	}
 	if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) != 0 ) {
 		if ( adata(ADATA_NEFIA_GEM_CHANCE, gdata(GDATA_AREA)) == 0 ) {
 			adata(ADATA_NEFIA_GEM_CHANCE, gdata(GDATA_AREA)) = rnd(gdata(GDATA_LEVEL))
@@ -12191,10 +12256,41 @@
 						if ( cbit(CHARA_BIT_SQUEEZED, cnt) == TRUE ) {
 							cbitmod CHARA_BIT_SQUEEZED, cnt, FALSE
 						}
 					loop
 				}
+				if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CAMP ) {
+					work = 0
+					cost = adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) * adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) * adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA))
+					repeat 245
+						if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+							continue
+						}
+						if ( cbit(CHARA_BIT_LABOR_CAMP, cnt) != TRUE ) {
+							continue
+						}
+						if ( cost > 0 ) {
+							work += cost * 2
+							if ( sorg(SKILL_ATTR_LIFE, cnt) <= cost ) {
+								evadd EVENT_SQUEEZE, cnt
+							}
+							else {
+								skillmod SKILL_ATTR_LIFE, cnt, -cost * 1000
+							}
+						}
+						if ( cdata(CDATA_MASTER_SERVANT, cnt) > 0 ) {
+							work += cdata(CDATA_MASTER_SERVANT, cnt) / 10 + 1
+						}
+					loop
+					adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) += work
+					if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) > 100000 ) {
+						adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 100000
+					}
+					txtmore
+					txtef COLOR_YELLOW2
+					txt lang("今回の労働エナジーの生産量は" + work + "のようだ。[現在の労働エナジー：" + adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) + "]", "It seems that " + work + " Toil-Energy has been produced. Current Toil-Energy is " + adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) + ".")
+				}
 				if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CROP ) {
 					repeat mdata(MDATA_HEIGHT)
 						y = cnt
 						repeat mdata(MDATA_WIDTH)
 							if ( map(cnt, y, MAP_TILE_ID) != xy2pic(0, 0) ) {
@@ -12338,10 +12434,13 @@
 		}
 		mdata(MDATA_RENEW) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + 120
 		if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CROP | gdata(GDATA_AREA) == AREA_HOME ) {
 			mdata(MDATA_RENEW) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + 24
 		}
+		if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CAMP ) {
+			mdata(MDATA_RENEW) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + 72
+		}
 	}
 	if ( gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 >= mdata(MDATA_RENEW_MINOR) ) {
 		procid = (procid + 1) \ 4
 		proclist(procid) = "renew_minor" + " ct:" + ct
 		if ( mdata(MDATA_RENEW_MINOR) == 0 ) {
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/map_user.hsp ../2.20-borscht/map_user.hsp
--- ../2.19R-borscht/map_user.hsp	2023-08-08 08:52:07.745874100 +0800
+++ ../2.20-borscht/map_user.hsp	2023-10-08 12:53:02.061761000 +0800
@@ -31,11 +31,11 @@
 	return
 
 *building_new
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
 		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
-			if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CROP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_STORAGE_HOUSE | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DISCARDED_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DUNGEON ) {
+			if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CROP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CAMP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_STORAGE_HOUSE | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DISCARDED_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DUNGEON ) {
 				item_separate ci
 				inv(INV_ITEM_PARAM2, ci) = gdata(GDATA_AREA)
 				txt lang("物件No" + inv(INV_ITEM_PARAM2, ci) + "を登録" + adata(ADATA_ARENA_WIN, gdata(GDATA_AREA)) + "した。", "You can only use it in the world map.")
 				adata(ADATA_ARENA_WIN, gdata(GDATA_AREA)) = -1
 				snd SOUNDLIST_ENC
@@ -179,10 +179,16 @@
 		adata(ADATA_ID, p) = AREA_MUSEUM
 		adata(ADATA_ICON, p) = xy2pic(19, 4)
 		adata(ADATA_FIELD, p) = 1
 		s = lang("博物館", "museum")
 	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_CAMP ) {
+		adata(ADATA_ID, p) = AREA_CAMP
+		adata(ADATA_ICON, p) = xy2pic(29, 4)
+		adata(ADATA_FIELD, p) = 1
+		s = lang("収容所", "camp")
+	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_SHOP ) {
 		adata(ADATA_ID, p) = AREA_SHOP
 		adata(ADATA_ICON, p) = xy2pic(18, 4)
 		adata(ADATA_FIELD, p) = 1
 		s = lang("店", "shop")
@@ -303,10 +309,14 @@
 	if ( mdata(MDATA_MAX_INV) != 0 ) {
 		p(2) = mdata(MDATA_MAX_INV)
 	}
 	txt lang(mapname(gdata(GDATA_AREA)) + "には" + p + "個のアイテムと" + p(1) + "個の家具がある(アイテム最大" + p(2) + "個) ", "There are " + p + " items and " + p(1) + " furniture in " + mapname(gdata(GDATA_AREA)) + ".(Max: " + p(2) + ") ")
 	txtmore
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CAMP ) {
+		txtef COLOR_YELLOW2
+		txt lang("現在の労働強度は" + adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) + "、溜まっている労働エナジーは" + adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) + "だ。", "Current Toil-Lv is " + adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) + ", Toil-Energy is " + adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) + ".")
+	}
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
 		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_GOODS ) {
 			shops = lang("何でも屋", "Goods shop")
 		}
 		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_FOOD ) {
@@ -326,17 +336,17 @@
 		}
 		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_JUNK ) {
 			shops = lang("ジャンク屋", "Junk shop")
 		}
 		txt lang("店タイプ：" + shops + "。", "Shop type : " + shops + ".")
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 0 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 0 ) {
 			txt lang("販売制限なし。", "Shop type : " + shops + ".")
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 1 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 1 ) {
 			txt lang("1日15品限定販売。", "15 items limited sale.")
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 2 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 2 ) {
 			txt lang("1日5品限定販売。", "5 items limited sale")
 		}
 		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
 			txt lang("現在の店主：" + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + " ", "Current shopkeeper is " + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + ".")
 		}
@@ -454,29 +464,39 @@
 		promptmax++
 		promptl(0, promptmax) = lang("餌を撒く（家畜の餌消費）", "Consume livestock feed"), "null", "" + 17
 		promptmax++
 		promptl(0, promptmax) = lang("場内消毒（浄化消毒薬消費）", "Consume disinfectant"), "null", "" + 18
 		promptmax++
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 0 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 0 ) {
 			promptl(0, promptmax) = lang("繁殖防止コード発動", "Activate breeding-prevent code"), "null", "" + 19
 			promptmax++
 		}
 		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) == 0 ) {
 			promptl(0, promptmax) = lang("生産防止コード発動", "Activate production-prevent code"), "null", "" + 20
 			promptmax++
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) != 0 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) != 0 ) {
 			promptl(0, promptmax) = lang("繁殖防止コード解除", "Cancel breeding-prevent code"), "null", "" + 21
 			promptmax++
 		}
 		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) != 0 ) {
 			promptl(0, promptmax) = lang("生産防止コード解除", "Cancel production-prevent code"), "null", "" + 22
 			promptmax++
 		}
 	}
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CAMP ) {
+		promptl(0, promptmax) = lang("檻から出して収容", "Removed from cage"), "null", "" + 24
+		promptmax++
+		promptl(0, promptmax) = lang("収容者の移動", "Move a inmate"), "null", "" + 3
+		promptmax++
+		promptl(0, promptmax) = lang("労働強度の変更", "Change Toil-Lv"), "null", "" + 25
+		promptmax++
+		promptl(0, promptmax) = lang("労働エナジー交換", "Exchange Toil-Energy"), "null", "" + 26
+		promptmax++
+	}
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DISCARDED_RANCH ) {
-		promptl(0, promptmax) = lang("ペットを放す", "release ally"), "null", "" + 8
+		promptl(0, promptmax) = lang("ペットを放す", "Release ally"), "null", "" + 8
 		promptmax++
 		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
 		promptmax++
 	}
 	if ( 0 ) {
@@ -574,11 +594,11 @@
 			else {
 				ibitmod ITEM_BIT_SHOP_SAMPLE, cnt, FALSE
 			}
 		loop
 		goto *turn_end
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 10 | _switch_sw ) {
 		_switch_sw = 0
 		txt lang(mdatan(0) + "を何と呼ぶ？ ", "What do you want to call " + mdatan(0) + "? ")
@@ -596,11 +616,11 @@
 			txt lang("" + mdatan(0) + "という名前で呼ぶことにした。", "You named " + him(tc) + " " + cdatan(CDATAN_NAME, tc) + ".")
 			gosub *screen_refreshFull
 		}
 		gosub *screen_refresh
 		goto *pc_turn
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 
 
 	if ( _switch_val == 2 | _switch_sw ) {
@@ -729,11 +749,11 @@
 		if ( key == key_cancel ) {
 			goto *com_home_WEND1
 		}
 		goto *com_home_WHILE1
 *com_home_WEND1
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 
 
 
@@ -741,24 +761,24 @@
 
 	if ( _switch_val == 3 | _switch_sw ) {
 		_switch_sw = 0
 *com_home_WHILE2
 		if ( 1 == 0 ) {
-			goto *com_home_WEND3
+			goto *com_home_WBREAK
 		}
 		txtnew
 		txt lang("誰を移動させる？", "Move who?")
 		allyctrl = 0
 		gosub *com_listNpc
 		if ( stat == (-1) ) {
-			goto *com_home_WEND3
+			goto *com_home_WBREAK
 		}
 		if ( cdata(CDATA_RELATION, stat) <= RELATION_ENEMY ) {
 			txtnew
 			txtef COLOR_SKY_BLUE
 			txt cdatan(CDATAN_NAME, stat) + lang("「触るな！」", " " + cnvtalk("Don't touch me!"))
-			goto *com_home_WEND3
+			goto *com_home_WBREAK
 		}
 		tchome = stat
 		tc = stat
 		snd SOUNDLIST_OK1
 *com_home_WHILE3
@@ -774,11 +794,11 @@
 		if ( chipm(CHIPM_ATTRIB, map(tlocx, tlocy, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS | map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
 			txt lang("その場所には移動させることができない。", "The location is invalid.")
 			tc = tchome
 			tlochomex = tlocx
 			tlochomey = tlocy
-			goto *com_home_SWEND1
+			goto *com_home_WEND3
 		}
 		tc = tchome
 		map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_CHARA_INDEX_PLUS_ONE) = 0
 		map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) = tc + 1
 		cdata(CDATA_X, tc) = tlocx
@@ -788,17 +808,17 @@
 		rowactend tc
 		txtnew
 		txt lang(cdatan(CDATAN_NAME, tc) + "を移動させた。", cdatan(CDATAN_NAME, tc) + " " + is(tc) + " moved to the location.")
 		snd SOUNDLIST_FOOT
 		goto *com_home_WEND2
-*com_home_SWEND1
+*com_home_WEND3
 		goto *com_home_WHILE3
 *com_home_WEND2
 		goto *com_home_WHILE2
-*com_home_WEND3
+*com_home_WBREAK
 		goto *turn_end
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 4 | _switch_sw ) {
 		_switch_sw = 0
 		allyctrl = 3
@@ -809,18 +829,18 @@
 			txtnew
 			if ( cdata(CDATA_IN_TAGTEAM, c) != 0 ) {
 				snd SOUNDLIST_FAIL1
 				txtef COLOR_RED
 				txt lang("タッグを解散する必要がある。", "It is need to dissolve the tag.")
-				goto *label_4676
+				goto *com_home_SWEND1
 			}
 			if ( getworker(gdata(GDATA_AREA), c) == c ) {
 				f = get_freeallyne()
 				if ( f == 0 ) {
 					snd SOUNDLIST_FAIL1
 					txt lang("仲間の最大数に達しているため、連れていけない。", "Your party is already full. You can't invite someone anymore.")
-					goto *label_4676
+					goto *com_home_SWEND1
 				}
 				if ( gdata(GDATA_AREA) == AREA_HOME ) {
 					cdata(CDATA_AREA, c) = 0
 					txt lang(cdatan(CDATAN_NAME, c) + "の滞在を取り消した。", cdatan(CDATAN_NAME, c) + " " + is(c) + " no longer staying at your home.")
 					cdata(CDATA_HOME, c) = 0
@@ -842,11 +862,11 @@
 					txt lang(cdatan(CDATAN_NAME, c) + "を任命した。", cdatan(CDATAN_NAME, c) + " take" + _s(c) + " charge of the job now.")
 				}
 				cdata(CDATA_AREA, c) = gdata(GDATA_AREA)
 			}
 		}
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 8 | _switch_sw ) {
 		_switch_sw = 0
 		pet = 0
@@ -856,11 +876,11 @@
 			}
 		loop
 		if ( pet >= 150 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("150体までしか放せない。", "You can not let go only 150 in this ranch.")
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		allyctrl = 3
 		gosub *com_ally
 		if ( stat != (-1) ) {
 			c = stat
@@ -869,11 +889,11 @@
 			cdata(CDATA_X_ORG, c) = cdata(CDATA_X, c)
 			cdata(CDATA_Y_ORG, c) = cdata(CDATA_Y, c)
 			if ( cbit(CHARA_BIT_BODYGUARD, c) != FALSE | cbit(CHARA_BIT_GUARD_TEMP, c) != FALSE ) {
 				snd SOUNDLIST_FAIL1
 				txt lang("護衛対象は放せない。", "You can not let go escort target in this ranch.")
-				goto *label_4676
+				goto *com_home_SWEND1
 			}
 			cbitmod CHARA_BIT_LIVESTOCK, c, TRUE
 			txt lang(cdatan(CDATAN_NAME, c) + "を放してやった。", cdatan(CDATAN_NAME, c) + " stay" + _s(c) + " at this ranch.")
 			if ( cbit(CHARA_BIT_PCC, c) == TRUE ) {
 				txtef COLOR_YELLOW
@@ -893,22 +913,22 @@
 			cdata(CDATA_ROLE, c) = ROLE_SPECIAL
 			if ( mdata(MDATA_MAX_INV) <= 80 ) {
 				mdata(MDATA_MAX_INV) = 400
 			}
 		}
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 17 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		item_find ITEM_ID_LIVESTOCK_FEED, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
 		if ( stat == (-1) ) {
 			snd SOUNDLIST_FAIL1
 			txtef COLOR_RED
 			txt lang("家畜の餌を持っていない。", "You need a livestock feed.")
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		else {
 			ci = stat
 			txt lang(itemname(ci, 1) + "を使う？", "Really use " + itemname(ci, 1) + "?")
 			promptl(0, 0) = stryes, "y", "0"
@@ -949,22 +969,22 @@
 				cdata(CDATA_EMO_ICON, cc) = 16 + 100 * 1
 				modimp2 cc, 15
 			loop
 		}
 		cc = ccbk
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 18 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		item_find ITEM_ID_DISINFECTANT, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
 		if ( stat == (-1) ) {
 			snd SOUNDLIST_FAIL1
 			txtef COLOR_RED
 			txt lang("浄化消毒薬を持っていない。", "You need a disinfectant.")
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		else {
 			ci = stat
 			txt lang(itemname(ci, 1) + "を使う？", "Really use " + itemname(ci, 1) + "?")
 			promptl(0, 0) = stryes, "y", "0"
@@ -1004,51 +1024,51 @@
 					addbuff cnt, BUFF_DISINFECTION, 50, 600
 				}
 				modimp cnt, 15
 			loop
 		}
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 19 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		snd SOUNDLIST_AMMO
 		txtef COLOR_RED
 		txt lang("この牧場では繁殖が行われない。", "This area will prevent breeding.")
-		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 10
-		goto *label_4676
+		adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 10
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 20 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		snd SOUNDLIST_AMMO
 		txtef COLOR_RED
 		txt lang("この牧場では生産が行われない。", "This area will prevent production.")
 		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = 10
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 21 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		snd SOUNDLIST_ENC
 		txtef COLOR_GREEN
 		txt lang("繁殖が通常通り行われるようになった。", "This area does not prevent breeding.")
-		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 0
-		goto *label_4676
+		adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 0
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 22 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		snd SOUNDLIST_ENC
 		txtef COLOR_GREEN
 		txt lang("生産が通常通り行われるようになった。", "This area does not prevent production.")
 		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = 0
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 23 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1061,11 +1081,11 @@
 		loop
 		val = promptx, prompty, 200, 1
 		gosub *prompt_key
 		if ( stat == 0 ) {
 			gosub *screen_draw
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		if ( rtval == 1 ) {
 			snd SOUNDLIST_ENC
 			repeat 400, 5080
 				if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
@@ -1080,11 +1100,230 @@
 				inv(INV_ITEM_Y, cnt) = cdata(CDATA_Y, CHARA_PLAYER)
 				cell_refresh bkx, bky
 			loop
 			cell_refresh cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
 		}
-		goto *label_4676
+		goto *com_home_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 24 | _switch_sw ) {
+		_switch_sw = 0
+		pet = 0
+		repeat 245
+			if ( cbit(CHARA_BIT_LABOR_CAMP, cnt) == TRUE ) {
+				pet++
+			}
+		loop
+		if ( pet >= 30 ) {
+			snd SOUNDLIST_FAIL1
+			txt lang("30体までしか収容できない。", "You can not placed only 150 in this camp.")
+			goto *com_home_SWEND1
+		}
+		allyctrl = 9
+		gosub *com_ally
+		if ( stat != (-1) ) {
+			c = stat
+			snd SOUNDLIST_OK1
+			txtnew
+			cdata(CDATA_X_ORG, c) = cdata(CDATA_X, c)
+			cdata(CDATA_Y_ORG, c) = cdata(CDATA_Y, c)
+			if ( cbit(CHARA_BIT_BODYGUARD, c) != FALSE | cbit(CHARA_BIT_GUARD_TEMP, c) != FALSE ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("護衛対象は放せない。", "You can not let go escort target in this ranch.")
+				goto *com_home_SWEND1
+			}
+			cbitmod CHARA_BIT_LOCKED_UP, c, FALSE
+			cbitmod CHARA_BIT_LABOR_CAMP, c, TRUE
+			flt
+			itemcreate -1, ITEM_ID_FLOAT_CAGE, cdata(CDATA_X, c), cdata(CDATA_Y, c), 0
+			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+			snd SOUNDLIST_ENC
+			txt lang(cdatan(CDATAN_NAME, c) + "を収容した。", cdatan(CDATAN_NAME, c) + " stay" + _s(c) + " at this camp.")
+			if ( cbit(CHARA_BIT_PCC, c) == TRUE ) {
+				txtef COLOR_YELLOW
+				txtmore
+				txt lang(cdatan(CDATAN_NAME, c) + "は元々の姿に着替えた。", cdatan(CDATAN_NAME, c) + " changed original cloth.")
+				cbitmod CHARA_BIT_PCC, c, FALSE
+			}
+			if ( cdata(CDATA_EXIST, c) != CHAR_STATE_DEAD ) {
+				if ( cdatan(CDATAN_RACE, c) == "servant" ) {
+					gdata(GDATA_ACTIVE_GOD_PETS)++
+				}
+			}
+			cdata(CDATA_AREA, c) = gdata(GDATA_AREA)
+			relocate_chara c, -1
+			cdata(CDATA_RELATION, c) = RELATION_DISLIKE
+			cdata(CDATA_RELATION_ORG, c) = RELATION_DISLIKE
+		}
+		goto *com_home_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 25 | _switch_sw ) {
+		_switch_sw = 0
+		txtsetwlevel 5
+		repeat 5
+			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
+			promptmax++
+		loop
+		val = promptx, prompty, 450, 1
+		gosub *prompt_key
+		if ( stat == 0 ) {
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		if ( rtval == 0 ) {
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		snd SOUNDLIST_ENC
+		if ( rtval == 1 ) {
+			adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) = 0
+		}
+		if ( rtval == 2 ) {
+			adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) = 1
+		}
+		if ( rtval == 3 ) {
+			adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) = 2
+		}
+		if ( rtval == 4 ) {
+			adata((38 /*!!!@[ADATA_EXTRA_MEDAL @@@ ADATA_LABOR_CAMP_TOIL_LEVEL]@!!! */), gdata(GDATA_AREA)) = 3
+		}
+		goto *com_home_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 26 | _switch_sw ) {
+		_switch_sw = 0
+		txtsetwpoint 9
+		repeat 9
+			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
+			promptmax++
+		loop
+		val = promptx, prompty, 450, 1
+		gosub *prompt_key
+		if ( stat == 0 ) {
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		if ( rtval == 0 ) {
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		snd SOUNDLIST_DING3
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) > 100000 ) {
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 100000
+		}
+		if ( 0 ) {
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 100000
+		}
+		if ( rtval == 1 ) {
+			if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) < 200 ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("労働エナジーが足りない…", "You don't have enough Toil-Energy...")
+				goto *com_home_SWEND1
+			}
+			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) -= 200
+			flt
+			itemcreate -1, ITEM_ID_FLOAT_CAGE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 3
+			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+		}
+		if ( rtval == 2 ) {
+			if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) < 300 ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("労働エナジーが足りない…", "You don't have enough Toil-Energy...")
+				goto *com_home_SWEND1
+			}
+			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) -= 300
+			flt
+			itemcreate -1, ITEM_ID_SLAVE_SPINNER, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+			flt
+			itemcreate -1, ITEM_ID_SLAVE_WHEEL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+		}
+		if ( rtval == 3 ) {
+			if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) < 600 ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("労働エナジーが足りない…", "You don't have enough Toil-Energy...")
+				goto *com_home_SWEND1
+			}
+			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) -= 600
+			repeat 10
+				flt
+				itemcreate -1, ITEM_ID_BOTTLE_DYE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+			loop
+		}
+		if ( rtval == 4 ) {
+			if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) < 1000 ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("労働エナジーが足りない…", "You don't have enough Toil-Energy...")
+				goto *com_home_SWEND1
+			}
+			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) -= 1000
+			repeat 10
+				flt
+				itemcreate -1, ITEM_ID_DISC, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+			loop
+		}
+		if ( rtval == 5 ) {
+			if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) < 1500 ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("労働エナジーが足りない…", "You don't have enough Toil-Energy...")
+				goto *com_home_SWEND1
+			}
+			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) -= 1500
+			repeat 10
+				flt
+				itemcreate -1, ITEM_ID_SPIRITIUM, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+				inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+			loop
+		}
+		if ( rtval == 6 ) {
+			if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) < 2000 ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("労働エナジーが足りない…", "You don't have enough Toil-Energy...")
+				goto *com_home_SWEND1
+			}
+			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) -= 2000
+			flt
+			itemcreate -1, ITEM_ID_SURVIVABILITY_EXTENDER_X, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+			flt
+			itemcreate -1, ITEM_ID_SURVIVABILITY_EXTENDER_Y, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+		}
+		if ( rtval == 7 ) {
+			if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) < 3000 ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("労働エナジーが足りない…", "You don't have enough Toil-Energy...")
+				goto *com_home_SWEND1
+			}
+			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) -= 3000
+			flt
+			itemcreate -1, ITEM_ID_BOTTLE_WATER, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 2
+			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+		}
+		if ( rtval == 8 ) {
+			if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) < 10000 ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("労働エナジーが足りない…", "You don't have enough Toil-Energy...")
+				goto *com_home_SWEND1
+			}
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) -= 10000
+			mat(1) += 10
+			txtef COLOR_YELLOW
+			txt lang("マテリアル:カジノチップを10個受け取った。", "You get 10 Casino chips.")
+		}
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 5 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1096,30 +1335,30 @@
 			cdata(CDATA_GOLD, CHARA_PLAYER) -= calcshopreform()
 			mdata(MDATA_MAX_INV) = limit(mdata(MDATA_MAX_INV) + 10, 1, 400)
 			txtef COLOR_GREEN
 			txt lang("店を拡張した！これからは" + mdata(MDATA_MAX_INV) + "個のアイテムを陳列できる。", "You extend your shop! You can display max of " + mdata(MDATA_MAX_INV) + " items now!")
 		}
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 11 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) > gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 ) {
 			txt lang("次に変更できるのは" + cnvdate(adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)), 1) + "だ。", "This Shop will be changeable again at " + cnvdate(adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)), 1) + ".")
 			snd SOUNDLIST_FAIL1
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		txtsetshop 8
 		repeat 8
 			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
 			promptmax++
 		loop
 		val = promptx, prompty, 350, 0
 		gosub *prompt_key
 		if ( rtval == 0 ) {
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + 24 * 15
 		adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) = rtval - 1
 		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_GOODS ) {
 			shops = lang("何でも屋", "Goods shop")
@@ -1143,11 +1382,11 @@
 			shops = lang("ジャンク屋", "Junk shop")
 		}
 		txtef COLOR_GREEN
 		txt lang("店種類変更：" + shops + "。", "Shop type changed: " + shops + ".")
 		snd SOUNDLIST_BUILD1
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 12 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1166,11 +1405,11 @@
 				goto *turn_end
 			}
 		}
 		txt lang("ブロンズ硬貨が足りない…", "You don't have enough bronze coin...")
 		snd SOUNDLIST_FAIL1
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 13 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1180,24 +1419,24 @@
 		}
 		if ( cdata(CDATA_SALES_FEATS, sc) == 0 ) {
 			if ( cdata(CDATA_SALES_EXP, sc) < 120 ) {
 				txt lang("営業実績が120は必要だ…。", cdatan(CDATAN_NAME, sc) + " don't have enough sales exp...")
 				snd SOUNDLIST_FAIL1
-				goto *label_4676
+				goto *com_home_SWEND1
 			}
 		}
 		if ( cdata(CDATA_SALES_FEATS, sc) == 1 ) {
 			if ( cdata(CDATA_SALES_EXP, sc) < 360 ) {
 				txt lang("営業実績が360は必要だ…。", cdatan(CDATAN_NAME, sc) + " don't have enough sales exp...")
 				snd SOUNDLIST_FAIL1
-				goto *label_4676
+				goto *com_home_SWEND1
 			}
 		}
 		if ( cdata(CDATA_SALES_FEATS, sc) >= 2 ) {
 			txt lang("これ以上は獲得できない。", cdatan(CDATAN_NAME, sc) + " can't get shopkeeper feat...")
 			snd SOUNDLIST_FAIL1
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		txtef COLOR_GREEN
 		txt lang(cdatan(CDATAN_NAME, sc) + "は営業で得た経験をもとにフィートを獲得できる！それは…", itemname(ci) + " sucked enough blood and ready to grow!")
 		txtsetshopfeat 6
 		repeat 6
@@ -1209,11 +1448,11 @@
 		shopval = rtval
 		txtnew
 		if ( shopval == 0 ) {
 			txtef COLOR_GREEN
 			txt lang(cdatan(CDATAN_NAME, sc) + "はずっこけた。", cdatan(CDATAN_NAME, sc) + " seems dissatisfied.")
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		if ( shopval > 0 & shopval <= 5 ) {
 			if ( shopval == 1 ) {
 				bitp = CHARA_BIT_SHOP_ELEGANCE
 			}
@@ -1231,22 +1470,22 @@
 			}
 			if ( cbit(bitp, sc) ) {
 				txtef COLOR_RED
 				txt lang(cdatan(CDATAN_NAME, sc) + "はそのフィートを既に持っている。", cdatan(CDATAN_NAME, sc) + " already has that feat.")
 				snd SOUNDLIST_FAIL1
-				goto *label_4676
+				goto *com_home_SWEND1
 			}
 			cbitmod bitp, sc, TRUE
 			if ( bitp == CHARA_BIT_SHOP_ELEGANCE ) {
 				skillmod SKILL_ATTR_CHA, sc, 30000
 			}
 			cdata(CDATA_SALES_FEATS, sc)++
 			snd SOUNDLIST_PRAY1
 			txtef COLOR_GREEN
 			txt lang(cdatan(CDATAN_NAME, sc) + "はフィートを獲得した。", cdatan(CDATAN_NAME, sc) + " got the new feat!")
 		}
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 14 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1256,21 +1495,21 @@
 			promptmax++
 		loop
 		val = promptx, prompty, 300, 0
 		gosub *prompt_key
 		if ( rtval == 0 ) {
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
-		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = rtval - 1
+		adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = rtval - 1
 		snd SOUNDLIST_BUILD1
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 15 | _switch_sw ) {
 		_switch_sw = 0
 		snd SOUNDLIST_FAIL1
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 7 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1305,11 +1544,11 @@
 			txtef COLOR_GREEN
 			txt lang("片開きの扉が生成されるようになった。", "You changed door to EW type.")
 		}
 		txtef COLOR_GREEN
 		txt lang("変更を完全に適用するにはマップに入りなおす必要がある。", "You have to enter map again to apply changes.")
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 16 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1344,11 +1583,11 @@
 			txtef COLOR_GREEN
 			txt lang("タイルグループをmap3に変更した。", "You changed tile group map3.")
 		}
 		txtef COLOR_GREEN
 		txt lang("変更を完全に適用するにはマップに入りなおす必要がある。", "You have to enter map again to apply changes.")
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 9 | _switch_sw ) {
 		_switch_sw = 0
 		if ( adata(ADATA_ICON, gdata(GDATA_AREA)) < xy2pic(0, 10) | adata(ADATA_ICON, gdata(GDATA_AREA)) > xy2pic(32, 10) ) {
@@ -1471,11 +1710,11 @@
 				snd SOUNDLIST_DING2
 				sekaikousin = 100
 			}
 		}
 		goto *pc_turn
-		goto *label_4676
+		goto *com_home_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 6 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1487,11 +1726,11 @@
 				}
 			}
 		loop
 		if ( p >= gdata(GDATA_HOME_LEVEL) + 2 ) {
 			txt lang("家はすでに人であふれかえっている。", "You already have too many guests in your home.")
-			goto *label_4676
+			goto *com_home_SWEND1
 		}
 		repeat 10
 			if ( 0 == 0 ) {
 				randomize gdata(GDATA_DAY) + cnt
 			}
@@ -1581,14 +1820,14 @@
 			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_TEMP ) {
 				chara_vanquish cnt
 			}
 		loop
 		calccosthire
-		goto *label_4676
+		goto *com_home_SWEND1
 	}
 
-*label_4676
+*com_home_SWEND1
 	tlocinitx = 0
 	tlocinity = 0
 	screenupdate = -1
 	gosub *screen_draw
 	goto *com_home
@@ -1722,11 +1961,11 @@
 			continue
 		}
 		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_ROD_WISHING ) {
 			continue
 		}
-		if ( inv(INV_ITEM_SHOP_SAMPLE, cnt) == 100 ) {
+		if ( inv(INV_ITEM_PARTS, cnt) == 100 ) {
 			continue
 		}
 		if ( ibit(ITEM_BIT_SHOP_SAMPLE, cnt) == TRUE ) {
 			continue
 		}
@@ -1851,16 +2090,16 @@
 			if ( rnd(2) ) {
 				continue
 			}
 		}
 		in = rnd(inv(INV_ITEM_NUM, ci)) + 1
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 1 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 1 ) {
 			if ( in + sold > 15 ) {
 				in = 15 - sold
 			}
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 2 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 2 ) {
 			if ( in + sold > 5 ) {
 				in = 5 - sold
 			}
 		}
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_PRODUCED_BOOK ) {
@@ -1895,16 +2134,16 @@
 				if ( cdata(CDATA_ITEM_USING, cnt) == ci ) {
 					rowactend cnt
 				}
 			loop
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 1 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 1 ) {
 			if ( sold >= 15 ) {
 				break
 			}
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 2 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 2 ) {
 			if ( sold >= 5 ) {
 				break
 			}
 		}
 	loop
@@ -2000,11 +2239,11 @@
 			snd SOUNDLIST_DING2
 			txtmore
 			txtef COLOR_YELLOW
 			txt lang("[店]" + customer + "人の来客があり、" + cdatan(CDATAN_NAME, worker) + "は" + sold + "個のアイテムを売却した。" + s + "が売り上げとして金庫に保管された。そして" + yaca + "ヤカポイントを獲得した。", "[Shop]" + customer + " customers visited your shop and " + cdatan(CDATAN_NAME, worker) + " sold " + sold + " items. " + cdatan(CDATAN_NAME, worker) + " put " + s + " in the shop strong box. You got " + yaca + " yaca points.")
 		}
-		skillexp SKILL_NORMAL_NEGOTIATION, worker, limit(int(sqrt(income)) * 10, 25, 2000) * (adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) + 2) / 2
+		skillexp SKILL_NORMAL_NEGOTIATION, worker, limit(int(sqrt(income)) * 10, 25, 2000) * (adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) + 2) / 2
 		cdata(CDATA_SALES_EXP, worker)++
 		if ( 0 ) {
 			cdata(CDATA_SALES_EXP, worker) += 360
 		}
 		gdata(GDATA_FLAG_YACA_POINTS) += yaca
@@ -2399,11 +2638,11 @@
 	loop
 	repeat renewmulti
 		if ( worker == (-1) ) {
 			goto *skipBreeder
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 10 ) {
+		if ( adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 10 ) {
 			goto *skipBreeder
 		}
 		if ( cdatan(CDATAN_RACE, worker) == "quickling" ) {
 			if ( rnd(10) >= 8 ) {
 				goto *skipBreeder
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/module.hsp ../2.20-borscht/module.hsp
--- ../2.19R-borscht/module.hsp	2023-08-08 08:52:07.848572500 +0800
+++ ../2.20-borscht/module.hsp	2023-10-08 12:53:02.150525400 +0800
@@ -1950,16 +1950,16 @@
 									gmode 2, 48, 48
 									grotate BUFFER_ITEM, 0, 960, cdata(CDATA_MARK_ITEM_ADJUST_R, CHARA_PLAYER) * 6.54498469498, 24 + cdata(CDATA_MARK_ITEM_ADJUST_W, CHARA_PLAYER) * 2, 24 + cdata(CDATA_PRECIOUS_ALLY, CHARA_PLAYER) * 2
 								}
 							}
 						}
-						if ( cdata(CDATA_SP_EARNED, CHARA_PLAYER) <= (-1000000) & cdata(CDATA_SP_EARNED, CHARA_PLAYER) > (-2000000) ) {
+						if ( cdata(CDATA_PREGNANCY_PROGRESS, CHARA_PLAYER) <= (-1000000) & cdata(CDATA_PREGNANCY_PROGRESS, CHARA_PLAYER) > (-2000000) ) {
 							pos locvar_cell_draw_px, locvar_cell_draw_py - 5
 							gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
 							gcopy BUFFER_INF, 192 + 48 * 20 + rnd(1) * inf_tiles, 704
 						}
-						if ( cdata(CDATA_SP_EARNED, CHARA_PLAYER) <= (-2000000) ) {
+						if ( cdata(CDATA_PREGNANCY_PROGRESS, CHARA_PLAYER) <= (-2000000) ) {
 							pos locvar_cell_draw_px, locvar_cell_draw_py - 5
 							gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
 							gcopy BUFFER_INF, 192 + 48 * 21 + rnd(1) * inf_tiles, 704
 						}
 						if ( gdata(GDATA_FLAG_MAIN) >= 900 & gdata(GDATA_FLAG_MAIN) < 1000 ) {
@@ -2231,13 +2231,13 @@
 							}
 							else {
 								gcopy BUFFER_ITEM, chipi(CHIPI_X, locvar_cell_draw_p) + (locvar_cell_draw_scrturn \ (chipi(CHIPI_ANIM, locvar_cell_draw_p) + 1) - (locvar_cell_draw_scrturn \ (chipi(CHIPI_ANIM, locvar_cell_draw_p) + 1) == chipi(CHIPI_ANIM, locvar_cell_draw_p)) * 2 * (chipi(CHIPI_ANIM, locvar_cell_draw_p) != 0)) * inf_tiles, chipi(CHIPI_Y, locvar_cell_draw_p), chipi(CHIPI_WIDTH, locvar_cell_draw_p), chipi(CHIPI_HEIGHT, locvar_cell_draw_p)
 							}
 							if ( inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_CF_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_CRUSH_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_BATTLE_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_SUPER_POTIOMAN ) {
-								if ( inv(INV_ITEM_SHOP_SAMPLE, locvar_cell_draw_fp) > 0 ) {
+								if ( inv(INV_ITEM_PARTS, locvar_cell_draw_fp) > 0 ) {
 									pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p) - locvar_cell_draw_stackh
-									gcopy BUFFER_ITEM, 1008 - (inv(INV_ITEM_SHOP_SAMPLE, locvar_cell_draw_fp) - 50) * 48, 1776, 48, 48
+									gcopy BUFFER_ITEM, 1008 - (inv(INV_ITEM_PARTS, locvar_cell_draw_fp) - 50) * 48, 1776, 48, 48
 								}
 								if ( inv(INV_ITEM_AMUR_CAGE, locvar_cell_draw_fp) > 0 ) {
 									pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p) - locvar_cell_draw_stackh
 									gcopy BUFFER_ITEM, 1344 - inv(INV_ITEM_AMUR_CAGE, locvar_cell_draw_fp) * 48, 1776, 48, 48
 								}
@@ -2525,13 +2525,13 @@
 									gmode 4, inf_tiles, inf_tiles, 140
 									color 0, 0, 0
 									pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p)
 									gcopy BUFFER_ITEM, 0, 960, chipi(CHIPI_WIDTH, locvar_cell_draw_p), chipi(CHIPI_HEIGHT, locvar_cell_draw_p)
 									if ( inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_CF_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_CRUSH_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_BATTLE_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_SUPER_POTIOMAN ) {
-										if ( inv(INV_ITEM_SHOP_SAMPLE, locvar_cell_draw_fp) > 0 ) {
+										if ( inv(INV_ITEM_PARTS, locvar_cell_draw_fp) > 0 ) {
 											pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p)
-											gcopy BUFFER_ITEM, 1008 - (inv(INV_ITEM_SHOP_SAMPLE, locvar_cell_draw_fp) - 50) * 48, 1776, 48, 48
+											gcopy BUFFER_ITEM, 1008 - (inv(INV_ITEM_PARTS, locvar_cell_draw_fp) - 50) * 48, 1776, 48, 48
 										}
 										if ( inv(INV_ITEM_AMUR_CAGE, locvar_cell_draw_fp) > 0 ) {
 											pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p)
 											gcopy BUFFER_ITEM, 1344 - inv(INV_ITEM_AMUR_CAGE, locvar_cell_draw_fp) * 48, 1776, 48, 48
 										}
@@ -2549,13 +2549,13 @@
 									}
 									else {
 										gcopy BUFFER_ITEM, chipi(CHIPI_X, locvar_cell_draw_p) + (locvar_cell_draw_scrturn \ (chipi(CHIPI_ANIM, locvar_cell_draw_p) + 1) - (locvar_cell_draw_scrturn \ (chipi(CHIPI_ANIM, locvar_cell_draw_p) + 1) == chipi(CHIPI_ANIM, locvar_cell_draw_p)) * 2 * (chipi(CHIPI_ANIM, locvar_cell_draw_p) != 0)) * inf_tiles, chipi(CHIPI_Y, locvar_cell_draw_p), chipi(CHIPI_WIDTH, locvar_cell_draw_p), chipi(CHIPI_HEIGHT, locvar_cell_draw_p) - 22
 									}
 									if ( inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_CF_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_CRUSH_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_BATTLE_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_SUPER_POTIOMAN ) {
-										if ( inv(INV_ITEM_SHOP_SAMPLE, locvar_cell_draw_fp) > 0 ) {
+										if ( inv(INV_ITEM_PARTS, locvar_cell_draw_fp) > 0 ) {
 											pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p)
-											gcopy BUFFER_ITEM, 1008 - (inv(INV_ITEM_SHOP_SAMPLE, locvar_cell_draw_fp) - 50) * 48, 1776, 48, 48
+											gcopy BUFFER_ITEM, 1008 - (inv(INV_ITEM_PARTS, locvar_cell_draw_fp) - 50) * 48, 1776, 48, 48
 										}
 										if ( inv(INV_ITEM_AMUR_CAGE, locvar_cell_draw_fp) > 0 ) {
 											pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p)
 											gcopy BUFFER_ITEM, 1344 - inv(INV_ITEM_AMUR_CAGE, locvar_cell_draw_fp) * 48, 1776, 48, 48
 										}
@@ -2568,13 +2568,13 @@
 								}
 								else {
 									gcopy BUFFER_ITEM, chipi(CHIPI_X, locvar_cell_draw_p) + (locvar_cell_draw_scrturn \ (chipi(CHIPI_ANIM, locvar_cell_draw_p) + 1) - (locvar_cell_draw_scrturn \ (chipi(CHIPI_ANIM, locvar_cell_draw_p) + 1) == chipi(CHIPI_ANIM, locvar_cell_draw_p)) * 2 * (chipi(CHIPI_ANIM, locvar_cell_draw_p) != 0)) * inf_tiles, chipi(CHIPI_Y, locvar_cell_draw_p), chipi(CHIPI_WIDTH, locvar_cell_draw_p), chipi(CHIPI_HEIGHT, locvar_cell_draw_p)
 								}
 								if ( inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_CF_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_CRUSH_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_BATTLE_POTIOMAN | inv(INV_ITEM_ID, locvar_cell_draw_fp) == ITEM_ID_SUPER_POTIOMAN ) {
-									if ( inv(INV_ITEM_SHOP_SAMPLE, locvar_cell_draw_fp) > 0 ) {
+									if ( inv(INV_ITEM_PARTS, locvar_cell_draw_fp) > 0 ) {
 										pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p)
-										gcopy BUFFER_ITEM, 1008 - (inv(INV_ITEM_SHOP_SAMPLE, locvar_cell_draw_fp) - 50) * 48, 1776, 48, 48
+										gcopy BUFFER_ITEM, 1008 - (inv(INV_ITEM_PARTS, locvar_cell_draw_fp) - 50) * 48, 1776, 48, 48
 									}
 									if ( inv(INV_ITEM_AMUR_CAGE, locvar_cell_draw_fp) > 0 ) {
 										pos locvar_cell_draw_dx, locvar_cell_draw_dy - chipi(CHIPI_F, locvar_cell_draw_p)
 										gcopy BUFFER_ITEM, 1344 - inv(INV_ITEM_AMUR_CAGE, locvar_cell_draw_fp) * 48, 1776, 48, 48
 									}
@@ -2789,10 +2789,22 @@
 								pos locvar_cell_draw_dx + 24, locvar_cell_draw_dy + 24 - chipc(CHIPC_F, locvar_cell_draw_p) / 2
 								grotate BUFFER_CHR, 0, 960, 0, 36, chipc(CHIPC_HEIGHT, locvar_cell_draw_p) * 3 / 4
 								if ( cdata(CDATA_EMO_ICON, locvar_cell_draw_c) != 0 ) {
 									draw_emo locvar_cell_draw_c, locvar_cell_draw_dx + 4, locvar_cell_draw_dy - chipc(CHIPC_F, locvar_cell_draw_p) / 2 - 16
 								}
+								if ( locvar_cell_draw_c != 0 ) {
+									if ( cbit(CHARA_BIT_LOCKED_UP, locvar_cell_draw_c) ) {
+										if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 1 ) {
+											pos locvar_cell_draw_dx + 24 + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 8, locvar_cell_draw_dy
+										}
+										else {
+											pos locvar_cell_draw_dx + 24, locvar_cell_draw_dy
+										}
+										gmode 2, 48, 96
+										grotate BUFFER_ITEM, 335, 1824, 0, 36, 72
+									}
+								}
 							}
 							else {
 								locvar_cell_draw_mimi = 0
 								if ( cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_CHAOS_MIMIC | cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_MIMIC ) {
 									if ( locvar_cell_draw_c >= 16 ) {
@@ -2912,10 +2924,23 @@
 										}
 									}
 								}
 							}
 						}
+						if ( locvar_cell_draw_c != 0 ) {
+							if ( cbit(CHARA_BIT_LOCKED_UP, locvar_cell_draw_c) ) {
+								if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
+									if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 1 ) {
+										pos locvar_cell_draw_dx + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 12, locvar_cell_draw_dy - 63 + (chipm(CHIPM_ROLE, locvar_cell_draw_ground) == MAP_CHIP_ROLE_WATER) * 16
+									}
+									else {
+										pos locvar_cell_draw_dx, locvar_cell_draw_dy - 63 + (chipm(CHIPM_ROLE, locvar_cell_draw_ground) == MAP_CHIP_ROLE_WATER) * 16
+									}
+									gcopy BUFFER_ITEM, 335, 1824, 48, 96
+								}
+							}
+						}
 						if ( cbit(CHARA_BIT_STETHOSCOPE, locvar_cell_draw_c) == TRUE | gdata(GDATA_SCOPE) == locvar_cell_draw_c | (cbit(CHARA_BIT_NECRO, locvar_cell_draw_c) & cdata(CDATA_RELATION, locvar_cell_draw_c) == RELATION_ALLY) | (cdata(CDATA_RELATION, locvar_cell_draw_c) == RELATION_ALLY & locvar_cell_draw_c >= 16) ) {
 							if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 0 ) {
 								locvar_cell_draw_h = cdata(CDATA_HP, locvar_cell_draw_c) * 30 / cdata(CDATA_MAX_HP, locvar_cell_draw_c)
 								if ( locvar_cell_draw_h > 30 ) {
 									locvar_cell_draw_h = 30
@@ -3069,28 +3094,28 @@
 							}
 							else {
 								gcopy BUFFER_INF, 1440 - locvar_cell_draw_h, 531, locvar_cell_draw_h, 3
 							}
 							if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 0 ) {
-								locvar_cell_draw_hg = cdata(CDATA_DRAIN_HP, locvar_cell_draw_c) * 30 / 100
+								locvar_cell_draw_hg = cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), locvar_cell_draw_c) * 30 / 100
 								if ( locvar_cell_draw_hg > 30 ) {
 									locvar_cell_draw_hg = 30
 								}
 							}
 							else {
-								locvar_cell_draw_hg = cdata(CDATA_DRAIN_HP, locvar_cell_draw_c) * 15 / 100
+								locvar_cell_draw_hg = cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), locvar_cell_draw_c) * 15 / 100
 								if ( locvar_cell_draw_hg > 15 ) {
 									locvar_cell_draw_hg = 15
 								}
 							}
 							if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 1 ) {
 								pos locvar_cell_draw_dx + 9 + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 13, locvar_cell_draw_dy + 39
 							}
 							else {
 								pos locvar_cell_draw_dx + 9, locvar_cell_draw_dy + 39
 							}
-							if ( cdata(CDATA_DRAIN_HP, locvar_cell_draw_c) < 100 ) {
+							if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), locvar_cell_draw_c) < 100 ) {
 								gcopy BUFFER_INF, 1440 - locvar_cell_draw_hg, 588, locvar_cell_draw_hg, 3
 							}
 							else {
 								gcopy BUFFER_INF, 1440 - locvar_cell_draw_hg, 591, locvar_cell_draw_hg, 3
 							}
@@ -3283,16 +3308,16 @@
 						if ( cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_THE_ELEMENT & cdata(CDATA_PIC, locvar_cell_draw_c) == 496 + 3 * 1000 | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_HYPER_YACATECT & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(0, 15)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_BLESSED_JURE & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(6, 12)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_DEVASTATE_LULWY & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(30, 11)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_BUILDUP_OPATOS & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(3, 13)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_DEUS_EX_MANINA & cdata(CDATA_PIC, locvar_cell_draw_c) == 447 + 5 * 1000) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_GOD_INSIDE_EHEKATL & cdata(CDATA_PIC, locvar_cell_draw_c) == 413 + 7 * 1000) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_YAYAUHQUI_TEZCATLIPOCA & cdata(CDATA_PIC, locvar_cell_draw_c) == 931 + 7 * 1000) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(21, 28)) ) {
 							pos locvar_cell_draw_dx, locvar_cell_draw_dy - 40
 							gmode 5, inf_tiles, inf_tiles, 100 + rnd(70)
 							gcopy BUFFER_INF, 192 + 48 * 11 + rnd(1) * inf_tiles, 704
 						}
-						if ( cdata(CDATA_SP_EARNED, locvar_cell_draw_c) <= (-1000000) & cdata(CDATA_SP_EARNED, locvar_cell_draw_c) > (-2000000) ) {
+						if ( cdata(CDATA_PREGNANCY_PROGRESS, locvar_cell_draw_c) <= (-1000000) & cdata(CDATA_PREGNANCY_PROGRESS, locvar_cell_draw_c) > (-2000000) ) {
 							pos locvar_cell_draw_dx, locvar_cell_draw_dy - 5
 							gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
 							gcopy BUFFER_INF, 192 + 48 * 20 + rnd(1) * inf_tiles, 704
 						}
-						if ( cdata(CDATA_SP_EARNED, locvar_cell_draw_c) <= (-2000000) ) {
+						if ( cdata(CDATA_PREGNANCY_PROGRESS, locvar_cell_draw_c) <= (-2000000) ) {
 							pos locvar_cell_draw_dx, locvar_cell_draw_dy - 5
 							gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
 							gcopy BUFFER_INF, 192 + 48 * 21 + rnd(1) * inf_tiles, 704
 						}
 					}
@@ -3505,10 +3530,22 @@
 										pos locvar_cell_draw_dx + 24 + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 8, locvar_cell_draw_dy + 24 - chipc(CHIPC_F, locvar_cell_draw_p) / 2
 										grotate BUFFER_CHR, 0, 960, 0, 36, chipc(CHIPC_HEIGHT, locvar_cell_draw_p) * 3 / 4
 										if ( cdata(CDATA_EMO_ICON, locvar_cell_draw_c) != 0 ) {
 											draw_emo locvar_cell_draw_c, locvar_cell_draw_dx + 4 + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 8, locvar_cell_draw_dy - chipc(CHIPC_F, locvar_cell_draw_p) / 2 - 16
 										}
+										if ( locvar_cell_draw_c != 0 ) {
+											if ( cbit(CHARA_BIT_LOCKED_UP, locvar_cell_draw_c) ) {
+												if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 1 ) {
+													pos locvar_cell_draw_dx + 24 + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 8, locvar_cell_draw_dy
+												}
+												else {
+													pos locvar_cell_draw_dx + 24, locvar_cell_draw_dy
+												}
+												gmode 2, 48, 96
+												grotate BUFFER_ITEM, 335, 1824, 0, 36, 72
+											}
+										}
 									}
 									else {
 										if ( chipm(CHIPM_ROLE, locvar_cell_draw_ground) == MAP_CHIP_ROLE_WATER ) {
 											gmode 4, chipc(CHIPC_WIDTH, locvar_cell_draw_p), chipc(CHIPC_HEIGHT, locvar_cell_draw_p), 100
 											color 0, 0, 0
@@ -3620,10 +3657,23 @@
 												}
 											}
 										}
 									}
 								}
+								if ( locvar_cell_draw_c != 0 ) {
+									if ( cbit(CHARA_BIT_LOCKED_UP, locvar_cell_draw_c) ) {
+										if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
+											if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 1 ) {
+												pos locvar_cell_draw_dx + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 12, locvar_cell_draw_dy - 63 + (chipm(CHIPM_ROLE, locvar_cell_draw_ground) == MAP_CHIP_ROLE_WATER) * 16
+											}
+											else {
+												pos locvar_cell_draw_dx, locvar_cell_draw_dy - 63 + (chipm(CHIPM_ROLE, locvar_cell_draw_ground) == MAP_CHIP_ROLE_WATER) * 16
+											}
+											gcopy BUFFER_ITEM, 335, 1824, 48, 96
+										}
+									}
+								}
 								if ( cbit(CHARA_BIT_STETHOSCOPE, locvar_cell_draw_c) == TRUE | gdata(GDATA_SCOPE) == locvar_cell_draw_c ) {
 									if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 0 ) {
 										locvar_cell_draw_h = cdata(CDATA_HP, locvar_cell_draw_c) * 30 / cdata(CDATA_MAX_HP, locvar_cell_draw_c)
 										if ( locvar_cell_draw_h > 30 ) {
 											locvar_cell_draw_h = 30
@@ -3726,28 +3776,28 @@
 									}
 									else {
 										gcopy BUFFER_INF, 1440 - locvar_cell_draw_h, 531, locvar_cell_draw_h, 3
 									}
 									if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 0 ) {
-										locvar_cell_draw_hg = cdata(CDATA_DRAIN_HP, locvar_cell_draw_c) * 30 / 100
+										locvar_cell_draw_hg = cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), locvar_cell_draw_c) * 30 / 100
 										if ( locvar_cell_draw_hg > 30 ) {
 											locvar_cell_draw_hg = 30
 										}
 									}
 									else {
-										locvar_cell_draw_hg = cdata(CDATA_DRAIN_HP, locvar_cell_draw_c) * 15 / 100
+										locvar_cell_draw_hg = cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), locvar_cell_draw_c) * 15 / 100
 										if ( locvar_cell_draw_hg > 15 ) {
 											locvar_cell_draw_hg = 15
 										}
 									}
 									if ( cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) == 1 ) {
 										pos locvar_cell_draw_dx + 9 + 15, locvar_cell_draw_dy + 39
 									}
 									else {
 										pos locvar_cell_draw_dx + 9, locvar_cell_draw_dy + 39
 									}
-									if ( cdata(CDATA_DRAIN_HP, locvar_cell_draw_c) < 100 ) {
+									if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), locvar_cell_draw_c) < 100 ) {
 										gcopy BUFFER_INF, 1440 - locvar_cell_draw_hg, 588, locvar_cell_draw_hg, 3
 									}
 									else {
 										gcopy BUFFER_INF, 1440 - locvar_cell_draw_hg, 591, locvar_cell_draw_hg, 3
 									}
@@ -3933,16 +3983,16 @@
 								if ( cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_THE_ELEMENT & cdata(CDATA_PIC, locvar_cell_draw_c) == 496 + 3 * 1000 | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_HYPER_YACATECT & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(0, 15)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_BLESSED_JURE & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(6, 12)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_DEVASTATE_LULWY & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(30, 11)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_BUILDUP_OPATOS & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(3, 13)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_DEUS_EX_MANINA & cdata(CDATA_PIC, locvar_cell_draw_c) == 447 + 5 * 1000) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_GOD_INSIDE_EHEKATL & cdata(CDATA_PIC, locvar_cell_draw_c) == 413 + 7 * 1000) ) {
 									pos locvar_cell_draw_dx + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 12, locvar_cell_draw_dy - 40
 									gmode 5, inf_tiles, inf_tiles, 100 + rnd(70)
 									gcopy BUFFER_INF, 192 + 48 * 11 + rnd(1) * inf_tiles, 704
 								}
-								if ( cdata(CDATA_SP_EARNED, locvar_cell_draw_c) <= (-1000000) & cdata(CDATA_SP_EARNED, locvar_cell_draw_c) > (-2000000) ) {
+								if ( cdata(CDATA_PREGNANCY_PROGRESS, locvar_cell_draw_c) <= (-1000000) & cdata(CDATA_PREGNANCY_PROGRESS, locvar_cell_draw_c) > (-2000000) ) {
 									pos locvar_cell_draw_dx, locvar_cell_draw_dy - 5
 									gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
 									gcopy BUFFER_INF, 192 + 48 * 20 + rnd(1) * inf_tiles, 704
 								}
-								if ( cdata(CDATA_SP_EARNED, locvar_cell_draw_c) <= (-2000000) ) {
+								if ( cdata(CDATA_PREGNANCY_PROGRESS, locvar_cell_draw_c) <= (-2000000) ) {
 									pos locvar_cell_draw_dx, locvar_cell_draw_dy - 5
 									gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
 									gcopy BUFFER_INF, 192 + 48 * 21 + rnd(1) * inf_tiles, 704
 								}
 							}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/proc.hsp ../2.20-borscht/proc.hsp
--- ../2.19R-borscht/proc.hsp	2023-08-08 08:52:08.121140900 +0800
+++ ../2.20-borscht/proc.hsp	2023-10-08 12:53:02.371932300 +0800
@@ -3280,10 +3280,25 @@
 		}
 		if ( gdata(GDATA_ROW_ACT) == ACTION_CUT_TREE ) {
 			txt lang("あなたは" + itemname(ci) + "の伐採を始めた。", "You start to cut tree.")
 			cdata(CDATA_ACTION_PERIOD, cc) = limit(axeitem - sdata(SKILL_WEAPON_AXE, CHARA_PLAYER) / 8, 20, 100)
 		}
+		if ( gdata(GDATA_ROW_ACT) == ACTION_SLAVE_SPINNER | gdata(GDATA_ROW_ACT) == ACTION_SLAVE_WHEEL ) {
+			if ( gdata(GDATA_NEXT_TRAIN) > gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 ) {
+				txt lang("やる気が起きない。", "You are bored.")
+				rowactend cc
+				return
+			}
+			txt lang("労働を始めた。", "You start working.")
+			gdata(GDATA_NEXT_TRAIN) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + 48
+			if ( gdata(GDATA_ROW_ACT) == ACTION_SLAVE_SPINNER ) {
+				cdata(CDATA_ACTION_PERIOD, cc) = 21
+			}
+			if ( gdata(GDATA_ROW_ACT) == ACTION_SLAVE_WHEEL ) {
+				cdata(CDATA_ACTION_PERIOD, cc) = 61
+			}
+		}
 		if ( gdata(GDATA_ROW_ACT) == ACTION_TRAIN ) {
 			if ( gdata(GDATA_WEATHER) == WEATHER_CLEAR | gdata(GDATA_WEATHER) == WEATHER_RAIN ) {
 				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SKILLBOOK ) {
 					if ( gdata(GDATA_SKILLBOOK_COOLDOWN) > gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 ) {
 						txt lang("もう飽きた。", "You are bored.")
@@ -3336,10 +3351,22 @@
 		gosub *screen_draw
 		return
 	}
 	tc = cdata(CDATA_ROW_ACT_TC, cc)
 	if ( cdata(CDATA_ACTION_PERIOD, cc) > 0 ) {
+		if ( gdata(GDATA_ROW_ACT) == ACTION_SLAVE_SPINNER ) {
+			dmgsp CHARA_PLAYER, 5
+			await 5
+			snd SOUNDLIST_GET1
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) += 3
+		}
+		if ( gdata(GDATA_ROW_ACT) == ACTION_SLAVE_WHEEL ) {
+			dmgsp CHARA_PLAYER, 2
+			await 5
+			snd SOUNDLIST_FOOT1A
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) += 1
+		}
 		if ( gdata(GDATA_ROW_ACT) == ACTION_CUT_TREE ) {
 			if ( rnd(5) == 0 ) {
 				skillexp SKILL_WEAPON_AXE, cc, 20
 			}
 			if ( rnd(6) == 0 ) {
@@ -3672,10 +3699,15 @@
 				txt lang("あなたは良心の呵責を感じた。", "You feel the stings of conscience.")
 				modkarma 0, -1
 			}
 		}
 	}
+	if ( gdata(GDATA_ROW_ACT) == ACTION_SLAVE_SPINNER | gdata(GDATA_ROW_ACT) == ACTION_SLAVE_WHEEL ) {
+		if ( cdata(CDATA_ACTION_PERIOD, cc) == 0 ) {
+			txt lang("あなたは労働を終えた。[現在の労働エナジー：" + adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) + "]", "You have finished your toil. [Current Toil-Energy: " + adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) + "]")
+		}
+	}
 	if ( gdata(GDATA_ROW_ACT) == ACTION_SLEEP ) {
 		txt lang("あなたは眠り込んだ。", "You fall asleep.")
 		gosub *sleep
 	}
 	if ( gdata(GDATA_ROW_ACT) == ACTION_CONSTRUCT ) {
@@ -4255,14 +4287,14 @@
 	if ( cdata(CDATA_ACTION_PERIOD, cc) > 0 ) {
 		repeat 245
 			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
 				continue
 			}
-			if ( cdata(CDATA_DRAIN_HP, cnt) > 0 ) {
-				cdata(CDATA_DRAIN_HP, cnt) -= 2
-				if ( cdata(CDATA_DRAIN_HP, cnt) == 100 | cdata(CDATA_DRAIN_HP, cnt) == 99 ) {
-					cdata(CDATA_DRAIN_HP, cnt) = 0
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cnt) > 0 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cnt) -= 2
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cnt) == 100 | cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cnt) == 99 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cnt) = 0
 				}
 			}
 			if ( cdata(CDATA_ACTION_PERIOD, cc) \ 2 == 0 ) {
 				healsp cnt, 1
 			}
@@ -5112,14 +5144,14 @@
 				repeat invrange, invhead
 					if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
 						continue
 					}
 					if ( chipm(CHIPM_ROLE, map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_TILE_ID)) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
-						inv(INV_ITEM_SHOP_SAMPLE, cnt) = 100
+						inv(INV_ITEM_PARTS, cnt) = 100
 					}
 					else {
-						inv(INV_ITEM_SHOP_SAMPLE, cnt) = 0
+						inv(INV_ITEM_PARTS, cnt) = 0
 					}
 				loop
 			}
 			spillfrag refx, refy, 2
 			x = refx
@@ -5201,11 +5233,11 @@
 		return
 	}
 	if ( cdata(CDATA_ACTION_PERIOD, cc) > 0 ) {
 		return
 	}
-	if ( cdata(CDATA_TAMER_WHIP_PICKUP, cc) == 10 ) {
+	if ( cdata(CDATA_PREGNANCY_MALE_CHILD, cc) == 10 ) {
 		if ( ci >= 5080 ) {
 			modimp2 cc, -20
 		}
 	}
 	if ( synccheck(cc, -1) ) {
@@ -6072,16 +6104,16 @@
 		if ( cc != CHARA_PLAYER ) {
 			if ( cdata(CDATA_SP, cc) > (-50) ) {
 				cdata(CDATA_SP, cc)--
 			}
 		}
-		if ( cdata(CDATA_DRAIN_HP, cc) < 99 ) {
-			cdata(CDATA_DRAIN_HP, cc)++
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) < 99 ) {
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc)++
 		}
 		if ( cc != CHARA_PLAYER ) {
-			if ( cdata(CDATA_DRAIN_HP, cc) < 99 ) {
-				cdata(CDATA_DRAIN_HP, cc)++
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) < 99 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc)++
 			}
 		}
 		if ( cc != CHARA_PLAYER ) {
 			if ( sdataref(SKILL_DATAREF_TYPE, efid) == 7 ) {
 				procid = (procid + 1) \ 4
@@ -6754,11 +6786,11 @@
 	if ( cc == CHARA_PLAYER ) {
 		if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) != 0 ) {
 			if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
 				if ( gdata(GDATA_ACTIVATE_PROC) == 0 ) {
 					if ( sdataref(SKILL_DATAREF_TYPE, efid) == 1 | sdataref(SKILL_DATAREF_TYPE, efid) == 2 | (sdataref(SKILL_DATAREF_TYPE, efid) == 3 & efid != SKILL_SPACT_RAIN_OF_SANITY & efid != SKILL_SPELL_HEALING_RAIN) ) {
-						efid = SKILL_SPACT_DIFFUSION_WAVE
+						efid = SKILL_SPACT_GOD_CHARGE_ROD
 						gosub *effect
 					}
 				}
 			}
 		}
@@ -6767,11 +6799,11 @@
 		if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_OFFENSIVE ) {
 			powsel = 0
 			if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
 				if ( gdata(GDATA_ACTIVATE_PROC) == 0 ) {
 					if ( sdataref(SKILL_DATAREF_TYPE, efid) == 1 | sdataref(SKILL_DATAREF_TYPE, efid) == 2 | (sdataref(SKILL_DATAREF_TYPE, efid) == 3 & efid != SKILL_SPACT_RAIN_OF_SANITY & efid != SKILL_SPELL_HEALING_RAIN) ) {
-						efid = SKILL_SPACT_DIFFUSION_WAVE
+						efid = SKILL_SPACT_GOD_CHARGE_ROD
 						gosub *effect
 					}
 				}
 			}
 		}
@@ -8174,11 +8206,11 @@
 						dmghp tc, role(dice1, dice2, bonus), cc, ele, elep
 						dmgcon tc, CONDITION_BLEED, 75
 					}
 				}
 				if ( efid != SKILL_SPACT_DRAIN_BLOOD ) {
-					dmghp tc, role(dice1, dice2, bonus), cc, ele, elep
+					dmghp tc, role(dice1, dice2, bonus) + ((limit(cdata(CDATA_LEVEL, cc) - 50, 1, 2000) + limit(cdata(CDATA_LEVEL, cc) - 100, 1, 2000)) * 2 * sqrt(limit(cdata(CDATA_LEVEL, cc), 1, 2000) * 3) + 30 + 1) / 3, cc, ele, elep
 				}
 				if ( efid == SKILL_SPACT_VORACITY_FANG ) {
 					dmgcon tc, CONDITION_BLEED, 75
 					cdata(CDATA_HUNGER, cc) += 150
 				}
@@ -8212,10 +8244,16 @@
 					dmgcon tc, CONDITION_FEAR, elep
 				}
 				if ( efid == SKILL_SPACT_TOUCH_OF_SLEEP ) {
 					dmgcon tc, CONDITION_SLEEP, elep
 				}
+				if ( efid == SKILL_SPACT_TOUCH_OF_POISON ) {
+					dmgcon tc, CONDITION_POISON, elep
+				}
+				if ( efid == SKILL_SPACT_TOUCH_OF_NERVE ) {
+					dmgcon tc, CONDITION_PARALYZE, elep
+				}
 				if ( efid == SKILL_SPACT_TOUCH_OF_HUNGER ) {
 					addbuff tc, BUFF_CURSE_OF_HUNGER, 9999999, 100
 				}
 				if ( efid == SKILL_SPACT_TOUCH_OF_WEAKNESS ) {
 					if ( cdata(CDATA_QUALITY, tc) >= FIX_QUALITY_MIRACLE ) {
@@ -8500,10 +8538,13 @@
 							dbid = 412
 						}
 						if ( cdata(CDATA_ID, cc) == CREATURE_ID_POWERFUL_GREAT_WYRM ) {
 							dbid = 1033
 						}
+						if ( cdata(CDATA_ID, cc) == CREATURE_ID_MESHERA_PLANT ) {
+							dbid = 1089
+						}
 					}
 					if ( efid == SKILL_SPELL_SUMMON_SPIRIT ) {
 						initlv = limit(efp * 1 / 3 + 2, 1, gdata(GDATA_DEEPEST_LEVEL))
 						novoidlv = 1
 						fltn "spirit"
@@ -11368,10 +11409,101 @@
 			gdata(GDATA_TIME_STOP_TIME) += 2
 		}
 		goto *effect_end
 		_switch_sw++
 	}
+	if ( _switch_val == 855 | _switch_sw ) {
+		_switch_sw = 0
+		if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
+			goto *effect_end
+		}
+		if ( tc == cc ) {
+			goto *effect_end
+		}
+		if ( cc < MAX_CHARA_FOLLOWER | cc == CHARA_PLAYER ) {
+			if ( tc < MAX_CHARA_FOLLOWER | tc == CHARA_PLAYER ) {
+				goto *effect_end
+			}
+		}
+		if ( cdata(CDATA_POWER_GAUGE, cc) < 100 ) {
+			txt lang("何もおきない… ", "Nothing happens...")
+			goto *effect_end
+		}
+		cdata(CDATA_POWER_GAUGE, cc) -= 100
+		if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
+			snd SOUNDLIST_POWER
+			exgauge = 100
+			if ( gdata(GDATA_TIME_STOP_TIME) == 0 ) {
+				gdata(GDATA_TIME_STOP_TIME) = 2
+			}
+		}
+		txtef COLOR_YELLOW
+		txt lang("*" + skillname(efid) + "*　", "*" + skillname(efid) + "* ")
+		if ( cc == CHARA_PLAYER ) {
+			cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) = 0
+		}
+		txtef COLOR_GREEN
+		txt lang(name(cc) + "は魔杖の力を天に放った！", name(cc) + " released rod power into the sky!")
+		animeid = ANIMATION_GOD_CHARGE_ROD
+		animode = 100 + tc
+		gosub *anime
+		weap = sdata(SKILL_NORMAL_MAGIC_DEVICE, cc)
+		if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
+			skillexp SKILL_NORMAL_MAGIC_DEVICE, cc, 400
+		}
+		if ( synccheck(tc, -1) ) {
+			txtmore
+			if ( tc >= MAX_CHARA_FOLLOWER ) {
+				gdata(GDATA_DMG_TYPE) = 2
+				txt3rd = 1
+				txt lang(name(tc) + "に命中し", "The breath hits " + name(tc) + " and")
+			}
+			else {
+				txt lang(name(tc) + "に命中した。", "The breath hits " + name(tc) + ".")
+			}
+		}
+		inv_getheader cc
+		eqlv = 1
+		eqbui = 0
+		repeat invrange, invhead
+			if ( inv(INV_ITEM_NUM, cnt) == 0 | inv(INV_ITEM_EQUIP, cnt) == 0 ) {
+				continue
+			}
+			eqlv += limit(inv(INV_ITEM_LEVEL, cnt), 0, 20)
+			eqbui++
+		loop
+		if ( eqlv <= 0 ) {
+			eqlv = 1
+		}
+		if ( eqbui <= 0 ) {
+			eqbui = 1
+		}
+		eqlv = limit(eqlv / eqbui * 3, 3, 30)
+		dmghp tc, limit((weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap * 2 + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
+		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
+					waitbk = cfg_animewait
+					if ( cfg_animewait < 50 ) {
+						cfg_animewait = 50
+					}
+					animeload 87, tc
+					snd SOUNDLIST_CRASH14
+					cfg_animewait = waitbk
+				}
+			}
+		}
+		gdata(GDATA_ABSORB_CHARGE) += 10
+		txt lang("充填用魔力を10獲得した(魔力の貯蓄：" + gdata(GDATA_ABSORB_CHARGE) + ")", "You get 10 recharge powers. (Total:" + gdata(GDATA_ABSORB_CHARGE) + ")")
+		eqlv = 0
+		eqbui = 0
+		weap = 0
+		goto *effect_end
+		_switch_sw++
+	}
 	if ( _switch_val == 718 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
 			goto *effect_end
 		}
@@ -11408,20 +11540,12 @@
 		animeload 43, cc
 		snd SOUNDLIST_ENC
 		animeload 43, cc
 		snd SOUNDLIST_PUNISH1
 		weap = sdata(SKILL_NORMAL_CASTING, cc)
-		if ( sdata(SKILL_NORMAL_CASTING, cc) < sdata(SKILL_NORMAL_MAGIC_DEVICE, cc) ) {
-			weap = sdata(SKILL_NORMAL_MAGIC_DEVICE, cc)
-		}
 		if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
-			if ( sdata(SKILL_NORMAL_CASTING, cc) < sdata(SKILL_NORMAL_MAGIC_DEVICE, cc) ) {
-				skillexp SKILL_NORMAL_MAGIC_DEVICE, cc, 400
-			}
-			else {
-				skillexp SKILL_NORMAL_MAGIC_DEVICE, cc, 400
-			}
+			skillexp SKILL_NORMAL_CASTING, cc, 400
 		}
 		if ( synccheck(tc, -1) ) {
 			txtmore
 			if ( tc >= MAX_CHARA_FOLLOWER ) {
 				gdata(GDATA_DMG_TYPE) = 2
@@ -11449,14 +11573,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit((weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap * 2 + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 30
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12085,14 +12209,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 60
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 60
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12198,14 +12322,14 @@
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmgmp tc, limit(limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) / 5, 1, cdata(CDATA_MAX_MP, tc) / 2)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 40
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12287,14 +12411,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 40
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12389,14 +12513,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 40
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12480,14 +12604,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 40
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12687,14 +12811,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 30
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12782,14 +12906,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 30
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12874,14 +12998,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 30
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -12965,14 +13089,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 30
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -13468,14 +13592,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 40
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -13557,14 +13681,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 40
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -13662,14 +13786,14 @@
 			gosub *anime
 			snd SOUNDLIST_ATK2
 			dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 16, 2500) / 16 * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap / 10 + 1), cc, SKILL_SPACT_DANCE_OF_BLOW
 		loop
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 40
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -13743,14 +13867,14 @@
 				eqbui = 1
 			}
 			eqlv = limit(eqlv / eqbui * 3, 3, 30)
 			dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) / 2 * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 			if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-				if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) += 40
-					if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-						cdata(CDATA_DRAIN_HP, tc) = 120
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+					if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+						cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 						waitbk = cfg_animewait
 						if ( cfg_animewait < 50 ) {
 							cfg_animewait = 50
 						}
 						animeload 87, tc
@@ -13842,14 +13966,14 @@
 			eqbui = 1
 		}
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 40
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 40
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -15339,11 +15463,11 @@
 		else {
 			txt lang("何もおきない… ", "Nothing happens...")
 			obvious = 0
 		}
 		if ( 0 ) {
-			txt lang("のPV" + inv(INV_ITEM_CHARA_PIC, ci) + "、DVは" + inv(INV_ITEM_NEED_SLEEP, ci) + "、DMGは" + inv(INV_ITEM_AMUR_CAGE, ci) + "、ATKは" + inv(INV_ITEM_SHOP_SAMPLE, ci) + "。", name(cc) + your(cc) + " " + s + " transforms into " + itemname(ci, 1) + ".")
+			txt lang("のPV" + inv(INV_ITEM_CHARA_PIC, ci) + "、DVは" + inv(INV_ITEM_NEED_SLEEP, ci) + "、DMGは" + inv(INV_ITEM_AMUR_CAGE, ci) + "、ATKは" + inv(INV_ITEM_PARTS, ci) + "。", name(cc) + your(cc) + " " + s + " transforms into " + itemname(ci, 1) + ".")
 		}
 		r1 = cc
 		gosub *charaRefresh
 		goto *effect_end
 		_switch_sw++
@@ -19442,14 +19566,14 @@
 			anic = tc
 			gosub *anime
 		}
 		dmghp tc, dmg, cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 30
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -22116,16 +22240,16 @@
 			}
 		}
 		if ( cdata(CDATA_POWER_GAUGE, cc) > 200 ) {
 			cdata(CDATA_POWER_GAUGE, cc) = 200
 		}
-		cdata(CDATA_DRAIN_HP, cc) -= 15
-		if ( cdata(CDATA_DRAIN_HP, cc) <= 100 & cdata(CDATA_DRAIN_HP, cc) >= 85 ) {
-			cdata(CDATA_DRAIN_HP, cc) = 0
+		cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) -= 15
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) <= 100 & cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) >= 85 ) {
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) = 0
 		}
-		if ( cdata(CDATA_DRAIN_HP, cc) < 0 ) {
-			cdata(CDATA_DRAIN_HP, cc) = 0
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) < 0 ) {
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) = 0
 		}
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 847 | _switch_sw ) {
@@ -22254,10 +22378,11 @@
 				gdata(GDATA_WORLD_RENEW) = TRUE
 				gdata(GDATA_MONTH) = 11
 				gdata(GDATA_HOUR) = 23
 				gosub *advance_hour
 				gdata(GDATA_GUEST) = 2
+				gdata(GDATA_WORLD) = AREA_LOST_YLVA
 				mdata(MDATA_RENEW) = 1
 				gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) += 95
 				cdata(CDATA_SKILLPOINT, CHARA_PLAYER) += 95
 				gdata(GDATA_FLAG_DESTINY_LETTERS) = 7
 				cdata(CDATA_GOD, CHARA_PLAYER) = GOD_EYTH
@@ -22265,11 +22390,11 @@
 					cdata(CDATA_ROLE_SHOP_LEVEL, cnt) = rnd(30) + 1
 					cdata(CDATA_ROLE_RESTOCK, cnt) = rnd(30) + 1
 				loop
 				repeat 245
 					cdata(CDATA_POWER_GAUGE, cnt) += 52
-					cdata(CDATA_DRAIN_HP, cnt) += 52
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cnt) += 52
 					cdata(CDATA_WEIGHT, cnt) = 15000
 					if ( cnt != 0 ) {
 						cdata(CDATA_CONDITION_BIND, cnt) += 100
 					}
 					if ( cdata(CDATA_POWER_GAUGE, cnt) > 100 ) {
@@ -23361,16 +23486,16 @@
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 840 | _switch_sw ) {
 		_switch_sw = 0
-		if ( cdata(CDATA_DRAIN_HP, cc) >= 100 ) {
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) >= 100 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("他人の指導をしている余裕はない。", "You can't afford to lead others.")
 			goto *effect_end
 		}
-		goto *label_6427
+		goto *label_6456
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 1131 | _switch_sw ) {
 		_switch_sw = 0
@@ -24114,14 +24239,14 @@
 		}
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
 			dmghp tc, (sdata(SKILL_ATTR_MAG, cc) / 10 + 1) * sqrt(sdata(SKILL_ATTR_WIL, cc)) * eqlv, cc, SKILL_RES_MIND, sdata(SKILL_ATTR_MAG, cc) + 100
 		}
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 30
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -24324,14 +24449,14 @@
 		eqlv = limit(eqlv / eqbui * 3, 3, 30)
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
 			dmghp tc, limit(cdata(CDATA_DAMAGE_FIX, cc) + (weap + 1) / 2, 2, 2500) * sqrt(weap) * sqrt(eqlv - 2) + rnd(weap + 1), cc, SKILL_SPACT_FLASH_OF_SWIFTNESS
 		}
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_DRAIN_HP, tc) < 100 ) {
-				cdata(CDATA_DRAIN_HP, tc) += 30
-				if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
-					cdata(CDATA_DRAIN_HP, tc) = 120
+			if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) < 100 ) {
+				cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) += 30
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
+					cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) = 120
 					waitbk = cfg_animewait
 					if ( cfg_animewait < 50 ) {
 						cfg_animewait = 50
 					}
 					animeload 87, tc
@@ -24675,26 +24800,26 @@
 		dx = cdata(CDATA_X, tc)
 		dy = cdata(CDATA_Y, tc)
 		if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("範囲外だ。", "Out of range.")
-			goto *label_6427
+			goto *label_6456
 		}
 		if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("範囲外だ。", "Out of range.")
-			goto *label_6427
+			goto *label_6456
 		}
-		if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("手遅れだ。", "It's too late to lead.")
-			goto *label_6427
+			goto *label_6456
 		}
-		if ( cdata(CDATA_DRAIN_HP, tc) <= 0 ) {
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) <= 0 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("指導の必要はなさそうだ。", "There seems to be no need for leading.")
-			goto *label_6427
+			goto *label_6456
 		}
 		customtalk tc, DBMODE_FLAVOR_LEADING
 		gosub *convert_word
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			txtef COLOR_SKY_BLUE
@@ -24704,15 +24829,15 @@
 			if ( en ) {
 				txt name(tc) + " " + cnvtalk("I got it."), name(tc) + " " + cnvtalk("I'll be careful."), name(tc) + " " + cnvtalk("Hmmm..."), name(tc) + " " + cnvtalk("Okay.")
 			}
 		}
 		snd SOUNDLIST_ENC
-		half = limit(cdata(CDATA_DRAIN_HP, tc) / 2, 1, 100 - cdata(CDATA_DRAIN_HP, cc))
-		cdata(CDATA_DRAIN_HP, tc) -= half
-		cdata(CDATA_DRAIN_HP, cc) += half
-		if ( cdata(CDATA_DRAIN_HP, cc) >= 100 ) {
-			cdata(CDATA_DRAIN_HP, cc) = 99
+		half = limit(cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) / 2, 1, 100 - cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc))
+		cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) -= half
+		cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) += half
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) >= 100 ) {
+			cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), cc) = 99
 		}
 	}
 	return
 
 *effect_directive
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/screen.hsp ../2.20-borscht/screen.hsp
--- ../2.19R-borscht/screen.hsp	2023-08-08 08:52:08.256746200 +0800
+++ ../2.20-borscht/screen.hsp	2023-10-08 12:53:02.480640900 +0800
@@ -208,19 +208,19 @@
 			ap = 100
 		}
 		pos inf_hpx + 16, inf_hpy + 10
 		gcopy BUFFER_INF, 1439 - ap, 492, ap, 2
 	}
-	if ( cdata(CDATA_DRAIN_HP, CHARA_PLAYER) > 0 & cdata(CDATA_DRAIN_HP, CHARA_PLAYER) <= 100 ) {
-		apg = cdata(CDATA_DRAIN_HP, CHARA_PLAYER) * 84 / 100
+	if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), CHARA_PLAYER) > 0 & cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), CHARA_PLAYER) <= 100 ) {
+		apg = cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), CHARA_PLAYER) * 84 / 100
 		if ( apg > 100 ) {
 			apg = 100
 		}
 		pos inf_mpx + 6, inf_mpy + 10
 		gcopy BUFFER_INF, 532 - apg, 525, apg, 2
 	}
-	if ( cdata(CDATA_DRAIN_HP, CHARA_PLAYER) > 100 ) {
+	if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), CHARA_PLAYER) > 100 ) {
 		apg = 84
 		pos inf_mpx + 6, inf_mpy + 10
 		gcopy BUFFER_INF, 1439 - apg, 585, apg, 2
 	}
 	if ( cdata(CDATA_MP, CHARA_PLAYER) > 0 ) {
@@ -281,11 +281,11 @@
 	bmes "" + cdata(CDATA_POWER_GAUGE, CHARA_PLAYER) + "%", 255, 255, 255
 	sx = inf_mpx + 92
 	sy = inf_mpy + 3
 	color 0
 	pos sx + 4, sy - 2
-	bmes "" + cdata(CDATA_DRAIN_HP, CHARA_PLAYER) + "%", 255, 255, 255
+	bmes "" + cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), CHARA_PLAYER) + "%", 255, 255, 255
 	font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
 	color 0, 0, 0
 	sy = inf_bary + 2 + vfix
 	repeat 10
 		sx = inf_raderw + cnt * 47 + 168 - 2
@@ -329,11 +329,11 @@
 				if ( cdata(CDATA_PV, CHARA_PLAYER) < 0 ) {
 					pvfix = 100
 				}
 				dvpc = cdata(CDATA_DV, CHARA_PLAYER) * dvfix / 100 + dvfix - 100
 				pvpc = (cdata(CDATA_PV, CHARA_PLAYER) + pvfix / 25) * pvfix / 100
-				if ( cdata(CDATA_DRAIN_HP, CHARA_PLAYER) >= 100 ) {
+				if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), CHARA_PLAYER) >= 100 ) {
 					dvpc = 0
 					pvpc = 0
 				}
 				mes "" + dvpc + "/" + pvpc
 			}
@@ -3006,14 +3006,12 @@
 	}
 	if ( _switch_val == 2 | _switch_sw ) {
 		_switch_sw = 0
 		snd SOUNDLIST_BALL1
 		if ( animeid == ANIMATION_BALL ) {
-			if ( ele == SKILL_NONE ) {
-				if ( efid == SKILL_SPELL_BUBBLE_STORM ) {
-					anicol = 21
-				}
+			if ( ele == SKILL_RESDMG_CRUSH ) {
+				anicol = 21
 			}
 		}
 		gsel BUFFER_PIC
 		picload exedir + "graphic\\anime5.bmp"
 		pos 0, 96
@@ -3084,27 +3082,25 @@
 			pos 0, 0
 			gcopy BUFFER_BUF, 0, 0, windoww, windowh
 			await cfg_animewait
 		loop
 		if ( animeid == ANIMATION_BALL ) {
-			if ( ele == SKILL_NONE ) {
-				if ( efid == SKILL_SPELL_BUBBLE_STORM ) {
-					snd SOUNDLIST_BUBLE
-					snd SOUNDLIST_MIZU
-				}
+			if ( ele == SKILL_RESDMG_CRUSH ) {
+				snd SOUNDLIST_BUBLE
+				snd SOUNDLIST_MIZU
 			}
 		}
 		if ( anisound ) {
 			snd anisound, FALSE, TRUE
 		}
 		goto *anime_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 0 | _switch_sw ) {
 		_switch_sw = 0
-		if ( ele == SKILL_NONE ) {
-			anicol = 17
+		if ( ele == SKILL_RESDMG_CRUSH ) {
+			anicol = 21
 		}
 		if ( efid == SKILL_SPACT_BLOOD_STREAM ) {
 			anicol = 22
 		}
 		gsel BUFFER_ITEM
@@ -3256,11 +3252,11 @@
 			else {
 				await cfg_animewait + 15
 			}
 			redraw 1
 		loop
-		if ( ele == SKILL_NONE ) {
+		if ( ele == SKILL_RESDMG_CRUSH ) {
 			if ( zannku != 10 ) {
 				snd SOUNDLIST_MIZU
 			}
 		}
 		if ( zannku != 100 ) {
@@ -3436,10 +3432,15 @@
 	if ( _switch_val == 63 | _switch_sw ) {
 		_switch_sw = 0
 		if ( synccheck(cc, -1) == 0 ) {
 			goto *anime_SWEND1
 		}
+		if ( animeid == ANIMATION_ARROW ) {
+			if ( ele == SKILL_RESDMG_CRUSH ) {
+				anicol = 21
+			}
+		}
 		gsel BUFFER_ITEM
 		color 0
 		boxf 0, 960, chipi(CHIPI_WIDTH, xy2pic(6, 0)), chipi(CHIPI_HEIGHT, xy2pic(6, 0)) + 960
 		if ( 6 == 528 ) {
 			gmode 2
@@ -4942,10 +4943,15 @@
 					snd SOUNDLIST_THROW1
 				}
 			loop
 		}
 		kaiten = 0
+		if ( animeid == ANIMATION_ARROW ) {
+			if ( ele == SKILL_RESDMG_CRUSH ) {
+				snd SOUNDLIST_MIZU
+			}
+		}
 		if ( anisound ) {
 			snd anisound, FALSE, TRUE
 		}
 		goto *anime_SWEND1
 		_switch_sw++
@@ -6327,10 +6333,112 @@
 			redraw 1
 		loop
 		goto *anime_SWEND1
 		_switch_sw++
 	}
+	if ( _switch_val == 64 | _switch_sw ) {
+		_switch_sw = 0
+		snd SOUNDLIST_BOLT1
+		anicol = 4
+		if ( gdata(GDATA_TEMPORARY_FLAGS3) == 777 ) {
+			anicol = 25
+		}
+		gsel BUFFER_PIC
+		picload exedir + "graphic\\anime12.bmp"
+		pos 0, 0
+		gfini 960, 192
+		gfdec2 c_col(0, anicol), c_col(1, anicol), c_col(2, anicol)
+		gsel BUFFER_BUF
+		pos 0, 0
+		gmode 0
+		gcopy BUFFER_SCREEN, 0, 0, windoww, windowh
+		gsel BUFFER_SCREEN
+		am = 0
+		repeat 245
+			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+				continue
+			}
+			if ( gdata(GDATA_TEMPORARY_FLAGS3) == 777 ) {
+				if ( cdata(CDATA_RELATION, cnt) != RELATION_ENEMY ) {
+					continue
+				}
+			}
+			if ( animode == 0 ) {
+				if ( cnt == cc ) {
+					continue
+				}
+			}
+			if ( animode >= 100 ) {
+				if ( cnt != animode - 100 ) {
+					continue
+				}
+			}
+			ax(am) = (cdata(CDATA_X, cnt) - scx) * inf_tiles + inf_screenx - 24
+			if ( am != 0 ) {
+				ax(am) += 4 - rnd(8)
+			}
+			ay(am) = (cdata(CDATA_Y, cnt) - scy) * inf_tiles + inf_screeny + 32
+			if ( ay(am) < 0 | ay(am) > inf_screenh * inf_tiles + inf_screeny ) {
+				continue
+			}
+			if ( ax(am) < (-20) | ax(am) > windoww + 20 ) {
+				continue
+			}
+			ap(am) = 20 + (am != 0) * rnd(5)
+			am++
+		loop
+		repeat
+			redraw 0
+			pos 0, 0
+			gmode 0
+			gcopy BUFFER_BUF, 0, 0, windoww, windowh
+			af = 0
+			repeat am
+				if ( ap(cnt) <= 0 ) {
+					continue
+				}
+				af = 1
+				cnt2 = cnt
+				anidy = ay(cnt) * limit(20 - ap(cnt), 0, 6) / 6 - 96
+				gmode 2, 96, 96
+				pos ax(cnt), anidy
+				gcopy BUFFER_PIC, limit(8 - ap(cnt), 0, 8) * 96 + 96 * (ap(cnt) < 15), 0, 96, 96
+				if ( ap(cnt) <= 14 ) {
+					if ( ap(cnt) >= 6 ) {
+						pos ax(cnt), anidy + 16
+						gcopy BUFFER_PIC, (14 - ap(cnt)) / 2 * 96, 96, 96, 96
+					}
+				}
+				anidx = limit(anidy / 55 + 1, 0, 7 - limit((11 - ap(cnt)) * 2, 0, 7))
+				repeat anidx, 1
+					pos ax(cnt2), anidy - cnt * 55
+					gcopy BUFFER_PIC, 96 * (ap(cnt2) < 15), 0, 96, 55
+					if ( cnt == anidx ) {
+						pos ax(cnt2), anidy - cnt * 55 - 40
+						gcopy BUFFER_PIC, 288, 0, 96, 40
+					}
+				loop
+				if ( ap(cnt) >= 20 ) {
+					ap(cnt) -= rnd(2)
+				}
+				else {
+					ap(cnt)--
+				}
+			loop
+			if ( cnt \ 2 == 0 ) {
+				snd SOUNDLIST_ATK_FIRE
+				snd SOUNDLIST_BOLT1
+			}
+			if ( af == 0 ) {
+				break
+			}
+			await cfg_animewait + 25
+			redraw 1
+		loop
+		goto *anime_SWEND1
+		_switch_sw++
+	}
 	if ( _switch_val == 22 | _switch_sw ) {
 		_switch_sw = 0
 		gsel BUFFER_PIC
 		picload exedir + "graphic\\anime17.bmp"
 		gsel BUFFER_BUF
@@ -8642,11 +8750,11 @@
 	dvfix = cdata(CDATA_DV_FIX, tc)
 	if ( cdata(CDATA_DV, tc) < 0 ) {
 		dvfix = 100
 	}
 	hoseidv = cdata(CDATA_DV, tc) * dvfix / 100 + dvfix - 100
-	if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
+	if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
 		hoseidv = 0
 	}
 	evade = sdata(SKILL_ATTR_PER, tc) / 6 + sdata(SKILL_NORMAL_EVASION, tc) + hoseidv * 2 * 7 / 4 + 25 - cdata(CDATA_EVASION_PENALTY, tc) * 100
 	if ( cdata(CDATA_DIRECTIVE_MODE, tc) == DIRECTIVE_MODE_DEFENSIVE ) {
 		evade += sdata(SKILL_NORMAL_SHIELD, tc) + sdata(SKILL_ATTR_CON, tc) / 6
@@ -9130,22 +9238,15 @@
 	}
 	if ( cdata(CDATA_CONDITION_GRAVITY, tc) == 0 ) {
 		if ( sdata(SKILL_NORMAL_GREATER_EVASION, tc) != 0 ) {
 			if ( tohit < sdata(SKILL_NORMAL_GREATER_EVASION, tc) * 10 ) {
 				evaderef = evade * 100 / limit(tohit, 1, tohit)
-				if ( evaderef > 300 ) {
-					if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 250) > 100 ) {
-						return -2
-					}
+				if ( evaderef > 1000 ) {
+					evaderef = 1000
 				}
 				if ( evaderef > 200 ) {
-					if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 250) > 150 ) {
-						return -2
-					}
-				}
-				if ( evaderef > 150 ) {
-					if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 250) > 200 ) {
+					if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + evaderef) > 100 ) {
 						return -2
 					}
 				}
 			}
 		}
@@ -9322,11 +9423,11 @@
 	pvfix = cdata(CDATA_PV_FIX, tc)
 	if ( cdata(CDATA_PV, tc) < 0 ) {
 		pvfix = 100
 	}
 	hoseipv = (cdata(CDATA_PV, tc) + pvfix / 25) * pvfix / 100
-	if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
+	if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), tc) >= 100 ) {
 		hoseipv = 0
 	}
 	prot = hoseipv + limit(sdata(carmor(tc), tc) / 4 - cdata(CDATA_PROT_PENALTY, tc) * 100, 0, 2000) + sdata(SKILL_ATTR_DEX, tc) / 10
 	if ( calcattackdmg_arg1 == 0 ) {
 		if ( cbit(CHARA_BIT_VINDALIAN_JIUJITSU_ACTIVE, cc) == TRUE ) {
@@ -10146,14 +10247,14 @@
 	}
 	if ( cdata(CDATA_MAX_HP, r1) < 1 ) {
 		cdata(CDATA_MAX_HP, r1) = 1
 	}
 	if ( r1 >= 57 & cdata(CDATA_ALLIED, r1) == 0 & r1 != 0 ) {
-		if ( cdata(CDATA_DRAIN_HP, r1) < 100 ) {
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1) < 100 ) {
 			cdata(CDATA_DV, r1) += limit(cdata(CDATA_LEVEL, r1) / 2, 1, 200)
 		}
-		if ( cdata(CDATA_DRAIN_HP, r1) < 100 ) {
+		if ( cdata((60 /*!!!@[CDATA_DRAIN_HP @@@ CDATA_GUARD_BREAK]@!!! */), r1) < 100 ) {
 			cdata(CDATA_PV, r1) += limit(cdata(CDATA_LEVEL, r1) / 2, 1, 200)
 		}
 		if ( cdata(CDATA_QUALITY, r1) == FIX_QUALITY_GREAT ) {
 			cdata(CDATA_MAX_HP, r1) = cdata(CDATA_MAX_HP, r1) * 3 / 2
 		}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.19R-borscht/system.hsp ../2.20-borscht/system.hsp
--- ../2.19R-borscht/system.hsp	2023-08-08 08:52:08.291652400 +0800
+++ ../2.20-borscht/system.hsp	2023-10-08 12:53:02.512555300 +0800
@@ -38,11 +38,11 @@
 	}
 	gdata(GDATA_TEMPORARY_FLAGS2) = 0
 	return
 
 *fixSave
-	if ( gdata(GDATA_VERSION) != int(double("6.20") * 1000) ) {
+	if ( gdata(GDATA_VERSION) != int(double("6.22") * 1000) ) {
 		dialog lang("Ver." + gdata(GDATA_VERSION) + "のセーブデータをアップデートします。", "Updating your save data from Ver." + gdata(GDATA_VERSION) + " now.")
 	}
 	if ( gdata(GDATA_HEIR_DEED) < 0 ) {
 		gdata(GDATA_HEIR_DEED) = 1
 	}
@@ -422,12 +422,12 @@
 				inv(INV_ITEM_DV, ci) = inv(INV_ITEM_NEED_SLEEP, ci)
 			}
 			if ( inv(INV_ITEM_AMUR_CAGE, ci) != 0 ) {
 				inv(INV_ITEM_DAMAGE, ci) = inv(INV_ITEM_AMUR_CAGE, ci)
 			}
-			if ( inv(INV_ITEM_SHOP_SAMPLE, ci) != 0 ) {
-				inv(INV_ITEM_ATTACK, ci) = inv(INV_ITEM_SHOP_SAMPLE, ci)
+			if ( inv(INV_ITEM_PARTS, ci) != 0 ) {
+				inv(INV_ITEM_ATTACK, ci) = inv(INV_ITEM_PARTS, ci)
 			}
 			if ( inv(INV_ITEM_QUALITY, ci) == FIX_QUALITY_UNIQUE ) {
 				saiseiseimode = 50
 			}
 			else {
@@ -641,11 +641,11 @@
 	if ( gdata(GDATA_VERSION) < 3060 ) {
 		repeat 450 - 300, 300
 			if ( adata(ADATA_ID, cnt) != AREA_SHOP ) {
 				continue
 			}
-			adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), cnt) = 0
+			adata((37 /*!!!@[ADATA_LABOR_CAMP_TOIL_ENERGY @@@ ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), cnt) = 0
 			adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), cnt) = 0
 		loop
 	}
 	if ( gdata(GDATA_VERSION) < 3080 ) {
 		if ( gdata(GDATA_FLAG_GAME_MODE) == 5 ) {
@@ -816,17 +816,17 @@
 		}
 	}
 	if ( gdata(GDATA_VERSION) < 6140 ) {
 		gdata(GDATA_FLAG_MOST_EXPENSIVE_WORLD_MAP_VEHICLE_THIS_MONTH) = gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND)
 		repeat 245
-			cdata(CDATA_SP_EARNED, cnt) = 0
-			if ( cdata(CDATA_TAMER_WHIP_PICKUP, cnt) != 0 ) {
-				cdata(CDATA_TAMER_WHIP_PICKUP, cnt) = 0
+			cdata(CDATA_PREGNANCY_PROGRESS, cnt) = 0
+			if ( cdata(CDATA_PREGNANCY_MALE_CHILD, cnt) != 0 ) {
+				cdata(CDATA_PREGNANCY_MALE_CHILD, cnt) = 0
 				cbitmod CHARA_BIT_PROHIBIT_PICKING_UP_ITEMS, cnt, TRUE
 			}
-			if ( cdata(CDATA_TAMER_WHIP_EAT, cnt) != 0 ) {
-				cdata(CDATA_TAMER_WHIP_EAT, cnt) = 0
+			if ( cdata(CDATA_PREGNANCY_FEMALE_CHILD, cnt) != 0 ) {
+				cdata(CDATA_PREGNANCY_FEMALE_CHILD, cnt) = 0
 				cbitmod CHARA_BIT_PROHIBIT_EATING_FROM_GROUND, cnt, TRUE
 			}
 		loop
 	}
 	if ( gdata(GDATA_VERSION) < 6160 ) {
@@ -865,15 +865,25 @@
 			cdata(CDATA_MATERIAL4_COUNTER, CHARA_PLAYER) = cdata(CDATA_MATERIAL5_COUNTER, CHARA_PLAYER) - 1
 		}
 		cdata(CDATA_MATERIAL1_COUNTER, CHARA_PLAYER) = 1
 		cdata(CDATA_SPINDLE_COMBINATION_B, CHARA_PLAYER) = 1
 	}
-	if ( gdata(GDATA_VERSION) != int(double("6.20") * 1000) ) {
+	if ( gdata(GDATA_VERSION) < 6210 ) {
+		if ( cdata(CDATA_MATERIAL3_COUNTER, CHARA_PLAYER) > 0 ) {
+			if ( spact(SKILL_SPACT_EYE_OF_ANE - STARTING_SKILL_SPACT) == 0 ) {
+				spact(SKILL_SPACT_EYE_OF_ANE - STARTING_SKILL_SPACT) = 1
+				txtmore
+				txtef COLOR_YELLOW
+				txt lang("あなたは「" + skillname(SKILL_SPACT_EYE_OF_ANE) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_EYE_OF_ANE) + ".")
+			}
+		}
+	}
+	if ( gdata(GDATA_VERSION) != int(double("6.22") * 1000) ) {
 		gdata(GDATA_WORLD_RENEW) = TRUE
 	}
 	del_chara 56
-	if ( gdata(GDATA_VERSION) > int(double("6.20") * 1000) ) {
+	if ( gdata(GDATA_VERSION) > int(double("6.22") * 1000) ) {
 		dialog "invalid version"
 		goto *exit_game
 	}
 	if ( gdata(GDATA_PLAY_TIME) < 0 ) {
 		gdata(GDATA_PLAY_TIME) = 0
@@ -923,11 +933,11 @@
 		if ( gdata(GDATA_GAMEMODE_PENALTY) == 1 ) {
 			gdata(GDATA_GAMEMODE_PENALTY) = 0
 			snd SOUNDLIST_ENC
 		}
 	}
-	gdata(GDATA_VERSION) = int(double("6.20") * 1000)
+	gdata(GDATA_VERSION) = int(double("6.22") * 1000)
 	cbitmod CHARA_BIT_PCC, CHARA_PLAYER, TRUE
 	gdata(GDATA_SPEEDSUM_RESET) = 1
 	gosub *initial_recipe
 	return
 
@@ -3390,11 +3400,11 @@
 		pos x, y
 		mesbox inputlog, 600, 0, 5, val(2) * (1 + en)
 		pos x + 4, y + 4
 		gfini dx - 1, 35
 		gfdec 60, 60, 60
-		aplsel "ElonaPlus 2.19R"
+		aplsel "ElonaPlus 2.20fix1"
 		if ( stat == 1 ) {
 			dialog "Failed to get WINDOW ID", 1
 			clrobj 1
 			cfg_msg_box = 0
 			goto *prompt_word
@@ -3753,11 +3763,11 @@
 
 *game_debug
 	notesel dbm
 	buff = ""
 	if ( dbm == "" ) {
-		noteadd "ElonaPlus 2.19R" + " v" + "6.20" + " Debug Console    Type \"?\" for help. Hit ESC to exit."
+		noteadd "ElonaPlus 2.20fix1" + " v" + "6.22" + " Debug Console    Type \"?\" for help. Hit ESC to exit."
 		noteadd ""
 	}
 	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
 	objmode 2
 	pos 0, 24
@@ -4106,11 +4116,11 @@
 			loop
 			noteadd "Done."
 			goto *console_write
 		}
 		if ( instr(buff, 0, "gain_spact") != (-1) ) {
-			repeat 855 - 600
+			repeat 856 - 600
 				spact(cnt + STARTING_SKILL_SPACT - STARTING_SKILL_SPACT) = 1
 			loop
 			noteadd "Done."
 			goto *console_write
 		}
@@ -4164,11 +4174,11 @@
 	objprm 1, dbm
 	objprm 2, ""
 	return
 
 *mutexobj
-	CreateMutexA 0, 0, "ElonaPlus 2.19R"
+	CreateMutexA 0, 0, "ElonaPlus 2.20fix1"
 	mutex_handle = stat
 	func_3
 	if ( stat == 183 ) {
 		dialog lang("二重起動のため終了します。", "The program is already running."), 1
 		end
