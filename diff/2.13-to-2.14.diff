diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/action.hsp ../2.14-borscht/action.hsp
--- ../2.13-borscht/action.hsp	2022-06-26 12:14:11.385344500 -0700
+++ ../2.14-borscht/action.hsp	2022-09-18 12:36:58.440858300 -0700
@@ -92,11 +92,11 @@
 			inv(INV_ITEM_Y, ti) = tlocy
 			ci = ti
 		}
 	}
 	if ( cc == CHARA_PLAYER ) {
-		gosub *calcBurdenPc
+		gosub *label_4102
 	}
 	animeid = ANIMATION_CRUSH
 	x = tlocx
 	y = tlocy
 	gosub *anime
@@ -116,23 +116,23 @@
 			txtmore
 			txt lang(name(tc) + "に見事に命中した！", "It hits " + name(tc) + "!")
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MONSTER_BALL ) {
 				if ( tc < MAX_CHARA_SAVE | cdata(CDATA_ROLE, tc) != ROLE_NONE | cdata(CDATA_QUALITY, tc) == FIX_QUALITY_UNIQUE | cbit(CHARA_BIT_PRECIOUS, tc) == TRUE | cbit(CHARA_BIT_NECRO, tc) == TRUE | gdata(GDATA_FLAG_DUEL_TARGET) == tc ) {
 					txt lang("その生物には無効だ。", "The creature can't be captured.")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( cdata(CDATA_LEVEL, tc) > inv(INV_ITEM_PARAM2, ci) ) {
 					txt lang("その生物を捕獲するには、より高レベルのモンスターボールが必要だ。", "Power level of the ball is not enough to capture the creature.")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( cdata(CDATA_HP, tc) > cdata(CDATA_MAX_HP, tc) / 10 ) {
 					txt lang("捕獲するためにはもっと弱らせる必要がある。", "You need to weaken the creature to capture it.")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( gdata(GDATA_AREA) == AREA_ARENA | gdata(GDATA_AREA) == AREA_PET_ARENA | gdata(GDATA_AREA) == AREA_SHOW_HOUSE | (gdata(GDATA_AREA) == AREA_SHELTER & gdata(GDATA_LEVEL) == 1) ) {
 					txt lang("この場所では捕獲できない。", "This doesn't work in this area.")
-					goto *turn_end
+					goto *label_9247
 				}
 				txtef COLOR_GREEN
 				txt lang(name(tc) + "をモンスターボールに捕獲した。", "You capture " + name(tc) + ".")
 				animeload 8, tc
 				inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, tc)
@@ -141,23 +141,23 @@
 				inv(INV_ITEM_VALUE, ci) = 1000
 			}
 			else {
 				if ( cdata(CDATA_ID, tc) != CREATURE_ID_LITTLE_SISTER | tc < MAX_CHARA_FOLLOWER | gdata(GDATA_FLAG_DUEL_TARGET) == tc ) {
 					txt lang("何もおきない… ", "Nothing happens...")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( gdata(GDATA_AREA) == AREA_ARENA | gdata(GDATA_AREA) == AREA_PET_ARENA | gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
 					txt lang("この場所では効果がない。", "This doesn't work in this area.")
-					goto *turn_end
+					goto *label_9247
 				}
 				rc = tc
 				gosub *add_ally
 			}
 			chara_vanquish tc
 			check_quest
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_POTION | inv(INV_ITEM_ID, ci) == ITEM_ID_TOMATO | inv(INV_ITEM_ID, ci) == ITEM_ID_BUTTER | inv(INV_ITEM_ID, ci) == ITEM_ID_YOGURT | inv(INV_ITEM_ID, ci) == ITEM_ID_NATTO | inv(INV_ITEM_ID, ci) == ITEM_ID_KEMURIDAMA | inv(INV_ITEM_ID, ci) == ITEM_ID_DYING_CICADA ) {
 		if ( inv(INV_ITEM_ID, ci) != ITEM_ID_EMPTY_BOTTLE ) {
 			if ( synccheck(tlocx, tlocy) ) {
 				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HANDFUL_SNOW ) {
@@ -200,11 +200,11 @@
 								txtef COLOR_SKY_BLUE
 								txtmore
 								txt lang("「いてー！」", cnvtalk("Hey!")), lang("「やったな」", cnvtalk("Now you did it.")), lang(" *クスクス* ", "*chuckle*"), lang("「キャハハ」", cnvtalk("Tee-hee-hee!")), lang("「こやつめ」", cnvtalk("You'll pay for this.")), lang("「むむっ」", "*grin*")
 							}
 						}
-						goto *turn_end
+						goto *label_9247
 					}
 					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOMATO ) {
 						if ( synccheck(tc, -1) ) {
 							txtef COLOR_BLUE
 							txt lang(" *ぷちゅ* ", "*crumble*")
@@ -218,11 +218,11 @@
 								cdata(CDATA_CONDITION_ANGRY, tc) += rnd(10) + 5
 							}
 						}
 						inv(INV_ITEM_NUM, ci)--
 						cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-						goto *turn_end
+						goto *label_9247
 					}
 					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DYING_CICADA ) {
 						kaiwa = rnd(2)
 						txtef COLOR_BLUE
 						txt lang(" *必殺セミファイナル！* ", "*cicada*")
@@ -253,11 +253,11 @@
 						itemcreate -1, ITEM_ID_BAIT, cdata(CDATA_X, tc), cdata(CDATA_Y, tc), 0
 						inv(INV_ITEM_PARAM1, ci) = 4
 						inv(INV_ITEM_PIC, ci) = xy2pic(26, 11)
 						inv(INV_ITEM_VALUE, ci) = 4 * 4 * 500 + 200
 						cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-						goto *turn_end
+						goto *label_9247
 					}
 					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_NATTO ) {
 						if ( synccheck(tc, -1) ) {
 							txtef COLOR_BLUE
 							txt lang(" *ねばー* ", "*crumble*")
@@ -269,11 +269,11 @@
 						if ( cdata(CDATA_CONDITION_ANGRY, tc) == 0 ) {
 							cdata(CDATA_CONDITION_ANGRY, tc) += 5 + inv(INV_ITEM_LEVEL, ci)
 						}
 						inv(INV_ITEM_NUM, ci)--
 						cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-						goto *turn_end
+						goto *label_9247
 					}
 					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BUTTER ) {
 						if ( synccheck(tc, -1) ) {
 							txtef COLOR_YELLOW
 							txt lang(name(tc) + "は香ばしいバターまみれになった。「べちゃべちゃする…」", name(tc) + " " + is(tc) + " engulfed in fury!")
@@ -282,21 +282,21 @@
 							cdata(CDATA_BRUSH_LEVEL, tc)++
 						}
 						cdata(CDATA_CONDITION_OIL, tc) += 15
 						inv(INV_ITEM_NUM, ci)--
 						cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-						goto *turn_end
+						goto *label_9247
 					}
 					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_YOGURT ) {
 						if ( synccheck(tc, -1) ) {
 							txtef COLOR_BLUE
 							txt lang(name(tc) + "は怒りに体を奮わせた！", name(tc) + " " + is(tc) + " engulfed in fury!")
 						}
 						cdata(CDATA_CONDITION_ANGRY, tc) += rnd(3) + 5
 						inv(INV_ITEM_NUM, ci)--
 						cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-						goto *turn_end
+						goto *label_9247
 					}
 					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MOLOTOV ) {
 						if ( synccheck(tc, -1) ) {
 							txtef COLOR_BLUE
 							txt lang(name(tc) + "は、燃料まみれになった。", name(tc) + " became the oil covered.")
@@ -316,11 +316,11 @@
 					gosub *db_item
 					cc = ccthrowpotion
 					if ( findbuff(cc, BUFF_POWER_ITEM) != (-1) ) {
 						modgauge cc, 5
 					}
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HANDFUL_SNOW ) {
 				if ( map(tlocx, tlocy, MAP_ITEM_CHIPS) != 0 ) {
 					cell_itemlist tlocx, tlocy
@@ -337,17 +337,17 @@
 							break
 						}
 					loop
 					if ( f == 1 ) {
 						cell_refresh tlocx, tlocy
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HANDFUL_SNOW ) {
 				if ( chipm(CHIPM_ROLE, map(tlocx, tlocy, MAP_TILE_ID)) == MAP_CHIP_ROLE_SNOW ) {
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( synccheck(tlocx, tlocy) ) {
 					txtmore
 					txt lang("それは地面に落ちて溶けた。", "It falls on the ground and melts.")
 				}
@@ -378,39 +378,39 @@
 				itemcreate -1, ITEM_ID_BAIT, tlocx, tlocy, 0
 				inv(INV_ITEM_PARAM1, ci) = 4
 				inv(INV_ITEM_PIC, ci) = xy2pic(26, 11)
 				inv(INV_ITEM_VALUE, ci) = 4 * 4 * 500 + 200
 				cell_refresh tlocx, tlocy
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_YOGURT | inv(INV_ITEM_ID, ci) == ITEM_ID_BUTTER | inv(INV_ITEM_ID, ci) == ITEM_ID_NATTO ) {
 				inv(INV_ITEM_NUM, ci)--
 				cell_refresh tlocx, tlocy
 				if ( synccheck(tlocx, tlocy) ) {
 					txtef COLOR_BLUE
 					txt lang(" *べちゃ* ", "*crumble*")
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOMATO ) {
 				inv(INV_ITEM_NUM, ci)--
 				cell_refresh tlocx, tlocy
 				if ( synccheck(tlocx, tlocy) ) {
 					txtef COLOR_BLUE
 					txt lang(" *ぷちゅ* ", "*crumble*")
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 			efp = 50 + sdata(SKILL_WEAPON_THROWING, cc) * 10
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BOTTLE_SULFURIC ) {
 				addmef tlocx, tlocy, MEF_TYPE_ACID, xy2pic(19, 0), rnd(15) + 5, efp, cc
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MOLOTOV ) {
 				addmef tlocx, tlocy, MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 25, efp, cc
 				mapitem_fire tlocx, tlocy
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_KEMURIDAMA ) {
 				p = 3
 				repeat 120
 					x = rnd(p) + tlocx - rnd(p)
@@ -435,17 +435,17 @@
 							continue cnt
 						}
 					}
 					addmef x, y, MEF_TYPE_KEMURIDAMA, xy2pic(6, 29), 30, 500
 				loop
-				goto *turn_end
+				goto *label_9247
 			}
 			addmef tlocx, tlocy, MEF_TYPE_POTION, xy2pic(27, 0), -1, efp, cc, inv(INV_ITEM_ID, ci), inv(INV_ITEM_STATUS, ci), inv(INV_ITEM_COL, ci)
 			if ( findbuff(cc, BUFF_POWER_ITEM) != (-1) ) {
 				modgauge cc, 5
 			}
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SUIGARA ) {
 		snd SOUNDLIST_THROW2
 		snd SOUNDLIST_FIRE1
@@ -466,11 +466,11 @@
 		}
 		else {
 			addmef tlocx, tlocy, MEF_TYPE_FIRE, xy2pic(24, 0), 5 + rnd(5), 40, cc
 			mapitem_fire tlocx, tlocy
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CHESTNUT & inv(INV_ITEM_PARAM2, ci) == 0 ) {
 		snd SOUNDLIST_THROW2
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
@@ -503,11 +503,11 @@
 			}
 			if ( gdata(GDATA_FLAG_THROWN_CHESTNUTS) < 100 ) {
 				gdata(GDATA_FLAG_THROWN_CHESTNUTS)++
 			}
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_LULWYS_PHOTO_COLLECTION ) {
 		snd SOUNDLIST_THROW2
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
@@ -515,11 +515,11 @@
 			if ( synccheck(tc, -1) ) {
 				txt lang(name(tc) + "の足元に落ちた。", "It hits " + name(tc) + "!")
 			}
 			rowact_check tc
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DUEL_GLOVE ) {
 		snd SOUNDLIST_THROW2
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
@@ -527,11 +527,11 @@
 			if ( synccheck(tc, -1) ) {
 				txt lang(name(tc) + "の足元に落ちた。", "It hits " + name(tc) + "!")
 			}
 			rowact_check tc
 			if ( cdata(CDATA_CONDITION_SLEEP, tc) != 0 | cdata(CDATA_CONDITION_PARALYZE, tc) != 0 | cdata(CDATA_CONDITION_BLIND, tc) != 0 | cdata(CDATA_CONDITION_FEAR, tc) != 0 | cdata(CDATA_CONDITION_DIM, tc) != 0 ) {
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( gdata(GDATA_FLAG_DUEL_TARGET) <= 0 & gdata(GDATA_FLAG_DUEL_TARGET) != tc & cdata(CDATA_RELATION, tc) == RELATION_NEUTRAL & tc >= MAX_CHARA_FOLLOWER ) {
 				gdata(GDATA_FLAG_DUEL_TARGET) = tc
 				gdata(GDATA_FLAG_TIMES_DUELED)++
 				snd SOUNDLIST_GET1
@@ -548,11 +548,11 @@
 				if ( tc != CHARA_PLAYER ) {
 					txt lang(name(tc) + "に鼻で笑われた。", name(tc) + " ridiculed you.")
 				}
 			}
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SOYBEAN | inv(INV_ITEM_ID, ci) == ITEM_ID_TOFU ) {
 		snd SOUNDLIST_THROW2
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
@@ -583,11 +583,11 @@
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOFU ) {
 				snd SOUNDLIST_BASH1
 				dmghp tc, sdata(SKILL_WEAPON_THROWING, cc) * inv(INV_ITEM_LEVEL, ci) + rnd(sdata(SKILL_WEAPON_THROWING, cc) + 10) + 1, cc, SKILL_RESDMG_TOFU, 1000
 			}
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_JUNK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ENVIRONMENT ) {
 		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
 			tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
 			if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
@@ -719,11 +719,11 @@
 		}
 		else {
 			snd SOUNDLIST_THROW2
 		}
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( synccheck(tlocx, tlocy) ) {
 		txt lang("それは地面に落ちて砕けた。", "It falls on the ground and shatters.")
 		snd SOUNDLIST_CRUSH2
 	}
@@ -731,19 +731,19 @@
 		if ( inv(INV_ITEM_PROPERTY, ci) != PROP_SPECIAL ) {
 			flt
 			itemcreate -1, ITEM_ID_GOLD_PIECE, tlocx, tlocy, inv(INV_ITEM_PARAM1, ci)
 		}
 	}
-	goto *turn_end
+	goto *label_9247
 
 *act_pray
 	item_find 60002
 	if ( stat != (-1) ) {
 		ci = stat
 		if ( inv(INV_ITEM_PARAM1, ci) != cdata(CDATA_GOD, CHARA_PLAYER) ) {
 			gosub *god_select
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	goto *god_pray
 
 *act_exchange
@@ -830,11 +830,11 @@
 					if ( inv_getspace(CHARA_PLAYER) == 0 ) {
 						txt lang("バックパックが一杯だ。", "Your inventory is full.")
 						return 0
 					}
 					gdata(GDATA_ROW_ACT) = ACTION_HARVEST
-					gosub *generalAct
+					gosub *label_6023
 					return -1
 				}
 			}
 		}
 		if ( inv(INV_ITEM_PROPERTY, ci) == PROP_CONSTRUCT ) {
@@ -1087,14 +1087,14 @@
 		if ( gdata(GDATA_AREA) == AREA_HOME ) {
 			if ( mode == MODELIST_MAIN ) {
 				gosub *house_update
 			}
 		}
-		gosub *calcBurdenPc
+		gosub *label_4102
 	}
 	if ( cc == (-1) ) {
-		gosub *calcBurdenPc
+		gosub *label_4102
 	}
 	return 1
 
 *act_drop
 	inumbk = inv(INV_ITEM_NUM, ci) - in
@@ -1128,11 +1128,11 @@
 		screenupdate = -1
 		gosub *screen_draw
 		snd SOUNDLIST_DROP1
 		txt lang(itemname(ti, in) + "を地面に置いた。", "You drop " + itemname(ti, in) + ".")
 	}
-	gosub *calcBurdenPc
+	gosub *label_4102
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
 		if ( chipm(CHIPM_ROLE, map(inv(INV_ITEM_X, ti), inv(INV_ITEM_Y, ti), MAP_TILE_ID)) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
 			inv(INV_ITEM_SHOP_SAMPLE, ti) = 100
 		}
 	}
@@ -1165,11 +1165,11 @@
 		mdata(MDATA_FIRE_SOUND) = 1
 		gosub *music_play
 	}
 	return 1
 
-*act_equip
+*label_6352
 	if ( ci == (-1) ) {
 		return 0
 	}
 	if ( cdata(body, r1) \ EXT_EQUIP_SLOTS != 0 ) {
 		return 0
@@ -1183,11 +1183,11 @@
 	}
 	inv(INV_ITEM_EQUIP, ci) = body
 	cdata(body, r1) = cdata(body, r1) / EXT_EQUIP_SLOTS * 10000 + ci + 1
 	return 1
 
-*act_unequip
+*label_6353
 	p = cdata(body, r1) \ EXT_EQUIP_SLOTS
 	if ( p == 0 ) {
 		rtval = -2
 		return
 	}
@@ -1213,11 +1213,11 @@
 
 *act_read
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_RECIPE ) {
 		if ( inv(INV_ITEM_SUB_NAME, ci) == 0 ) {
 			txt lang("最後に調合したアイテムを、レシピに加えることができる。", "You can add a recipe of the item you previously created.(Not implemented yet)")
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	efid = (0 /*!!!@[BUFF_NONE @@@ SKILL_NONE]@!!! */)
 	dbmode = DBMODE_ON_READ
 	dbid = inv(INV_ITEM_ID, ci)
@@ -1226,11 +1226,11 @@
 		goto *building_new
 	}
 	if ( findbuff(cc, BUFF_POWER_ITEM) != (-1) ) {
 		modgauge cc, 5
 	}
-	goto *turn_end
+	goto *label_9247
 
 *act_eat
 	if ( cc == CHARA_PLAYER ) {
 		cargocheck
 		if ( stat == 0 ) {
@@ -1253,11 +1253,11 @@
 			}
 		}
 	}
 	cdata(CDATA_EMO_ICON, cc) = 16 + 100
 	gosub *eat
-	goto *turn_end
+	goto *label_9247
 
 *act_drink
 	dbmode = DBMODE_ON_DRINK
 	dbid = inv(INV_ITEM_ID, ci)
 	gosub *db_item
@@ -1269,11 +1269,11 @@
 	if ( cc == CHARA_PLAYER ) {
 		if ( inv(INV_ITEM_PIC, ci) == xy2pic(24, 10) ) {
 			gdata(GDATA_FLAG_TOTAL_POTION_PLUGS)++
 		}
 	}
-	goto *turn_end
+	goto *label_9247
 
 *act_zap
 	if ( cc != CHARA_PLAYER ) {
 		if ( rnd(2) == 0 | cdata(CDATA_TARGET, cc) == 0 | cdata(CDATA_TARGET, cc) == 0 | cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE | cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_TALKING ) {
 			goto *ai_action
@@ -1296,11 +1296,11 @@
 		}
 	}
 	if ( findbuff(cc, BUFF_POWER_ITEM) != (-1) ) {
 		modgauge cc, 5
 	}
-	goto *turn_end
+	goto *label_9247
 
 *act_bash
 	if ( map(x, y, MAP_ITEM_CHIPS_MEMORY) != 0 ) {
 		if ( mapitemfind(x, y, ITEM_ID_TREE_FRUIT) != (-1) ) {
 			ci = mapitemfind(x, y, ITEM_ID_TREE_FRUIT)
@@ -1308,11 +1308,11 @@
 			snd SOUNDLIST_BASH1
 			txt lang(itemname(ci) + "に体当たりした。", "You throw your weight against " + itemname(ci) + ".")
 			if ( inv(INV_ITEM_PROPERTY, ci) == PROP_SPECIAL | inv(INV_ITEM_PARAM1, ci) <= 0 ) {
 				txtmore
 				txt lang("もう実はないようだ… ", "It seems there are no fruits left on the tree.")
-				goto *turn_end
+				goto *label_9247
 			}
 			inv(INV_ITEM_PARAM1, ci)--
 			if ( inv(INV_ITEM_PARAM1, ci) <= 0 ) {
 				inv(INV_ITEM_PIC, ci) = xy2pic(31, 17)
 				cell_refresh x, y
@@ -1323,11 +1323,11 @@
 				}
 			}
 			flt
 			itemcreate -1, inv(INV_ITEM_PARAM2, ci), x, y, 0
 			txt lang(itemname(ci, 1) + "が降ってきた。", itemname(ci, 1) + " falls down from the tree.")
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( map(x, y, MAP_ITEM_CHIPS_MEMORY) != 0 ) {
 		if ( mapitemfind(x, y, ITEM_ID_KITTY_BANK) != (-1) ) {
 			ci = mapitemfind(x, y, ITEM_ID_KITTY_BANK)
@@ -1339,11 +1339,11 @@
 				inv(INV_ITEM_NUM, ci)--
 				snd SOUNDLIST_CRUSH2
 				flt
 				itemcreate -1, ITEM_ID_GOLD_PIECE, tlocx, tlocy, okane
 			}
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
 		tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
 		if ( cc == CHARA_PLAYER ) {
@@ -1402,11 +1402,11 @@
 		}
 		if ( cdata(CDATA_CONDITION_DIM, tc) > 60 ) {
 			cdata(CDATA_CONDITION_DIM, tc) = 59
 		}
 		cdata(CDATA_CONDITION_SLEEP, tc) = 0
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( map(x, y, MAP_FEATS_ON_TILE) != 0 ) {
 		cell_featread x, y
 		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_POT ) {
 			map(x, y, MAP_FEATS_ON_TILE) = 0
@@ -1419,11 +1419,11 @@
 				txt lang(name(cc) + "は壷を割った。", name(cc) + " shatter" + _s(cc) + " the pot.")
 				snd SOUNDLIST_CRUSH1
 				animeid = ANIMATION_CRUSH
 				gosub *anime
 			}
-			goto *turn_end
+			goto *label_9247
 		}
 		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_DOOR_CLOSED ) {
 			snd SOUNDLIST_BASH1
 			p = feat(FEAT_CELL_SUB_FEATURE_ID) * 3 + 30
 			if ( gdata(GDATA_AREA) == AREA_JAIL ) {
@@ -1433,11 +1433,11 @@
 				txt lang("扉に体当たりして破壊した。", "You bash up the door. The door is destroyed.")
 				if ( feat(FEAT_CELL_SUB_FEATURE_ID) > sdata(SKILL_ATTR_STR, cc) ) {
 					skillexp SKILL_ATTR_STR, cc, (feat(FEAT_CELL_SUB_FEATURE_ID) - sdata(SKILL_ATTR_STR, cc)) * 15
 				}
 				cell_featset x, y, 0, CELL_FEATURE_NONE, 0, 0
-				goto *turn_end
+				goto *label_9247
 			}
 			else {
 				txt lang("扉に体当たりした。", "You bash up the door.")
 				if ( gdata(GDATA_AREA) == AREA_JAIL ) {
 					txt lang("さすがに牢獄の扉は頑丈だ。", "As might be expected, the door of the Jail is hard.")
@@ -1473,18 +1473,18 @@
 						if ( synccheck(cc, -1) ) {
 							txt lang("扉は少しだけ壊れた。", "The door is cracked a bit.")
 						}
 					}
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	txt_check 0
 	txt lang(name(cc) + "は空気に体当たりした。", name(cc) + " bash" + _s(cc) + " up the air.")
 	snd SOUNDLIST_MISS
-	goto *turn_end
+	goto *label_9247
 	gosub *search_for_chara
 	if ( cc == CHARA_PLAYER ) {
 	}
 	return
 
@@ -1648,11 +1648,11 @@
 						}
 					}
 				}
 				if ( cdata(CDATA_ROW_ACT, tc) == ACTION_EAT ) {
 					if ( cdata(CDATA_ACTION_PERIOD, tc) > 0 ) {
-						if ( cdata(CDATA_TAMER_WHIP_PICKUP, tc) == 10 ) {
+						if ( cbit(1032, tc) == TRUE ) {
 							if ( cdata(CDATA_ITEM_USING, tc) >= 5080 ) {
 								txt lang(name(tc) + "はバツが悪そうにあなたを見た。", name(tc) + " stares in your face.")
 								cdata(CDATA_ROW_ACT, tc) = ACTION_NONE, 0
 							}
 							if ( cdata(CDATA_CUSTOM_TALK_LINE, tc) < gdata(GDATA_YEAR) * 10000 + gdata(GDATA_MONTH) * 100 + gdata(GDATA_DAY) ) {
@@ -1664,11 +1664,11 @@
 					}
 				}
 				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
 					ttc = cdata(CDATA_TAGTEAM_PARTNER, tc)
 					if ( cdata(CDATA_ROW_ACT, ttc) == ACTION_EAT ) {
-						if ( cdata(CDATA_TAMER_WHIP_PICKUP, ttc) == 10 ) {
+						if ( cbit(1032, ttc) == TRUE ) {
 							if ( cdata(CDATA_ACTION_PERIOD, ttc) > 0 ) {
 								if ( cdata(CDATA_ITEM_USING, ttc) >= 5080 ) {
 									txt lang(cdatan(CDATAN_NAME, ttc) + "はバツが悪そうにあなたを見た。", cdatan(CDATAN_NAME, ttc) + " stares in your face.")
 									cdata(CDATA_ROW_ACT, ttc) = ACTION_NONE, 0
 								}
@@ -1681,11 +1681,11 @@
 						}
 					}
 				}
 				if ( cdata(CDATA_ROW_ACT, tc) == ACTION_EAT ) {
 					if ( cdata(CDATA_ACTION_PERIOD, tc) > 0 ) {
-						if ( cdata(CDATA_TAMER_WHIP_PICKUP, tc) != 10 | (cdata(CDATA_TAMER_WHIP_PICKUP, tc) == 10 & cdata(CDATA_ITEM_USING, tc) < 5080) ) {
+						if ( cbit(1032, tc) != TRUE | (cbit(1032, tc) == TRUE & cdata(CDATA_ITEM_USING, tc) < 5080) ) {
 							if ( cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) < 200 ) {
 								txt lang(name(tc) + "はあなたを睨み付けた。", name(tc) + " glare" + _s(tc) + " you.")
 							}
 							if ( cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) >= 200 & cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) < 250 ) {
 								txt lang(name(tc) + "はあなたを不満げに見つめた。", name(tc) + " looked away you with dissatisfaction.")
@@ -1705,11 +1705,11 @@
 					}
 				}
 				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
 					ttc = cdata(CDATA_TAGTEAM_PARTNER, tc)
 					if ( cdata(CDATA_ROW_ACT, ttc) == ACTION_EAT ) {
-						if ( cdata(CDATA_TAMER_WHIP_PICKUP, ttc) != 10 | (cdata(CDATA_TAMER_WHIP_PICKUP, ttc) == 10 & cdata(CDATA_ITEM_USING, ttc) < 5080) ) {
+						if ( cbit(1032, ttc) != TRUE | (cbit(1032, ttc) == TRUE & cdata(CDATA_ITEM_USING, ttc) < 5080) ) {
 							if ( cdata(CDATA_ACTION_PERIOD, ttc) > 0 ) {
 								if ( cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) < 200 ) {
 									txt lang(cdatan(CDATAN_NAME, ttc) + "はあなたを睨み付けた。", cdatan(CDATAN_NAME, ttc) + " glare" + _s(ttc) + " you.")
 								}
 								if ( cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) >= 200 & cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) < 250 ) {
@@ -1729,11 +1729,11 @@
 							}
 						}
 					}
 				}
 				gosub *cell_info
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		if ( gdata(GDATA_RIDER) != 0 ) {
 			if ( cdata(CDATA_RELATION, tc) < RELATION_DISLIKE ) {
 				if ( findbuff(CHARA_PLAYER, BUFF_HYPER_DASH) != (-1) ) {
@@ -1761,11 +1761,11 @@
 					if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
 						skillexp SKILL_ACTIVE_RIDING, CHARA_PLAYER, 30
 						skillexp SKILL_ACTIVE_RIDING, gdata(GDATA_RIDER), 20
 					}
 					gosub *cell_info
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 		}
 		if ( running ) {
 			if ( cdata(CDATA_RELATION, tc) >= RELATION_HATE | keybd_wait >= 40 ) {
@@ -1783,19 +1783,19 @@
 			}
 			if ( keybd_attacking == 0 ) {
 				keybd_wait = 1
 				keybd_attacking = 1
 			}
-			gosub *act_melee
-			goto *turn_end
+			gosub *label_6394
+			goto *label_9247
 		}
 		gosub *chat
 		if ( chatteleport == 1 ) {
 			chatteleport = 0
 			goto *map_exit
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	else {
 		keybd_attacking = 0
 	}
 	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
@@ -1858,11 +1858,11 @@
 								gdata(GDATA_TIME_STOP_TIME) = 0
 								gdata(GDATA_TIME_LIMIT) = 0
 								if ( qexit == 0 ) {
 									evadd EVENT_QUEST_TIMEOUT
 								}
-								goto *turn_end
+								goto *label_9247
 							}
 							gdata(GDATA_LAST_EDGE_X) = cdata(CDATA_X, CHARA_PLAYER)
 							gdata(GDATA_LAST_EDGE_Y) = cdata(CDATA_Y, CHARA_PLAYER)
 							snd SOUNDLIST_EXITMAP1
 							if ( gdata(GDATA_QUEST) == QUEST_TYPE_THIEVES ) {
@@ -1872,11 +1872,11 @@
 								gdata(GDATA_LEVEL)--
 								levelexitby = MAP_EXIT_NORMAL
 								goto *map_exit
 							}
 							if ( qexit == 100 ) {
-								goto *turn_end
+								goto *label_9247
 							}
 						}
 						goto *pc_turn
 					}
 				}
@@ -1893,11 +1893,11 @@
 			goto *com_quest
 		}
 		if ( cellfeat == 31 ) {
 			snd SOUNDLIST_CHAT
 			gosub *com_vote_new
-			goto *turn_end
+			goto *label_9247
 		}
 		if ( cellfeat == 33 ) {
 			menucycle = 1
 			gosub *com_politics_chart
 			goto *pc_turn
@@ -1914,29 +1914,29 @@
 	if ( cc == CHARA_PLAYER ) {
 		gdata(GDATA_FLAG_CURTAIN_CALL) = 0
 	}
 	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE ) {
 		if ( cdata(CDATA_TARGET, cc) != 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( cdata(CDATA_CONDITION_BIND, cc) > 0 ) {
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( cdata(CDATA_IN_TAGTEAM, cc) == (-1) ) {
 		tcc = cdata(CDATA_TAGTEAM_PARTNER, cc)
 		if ( cdata(CDATA_ROW_ACT, tcc) == ACTION_EAT ) {
 			if ( cdata(CDATA_ACTION_PERIOD, tcc) > 0 ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( cbit(CHARA_BIT_RIDE, cc) ) {
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( cdata(CDATA_IN_TAGTEAM, cc) == 1 ) {
-		goto *turn_end
+		goto *label_9247
 	}
 	dx = cdata(CDATA_X_NEW, cc)
 	dy = cdata(CDATA_Y_NEW, cc)
 	if ( cc < MAX_CHARA_FOLLOWER ) {
 		if ( cc != CHARA_PLAYER ) {
@@ -1983,22 +1983,22 @@
 				else {
 					mef(MEF_POWER, i) = mef(MEF_POWER, i) * 3 / 4
 					if ( synccheck(cc, -1) ) {
 						txt lang(name(cc) + "は蜘蛛の巣にひっかかった。", name(cc) + " " + is(cc) + " caught in a cobweb.")
 					}
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 		}
 	}
 	if ( dbg_notravel == 0 ) {
 		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 			if ( cc == CHARA_PLAYER ) {
 				if ( traveldone == 0 ) {
 					gosub *travel
 					keybd_wait = 1
-					goto *turn_end
+					goto *label_9247
 				}
 				else {
 					traveldone = 0
 				}
 			}
@@ -2198,11 +2198,11 @@
 				}
 				encounter = ENCOUNTER_NONE
 			}
 		}
 	}
-	goto *turn_end
+	goto *label_9247
 
 *cell_info
 	if ( cc == CHARA_PLAYER ) {
 		gdata(GDATA_LAST_EDGE_X) = -1
 		gdata(GDATA_LAST_EDGE_Y) = -1
@@ -2515,11 +2515,11 @@
 			inv(INV_ITEM_NUM, stat)--
 			cell_refresh inv(INV_ITEM_X, stat), inv(INV_ITEM_Y, stat)
 			comctrl = 2
 			gosub *com_import
 			if ( stat == 1 ) {
-				goto *extract_map
+				goto *label_5895
 			}
 		}
 	}
 	cell_featread cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
 	movelevelbystairs = FALSE
@@ -2535,11 +2535,11 @@
 				gosub *screen_draw
 				goto *pc_turn
 			}
 			txt lang("まっくらだ！", "It's dark here!")
 			cdata(CDATA_CONDITION_BLIND, CHARA_PLAYER) += 2
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 715 & gdata(GDATA_FLAG_MAIN) < 760 & gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179 ) {
 		snd SOUNDLIST_FAIL1
 		txt lang("無力化しないと奴が神の間から出てきてしまう！", "If you do not weaken the <Chaos Child>, it will come out of God's prison!")
@@ -2710,15 +2710,15 @@
 			else {
 				txt lang("地下への扉を開けた。", "You unlock the door")
 			}
 			snd SOUNDLIST_CHEST1
 			cell_featset cdata(CDATA_X, cc), cdata(CDATA_Y, cc), tile_downstairs, CELL_FEATURE_DOWNSTAIRS
-			goto *turn_end
+			goto *label_9247
 		}
 		snd SOUNDLIST_LOCKED1
 		txt lang("鍵のかかった扉が行く手を塞いでいる。", "The door is locked. It seems you need a specific key to unlock the door.")
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANDOM_DUNGEON ) {
 		if ( gdata(GDATA_LEVEL) == adata(ADATA_MAX_LEVEL, gdata(GDATA_AREA)) ) {
 			if ( adata(ADATA_BOSS, gdata(GDATA_AREA)) != (-1) ) {
 				txt lang("クエストを放棄して階を移動する？", "Really give up the quest and move over?")
@@ -2760,11 +2760,11 @@
 	if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_NEFIA ) {
 		if ( feat(FEAT_CELL_SUB_FEATURE_ID) + feat(FEAT_CELL_PARAM_1) * 100 == 35 ) {
 			comctrl = 0
 			gosub *com_import
 			if ( stat == 1 ) {
-				goto *extract_map
+				goto *label_5895
 			}
 			else {
 				goto *pc_turn
 			}
 		}
@@ -2850,11 +2850,11 @@
 		invfile = inv(INV_ITEM_PARAM1, ci)
 		snd SOUNDLIST_CHEST1
 		gosub *shop
 		screenupdate = -1
 		gosub *screen_draw
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MASTERS_DELIVERY_CHEST ) {
 		invctrl = INVCTRL_PUT, 0
 		snd SOUNDLIST_INV
 		goto *com_inventory
@@ -2882,11 +2882,11 @@
 						gdata(GDATA_FLAG_FIRE_GIANT) = 1
 					}
 				}
 			}
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) != 0 ) {
 		invfile = inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci)
 		invcontainer(1) = ci
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_COOLER_BOX ) {
@@ -2974,26 +2974,26 @@
 		file = "shoptmp.s2"
 		fmode = 3
 		gosub *game_ctrlFile
 		if ( refweight != 0 ) {
 			inv(INV_ITEM_WEIGHT, invcontainer(1)) = refweight
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		gosub *screen_draw
 		mode = MODELIST_MAIN
-		goto *turn_end
+		goto *label_9247
 	}
 	item_separate ci
 	if ( inv(INV_ITEM_PARAM1, ci) != 0 ) {
 		if ( inv(INV_ITEM_PARAM2, ci) != 0 ) {
 			if ( inv(INV_ITEM_ID, ci) != ITEM_ID_CARD_PACK & inv(INV_ITEM_ID, ci) != ITEM_ID_MYSTERIOUS_ENVELOPE ) {
 				val = inv(INV_ITEM_PARAM2, ci)
 				gosub *lockpick_val
 				if ( stat == 0 ) {
 					screenupdate = -1
 					gosub *screen_draw
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 		}
 	}
 
@@ -3142,21 +3142,21 @@
 			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 			autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
 			goto *act_open_SWEND1
 		}
 		if ( 1 ) {
-			gosub *open_chest
+			gosub *label_6382
 			goto *act_open_SWEND1
 		}
 *act_open_SWEND1
 		item_stack cc, ri
 	}
 	screenupdate = -1
 	gosub *screen_draw
-	goto *turn_end
+	goto *label_9247
 
-*open_chest
+*label_6382
 	snd SOUNDLIST_CHEST1
 	txt lang("あなたは" + itemname(ci) + "を開けた。", "You open " + itemname(ci) + ".")
 	msg_halt
 	ri = ci
 	if ( inv(INV_ITEM_ID, ri) == ITEM_ID_MATERIAL_BOX ) {
@@ -3293,12 +3293,14 @@
 	if ( f ) {
 		flt
 		itemcreate -1, 422 + rnd(6), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1
 	}
 	if ( f == 0 ) {
-		flt
-		itemcreate -1, ITEM_ID_SPIRITIUM, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+		if ( inv(INV_ITEM_ID, ri) == ITEM_ID_CHEST ) {
+			flt
+			itemcreate -1, ITEM_ID_SPIRITIUM, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+		}
 	}
 	f = 0
 	if ( inv(INV_ITEM_ID, ri) == ITEM_ID_CHEST ) {
 		if ( rnd(2) == 0 ) {
 			f = 1
@@ -3511,16 +3513,16 @@
 			gosub *lockpick_val
 			if ( stat == 0 ) {
 				screenupdate = -1
 				gosub *screen_draw
 				await 100
-				goto *turn_end
+				goto *label_9247
 			}
 			feat(FEAT_CELL_SUB_FEATURE_ID) = CELL_SUB_FEATURE_TRAP_IMPALEMENT
 		}
 		else {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( feat(FEAT_CELL_SUB_FEATURE_ID) > CELL_SUB_FEATURE_TRAP_IMPALEMENT ) {
 		f = 0
 		if ( rnd(feat(FEAT_CELL_SUB_FEATURE_ID) * 20 + 150) < sdata(SKILL_NORMAL_LOCK_PICKING, cc) * 20 + 20 ) {
@@ -3528,11 +3530,11 @@
 		}
 	}
 	else {
 		if ( cdata(CDATA_ALLIED, cc) == 100 ) {
 			if ( cc != CHARA_PLAYER ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		f = 1
 	}
 	if ( f ) {
@@ -3563,11 +3565,11 @@
 		}
 	}
 	if ( cc == CHARA_PLAYER ) {
 		await 100
 	}
-	goto *turn_end
+	goto *label_9247
 
 *act_close
 	txt lang("何を閉める？", "Which door do you want to close? ")
 	gosub *screen_draw
 	val = 0
@@ -3588,11 +3590,11 @@
 		gosub *screen_draw
 		goto *pc_turn
 	}
 	cell_featset x, y, tile_doorclosed, CELL_FEATURE_DOOR_CLOSED, -1, -1
 	txt lang(name(cc) + "は扉を閉めた。", name(cc) + " close the door.")
-	goto *turn_end
+	goto *label_9247
 
 *act_fire
 	if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 		actaa = 414
 		bvar = sdata(SKILL_RES_MAGIC, cc)
@@ -3686,19 +3688,19 @@
 	ammox = cdata(CDATA_X, tc)
 	ammoy = cdata(CDATA_Y, tc)
 	attackitem = cw
 	if ( ammo != (-1) ) {
 		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) != (-1) ) {
-			if ( inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2 + 1, ammo) \ 1000 <= 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2 + 1, ammo) \ 1000 <= 0 ) {
 				txt lang("通常弾を装填した。", "You load normal ammo.")
 				inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) = -1
 			}
 			else {
-				ammoproc = inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2, ammo) \ 10000
+				ammoproc = inv(STARTING_INV_ITEM_ENCHANT + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2, ammo) \ 10000
 				if ( cc == CHARA_PLAYER ) {
 				}
-				inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2 + 1, ammo)--
+				inv(STARTING_INV_ITEM_ENCHANT + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2 + 1, ammo)--
 			}
 		}
 	}
 	if ( ammo != (-1) ) {
 		if ( cc >= MAX_CHARA_FOLLOWER & cdata(CDATA_ALLIED, cc) == 0 ) {
@@ -3740,11 +3742,11 @@
 			gosub *FindRangeWeapon
 			ele = SKILL_NONE
 			extraattack = 0
 			gosub *act_attack
 			if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
-				gosub *findTarget
+				gosub *label_5740
 				if ( stat == 0 ) {
 					break
 				}
 				else {
 					tc = cdata(CDATA_TARGET, cc)
@@ -3759,11 +3761,11 @@
 	else {
 		if ( ammoproc == ENCHANT_AMMO_BURST ) {
 			repeat 40
 				gosub *FindRangeWeapon
 				ele = SKILL_NONE
-				gosub *com_findTarget
+				gosub *label_5748
 				if ( listmax == 0 ) {
 					break
 				}
 				tc = list(0, rnd(listmax))
 				if ( cc == CHARA_PLAYER | cdata(CDATA_RELATION, cc) >= RELATION_NEUTRAL ) {
@@ -3794,11 +3796,11 @@
 	}
 	attackvar = 0
 	ammoproc = ENCHANT_AMMO_NONE
 	return
 
-*act_melee
+*label_6394
 	if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 		actaa = 414
 		bvar = sdata(SKILL_RES_MAGIC, cc)
 		if ( sdata(SKILL_RES_FIRE, cc) > bvar ) {
 			actaa = 485
@@ -4682,68 +4684,68 @@
 							cw4 = cdata(cnt, cc) - cdata(cnt, cc) / EXT_EQUIP_SLOTS * 10000 - 1
 							break
 						loop
 						if ( cw2 != (-1) ) {
 							repeat 15
-								if ( inv(40 + cnt * 2, cw2) == 0 ) {
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw2) == 0 ) {
 									break
 								}
-								enc = inv(40 + cnt * 2, cw2)
+								enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw2)
 								if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) <= 1 ) {
 									if ( enc == 66 ) {
 										cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) = 1
-										shootp = inv(40 + cnt * 2 + 1, cw2)
+										shootp = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw2)
 										break
 									}
 								}
 								if ( enc == 65 ) {
 									cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) = 2
-									shootp = inv(40 + cnt * 2 + 1, cw2)
+									shootp = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw2)
 									break
 								}
 							loop
 							if ( shootp == 0 ) {
 								if ( cw3 != (-1) ) {
 									cw2 = cw3
 									repeat 15
-										if ( inv(40 + cnt * 2, cw2) == 0 ) {
+										if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw2) == 0 ) {
 											break
 										}
-										enc = inv(40 + cnt * 2, cw2)
+										enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw2)
 										if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) <= 1 ) {
 											if ( enc == 66 ) {
 												cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) = 1
-												shootp = inv(40 + cnt * 2 + 1, cw2)
+												shootp = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw2)
 												break
 											}
 										}
 										if ( enc == 65 ) {
 											cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) = 2
-											shootp = inv(40 + cnt * 2 + 1, cw2)
+											shootp = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw2)
 											break
 										}
 									loop
 								}
 							}
 							if ( shootp == 0 ) {
 								if ( cw4 != (-1) ) {
 									cw2 = cw4
 									repeat 15
-										if ( inv(40 + cnt * 2, cw2) == 0 ) {
+										if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw2) == 0 ) {
 											break
 										}
-										enc = inv(40 + cnt * 2, cw2)
+										enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw2)
 										if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) <= 1 ) {
 											if ( enc == 66 ) {
 												cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) = 1
-												shootp = inv(40 + cnt * 2 + 1, cw2)
+												shootp = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw2)
 												break
 											}
 										}
 										if ( enc == 65 ) {
 											cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) = 2
-											shootp = inv(40 + cnt * 2 + 1, cw2)
+											shootp = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw2)
 											break
 										}
 									loop
 								}
 							}
@@ -5025,11 +5027,11 @@
 			}
 		}
 		else {
 			bakucut = 0
 			bakuretu = 0
-			gosub *act_attackSub
+			gosub *label_6405
 		}
 		if ( trait(TRAIT_ETHER_TENTACLES) != 0 ) {
 			if ( cc == CHARA_PLAYER ) {
 				if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE & rnd(8) == 0 ) {
 					txt lang("さらに" + name(cc) + "の触手が襲いかかった！", "Furthermore, your tentacles have attacked!")
@@ -5537,25 +5539,25 @@
 			}
 		}
 	}
 	return
 
-*act_attackSub
+*label_6405
 	if ( gdata(GDATA_TEMPORARY_FLAGS2) >= 100 ) {
 		return
 	}
 	if ( gdata(GDATA_TEMPORARY_FLAGS3) >= 100 ) {
 		return
 	}
 	repeat 15
 		cw = attackitem
-		if ( inv(40 + cnt * 2, cw) == 0 ) {
+		if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw) == 0 ) {
 			break
 		}
-		enc = inv(40 + cnt * 2, cw)
+		enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw)
 		if ( enc == 36 ) {
-			p = rnd(inv(40 + cnt * 2 + 1, cw) / 50 + 1) + 1
+			p = rnd(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw) / 50 + 1) + 1
 			if ( cdata(CDATA_SP, tc) > 0 ) {
 				healsp cc, rnd(2) + 1
 			}
 			if ( tc == CHARA_PLAYER ) {
 				dmgsp tc, p / 2
@@ -5566,11 +5568,11 @@
 			dmgsp tc, p / 2
 			refreshspeed tc
 			continue
 		}
 		if ( enc == 38 ) {
-			p = (rnd(inv(40 + cnt * 2 + 1, cw) / 100 + 1) + 20) * limit(orgdmg / 500, 1, 50) - cdata(CDATA_PV, tc)
+			p = (rnd(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw) / 100 + 1) + 20) * limit(orgdmg / 500, 1, 50) - cdata(CDATA_PV, tc)
 			if ( 0 ) {
 				txtef COLOR_SKY_BLUE
 				txt lang("マナダメ" + p + "オリダメ" + orgdmg + "。", name(cc) + " stop" + _s(cc) + " time.")
 			}
 			if ( p <= 0 ) {
@@ -5594,11 +5596,11 @@
 				if ( rnd(25) == 0 ) {
 					snd SOUNDLIST_CHEST1
 					animeload 42, cc
 					txtef COLOR_SKY_BLUE
 					txt lang(name(cc) + "は時を止めた。", name(cc) + " stop" + _s(cc) + " time.")
-					gdata(GDATA_TIME_STOP_TIME) = limit(inv(40 + cnt * 2 + 1, cw) / 100 + 1 + 1, 2, 6)
+					gdata(GDATA_TIME_STOP_TIME) = limit(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw) / 100 + 1 + 1, 2, 6)
 					await
 					snd SOUNDLIST_CHEST1
 				}
 				continue
 			}
@@ -5619,45 +5621,45 @@
 		}
 		if ( enc == 57 ) {
 			s = refchara(cdata(CDATA_ID, tc), DBSPEC_CHARA_FILTER, 1)
 			if ( instr(s, 0, "/dragon/") != (-1) ) {
 				gdata(GDATA_DMG_TYPE) = 1
-				dmghp tc, orgdmg / 30 * ((rnd(20) + limit(inv(40 + cnt * 2 + 1, cw), 1, 2000)) / 50) + 1, cc
+				dmghp tc, orgdmg / 30 * ((rnd(20) + limit(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw), 1, 2000)) / 50) + 1, cc
 				subdmg = 0
 			}
 			continue
 		}
 		if ( enc == 61 ) {
 			s = refchara(cdata(CDATA_ID, tc), DBSPEC_CHARA_FILTER, 1)
 			if ( instr(s, 0, "/god/") != (-1) ) {
 				gdata(GDATA_DMG_TYPE) = 1
-				dmghp tc, orgdmg / 30 * ((rnd(20) + limit(inv(40 + cnt * 2 + 1, cw), 1, 2000)) / 50) + 1, cc
+				dmghp tc, orgdmg / 30 * ((rnd(20) + limit(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw), 1, 2000)) / 50) + 1, cc
 				subdmg = 0
 			}
 			continue
 		}
 		if ( enc == 58 ) {
 			s = refchara(cdata(CDATA_ID, tc), DBSPEC_CHARA_FILTER, 1)
 			if ( instr(s, 0, "/undead/") != (-1) ) {
 				gdata(GDATA_DMG_TYPE) = 1
-				dmghp tc, orgdmg / 30 * ((rnd(20) + limit(inv(40 + cnt * 2 + 1, cw), 1, 2000)) / 50) + 1, cc
+				dmghp tc, orgdmg / 30 * ((rnd(20) + limit(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw), 1, 2000)) / 50) + 1, cc
 				subdmg = 0
 			}
 			continue
 		}
 		if ( enc == 76 ) {
 			if ( cbit(CHARA_BIT_FLOAT, tc) == TRUE ) {
 				gdata(GDATA_DMG_TYPE) = 1
-				dmghp tc, orgdmg / 120 * ((rnd(10) + limit(inv(40 + cnt * 2 + 1, cw), 1, 2000)) / 50) + 1, cc
+				dmghp tc, orgdmg / 120 * ((rnd(10) + limit(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw), 1, 2000)) / 50) + 1, cc
 				subdmg = 0
 			}
 			continue
 		}
 		if ( enc == 84 ) {
 			if ( cbit(CHARA_BIT_METAL, tc) == TRUE ) {
 				gdata(GDATA_DMG_TYPE) = 1
-				dmghp tc, orgdmg / 25 * ((rnd(100) + limit(inv(40 + cnt * 2 + 1, cw), 1, 2000)) / 50) + 100, cc
+				dmghp tc, orgdmg / 25 * ((rnd(100) + limit(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw), 1, 2000)) / 50) + 100, cc
 				subdmg = 0
 			}
 			continue
 		}
 		i = enc / 10000
@@ -5671,11 +5673,11 @@
 				if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
 					continue
 					ele = SKILL_NONE
 				}
 				gdata(GDATA_DMG_TYPE) = 1
-				dmghp tc, orgdmg / 10 * (rnd(100) + inv(40 + cnt * 2 + 1, cw)) / 100 + 1, cc, ele, inv(40 + cnt * 2 + 1, cw) / 2 + 100
+				dmghp tc, orgdmg / 10 * (rnd(100) + inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw)) / 100 + 1, cc, ele, inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw) / 2 + 100
 				subdmg = 0
 				continue
 			}
 			if ( i == 8 ) {
 				if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
@@ -5700,13 +5702,13 @@
 				}
 				tlocx = cdata(CDATA_X, tc)
 				tlocy = cdata(CDATA_Y, tc)
 				if ( rnd(100) < p ) {
 					gdata(GDATA_ACTIVATE_PROC) = 100
-					efpori = inv(40 + cnt * 2 + 1, cw) + sdata(attackskill, cc) * 10
+					efpori = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw) + sdata(attackskill, cc) * 10
 					efid = enc
-					efp = inv(40 + cnt * 2 + 1, cw) + sdata(attackskill, cc) * 10
+					efp = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, cw) + sdata(attackskill, cc) * 10
 					gosub *effect
 				}
 				gdata(GDATA_ACTIVATE_PROC) = 0
 				tc = tcbk
 				continue
@@ -5756,11 +5758,11 @@
 			snd SOUNDLIST_LOCOMO
 		}
 		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 4 ) {
 			snd SOUNDLIST_SIREN
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	msgdup++
 	txt lang("周囲を注意深く調べた。", "You search the surroundings carefully.")
 	if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
 		inv_getheader -1
@@ -5812,21 +5814,21 @@
 				refx = x
 				refy = y
 				if ( abs(cdata(CDATA_Y, cc) - y) <= 1 & abs(cdata(CDATA_X, cc) - x) <= 1 ) {
 					if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_TRAP ) {
 						if ( feat(FEAT_CELL_PIC) == 0 ) {
-							gosub *calcSearch
+							gosub *label_4091
 							if ( stat == 1 ) {
 								gosub *revealTrap
 								txt lang("罠を発見した。", "You discover a trap.")
 							}
 						}
 					}
 					if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_HIDDEN_PATH ) {
-						gosub *calcSearch
+						gosub *label_4091
 						if ( stat == 1 | 0 ) {
-							gosub *revealHiddenPath
+							gosub *label_6413
 							txt lang("隠れた通路を発見した。", "You discover a hidden path.")
 						}
 					}
 				}
 				if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SMALL_MEDAL ) {
@@ -5876,17 +5878,17 @@
 		}
 		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_GARDENING ) {
 			gosub *plant
 		}
 	}
-	goto *turn_end
+	goto *label_9247
 
 *revealTrap
 	cell_featset refx, refy, tile_trap, -1, -1
 	return
 
-*revealHiddenPath
+*label_6413
 	map(refx, refy, MAP_TILE_ID) = tile_tunnel
 	cell_featset refx, refy, 0, CELL_FEATURE_NONE
 	return
 
 *act_dig
@@ -5897,11 +5899,11 @@
 	}
 	rowactre = 0
 	digx = tlocx
 	digy = tlocy
 	gosub *dig
-	goto *turn_end
+	goto *label_9247
 	goto *act_dip
 
 #deffunc dipcursed int dipcursed_item, int dipcursed_arg1
 	if ( refitem(inv(INV_ITEM_ID, dipcursed_item), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
 		if ( inv(INV_ITEM_MATERIAL, dipcursed_item) == ITEM_MATERIAL_RAW ) {
@@ -5963,11 +5965,11 @@
 		}
 		else {
 			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = rnd(10) + 15
 			inv(INV_ITEM_PARAM4, ci) = inv(INV_ITEM_PARAM1, cidip)
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	snd SOUNDLIST_DRINK1
 	if ( refitem(inv(INV_ITEM_ID, cidip), DBSPEC_TYPE) == FILTER_ITEM_POTION ) {
 		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE_MINOR) == FILTER_FURNITURE_WELL ) {
 			item_separate ci
@@ -5975,42 +5977,42 @@
 			if ( inv(INV_ITEM_ID, cidip) != ITEM_ID_EMPTY_BOTTLE ) {
 				txt lang(itemname(cidip, 1) + "を" + itemname(ci) + "に浸した。", "You dip " + itemname(ci) + " into " + itemname(cidip, 1) + ".")
 				txtmore
 				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HOLY_WELL ) {
 					txt lang("井戸は汚れた。", "The holy well is polluted.")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( inv(INV_ITEM_PARAM3, ci) >= 20 ) {
 					txt lang(itemname(ci) + "は完全に枯れている。", itemname(ci) + " is completely dry.")
-					goto *turn_end
+					goto *label_9247
 				}
 				txt lang(itemname(ci) + "は一瞬輝いた。", itemname(ci) + " shines for a moment.")
 				if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_HANDFUL_SNOW ) {
 					txt lang("こんな量では… ", "Snow just melts.")
 				}
 				else {
 					inv(INV_ITEM_PARAM1, ci) += rnd(3)
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 			else {
 				if ( inv(INV_ITEM_PARAM1, ci) < (-5) | inv(INV_ITEM_PARAM3, ci) >= 20 | (inv(INV_ITEM_ID, ci) == ITEM_ID_HOLY_WELL & gdata(GDATA_FLAG_HOLY_WELL) <= 0) ) {
 					valn = itemname(ci)
 					txt lang(valn + "は涸れている。", valn + " is dry.")
 					txtmore
 					txt lang("あっ！空き瓶を井戸に落としてしまった…", "Ops! You drop the empty bottle into the well...")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( gdata(GDATA_FLAG_GAME_MODE) == 1 ) {
 					if ( inv_sum(CHARA_PLAYER) > 20 ) {
 						txt lang("バックパックが一杯だ。", "Your inventory is full.")
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 				if ( inv_getspace(CHARA_PLAYER) == 0 ) {
 					txt lang("あっ！空き瓶を井戸に落としてしまった…", "Ops! You drop the empty bottle into the well...")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HOLY_WELL ) {
 					gdata(GDATA_FLAG_HOLY_WELL)--
 					flt
 					itemcreate CHARA_PLAYER, ITEM_ID_BOTTLE_WATER, -1, -1, 0
@@ -6018,11 +6020,11 @@
 						inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
 					}
 					if ( inv_getfreeid(CHARA_PLAYER) == (-1) ) {
 						item_num cidip, 1
 						txt lang("バックパックには、もうアイテムを入れる余裕がない。", "Your inventory is full.")
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 				else {
 					inv(INV_ITEM_PARAM1, ci) -= 3
 					flt 20
@@ -6031,11 +6033,11 @@
 				}
 				txt lang("空き瓶に水をすくった。", "You draw water from the well into the empty bottle.")
 				txtvalid = 0
 				txt lang(itemname(ci, 1) + "を手に入れた。", "You get " + itemname(ci, 1) + ".")
 				item_stack CHARA_PLAYER, ci, 1
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_POISON ) {
 		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
@@ -6044,29 +6046,29 @@
 			txt lang(itemname(ci) + "に" + itemname(cidip, 1) + "を混入した！あなたはにやりと笑った。", "You made aphrodisiac food! You grin.")
 			if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
 				dipcursed ci
 			}
 			ibitmod ITEM_BIT_POISON_BLEND, ci, TRUE
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_JUICE ) {
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_JUICE ) {
 			item_num cidip, -1
 			item_separate ci
 			txt lang(itemname(ci) + "はミックスジュースになった！", "You made a mix juice!")
 			ibitmod ITEM_BIT_HERBED_IN, ci, TRUE
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_MILK ) {
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_JUICE | inv(INV_ITEM_ID, ci) == ITEM_ID_COFFEE ) {
 			item_num cidip, -1
 			item_separate ci
 			txt lang(itemname(ci) + "に乳を混ぜた！", "You mixed milk.")
 			ibitmod ITEM_BIT_ACIDPROOF, ci, TRUE
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_LOVE_POTION ) {
 		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
 			item_num cidip, -1
@@ -6074,30 +6076,30 @@
 			txt lang(itemname(ci) + "に媚薬を混入した！あなたはうしろめたさを感じた…", "You made aphrodisiac food! You kind of feel guilty...")
 			if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
 				dipcursed ci
 			}
 			ibitmod ITEM_BIT_LOVE_BLEND, ci, TRUE
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( refitem(inv(INV_ITEM_ID, cidip), DBSPEC_TYPE) == FILTER_ITEM_POTION ) {
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CF_POTIOMAN | inv(INV_ITEM_ID, ci) == ITEM_ID_CRUSH_POTIOMAN | inv(INV_ITEM_ID, ci) == ITEM_ID_BATTLE_POTIOMAN | inv(INV_ITEM_ID, ci) == ITEM_ID_SUPER_POTIOMAN ) {
 			item_num cidip, -1
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CF_POTIOMAN & inv(INV_ITEM_LEVEL, ci) >= 4 | (inv(INV_ITEM_ID, ci) != ITEM_ID_CF_POTIOMAN & inv(INV_ITEM_LEVEL, ci) >= 3) ) {
 				snd SOUNDLIST_FAIL1
 				txt lang("これ以上はチャージできない。", "You can't charge " + itemname(ci) + " anymore.")
-				goto *turn_end
+				goto *label_9247
 			}
 			pcharge = calcitemvalue(cidip, 5)
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CF_POTIOMAN ) {
 				pcharge = pcharge * 3
 			}
 			pcharge = limit(pcharge / 1000, 0, 4)
 			if ( pcharge == 0 ) {
 				snd SOUNDLIST_FAIL1
 				txt lang(itemname(cidip) + "にはチャージに充分な魔力が含まれていない。", "It doesn't have enough magic power to charge " + itemname(ci) + ".")
-				goto *turn_end
+				goto *label_9247
 			}
 			repeat pcharge
 				snd SOUNDLIST_ATK_ELEC
 			loop
 			item_separate ci
@@ -6113,11 +6115,11 @@
 				}
 			}
 			txtnew
 			txtef COLOR_SKY_BLUE
 			txt lang("Potion-charge Lv" + inv(INV_ITEM_LEVEL, ci) + "!!", "Potion-charge Lv" + inv(INV_ITEM_LEVEL, ci) + "!!")
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_DIRTY_WATER | inv(INV_ITEM_ID, cidip) == ITEM_ID_VOMIT | inv(INV_ITEM_ID, cidip) == ITEM_ID_URINE ) {
 		if ( inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_BLESSED ) {
 			if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
@@ -6140,22 +6142,22 @@
 				dipcursed ci
 			}
 		}
 		r1 = cc
 		gosub *charaRefresh
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_ANTISEPTIC ) {
 		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
 			item_num cidip, -1
 			item_separate ci
 			txt lang(itemname(ci) + "に永久防腐剤を混ぜた。", "You made Incorruptible food!")
 			if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
 				dipcursed ci
 			}
 			ibitmod ITEM_BIT_ANTISEPTIC, ci, TRUE
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_DYE ) {
 		if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
 			in = inv(INV_ITEM_NUM, cidip)
@@ -6171,11 +6173,11 @@
 			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		}
 		if ( inv(INV_ITEM_EQUIP, ci) != 0 ) {
 			create_pcpic cc, 1
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_ACIDPROOF_LIQUID ) {
 		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_POTION ) {
 			if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
 				in = inv(INV_ITEM_NUM, cidip)
@@ -6191,11 +6193,11 @@
 			else {
 				ibitmod ITEM_BIT_ACIDPROOF, ci, TRUE
 				txt lang(itemname(ci) + "は酸から守られた。", itemname(ci) + " gain" + _s2(in) + " acidproof.")
 			}
 			item_num cidip, -1
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_FIREPROOF_LIQUID ) {
 		if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
 			in = inv(INV_ITEM_NUM, cidip)
@@ -6216,33 +6218,33 @@
 				ibitmod ITEM_BIT_FIREPROOF, ci, TRUE
 				txt lang(itemname(ci) + "は熱から守られた。", itemname(ci) + " gain" + _s2(in) + " fireproof.")
 			}
 		}
 		item_num cidip, -1
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_WATER ) {
 		item_num cidip, -1
 		if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
 			txtef COLOR_GREEN
 			txt lang(itemname(ci) + "は銀色に輝いた。", itemname(ci) + " shine" + _s2(inv(INV_ITEM_NUM, ci)) + " silvery.")
 			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
 			r1 = cc
 			gosub *charaRefresh
-			goto *turn_end
+			goto *label_9247
 		}
 		if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
 			txtef COLOR_PURPLE
 			txt lang(itemname(ci) + "は黒いオーラに包まれた。", itemname(ci) + " " + is2(inv(INV_ITEM_NUM, ci)) + " wrapped by a dark aura.")
 			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
 			r1 = cc
 			gosub *charaRefresh
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	txt lang("何もおきない… ", "Nothing happens...")
-	goto *turn_end
+	goto *label_9247
 
 *act_use
 	if ( cc != CHARA_PLAYER ) {
 		if ( rnd(2) == 0 | cdata(CDATA_TARGET, cc) == 0 | cdata(CDATA_TARGET, cc) == 0 | cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE | cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_TALKING ) {
 			cdata(CDATA_AI_ITEM, cc) = ci
@@ -6315,27 +6317,27 @@
 				gosub *screen_draw
 				goto *pc_turn
 			}
 		}
 		gdata(GDATA_ROW_ACT) = ACTION_SLEEP
-		gosub *generalAct
-		goto *turn_end
+		gosub *label_6023
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_RED_TREASURE_MACHINE | inv(INV_ITEM_ID, ci) == ITEM_ID_BLUE_TREASURE_MACHINE ) {
 		goto *com_gasha
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_PACHISURO_MACHINE | inv(INV_ITEM_ID, ci) == ITEM_ID_CASINO_TABLE | inv(INV_ITEM_ID, ci) == ITEM_ID_SLOT_MACHINE | inv(INV_ITEM_ID, ci) == ITEM_ID_DARTS_BOARD ) {
 		atxid = 1
 		gosub *com_txtadv
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_EFFECT, ci) == EFFECT_CARPENTRY | inv(INV_ITEM_EFFECT, ci) == EFFECT_ALCHEMY | inv(INV_ITEM_EFFECT, ci) == EFFECT_JEWELER | inv(INV_ITEM_EFFECT, ci) == EFFECT_TAILOR ) {
 		prodtype = inv(INV_ITEM_EFFECT, ci)
 		snd SOUNDLIST_POP2
 		invctrl = 0
-		gosub *label_5142
-		goto *turn_end
+		gosub *label_5149
+		goto *label_9247
 	}
 	if ( ibit(ITEM_BIT_ULTIMATE, ci) == TRUE ) {
 		if ( synccheck(tc, -1) ) {
 			txtef COLOR_RED
 			txt lang("SPを最大分消費して無差別全域攻撃魔法を発動する？", "Do you want to consume your maximum amount of SP to activate indiscriminate attack magic?")
@@ -6346,15 +6348,15 @@
 		val = promptx, prompty, 160, 1
 		gosub *prompt_key
 		if ( rtval == 0 ) {
 			if ( cdata(CDATA_SP, CHARA_PLAYER) <= 0 ) {
 				txt lang("疲労し過ぎて失敗した！", "You are too exhausted!")
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( gdata(GDATA_AREA) == AREA_PET_ARENA | mdata(MDATA_TYPE) == MAP_TYPE_WORLD | gdata(GDATA_AREA) == AREA_PYRAMID | gdata(GDATA_AREA) == AREA_JAIL ) {
 				txt lang("何もおきない… ", "Nothing happens...")
-				goto *turn_end
+				goto *label_9247
 			}
 			snd SOUNDLIST_ATK_ICE
 			txtef COLOR_BLUE
 			txt lang("周囲の大気が一瞬にして氷結した！", "The surrounding air was frozen in a moment!")
 			snd SOUNDLIST_ATK_ICE
@@ -6436,11 +6438,11 @@
 						p = dist(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), x, y)
 						map(x, y, MAP_TILE_ID_MEMORY) = map(x, y, MAP_TILE_ID)
 					loop
 				loop
 			loop
-			goto *turn_end
+			goto *label_9247
 		}
 		else {
 			goto *pc_turn
 		}
 	}
@@ -7315,11 +7317,11 @@
 					}
 				}
 				if ( list(0, rtval) == (-7) ) {
 					taiseip = taisei \ 9
 					if ( taiseip == 0 ) {
-						encadd ci, ENCHANT_BANE_GOD, 80, 0, 1
+						encadd ci, ENCHANT_GOD_BANE, 80, 0, 1
 					}
 					if ( taiseip == 1 ) {
 						encadd ci, ENCHANT_BANE_UNDEAD, 130, 0, 1
 					}
 					if ( taiseip == 2 ) {
@@ -7350,15 +7352,15 @@
 				exrand_randomize inv(INV_ITEM_SUB_NAME, ci)
 				if ( inv(INV_ITEM_PARAM1, ci) >= 10 ) {
 					txt lang("その力は次第に脅威になっている。", "Its power is becoming a threat.")
 					encadd ci, ENCHANT_SUCK_BLOOD, 50
 					if ( stat == 0 ) {
-						inv(40 + (15 - 1) * 2, ci) = 0
+						inv(STARTING_INV_ITEM_ENCHANT + (15 - 1) * 2, ci) = 0
 						txt lang(itemname(ci) + "はエンチャントを消した。", itemname(ci) + " removes an enchantment.")
 						encadd ci, ENCHANT_SUCK_BLOOD, 50
 						if ( stat == 0 ) {
-							inv(40 + (15 - 2) * 2, ci) = 0
+							inv(STARTING_INV_ITEM_ENCHANT + (15 - 2) * 2, ci) = 0
 							txt lang(itemname(ci) + "はさらにエンチャントを消した。", itemname(ci) + " removes an enchantment.")
 						}
 					}
 				}
 				inv(INV_ITEM_PARAM2, ci) = 0
@@ -7509,11 +7511,11 @@
 				booksitu = inv(INV_ITEM_PARAM3, ci)
 				bookpage = limit(inv(INV_ITEM_NUM, ci), 1, 1000)
 				syukuzyu = inv(INV_ITEM_STATUS, ci)
 				inv(INV_ITEM_NUM, ci) = 0
 				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-				gosub *calcBurdenPc
+				gosub *label_4102
 				redraw 0
 				gosub *screen_draw
 				gosub *screen_fade
 				gsel BUFFER_BUF
 				pos 0, 0
@@ -7839,11 +7841,11 @@
 				cdata(CDATA_ACTION_PERIOD, cc) = 500
 			}
 			if ( rtval == 6 ) {
 				txt lang("とりあえずなんか大量にあるメモやファイルを整理した…。", "For the time being, you've organized some files...")
 				gdata(GDATA_HOUR)++
-				gosub *advance_hour
+				gosub *label_9228
 				seiton++
 				if ( seiton == 3 ) {
 					await 1000
 					snd SOUNDLIST_ENC
 					txt lang("…前任者が遺した仕事Ｃの重要ファイルを発見した！", "...You have found an important file of Work-C that your predecessor left behind in his lifetime!")
@@ -8173,11 +8175,11 @@
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 119 | _switch_sw ) {
 		_switch_sw = 0
-		gosub *findTarget
+		gosub *label_5740
 		if ( stat == 0 ) {
 			goto *act_use_SWEND1
 		}
 		tc = cdata(CDATA_TARGET, CHARA_PLAYER)
 		if ( cdata(CDATA_RELATION, tc) >= RELATION_DISLIKE ) {
@@ -8255,11 +8257,11 @@
 			}
 			if ( cdata(CDATA_IMPRESSION, tc) < 200 ) {
 				txtef COLOR_PURPLE
 				snd SOUNDLIST_ATK_DARK
 				txt lang("…" + cdatan(CDATAN_NAME, tc) + "はきっぱりと断った。", "..." + cdatan(CDATAN_NAME, tc) + " gently refuses your proposal. ")
-				goto *turn_end
+				goto *label_9247
 			}
 			cbitmod CHARA_BIT_MARRIED, tc, TRUE
 			txtef COLOR_PINK
 			txt lang("「しょうがない" + _na(3) + "…" + _yoro(3) + "」", "..." + cdatan(CDATAN_NAME, tc) + " blushed and nodded!")
 			gdata(GDATA_FLAG_TIMES_MARRIED)++
@@ -8267,11 +8269,11 @@
 			cdata(CDATA_JOIN_DATE_DAY, tc) = gdata(GDATA_DAY)
 			cdata(CDATA_JOIN_DATE_YEAR, tc) = gdata(GDATA_YEAR)
 			cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
 			marry = tc
 			evadd EVENT_MARRY
-			goto *turn_end
+			goto *label_9247
 		}
 		else {
 			txt lang("何もおきない… ", "Nothing happens...")
 		}
 		goto *act_use_SWEND1
@@ -8362,11 +8364,11 @@
 			txt lang(name(tc) + "の力が高まった。", "Skill memories have been converted to bonuses.")
 		}
 		zouka = 0
 		r1 = tc
 		gosub *charaRefresh
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 135 | _switch_sw ) {
 		_switch_sw = 0
@@ -8376,21 +8378,99 @@
 		txt lang("ポーションの栓を100個手に入れた。[残り" + gdata(GDATA_FLAG_TOTAL_POTION_PLUGS) + "個]", name(0) + " get 100 potion plugs.[Remaining plug " + gdata(GDATA_FLAG_TOTAL_POTION_PLUGS) + "]")
 		inv(INV_ITEM_NUM, ci)--
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		r1 = tc
 		gosub *charaRefresh
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 131 | _switch_sw ) {
 		_switch_sw = 0
 		_switch_sw++
 	}
 	if ( _switch_val == 132 | _switch_sw ) {
 		_switch_sw = 0
-		txt lang("開発中。", "Under development.")
+		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
+			goto *act_use_SWEND1
+		}
+		txt lang("誰に注射する？", "Who is target?")
+		gosub *screen_draw
+		val = 0
+		gosub *prompt_direction
+		if ( stat == 0 ) {
+			txt lang("それは無理だ。", "It's impossible.")
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
+			tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
+		}
+		else {
+			txt lang("それは無理だ。", "It's impossible.")
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
+			txtselecttc 2
+			repeat 2
+				promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
+				promptmax++
+			loop
+			val = promptx, prompty, 200, 1
+			gosub *prompt_key
+			if ( stat == 0 ) {
+				gosub *screen_draw
+				goto *pc_turn
+			}
+			if ( rtval == 1 ) {
+				tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
+			}
+		}
+		if ( cdata(CDATA_SP_EARNED, tc) <= (-2000000) ) {
+			txt lang("フェイズ2には使っても意味がない。", "There is no point in using it Phase 2.")
+			gosub *screen_draw
+			goto *pc_turn
+		}
+		teikou = sdata(SKILL_ATTR_STR, tc) + 100
+		if ( cdata(CDATA_CONDITION_SLEEP, tc) > 0 | cdata(CDATA_CONDITION_DIM, tc) >= 60 | cdata(CDATA_HP, tc) < cdata(CDATA_MAX_HP, tc) / 8 ) {
+			teikou = teikou / 2
+		}
+		if ( tc != CHARA_PLAYER ) {
+			if ( teikou >= cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) + rnd(sdata(SKILL_ATTR_DEX, CHARA_PLAYER)) ) {
+				txt lang(name(tc) + "は物凄い力で抵抗した。「注射は嫌い" + _da(3) + "！」", name(tc) + " resist" + _s(tc) + ".")
+				hostileaction CHARA_PLAYER, tc
+				hostileaction CHARA_PLAYER, tc
+				gosub *screen_draw
+				goto *pc_turn
+			}
+		}
+		snd SOUNDLIST_SWING39
+		txt lang(name(tc) + "「痛っ！」", name(tc) + " writhe" + _s(tc) + " in pain.")
+		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SURVIVABILITY_EXTENDER_X ) {
+			cdata(CDATA_TAMER_WHIP_EAT, tc) = limit(cdata(CDATA_TAMER_WHIP_EAT, tc) + 1, 1, 9)
+		}
+		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SURVIVABILITY_EXTENDER_Y ) {
+			cdata(CDATA_TAMER_WHIP_PICKUP, tc) = limit(cdata(CDATA_TAMER_WHIP_PICKUP, tc) + 1, 1, 9)
+		}
+		if ( cdata(CDATA_SP_EARNED, tc) > (-1000000) ) {
+			cdata(CDATA_SP_EARNED, tc) = -1000000
+		}
+		if ( cbit(CHARA_BIT_PREGNANT, tc) ) {
+			cbitmod CHARA_BIT_PREGNANT, tc, FALSE
+			if ( synccheck(tc, -1) ) {
+				txt lang(name(tc) + "の体内の異物は養分にされた。", name(tc) + your(tc) + "  child melt in " + his(tc) + " stomach.")
+			}
+		}
+		if ( tc != CHARA_PLAYER ) {
+			cdata(CDATA_INFANT, tc) = cdata(CDATA_ID, tc)
+		}
+		inv(INV_ITEM_NUM, ci)--
+		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+		txtef COLOR_GREEN
+		txt lang(name(tc) + "に新たな生命核が生成された。" + name(tc) + "以外の遺伝子を与える必要がある。また、フェイズ1の間は追加投与することもできる。", "A new life core was created in " + name(tc) + ". It needs to give the genes other than " + name(tc) + ". Additional infusions are possible during Phase 1.")
+		gosub *label_4102
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 130 | _switch_sw ) {
 		_switch_sw = 0
@@ -8507,11 +8587,11 @@
 		gosub *anime
 		inv(INV_ITEM_NUM, ci)--
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		r1 = tc
 		gosub *charaRefresh
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == effmemory2 | _switch_sw ) {
 		_switch_sw = 0
@@ -8599,11 +8679,11 @@
 			}
 			inv(INV_ITEM_NUM, ci)--
 			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 			r1 = tc
 			gosub *charaRefresh
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 110 | _switch_sw ) {
@@ -8670,11 +8750,11 @@
 		gdata(GDATA_SENSE_OBJECT) = 0
 		inv(INV_ITEM_NUM, ci)--
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		r1 = tc
 		gosub *charaRefresh
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 104 | _switch_sw ) {
 		_switch_sw = 0
@@ -8981,11 +9061,11 @@
 		if ( cdata(CDATA_DRUG_DEPENDENCE, tc) < 0 ) {
 			cdata(CDATA_DRUG_DEPENDENCE, tc) = 0
 		}
 		inv(INV_ITEM_NUM, ci)--
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-		gosub *calcBurdenPc
+		gosub *label_4102
 		toba = 0
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 89 | _switch_sw ) {
@@ -9129,11 +9209,11 @@
 		if ( cdata(CDATA_TOBACCO_DEPENDENCE, tc) < 0 ) {
 			cdata(CDATA_TOBACCO_DEPENDENCE, tc) = 0
 		}
 		inv(INV_ITEM_NUM, ci)--
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-		gosub *calcBurdenPc
+		gosub *label_4102
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CIGARETTE ) {
 			flt
 			itemcreate -1, ITEM_ID_SUIGARA, cdata(CDATA_X, tc), cdata(CDATA_Y, tc), 0
 		}
 		toba = 0
@@ -9174,11 +9254,11 @@
 		}
 		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 			goto *act_use_SWEND1
 		}
 		if ( cdata(CDATA_TARGET, cc) == 0 ) {
-			gosub *findTarget
+			gosub *label_5740
 			if ( stat == 0 ) {
 				goto *act_use_SWEND1
 			}
 		}
 		tc = cdata(CDATA_TARGET, cc)
@@ -9311,11 +9391,11 @@
 	if ( _switch_val == 84 | _switch_sw ) {
 		_switch_sw = 0
 		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 			goto *act_use_SWEND1
 		}
-		gosub *findLocation
+		gosub *label_5349
 		if ( stat != 1 ) {
 			if ( stat == 0 ) {
 				txt lang("その場所は見えない。", "You can't see the location.")
 				gosub *screen_draw
 			}
@@ -9327,11 +9407,11 @@
 			goto *pc_turn
 		}
 		animeid = ANIMATION_NUCLEAR
 		gosub *anime
 		inv(INV_ITEM_NUM, ci)--
-		gosub *calcBurdenPc
+		gosub *label_4102
 		repeat 40
 			if ( cnt == 14 ) {
 				snd SOUNDLIST_ATK_FIRE
 			}
 			await cfg_animewait + 20
@@ -9409,11 +9489,11 @@
 		}
 		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 			goto *act_use_SWEND1
 		}
 		if ( cdata(CDATA_TARGET, cc) == 0 ) {
-			gosub *findTarget
+			gosub *label_5740
 			if ( stat == 0 ) {
 				goto *act_use_SWEND1
 			}
 		}
 		tc = cdata(CDATA_TARGET, cc)
@@ -9483,11 +9563,11 @@
 		}
 		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 			goto *act_use_SWEND1
 		}
 		if ( cdata(CDATA_TARGET, cc) == 0 ) {
-			gosub *findTarget
+			gosub *label_5740
 			if ( stat == 0 ) {
 				goto *act_use_SWEND1
 			}
 		}
 		tc = cdata(CDATA_TARGET, cc)
@@ -9557,11 +9637,11 @@
 		}
 		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 			goto *act_use_SWEND1
 		}
 		if ( cc == CHARA_PLAYER ) {
-			gosub *findLocation
+			gosub *label_5349
 			if ( stat != 1 ) {
 				if ( stat == 0 ) {
 					txt lang("その場所は見えない。", "You can't see the location.")
 					gosub *screen_draw
 				}
@@ -9573,11 +9653,11 @@
 				goto *act_use_SWEND1
 			}
 		}
 		if ( cc != CHARA_PLAYER ) {
 			if ( cdata(CDATA_TARGET, cc) == 0 ) {
-				gosub *findTarget
+				gosub *label_5740
 				if ( stat == 0 ) {
 					goto *act_use_SWEND1
 				}
 			}
 			tc = cdata(CDATA_TARGET, cc)
@@ -9677,11 +9757,11 @@
 		_switch_sw = 0
 		txt lang("火を起こした。", "You made a fire.")
 		snd SOUNDLIST_FIRE1
 		inv(INV_ITEM_NUM, ci)--
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-		gosub *calcBurdenPc
+		gosub *label_4102
 		flt
 		itemcreate -1, ITEM_ID_CAMPFIRE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
@@ -9705,11 +9785,11 @@
 		inv(INV_ITEM_WEIGHT, ci) = 100
 		inv(INV_ITEM_MATERIAL, ci) = ITEM_MATERIAL_SAND
 		inv(INV_ITEM_PARAM3, ci) = 0
 		txt lang(itemname(ci) + "を作った。", "You made " + itemname(ci) + ".")
 		item_stack CHARA_PLAYER, ci, 1
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 15 | _switch_sw ) {
 		_switch_sw = 0
@@ -9772,26 +9852,26 @@
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 9 | _switch_sw ) {
 		_switch_sw = 0
-		gosub *com_train
+		gosub *label_5761
 		if ( stat == 1 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 		else {
 			gosub *screen_draw
 			goto *pc_turn
 		}
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 107 | _switch_sw ) {
 		_switch_sw = 0
-		gosub *com_train
+		gosub *label_5761
 		if ( stat == 1 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 		else {
 			gosub *screen_draw
 			goto *pc_turn
 		}
@@ -9834,29 +9914,29 @@
 			}
 		}
 		if ( tc == CHARA_PLAYER ) {
 			txt lang(" *ドクン ドクン* ", "You blush.")
 			gdata(GDATA_SCOPE) = 0
-			goto *turn_end
+			goto *label_9247
 		}
 		if ( tc > CHARA_PLAYER & tc < MAX_CHARA_FOLLOWER ) {
 			if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
 				gdata(GDATA_SCOPE) = 0
 				if ( cbit(CHARA_BIT_STETHOSCOPE, tc) == TRUE ) {
 					cbitmod CHARA_BIT_STETHOSCOPE, tc, FALSE
 					txt lang(name(tc) + "から聴診器を外した。", "You no longer watch on " + his(tc) + " health.")
-					goto *turn_end
+					goto *label_9247
 				}
 				txt lang("あなたは" + name(tc) + "に聴診器を当てた。", "You start to keep an eye on " + his(tc) + " health.")
 				if ( cdata(CDATA_SEX, tc) == 1 ) {
 					txt lang("" + name(tc) + "は顔を赤らめた。", name(tc) + " blush" + _s(tc, 1) + ".")
 					txtmore
 					txtef COLOR_BLUE
 					txt lang("「キャー」", cnvtalk("Pervert!"))
 				}
 				cbitmod CHARA_BIT_STETHOSCOPE, tc, TRUE
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		txt lang("それは無理だ。", "It's impossible.")
 		gosub *screen_draw
 		goto *pc_turn
@@ -9897,11 +9977,11 @@
 						if ( tc >= MAX_CHARA_FOLLOWER ) {
 							if ( rnd(5) == 0 ) {
 								txt lang(name(tc) + "が激しく抵抗したため紐は切れた。", "The leash is cut as " + name(tc) + " resists.")
 								inv(INV_ITEM_NUM, ci)--
 								cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-								gosub *calcBurdenPc
+								gosub *label_4102
 								goto *act_use_SWEND1
 							}
 						}
 						cbitmod CHARA_BIT_LEASHED, tc, TRUE
 						txt lang("あなたは" + name(tc) + "を紐でくくりつけた。", "You leash " + name(tc) + ".")
@@ -9970,11 +10050,11 @@
 					txtvalid = 0
 					txt lang(name(tc) + "は呻き声を洩らした。「アン…♪」", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("Pervert!"))
 					animeload 8, tc
 					inv(INV_ITEM_NUM, ci)--
 					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-					gosub *calcBurdenPc
+					gosub *label_4102
 				}
 				f = 1
 			}
 		}
 		if ( f == 0 ) {
@@ -10268,24 +10348,24 @@
 					if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) != FILTER_AMMO ) {
 						continue
 					}
 					ci = cnt
 					repeat 15
-						if ( inv(40 + cnt * 2, ci) == 0 ) {
+						if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 							break
 						}
-						enc = inv(40 + cnt * 2, ci)
+						enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci)
 						i = enc / 10000
 						if ( i != 0 ) {
 							enc = enc \ 10000
 							if ( i == 9 ) {
-								i = inv(40 + cnt * 2 + 1, ci) \ 1000, inv(40 + cnt * 2 + 1, ci) / 1000
-								if ( inv(40 + cnt * 2, ci) \ 10000 == 4 ) {
+								i = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) \ 1000, inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 1000
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) \ 10000 == 4 ) {
 									continue
 								}
 								cost += (i(1) - i) * (50 + enc * enc * 10)
-								inv(40 + cnt * 2 + 1, ci) = i(1) * 1000 + i(1)
+								inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) = i(1) * 1000 + i(1)
 							}
 						}
 					loop
 				loop
 				f = 1
@@ -10425,11 +10505,11 @@
 					pos 0, 0
 					picload exedir + "graphic\\face1" + devfile + ".bmp", 1
 					gsel BUFFER_SCREEN
 					ccbk = cc
 					cc = tc
-					gosub *com_portrait
+					gosub *label_5658
 					cc = ccbk
 				}
 				else {
 					gdata(GDATA_SENSE_OBJECT) = 1
 					ccbk = cc
@@ -10439,11 +10519,11 @@
 				}
 				if ( tc == CHARA_PLAYER ) {
 					gdata(GDATA_TEMPORARY_FLAGS) = 7777
 				}
 				customtalk tc, DBMODE_FLAVOR_SHIFT
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						txt "「変身！」", "「フォームアップ！」", "「ドレスアップ！」", "「トランスフォーム！」"
 					}
 					if ( en ) {
@@ -10858,31 +10938,31 @@
 							txt name(tc) + "はなんだか残念そうだ…。", "「ぶってもらいたいのは" + _ore(3) + "なのに…」", "「あの…次は" + _ore(3) + "にも" + _tanomu(3) + "」"
 						}
 					}
 					if ( cdata(CDATA_MASTER_SERVANT2, tc) > (-5) & cdata(CDATA_MASTER_SERVANT2, tc) < 5 ) {
 						customtalk tc, DBMODE_FLAVOR_INSULT2
-						gosub *convert_word
+						gosub *label_0416
 						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 							if ( jp ) {
 								txtef COLOR_RED
 								txt name(tc) + "は戸惑いながら鞭であなたを軽く叩いた。", "「なんだかちょっとゾクゾクする…」", "「こ、これでいいの" + _kana(3) + "」", "「痛そうだからちょっと加減する" + _na(3) + "」"
 							}
 						}
 					}
 					if ( cdata(CDATA_MASTER_SERVANT2, tc) >= 5 & cdata(CDATA_MASTER_SERVANT2, tc) < 10 ) {
 						customtalk tc, DBMODE_FLAVOR_INSULT2
-						gosub *convert_word
+						gosub *label_0416
 						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 							if ( jp ) {
 								txtef COLOR_RED
 								txt name(tc) + "はうっすらと嗜虐的な笑みを浮かべた。", "「ヘンタイにはこれでも足りない" + _nda(1) + "」", "「さぁ、" + _ore(3) + "への服従を示してもら" + _u(3) + "」", "「まだご褒美が足りない" + _noka(3) + "？」"
 							}
 						}
 					}
 					if ( cdata(CDATA_MASTER_SERVANT2, tc) == 10 ) {
 						customtalk tc, DBMODE_FLAVOR_INSULT2
-						gosub *convert_word
+						gosub *label_0416
 						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 							if ( jp ) {
 								txtef COLOR_RED
 								txt name(tc) + "は無言であなたに鞭を浴びせた。", name(tc) + "は無表情で機械的に鞭を振り下ろした。", "「" + _kimi(3) + "の親は可哀想" + _da(3) + "」", "「そうやって、いつまでうずくまってるの" + _kana(3) + "？」"
 							}
@@ -10925,27 +11005,33 @@
 					}
 					if ( rtval == 3 ) {
 						hostileaction CHARA_PLAYER, tc
 					}
 					if ( rtval == 0 ) {
-						if ( cdata(CDATA_TAMER_WHIP_EAT, tc) == 1 ) {
-							cdata(CDATA_TAMER_WHIP_EAT, tc) = 0
+						if ( cbit(1033, tc) == TRUE ) {
+							cbitmod 1033, tc, FALSE
 						}
 						else {
-							cdata(CDATA_TAMER_WHIP_EAT, tc) = 1
+							cbitmod 1033, tc, TRUE
 						}
 					}
 					if ( rtval == 1 ) {
-						if ( cdata(CDATA_TAMER_WHIP_PICKUP, tc) == 1 ) {
-							cdata(CDATA_TAMER_WHIP_PICKUP, tc) = 0
+						if ( cbit(1032, tc) == TRUE ) {
+							cbitmod 1032, tc, FALSE
 						}
 						else {
-							cdata(CDATA_TAMER_WHIP_PICKUP, tc) = 1
+							cbitmod 1032, tc, TRUE
 						}
 					}
-					if ( rtval == 0 & cdata(CDATA_TAMER_WHIP_EAT, tc) == 1 | (rtval == 1 & cdata(CDATA_TAMER_WHIP_PICKUP, tc) != 0) | rtval == 3 ) {
+					if ( rtval == 0 & cbit(1033, tc) == TRUE | (rtval == 1 & cbit(1032, tc) == TRUE) | rtval == 3 ) {
 						txt lang("あなたは鞭を振り下ろした。", "You beat " + name(tc) + ".")
+						if ( rtval == 0 & cbit(1033, tc) == TRUE ) {
+							txt lang("[拾い食い禁止！]", "[Prohibition!]")
+						}
+						if ( rtval == 1 & cbit(1032, tc) == TRUE ) {
+							txt lang("[アイテム拾い禁止！]", "[Prohibition!]")
+						}
 						animeload 28, tc
 						snd SOUNDLIST_PUNISH1
 						snd searrow
 						cdata(CDATA_MASTER_SERVANT2, tc) -= 1
 						if ( cdata(CDATA_MASTER_SERVANT2, tc) == 0 ) {
@@ -10975,41 +11061,41 @@
 								}
 							loop
 						}
 						if ( cdata(CDATA_MASTER_SERVANT2, tc) >= 5 ) {
 							customtalk tc, DBMODE_FLAVOR_INSULT
-							gosub *convert_word
+							gosub *label_0416
 							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 								if ( jp ) {
 									txtef COLOR_RED
 									txt name(tc) + "は反抗的にあなたをにらみつけた。", name(tc) + "は信じられないといった表情で呆然としている…。", "「ッ！" + _ore(3) + "にこんなことをして、どうなるかわかってるの" + _kana(3) + "！」", "「あぐっ！？…ふん、この程度" + _ka(3) + "？」"
 								}
 							}
 						}
 						if ( cdata(CDATA_MASTER_SERVANT2, tc) > (-5) & cdata(CDATA_MASTER_SERVANT2, tc) < 5 ) {
 							customtalk tc, DBMODE_FLAVOR_DISCIPLINE
-							gosub *convert_word
+							gosub *label_0416
 							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 								if ( jp ) {
 									txtef COLOR_SKY_BLUE
 									txt name(tc) + "は涙を浮かべて痛みに耐えた。", name(tc) + "は痛みと恐怖でがくがくと震えている…。", "「" + name(0) + "、怖い" + _yo(3) + "…」", "「何か悪いことした" + _kana(3) + "？」"
 								}
 							}
 						}
 						if ( cdata(CDATA_MASTER_SERVANT2, tc) <= (-5) & cdata(CDATA_MASTER_SERVANT2, tc) > (-10) ) {
 							customtalk tc, DBMODE_FLAVOR_DISCIPLINE2
-							gosub *convert_word
+							gosub *label_0416
 							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 								if ( jp ) {
 									txtef COLOR_SKY_BLUE
 									txt name(tc) + "は泣きながらも微かに笑みを浮かべた。", name(tc) + "は我慢することの快感に戸惑っている。", "「なんだか、身体が熱い…」", "「あ…！」"
 								}
 							}
 						}
 						if ( cdata(CDATA_MASTER_SERVANT2, tc) == (-10) ) {
 							customtalk tc, DBMODE_FLAVOR_DISCIPLINE2
-							gosub *convert_word
+							gosub *label_0416
 							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 								if ( jp ) {
 									txtef COLOR_SKY_BLUE
 									txt name(tc) + "はだらしない表情を浮かべている。", name(tc) + "はあなたの与える痛みに溺れている…。", "「まだ…満足してない" + _yo(3) + "？」", "「あひっ♪」"
 								}
@@ -11022,11 +11108,11 @@
 							}
 						}
 					}
 					else {
 						customtalk tc, DBMODE_FLAVOR_DISCIPLINE_OFF
-						gosub *convert_word
+						gosub *label_0416
 						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 							txtef COLOR_SKY_BLUE
 							txt lang(name(tc) + "はホッと胸をなでおろした。", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("Don't stop!"))
 						}
 					}
@@ -11324,15 +11410,15 @@
 				tc = CHARA_PLAYER
 				efid = SKILL_SPACT_SHADOW_STEP
 				gosub *effect
 			}
 			if ( cdata(CDATA_IN_TAGTEAM, cc) != 1 ) {
-				gosub *eat_meal_xmas_cake
+				gosub *label_6018
 			}
 			if ( cdata(CDATA_IN_TAGTEAM, cc) == (-1) ) {
 				cc = cdata(CDATA_TAGTEAM_PARTNER, cc)
-				gosub *eat_meal_xmas_cake
+				gosub *label_6018
 			}
 		loop
 		cc = CHARA_PLAYER
 		goto *act_use_SWEND1
 		_switch_sw++
@@ -11361,15 +11447,15 @@
 				tc = CHARA_PLAYER
 				efid = SKILL_SPACT_SHADOW_STEP
 				gosub *effect
 			}
 			if ( cdata(CDATA_IN_TAGTEAM, cc) != 1 ) {
-				gosub *eat_meal
+				gosub *label_6016
 			}
 			if ( cdata(CDATA_IN_TAGTEAM, cc) == (-1) ) {
 				cc = cdata(CDATA_TAGTEAM_PARTNER, cc)
-				gosub *eat_meal
+				gosub *label_6016
 			}
 		loop
 		cc = CHARA_PLAYER
 		goto *act_use_SWEND1
 		_switch_sw++
@@ -11748,11 +11834,11 @@
 							break
 						}
 					}
 					break
 				loop
-				gosub *calcBodyFix
+				gosub *label_3962
 				inv(INV_ITEM_NUM, ci)--
 				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 				animeload 8, tc
 				f = 1
 			}
@@ -11917,11 +12003,11 @@
 		}
 		inv(INV_ITEM_NUM, ci)--
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		dbg_skipevent = 1
 		gdata(GDATA_HOUR)++
-		gosub *advance_hour
+		gosub *label_9228
 		dbg_skipevent = 0
 		txtef COLOR_GREEN
 		txt lang("チョコレートを刻んで、テンパリングしながら湯煎で溶かした！次はどうしようか。", "You have to wait next February.")
 		snd SOUNDLIST_ATK_POISON
 		txtsetchocoword2 3
@@ -12001,11 +12087,11 @@
 			gosub *music_play
 			goto *act_use_SWEND1
 		}
 		dbg_skipevent = 1
 		gdata(GDATA_MIN) += 10
-		gosub *advance_hour
+		gosub *label_9228
 		dbg_skipevent = 0
 		txtef COLOR_YELLOW
 		txt lang("手作りチョコができた！", "It was delicious.")
 		snd SOUNDLIST_COMPLETE1
 		itemcreate -1, ITEM_ID_HANDMADE_CHOCOLATE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
@@ -12184,10 +12270,14 @@
 					if ( tc >= MAX_CHARA_FOLLOWER ) {
 						txt lang("それは無理だ。", "It's impossible.")
 						goto *pc_turn
 					}
 				}
+				if ( cbit(1034, tc) == TRUE ) {
+					txt lang("子供のうちは夢を見させてあげよう。", "It cannot be used among children.")
+					goto *pc_turn
+				}
 				txt lang("新しい職業は？", "What's a new class?")
 				val = (windoww - 220) / 2 + inf_screenx, winposy(90), 12, 1, 0
 				inputlog = ""
 				input_mode = 0
 				gosub *prompt_word
@@ -12286,12 +12376,12 @@
 				}
 				gosub *screen_draw
 				goto *pc_turn
 			}
 			gdata(GDATA_ROW_ACT) = ACTION_CONSTRUCT
-			gosub *generalAct
-			goto *turn_end
+			gosub *label_6023
+			goto *label_9247
 		}
 		if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANDOM_DUNGEON ) {
 			if ( gdata(GDATA_LEVEL) == adata(ADATA_MAX_LEVEL, gdata(GDATA_AREA)) ) {
 				if ( adata(ADATA_BOSS, gdata(GDATA_AREA)) != (-1) ) {
 					txt lang("クエストを放棄してシェルターに避難する？", "Really give up the quest and evacuate to the shelter?")
@@ -12306,11 +12396,11 @@
 					}
 				}
 			}
 		}
 		gdata(GDATA_ROW_ACT) = ACTION_OPEN_HATCH
-		gosub *generalAct
+		gosub *label_6023
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 11 | _switch_sw ) {
 		_switch_sw = 0
@@ -12501,11 +12591,11 @@
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		txt lang("突然、あなたの目の前に異次元へのゲートが現れた。", "Suddenly, a strange gate opens.")
 		comctrl = 2
 		gosub *com_import
 		if ( stat == 1 ) {
-			goto *extract_map
+			goto *label_5895
 		}
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 49 | _switch_sw ) {
@@ -13451,11 +13541,11 @@
 			}
 			if ( fov_los(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), dx, dy) == 0 ) {
 				continue
 			}
 			cc = cnt
-			gosub *findTarget
+			gosub *label_5740
 			if ( stat == 0 ) {
 				continue
 			}
 			if ( cc != CHARA_PLAYER ) {
 				if ( cdata(CDATA_TARGET, cc) != 0 ) {
@@ -13536,10 +13626,24 @@
 				continue
 			}
 			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
 				continue
 			}
+			if ( cbit(1034, tc) == TRUE ) {
+				if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-1) ) {
+					if ( rnd(2) == 0 ) {
+						snd SOUNDLIST_FAIL1
+						if ( jp ) {
+							txt cdatan(CDATAN_NAME, tc) + "「指図しないで" + _kure(3) + "」", cdatan(CDATAN_NAME, tc) + "「今やろうと思っていたのにやる気がなくなった" + _yo(3) + "」"
+						}
+						if ( en ) {
+							txt cdatan(CDATAN_NAME, tc) + " " + cnvtalk("Please don't give instructions!"), cdatan(CDATAN_NAME, tc) + " " + cnvtalk("I thought I would do it now, but I've lost my motivation!")
+						}
+						continue
+					}
+				}
+			}
 			if ( rtval <= 4 ) {
 				cdata(CDATA_DIRECTIVE_MODE, tc) = tact
 				if ( cdata(CDATA_DIRECTIVE_MODE, tc) == DIRECTIVE_MODE_OFFENSIVE ) {
 					if ( synccheck(tc, -1) ) {
 						txtef COLOR_RED
@@ -13605,19 +13709,19 @@
 					if ( rtval == 10 ) {
 						amp = ENCHANT_AMMO_RAPID
 					}
 					change = 0
 					repeat 15
-						if ( inv(40 + cnt * 2, ci) == 0 ) {
+						if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 							break
 						}
-						enc = inv(40 + cnt * 2, ci)
+						enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci)
 						i = enc / 10000
 						if ( i != 0 ) {
 							enc = enc \ 10000
 							if ( i == 9 ) {
-								if ( inv(40 + cnt * 2, ci) \ 10000 == amp ) {
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) \ 10000 == amp ) {
 									inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = cnt
 									change = 1
 									break
 								}
 							}
@@ -13627,11 +13731,11 @@
 						txt lang(cdatan(CDATAN_NAME, tc) + "の矢弾はその切替に対応していない。", itemname(ci) + " isn't capable of that ammos.")
 						continue
 					}
 					snd SOUNDLIST_AMMO
 					change = 0
-					i = inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) \ 1000, inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) / 1000
+					i = inv(STARTING_INV_ITEM_ENCHANT + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) \ 1000, inv(STARTING_INV_ITEM_ENCHANT + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) / 1000
 					s = ammoname(amp), "" + i + "/" + i(1)
 					s = s + ":" + s(1)
 					txtef COLOR_GREEN
 					txt lang(cdatan(CDATAN_NAME, tc) + "は" + s + "に切り替えた。", "Current Ammo Type")
 				}
@@ -15049,17 +15153,17 @@
 				if ( evmode > 0 ) {
 					if ( 0 != 1 ) {
 						if ( cdata(CDATA_IMPRESSION, tc) < 150 ) {
 							txt lang(cdatan(CDATAN_NAME, tc) + "は進化を拒絶した。", "You will need to deepen the friendship.")
 							evmode = 0
-							goto *turn_end
+							goto *label_9247
 						}
 					}
 					if ( cdata(CDATA_SHIFT_FORM, tc) > SHIFT_FORM_NONE ) {
 						txt lang("変異殻使用中は進化できない。", "It cannot evolve during Form Shift.")
 						evmode = 0
-						goto *turn_end
+						goto *label_9247
 					}
 					txt lang("おや？" + cdatan(CDATAN_NAME, tc) + "の様子が…！？", "Oh? " + cdatan(CDATAN_NAME, tc) + "'s act strange ...")
 					if ( synccheck(tc, -1) ) {
 						txtef COLOR_RED
 						txt lang(cdatan(CDATAN_NAME, tc) + "の変化を見守る？", "Watch " + cdatan(CDATAN_NAME, tc) + "'s change?")
@@ -15075,11 +15179,11 @@
 						gosub *anime
 					}
 					else {
 						txt lang("あなたが声をかけると" + cdatan(CDATAN_NAME, tc) + "の変化は止まった…。", "Why? " + cdatan(CDATAN_NAME, tc) + "'s change stopped.")
 						evmode = 0
-						goto *turn_end
+						goto *label_9247
 					}
 					if ( evmode == 1 ) {
 						evname = lang("猫の王女", "EV")
 						evold = lang("妹猫", "aaaaaaa")
 						cdata(CDATA_PIC, tc) = xy2pic(8, 17)
@@ -17099,11 +17203,11 @@
 					}
 					if ( synccheck(tc, -1) ) {
 						txtef COLOR_GREEN
 						txt lang("おめでとう！" + cdatan(CDATAN_NAME, tc) + "は" + evname + "に進化した！", "Congratulations! Your friend has evolved!")
 					}
-					gosub *effect_elixer
+					gosub *label_6338
 					r1 = tc
 					gosub *charaRefresh
 					if ( cdata(CDATA_POWER_GAUGE, tc) < 200 ) {
 						cdata(CDATA_POWER_GAUGE, tc) = 200
 					}
@@ -17112,23 +17216,23 @@
 					}
 					inv(INV_ITEM_NUM, ci)--
 					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 					cdata(CDATA_EVOLUTION_STAGE, tc) += 1
 					evmode = 0
-					goto *turn_end
+					goto *label_9247
 				}
 				txt lang("組み合わせが違うようだ。", "Seems to have no effect using.")
 				evmode = 0
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		if ( f == 0 ) {
 			txt lang("それは無理だ。", "It's impossible.")
 		}
 		txt lang("仲間にしか使えない。", "Seems to have no effect using.")
 		evmode = 0
-		goto *turn_end
+		goto *label_9247
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 30 | _switch_sw ) {
 		_switch_sw = 0
@@ -17175,11 +17279,11 @@
 		promptl(0, 1) = strno, "n", "1"
 		promptmax = 2
 		val = promptx, prompty, 160, 1
 		gosub *prompt_key
 		if ( rtval != 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 		dmghp CHARA_PLAYER, 99999, DAMAGE_FROM_HANGING
 		goto *act_use_SWEND1
 		_switch_sw++
 	}
@@ -17195,11 +17299,11 @@
 		promptl(0, 1) = strno, "n", "1"
 		promptmax = 2
 		val = promptx, prompty, 160, 1
 		gosub *prompt_key
 		if ( rtval != 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 		txtef COLOR_RED2
 		txt lang("あなたはこの場をおさめるために腹を切った！", "You cut your belly for an apology!")
 		snd SOUNDLIST_STAB
 		cdata(CDATA_HP, CHARA_PLAYER) = cdata(CDATA_HP, CHARA_PLAYER) / 8
@@ -17410,11 +17514,11 @@
 			txt lang("この作物は既に成長しきっている。", "The plant has already grown full.")
 			goto *act_use_SWEND1
 		}
 		if ( feat == tile_plant + 3 ) {
 			feat = tile_plant + 1
-			gosub *item_seedNextGrowth
+			gosub *label_6526
 			txt lang("枯れた植物に生命が宿った。", "The plant revives.")
 		}
 		else {
 			feat++
 			txt lang("植物は成長した。", "The plant grows.")
@@ -17431,37 +17535,37 @@
 		txtmore
 		rc = CHARA_PLAYER
 		allyctrl = 5
 		gosub *com_ally
 		if ( stat == (-1) ) {
-			goto *turn_end
+			goto *label_9247
 		}
 		rc = stat
 		txtnew
 		txt lang("能力を取り出す仲間を選ぶ必要がある。この仲間は合成後、永久に失われる。", "Choose a gene. Once you extract a gene, the subject will be lost forever.")
 		txtmore
 		allyctrl = 5
 		gosub *com_ally
 		if ( stat == (-1) ) {
-			goto *turn_end
+			goto *label_9247
 		}
 		tc = stat
 		if ( cdata(CDATA_PRAY, tc) != 0 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang(cdatan(CDATAN_NAME, tc) + "はあなたの大事な仲間だ。", "It's precious your ally.")
-			goto *turn_end
+			goto *label_9247
 		}
 		gosub *screen_draw
 		txtnew
 		txt lang("本当に" + cdatan(CDATAN_NAME, rc) + "に" + cdatan(CDATAN_NAME, tc) + "の能力を組み込む？", "Really add " + cdatan(CDATAN_NAME, tc) + "'s gene to " + cdatan(CDATAN_NAME, rc) + "?")
 		promptl(0, 0) = stryes, "y", "0"
 		promptl(0, 1) = strno, "n", "1"
 		promptmax = 2
 		val = promptx, prompty, 160, 1
 		gosub *prompt_key
 		if ( rtval != 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 		txtnew
 		txtef COLOR_YELLOW
 		txt lang("" + cdatan(CDATAN_NAME, rc) + "は" + cdatan(CDATAN_NAME, tc) + "の能力を受けついだ！", "" + cdatan(CDATAN_NAME, rc) + " has inherited " + cdatan(CDATAN_NAME, tc) + "'s gene!")
 		animeid = ANIMATION_GENE
@@ -17471,11 +17575,11 @@
 		if ( stat != (-1) ) {
 			cdata(stat, rc) = rtval * 10000
 			txtef COLOR_GREEN
 			txt lang(cdatan(CDATAN_NAME, rc) + "は新しい" + bodyn(rtval) + "を得た！", cdatan(CDATAN_NAME, rc) + " gains new " + bodyn(rtval) + "!")
 			r1 = rc
-			gosub *calcBodyFix
+			gosub *label_3962
 		}
 		gosub *gene_skill
 		if ( stat != 0 ) {
 			repeat 2
 				if ( rtval(cnt) == (-1) ) {
@@ -17490,11 +17594,11 @@
 			if ( cdata(CDATA_ID, tc) != CREATURE_ID_USER ) {
 				lv = (cdata(CDATA_LEVEL, tc) - cdata(CDATA_LEVEL, rc)) / 2 + 1
 				repeat lv
 					r1 = rc
 					r2 = 1
-					gosub *calcLevelUp
+					gosub *label_3967
 				loop
 				txtef COLOR_GREEN
 				txt lang(cdatan(CDATAN_NAME, rc) + "はレベル" + cdata(CDATA_LEVEL, rc) + "になった！", cdatan(CDATAN_NAME, rc) + " is now level " + cdata(CDATA_LEVEL, rc) + "!")
 				listmax = 0
 				repeat 18 - 10, 10
@@ -17512,11 +17616,11 @@
 						txtmore
 					}
 				loop
 			}
 		}
-		cdata(CDATA_AREA, tc) = AREA_NONE
+		cdata(CDATA_AREA, tc) = 0
 		chara_vanquish tc
 		skillexp SKILL_NORMAL_GENE_ENGINEER, CHARA_PLAYER, 1200
 		randomize
 		screenupdate = -1
 		gosub *screen_draw
@@ -17574,11 +17678,11 @@
 		}
 		else {
 			gdata(GDATA_QUICK_USE) = 0
 		}
 		tcgdeck
-		gosub *map_prepareTile
+		gosub *label_4912
 		gosub *screen_refreshFull
 		txtnew
 		txt lang("デッキをしまった。", "You put away the deck.")
 		goto *act_use_SWEND1
 		_switch_sw++
@@ -17598,12 +17702,12 @@
 		card(0, inv(INV_ITEM_SUB_NAME, ci))++
 		goto *act_use_SWEND1
 	}
 
 *act_use_SWEND1
-	gosub *calcBurdenPc
-	goto *turn_end
+	gosub *label_4102
+	goto *label_9247
 
 *gene_skill
 	if ( cdata(CDATA_ID, tc) == CREATURE_ID_USER ) {
 		return 0
 	}
@@ -17741,11 +17845,11 @@
 	}
 	else {
 		val = 0
 	}
 	feat = tile_plant, 29, inv(INV_ITEM_MATERIAL, ci)
-	gosub *item_seedNextGrowth
+	gosub *label_6526
 	if ( val ) {
 		s = "畑に"
 	}
 	else {
 		s = ""
@@ -17756,29 +17860,29 @@
 	removeitem ci, 1
 	cell_featset cdata(CDATA_X, cc), cdata(CDATA_Y, cc), tile_plant, CELL_FEATURE_PLANTED_SEED, inv(INV_ITEM_MATERIAL, ci), feat(FEAT_CELL_PARAM_1)
 	if ( dbg_plant ) {
 		cell_featset cdata(CDATA_X, cc), cdata(CDATA_Y, cc), tile_plant + 1, CELL_FEATURE_PLANTED_SEED, inv(INV_ITEM_MATERIAL, ci), feat(FEAT_CELL_PARAM_1)
 	}
-	goto *turn_end
+	goto *label_9247
 
-*item_seedGrowth
+*label_6525
 	if ( feat == tile_plant + 6 ) {
 		return
 	}
 	feat(FEAT_CELL_PARAM_1)--
 	if ( feat(FEAT_CELL_PARAM_1) \ 50 == 0 ) {
 		if ( feat(FEAT_CELL_PARAM_1) >= 50 ) {
 			feat = tile_plant + 3
 		}
 		else {
 			feat++
-			gosub *item_seedNextGrowth
+			gosub *label_6526
 		}
 	}
 	return
 
-*item_seedNextGrowth
+*label_6526
 	if ( feat == tile_plant + 6 ) {
 		return
 	}
 	feat(FEAT_CELL_PARAM_1) = 4 + rnd(4 + 1)
 	p = 10
@@ -17868,11 +17972,11 @@
 		feat(FEAT_CELL_SUB_FEATURE_ID) = CELL_SUB_FEATURE_SEED_GEM
 	}
 	if ( feat(FEAT_CELL_SUB_FEATURE_ID) \ 10 == 2 ) {
 		feat(FEAT_CELL_SUB_FEATURE_ID) = CELL_SUB_FEATURE_SEED_MAGIC
 	}
-	gosub *item_seedNextGrowth
+	gosub *label_6526
 	cell_featset cdata(CDATA_X, cc), cdata(CDATA_Y, cc), feat, feat(FEAT_CELL_FEATURE_ID), feat(FEAT_CELL_SUB_FEATURE_ID), feat(FEAT_CELL_PARAM_1)
 	txtef COLOR_GREEN
 	txt lang("新しい芽が息吹いている！", "A new plant grows!")
 	return
 
@@ -18303,13 +18407,13 @@
 	}
 	txt lang(itemname(ci, 1) + "を収穫した。", "You harvest " + itemname(ci, 1) + ".")
 	item_stack CHARA_PLAYER, ci, 1
 	return
 
-*act_pickpocket
+*label_6529
 	gdata(GDATA_ROW_ACT) = ACTION_STEAL
-	gosub *generalAct
+	gosub *label_6023
 	return
 	goto *chat_refresh
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/adv.hsp ../2.14-borscht/adv.hsp
--- ../2.13-borscht/adv.hsp	2022-06-26 12:14:11.402360100 -0700
+++ ../2.14-borscht/adv.hsp	2022-09-18 12:36:58.462878600 -0700
@@ -5,10 +5,14 @@
 		if ( wishally == 100 ) {
 			chara_vanquish rc
 			txt lang(cdatan(CDATAN_NAME, rc) + "は仲間の枠がないことに気がつくと、寂しそうにそのまま何処かに行ってしまった…。", cdatan(CDATAN_NAME, rc) + " went somewhere...")
 			wishally = 0
 		}
+		if ( wishally == 200 ) {
+			chara_vanquish rc
+			txt lang(cdatan(CDATAN_NAME, rc) + "は仲間の枠がないことに気がつくと、独りで生きていくことを決意し去っていった…。", cdatan(CDATAN_NAME, rc) + " went somewhere...")
+		}
 		return -1
 	}
 	if ( cdata(CDATA_ROW_ACT, rc) != ACTION_NONE ) {
 		if ( synccheck(rc, -1) ) {
 			txt lang(name(rc) + "は行動を中断した。", name(rc) + " stopped action.")
@@ -47,11 +51,11 @@
 			cdata(CDATA_INIT_SPEED, rc) = sorg(SKILL_ATTR_SPD, rc)
 			if ( cdata(CDATA_LEVEL, rc) >= 2 ) {
 				cdata(CDATA_LEVEL, rc) = cdata(CDATA_LEVEL, rc) / 2
 				cdata(CDATA_EXP, rc) = 0
 				r1 = rc
-				gosub *calcExpToNextLevel
+				gosub *label_3991
 			}
 			if ( cdata(CDATA_CHARACTER_TIER, rc) != CHARACTER_TIER_GOD ) {
 				p = 10, 11, 12, 17, 18, 14, 13, 16, 15, 19, -1
 				repeat
 					if ( p(cnt) == (-1) ) {
@@ -83,11 +87,11 @@
 				cdata(CDATA_INIT_SPEED, rc) = sorg(SKILL_ATTR_SPD, rc)
 				if ( cdata(CDATA_LEVEL, rc) >= 2 ) {
 					cdata(CDATA_LEVEL, rc) = cdata(CDATA_LEVEL, rc) / 2
 					cdata(CDATA_EXP, rc) = 0
 					r1 = rc
-					gosub *calcExpToNextLevel
+					gosub *label_3991
 				}
 				p = 10, 11, 12, 17, 18, 14, 13, 16, 15, 19, -1
 				repeat
 					if ( p(cnt) == (-1) ) {
 						break
@@ -138,11 +142,11 @@
 		cdata(CDATA_AP_CURRENT, rc) = 0
 		if ( cdata(CDATA_LEVEL, rc) >= 10 ) {
 			cdata(CDATA_LEVEL, rc) = 10
 			cdata(CDATA_EXP, rc) = 0
 			r1 = rc
-			gosub *calcExpToNextLevel
+			gosub *label_3991
 		}
 		p = 10, 11, 12, 17, 18, 14, 13, 16, 15, 19, -1
 		repeat
 			if ( p(cnt) == (-1) ) {
 				break
@@ -193,15 +197,15 @@
 	if ( dbg_noadv == 1 ) {
 		return
 	}
 	repeat 40 - 1, 16
 		rc = cnt
-		gosub *adv_generate
+		gosub *label_8908
 	loop
 	return
 
-*adv_generate
+*label_8908
 	flt 0, FIX_QUALITY_MIRACLE
 	initlv = limit(rnd(60 + cdata(CDATA_LEVEL, CHARA_PLAYER)) + 1, 1, 200)
 	novoidlv = 1
 	p = 75, 41, 160
 	characreate rc, p(rnd(3)), -1, -1
@@ -259,11 +263,11 @@
 		}
 		if ( cdata(CDATA_AREA, rc) == gdata(GDATA_AREA) ) {
 			continue
 		}
 		if ( cdata(CDATA_EXIST, rc) == CHAR_STATE_ADV_DEAD ) {
-			gosub *adv_generate
+			gosub *label_8908
 			continue
 		}
 		if ( cdata(CDATA_EXIST, rc) == CHAR_STATE_ADV_HOSPITAL ) {
 			if ( gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 >= cdata(CDATA_RESPAWN, rc) | 0 ) {
 				if ( rnd(3) == 0 | cdata(CDATA_CUSTOM_TALK_LINE, rc) == 5 & cdata(CDATA_CUSTOM_TALK_LINE, rc) != 4 ) {
@@ -271,11 +275,11 @@
 						cdata(CDATA_CUSTOM_TALK_LINE, rc) = 0
 						txt lang(cdatan(CDATAN_AKA, rc) + "はあなたからのメッセージを思い出した…。", cdatan(CDATAN_AKA, rc) + " recalled your message...")
 					}
 					addnews 5, rc
 					cdata(CDATA_EXIST, rc) = CHAR_STATE_DEAD
-					gosub *adv_generate
+					gosub *label_8908
 				}
 				else {
 					if ( cdata(CDATA_CUSTOM_TALK_LINE, rc) == 4 ) {
 						cdata(CDATA_CUSTOM_TALK_LINE, rc) = 0
 						txt lang(cdatan(CDATAN_AKA, rc) + "はあなたからのメッセージを思い出した…。", cdatan(CDATAN_AKA, rc) + " recalled your message...")
@@ -314,11 +318,11 @@
 				}
 				break
 			loop
 			cdata(CDATA_AREA, rc) = p, 1
 		}
-		if ( cdata(CDATA_AREA, rc) == AREA_NORTH_TYRIS ) {
+		if ( cdata(CDATA_AREA, rc) == 4 ) {
 			repeat 10
 				if ( rnd(4) == 0 ) {
 					p = rnd(500 - 450) + 450
 				}
 				else {
@@ -388,22 +392,22 @@
 			gosub *adv_gainItem
 		}
 		if ( cdata(CDATA_EXP, rc) >= cdata(CDATA_EXP_TO_NEXT_LVL, rc) ) {
 			r1 = rc
 			r2 = 0
-			gosub *calcLevelUp
+			gosub *label_3967
 		}
 	loop
 	notesel newsbuff
 	if ( noteinfo(0) > 195 ) {
 		repeat noteinfo(0) - 195
 			notedel 0
 		loop
 	}
 	return
 
-*chara_item
+*label_8914
 	a = refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE)
 	if ( a == 57000 | a == 52000 | a == 53000 ) {
 		cdata(CDATA_AI_ITEM, rc) = ci
 	}
 	return
@@ -468,11 +472,11 @@
 			break
 		}
 	loop
 	return p
 
-*chara_equipFull
+*label_8919
 	inv_getheader rc
 	repeat invrange, invhead
 		ci = cnt
 		if ( inv(INV_ITEM_NUM, cnt) == 0 | inv(INV_ITEM_EQUIP, cnt) != 0 ) {
 			continue
@@ -523,11 +527,11 @@
 		}
 		repeat eqdup
 			body = bodylist(cnt)
 			i = cdata(body, rc) \ EXT_EQUIP_SLOTS
 			if ( i == 0 ) {
-				gosub *act_equip
+				gosub *label_6352
 				break
 			}
 			i--
 			f = 0
 			if ( inv(INV_ITEM_VALUE, ci) >= inv(INV_ITEM_VALUE, i) ) {
@@ -544,13 +548,13 @@
 					}
 				}
 			}
 			if ( f == 1 ) {
 				cibk = ci
-				gosub *act_unequip
+				gosub *label_6353
 				ci = cibk
-				gosub *act_equip
+				gosub *label_6352
 				break
 			}
 		loop
 	}
 	locationweap = 0
@@ -656,10 +660,889 @@
 			}
 		}
 	loop
 	return
 
+*label_8928
+	repeat 245 - 57, 57
+		if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_DEAD ) {
+			continue
+		}
+		if ( cdata(CDATA_ROLE, cnt) == ROLE_NONE ) {
+			continue
+		}
+		if ( cdata(CDATA_QUALITY, cnt) == FIX_QUALITY_UNIQUE ) {
+			continue
+		}
+		if ( cdata(CDATA_ROLE, cnt) == ROLE_SPECIAL ) {
+			continue
+		}
+		if ( cdata(CDATA_RELATION, cnt) == RELATION_DISLIKE ) {
+			continue
+		}
+		if ( cnt == 0 ) {
+			continue
+		}
+		i = -1
+		repeat 500
+			if ( qdata(QDATA_CLIENT, cnt) == 0 ) {
+				i = cnt
+				break
+			}
+		loop
+		cnt2 = cnt
+		repeat 500
+			if ( qdata(QDATA_CLIENT, cnt) == cnt2 ) {
+				if ( qdata(QDATA_MAP, cnt) == gdata(GDATA_AREA) ) {
+					i = -1
+					break
+				}
+			}
+		loop
+		if ( i == (-1) ) {
+			break
+		}
+		qdata(QDATA_CLIENT, i) = cnt
+		qdata(QDATA_MAP, i) = gdata(GDATA_AREA)
+		qname(i) = cdatan(CDATAN_NAME, cnt)
+		cdata(CDATA_QUEST_NPC, cnt) = i + 1
+		if ( gdata(GDATA_CLIENT) <= i ) {
+			gdata(GDATA_CLIENT) = i + 1
+		}
+	loop
+	return
+
+*label_8932
+	qdata(QDATA_REWARD, rq) = ((qdata(QDATA_LEVEL, rq) + 3) * 100 + rnd(qdata(QDATA_LEVEL, rq) * 30 + 200) + 400) * rewardfix / 100
+	qdata(QDATA_REWARD, rq) = qdata(QDATA_REWARD, rq) * 100 / (100 + qdata(QDATA_LEVEL, rq) * 2 / 3)
+	if ( qdata(QDATA_TYPE, rq) == QUEST_SUBTYPE_SUPPLY | qdata(QDATA_TYPE, rq) == QUEST_SUBTYPE_DELIVER ) {
+		return
+	}
+	if ( gdata(GDATA_DEEPEST_LEVEL) / 2 >= qdata(QDATA_LEVEL, rq) ) {
+	}
+	else {
+		qdata(QDATA_REWARD, rq) = qdata(QDATA_REWARD, rq) * (100 + limit((qdata(QDATA_LEVEL, rq) - gdata(GDATA_DEEPEST_LEVEL) / 2) / 5 * 25, 50, 200)) / 100
+	}
+	return
+
+*label_8933
+	repeat gdata(GDATA_CLIENT)
+		if ( qdata(QDATA_CLIENT, cnt) == (-1) ) {
+			continue
+		}
+		if ( qdata(QDATA_CLIENT, cnt) == 0 ) {
+			continue
+		}
+		if ( qdata(QDATA_MAP, cnt) != gdata(GDATA_AREA) ) {
+			continue
+		}
+		rc = qdata(QDATA_CLIENT, cnt)
+		if ( cdata(CDATA_RELATION_ORG, rc) != RELATION_NEUTRAL ) {
+			qdata(QDATA_CLIENT, cnt) = 0
+			rq = cnt
+			gosub *label_8937
+		}
+		if ( cdata(CDATA_ROLE, rc) == ROLE_NONE ) {
+			continue
+		}
+		if ( cdata(CDATA_QUALITY, rc) == FIX_QUALITY_UNIQUE ) {
+			continue
+		}
+		if ( cdata(CDATA_ROLE, rc) == ROLE_SPECIAL ) {
+			continue
+		}
+		if ( cdata(CDATA_ID, rc) == CREATURE_ID_ORPHE_THE_CHAOS_CHILD ) {
+			continue
+		}
+		if ( rc == CHARA_PLAYER ) {
+			continue
+		}
+		if ( qdata(QDATA_STATE, cnt) == QUEST_STATE_NONE ) {
+			if ( qdata(QDATA_RENEW, cnt) < gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 | adata(ADATA_QUEST_RENEW, gdata(GDATA_AREA)) != 4 ) {
+				rq = cnt
+				gosub *label_8937
+				gosub *label_8932
+			}
+		}
+	loop
+	adata(ADATA_QUEST_RENEW, gdata(GDATA_AREA)) = 4
+	return
+	repeat gdata(GDATA_CLIENT)
+		if ( qdata(QDATA_CLIENT, cnt) == 0 ) {
+			continue
+		}
+		if ( qdata(QDATA_MAP, cnt) != gdata(GDATA_AREA) ) {
+			continue
+		}
+		rc = qdata(QDATA_CLIENT, cnt)
+		if ( qdata(QDATA_STATE, cnt) == QUEST_STATE_NONE ) {
+			rq = cnt
+			gosub *label_8937
+			gosub *label_8932
+		}
+	loop
+	return
+
+*label_8937
+	qdata(QDATA_EXIST, rq) = QUEST_TYPE_NONE
+	qdata(QDATA_TYPE, rq) = QUEST_TYPE_NONE
+	qdata(QDATA_STATE, rq) = QUEST_STATE_NONE
+	qdata(QDATA_RENEW, rq) = rnd(3 + 1) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
+	qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+	if ( rnd(3) == 0 ) {
+		return
+	}
+	if ( qdata(QDATA_CLIENT, rq) == 0 ) {
+		return
+	}
+	if ( rnd(14) == 0 & gdata(GDATA_AREA) != AREA_RUST_PLAZA ) {
+		i = -1
+		repeat 300
+			n = rnd(245 - 57) + 57
+			if ( n == qdata(QDATA_CLIENT, rq) ) {
+				continue
+			}
+			if ( cdata(CDATA_EXIST, n) != CHAR_STATE_ALIVE ) {
+				continue
+			}
+			if ( cdata(CDATA_RELATION, n) != RELATION_NEUTRAL | (cdata(CDATA_ROLE, n) != ROLE_CITIZEN & cdata(CDATA_ROLE, n) != ROLE_GUARD) ) {
+				continue
+			}
+			flt 40, FIX_QUALITY_GOOD
+			flttypemajor = fsetcollect(rnd(length(fsetcollect)))
+			itemcreate n, ITEM_ID_DUMMY, -1, -1, 0
+			if ( stat != 0 ) {
+				inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = rq
+				i = n, inv(INV_ITEM_ID, ci)
+				ibitmod ITEM_BIT_DROP, ci, TRUE
+				break
+			}
+			else {
+				i = -1
+				break
+			}
+		loop
+		if ( i != (-1) ) {
+			qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq) = i
+			qdata(QDATA_DEST_ITEM, rq) = i(1)
+			qdata(QDATA_MAP, rq) = gdata(GDATA_AREA)
+			rewardfix = 60
+			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qdata(QDATA_EXIST, rq) = QUEST_TYPE_COLLECT
+			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_SUPPLY
+			qdata(QDATA_VAR, rq) = 0
+			qdata(QDATA_DEADLINE, rq) = rnd(3) + 2
+			qdata(QDATA_LEVEL, rq) = cdata(CDATA_LEVEL, i) / 3
+		}
+		return
+	}
+	if ( cdata(CDATA_FAME, CHARA_PLAYER) >= 30000 ) {
+		if ( rnd(13) == 0 ) {
+			qdata(QDATA_LEVEL, rq) = rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cdata(CDATA_FAME, CHARA_PLAYER) / 2500 + 1)
+			qdata(QDATA_LEVEL, rq) = roundmargin(qdata(QDATA_LEVEL, rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
+			minlevel = limit(qdata(QDATA_LEVEL, rq) / 7, 5, 30)
+			repeat 50
+				flt qdata(QDATA_LEVEL, rq), FIX_QUALITY_GOOD
+				characreate MAX_CHARA_NC, CREATURE_ID_BUG, -3, 0
+				if ( cmshade ) {
+					continue
+				}
+				if ( cdata(CDATA_LEVEL, rc) < minlevel ) {
+					continue
+				}
+				break
+			loop
+			qdata(QDATA_PARAM1, rq) = cdata(CDATA_ID, MAX_CHARA_NC)
+			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
+			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qdata(QDATA_EXIST, rq) = QUEST_TYPE_HUNTEX
+			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_ELIMINATE
+			qdata(QDATA_VAR, rq) = 0
+			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qdata(QDATA_DEADLINE, rq) = -1
+			rewardfix = 140
+			return
+		}
+	}
+	if ( cdata(CDATA_FAME, CHARA_PLAYER) >= 50000 ) {
+		if ( rnd(20) == 0 ) {
+			qdata(QDATA_LEVEL, rq) = rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cdata(CDATA_FAME, CHARA_PLAYER) / 2500 + 1)
+			qdata(QDATA_LEVEL, rq) = roundmargin(qdata(QDATA_LEVEL, rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
+			minlevel = limit(qdata(QDATA_LEVEL, rq) / 4, 5, 30)
+			repeat 50
+				flt qdata(QDATA_LEVEL, rq), FIX_QUALITY_GOOD
+				characreate MAX_CHARA_NC, CREATURE_ID_BUG, -3, 0
+				if ( cmshade ) {
+					continue
+				}
+				if ( cdata(CDATA_LEVEL, rc) < minlevel ) {
+					continue
+				}
+				break
+			loop
+			qdata(QDATA_PARAM1, rq) = cdata(CDATA_ID, MAX_CHARA_NC)
+			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
+			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qdata(QDATA_EXIST, rq) = QUEST_TYPE_CONQUER
+			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_CONQUER
+			qdata(QDATA_VAR, rq) = 0
+			qdata(QDATA_REWARD_ITEM, rq) = (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */)
+			qdata(QDATA_DEADLINE, rq) = -1
+			rewardfix = 175
+			return
+		}
+	}
+	if ( rnd(11) == 0 & gdata(GDATA_AREA) != AREA_RUST_PLAZA & gdata(GDATA_AREA) != AREA_OL_DRAN ) {
+		qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
+		qdata(QDATA_EXIST, rq) = QUEST_TYPE_ESCORT
+		qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_GUARD
+		qdata(QDATA_VAR, rq) = rnd(3)
+		qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq) = 0
+		qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+		if ( gdata(GDATA_AREA) == AREA_EIREL | gdata(GDATA_AREA) == AREA_MELKAWN | gdata(GDATA_AREA) == AREA_KURUALM | gdata(GDATA_AREA) == AREA_VALM | gdata(GDATA_AREA) == AREA_MELUGAS | gdata(GDATA_AREA) == AREA_ARCBELC | gdata(GDATA_AREA) == AREA_LUDUS ) {
+			repeat
+				qdata(QDATA_PARAM1, rq) = asettowns(rnd(length(asettowns)))
+				if ( qdata(QDATA_PARAM1, rq) != gdata(GDATA_AREA) ) {
+					break
+				}
+			loop
+		}
+		if ( gdata(GDATA_AREA) == AREA_VERNIS | gdata(GDATA_AREA) == AREA_YOWYN | gdata(GDATA_AREA) == AREA_PALMIA | gdata(GDATA_AREA) == AREA_DERPHY | gdata(GDATA_AREA) == AREA_PORT_KAPUL | gdata(GDATA_AREA) == AREA_LUMIEST | gdata(GDATA_AREA) == AREA_NOYEL ) {
+			repeat
+				qdata(QDATA_PARAM1, rq) = asettownn(rnd(length(asettownn)))
+				if ( qdata(QDATA_PARAM1, rq) != gdata(GDATA_AREA) ) {
+					break
+				}
+			loop
+		}
+		p = qdata(QDATA_PARAM1, rq)
+		if ( qdata(QDATA_VAR, rq) == 0 ) {
+			rewardfix = 140 + dist(adata(ADATA_X, gdata(GDATA_AREA)), adata(ADATA_Y, gdata(GDATA_AREA)), adata(ADATA_X, p), adata(ADATA_Y, p)) * 2
+			qdata(QDATA_DEADLINE, rq) = rnd(8) + 6
+			qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cdata(CDATA_FAME, CHARA_PLAYER) / 500 + 1) + 1, 1, 80)
+		}
+		if ( qdata(QDATA_VAR, rq) == 1 ) {
+			rewardfix = 130 + dist(adata(ADATA_X, gdata(GDATA_AREA)), adata(ADATA_Y, gdata(GDATA_AREA)), adata(ADATA_X, p), adata(ADATA_Y, p)) * 2
+			qdata(QDATA_DEADLINE, rq) = rnd(5) + 2
+			qdata(QDATA_LEVEL, rq) = limit(rewardfix / 10 + 1, 1, 40)
+		}
+		if ( qdata(QDATA_VAR, rq) == 2 ) {
+			rewardfix = 80 + dist(adata(ADATA_X, gdata(GDATA_AREA)), adata(ADATA_Y, gdata(GDATA_AREA)), adata(ADATA_X, p), adata(ADATA_Y, p)) * 2
+			qdata(QDATA_DEADLINE, rq) = rnd(8) + 6
+			qdata(QDATA_LEVEL, rq) = limit(rewardfix / 20 + 1, 1, 40)
+		}
+		if ( qdata(QDATA_PARAM1, rq) == 33 | gdata(GDATA_AREA) == AREA_NOYEL ) {
+			rewardfix = rewardfix * 180 / 100
+		}
+		if ( qdata(QDATA_PARAM1, rq) == 57 | gdata(GDATA_AREA) == AREA_LUDUS ) {
+			rewardfix = rewardfix * 120 / 100
+		}
+		return
+	}
+	if ( rnd(35) == 0 | (gdata(GDATA_AREA) == AREA_DERPHY & rnd(8) == 0) | (gdata(GDATA_AREA) == AREA_LUDUS & rnd(12) == 0) ) {
+		if ( gdata(GDATA_AREA) != AREA_RUST_PLAZA & gdata(GDATA_AREA) != AREA_OL_DRAN ) {
+			qdata(QDATA_LEVEL, rq) = limit(rnd(sdata(SKILL_NORMAL_DETECTION, CHARA_PLAYER) + sdata(SKILL_ATTR_PER, CHARA_PLAYER) / 30 + 5), int(sqrt(sdata(SKILL_NORMAL_DETECTION, CHARA_PLAYER)) + 1) / 2 + 5, cdata(CDATA_FAME, CHARA_PLAYER) / 2000 + 5)
+			if ( qdata(QDATA_LEVEL, rq) > 66 ) {
+				qdata(QDATA_LEVEL, rq) = 66
+			}
+			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
+			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qdata(QDATA_EXIST, rq) = QUEST_TYPE_MINEFIELD
+			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_TRAP
+			if ( cdata(CDATA_FAME, CHARA_PLAYER) >= 15000 ) {
+				qdata(QDATA_VAR, rq) = rnd(2)
+			}
+			else {
+				qdata(QDATA_VAR, rq) = 0
+			}
+			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qdata(QDATA_PARAM1, rq) = qdata(QDATA_LEVEL, rq) + rnd(5)
+			qdata(QDATA_PARAM2, rq) = 0
+			qdata(QDATA_DEADLINE, rq) = -1
+			rewardfix = 0
+			return
+		}
+	}
+	if ( rnd(23) == 0 | (gdata(GDATA_AREA) == AREA_PALMIA & rnd(8) == 0) | (gdata(GDATA_AREA) == AREA_ARCBELC & rnd(2) == 0) ) {
+		if ( gdata(GDATA_AREA) != AREA_RUST_PLAZA & gdata(GDATA_AREA) != AREA_OL_DRAN ) {
+			qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) + sdata(SKILL_ATTR_CHA, CHARA_PLAYER) / 10 + 10), int(1.5 * sqrt(gdata(GDATA_DEEPEST_LEVEL) + 4)) + 10, cdata(CDATA_FAME, CHARA_PLAYER) / 1000 + 10)
+			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
+			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qdata(QDATA_EXIST, rq) = QUEST_TYPE_PARTY
+			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_PERFORM
+			qdata(QDATA_VAR, rq) = 0
+			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qdata(QDATA_PARAM1, rq) = qdata(QDATA_LEVEL, rq) * 10 + rnd(50)
+			qdata(QDATA_PARAM2, rq) = 0
+			qdata(QDATA_DEADLINE, rq) = -1
+			rewardfix = 0
+			return
+		}
+	}
+	if ( rnd(30) == 0 | (gdata(GDATA_AREA) == AREA_YOWYN & rnd(2) == 0) | (gdata(GDATA_AREA) == AREA_LUDUS & rnd(8) == 0) | (gdata(GDATA_AREA) == AREA_RUST_PLAZA & rnd(2) == 0) ) {
+		if ( gdata(GDATA_AREA) != AREA_OL_DRAN ) {
+			qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 3 + 2), 2, 50)
+			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
+			qdata(QDATA_EXIST, rq) = QUEST_TYPE_HARVEST
+			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_CARRY
+			qdata(QDATA_VAR, rq) = 0
+			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qdata(QDATA_DEADLINE, rq) = -1
+			qdata(QDATA_PARAM1, rq) = 15000 + qdata(QDATA_LEVEL, rq) * 2500
+			qdata(QDATA_PARAM2, rq) = 0
+			rewardfix = 60 + qdata(QDATA_LEVEL, rq) * 2
+			return
+		}
+	}
+	if ( rnd(8) == 0 ) {
+		qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cdata(CDATA_FAME, CHARA_PLAYER) / 500 + 1) + 1, 1, 80)
+		qdata(QDATA_LEVEL, rq) = roundmargin(qdata(QDATA_LEVEL, rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
+		qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
+		qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+		qdata(QDATA_EXIST, rq) = QUEST_TYPE_HUNT
+		qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_ELIMINATE
+		qdata(QDATA_VAR, rq) = 0
+		qdata(QDATA_REWARD_ITEM, rq) = (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */)
+		qdata(QDATA_DEADLINE, rq) = -1
+		rewardfix = 135
+		return
+	}
+	if ( rnd(6) == 0 | gdata(GDATA_AREA) == AREA_RUST_PLAZA ) {
+		if ( gdata(GDATA_AREA) != AREA_OL_DRAN ) {
+			qdata(QDATA_EXIST, rq) = QUEST_TYPE_COOK
+			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_SUPPLY
+			qdata(QDATA_DEADLINE, rq) = rnd(6) + 2
+			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qdata(QDATA_PARAM1, rq) = rnd(9 - 1) + 1
+			if ( qdata(QDATA_PARAM1, rq) == 4 ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ITEM_POTION
+			}
+			if ( qdata(QDATA_PARAM1, rq) == 6 ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_AMMO
+			}
+			if ( qdata(QDATA_PARAM1, rq) == 1 ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_AMMO
+			}
+			if ( qdata(QDATA_PARAM1, rq) == 5 ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ITEM_POTION
+			}
+			if ( qdata(QDATA_PARAM1, rq) == 7 ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ORE
+			}
+			if ( qdata(QDATA_PARAM1, rq) == 2 ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ITEM_ROD
+			}
+			if ( qdata(QDATA_PARAM1, rq) == 3 ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ITEM_SCROLL
+			}
+			qdata(QDATA_PARAM2, rq) = rnd(10 - 3) + 3
+			qdata(QDATA_LEVEL, rq) = qdata(QDATA_PARAM2, rq) * 3
+			rewardfix = 60 + qdata(QDATA_LEVEL, rq)
+			return
+		}
+	}
+	if ( rnd(5) == 0 | gdata(GDATA_AREA) == AREA_OL_DRAN ) {
+		qdata(QDATA_EXIST, rq) = QUEST_TYPE_SUPPLY
+		qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_SUPPLY
+		qdata(QDATA_DEADLINE, rq) = rnd(6) + 2
+		flt
+		dbmode = DBMODE_FIND
+		flttypemajor = fsetsupply(rnd(length(fsetsupply)))
+		gosub *db_item
+		qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+		qdata(QDATA_DEST_ITEM, rq) = dbid
+		qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 5) + 1, 1, 30)
+		rewardfix = 65 + qdata(QDATA_LEVEL, rq)
+		return
+	}
+	if ( rnd(6) == 0 | (gdata(GDATA_AREA) == AREA_KURUALM & rnd(2) == 0) ) {
+		i = -1
+		repeat gdata(GDATA_CLIENT)
+			p = rnd(gdata(GDATA_CLIENT))
+			repeat gdata(GDATA_CLIENT)
+				if ( qdata(QDATA_EXIST, cnt) == QUEST_TYPE_DELIVER ) {
+					if ( qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), cnt) == p ) {
+						p = -1
+						break
+					}
+				}
+			loop
+			if ( p == (-1) ) {
+				continue
+			}
+			if ( gdata(GDATA_AREA) == AREA_EIREL | gdata(GDATA_AREA) == AREA_MELKAWN | gdata(GDATA_AREA) == AREA_KURUALM | gdata(GDATA_AREA) == AREA_VALM | gdata(GDATA_AREA) == AREA_MELUGAS | gdata(GDATA_AREA) == AREA_ARCBELC | gdata(GDATA_AREA) == AREA_LUDUS ) {
+				if ( qdata(QDATA_MAP, p) != 50 & qdata(QDATA_MAP, p) != 52 & qdata(QDATA_MAP, p) != 53 & qdata(QDATA_MAP, p) != 54 & qdata(QDATA_MAP, p) != 55 & qdata(QDATA_MAP, p) != 56 & qdata(QDATA_MAP, p) != 57 ) {
+					continue
+				}
+			}
+			if ( gdata(GDATA_AREA) == AREA_VERNIS | gdata(GDATA_AREA) == AREA_YOWYN | gdata(GDATA_AREA) == AREA_PALMIA | gdata(GDATA_AREA) == AREA_DERPHY | gdata(GDATA_AREA) == AREA_PORT_KAPUL | gdata(GDATA_AREA) == AREA_LUMIEST | gdata(GDATA_AREA) == AREA_NOYEL ) {
+				if ( qdata(QDATA_MAP, p) != 5 & qdata(QDATA_MAP, p) != 12 & qdata(QDATA_MAP, p) != 15 & qdata(QDATA_MAP, p) != 14 & qdata(QDATA_MAP, p) != 11 & qdata(QDATA_MAP, p) != 36 & qdata(QDATA_MAP, p) != 33 ) {
+					continue
+				}
+			}
+			if ( qdata(QDATA_CLIENT, p) != 0 ) {
+				if ( qdata(QDATA_MAP, p) != gdata(GDATA_AREA) ) {
+					i = p
+					break
+				}
+			}
+		loop
+		if ( i != (-1) ) {
+			p = qdata(QDATA_MAP, i)
+			rewardfix = 70 + dist(adata(ADATA_X, gdata(GDATA_AREA)), adata(ADATA_Y, gdata(GDATA_AREA)), adata(ADATA_X, p), adata(ADATA_Y, p)) * 2
+			if ( p == 33 | gdata(GDATA_AREA) == AREA_NOYEL ) {
+				rewardfix = rewardfix * 175 / 100
+			}
+			qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq) = i
+			flt
+			dbmode = DBMODE_FIND
+			flttypemajor = fsetdeliver(rnd(length(fsetdeliver)))
+			gosub *db_item
+			qdata(QDATA_PARAM1, rq) = flttypemajor
+			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			if ( flttypemajor == FILTER_ITEM_SPELLBOOK ) {
+				qdata(QDATA_REWARD_ITEM, rq) = (2 /*!!!@[FILTER_RACE_ORC @@@ QUEST_REWARD_MAGIC]@!!! */)
+			}
+			if ( flttypemajor == FILTER_ORE ) {
+				qdata(QDATA_REWARD_ITEM, rq) = (3 /*!!!@[FILTER_RACE_SLIME @@@ QUEST_REWARD_ARMOR]@!!! */)
+			}
+			if ( flttypemajor == FILTER_JUNK ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ORE
+			}
+			if ( flttypemajor == FILTER_FURNITURE ) {
+				qdata(QDATA_REWARD_ITEM, rq) = FILTER_FURNITURE
+			}
+			qdata(QDATA_DEST_ITEM, rq) = dbid
+			qdata(QDATA_EXIST, rq) = QUEST_TYPE_DELIVER
+			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_DELIVER
+			qdata(QDATA_VAR, rq) = 0
+			qdata(QDATA_DEADLINE, rq) = rnd(12) + 3
+			qdata(QDATA_LEVEL, rq) = limit(rewardfix / 20 + 1, 1, 25)
+		}
+		return
+	}
+	return 1
+
+*label_8945
+	repeat gdata(GDATA_CLIENT)
+		if ( qdata(QDATA_EXIST, cnt) == QUEST_TYPE_NONE ) {
+			continue
+		}
+		if ( qdata(QDATA_STATE, cnt) != QUEST_STATE_ONGOING ) {
+			continue
+		}
+		if ( qdata(QDATA_DEADLINE, cnt) < 0 ) {
+			continue
+		}
+		rq = cnt
+		qdata(QDATA_DEADLINE, rq)--
+		if ( qdata(QDATA_DEADLINE, rq) == 0 ) {
+			val = qdata(QDATA_EXIST, rq)
+			gosub *quest_fail
+		}
+	loop
+	return
+
+*label_8947
+	if ( gdata(GDATA_QUEST) == QUEST_TYPE_HARVEST ) {
+		inv_getheader 0
+		repeat invrange, invhead
+			if ( inv(INV_ITEM_PROPERTY, cnt) == PROP_QUEST ) {
+				inv(INV_ITEM_NUM, cnt) = 0
+			}
+		loop
+		gosub *label_4102
+	}
+	if ( gdata(GDATA_QUEST_STATE) != QUEST_STATE_SUCCESS ) {
+		if ( gdata(GDATA_QUEST) >= STARTING_QUEST_TYPE ) {
+			rq = gdata(GDATA_QUEST_REF)
+		}
+		if ( gdata(GDATA_QUEST) == QUEST_TYPE_ESCORT ) {
+			if ( qdata(QDATA_STATE, rq) == QUEST_STATE_NONE ) {
+				gdata(GDATA_QUEST) = QUEST_TYPE_NONE, 0, 0, 0
+				return
+			}
+			else {
+				txtmore
+				txt lang("あなたはクライアントを置き去りにした。", "You left your client.")
+			}
+		}
+		val = gdata(GDATA_QUEST)
+		gosub *quest_fail
+		msg_halt
+	}
+	gdata(GDATA_QUEST) = QUEST_TYPE_NONE, 0, 0, 0
+	return
+
+*quest_death
+	rc = CHARA_PLAYER
+	gosub *chara_respawn
+	skillexp SKILL_ATTR_CHA, CHARA_PLAYER, -500
+	skillexp SKILL_ATTR_WIL, CHARA_PLAYER, -500
+	levelexitby = MAP_EXIT_NORMAL
+	gdata(GDATA_LEVEL) = 0
+	goto *map_exit
+
+*quest_fail
+	if ( val == 1 ) {
+		txt lang("あなたは敗北した。", "You were defeated.")
+		modrank 0, -100
+	}
+	if ( val >= 1000 ) {
+		txt lang(qname(rq) + "から受けた依頼は失敗に終わった。", "You have failed the quest taken from " + qname(rq) + ".")
+		gdata(GDATA_FLAG_JOBS_FAILED)++
+		if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_DELIVER ) {
+			qdata(QDATA_QUEST_TARGET, qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq))--
+			txtmore
+			txtef COLOR_PURPLE
+			txt lang("あなたは重大な罪を犯した!", "You comit a serious crime!")
+			modkarma 0, -20
+		}
+		if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_ESCORT ) {
+			txtmore
+			txtef COLOR_PURPLE
+			txt lang("あなたは護衛の任務を果たせなかった。", "You have failed to protect the client.")
+			repeat 16
+				if ( cnt != 0 ) {
+					if ( cbit(CHARA_BIT_BODYGUARD, cnt) == TRUE ) {
+						if ( qdata(QDATA_PARAM2, rq) == cdata(CDATA_ID, cnt) ) {
+							tc = cnt
+							cbitmod CHARA_BIT_BODYGUARD, cnt, FALSE
+							if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
+								if ( qdata(QDATA_VAR, rq) == 0 ) {
+									s = lang("「おい、暗殺者が私の後ろにいるぞ」", cnvtalk("Hey, the assassins are killing me."))
+									p = -11
+								}
+								if ( qdata(QDATA_VAR, rq) == 1 ) {
+									s = lang("「毒が、毒がー！」", cnvtalk("Poison! P-P-Poison in my vein!!"))
+									p = -4
+								}
+								if ( qdata(QDATA_VAR, rq) == 2 ) {
+									s = lang("「時間切れだ。こうなったら…」" + name(tc) + "は火をかぶった。", cnvtalk("I missed the deadline. I don't have a right to live anymore.") + " " + name(tc) + " pours a bottole of molotov cocktail over " + him(tc) + "self.")
+									addmef cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 25, efp, CHARA_PLAYER
+									mapitem_fire cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
+									p = -9
+								}
+								txtef COLOR_SKY_BLUE
+								txtmore
+								txt s
+								dmghp tc, 999999, p
+							}
+							cdata(CDATA_EXIST, tc) = CHAR_STATE_DEAD
+							break
+						}
+					}
+				}
+			loop
+			modkarma 0, -10
+		}
+		qdata(QDATA_EXIST, rq) = QUEST_TYPE_NONE
+		qdata(QDATA_STATE, rq) = QUEST_STATE_NONE
+	}
+	decfame CHARA_PLAYER, 40
+	p = stat
+	txtmore
+	txtef COLOR_RED
+	txt lang("名声値を" + p + "失った。", "You lose " + p + " fame.")
+	return
+
+*quest_petArenaWin
+	repeat 16
+		if ( cdata(CDATA_DIRECTIVE_MODE, cnt) == DIRECTIVE_MODE_TEMPORARY ) {
+			cdata(CDATA_DIRECTIVE_MODE, cnt) = cdata(CDATA_DIRECTIVE_MODE_ORG, cnt)
+		}
+		if ( followerin(cnt) == 0 ) {
+			continue
+		}
+		if ( cdata(CDATA_HP, cnt) < cdata(CDATA_MAX_HP, cnt) / 2 ) {
+			cdata(CDATA_HP, cnt) = cdata(CDATA_MAX_HP, cnt) / 2
+		}
+		cdata(CDATA_FAME, cnt) += calcfame(cnt, (220 - gdata(GDATA_RANK_PET_ARENA) / 50) * (50 + limit(adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)), 0, 50)) / 100 + 2) * 2
+	loop
+	snd SOUNDLIST_CHEER
+	if ( petarenawin == 1 ) {
+		txtef COLOR_GREEN
+		txt lang("あなたのチームは勝利した！", "Your team is victorious!")
+		txtef COLOR_GREEN
+		txtmore
+		txt lang("" + gdata(GDATA_QUEST_FAME) + "の名声値を手に入れた。", "You gain " + gdata(GDATA_QUEST_FAME) + " fame.")
+		if ( arenaimport == 1 ) {
+			gdata(GDATA_EX_BATTLE_WIN)++
+			if ( enemylv > gdata(GDATA_EX_BATTLE_MAX_LVL) ) {
+				txt lang("EXバトルの撃破相手LVの記録を更新した(Lv" + gdata(GDATA_EX_BATTLE_MAX_LVL) + " → " + enemylv + " )", "You've made a new record. (Lv" + gdata(GDATA_EX_BATTLE_MAX_LVL) + " to " + enemylv + " )")
+				gdata(GDATA_EX_BATTLE_MAX_LVL) = enemylv
+			}
+		}
+		else {
+			cdata(CDATA_FAME, CHARA_PLAYER) += gdata(GDATA_QUEST_FAME)
+			modrank 1, 100, 2
+			adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA))++
+			gdata(GDATA_FLAG_HIGHEST_PET_ARENA_STREAK)++
+			if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 100 == 0 ) {
+				snd SOUNDLIST_DING3
+				txt lang("なんと…" + adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) + "勝を達成した！追加で30000の名声値を手に入れた。", "You gain 30000 fame!!")
+				await 2000
+				cdata(CDATA_FAME, CHARA_PLAYER) += 30000
+				prenshyou = 100
+			}
+			else {
+				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 3 == 0 ) {
+					prenshyou = 3
+				}
+				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 10 == 0 ) {
+					prenshyou = 10
+				}
+				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 30 == 0 ) {
+					prenshyou = 30
+				}
+				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 50 == 0 ) {
+					prenshyou = 50
+				}
+				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 20 == 0 ) {
+					matgetmain MATERIAL_500_YEN_COIN, 1
+				}
+				else {
+					if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 5 == 0 ) {
+						matgetmain MATERIAL_100_YEN_COIN, 1
+					}
+				}
+			}
+		}
+	}
+	else {
+		txtef COLOR_PURPLE
+		txt lang("あなたのチームは敗北した。", "Your team is defeated.")
+		modrank 1, -100
+		decfame CHARA_PLAYER, 60
+		p = stat
+		if ( arenaop == 0 ) {
+			txtmore
+			txtef COLOR_RED
+			txt lang("名声値を" + p + "失った。", "You loose " + p + " fame.")
+		}
+	}
+	return
+
+*label_8954
+	music = MUSICLIST_MCFANFARE
+	musicloop = 1
+	gosub *music_play
+	gdata(GDATA_QUEST_STATE) = QUEST_STATE_SUCCESS
+	if ( gdata(GDATA_QUEST) == QUEST_SUBTYPE_ELIMINATE ) {
+		snd SOUNDLIST_CHEER
+		txtef COLOR_GREEN
+		txt lang("あなたは勝利した！", "You are victorious!")
+		txtef COLOR_GREEN
+		txtmore
+		txt lang("" + gdata(GDATA_QUEST_FAME) + "の名声値を手に入れた。", "You gain " + gdata(GDATA_QUEST_FAME) + " fame.")
+		modrank 0, 100, 2
+		cdata(CDATA_FAME, CHARA_PLAYER) += gdata(GDATA_QUEST_FAME)
+		txt lang("外への階段が現れた。", "Stairs appear.")
+		map_placeupstairs mdata(MDATA_WIDTH) / 2, mdata(MDATA_HEIGHT) / 2
+		adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA))++
+		gdata(GDATA_FLAG_HIGHEST_ARENA_STREAK)++
+		if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 100 == 0 ) {
+			snd SOUNDLIST_DING3
+			snd SOUNDLIST_DING1
+			txt lang("なんと…" + adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) + "勝を達成した！追加で30000の名声値を手に入れた。", "You gain 30000 fame!!")
+			cdata(CDATA_FAME, CHARA_PLAYER) += 30000
+			renshyou = 100
+		}
+		else {
+			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 3 == 0 ) {
+				renshyou = 3
+			}
+			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 10 == 0 ) {
+				renshyou = 10
+			}
+			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 30 == 0 ) {
+				renshyou = 30
+			}
+			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 50 == 0 ) {
+				renshyou = 50
+			}
+			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 20 == 0 ) {
+				matgetmain MATERIAL_500_YEN_COIN, 1
+			}
+			else {
+				if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 5 == 0 ) {
+					matgetmain MATERIAL_100_YEN_COIN, 1
+				}
+			}
+		}
+	}
+	if ( gdata(GDATA_QUEST) == QUEST_TYPE_HUNT | gdata(GDATA_QUEST) == QUEST_TYPE_HUNTEX ) {
+		qdata(QDATA_STATE, gdata(GDATA_QUEST_REF)) = QUEST_STATE_SUCCESS
+		txtef COLOR_GREEN
+		txt lang("エリアを制圧した！", "The area is secured!")
+	}
+	if ( gdata(GDATA_QUEST) == QUEST_TYPE_ESCORT ) {
+		txtef COLOR_GREEN
+		txt lang("エリアを制圧した！", "The area is secured!")
+	}
+	if ( gdata(GDATA_QUEST) == QUEST_TYPE_THIEVES ) {
+		txtef COLOR_GREEN
+		txt lang("盗賊団を返り討ちにした！", "The area is secured!")
+		gdata(GDATA_FLAG_BANDITS_KILLED)++
+	}
+	if ( gdata(GDATA_QUEST) == QUEST_TYPE_CONQUER ) {
+		gdata(GDATA_TIME_LIMIT) = 0
+		qdata(QDATA_STATE, gdata(GDATA_QUEST_REF)) = QUEST_STATE_SUCCESS
+		txtef COLOR_GREEN
+		txt lang("討伐に成功した！", "You successfully slay the target.")
+	}
+	return
+
+*quest_success
+	snd SOUNDLIST_COMPLETE1
+	p = qdata(QDATA_REWARD, rq)
+	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_HARVEST ) {
+		if ( qdata(QDATA_PARAM1, rq) != 0 ) {
+			if ( qdata(QDATA_PARAM1, rq) * 125 / 100 < qdata(QDATA_PARAM2, rq) ) {
+				p = limit(p * qdata(QDATA_PARAM2, rq) / qdata(QDATA_PARAM1, rq), p, p * 3)
+			}
+		}
+	}
+	if ( p != 0 ) {
+		flt
+		itemcreate -1, ITEM_ID_GOLD_PIECE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), p
+	}
+	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_PARTY ) {
+		p = 1
+	}
+	else {
+		p = limit(rnd(1 + cdata(CDATA_FAME, CHARA_PLAYER) / EXT_EQUIP_SLOTS), 1, 3)
+	}
+	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_CONQUER | qdata(QDATA_EXIST, rq) == QUEST_TYPE_HUNTEX ) {
+		p = limit(rnd(2 + cdata(CDATA_FAME, CHARA_PLAYER) / 20000), 2, 6)
+	}
+	flt
+	itemcreate -1, ITEM_ID_PLATINUM_COIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), p
+	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_PARTY ) {
+		if ( qdata(QDATA_PARAM1, rq) * 150 / 100 < qdata(QDATA_PARAM2, rq) ) {
+			flt
+			itemcreate -1, ITEM_ID_MUSIC_TICKET, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1 + qdata(QDATA_PARAM2, rq) / 10
+		}
+	}
+	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_MINEFIELD ) {
+		flt
+		itemcreate -1, ITEM_ID_DEVIL_FRAGMENT, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), limit(1 + qdata(QDATA_PARAM2, rq) / 5, 1, 30)
+		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
+		if ( qdata(QDATA_PARAM1, rq) * 125 / 100 <= qdata(QDATA_PARAM2, rq) | qdata(QDATA_VAR, rq) == 1 ) {
+			flt
+			itemcreate -1, ITEM_ID_BRONZE_COIN, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 1
+		}
+	}
+	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_HARVEST ) {
+		if ( qdata(QDATA_PARAM1, rq) * 125 / 100 < qdata(QDATA_PARAM2, rq) ) {
+			flt
+			itemcreate -1, ITEM_ID_BRONZE_COIN, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 1
+		}
+		seedp = rnd(limit(sdata(SKILL_NORMAL_GARDENING, CHARA_PLAYER) / 2, 0, 30) + 80)
+		if ( seedp >= 90 ) {
+			if ( rnd(2) == 0 ) {
+				itemcreate -1, ITEM_ID_HERB_SEED, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 3
+			}
+			else {
+				itemcreate -1, ITEM_ID_HERB_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 2
+			}
+		}
+		if ( seedp >= 70 & seedp < 90 ) {
+			if ( rnd(2) == 0 ) {
+				itemcreate -1, ITEM_ID_UNKNOWN_SEED, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 3
+			}
+			else {
+				itemcreate -1, ITEM_ID_MAGICAL_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 4
+			}
+		}
+		if ( seedp >= 50 & seedp < 70 ) {
+			itemcreate -1, ITEM_ID_GEM_SEED, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 4
+		}
+		if ( seedp >= 0 & seedp < 50 ) {
+			if ( rnd(2) == 0 ) {
+				itemcreate -1, ITEM_ID_FRUIT_SEED, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 5
+			}
+			else {
+				itemcreate -1, ITEM_ID_VEGETABLE_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 5
+			}
+		}
+	}
+	if ( qdata(QDATA_REWARD_ITEM, rq) != (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */) ) {
+		p = rnd(rnd(4) + 1) + 1
+		if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_CONQUER | qdata(QDATA_EXIST, rq) == QUEST_TYPE_HUNTEX ) {
+			p += 2
+		}
+		repeat p
+			fixlv = FIX_QUALITY_GOOD
+			if ( rnd(2) ) {
+				fixlv = FIX_QUALITY_GREAT
+				if ( rnd(12) == 0 ) {
+					fixlv = FIX_QUALITY_MIRACLE
+				}
+			}
+			flt (qdata(QDATA_LEVEL, rq) + gdata(GDATA_DEEPEST_LEVEL) / 2) / 2 + 1, calcfixlv(fixlv)
+			if ( qdata(QDATA_REWARD_ITEM, rq) < FILTER_WEAPON ) {
+				if ( qdata(QDATA_REWARD_ITEM, rq) == (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */) ) {
+					flttypemajor = fsetwear(rnd(length(fsetwear)))
+				}
+				if ( qdata(QDATA_REWARD_ITEM, rq) == (2 /*!!!@[FILTER_RACE_ORC @@@ QUEST_REWARD_MAGIC]@!!! */) ) {
+					flttypemajor = fsetmagic(rnd(length(fsetmagic)))
+				}
+				if ( qdata(QDATA_REWARD_ITEM, rq) == (3 /*!!!@[FILTER_RACE_SLIME @@@ QUEST_REWARD_ARMOR]@!!! */) ) {
+					flttypemajor = fsetarmor(rnd(length(fsetarmor)))
+				}
+				if ( qdata(QDATA_REWARD_ITEM, rq) == (4 /*!!!@[FILTER_RACE_ELEA @@@ QUEST_REWARD_WEAPON]@!!! */) ) {
+					flttypemajor = fsetweapon(rnd(length(fsetweapon)))
+				}
+				if ( qdata(QDATA_REWARD_ITEM, rq) == (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */) ) {
+					flttypemajor = fsetrewardsupply(rnd(length(fsetrewardsupply)))
+				}
+			}
+			else {
+				flttypemajor = qdata(QDATA_REWARD_ITEM, rq)
+			}
+			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+		loop
+	}
+	modkarma 0, 1
+	gdata(GDATA_QUEST_FAME) = calcfame(CHARA_PLAYER, qdata(QDATA_LEVEL, rq) * 3 + 10)
+	txtef COLOR_GREEN
+	txt lang(qname(rq) + "から受けた依頼を完了した。", "You have completed the quest taken from " + qname(rq) + ".")
+	if ( gdata(GDATA_FLAG_ZISILION_SIDEQUEST) == 100 ) {
+		gdata(GDATA_FLAG_ZISILION_SIDEQUEST) = 300
+	}
+	hatugen = limit(sqrt(qdata(QDATA_LEVEL, rq) + 1), 3, 10) * 10
+	mdata(MDATA_CITY_AUTHORITY) += hatugen
+	if ( mdata(MDATA_CITY_ETHER_CORRUPTION) != 0 ) {
+		txtef COLOR_GREEN
+		txt lang("発言力を" + hatugen + "獲得（現在" + mdata(MDATA_CITY_AUTHORITY) + "）、", "You get " + hatugen + " praise.")
+	}
+	gdata(GDATA_FLAG_JOBS_COMPLETED)++
+	txtef COLOR_GREEN
+	txtmore
+	txt lang("" + gdata(GDATA_QUEST_FAME) + "の名声値を手に入れた。", "You gain " + gdata(GDATA_QUEST_FAME) + " fame.")
+	cdata(CDATA_FAME, CHARA_PLAYER) += gdata(GDATA_QUEST_FAME)
+	txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
+	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_DELIVER ) {
+		qdata(QDATA_QUEST_TARGET, qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq))--
+	}
+	qdata(QDATA_EXIST, rq) = QUEST_TYPE_NONE
+	qdata(QDATA_STATE, rq) = QUEST_STATE_NONE
+	autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
+	return
+
+
+
+
+
+
+
+
+
+
+
+
 
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/ai.hsp ../2.14-borscht/ai.hsp
--- ../2.13-borscht/ai.hsp	2022-06-26 12:14:11.443397900 -0700
+++ ../2.14-borscht/ai.hsp	2022-09-18 12:36:58.498911900 -0700
@@ -233,22 +233,22 @@
 				if ( kamui == 21 | cdata(CDATA_HP, cc) <= cdata(CDATA_MAX_HP, cc) / 2 ) {
 					kamui = 22
 					snd SOUNDLIST_ENC
 					animeload 40, cc
 					evadd EVENT_CHAOS_CRADLE_SPAWN_YAYAUHQUI
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 			if ( gdata(GDATA_FLAG_MAIN) == 880 ) {
 				healhp cc, cdata(CDATA_MAX_HP, cc) / 4
 				evadd EVENT_CHAOS_CRADLE_CHAT_JALDABAOTH
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( gdata(GDATA_FLAG_MAIN) == 890 ) {
 				healhp cc, cdata(CDATA_MAX_HP, cc) / 4
 				evadd EVENT_CHAOS_CRADLE_CHAT_JALDABAOTH
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_THE_CHAOS_CHILD ) {
 		if ( cdata(CDATA_ALLIED, cc) == 0 & gdata(GDATA_AREA) == AREA_CHAOS_CRADLE ) {
@@ -258,17 +258,17 @@
 				if ( rnd(20) > 0 ) {
 					cdata(CDATA_TARGET, cc) = 0
 				}
 				if ( cdata(CDATA_HP, cc) >= cdata(CDATA_MAX_HP, cc) / 2 ) {
 					if ( rnd(tekagen + 1) != 0 ) {
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 				if ( dist(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), cdata(CDATA_X, cc), cdata(CDATA_Y, cc)) <= 1 ) {
 					if ( cdata(CDATA_HP, cc) >= cdata(CDATA_MAX_HP, cc) / 2 ) {
 						if ( rnd(tekagen + 1) != 0 ) {
-							goto *turn_end
+							goto *label_9247
 						}
 					}
 				}
 				if ( gdata(GDATA_FLAG_CHAOS_CHILD_FORGET) < 70 ) {
 					gdata(GDATA_FLAG_CHAOS_CHILD_FORGET) = 70
@@ -309,20 +309,20 @@
 						animeload 8, cc
 						txtef COLOR_RED
 						txt lang(name(cc) + "は全てを忘れ、完全に動きを止めた…。", name(tc) + " forgot everything and completely stopped moving....")
 						gdata(GDATA_FLAG_MAIN) = 755
 						evadd EVENT_NAGAREW
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 				if ( gdata(GDATA_FLAG_MAIN) == 740 ) {
 					if ( gdata(GDATA_FLAG_CHAOS_CHILD_FORGET) >= 200 | cdata(CDATA_HP, cc) < cdata(CDATA_MAX_HP, cc) / 4 ) {
 						healhp cc, cdata(CDATA_MAX_HP, cc) / 4
 						gdata(GDATA_FLAG_CHAOS_CHILD_FORGET) = 200
 						gdata(GDATA_FLAG_MAIN) = 745
 						evadd EVENT_NAGAREW
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 				if ( gdata(GDATA_FLAG_MAIN) == 730 ) {
 					if ( gdata(GDATA_FLAG_CHAOS_CHILD_FORGET) >= 150 | cdata(CDATA_HP, cc) < cdata(CDATA_MAX_HP, cc) / 2 ) {
 						healhp cc, cdata(CDATA_MAX_HP, cc) / 4
@@ -332,42 +332,42 @@
 						anix = cdata(CDATA_X, cc)
 						aniy = cdata(CDATA_Y, cc)
 						gosub *anime
 						cdata(CDATA_CONDITION_BIND, cc) = 999
 						evadd EVENT_NAGAREW
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 				if ( gdata(GDATA_FLAG_MAIN) == 720 ) {
 					if ( gdata(GDATA_FLAG_CHAOS_CHILD_FORGET) >= 100 | cdata(CDATA_HP, cc) < cdata(CDATA_MAX_HP, cc) * 3 / 4 ) {
 						healhp cc, cdata(CDATA_MAX_HP, cc) / 4
 						gdata(GDATA_FLAG_CHAOS_CHILD_FORGET) = 100
 						gdata(GDATA_FLAG_MAIN) = 725
 						evadd EVENT_NAGAREW
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 			}
 			if ( gdata(GDATA_FLAG_MAIN) >= 845 ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( cbit(CHARA_BIT_BRUSHED, cc) & cbit(CHARA_BIT_LIVESTOCK, cc) == TRUE ) {
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_RAIZEL_THE_OLD_WIZARD ) {
 		if ( cdata(CDATA_ALLIED, cc) == 0 ) {
 			if ( gdata(GDATA_FLAG_MAIN) >= 760 ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD ) {
 		if ( cdata(CDATA_ALLIED, cc) == 0 ) {
 			if ( gdata(GDATA_FLAG_MAIN) >= 875 & gdata(GDATA_FLAG_MAIN) < 900 ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( cbit(CHARA_BIT_SANDBAG, cc) ) {
 		if ( synccheck(cc, -1) ) {
@@ -375,24 +375,24 @@
 				tc = cc
 				txt lang("「もっとぶって" + _yo(2) + "」", cnvtalk("Release me now.")), lang("「こんなことして、許さない" + _yo() + "」", cnvtalk("I won't forget this.")), lang("「何をする" + _nda(2) + "」", cnvtalk("Hit me!"))
 			}
 		}
 		cdata(CDATA_AI_AGGRO, cc) = 0
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( cbit(CHARA_BIT_LIVESTOCK, cc) ) {
-		goto *ai_calmMove
+		goto *label_8978
 	}
 	if ( cbit(CHARA_BIT_NECRO, cc) ) {
 		if ( synccheck(cc, -1) == 0 ) {
 			if ( rnd(2) == 0 ) {
 				if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
 					if ( gdata(GDATA_AREA) != AREA_PET_ARENA ) {
 						tc = CHARA_PLAYER
 						efid = SKILL_SPACT_SHADOW_STEP
 						gosub *effect
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 			}
 		}
 	}
@@ -418,11 +418,11 @@
 								}
 							}
 							tc = CHARA_PLAYER
 							efid = SKILL_SPACT_SHADOW_STEP
 							gosub *effect
-							goto *turn_end
+							goto *label_9247
 						}
 					}
 				}
 			}
 		}
@@ -430,11 +430,11 @@
 	if ( cbit(CHARA_BIT_SUICIDE_SWITCH, cc) ) {
 		tlocx = cdata(CDATA_X, cc)
 		tlocy = cdata(CDATA_Y, cc)
 		efid = SKILL_SPACT_SUICIDE_ATTACK
 		gosub *effect
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( cc < MAX_CHARA_FOLLOWER ) {
 		if ( gdata(GDATA_FLAG_GAME_MODE) == 1 & cdata(CDATA_RELATION, cc) == RELATION_DISLIKE & cdata(CDATA_IMPRESSION, cc) > 0 ) {
 			cdata(CDATA_RELATION, cc) = RELATION_ALLY
 			cdata(CDATA_TARGET, cc) = 0
@@ -461,11 +461,11 @@
 				}
 			}
 			if ( cdata(CDATA_TARGET, cc) == 0 ) {
 				if ( cc < MAX_CHARA_FOLLOWER | cdata(CDATA_ALLIED, cc) == 100 ) {
 					if ( cdata(CDATA_DIRECTIVE_MODE, cc) != DIRECTIVE_MODE_DEFENSIVE & cdata(CDATA_DIRECTIVE_MODE, cc) != DIRECTIVE_MODE_TALKING ) {
-						gosub *findTarget
+						gosub *label_5740
 					}
 				}
 			}
 			if ( cdata(CDATA_RELATION, cdata(CDATA_TARGET, cc)) > RELATION_ENEMY ) {
 				cdata(CDATA_TARGET, cc) = 0
@@ -513,22 +513,22 @@
 				if ( rnd(40) == 0 ) {
 					txtef COLOR_BLUE
 					txtmore
 					txt lang("「いいぞ！」", cnvtalk("Come on!")), lang("「もっとやれー」", cnvtalk("More blood!")), lang("「血をみせろー」", cnvtalk("Beat'em!")), lang("「頑張って！」", cnvtalk("Use your brain!")), lang("「うぉぉぉぉ！」", cnvtalk("Wooooo!")), lang("「行けぇ！」", cnvtalk("Go go!")), lang("「頭を使えよ」", cnvtalk("Good fighting.")), lang("「きゃー」", cnvtalk("Yeeee!"))
 				}
-				goto *ai_calmMove
+				goto *label_8978
 			}
 		}
 		if ( cbit(CHARA_BIT_SUMMONED, cc) == TRUE ) {
 			if ( cdata(CDATA_RELATION, cc) != RELATION_ALLY ) {
 				cdata(CDATA_RELATION, cc) = RELATION_DISLIKE
 				if ( rnd(40) == 0 ) {
 					txtef COLOR_BLUE
 					txtmore
 					txt lang("「面白そう！」", cnvtalk("Come on!")), lang("「どっちもがんばれー」", cnvtalk("More blood!"))
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		cdata(CDATA_AI_AGGRO, cc) = 100
 		if ( cdata(CDATA_RELATION, cc) == RELATION_ALLY ) {
 			p = -3, enemyteam, 15
@@ -569,11 +569,11 @@
 					petarenawin = 1
 				}
 				else {
 					petarenawin = 2
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( gdata(GDATA_AREA) == AREA_NOYEL ) {
 		if ( cc != gdata(GDATA_FLAG_GIANT_ID) ) {
@@ -627,16 +627,16 @@
 					if ( cdata(CDATA_X, CHARA_PLAYER) > cdata(CDATA_X, cc) - 10 & cdata(CDATA_X, CHARA_PLAYER) < cdata(CDATA_X, cc) + 10 ) {
 						if ( cdata(CDATA_Y, CHARA_PLAYER) > cdata(CDATA_Y, cc) - 10 & cdata(CDATA_Y, CHARA_PLAYER) < cdata(CDATA_Y, cc) + 10 ) {
 							if ( cdata(CDATA_ROW_ACT, CHARA_PLAYER) != ACTION_PERFORM ) {
 								if ( cdata(CDATA_AI_AGGRO, cc) <= 0 ) {
 									customtalk cc, DBMODE_FLAVOR_PASSIVE
-									gosub *convert_word
+									gosub *label_0416
 								}
 								if ( findbuff(cc, BUFF_RUN_WILDLY) == (-1) ) {
 									if ( cdata(CDATA_AI_AGGRO, cc) > 0 ) {
 										customtalk cc, DBMODE_FLAVOR_ANGERED
-										gosub *convert_word
+										gosub *label_0416
 									}
 								}
 							}
 						}
 					}
@@ -683,11 +683,11 @@
 					cdata(CDATA_CONDITION_DRUNK, cc) = cdata(CDATA_CONDITION_DRUNK, cc) / 8 + 1
 				}
 				if ( cdata(CDATA_CONDITION_BLEED, cc) != 0 ) {
 					cdata(CDATA_CONDITION_BLEED, cc) = cdata(CDATA_CONDITION_BLEED, cc) / 8 + 1
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( cdata(CDATA_ACT_HEAL, cc) != 0 ) {
 		if ( cdata(CDATA_HP, cc) < cdata(CDATA_MAX_HP, cc) / 4 ) {
@@ -701,18 +701,18 @@
 				}
 				if ( efid >= SKILL_SPELL_HEAL_LIGHT & efid < MAX_SPELL ) {
 					npccostmp = 1
 					gosub *cast
 					if ( stat == 1 ) {
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 				else {
 					if ( efid >= (600 /*!!!@[MAX_SKILL_RANGE @@@ STARTING_SKILL_SPACT]@!!! */) ) {
 						gosub *action
 						if ( stat == 1 ) {
-							goto *turn_end
+							goto *label_9247
 						}
 					}
 				}
 			}
 		}
@@ -733,20 +733,20 @@
 	}
 	if ( a == 57000 ) {
 		if ( cdata(CDATA_RELATION, cc) == RELATION_ALLY & cdata(CDATA_HUNGER, cc) > 10000 ) {
 		}
 		else {
-			if ( cdata(CDATA_TAMER_WHIP_EAT, cc) == 1 ) {
+			if ( cbit(1033, cc) == TRUE ) {
 				txtef COLOR_BLUE
 				customtalk cc, DBMODE_FLAVOR_DISCIPLINE_EAT
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					txt lang(name(cc) + "はあなたの顔色をうかがいながら恐る恐る食べ物を手に取った。", name(cc) + " is drooling.")
 				}
 				goto *act_eat
 			}
-			if ( cdata(CDATA_TAMER_WHIP_EAT, cc) == 0 ) {
+			if ( cbit(1033, cc) != TRUE ) {
 				goto *act_eat
 			}
 		}
 	}
 	if ( a == 52000 ) {
@@ -770,16 +770,16 @@
 	retreat = 0
 	if ( cdata(CDATA_AI_AGGRO, cc) > 0 | cdata(CDATA_RELATION, cc) == RELATION_ALLY ) {
 		distance = dist(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), cdata(CDATA_X, cc), cdata(CDATA_Y, cc))
 		if ( cdata(CDATA_CONDITION_BLIND, cc) != 0 ) {
 			if ( rnd(10) > 2 ) {
-				goto *ai_calmMove
+				goto *label_8978
 			}
 		}
 		if ( cdata(CDATA_CONDITION_CONFUSE, cc) != 0 ) {
 			if ( rnd(10) > 3 ) {
-				goto *ai_calmMove
+				goto *label_8978
 			}
 		}
 		if ( tc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_ID, cc) == CREATURE_ID_ALCHEMIST_NAPLUS ) {
 				if ( map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_ITEM_CHIPS) != 0 ) {
@@ -814,19 +814,19 @@
 											txtef COLOR_BLUE
 											txt lang(name(cc) + "はパートナーの食事を静かに見守っている…。", name(cc) + " is drooling.")
 										}
 									}
 									else {
-										if ( cdata(CDATA_TAMER_WHIP_EAT, cc) == 0 ) {
+										if ( cbit(1033, cc) != TRUE ) {
 											if ( cdata(CDATA_RIDING, cc) == 0 ) {
 												if ( inv(INV_ITEM_ID, ci) != ITEM_ID_PUFF_PUFF_BREAD | cdata(CDATA_ID, cc) != CREATURE_ID_ALCHEMIST_NAPLUS ) {
 													if ( inv(INV_ITEM_STATUS, ci) >= ITEM_STATUS_NORMAL ) {
 														if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_RANCH & adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_SHOP & gdata(GDATA_QUEST) != QUEST_TYPE_PARTY ) {
-															if ( cdata(CDATA_TAMER_WHIP_PICKUP, cc) != 10 | cdata(CDATA_MASTER_SERVANT, cc) <= 0 ) {
+															if ( cbit(1032, cc) != TRUE | cdata(CDATA_MASTER_SERVANT, cc) <= 0 ) {
 																goto *act_eat
 															}
-															if ( cdata(CDATA_TAMER_WHIP_PICKUP, cc) == 10 ) {
+															if ( cbit(1032, cc) == TRUE ) {
 																if ( cdata(CDATA_MASTER_SERVANT, cc) > 0 ) {
 																	if ( rnd(cdata(CDATA_MASTER_SERVANT, cc) + 1) == 0 ) {
 																		txtef COLOR_RED
 																		txt lang(name(cc) + "は我慢できず食べ物に近づいた。", name(cc) + " could not endure.")
 																		goto *act_eat
@@ -837,11 +837,11 @@
 													}
 												}
 											}
 										}
 									}
-									if ( cdata(CDATA_TAMER_WHIP_EAT, cc) == 1 ) {
+									if ( cbit(1033, cc) == TRUE ) {
 										if ( cdata(CDATA_RIDING, cc) == 0 ) {
 											if ( inv(INV_ITEM_ID, ci) != ITEM_ID_PUFF_PUFF_BREAD | cdata(CDATA_ID, cc) != CREATURE_ID_ALCHEMIST_NAPLUS ) {
 												if ( inv(INV_ITEM_STATUS, ci) >= ITEM_STATUS_NORMAL ) {
 													if ( rnd(5) == 0 ) {
 														txtef COLOR_BLUE
@@ -857,21 +857,21 @@
 								if ( cdata(CDATA_RIDING, cc) == 0 ) {
 									if ( inv(INV_ITEM_PROPERTY, ci) <= PROP_NPC ) {
 										if ( inv(INV_ITEM_PARAM1, ci) >= (-5) ) {
 											if ( inv(INV_ITEM_PARAM3, ci) < 20 ) {
 												if ( inv(INV_ITEM_ID, ci) != ITEM_ID_HOLY_WELL ) {
-													if ( cdata(CDATA_TAMER_WHIP_EAT, cc) == 1 ) {
+													if ( cbit(1033, cc) == TRUE ) {
 														if ( rnd(5) == 0 ) {
 															txtef COLOR_BLUE
 															txt lang(name(cc) + "は喉を潤そうとしたが、何かを思い出してびくりと震えた。", name(cc) + " could not endure.")
 														}
 													}
-													if ( cdata(CDATA_TAMER_WHIP_EAT, cc) != 1 ) {
-														if ( cdata(CDATA_TAMER_WHIP_PICKUP, cc) != 10 | cdata(CDATA_MASTER_SERVANT, cc) <= 0 ) {
+													if ( cbit(1033, cc) != TRUE ) {
+														if ( cbit(1032, cc) != TRUE | cdata(CDATA_MASTER_SERVANT, cc) <= 0 ) {
 															goto *act_drink
 														}
-														if ( cdata(CDATA_TAMER_WHIP_PICKUP, cc) == 10 ) {
+														if ( cbit(1032, cc) == TRUE ) {
 															if ( cdata(CDATA_MASTER_SERVANT, cc) > 0 ) {
 																if ( rnd(cdata(CDATA_MASTER_SERVANT, cc) * 2 + 1) == 0 ) {
 																	txtef COLOR_RED
 																	txt lang(name(cc) + "は我慢できず水に近づいた。", name(cc) + " is drooling.")
 																	goto *act_drink
@@ -889,15 +889,15 @@
 						if ( p == 68000 | p == 77000 ) {
 							if ( inv(INV_ITEM_PROPERTY, ci) <= PROP_NONE ) {
 								if ( ibit(ITEM_BIT_PRECIOUS, ci) == FALSE ) {
 									if ( mdata(MDATA_TYPE) != MAP_TYPE_HOME ) {
 										in = inv(INV_ITEM_NUM, ci)
-										if ( cdata(CDATA_TAMER_WHIP_PICKUP, cc) == 0 ) {
+										if ( cbit(1032, cc) != TRUE ) {
 											if ( gdata(GDATA_RIDER) != cc ) {
 												gosub *act_get
 												if ( stat == 1 ) {
-													goto *turn_end
+													goto *label_9247
 												}
 											}
 										}
 									}
 								}
@@ -905,19 +905,19 @@
 						}
 					}
 				}
 				if ( cdata(CDATA_AREA, cc) == gdata(GDATA_AREA) ) {
 					if ( cbit(CHARA_BIT_HIRED, cc) == FALSE ) {
-						goto *ai_calmMove
+						goto *label_8978
 					}
 				}
 				if ( distance > 2 | rnd(3) ) {
 					retreat = 0
 					goto *ai_followMove
 				}
 				else {
-					goto *ai_calmMove
+					goto *label_8978
 				}
 			}
 		}
 		if ( cdata(CDATA_CONDITION_FEAR, cc) != 0 ) {
 			retreat = 1
@@ -926,11 +926,11 @@
 		else {
 			retreat = 0
 		}
 		if ( cdata(CDATA_CONDITION_BLIND, cc) != 0 ) {
 			if ( rnd(3) ) {
-				goto *ai_calmMove
+				goto *label_8978
 			}
 		}
 		if ( distance != cdata(CDATA_AI_DISTANCE, cc) ) {
 			if ( rnd(100) < cdata(CDATA_AI_MOVE_FREQ, cc) ) {
 				goto *ai_followMove
@@ -995,44 +995,44 @@
 		loop
 	}
 	if ( tc == CHARA_PLAYER ) {
 		r1 = tc
 		r2 = cc
-		gosub *calcStealth
+		gosub *label_4095
 		if ( stat == 1 ) {
 			if ( cdata(CDATA_RELATION, cc) == RELATION_ENEMY ) {
 				cdata(CDATA_AI_AGGRO, cc) = 30
 			}
 		}
 	}
-	goto *ai_calmMove
+	goto *label_8978
 
-*ai_calmMove
+*label_8978
 	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE ) {
 		if ( cdata(CDATA_TARGET, cc) != 0 | cdata(CDATA_TARGET, cc) == 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_RAIZEL_THE_OLD_WIZARD ) {
 		if ( cdata(CDATA_ALLIED, cc) == 0 ) {
 			if ( gdata(GDATA_FLAG_MAIN) >= 760 ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( cdata(CDATA_AI_CALM, cc) == 4 | (cbit(CHARA_BIT_BRUSHED, cc) == FALSE & cdata(CDATA_BRUSH_LEVEL, cc) != 0 & cbit(CHARA_BIT_LIVESTOCK, cc) == TRUE) ) {
 		tc = CHARA_PLAYER
 		distance = dist(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), cdata(CDATA_X, cc), cdata(CDATA_Y, cc))
 		goto *ai_followMove
 	}
 	if ( cc > MAX_CHARA_FOLLOWER ) {
 		if ( rnd(5) != 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( adata(ADATA_TYPE, gdata(GDATA_AREA)) == MAP_TYPE_WORLD ) {
-		goto *turn_end
+		goto *label_9247
 	}
 
 	if ( cdata(CDATA_CONDITION_DRUNK, cc) != 0 ) {
 		if ( synccheck(cc, -1) ) {
 			if ( cdatan(CDATAN_RACE, cc) == "cat" ) {
@@ -1037,49 +1037,49 @@
 		if ( synccheck(cc, -1) ) {
 			if ( cdatan(CDATAN_RACE, cc) == "cat" ) {
 				if ( cdata(CDATA_CONDITION_DRUNK, cc) < 5 ) {
 					cdata(CDATA_CONDITION_DRUNK, cc) += 40
 				}
-*label_8967
+*label_8979
 				if ( 1 == 0 ) {
-					goto *ai_calmMove_WEND1
+					goto *label_8981
 				}
 				if ( jp ) {
 					if ( rnd(3) == 0 ) {
 						txt "「米さ米種だろ♪」", "「飲ま飲まイェイ！！」", "「飲ま飲ま飲まイェイ！！」"
-						goto *ai_calmMove_WEND1
+						goto *label_8981
 					}
 					if ( rnd(4) == 0 ) {
 						txt "「字ベロ♪指♪ラマ♪ｸﾏｰ!!して♪パンチラ♪」", "「アロー♪アーロン♪スゲェ♪ピカソ♪算段ビーフ♪」", "「キスすごい肉♪脱線してんの♪さらに肉♪」"
-						goto *ai_calmMove_WEND1
+						goto *label_8981
 					}
 					if ( rnd(4) == 0 ) {
 						txt "「キープダルシム♪アゴスタディーイェイ♪並フェイスで大きい筆入れ♪」", "「ハロー♪猿ー♪すげー♪うん入る♪」"
-						goto *ai_calmMove_WEND1
+						goto *label_8981
 					}
 					if ( rnd(4) == 0 ) {
 						txtef COLOR_BLUE
 						txt " *ﾋﾟﾛﾘ〜ﾋﾟﾛﾘ〜* "
-						goto *ai_calmMove_WEND1
+						goto *label_8981
 					}
 					txt "「マイアヒー♪」", "「マイアフゥー♪」", "「マイアホー♪」"
-					goto *ai_calmMove_WEND1
+					goto *label_8981
 				}
 				else {
 					if ( rnd(2) == 0 ) {
 						txt cnvtalk("Vrei sa pleci dar♪"), cnvtalk("Numa numa yay!!"), cnvtalk("Numa numa numa yay!!")
-						goto *ai_calmMove_WEND1
+						goto *label_8981
 					}
 					txt cnvtalk("Mai-Ya-Hi♪"), cnvtalk("Mai-Ya-Hoo♪"), cnvtalk("Mai-Ya-Ha Ma Mi A♪")
-					goto *ai_calmMove_WEND1
+					goto *label_8981
 				}
-				goto *label_8967
+				goto *label_8979
 			}
 		}
 	}
 
-*ai_calmMove_WEND1
+*label_8981
 	if ( cc > MAX_CHARA_FOLLOWER ) {
 		if ( cbit(CHARA_BIT_NECRO, cc) != TRUE ) {
 			if ( gdata(GDATA_AREA) != AREA_SEBI ) {
 				if ( mdata(MDATA_TYPE) == MAP_TYPE_TOWN | mdata(MDATA_TYPE) == MAP_TYPE_VILLAGE ) {
 					if ( gdata(GDATA_HOUR) >= 22 | gdata(GDATA_HOUR) < 7 ) {
@@ -1159,11 +1159,11 @@
 									flt
 									itemcreate -1, ITEM_ID_SNOW_MAN, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 0
 									if ( stat == 1 ) {
 										snd SOUNDLIST_SNOW
 										txt lang(name(cc) + "は" + itemname(ci) + "を作った！", name(cc) + " make" + _s(cc) + " " + itemname(ci) + "!")
-										goto *turn_end
+										goto *label_9247
 									}
 								}
 							}
 							if ( rnd(12) == 0 ) {
 								flt
@@ -1247,32 +1247,32 @@
 		if ( cdata(CDATA_AI_CALM, cc) != 11 ) {
 			if ( cdata(CDATA_AI_CALM, cc) == 6 ) {
 				if ( rnd(10) == 0 ) {
 					efid = SKILL_NORMAL_PERFORMER
 					gosub *effect
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 			if ( cdata(CDATA_AI_CALM, cc) == 7 ) {
 				if ( rnd(10) == 0 ) {
 					efid = SKILL_SPACT_PREACHING
 					gosub *effect
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 			if ( cdata(CDATA_AI_CALM, cc) == 12 ) {
 				if ( rnd(10) == 0 ) {
 					efid = SKILL_SPACT_SERIOUS_BEGGING
 					gosub *effect
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 			if ( cdata(CDATA_AI_CALM, cc) == 8 ) {
 				if ( rnd(10) == 0 ) {
 					efid = SKILL_SPACT_FASCINATION_DANCE
 					gosub *effect
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 			if ( cdata(CDATA_AI_CALM, cc) == 9 ) {
 				tc = cc
 				repeat 245
@@ -1355,12 +1355,12 @@
 				distance = dist(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), cdata(CDATA_X, cc), cdata(CDATA_Y, cc))
 				if ( tc != CHARA_PLAYER ) {
 					if ( distance == 1 ) {
 						if ( cdata(CDATA_ROW_ACT, tc) == ACTION_NONE ) {
 							cdata(CDATA_TARGET, cc) = 0
-							gosub *sexsex
-							goto *turn_end
+							gosub *label_6019
+							goto *label_9247
 						}
 					}
 					if ( distance < 6 ) {
 						goto *ai_followMove
 					}
@@ -1394,11 +1394,11 @@
 		cell_check cdata(CDATA_X_NEW, cc), cdata(CDATA_Y_NEW, cc)
 		if ( cellaccess == 1 ) {
 			goto *act_move
 		}
 	}
-	goto *turn_end
+	goto *label_9247
 
 *ai_followMove
 	if ( mdata(MDATA_TYPE) == MAP_TYPE_TOWN ) {
 		if ( cc < MAX_CHARA_FOLLOWER ) {
 			if ( rnd(10) == 0 ) {
@@ -1517,11 +1517,11 @@
 			}
 		}
 	}
 	if ( tc == cc ) {
 		cdata(CDATA_TARGET, cc) = 0
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( cdata(CDATA_MOVE_AROUND, cc) <= 0 ) {
 		cdata(CDATA_X_DEST, cc) = cdata(CDATA_X, tc)
 		cdata(CDATA_Y_DEST, cc) = cdata(CDATA_Y, tc)
 		if ( retreat | cdata(CDATA_AI_DISTANCE, cc) > distance ) {
@@ -1592,11 +1592,11 @@
 				if ( cdata(CDATA_IN_TAGTEAM, cc) != 0 ) {
 					skillexp SKILL_ACTIVE_RIDING, cdata(CDATA_TAGTEAM_PARTNER, cc), 30
 				}
 			}
 			ride = 0
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	ride = 0
 	if ( cellchara != (-1) ) {
 		tc = cellchara
@@ -1679,11 +1679,11 @@
 								}
 								rowactend ttc
 							}
 						}
 					}
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 		}
 	}
 	if ( cc > MAX_CHARA_FOLLOWER & cdata(CDATA_QUALITY, cc) > FIX_QUALITY_GREAT & cdata(CDATA_RELATION, cc) <= RELATION_HATE | findbuff(cc, BUFF_HYPER_DASH) != (-1) | (cdata(CDATA_ID, cc) == CREATURE_ID_MEGA_MOLE | cdata(CDATA_ID, cc) == CREATURE_ID_TALPIDAE | cdata(CDATA_ID, cc) == CREATURE_ID_AILE_THE_ATTENDANT & cc > MAX_CHARA_FOLLOWER) ) {
@@ -1770,11 +1770,11 @@
 		if ( dir == 0 ) {
 			cdata(CDATA_Y_DEST, cc) = cdata(CDATA_Y, cc) + 6
 			cdata(CDATA_X_DEST, cc) = cdata(CDATA_X, tc)
 		}
 	}
-	goto *turn_end
+	goto *label_9247
 
 *ai_moveH
 	if ( cdata(CDATA_X_DEST, cc) > cdata(CDATA_X, cc) ) {
 		if ( cdata(CDATA_Y_DEST, cc) > cdata(CDATA_Y, cc) ) {
 			p = 1
@@ -1851,24 +1851,56 @@
 		if ( rnd(100) == 0 ) {
 			txtef COLOR_RED
 			txt lang(" *BAN* ", " *BAN* ")
 			cdata(CDATA_HP, cc) = 0
 			dmghp cc, 99999, DAMAGE_FROM_UNSEEN
-			goto *turn_end
+			goto *label_9247
+		}
+	}
+	if ( cbit(1034, cc) == TRUE ) {
+		if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-5) ) {
+			if ( rnd(100) < 20 ) {
+				txt lang(cdatan(CDATAN_NAME, cc) + "は元気にはしゃいでいる！", cdatan(CDATAN_NAME, cc) + " is rolling fine!")
+				goto *label_9247
+			}
+		}
+		if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-4) ) {
+			if ( rnd(100) < 15 ) {
+				txt lang(cdatan(CDATAN_NAME, cc) + "は飛び跳ねて遊んでいる！", cdatan(CDATAN_NAME, cc) + " is hopping and playing!")
+				goto *label_9247
+			}
+		}
+		if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-3) ) {
+			if ( rnd(100) < 10 ) {
+				txt lang(cdatan(CDATAN_NAME, cc) + "は興味津々によそ見をしている！", cdatan(CDATAN_NAME, cc) + " is looking away with interest!")
+				goto *label_9247
+			}
+		}
+		if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-2) ) {
+			if ( rnd(100) < 5 ) {
+				txt lang(cdatan(CDATAN_NAME, cc) + "は真剣な顔で考え事をしている！", cdatan(CDATAN_NAME, cc) + " is thinking with a serious face!")
+				goto *label_9247
+			}
+		}
+		if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-1) ) {
+			if ( limit(cdata(CDATA_MASTER_SERVANT, cc), 1, 150) / 10 + 80 <= rnd(100) ) {
+				txt lang(cdatan(CDATAN_NAME, cc) + "は自分の在り方について悩んでいる！", cdatan(CDATAN_NAME, cc) + " has doubts about how lives!")
+				goto *label_9247
+			}
 		}
 	}
 	if ( cdata(CDATA_TARGET, cc) != 0 ) {
 		if ( cdata(CDATA_NECRO_FORCE, cc) == 10 ) {
 			efid = SKILL_SPACT_CLOSE_SUICIDE
 			gosub *action
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE ) {
 		if ( cdata(CDATA_TARGET, cc) != 0 | cdata(CDATA_TARGET, cc) == 0 ) {
 			if ( cdata(CDATA_POWER_GAUGE, cc) < 2 | cdata(CDATA_POWER_GAUGE, tc) < 2 ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	act = cdata(STARTING_CDATA_ACT_MAIN + rnd(cdata(CDATA_ACT_INDEX, cc) \ 10), cc)
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_DREAD_RABBIT ) {
@@ -1964,11 +1996,11 @@
 			hikae = cdata(CDATA_PIC, cc)
 			cdata(CDATA_PIC, cc) = cdata(CDATA_FORM_SHIFT_PIC, cc)
 			cdata(CDATA_FORM_SHIFT_PIC, cc) = hikae
 			create_pcpic cc, 0
 			customtalk cc, DBMODE_FLAVOR_SHIFT
-			gosub *convert_word
+			gosub *label_0416
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( jp ) {
 					txt "「変身！」", "「フォームアップ！」", "「ドレスアップ！」", "「トランスフォーム！」"
 				}
 				if ( en ) {
@@ -2860,11 +2892,11 @@
 									itemcreate cc, isetthrowpotiongreater(rnd(length(isetthrowpotiongreater))), -1, -1, 0
 								}
 								if ( stat == 1 ) {
 									goto *act_throw
 								}
-								goto *turn_end
+								goto *label_9247
 							}
 						}
 					}
 				}
 			}
@@ -3516,11 +3548,11 @@
 								itemcreate cc, ITEM_ID_POTION_SALT_SOLUTION, -1, -1, 0
 							}
 							if ( stat == 1 ) {
 								goto *act_throw
 							}
-							goto *turn_end
+							goto *label_9247
 						}
 					}
 				}
 			}
 		}
@@ -3754,11 +3786,11 @@
 				}
 				if ( act == SKILL_SPACT_MYSTERIOUS_SONG ) {
 					efid = SKILL_SPACT_MYSTERIOUS_SONG
 					gosub *effect
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE ) {
 		if ( powai == 100 ) {
@@ -3769,11 +3801,11 @@
 			}
 		}
 	}
 	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE ) {
 		if ( act != SKILL_SPACT_DISTURBANCE ) {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_USER ) {
 		if ( act == SKILL_SPELL_WISH | act == SKILL_SPELL_WIZARDS_HARVEST | act == SKILL_SPACT_MEWMEWMEW | act == SKILL_SPACT_MANIS_DISASSEMBLY | act == SKILL_SPACT_INSANE_WAVE | act == SKILL_SPACT_SUPER_VIBRATING_FIST | act == SKILL_SPACT_TEMPEST_ARROW | act == SKILL_SPACT_EXCESSIVE_HEAL | act == SKILL_SPACT_SHINE_SNAIL | act == SKILL_SPACT_SMOKE_MIRROR | act == SKILL_SPACT_ELEMENTIA | act == SKILL_SPACT_GOLD_RUSH | (act >= SKILL_SPACT_CONVERGE_BREATH & act <= SKILL_SPACT_MANA_SLASH) | act == SKILL_SPACT_SPINNING_THROW ) {
 			act = ACTION_RANGE
@@ -3785,56 +3817,56 @@
 		cell_check cdata(CDATA_X_NEW, cc), cdata(CDATA_Y_NEW, cc)
 		if ( cellaccess == 1 ) {
 			goto *act_move
 		}
 		else {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( act >= SKILL_SPELL_HEAL_LIGHT ) {
 		if ( act < MAX_SPELL ) {
 			if ( cdata(CDATA_SEALED_MAGIC, cc) == 0 ) {
 				efid = act
 				if ( cdata(CDATA_MP, cc) < cdata(CDATA_MAX_MP, cc) / 7 ) {
 					if ( rnd(3) | cc < MAX_CHARA_FOLLOWER | cdata(CDATA_QUALITY, cc) >= FIX_QUALITY_MIRACLE | cbit(CHARA_BIT_AI_SAVE_MANA, cc) ) {
 						cdata(CDATA_MP, cc) += cdata(CDATA_LEVEL, cc) / 4 + 5
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 				npccostmp = 1
 				gosub *cast
 				if ( stat == 1 ) {
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 		}
 	}
 	if ( act >= (600 /*!!!@[MAX_SKILL_RANGE @@@ STARTING_SKILL_SPACT]@!!! */) ) {
 		if ( act == SKILL_SPACT_DISTURBANCE | cdata(CDATA_SEALED_ABILITY, cc) == 0 ) {
 			efid = act
 			gosub *action
 			if ( stat == 1 ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( act == ACTION_WAIT_MELEE ) {
 		if ( distance == 1 ) {
-			gosub *act_melee
+			gosub *label_6394
 		}
 		if ( rnd(3) == 0 | cc < MAX_CHARA_FOLLOWER | cdata(CDATA_ALLIED, cc) == 100 ) {
 			if ( distance < 6 ) {
 				if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) ) {
 					gosub *FindRangeWeapon
 					if ( stat == 1 ) {
 						gosub *act_fire
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 			}
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( cbit(CHARA_BIT_AWAKE_PROXIMITY_ATTACK, cc) ) {
 		act = ACTION_MELEE
 	}
 	if ( cbit(CHARA_BIT_AWAKE_RANGED_ATTACK, cc) ) {
@@ -3852,29 +3884,29 @@
 			if ( distance < 6 ) {
 				if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) ) {
 					gosub *FindRangeWeapon
 					if ( stat == 1 ) {
 						gosub *act_fire
-						goto *turn_end
+						goto *label_9247
 					}
 				}
 			}
 		}
 	}
 	if ( cdata(CDATA_DIRECTIVE_MODE, cc) != DIRECTIVE_MODE_DEFENSIVE & cdata(CDATA_DIRECTIVE_MODE, cc) != DIRECTIVE_MODE_TALKING ) {
 		if ( distance == 1 ) {
-			gosub *act_melee
-			goto *turn_end
+			gosub *label_6394
+			goto *label_9247
 		}
 	}
 	if ( cdata(CDATA_DIRECTIVE_MODE, cc) != DIRECTIVE_MODE_DEFENSIVE & cdata(CDATA_DIRECTIVE_MODE, cc) != DIRECTIVE_MODE_TALKING ) {
 		if ( distance < 6 ) {
 			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) ) {
 				gosub *FindRangeWeapon
 				if ( stat == 1 ) {
 					gosub *act_fire
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 		}
 	}
 	if ( cdata(CDATA_AI_DISTANCE, cc) <= distance ) {
@@ -3888,20 +3920,20 @@
 				else {
 					if ( cdata(CDATA_POWER_GAUGE, cc) <= 170 ) {
 						cdata(CDATA_POWER_GAUGE, cc) += 16
 					}
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	if ( rnd(5) == 0 ) {
 		cdata(CDATA_AI_AGGRO, cc)--
 	}
 	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE ) {
 		if ( cdata(CDATA_TARGET, cc) != 0 | cdata(CDATA_TARGET, cc) == 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( rnd(100) < cdata(CDATA_AI_MOVE_FREQ, cc) ) {
 		goto *ai_followMove
 	}
@@ -3914,11 +3946,11 @@
 		else {
 			if ( cdata(CDATA_POWER_GAUGE, cc) <= 180 ) {
 				cdata(CDATA_POWER_GAUGE, cc) += 16
 			}
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/blend.hsp ../2.14-borscht/blend.hsp
--- ../2.13-borscht/blend.hsp	2022-06-26 12:14:11.478430400 -0700
+++ ../2.14-borscht/blend.hsp	2022-09-18 12:36:58.522934000 -0700
@@ -589,17 +589,17 @@
 	return
 	getinheritance window_recipe_itemid, locvar_window_recipe_inhlist, locvar_window_recipe_p
 	if ( locvar_window_recipe_p > 0 ) {
 		repeat locvar_window_recipe_p
 			locvar_window_recipe_cnt2 = locvar_window_recipe_inhlist(cnt)
-			if ( inv(40 + locvar_window_recipe_cnt2 * 2, window_recipe_itemid) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + locvar_window_recipe_cnt2 * 2, window_recipe_itemid) == 0 ) {
 				break
 			}
-			val = inv(40 + locvar_window_recipe_cnt2 * 2, window_recipe_itemid), inv(40 + locvar_window_recipe_cnt2 * 2 + 1, window_recipe_itemid), 0, refitem(inv(INV_ITEM_ID, window_recipe_itemid), DBSPEC_TYPE)
+			val = inv(STARTING_INV_ITEM_ENCHANT + locvar_window_recipe_cnt2 * 2, window_recipe_itemid), inv(STARTING_INV_ITEM_ENCHANT + locvar_window_recipe_cnt2 * 2 + 1, window_recipe_itemid), 0, refitem(inv(INV_ITEM_ID, window_recipe_itemid), DBSPEC_TYPE)
 			gosub *item_encdetail
 			color 0, 0, 100
-			if ( inv(40 + locvar_window_recipe_cnt2 * 2 + 1, window_recipe_itemid) < 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + locvar_window_recipe_cnt2 * 2 + 1, window_recipe_itemid) < 0 ) {
 				color 180, 0, 0
 			}
 			pos locvar_window_recipe_dx, locvar_window_recipe_dy
 			mes cnven(s)
 			locvar_window_recipe_dy += 16
@@ -777,11 +777,11 @@
 	rpdata(RPDATA_SKILL + 0 * 2, rpid) = SKILL_NORMAL_GARDENING, 20
 	rpdata(RPDATA_MAT + 0, rpid) = FILTER_ITEM_FOOD, FILTER_ITEM_FOOD, RF_SEED, RF_SEED
 	rpid = STARTING_RPID + 23
 	rplistdef(length(rplistdef)) = 1 * EXT_RECIPES + rpid
 	rpdatan(rpid) = lang("ハーブ調合", "herb infusion")
-	rpdata(RPDATA_ITEM, rpid) = (10000 /*!!!@[RECIPE_BLEND_ACTION_HERBED_FOOD @@@ STARTING_RECIPE_BLEND_ACTION]@!!! */), 60, 1
+	rpdata(RPDATA_ITEM, rpid) = RECIPE_BLEND_ACTION_HERBED_FOOD, 60, 1
 	rpdata(RPDATA_SKILL + 0 * 2, rpid) = SKILL_NORMAL_GARDENING, 20, SKILL_NORMAL_COOKING, 30
 	rpdata(RPDATA_MAT + 0, rpid) = FILTER_ITEM_FOOD, ITEM_ID_STOMAFILLIA, ITEM_ID_CURARIA, RF_HERB
 	rpid = STARTING_RPID + 24
 	rplistdef(length(rplistdef)) = 1 * EXT_RECIPES + rpid
 	rpdatan(rpid) = lang("進化の側枝", "another evolution")
@@ -1149,11 +1149,11 @@
 			if ( rtval == 0 ) {
 				rpref(1) = val
 				rpref(2) = rpdata(RPDATA_TIME, rpid)
 				rpref(3) = rpdiff(rpid, step, -1)
 				gosub *blend
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( rtval == 2 ) {
 				step = -1
 				goto *com_blend_step
 			}
@@ -1619,11 +1619,11 @@
 				}
 			}
 		}
 		cell_refresh inv(INV_ITEM_X, rpref(10 + cnt * 2)), inv(INV_ITEM_Y, rpref(10 + cnt * 2))
 	loop
-	gosub *calcBurdenPc
+	gosub *label_4102
 	return 1
 
 *blend_complete
 	rpresult = 1
 	if ( rpdiff(rpid, -1, -1) < rnd(100) ) {
@@ -1634,11 +1634,11 @@
 	else {
 		if ( rpdata(RPDATA_ITEM, rpid) == RECIPE_BLEND_ACTION_WOODCRAFT | rpdata(RPDATA_ITEM, rpid) == RECIPE_BLEND_ACTION_STONECRAFT | rpdata(RPDATA_ITEM, rpid) == RECIPE_BLEND_ACTION_POTTERY ) {
 			ti = rpref(10 + 0 * 2)
 			inv(INV_ITEM_NUM, ti)++
 		}
-		if ( rpdata(RPDATA_ITEM, rpid) >= (10000 /*!!!@[RECIPE_BLEND_ACTION_HERBED_FOOD @@@ STARTING_RECIPE_BLEND_ACTION]@!!! */) ) {
+		if ( rpdata(RPDATA_ITEM, rpid) >= RECIPE_BLEND_ACTION_HERBED_FOOD ) {
 			gosub *blend_act
 		}
 		if ( rpdata(RPDATA_ITEM, rpid) == ITEM_ID_RICE_BALL ) {
 			picp = inv(INV_ITEM_LEVEL, rpref(10 + 0 * 2))
 			flt
@@ -2087,11 +2087,11 @@
 			nostack = 1
 			itemcreate -1, rpdata(RPDATA_ITEM, rpid), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 			item_identify ci, ITEM_KNOWN_FULL
 		}
-		if ( rpdata(RPDATA_ITEM, rpid) < (10000 /*!!!@[RECIPE_BLEND_ACTION_HERBED_FOOD @@@ STARTING_RECIPE_BLEND_ACTION]@!!! */) ) {
+		if ( rpdata(RPDATA_ITEM, rpid) < RECIPE_BLEND_ACTION_HERBED_FOOD ) {
 			txtef COLOR_GREEN
 			txt lang(itemname(ci, 1) + "の作成に成功した！", "You successfully create " + itemname(ci, 1) + "!")
 		}
 		snd SOUNDLIST_DRINK1
 	}
@@ -2130,11 +2130,11 @@
 	if ( rpref(2) >= 10000 ) {
 		cdata(CDATA_ACTION_PERIOD, cc) = rpref(2) / 10000
 		repeat
 			mode = MODELIST_RP
 			gdata(GDATA_HOUR)++
-			gosub *advance_hour
+			gosub *label_9228
 			redraw 0
 			gosub *screen_drawStatus
 			if ( cnt \ 5 == 0 ) {
 				txtef COLOR_BLUE
 				txt lang(" *こねこね* ", "*pug*"), lang(" *トントン* ", "*clank*")
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/calculation.hsp ../2.14-borscht/calculation.hsp
--- ../2.13-borscht/calculation.hsp	2022-06-26 12:14:11.505455200 -0700
+++ ../2.14-borscht/calculation.hsp	2022-09-18 12:36:58.550960000 -0700
@@ -533,20 +533,20 @@
 		}
 		if ( adata(ADATA_ID, cnt) == AREA_STORAGE_HOUSE ) {
 			locvar_calccosthire_cost += 750
 		}
 	loop
-	if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 1 ) {
+	if ( gdata(250 + 442) == 1 ) {
 		locvar_calccosthire_cost += 500
 	}
-	if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 2 ) {
+	if ( gdata(250 + 442) == 2 ) {
 		locvar_calccosthire_cost += 2000
 	}
-	if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 3 ) {
+	if ( gdata(250 + 442) == 3 ) {
 		locvar_calccosthire_cost += 10000
 	}
-	if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 4 ) {
+	if ( gdata(250 + 442) == 4 ) {
 		locvar_calccosthire_cost += 200000
 	}
 	if ( locvar_calccostbuilding_hantei == 0 ) {
 		gdata(GDATA_RANK_MUSEUM) = 10000
 	}
@@ -586,22 +586,22 @@
 		if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) != FILTER_AMMO ) {
 			continue
 		}
 		locvar_calccostreload_ci = cnt
 		repeat 15
-			if ( inv(40 + cnt * 2, locvar_calccostreload_ci) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, locvar_calccostreload_ci) == 0 ) {
 				break
 			}
-			locvar_calccostreload_enc = inv(40 + cnt * 2, locvar_calccostreload_ci)
+			locvar_calccostreload_enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, locvar_calccostreload_ci)
 			locvar_calccostreload_i = locvar_calccostreload_enc / 10000
 			if ( locvar_calccostreload_i != 0 ) {
 				locvar_calccostreload_enc = locvar_calccostreload_enc \ 10000
 				if ( locvar_calccostreload_i == 9 ) {
-					locvar_calccostreload_i = inv(40 + cnt * 2 + 1, locvar_calccostreload_ci) \ 1000, inv(40 + cnt * 2 + 1, locvar_calccostreload_ci) / 1000
+					locvar_calccostreload_i = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_calccostreload_ci) \ 1000, inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_calccostreload_ci) / 1000
 					locvar_calccosthire_cost += (locvar_calccostreload_i(1) - locvar_calccostreload_i) * (50 + locvar_calccostreload_enc * locvar_calccostreload_enc * 10)
 					if ( calccostreload_arg2 == 1 ) {
-						inv(40 + cnt * 2 + 1, locvar_calccostreload_ci) = locvar_calccostreload_i(1) * 1000 + locvar_calccostreload_i(1)
+						inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_calccostreload_ci) = locvar_calccostreload_i(1) * 1000 + locvar_calccostreload_i(1)
 					}
 				}
 			}
 		loop
 	loop
@@ -621,22 +621,22 @@
 			if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) != FILTER_AMMO ) {
 				continue
 			}
 			locvar_calccostreload_ci = cnt
 			repeat 15
-				if ( inv(40 + cnt * 2, locvar_calccostreload_ci) == 0 ) {
+				if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, locvar_calccostreload_ci) == 0 ) {
 					break
 				}
-				locvar_calccostreload_enc = inv(40 + cnt * 2, locvar_calccostreload_ci)
+				locvar_calccostreload_enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, locvar_calccostreload_ci)
 				locvar_calccostreload_i = locvar_calccostreload_enc / 10000
 				if ( locvar_calccostreload_i != 0 ) {
 					locvar_calccostreload_enc = locvar_calccostreload_enc \ 10000
 					if ( locvar_calccostreload_i == 9 ) {
-						locvar_calccostreload_i = inv(40 + cnt * 2 + 1, locvar_calccostreload_ci) \ 1000, inv(40 + cnt * 2 + 1, locvar_calccostreload_ci) / 1000
+						locvar_calccostreload_i = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_calccostreload_ci) \ 1000, inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_calccostreload_ci) / 1000
 						locvar_calccosthire_cost += (locvar_calccostreload_i(1) - locvar_calccostreload_i) * (50 + locvar_calccostreload_enc * locvar_calccostreload_enc * 10)
 						if ( calccostreload_arg2 == 1 ) {
-							inv(40 + cnt * 2 + 1, locvar_calccostreload_ci) = locvar_calccostreload_i(1) * 1000 + locvar_calccostreload_i(1)
+							inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_calccostreload_ci) = locvar_calccostreload_i(1) * 1000 + locvar_calccostreload_i(1)
 						}
 					}
 				}
 			loop
 		loop
@@ -994,10 +994,14 @@
 				p = sdata(cnt, r1)
 			}
 		}
 		sdata(cnt + STARTING_SKILL_SPACT, r1) = limit(p, 1, 800) * 1000000
 	loop
+	if ( babymake == 1 ) {
+		sdata(bsid + STARTING_SKILL_SPACT, r1) += 400 * 1000000
+		sdata(bsids + STARTING_SKILL_SPACT, r1) += 400 * 1000000
+	}
 	i = 4
 	skillinit SKILL_WEAPON_LONGSWORD, r1, i
 	skillinit SKILL_WEAPON_SHORTSWORD, r1, i
 	skillinit SKILL_WEAPON_BLUNT, r1, i
 	skillinit SKILL_WEAPON_AXE, r1, i
@@ -1380,11 +1384,11 @@
 	}
 	spact(SKILL_SPACT_DRAIN_BLOOD - STARTING_SKILL_SPACT) = 1
 	spact(SKILL_SPACT_FIRE_BREATH - STARTING_SKILL_SPACT) = 1
 	spact(SKILL_SPACT_TOUCH_OF_WEAKNESS - STARTING_SKILL_SPACT) = 1
 	spact(SKILL_SPACT_PSYCHOANALYSIS - STARTING_SKILL_SPACT) = 1
-	repeat 843 - 600
+	repeat 846 - 600
 		spact(cnt + STARTING_SKILL_SPACT - STARTING_SKILL_SPACT) = 1
 	loop
 	skillinit SKILL_NORMAL_CASTING, r1, 6
 	skillinit SKILL_NORMAL_SHIELD, r1, 2
 	skillinit SKILL_WEAPON_FIREARM, r1, 2
@@ -1526,18 +1530,18 @@
 	tc = cc
 	efid = SKILL_SPELL_TELEPORT
 	gosub *effect
 	return 0
 
-*calcSearch
+*label_4091
 	if ( rnd(sdata(SKILL_NORMAL_DETECTION, cc) * 15 + 20 + sdata(SKILL_ATTR_PER, cc)) > rnd(gdata(GDATA_LEVEL) * 8 + 60) ) {
-		gosub *expDetection
+		gosub *label_3996
 		return 1
 	}
 	return 0
 
-*calcTrap
+*label_4092
 	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_TRAP_QUEST_MINE ) {
 		return 0
 	}
 	if ( cdata(CDATA_CONDITION_GRAVITY, cc) > 0 ) {
 		return 0
@@ -1566,11 +1570,11 @@
 		gosub *expDisarm
 		return 1
 	}
 	return 0
 
-*calcStealth
+*label_4095
 	if ( cdata(CDATA_CONDITION_SEPPUKU, r2) > 0 ) {
 		return 0
 	}
 	if ( map(cdata(CDATA_X, r2), cdata(CDATA_Y, r2), MAP_ITEM_CHIPS_MEMORY) != 0 ) {
 		if ( mapitemfind(cdata(CDATA_X, r2), cdata(CDATA_Y, r2), ITEM_ID_LULWYS_PHOTO_COLLECTION) != (-1) ) {
@@ -1659,10 +1663,13 @@
 		}
 		p = cdata(CDATA_HUNGER, r1) / 1000
 		if ( gdata(GDATA_FLAG_MAIN) != 900 ) {
 			cdata(CDATA_HUNGER, r1) -= haraheri
 		}
+		if ( cdata(CDATA_SP_EARNED, r1) <= (-2000000) ) {
+			cdata(CDATA_HUNGER, r1) -= haraheri
+		}
 		if ( findbuff(r1, BUFF_CURSE_OF_HUNGER) != (-1) ) {
 			cdata(CDATA_HUNGER, r1) -= haraheri / 2
 		}
 		if ( trait(TRAIT_RACE_SLOW_DIGESTION) ) {
 			if ( cdata(CDATA_HUNGER, r1) <= 5000 ) {
@@ -2294,11 +2301,11 @@
 	}
 	if ( r1 != 0 ) {
 		return
 	}
 
-*calcBurdenPc
+*label_4102
 	if ( findbuff(CHARA_PLAYER, BUFF_GRAVITY_ACCEL) != (-1) ) {
 		cdata(CDATA_INV_WEIGHT, CHARA_PLAYER) = limit(inv_weight(CHARA_PLAYER), 0, 20000000) * (10 + trait(TRAIT_ETHER_EQUIP_BACK) * 2) / 10
 	}
 	else {
 		cdata(CDATA_INV_WEIGHT, CHARA_PLAYER) = limit(inv_weight(CHARA_PLAYER), 0, 20000000) * (10 - trait(TRAIT_ETHER_WEIGHT) + trait(TRAIT_ETHER_EQUIP_BACK) * 2) / 10
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/chara.hsp ../2.14-borscht/chara.hsp
--- ../2.13-borscht/chara.hsp	2022-06-26 12:14:11.551497600 -0700
+++ ../2.14-borscht/chara.hsp	2022-09-18 12:36:58.600005300 -0700
@@ -533,10 +533,34 @@
 			txtmore
 			txtef COLOR_YELLOW
 			txt lang("あなたは「" + skillname(SKILL_SPACT_ABYSS_IN_THE_EYE) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_ABYSS_IN_THE_EYE) + ".")
 		}
 	}
+	if ( sorg(SKILL_NORMAL_GENE_ENGINEER, CHARA_PLAYER) > 9 & sorg(SKILL_ATTR_DEX, CHARA_PLAYER) > 29 ) {
+		if ( spact(MAX_SKILL - STARTING_SKILL_SPACT) == 0 ) {
+			spact(MAX_SKILL - STARTING_SKILL_SPACT) = 1
+			txtmore
+			txtef COLOR_YELLOW
+			txt lang("あなたは「" + skillname(MAX_SKILL) + "」の能力を得た。", "You have learned new ability, " + skillname(MAX_SKILL) + ".")
+		}
+	}
+	if ( sorg(SKILL_NORMAL_GENE_ENGINEER, CHARA_PLAYER) > 24 & sorg(SKILL_ATTR_MAG, CHARA_PLAYER) > 49 ) {
+		if ( spact(844 - STARTING_SKILL_SPACT) == 0 ) {
+			spact(844 - STARTING_SKILL_SPACT) = 1
+			txtmore
+			txtef COLOR_YELLOW
+			txt lang("あなたは「" + skillname(844) + "」の能力を得た。", "You have learned new ability, " + skillname(844) + ".")
+		}
+	}
+	if ( sorg(SKILL_NORMAL_GENE_ENGINEER, CHARA_PLAYER) > 44 & sorg(SKILL_NORMAL_TAILORING, CHARA_PLAYER) > 44 ) {
+		if ( spact(845 - STARTING_SKILL_SPACT) == 0 ) {
+			spact(845 - STARTING_SKILL_SPACT) = 1
+			txtmore
+			txtef COLOR_YELLOW
+			txt lang("あなたは「" + skillname(845) + "」の能力を得た。", "You have learned new ability, " + skillname(845) + ".")
+		}
+	}
 	if ( sorg(SKILL_NORMAL_GENE_ENGINEER, CHARA_PLAYER) > 19 & trait(TRAIT_NORMAL_SPACT_TOUCH_OF_POISON) != 0 ) {
 		if ( spact(SKILL_SPACT_HAZARD_RECIPE - STARTING_SKILL_SPACT) == 0 ) {
 			spact(SKILL_SPACT_HAZARD_RECIPE - STARTING_SKILL_SPACT) = 1
 			txtmore
 			txtef COLOR_YELLOW
@@ -803,11 +827,11 @@
 	}
 	if ( rnd(3) == 0 ) {
 		return 10008
 	}
 	return 10005
-	goto *chara_initEquip
+	goto *label_4114
 
 #deffunc eqrandweaponmage int eqrandweaponmage_arg1
 	locvar_eqrandweaponmage_p = rnd(2)
 	if ( locvar_eqrandweaponmage_p == 0 ) {
 		eqweapon1 = 10003, eqrandweaponmage_arg1
@@ -815,11 +839,11 @@
 	if ( locvar_eqrandweaponmage_p == 1 ) {
 		eqweapon1 = 10006, eqrandweaponmage_arg1
 	}
 	return
 
-*chara_initEquip
+*label_4114
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_HYPER_YACATECT | cdata(CDATA_ID, rc) == CREATURE_ID_YACATECT ) {
 		p = cdata(CDATA_LEVEL, rc) * 25 + rnd(cdata(CDATA_LEVEL, rc) * 25 + 1)
 		if ( cdata(CDATA_GOLD, rc) < p / 2 ) {
 			cdata(CDATA_GOLD, rc) = p
 		}
@@ -1240,11 +1264,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqamulet1 = 0
 				continue
 			}
 			if ( eqamulet2 ) {
 				if ( eqamulet2 >= 10000 ) {
@@ -1262,11 +1286,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqamulet2 = 0
 				continue
 			}
 		}
 		if ( p == 6 ) {
@@ -1286,11 +1310,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqring1 = 0
 				continue
 			}
 			if ( eqring2 ) {
 				if ( eqring2 >= 10000 ) {
@@ -1308,11 +1332,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqring2 = 0
 				continue
 			}
 		}
 		if ( p == 3 ) {
@@ -1332,11 +1356,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqcloack = 0
 				continue
 			}
 			continue
 		}
@@ -1357,11 +1381,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqgirdle = 0
 				continue
 			}
 			continue
 		}
@@ -1382,11 +1406,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqhelm = 0
 				continue
 			}
 			continue
 		}
@@ -1407,11 +1431,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqarmor = 0
 				continue
 			}
 			continue
 		}
@@ -1432,11 +1456,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqglove = 0
 				continue
 			}
 			continue
 		}
@@ -1457,11 +1481,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqboots = 0
 				continue
 			}
 			continue
 		}
@@ -1485,11 +1509,11 @@
 					}
 					break
 				loop
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqweapon1 = 0
 				continue
 			}
 			if ( eqweapon1 ) {
 				if ( eqweapon1 >= 10000 ) {
@@ -1536,11 +1560,11 @@
 						}
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqweapon1 = 0
 				continue
 			}
 			if ( eqweapon2 ) {
 				if ( eqweapon2 >= 10000 ) {
@@ -1580,11 +1604,11 @@
 					}
 				}
 				eqweapon2 = 0
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				continue
 			}
 			if ( eqshield ) {
 				if ( eqshield >= 10000 ) {
 					flt calcobjlv(cdata(CDATA_LEVEL, rc)), calcfixlv(fixeq + eqshield(1))
@@ -1601,11 +1625,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqshield = 0
 				continue
 			}
 			continue
 		}
@@ -1626,11 +1650,11 @@
 						inv(INV_ITEM_LEVEL, ci) = limit(cdata(CDATA_LEVEL, rc) / 30, 0, 10)
 					}
 				}
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqrange = 0
 				continue
 			}
 			continue
 		}
@@ -1646,11 +1670,11 @@
 					dbid = eqammo
 				}
 				itemcreate rc, dbid, -1, -1, 0
 				r1 = rc
 				body = cnt
-				gosub *act_equip
+				gosub *label_6352
 				eqammo = 0
 				continue
 			}
 			continue
 		}
@@ -1742,11 +1766,11 @@
 	p++
 	cdata(p, rc) = 11 * 10000
 	p++
 	return
 
-*place_chara
+*label_4125
 	if ( rc == (-1) ) {
 		return
 	}
 	if ( rc == MAX_CHARA_NC ) {
 		cdata(CDATA_EXIST, rc) = CHAR_STATE_DEAD
@@ -2184,11 +2208,11 @@
 				cbitmod CHARA_BIT_AWAKE_MP_BARRIER, rc, TRUE
 			}
 		}
 	}
 	if ( dbid == 343 ) {
-		gosub *set_userNpc
+		gosub *label_5841
 	}
 	else {
 		dbmode = DBMODE_SET
 		gosub *db_creature
 	}
@@ -2200,31 +2224,31 @@
 		if ( cdata(CDATA_PIC, rc) - refchara(cdata(CDATA_ID, rc), DBSPEC_CHARA_COL) * 1000 >= 1000 ) {
 			cdata(CDATA_CHARA_PIC, rc) = xy2pic(1, 0)
 		}
 	}
 	cdata(CDATA_QUALITY, rc) = fixlv
-	gosub *cm_finish
+	gosub *label_4132
 	rtval = rc
 	return 1
 
-*chara_fix
+*label_4131
 	if ( fixlv == FIX_QUALITY_MIRACLE ) {
 		cdatan(CDATAN_NAME, rc) = strbracketleft + cdatan(CDATAN_NAME, rc) + strbracketright
 		cdata(CDATA_LEVEL, rc) = cdata(CDATA_LEVEL, rc) * 10 / 8
 	}
 	if ( fixlv == FIX_QUALITY_GODLY ) {
 		cdatan(CDATAN_NAME, rc) = lang("《", "{") + cdatan(CDATAN_NAME, rc) + lang("》", "}")
 		cdata(CDATA_LEVEL, rc) = cdata(CDATA_LEVEL, rc) * 10 / 6
 	}
 	return
 
-*cm_finish
+*label_4132
 	if ( gdata(GDATA_AREA) != AREA_CHAOS_CRADLE | gdata(GDATA_LEVEL) != 179 ) {
 		cdata(CDATA_LEVEL, rc) = limit(cdata(CDATA_LEVEL, rc), 1, 6666)
 	}
 	if ( mode != MODELIST_CHARA_CREATION ) {
-		gosub *chara_fix
+		gosub *label_4131
 	}
 	cdata(CDATA_EXIST, rc) = CHAR_STATE_ALIVE
 	cdata(CDATA_INTEREST, rc) = 100
 	cdata(CDATA_IMPRESSION, rc) = 50
 	cdata(CDATA_MASTER_SERVANT, rc) = 50
@@ -2368,10 +2392,14 @@
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_SMALL_STONE_GOLEM | cdata(CDATA_ID, rc) == CREATURE_ID_SMALL_WOODEN_GOLEM | cdata(CDATA_ID, rc) == CREATURE_ID_SILVER_SKULL_MAJESTY ) {
 		cdata(CDATA_HEIGHT, rc) = rnd(60) + 140
 		cdata(CDATA_WEIGHT, rc) = rnd(100) + 200
 	}
+	if ( babymake == 1 ) {
+		cdata(CDATA_HEIGHT, rc) /= 5
+		cdata(CDATA_WEIGHT, rc) /= 10
+	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_SMALL_STONE_GOLEM | cdata(CDATA_ID, rc) == CREATURE_ID_SMALL_WOODEN_GOLEM | cdata(CDATA_ID, rc) == CREATURE_ID_SILVER_SKULL_MAJESTY | cdata(CDATA_ID, rc) == CREATURE_ID_CTHULHICK | cdata(CDATA_ID, rc) == CREATURE_ID_MAGIC_BEE | cdata(CDATA_ID, rc) == CREATURE_ID_YOUNG_SWALLOW ) {
 		cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR)
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_CHILD_WEL | cdata(CDATA_ID, rc) == CREATURE_ID_NAIVE_KYLE | cdata(CDATA_ID, rc) == CREATURE_ID_RILIAN_THE_DOG_LOVER | cdata(CDATA_ID, rc) == CREATURE_ID_TOWN_CHILD | cdata(CDATA_ID, rc) == CREATURE_ID_NOBLE_CHILD | cdata(CDATA_ID, rc) == CREATURE_ID_LITTLE_SISTER | cdata(CDATA_ID, rc) == CREATURE_ID_HALLOWEEN_CHILDREN2 | cdata(CDATA_ID, rc) == CREATURE_ID_HALLOWEEN_CHILDREN | cdata(CDATA_ID, rc) == CREATURE_ID_GWEN_THE_INNOCENT | cdata(CDATA_ID, rc) == CREATURE_ID_GILPHEM_THE_MAGIC_STEEL | cdata(CDATA_ID, rc) == CREATURE_ID_BISQUE_DOLL | cdata(CDATA_ID, rc) == CREATURE_ID_GRYFFON_CHILD | cdata(CDATA_ID, rc) == CREATURE_ID_DESKTOP_NAVY | cdata(CDATA_ID, rc) == CREATURE_ID_DESKTOP_BIRDIE | cdata(CDATA_ID, rc) == CREATURE_ID_PALE_INVITER | cdata(CDATA_ID, rc) == CREATURE_ID_STRAY_SOUL | cdata(CDATA_ID, rc) == CREATURE_ID_CLINGHOST ) {
 		cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - 5 - rnd(5)
@@ -2467,11 +2495,11 @@
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_WHOM_DWELL_IN_THE_VANITY ) {
 		cdata(CDATA_DRUG_DEPENDENCE, rc) = 300
 	}
 	r1 = rc
-	gosub *calcExpToNextLevel
+	gosub *label_3991
 	r1 = rc
 	gosub *calcInitialSkill
 	if ( cdata(CDATA_PORTRAIT, rc) == 0 ) {
 		cdata(CDATA_PORTRAIT, rc) = rnd(32)
 	}
@@ -2481,12 +2509,12 @@
 		cdata(CDATA_TONE_SEX, rc) = 1
 	}
 	else {
 		cdata(CDATA_TONE_SEX, rc) = 2
 	}
-	if ( dorei2 == 0 ) {
-		gosub *chara_initEquip
+	if ( dorei2 == 0 & babymake == 0 ) {
+		gosub *label_4114
 	}
 	r1 = rc
 	gosub *charaRefresh
 	gdata(GDATA_CROWD)++
 	cdata(CDATA_HP, rc) = cdata(CDATA_MAX_HP, rc)
@@ -2500,11 +2528,11 @@
 		gosub *define_los
 		gdata(GDATA_CARGO_LIMIT_ORG) = 80000
 		gdata(GDATA_CARGO_LIMIT) = gdata(GDATA_CARGO_LIMIT_ORG)
 	}
 	if ( cbit(CHARA_BIT_LAY_HANDS, rc) | cdata(CDATA_ID, rc) == CREATURE_ID_GOOSE | cdata(CDATA_ID, rc) == CREATURE_ID_CUTE_FAIRY ) {
-		cbitmod CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, rc, TRUE
+		cbitmod (974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), rc, TRUE
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_WEREWOLF & mdata(MDATA_TYPE) == MAP_TYPE_TOWN ) {
 		evname = lang("市民", "citizen")
 		evold = lang("人狼", "werewolf")
 		if ( strmid(cdatan(CDATAN_NAME, rc), 0, strlen(evold)) == evold ) {
@@ -2706,11 +2734,11 @@
 		cdatan(CDATAN_FAKE_CLASS, rc) = lang("君主", "monarch")
 	}
 	cm = 0
 	return
 
-*cm_finishPC
+*label_4136
 	cdata(CDATA_QUALITY, rc) = FIX_QUALITY_GOOD
 	cdata(CDATA_RELATION, rc) = RELATION_ALLY
 	cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
 	cbitmod CHARA_BIT_PCC, rc, TRUE
 	flt
@@ -2747,11 +2775,11 @@
 		itemcreate CHARA_PLAYER, ITEM_ID_SPELLBOOK_CURE_MINOR_WOUND, -1, -1, 0
 		inv(INV_ITEM_NUM, ci) = 3
 		flt
 		itemcreate CHARA_PLAYER, ITEM_ID_SPELLBOOK_HERO, -1, -1, 0
 	}
-	gosub *cm_putTrait
+	gosub *label_0046
 	cdata(CDATA_SKILLPOINT, r1) = 5 + trait(TRAIT_RACE_BONUS_SKILLPOINT), 5 + trait(TRAIT_RACE_BONUS_SKILLPOINT)
 	gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) = 5
 	inv_getheader 0
 	repeat invrange, invhead
 		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
@@ -2761,16 +2789,16 @@
 	loop
 	r1 = 0
 	gosub *charaRefresh
 	return
 
-*resurrect_ally
+*label_4138
 	gosub *resurrect
 	cxinit = cdata(CDATA_X, CHARA_PLAYER)
 	cyinit = cdata(CDATA_Y, CHARA_PLAYER)
-	gosub *place_chara
-	cdata(CDATA_AREA, rc) = AREA_NONE
+	gosub *label_4125
+	cdata(CDATA_AREA, rc) = 0
 	snd SOUNDLIST_PRAY1
 	txtef COLOR_YELLOW
 	txt cnven(cdatan(CDATAN_NAME, rc)) + lang("が現れた！", " " + have(rc) + " been resurrected!")
 	return
 
@@ -2783,11 +2811,11 @@
 	cdata(CDATA_HP, rc) = cdata(CDATA_MAX_HP, rc) / 3
 	cdata(CDATA_MP, rc) = cdata(CDATA_MAX_MP, rc) / 3
 	cdata(CDATA_SP, rc) = cdata(CDATA_MAX_SP, rc) / 3
 	cdata(CDATA_SANITY, rc) = 0
 	cdata(CDATA_EXIST, rc) = CHAR_STATE_ALIVE
-	cdata(CDATA_AREA, rc) = AREA_NONE
+	cdata(CDATA_AREA, rc) = 0
 	cdata(CDATA_RELATION, rc) = cdata(CDATA_RELATION_ORG, rc)
 	cdata(CDATA_HUNGER, rc) = 8000
 	cdata(CDATA_THIRST, rc) = 8000
 
 *renewStatus
@@ -2849,11 +2877,11 @@
 	if ( cdata(CDATA_ROLE, rc) == ROLE_GUARD | cdata(CDATA_ROLE, rc) == ROLE_BOUNTY_HUNTER ) {
 		p = rnd(5) + 1
 		repeat p
 			r1 = rc
 			r2 = 1
-			gosub *calcLevelUp
+			gosub *label_3967
 		loop
 	}
 	if ( cdata(CDATA_ID, rc) == CREATURE_ID_BARD ) {
 		skillmod SKILL_NORMAL_PERFORMER, rc, 1000
 	}
@@ -2864,11 +2892,11 @@
 *cm_init
 	if ( cfg_wizard ) {
 		gdata(GDATA_WIZARD) = 1
 	}
 	if ( geneuse != "" ) {
-		gosub *load_gene
+		gosub *label_5820
 	}
 	if ( dbg_skipcm == 1 ) {
 		cmrace = "elea"
 		cmclass = "warrior"
 		cmname = "Noa"
@@ -3810,11 +3838,11 @@
 
 *cm_feat
 	gdata(GDATA_TRAIT_POINT) = 3
 	dim trait, 500
 	dim spact, 500
-	gosub *cm_putTrait
+	gosub *label_0046
 	redraw 0
 	gmode 0
 	pos 0, 0
 	gcopy BUFFER_BUF, 0, 0, windoww, windowh
 	gmode 2
@@ -3853,11 +3881,11 @@
 	if ( geneuse != "" ) {
 		pos 20, windowh - 36
 		mes "Gene from " + geneuse
 	}
 	cbitmod CHARA_BIT_PCC, CHARA_PLAYER, TRUE
-	gosub *com_portrait
+	gosub *label_5658
 	if ( stat == 0 ) {
 		gosub *cm_bg
 		goto *cm_feat
 	}
 	if ( stat == (-1) ) {
@@ -4077,17 +4105,17 @@
 		gosub *com_help
 		goto *cmSubTxt
 	}
 	goto *cm_gamemode
 
-*label_4195
+*label_4202
 	snd SOUNDLIST_OK1
 
-*label_4196
+*label_4203
 	snd SOUNDLIST_CHARA
 
-*cm_birth_loop
+*label_4204
 	redraw 0
 	gmode 0
 	pos 0, 0
 	gcopy BUFFER_BUF, 0, 0, windoww, windowh
 	gmode 2
@@ -4127,12 +4155,12 @@
 	cdatan(CDATAN_AKA, rc) = cmaka
 	cdata(CDATA_LEVEL, rc) = 1
 	repeat 8, 10
 		sdata(cnt + STARTING_SKILL_SPACT, rc) = cmstats(cnt - 10)
 	loop
-	gosub *cm_finish
-	gosub *cm_finishPC
+	gosub *label_4132
+	gosub *label_4136
 	cdata(CDATA_PORTRAIT, rc) = cmportrait
 	create_pcpic 0, 1
 	if ( dbg_skipcm == 1 ) {
 		goto *cm_end
 	}
@@ -4141,11 +4169,11 @@
 	menucycle = 0
 	gosub *com_charainfo
 	if ( stat == 0 ) {
 		nowindowanime = 1
 		gosub *cm_bg
-		goto *cm_birth_loop
+		goto *label_4204
 	}
 	redraw 0
 	gsel BUFFER_MAP
 	pos 0, 0
 	gmode 0
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/chara_func.hsp ../2.14-borscht/chara_func.hsp
--- ../2.13-borscht/chara_func.hsp	2022-06-26 12:14:11.626567400 -0700
+++ ../2.14-borscht/chara_func.hsp	2022-09-18 12:36:58.648554700 -0700
@@ -144,11 +144,11 @@
 			return 1
 		}
 		if ( rc != CHARA_PLAYER ) {
 			if ( characreate_x != (-1) ) {
 				if ( hitugi != 100 ) {
-					gosub *place_chara
+					gosub *label_4125
 				}
 				else {
 					gosub *place_necro
 				}
 			}
@@ -435,11 +435,11 @@
 	return locvar_findchara_p
 
 #defcfunc findcharahome int findcharahome_charaid
 	locvar_findchara_p = 0
 	repeat 245 - 57, 57
-		if ( cdata(CDATA_AREA, cnt) != AREA_HOME ) {
+		if ( cdata(CDATA_AREA, cnt) != 7 ) {
 			continue
 		}
 		if ( cdata(CDATA_ID, cnt) == findcharahome_charaid ) {
 			locvar_findchara_p = cnt
 			break
@@ -1097,10 +1097,13 @@
 		cdata(CDATA_SPEED_FIX, CHARA_PLAYER) -= 30
 	}
 	if ( cdata(CDATA_BURDEN, CHARA_PLAYER) == 1 ) {
 		cdata(CDATA_SPEED_FIX, CHARA_PLAYER) -= 10
 	}
+	if ( gdata(250 + 442) < gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) ) {
+		gdata(250 + 442) = gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND)
+	}
 	if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 0 ) {
 		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD | mdata(MDATA_TYPE) == MAP_TYPE_LOCAL ) {
 			if ( gdata(GDATA_CARGO_WEIGHT) > gdata(GDATA_CARGO_LIMIT) ) {
 				cdata(CDATA_SPEED_FIX, CHARA_PLAYER) -= 25 + 25 * (gdata(GDATA_CARGO_WEIGHT) / (gdata(GDATA_CARGO_LIMIT) + 1))
 			}
@@ -1466,11 +1469,11 @@
 		else {
 			rc = locvar_relocate_chara_tc
 			cdata(CDATA_EXIST, locvar_relocate_chara_tc) = CHAR_STATE_ALIVE
 			cxinit = cdata(CDATA_X, CHARA_PLAYER)
 			cyinit = cdata(CDATA_Y, CHARA_PLAYER)
-			gosub *place_chara
+			gosub *label_4125
 		}
 		cdata(CDATA_TARGET, locvar_relocate_chara_tc) = 0
 		cdata(CDATA_AI_AGGRO, locvar_relocate_chara_tc) = 0
 	}
 	if ( gdata(GDATA_TEMPORARY_FLAGS2) != 200 ) {
@@ -1487,17 +1490,17 @@
 			loop
 		}
 	}
 	gdata(GDATA_TEMPORARY_FLAGS2) = 0
 	rc = locvar_relocate_chara_tc
-	gosub *chara_equipFull
+	gosub *label_8919
 	r1 = locvar_relocate_chara_tc
 	gosub *charaRefresh
 	return relocate_chara_arg1
 
-*label_3601
-	goto *label_3604
+*label_3607
+	goto *label_3610
 
 #deffunc hostileaction int hostileaction_target, int hostileaction_source
 	if ( hostileaction_target >= MAX_CHARA_FOLLOWER | hostileaction_source == CHARA_PLAYER ) {
 		return
 	}
@@ -1547,11 +1550,11 @@
 		if ( cdata(CDATA_ID, hostileaction_source) == CREATURE_ID_RAIZEL_THE_OLD_WIZARD & cdata(CDATA_ALLIED, hostileaction_source) == 0 & gdata(GDATA_FLAG_MAIN) >= 760 ) {
 		}
 		else {
 			if ( gdata(GDATA_TEMPORARY_FLAGS2) < 1000 ) {
 				customtalk hostileaction_source, DBMODE_FLAVOR_ANGERED
-				gosub *convert_word
+				gosub *label_0416
 			}
 		}
 	}
 	if ( cbit(CHARA_BIT_LIVESTOCK, hostileaction_source) == TRUE & gdata(GDATA_AREA) != AREA_DOJO ) {
 		if ( rnd(50) == 0 ) {
@@ -2208,20 +2211,20 @@
 	r1 = resistmod_charid
 	gosub *charaRefresh
 	return
 
 #deffunc resistmodh int resistmodh_charid, int resistmodh_ele, int resistmodh_arg3
-	locvar_resistmod_lv = sorg(resistmodh_ele, resistmodh_charid) + 25
-	if ( sorg(resistmodh_ele, resistmodh_charid) >= 200 & resistmodh_arg3 >= 25 ) {
+	locvar_resistmod_lv = sorg(resistmodh_ele, resistmodh_charid)
+	if ( sorg(resistmodh_ele, resistmodh_charid) >= 300 & resistmodh_arg3 >= 25 | sorg(resistmodh_ele, resistmodh_charid) < 100 ) {
 		txt lang("何もおきない… ", "Nothing happens...")
 	}
 	else {
 		if ( locvar_resistmod_lv < 50 ) {
 			locvar_resistmod_lv = 50
 		}
-		if ( locvar_resistmod_lv > 200 ) {
-			locvar_resistmod_lv = 200
+		if ( locvar_resistmod_lv >= 100 ) {
+			locvar_resistmod_lv = 300
 		}
 		if ( resistmodh_arg3 >= 25 ) {
 			txtef COLOR_GREEN
 			if ( resistmodh_ele == SKILL_RES_FIRE ) {
 				txt lang(name(resistmodh_charid) + "の身体は急に火照りだした。", "Suddenly, " + name(resistmodh_charid) + " feel" + _s(resistmodh_charid) + " very hot.")
@@ -3587,39 +3590,41 @@
 					}
 				}
 			}
 		}
 	}
-	locvar_check_talk_exp = limit(cdata(CDATA_LEVEL, check_talk_arg2), 1, 400) * limit(cdata(CDATA_LEVEL, check_talk_arg2) + 1, 1, 400) * limit(cdata(CDATA_LEVEL, check_talk_arg2) + 2, 1, 400) / 10 + 8
+	locvar_check_talk_exp = limit(cdata(CDATA_LEVEL, check_talk_arg2), 1, 400) * limit(cdata(CDATA_LEVEL, check_talk_arg2) + 1, 1, 400) * limit(cdata(CDATA_LEVEL, check_talk_arg2) + 2, 1, 400) / 10 + 10
 	if ( check_talk_arg1 == 0 ) {
 		if ( cdata(CDATA_LEVEL, check_talk_arg2) < cdata(CDATA_LEVEL, check_talk_arg1) ) {
-			locvar_check_talk_exp = locvar_check_talk_exp / 100 + 10
-		}
-	}
-	if ( check_talk_arg1 == 0 ) {
-		if ( cdata(CDATA_LEVEL, check_talk_arg2) > cdata(CDATA_LEVEL, check_talk_arg1) ) {
-			locvar_check_talk_exp *= limit(cdata(CDATA_LEVEL, check_talk_arg2) * 2 / cdata(CDATA_LEVEL, CHARA_PLAYER), 1, 10)
+			locvar_check_talk_exp = locvar_check_talk_exp / 100 + 5
 		}
 	}
 	if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, check_talk_arg2) | cbit(CHARA_BIT_SPLIT_NO_EFFECT, check_talk_arg2) ) {
 		locvar_check_talk_exp = 0
 	}
-	cdata(CDATA_EXP, check_talk_arg1) += locvar_check_talk_exp
-	if ( check_talk_arg1 == 0 ) {
+	if ( cdata(CDATA_RELATION, check_talk_arg1) == RELATION_ALLY | check_talk_arg1 == 0 ) {
 		if ( gdata(GDATA_SLEEP_EXP) > 1000000000 ) {
 			gdata(GDATA_SLEEP_EXP) = 1000000000
 		}
 		gdata(GDATA_SLEEP_EXP) += locvar_check_talk_exp
 		if ( gdata(GDATA_SLEEP_EXP) > 1000000000 ) {
 			gdata(GDATA_SLEEP_EXP) = 1000000000
 		}
 	}
+	if ( check_talk_arg1 == 0 ) {
+		if ( cdata(CDATA_LEVEL, check_talk_arg2) > cdata(CDATA_LEVEL, check_talk_arg1) ) {
+			if ( locvar_check_talk_exp > 10 ) {
+				locvar_check_talk_exp = locvar_check_talk_exp * limit(cdata(CDATA_LEVEL, check_talk_arg2) * 30 / cdata(CDATA_LEVEL, CHARA_PLAYER), 10, 100) / 10
+			}
+		}
+	}
+	cdata(CDATA_EXP, check_talk_arg1) += locvar_check_talk_exp
 	cdata(CDATA_AI_AGGRO, check_talk_arg1) = 0
 	return
 
-*label_3662
-	goto *label_3664
+*label_3668
+	goto *label_3670
 
 #deffunc check_kill int check_kill_arg1, int check_kill_arg2
 	if ( check_kill_arg1 >= 0 ) {
 		if ( check_kill_arg1 == 0 | cdata(CDATA_RELATION, check_kill_arg1) >= RELATION_ALLY ) {
 			if ( cbit(CHARA_BIT_NECRO, check_kill_arg2) != TRUE & cdata(CDATA_RELATION, check_kill_arg2) != RELATION_ALLY & gdata(GDATA_FLAG_MAIN) != 900 ) {
@@ -4307,11 +4312,11 @@
 				cell_refresh inv(INV_ITEM_X, locvar_item_acid_ci), inv(INV_ITEM_Y, locvar_item_acid_ci)
 				locvar_item_fire_f = 1
 			}
 		}
 	loop
-	gosub *calcBurdenPc
+	gosub *label_4102
 	return locvar_item_fire_f
 
 #deffunc mapitem_fire int mapitem_fire_arg1, int mapitem_fire_arg2
 	if ( map(mapitem_fire_arg1, mapitem_fire_arg2, MAP_ITEM_CHIPS) == 0 ) {
 		return
@@ -4378,51 +4383,53 @@
 		if ( inv(INV_ITEM_NUM, locvar_item_acid_ci) <= 0 ) {
 			continue
 		}
 		rowact_item locvar_item_acid_ci
 		txtmore
-		if ( ibit(ITEM_BIT_PRECIOUS, locvar_item_acid_ci) == FALSE ) {
-			locvar_item_fire_a = refitem(inv(INV_ITEM_ID, locvar_item_acid_ci), DBSPEC_TYPE)
-			if ( item_cold_arg1 == (-1) ) {
-				locvar_item_cold_s = ""
-			}
-			else {
-				locvar_item_cold_s = name(item_cold_arg1) + lang("の", your(item_cold_arg1))
-			}
-			if ( locvar_item_fire_a == 72000 | locvar_item_fire_a == 59000 | locvar_item_fire_a == 68000 ) {
-				continue
-			}
-			if ( inv(INV_ITEM_QUALITY, locvar_item_acid_ci) >= FIX_QUALITY_MIRACLE | inv(INV_ITEM_EQUIP, locvar_item_acid_ci) != 0 ) {
-				continue
-			}
-			if ( locvar_item_fire_a != 52000 ) {
-				if ( rnd(30) ) {
+		if ( ibit(ITEM_BIT_COLDPROOF, locvar_item_acid_ci) == FALSE ) {
+			if ( ibit(ITEM_BIT_PRECIOUS, locvar_item_acid_ci) == FALSE ) {
+				locvar_item_fire_a = refitem(inv(INV_ITEM_ID, locvar_item_acid_ci), DBSPEC_TYPE)
+				if ( item_cold_arg1 == (-1) ) {
+					locvar_item_cold_s = ""
+				}
+				else {
+					locvar_item_cold_s = name(item_cold_arg1) + lang("の", your(item_cold_arg1))
+				}
+				if ( locvar_item_fire_a == 72000 | locvar_item_fire_a == 59000 | locvar_item_fire_a == 68000 ) {
 					continue
 				}
-			}
-			if ( locvar_item_fire_ti != (-1) ) {
-				if ( inv(INV_ITEM_NUM, locvar_item_fire_ti) > 0 ) {
-					txt lang(itemname(locvar_item_fire_ti, 1) + "が" + name(item_cold_arg1) + "の持ち物を冷気から守った。", itemname(locvar_item_fire_ti, 1) + " protects " + name(item_cold_arg1) + your(item_cold_arg1) + " stuff from cold.")
-					if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), locvar_item_fire_ti) > 0 ) {
-						inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), locvar_item_fire_ti)--
+				if ( inv(INV_ITEM_QUALITY, locvar_item_acid_ci) >= FIX_QUALITY_MIRACLE | inv(INV_ITEM_EQUIP, locvar_item_acid_ci) != 0 ) {
+					continue
+				}
+				if ( locvar_item_fire_a != 52000 ) {
+					if ( rnd(30) ) {
+						continue
 					}
-					else {
-						txt lang(itemname(locvar_item_fire_ti, 1) + "は粉々に砕けた。", itemname(locvar_item_fire_ti, 1) + " is broken to pieces.")
-						inv(INV_ITEM_NUM, locvar_item_fire_ti)--
-						break
+				}
+				if ( locvar_item_fire_ti != (-1) ) {
+					if ( inv(INV_ITEM_NUM, locvar_item_fire_ti) > 0 ) {
+						txt lang(itemname(locvar_item_fire_ti, 1) + "が" + name(item_cold_arg1) + "の持ち物を冷気から守った。", itemname(locvar_item_fire_ti, 1) + " protects " + name(item_cold_arg1) + your(item_cold_arg1) + " stuff from cold.")
+						if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), locvar_item_fire_ti) > 0 ) {
+							inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), locvar_item_fire_ti)--
+						}
+						else {
+							txt lang(itemname(locvar_item_fire_ti, 1) + "は粉々に砕けた。", itemname(locvar_item_fire_ti, 1) + " is broken to pieces.")
+							inv(INV_ITEM_NUM, locvar_item_fire_ti)--
+							break
+						}
+						continue
 					}
-					continue
 				}
+				locvar_item_acid_p = rnd(inv(INV_ITEM_NUM, locvar_item_acid_ci)) / 2 + 1
+				txtef COLOR_PURPLE
+				txt lang(locvar_item_cold_s + itemname(locvar_item_acid_ci, locvar_item_acid_p) + "は粉々に砕けた。", locvar_item_cold_s + itemname(locvar_item_acid_ci, locvar_item_acid_p) + " break" + _s2(locvar_item_acid_p) + " to pieces.")
+				inv(INV_ITEM_NUM, locvar_item_acid_ci) -= locvar_item_acid_p
+				locvar_item_fire_f = 1
 			}
-			locvar_item_acid_p = rnd(inv(INV_ITEM_NUM, locvar_item_acid_ci)) / 2 + 1
-			txtef COLOR_PURPLE
-			txt lang(locvar_item_cold_s + itemname(locvar_item_acid_ci, locvar_item_acid_p) + "は粉々に砕けた。", locvar_item_cold_s + itemname(locvar_item_acid_ci, locvar_item_acid_p) + " break" + _s2(locvar_item_acid_p) + " to pieces.")
-			inv(INV_ITEM_NUM, locvar_item_acid_ci) -= locvar_item_acid_p
-			locvar_item_fire_f = 1
 		}
 	loop
-	gosub *calcBurdenPc
+	gosub *label_4102
 	return locvar_item_fire_f
 
 #deffunc mapitem_cold int mapitem_cold_arg1, int mapitem_cold_arg2
 	if ( map(mapitem_cold_arg1, mapitem_cold_arg2, MAP_ITEM_CHIPS) == 0 ) {
 		return
@@ -5938,14 +5945,14 @@
 				continue
 			}
 			if ( cbit(CHARA_BIT_LAY_HANDS, cnt) == FALSE ) {
 				continue
 			}
-			if ( cbit(CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, cnt) == FALSE ) {
+			if ( cbit((974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), cnt) == FALSE ) {
 				continue
 			}
-			cbitmod CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, cnt, FALSE
+			cbitmod (974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), cnt, FALSE
 			txtef COLOR_SKY_BLUE
 			txt lang(name(cnt) + "は叫んだ。「この者にジュアの加護を。レイハンド！」", name(cnt) + " shout" + _s(cnt) + ", " + cnvtalk("Lay hand!"))
 			txtmore
 			txt lang(name(dmghp_charid) + "は回復した。", name(dmghp_charid) + " " + is(dmghp_charid) + " healed.")
 			cdata(CDATA_HP, dmghp_charid) = cdata(CDATA_MAX_HP, dmghp_charid) / 2
@@ -6730,11 +6737,11 @@
 		}
 		if ( dmghp_charid != CHARA_PLAYER ) {
 			if ( dmghp_charid < MAX_CHARA_FOLLOWER ) {
 				modimp dmghp_charid, -10
 				cdata(CDATA_EXIST, dmghp_charid) = CHAR_STATE_ALLY_DEAD
-				cdata(CDATA_AREA, dmghp_charid) = AREA_NONE
+				cdata(CDATA_AREA, dmghp_charid) = 0
 				if ( cbit(CHARA_BIT_BODYGUARD, dmghp_charid) == TRUE ) {
 					evadd EVENT_CLIENT_DEAD, cdata(CDATA_ID, dmghp_charid)
 					cdata(CDATA_EXIST, dmghp_charid) = CHAR_STATE_DEAD
 				}
 				if ( cbit(CHARA_BIT_GUARD_TEMP, dmghp_charid) == TRUE ) {
@@ -6774,35 +6781,35 @@
 			gdata(GDATA_SCOPE) = 0
 		}
 		if ( dmghp_source >= (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 			cdata(CDATA_TARGET, dmghp_source) = 0
 			customtalk dmghp_source, DBMODE_FLAVOR_KILL
-			gosub *convert_word
-			locvar_dmghp_exp = limit(cdata(CDATA_LEVEL, dmghp_charid), 1, 400) * limit(cdata(CDATA_LEVEL, dmghp_charid) + 1, 1, 400) * limit(cdata(CDATA_LEVEL, dmghp_charid) + 2, 1, 400) / 10 + 8
+			gosub *label_0416
+			locvar_dmghp_exp = limit(cdata(CDATA_LEVEL, dmghp_charid), 1, 400) * limit(cdata(CDATA_LEVEL, dmghp_charid) + 1, 1, 400) * limit(cdata(CDATA_LEVEL, dmghp_charid) + 2, 1, 400) / 10 + 10
 			if ( dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 				if ( cdata(CDATA_LEVEL, dmghp_charid) < cdata(CDATA_LEVEL, dmghp_source) ) {
-					locvar_dmghp_exp = locvar_dmghp_exp / 100 + 10
-				}
-			}
-			if ( dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
-				if ( cdata(CDATA_LEVEL, dmghp_charid) > cdata(CDATA_LEVEL, dmghp_source) ) {
-					locvar_dmghp_exp *= limit(cdata(CDATA_LEVEL, dmghp_charid) * 2 / cdata(CDATA_LEVEL, CHARA_PLAYER), 1, 10)
+					locvar_dmghp_exp = locvar_dmghp_exp / 100 + 5
 				}
 			}
 			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, dmghp_charid) | cbit(CHARA_BIT_SPLIT_NO_EFFECT, dmghp_charid) ) {
 				locvar_dmghp_exp = 0
 			}
-			cdata(CDATA_EXP, dmghp_source) += locvar_dmghp_exp
-			if ( dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
+			if ( cdata(CDATA_RELATION, dmghp_source) == RELATION_ALLY | dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 				if ( gdata(GDATA_SLEEP_EXP) > 1000000000 ) {
 					gdata(GDATA_SLEEP_EXP) = 1000000000
 				}
 				gdata(GDATA_SLEEP_EXP) += locvar_dmghp_exp
 				if ( gdata(GDATA_SLEEP_EXP) > 1000000000 ) {
 					gdata(GDATA_SLEEP_EXP) = 1000000000
 				}
 			}
+			if ( dmghp_source == (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
+				if ( cdata(CDATA_LEVEL, dmghp_charid) > cdata(CDATA_LEVEL, dmghp_source) ) {
+					locvar_dmghp_exp = locvar_dmghp_exp * limit(cdata(CDATA_LEVEL, dmghp_charid) * 20 / cdata(CDATA_LEVEL, dmghp_source), 10, 100) / 10
+				}
+			}
+			cdata(CDATA_EXP, dmghp_source) += locvar_dmghp_exp
 			cdata(CDATA_AI_AGGRO, dmghp_source) = 0
 		}
 		if ( dmghp_source >= (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */) ) {
 			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, dmghp_charid) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, dmghp_charid) != TRUE & cbit(CHARA_BIT_SUMMONED, dmghp_charid) != TRUE ) {
 				if ( dmghp_source < MAX_CHARA_FOLLOWER ) {
@@ -7373,11 +7380,11 @@
 			if ( gdata(GDATA_AREA) != AREA_PET_ARENA & gdata(GDATA_AREA) != AREA_SHOW_HOUSE & gdata(GDATA_AREA) != AREA_ARENA ) {
 				npcmemory(0, cdata(CDATA_ID, dmghp_charid))++
 			}
 			if ( dmghp_source != DAMAGE_FROM_PERSUASION_HIGH & dmghp_source != DAMAGE_FROM_PERSUASION_LOW ) {
 				customtalk dmghp_charid, DBMODE_FLAVOR_DEATH
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( dmghp_charid < MAX_CHARA_FOLLOWER ) {
 				txt lang("あなたは悲しくなった。", "You feel sad for a moment.")
 			}
 		}
@@ -7433,11 +7440,11 @@
 		}
 		if ( dmghp_source == DAMAGE_FROM_PERSUASION_LOW ) {
 			gdata(GDATA_FLAG_TALKING_USED) = 100
 		}
 		rc = dmghp_charid
-		gosub *item_loot
+		gosub *label_4225
 		gdata(GDATA_FLAG_TALKING_USED) = 0
 		if ( gdata(GDATA_AREA) == AREA_PET_ARENA ) {
 			if ( rnd(5) == 0 ) {
 				snd SOUNDLIST_CHEER
 			}
@@ -7493,21 +7500,21 @@
 	}
 	gdata(GDATA_DMG_TYPE) = 0
 	txt3rd = 0
 	return
 
-*label_3702
-	goto *label_3707
+*label_3708
+	goto *label_3713
 
 #deffunc dmgmp int dmgmp_charid, int dmgmp_arg2
 	cdata(CDATA_MP, dmgmp_charid) -= dmgmp_arg2
 	if ( cdata(CDATA_MP, dmgmp_charid) < (-99999) ) {
 		cdata(CDATA_MP, dmgmp_charid) = -99999
 	}
 	if ( cdata(CDATA_MP, dmgmp_charid) < 0 ) {
 		r1 = dmgmp_charid
-		gosub *expMagicCapacity
+		gosub *label_3999
 		locvar_dmgmp_d = -cdata(CDATA_MP, dmgmp_charid) * 400 / (100 + sdata(SKILL_NORMAL_MAGIC_CAPACITY, dmgmp_charid) * 10)
 		if ( dmgmp_charid == CHARA_PLAYER ) {
 			if ( trait(TRAIT_RACE_MAGIC_REACTION) == 1 ) {
 				locvar_dmgmp_d = locvar_dmgmp_d / 2
 			}
@@ -7812,10 +7819,95 @@
 		}
 	}
 	cdata(CDATA_THIRST, chara_morasi_arg1) = 5000
 	return
 
+#deffunc gain_iden int gain_iden_prm0, int gain_iden_prm1, int gain_iden_prm2
+	if ( cdata(CDATA_SP_EARNED, gain_iden_prm1) <= (-1000000) & cdata(CDATA_SP_EARNED, gain_iden_prm1) > (-2000000) ) {
+		snd SOUNDLIST_OFFER2
+		locvar_chara_morasi_generes = 0
+		locvar_chara_morasi_bvar = sorg(SKILL_RES_MAGIC, gain_iden_prm0)
+		locvar_chara_morasi_generes = 60
+		if ( sorg(SKILL_RES_FIRE, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_FIRE, gain_iden_prm0)
+			locvar_chara_morasi_generes = 50
+		}
+		if ( sorg(SKILL_RES_COLD, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_COLD, gain_iden_prm0)
+			locvar_chara_morasi_generes = 51
+		}
+		if ( sorg(SKILL_RES_LIGHTNING, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_LIGHTNING, gain_iden_prm0)
+			locvar_chara_morasi_generes = 52
+		}
+		if ( sorg(SKILL_RES_DARKNESS, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_DARKNESS, gain_iden_prm0)
+			locvar_chara_morasi_generes = 53
+		}
+		if ( sorg(SKILL_RES_MIND, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_MIND, gain_iden_prm0)
+			locvar_chara_morasi_generes = 54
+		}
+		if ( sorg(SKILL_RES_POISON, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_POISON, gain_iden_prm0)
+			locvar_chara_morasi_generes = 55
+		}
+		if ( sorg(SKILL_RES_NETHER, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_NETHER, gain_iden_prm0)
+			locvar_chara_morasi_generes = 56
+		}
+		if ( sorg(SKILL_RES_SOUND, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_SOUND, gain_iden_prm0)
+			locvar_chara_morasi_generes = 57
+		}
+		if ( sorg(SKILL_RES_NERVE, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_NERVE, gain_iden_prm0)
+			locvar_chara_morasi_generes = 58
+		}
+		if ( sorg(SKILL_RES_CHAOS, gain_iden_prm0) > locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_CHAOS, gain_iden_prm0)
+			locvar_chara_morasi_generes = 59
+		}
+		if ( sorg(SKILL_RES_MAGIC, gain_iden_prm0) >= locvar_chara_morasi_bvar ) {
+			locvar_chara_morasi_bvar = sorg(SKILL_RES_MAGIC, gain_iden_prm0)
+			locvar_chara_morasi_generes = 60
+		}
+		cdata(CDATA_SP_EARNED, gain_iden_prm1) -= limit(locvar_chara_morasi_bvar / 100 + gain_iden_prm2, 5, 20) * 10000
+		if ( cdata(CDATA_SP_EARNED, gain_iden_prm1) \ EXT_EQUIP_SLOTS == 0 ) {
+			cdata(CDATA_SP_EARNED, gain_iden_prm1) -= locvar_chara_morasi_generes * 100
+		}
+		else {
+			if ( cdata(CDATA_SP_EARNED, gain_iden_prm1) \ 100 == 0 ) {
+				cdata(CDATA_SP_EARNED, gain_iden_prm1) -= locvar_chara_morasi_generes
+			}
+		}
+		if ( gain_iden_prm0 != 0 ) {
+			cdata(CDATA_INFANT, gain_iden_prm1) = cdata(CDATA_ID, gain_iden_prm0)
+		}
+		txtef COLOR_YELLOW
+		txt lang(name(gain_iden_prm1) + "の生命核は" + name(gain_iden_prm0) + "の遺伝子を獲得した。", name(gain_iden_prm1) + " get genes of " + _s(gain_iden_prm0) + ".")
+		locvar_chara_morasi_sintyoku = (cdata(CDATA_SP_EARNED, gain_iden_prm1) + 1000000) * (-1) / 10000
+		locvar_chara_morasi_sintyoku += 50
+		if ( cdata(CDATA_SP_EARNED, gain_iden_prm1) > (-1500000) ) {
+			txtef COLOR_YELLOW
+			txt lang("[フェイズ1進捗率：" + locvar_chara_morasi_sintyoku + "％]", "[Phase 1 progress " + locvar_chara_morasi_sintyoku + " %]")
+		}
+		if ( cdata(CDATA_SP_EARNED, gain_iden_prm1) <= (-1500000) ) {
+			cdata(CDATA_SP_EARNED, gain_iden_prm1) -= 500000
+			snd SOUNDLIST_DING1
+			txtef COLOR_GREEN
+			txt lang("[SURVIVABILITY EXTENSION！]　フェイズ1が完了した。これからは、食事の栄養で成長させる必要がある。", "[SURVIVABILITY EXTENSION !] Phase 1 completed. From now on, it need to grow with the nutrition of foods.")
+		}
+		if ( 0 ) {
+			txt lang("耐性" + locvar_chara_morasi_generes + "でステージ" + cdata(CDATA_SP_EARNED, gain_iden_prm1) + "。", name(gain_iden_prm1) + " get genes of " + _s(gain_iden_prm0) + ".")
+		}
+		locvar_chara_morasi_generes = 0
+		locvar_chara_morasi_bvar = 0
+		locvar_chara_morasi_sintyoku = 0
+	}
+	return
+
 #deffunc eatstatus int eatstatus_arg1, int eatstatus_arg2
 	if ( cdata(CDATA_EXIST, eatstatus_arg2) != CHAR_STATE_ALIVE ) {
 		return
 	}
 	if ( eatstatus_arg1 <= (-1) ) {
@@ -7874,17 +7966,18 @@
 			dmgcon sickifcursed_arg2, CONDITION_SICK, 200
 		}
 	}
 	return
 
-*label_3728
+*label_3735
 	goto *net_init
 
 
 
 
 
+
 
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/chat.hsp ../2.14-borscht/chat.hsp
--- ../2.13-borscht/chat.hsp	2022-06-26 12:14:12.090995000 -0700
+++ ../2.14-borscht/chat.hsp	2022-09-18 12:36:59.100977200 -0700
@@ -121,11 +121,11 @@
 					}
 				}
 			}
 		}
 	}
-	gosub *set_npcGod
+	gosub *label_5207
 	if ( scenemode == FALSE ) {
 		snd SOUNDLIST_CHAT
 		gosub *check_renew
 	}
 	cs = 0
@@ -161,13 +161,13 @@
 		cdata(CDATA_INTEREST, tc) = 100
 	}
 	if ( cdata(CDATA_ROLE, tc) >= (1000 /*!!!@[ROLE_SHOP_MIN @@@ ROLE_SHOP_WEAPON]@!!! */) & cdata(CDATA_ROLE, tc) < (2000 /*!!!@[ROLE_GUEST_BEGGAR @@@ ROLE_GUEST_MIN]@!!! */) | cdata(CDATA_ROLE, tc) == ROLE_GUEST_MERCHANT ) {
 		bkrestock = cdata(CDATA_ROLE_RESTOCK, tc)
 		invfile = cdata(CDATA_ROLE_FILE_ID, tc)
-		gosub *shop_init
+		gosub *label_6695
 		if ( gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 >= bkrestock ) {
-			cbitmod CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, tc, TRUE
+			cbitmod (974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), tc, TRUE
 		}
 		if ( gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 >= bkrestock ) {
 			if ( cdata(CDATA_ROLE, tc) != ROLE_SHOP_BOOK_RESERVE ) {
 				if ( dbg_noautosave == 0 & gdata(GDATA_WIZARD) == 0 ) {
 					if ( gdata(GDATA_AREA) != AREA_PET_ARENA & gdata(GDATA_AREA) != AREA_SHOW_HOUSE ) {
@@ -1215,11 +1215,11 @@
 			if ( scenemode ) {
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
-			gosub *sexsex
+			gosub *label_6019
 			goto *chat_event_SWEND1
 		}
 		listmax = 0
 		buff = lang("ふん！", "Hump!")
 		tc = tc * (0 == 0) + (0 != 0) * 0
@@ -1258,11 +1258,11 @@
 			if ( scenemode ) {
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
-			gosub *sexsex
+			gosub *label_6019
 			goto *chat_event_SWEND1
 		}
 		listmax = 0
 		buff = lang("ふん！", "Hump!")
 		tc = tc * (0 == 0) + (0 != 0) * 0
@@ -1471,11 +1471,11 @@
 				goto *chat_event_SWEND1
 			}
 		}
 		cbitmod CHARA_BIT_GUEST, tc, FALSE
 		cdata(CDATA_ROLE, tc) = ROLE_NONE
-		cdata(CDATA_AREA, tc) = AREA_HOME
+		cdata(CDATA_AREA, tc) = 7
 		goto *chat_event_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 2003 | _switch_sw ) {
 		_switch_sw = 0
@@ -5962,11 +5962,11 @@
 			invfile = cdata(CDATA_ROLE_FILE_ID, tc)
 			gosub *shop
 			screenupdate = -1
 			gosub *screen_draw
 			cs = 0
-			gosub *calcBurdenPc
+			gosub *label_4102
 			goto *chat_unique
 		}
 		if ( chatval == 3 ) {
 			ccpc = limit(calccargoupdatecost(), 1, 10)
 			buff = lang("荷車の改造とな。たいして気乗りのする仕事ではないが、そうじゃの、ブロンズ硬貨" + ccpc + "枚をくれるならやらんでもない。", "Upgrade your cart? It's not something I get excited about but if you can give me " + ccpc + " bronze coins, I'll think about it.")
@@ -6007,11 +6007,11 @@
 			if ( stat != (-1) ) {
 				ci = stat
 				inv(INV_ITEM_NUM, ci) -= ccpc
 			}
 			gdata(GDATA_CARGO_LIMIT) += calccargoupdate()
-			gosub *calcBurdenPc
+			gosub *label_4102
 			listmax = 0
 			buff = lang("ほい。", "Here you are.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
 			list(0, listmax) = 0
 			listn(0, listmax) = strmore
@@ -6157,11 +6157,11 @@
 					item_find ITEM_ID_BRONZE_COIN, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
 					if ( stat != (-1) ) {
 						ci = stat
 						inv(INV_ITEM_NUM, ci) -= 2
 					}
-					gosub *calcBurdenPc
+					gosub *label_4102
 					redraw 0
 					gosub *screen_draw
 					gosub *screen_fade
 					gsel BUFFER_BUF
 					pos 0, 0
@@ -8764,11 +8764,11 @@
 				if ( s(1) == "" ) {
 					s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
 					gosub *set_figure
 				}
 				r1 = 0
-				gosub *calcBodyFix
+				gosub *label_3962
 				atobui = 0
 				repeat 30, 100
 					if ( cdata(cnt, CHARA_PLAYER) != 0 ) {
 						atobui++
 					}
@@ -9189,11 +9189,11 @@
 					if ( s(1) == "" ) {
 						s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
 						gosub *set_figure
 					}
 					r1 = c
-					gosub *calcBodyFix
+					gosub *label_3962
 					r1 = c
 					gosub *charaRefresh
 					dbidn = 0
 					dbmode = DBMODE_NONE
 					atobui = 0
@@ -9312,11 +9312,11 @@
 					if ( scene_cut == 1 ) {
 						goto *chat_end
 					}
 				}
 			}
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		if ( gdata(GDATA_FLAG_SUB_BIOLOGIST) >= 6 ) {
 			listmax = 0
 			buff = lang("成功じゃ！実験は大成功じゃ！おぬしの働きに感謝して、記念すべき能力複合機第一号をくれてやろう。大事に使うのじゃぞ！", "Success! The experiment is a huge success! You've done a great job! To express my thanks I'll let you use my gene splicing machine. Please take good care of it.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
@@ -10812,11 +10812,11 @@
 						txt lang(itemname(cnt) + "を渡した。", "You hand over " + itemname(cnt) + ".")
 						inv(INV_ITEM_NUM, cnt) = 0
 					}
 				}
 			loop
-			gosub *calcBurdenPc
+			gosub *label_4102
 			listmax = 0
 			buff = lang("なかなか賢明な判断" + _da(), "A wise choice.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
 			list(0, listmax) = 0
 			listn(0, listmax) = strbye
@@ -11692,11 +11692,11 @@
 			if ( scenemode ) {
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
-			gosub *sexsex
+			gosub *label_6019
 			goto *chat_end
 		}
 		if ( gdata(GDATA_FLAG_SUB_FALLEN_PRINCESS) == 0 ) {
 			list(0, listmax) = 2
 			listn(0, listmax) = lang("仰せのままに", "Sure")
@@ -12001,11 +12001,11 @@
 			txtef COLOR_GREEN
 			txt lang("ジャーナルが更新された。", "Your journal has been updated.")
 			gdata(GDATA_FLAG_SUB_FALLEN_PRINCESS) = 1000
 			snd SOUNDLIST_COMPLETE1
 			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
-			gosub *sexsex
+			gosub *label_6019
 			goto *chat_end
 		}
 		goto *chat_unique_SWEND1
 		_switch_sw++
 	}
@@ -13675,11 +13675,11 @@
 					if ( scene_cut == 1 ) {
 						goto *chat_end
 					}
 				}
 			}
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		if ( gdata(GDATA_FLAG_SUB_STRUGGLE_AGAINST_INSANITY) >= 10 & gdata(GDATA_FLAG_SUB_STRUGGLE_AGAINST_INSANITY) < 1000 ) {
 			listmax = 0
 			buff = lang("これだけあれば父さまもきっと良くなる…冒険者さんありがとう。後でさっそく父さまに使ってみるね。これ、お礼だよ！", "This should be enough to make daddy better... Thanks Mr. Adventurer.  I'll use them on him later. Here, it's your reward!")
 			tc = tc * (0 == 0) + (0 != 0) * 0
@@ -15268,11 +15268,11 @@
 			invfile = cdata(CDATA_ROLE_FILE_ID, tc)
 			gosub *shop
 			screenupdate = -1
 			gosub *screen_draw
 			cs = 0
-			gosub *calcBurdenPc
+			gosub *label_4102
 			goto *chat_unique
 		}
 		goto *chat_end
 		goto *chat_unique_SWEND1
 		_switch_sw++
@@ -20400,11 +20400,11 @@
 			gdata(GDATA_LAST_EDGE_X) = -1
 			fixtransfermap = 0
 			gdata(GDATA_FLAG_MAIN) = 366
 			dbg_skipevent = 1
 			gdata(GDATA_HOUR) += 2
-			gosub *advance_hour
+			gosub *label_9228
 			dbg_skipevent = 0
 			chatteleport = 1
 			goto *chat_end
 		}
 		else {
@@ -20468,11 +20468,11 @@
 						gdata(GDATA_WORLD_X) = adata(ADATA_X, 71), adata(ADATA_Y, 71)
 					}
 					fixtransfermap = 1
 					dbg_skipevent = 1
 					gdata(GDATA_HOUR) += 2
-					gosub *advance_hour
+					gosub *label_9228
 					dbg_skipevent = 0
 					chatteleport = 1
 					goto *chat_end
 				}
 				listmax = 0
@@ -23244,11 +23244,11 @@
 						gdata(GDATA_LEVEL_START_ON) = 7
 						mapstartx = 5
 						mapstarty = 13
 						dbg_skipevent = 1
 						gdata(GDATA_HOUR) += 2
-						gosub *advance_hour
+						gosub *label_9228
 						dbg_skipevent = 0
 						chatteleport = 1
 						goto *chat_end
 					}
 					else {
@@ -25150,24 +25150,24 @@
 					p = 0
 					if ( ibit(ITEM_BIT_ALIVE, ci) ) {
 						p += 10000
 					}
 					repeat 15
-						if ( inv(40 + cnt * 2 + 1, ci) > 0 ) {
-							if ( inv(40 + cnt * 2, ci) >= 10000 ) {
-								if ( inv(40 + cnt * 2, ci) / 10000 == 6 ) {
+						if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) > 0 ) {
+							if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) >= 10000 ) {
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) / 10000 == 6 ) {
 									p += 100
 									continue
 								}
-								if ( inv(40 + cnt * 2, ci) / 10000 == 1 ) {
-									p -= inv(40 + cnt * 2 + 1, ci) * 6 / 10
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) / 10000 == 1 ) {
+									p -= inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) * 6 / 10
 								}
-								if ( inv(40 + cnt * 2, ci) / 10000 == 3 ) {
-									p -= inv(40 + cnt * 2 + 1, ci) / 2
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) / 10000 == 3 ) {
+									p -= inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 2
 								}
 							}
-							p += inv(40 + cnt * 2 + 1, ci)
+							p += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci)
 						}
 					loop
 					listmax = 0
 					buff = lang("ふむふむ…。こいつのエンチャントは" + p + "パワーってところだぜ。", "So you are also of the same genus as the others...")
 					tc = tc * (0 == 0) + (0 != 0) * 0
@@ -25539,24 +25539,24 @@
 					p = 0
 					if ( ibit(ITEM_BIT_ALIVE, ci) ) {
 						p += 10000
 					}
 					repeat 15
-						if ( inv(40 + cnt * 2 + 1, ci) > 0 ) {
-							if ( inv(40 + cnt * 2, ci) >= 10000 ) {
-								if ( inv(40 + cnt * 2, ci) / 10000 == 6 ) {
+						if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) > 0 ) {
+							if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) >= 10000 ) {
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) / 10000 == 6 ) {
 									p += 100
 									continue
 								}
-								if ( inv(40 + cnt * 2, ci) / 10000 == 1 ) {
-									p -= inv(40 + cnt * 2 + 1, ci) * 6 / 10
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) / 10000 == 1 ) {
+									p -= inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) * 6 / 10
 								}
-								if ( inv(40 + cnt * 2, ci) / 10000 == 3 ) {
-									p -= inv(40 + cnt * 2 + 1, ci) / 2
+								if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) / 10000 == 3 ) {
+									p -= inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 2
 								}
 							}
-							p += inv(40 + cnt * 2 + 1, ci)
+							p += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci)
 						}
 					loop
 					if ( inv(INV_ITEM_QUALITY, ci) == FIX_QUALITY_MIRACLE ) {
 						p -= 500
 					}
@@ -25588,11 +25588,11 @@
 					goto *chat_end
 				}
 				ii = -1
 				repeat 15
 					if ( ii == (-1) ) {
-						if ( inv(40 + cnt * 2, ci) == 0 ) {
+						if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 							ii = cnt
 						}
 					}
 				loop
 				if ( ii == (-1) ) {
@@ -25622,11 +25622,11 @@
 					gosub *chat_select
 					if ( chatval != 2 & chatval != 1 ) {
 						goto *chat_end
 					}
 					if ( chatval == 2 ) {
-						if ( inv(40 + (15 - 1) * 2, cibk) == 37 | inv(40 + (15 - 1) * 2, cibk) == 45 ) {
+						if ( inv(STARTING_INV_ITEM_ENCHANT + (15 - 1) * 2, cibk) == 37 | inv(STARTING_INV_ITEM_ENCHANT + (15 - 1) * 2, cibk) == 45 ) {
 							listmax = 0
 							buff = lang("消去とな？ふむ、このエンチャントだと…ちょっと無理じゃな…すまんのう。", "So you are also of the same genus as the others...")
 							tc = tc * (0 == 0) + (0 != 0) * 0
 							list(0, listmax) = 0
 							listn(0, listmax) = strmore
@@ -25654,12 +25654,12 @@
 							}
 						}
 						snd SOUNDLIST_BUILD1
 						await 300
 						snd SOUNDLIST_BUILD1
-						inv(40 + (15 - 1) * 2 + 1, cibk) = 0
-						inv(40 + (15 - 1) * 2, cibk) = 0
+						inv(STARTING_INV_ITEM_ENCHANT + (15 - 1) * 2 + 1, cibk) = 0
+						inv(STARTING_INV_ITEM_ENCHANT + (15 - 1) * 2, cibk) = 0
 						txt lang(itemname(cibk) + "のエンチャントがひとつ消えた。", itemname(cibk) + " removes an enchantment.")
 					}
 				}
 				listmax = 0
 				buff = lang("それで、どのアイテムの力をアーティファクトに組み込めばよいのじゃ？", "So you are also of the same genus as the others...")
@@ -26581,11 +26581,11 @@
 						gdata(GDATA_LEVEL_START_ON) = 7
 						mapstartx = 20
 						mapstarty = 55
 						dbg_skipevent = 1
 						gdata(GDATA_HOUR) += 2
-						gosub *advance_hour
+						gosub *label_9228
 						dbg_skipevent = 0
 						chatteleport = 1
 						goto *chat_end
 					}
 					else {
@@ -27684,11 +27684,11 @@
 							if ( scene_cut == 1 ) {
 								goto *chat_end
 							}
 						}
 					}
-					gosub *calcBurdenPc
+					gosub *label_4102
 					if ( gdata(GDATA_FLAG_SUB_URCAGUARY_THE_TENACIOUS_GEM) >= 32 ) {
 						listmax = 0
 						buff = lang("根性あるじゃないか…アンタは立派な騎士団備品調達係さ！褒美をやるよ、取っておきな。", "If you find any unicorn horns bring them to me.")
 						tc = tc * (0 == 0) + (0 != 0) * 0
 						list(0, listmax) = 0
@@ -28323,11 +28323,11 @@
 				}
 				goto *chat_end
 			}
 			if ( chatval == 1 ) {
 				inv(INV_ITEM_NUM, ci) -= 1
-				gosub *calcBurdenPc
+				gosub *label_4102
 				txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
 				flt
 				itemcreate -1, ITEM_ID_SCROLL_FAITH, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 3
 				if ( gdata(GDATA_FLAG_SUB_URCAGUARY_THE_TENACIOUS_GEM) >= 1 ) {
 					if ( gdata(GDATA_FLAG_SUB_SOCKS_THIEF) <= 10 ) {
@@ -28846,11 +28846,11 @@
 					gdata(GDATA_LEVEL_START_ON) = 7
 					mapstartx = 4
 					mapstarty = 4
 					dbg_skipevent = 1
 					gdata(GDATA_HOUR) += 2
-					gosub *advance_hour
+					gosub *label_9228
 					dbg_skipevent = 0
 					chatteleport = 1
 					goto *chat_end
 				}
 				else {
@@ -30227,12 +30227,12 @@
 				inv(INV_ITEM_PARAM1, ci) = 1
 				if ( inv(INV_ITEM_LEVEL, ci) > 0 ) {
 					inv(INV_ITEM_LEVEL, ci) = 0
 				}
 				repeat 15
-					inv(40 + cnt * 2 + 1, ci) = 0
-					inv(40 + cnt * 2, ci) = 0
+					inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) = 0
+					inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) = 0
 				loop
 				r1 = 0
 				gosub *charaRefresh
 				listmax = 0
 				buff = lang("これで、またひとつ…。", "I was approached a little.")
@@ -30616,11 +30616,11 @@
 						gdata(GDATA_LEVEL_START_ON) = 7
 						mapstartx = 5
 						mapstarty = 52
 						dbg_skipevent = 1
 						gdata(GDATA_HOUR) += 2
-						gosub *advance_hour
+						gosub *label_9228
 						dbg_skipevent = 0
 						chatteleport = 1
 						goto *chat_end
 					}
 					else {
@@ -33227,11 +33227,11 @@
 					}
 				}
 			}
 			if ( gdata(GDATA_FLAG_TRAINING_COURSE_LEVEL) == 1 ) {
 				listmax = 0
-				buff = lang("筋力や耐久といった値が主能力。潜在能力は、その能力がどのくらい伸びやすいかを示している。superb（素晴らしい）が最高で、hopeless（絶望的）が最低の状態だ。主能力は対応したスキルや能力、行動を行うことで自然に成長していくんだ。", "Strength, Constitution and all that are what we call the main attributes. Potentials are how easy they are to raise. The highest is 'Superb', and the lowest 'Hopeless'. Whenever you use a skill or special action, you will train the attribute that they depend on.")
+				buff = lang("筋力や耐久といった値が主能力。主能力は対応したスキルや能力、行動を行うことで自然に成長していくんだ。潜在能力は、その能力がどのくらい伸びやすいかを示している。Supreme（至高）は伸びやすさが最大に達した状態だ。そしてHopeless（絶望的）は最低レベルに伸びにくくなっている状態だな。潜在が下がってきたら回復しないと、主能力が全然伸びなくなるぞ。", "Strength, Constitution and all that are what we call the main attributes. Potentials are how easy they are to raise. The highest is 'Supreme', and the lowest 'Hopeless'. Whenever you use a skill or special action, you will train the attribute that they depend on.")
 				tc = tc * (0 == 0) + (0 != 0) * 0
 				list(0, listmax) = 0
 				listn(0, listmax) = strmore
 				listmax++
 				chatesc = 1
@@ -33242,11 +33242,11 @@
 					}
 				}
 			}
 			if ( gdata(GDATA_FLAG_TRAINING_COURSE_LEVEL) == 1 ) {
 				listmax = 0
-				buff = lang("主能力の潜在を回復させるには、ランクの高い寝具で睡眠を取ることだ。寝る前に得た経験値が多いほど潜在も多く回復するけれど、睡眠を遅らせてまで経験値を稼ぐくらいなら早く寝たほうがいいぞ！規模の大きい魔法店が稀に入荷する、潜在能力のポーションを飲むのもいいけれど、レアゆえに供給がなかなか追いつかないだろうな。", "To recover the potentials of your attributes, you need to sleep in a high-ranked bed. The more experience you gain before sleeping, the more potentials you recover while you sleep. Don't stay up just to earn more experience though. It's not worth it. It's better to just go to bed when you need to. High-ranked magic shops will stock potions of potential occasionally. But not often enough that you can depend entirely on just these to raise your potentials.")
+				buff = lang("主能力の潜在を回復させるには、ランクの高い寝具で睡眠を取ることだ。寝る前に得た経験値が多いほど潜在も多く回復するけれど、睡眠を遅らせてまで経験値を稼ぐくらいなら早く寝たほうがマシだぞ！規模の大きい魔法店が稀に入荷する、潜在能力のポーションを飲むのもいいけれど、レアゆえに供給がなかなか追いつかないだろうな。", "To recover the potentials of your attributes, you need to sleep in a high-ranked bed. The more experience you gain before sleeping, the more potentials you recover while you sleep. Don't stay up just to earn more experience though. It's not worth it. It's better to just go to bed when you need to. High-ranked magic shops will stock potions of potential occasionally. But not often enough that you can depend entirely on just these to raise your potentials.")
 				tc = tc * (0 == 0) + (0 != 0) * 0
 				list(0, listmax) = 0
 				listn(0, listmax) = strmore
 				listmax++
 				chatesc = 1
@@ -33272,11 +33272,11 @@
 					}
 				}
 			}
 			if ( gdata(GDATA_FLAG_TRAINING_COURSE_LEVEL) == 1 ) {
 				listmax = 0
-				buff = lang("スキルは、トレイナーにプラチナ硬貨を払うことで、習得したり潜在を回復させたりできるぞ。成長させるには経験値の入る行動が必要なんだ。どのスキルに経験値が入っているのかは、スキルトラック…スキルを*キーで登録すればわかりやすいな。", "Now. Skill potentials. You can pay skill trainers in towns platinum pieces to increase them. To increase their levels, you will need to earn experience for them. You can easily check if a skill is receiving experience by tracking it, which will display it on the left at all times. Track a skill by pressing the '*' key while it's selected.")
+				buff = lang("スキルは、トレイナーにプラチナ硬貨を払うことで、習得したり潜在を回復させたりできるぞ。成長させるには経験値の入る行動が必要なんだ。どのスキルに経験値が入っているのかは、スキルトラック…スキルを*キーで登録すればわかりやすいな。ちなみにスキルトラックは最大で15個まで登録できる。", "Now. Skill potentials. You can pay skill trainers in towns platinum pieces to increase them. To increase their levels, you will need to earn experience for them. You can easily check if a skill is receiving experience by tracking it, which will display it on the left at all times. Track a skill by pressing the '*' key while it's selected.")
 				tc = tc * (0 == 0) + (0 != 0) * 0
 				list(0, listmax) = 0
 				listn(0, listmax) = strmore
 				listmax++
 				chatesc = 1
@@ -33653,11 +33653,11 @@
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
 			listmax = 0
-			buff = lang("聴診器を使えばわかるんだが、青緑色の時は食事可能、桃色の時は満腹だ。腹がすいたらすぐに食わせることができるように、料理は多く持っておくんだ。足りなきゃ果物の木やパン屋から調達しような。", "When you've used a stethoscope on them, then you'll be able to tell when they're hungry. Blue-green for hungry, pink for full. Bring lots of cooked food so that you can feed them when hungry. When you run out, get more from fruit trees or bakers.")
+			buff = lang("聴診器を使えばわかるんだが、青緑色の時は食事可能、桃色の時は満腹だ。腹がすいたらすぐに食わせることができるように、料理は多く持っておくんだ。足りなきゃ果物の木やパン屋から調達しような。ランクの高い料理は仲のいい仲間と一緒に食事することもできる。能力上昇効果はそのままで満腹になりにくいので、活用してみてくれ。", "When you've used a stethoscope on them, then you'll be able to tell when they're hungry. Blue-green for hungry, pink for full. Bring lots of cooked food so that you can feed them when hungry. When you run out, get more from fruit trees or bakers. High-ranked dishes can be eaten with good friends. The effect of increasing the ability does not change, but the feeling of fullness is halved, so you should try it.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
 			list(0, listmax) = 0
 			listn(0, listmax) = strmore
 			listmax++
 			chatesc = 1
@@ -33695,11 +33695,11 @@
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
 			listmax = 0
-			buff = lang("仲間に新しいスキルを覚えさせる方法はまたの機会に説明するよ。それまでに、誰がどのスキルを持っているかをちゃんと把握しておこう。街の情報屋で教えてもらえるぞ。", "I'll explain how to teach your allies new skills some other time. In the meantime, make sure you know the skill sets of every one of your allies. To find out, you can go to the informers in towns.")
+			buff = lang("仲間に新しいスキルを覚えさせる方法はまたの機会に説明するよ。それまでに、誰がどのスキルを持っているかをちゃんと把握しておこう。仲間に干渉…iキーから情報を開示してもらえるぞ。", "I'll explain how to teach your allies new skills some other time. In the meantime, make sure you know the skill sets of every one of your allies. You can have your allies disclose information from the i key menu.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
 			list(0, listmax) = 0
 			listn(0, listmax) = strmore
 			listmax++
 			chatesc = 1
@@ -34199,11 +34199,11 @@
 					}
 				}
 			}
 			if ( gdata(GDATA_FLAG_TRAINING_COURSE_LEVEL) == 3 ) {
 				listmax = 0
-				buff = lang("今はまだ単純に武器で殴ったり魔法の矢を撃ったりするだけでいいかもしれない。でも冒険を進めていくうちに、物理攻撃に強い敵や魔法に強い敵、属性攻撃を無効化する敵なんかと戦うことになるの。そうした時にサブウェポンとして別系統の攻撃手段がないと、有効打を与えられずに死ぬほど苦労することになるよ。なんだかこの敵全然削れないな？と思ったらサブウェポンを試してみよう。", "You might be doing well now just by clubbing enemies on the head with your weapon or firing Magic Darts. In your adventures, however, you will encounter enemies that are resistant to physical attacks or to spells, or immune to elemental attacks. It's times like these when you will need have a sub weapon as a different source of damage, or else you'll find it really hard to break the stalemate. When you find an enemy who isn't affected by your attacks, it's time to try your sub weapon.")
+				buff = lang("今はまだ単純に武器で殴ったり魔法の矢を撃ったりするだけでいいかもしれない。でも冒険を進めていくうちに、物理攻撃に強い敵や魔法に強い敵、属性攻撃をほぼ無効化する敵なんかと戦うことになるの。そうした時にサブウェポンとして別系統の攻撃手段がないと、有効打を与えられずに死ぬほど苦労することになるよ。なんだかこの敵全然削れないな？と思ったらサブウェポンを試してみよう。", "You might be doing well now just by clubbing enemies on the head with your weapon or firing Magic Darts. In your adventures, however, you will encounter enemies that are resistant to physical attacks or to spells, or immune to elemental attacks. It's times like these when you will need have a sub weapon as a different source of damage, or else you'll find it really hard to break the stalemate. When you find an enemy who isn't affected by your attacks, it's time to try your sub weapon.")
 				tc = tc * (0 == 0) + (0 != 0) * 0
 				list(0, listmax) = 0
 				listn(0, listmax) = strmore
 				listmax++
 				chatesc = 1
@@ -34384,11 +34384,11 @@
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
 			listmax = 0
-			buff = lang("敵との距離が離れている場合は、壁生成や扉生成でさえぎって追撃を防ぐのも有効だよ。モグラの魔物や、名前に『』や《》がつく変異種には破壊されちゃうけど。煙玉を投げて煙幕を張れば、遠距離攻撃のほとんどを無効化できるね。", "If an enemy is a distance away, you can use Wall Creation or Door Creation block their line of sight and attacks for a bit. Mole monsters and monster variants with <> and {} brackets around their names will break right through it though.")
+			buff = lang("敵との距離が離れている場合は、壁生成や扉生成でさえぎって追撃を防ぐのも有効だよ。モグラの魔物や、名前に『』や《》がつく変異種には破壊されちゃうけど。煙玉を投げて煙幕を張れば、遠距離攻撃のほとんどを無効化できるね。", "If an enemy is a distance away, you can use Wall Creation or Door Creation block their line of sight and attacks for a bit. Mole monsters and monster variants with <> and {} brackets around their names will break right through it though. A smoke screen will negate most ranged attacks.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
 			list(0, listmax) = 0
 			listn(0, listmax) = strmore
 			listmax++
 			chatesc = 1
@@ -34400,11 +34400,11 @@
 			}
 			gdata(GDATA_FLAG_TRAINING_COURSE_STATE)++
 		}
 		if ( chatval == 1 ) {
 			listmax = 0
-			buff = lang("＊キーで「見る」と、相手とのおおよそのレベル差がわかるよ。でも装備や戦い方で体感的な強さが大きく変わるから、本当に目安でしかないの。インサイトレンズっていう道具を使えば相手の能力値は確認できるけど、レアだから…。", "You can look at enemies with the '*' targeting key to get an estimate of the difference in level. This is just a rough estimate, though, since the actual difficulty of the fight can drastically change with your equipment and the way you fight. I suppose you could use an insight lens on the enemy to look at all their stats, but those are rare.")
+			buff = lang("＊キーで「見る」と、相手とのおおよそのレベル差がわかるよ。でも装備や戦い方で体感的な強さが大きく変わるから、本当に目安でしかないの。インサイトレンズっていう道具を使えば相手の能力値は確認できるけど、レアだから…。分析スキルが高いなら、相手との物理戦闘を通じてComplete状態にすれば、能力を確認することもできるよ。", "You can look at enemies with the '*' targeting key to get an estimate of the difference in level. This is just a rough estimate, though, since the actual difficulty of the fight can drastically change with your equipment and the way you fight. I suppose you could use an insight lens on the enemy to look at all their stats, but those are rare. If your analysis skills are high, you can check your abilities by completing the physical battle with your opponent.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
 			list(0, listmax) = 0
 			listn(0, listmax) = strmore
 			listmax++
 			chatesc = 1
@@ -34455,11 +34455,11 @@
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
 			listmax = 0
-			buff = lang("覚えておいてほしいのは、ネフィアの入口の階層レベルは挑戦推奨レベルとは違うってこと。今まで倒せた敵のレベルがｃキーのキャラシートに適正値として記録されているから、そっちを目安にしよう。", "One thing you should know is that the danger level of the first floor of Nefia is not the level at which you should challenge the Nefia. What you should use as a reference is the Rating on the character sheet which has the highest level enemy you've defeated so far.")
+			buff = lang("覚えておいてほしいのは、ネフィアの入口の階層レベルは挑戦推奨レベルとは違うってこと。今まで倒せた敵のレベルがｃキーのキャラシートに戦力評価として記録されているから、そっちを目安にしよう。", "One thing you should know is that the danger level of the first floor of Nefia is not the level at which you should challenge the Nefia. What you should use as a reference is the Rating on the character sheet which has the highest level enemy you've defeated so far.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
 			list(0, listmax) = 0
 			listn(0, listmax) = strmore
 			listmax++
 			chatesc = 1
@@ -34539,11 +34539,11 @@
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
 			listmax = 0
-			buff = lang("最終的には全部の耐性を素晴らしい耐性まで上げたいけれど、揃うまでは属性耐性のポーションや魔法で補ったり、複数の装備を付け替えて対応することも考えようね。", "You'll eventually want to have Superb resistance to every element, but until then you should buff yourself with spells or potions of resistance, and keep swapping your equipment as needed.")
+			buff = lang("最終的には全部の耐性を可能な限り上げたいけれど、装備が揃うまでは属性耐性のポーションや魔法で補ったり、複数の装備を付け替えて対応することも考えようね。", "You'll eventually want to have Superb resistance to every element, but until then you should buff yourself with spells or potions of resistance, and keep swapping your equipment as needed.")
 			tc = tc * (0 == 0) + (0 != 0) * 0
 			list(0, listmax) = 0
 			listn(0, listmax) = strmore
 			listmax++
 			chatesc = 1
@@ -36032,11 +36032,11 @@
 			if ( scene_cut == 1 ) {
 				goto *chat_end
 			}
 		}
 		if ( gdata(GDATA_FLAG_MAIN) < 710 ) {
-			goto *chat_unique_enthumesis
+			goto *label_6617
 		}
 		goto *chat_end
 		goto *chat_unique_SWEND1
 		_switch_sw++
 	}
@@ -37519,20 +37519,20 @@
 			if ( scenemode ) {
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
-*label_6585
+*label_6595
 			if ( 1 == 0 ) {
-				goto *label_6587
+				goto *label_6597
 			}
 			txtnew
 			txt lang("誰と戦わせる？", "Who do you want her to hit?")
 			allyctrl = 3
-			gosub *com_listNpc
+			gosub *label_5444
 			if ( stat == (-1) ) {
-				goto *label_6587
+				goto *label_6597
 			}
 			hometc = stat
 			if ( hometc == tc ) {
 				txtef COLOR_YELLOW
 				txt cdatan(CDATAN_NAME, tc) + lang("「やだなぁ…この家を守る私が害虫なわけないじゃないですか」", " " + cnvtalk("I am protecting this house. I'm not a pest."))
@@ -37841,10 +37841,62 @@
 		}
 		goto *chat_end
 		goto *chat_unique_SWEND1
 		_switch_sw++
 	}
+	if ( _switch_val == 690 | _switch_sw ) {
+		_switch_sw = 0
+		kaiwa = rnd(3)
+		if ( kaiwa == 0 ) {
+			listmax = 0
+			buff = lang("やだなぁ…隙を見て赤ちゃんをさらおうなんて考えてませんよぉ。", "No...I'm not thinking of stealing the baby while looking for a chance...")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+		}
+		if ( kaiwa == 1 ) {
+			listmax = 0
+			buff = lang("あー…子供ができない夫婦のとこに赤ちゃん届けてチヤホヤされてぇ…。", "Ah...I want to deliver a baby to a couple who can't have children...")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+		}
+		if ( kaiwa == 2 ) {
+			listmax = 0
+			buff = lang("子育てってノイローゼになるくらい大変ですよ。私が預かりましょうか？", "Parenting is so hard that it makes me have a nervous breakdown. Shall I take care of the baby?")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strbye
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+		}
+		goto *chat_end
+		goto *chat_unique_SWEND1
+		_switch_sw++
+	}
 	if ( _switch_val == 1024 | _switch_sw ) {
 		_switch_sw = 0
 		if ( gdata(GDATA_FLAG_MAIN) < 1000 ) {
 			listmax = 0
 			buff = lang("あはは。もし" + _onii(cdata(CDATA_SEX, CHARA_PLAYER)) + "さんが自分の物語を終わらせたら、アイメが楽しいお話をきかせてあげるねー。", "Sorry, this is untranslated sentence.")
@@ -38288,11 +38340,11 @@
 						dmghp cnt, cdata(CDATA_MAX_HP, cnt), DAMAGE_FROM_JALDABAOTH
 						dmghp cnt, cdata(CDATA_MAX_HP, cnt), DAMAGE_FROM_JALDABAOTH
 					}
 				}
 				map(cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt), MAP_CHARA_INDEX_PLUS_ONE) = 0
-				cdata(CDATA_AREA, cnt) = AREA_NONE
+				cdata(CDATA_AREA, cnt) = 0
 			loop
 			tc = CHARA_PLAYER
 			repeat 200
 				p = -1, 1
 				cdata(CDATA_X_NEW, tc) = cdata(CDATA_X, tc) + (3 - cnt / 70 + rnd(5)) * p(rnd(2))
@@ -40796,11 +40848,11 @@
 					}
 				}
 				break
 			loop
 			gbui = 0
-			gosub *calcBodyFix
+			gosub *label_3962
 			r1 = c
 			gosub *charaRefresh
 			cbitmod CHARA_BIT_ALTERED_LIMBS, c, TRUE
 			snd SOUNDLIST_COMPLETE1
 			txt lang("「完了だ。馴染み具合にも問題はないだろう」", "Sorry, this is untranslated sentence.")
@@ -42077,11 +42129,11 @@
 			goto *chat_end
 		}
 	}
 	return 1
 
-*chat_unique_enthumesis
+*label_6617
 	listmax = 0
 	buff = lang("累計放出量から予測した状態を、ソピアーから聞いていたが…それよりもだいぶ弱っているようだ。", "Sorry, this is untranslated sentence.")
 	tc = tc * (findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD) == 0) + (findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD) != 0) * findchara(CREATURE_ID_BLACK_GAUNTLET_LEOLD)
 	list(0, listmax) = 0
 	listn(0, listmax) = strmore
@@ -42658,11 +42710,11 @@
 				dmghp cnt, cdata(CDATA_MAX_HP, cnt), DAMAGE_FROM_JALDABAOTH
 				dmghp cnt, cdata(CDATA_MAX_HP, cnt), DAMAGE_FROM_JALDABAOTH
 			}
 		}
 		map(cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt), MAP_CHARA_INDEX_PLUS_ONE) = 0
-		cdata(CDATA_AREA, cnt) = AREA_NONE
+		cdata(CDATA_AREA, cnt) = 0
 	loop
 	tc = CHARA_PLAYER
 	repeat 200
 		p = -1, 1
 		cdata(CDATA_X_NEW, tc) = cdata(CDATA_X, tc) + (3 - cnt / 70 + rnd(5)) * p(rnd(2))
@@ -43635,15 +43687,15 @@
 
 *chat_default
 	listmax = 0
 	if ( tag == 0 ) {
 		if ( buff == "" ) {
-			gosub *random_talk
+			gosub *label_0427
 			if ( evochat == 0 ) {
 				customtalk tc, DBMODE_FLAVOR_DIALOG
 				if ( stat ) {
-					gosub *convert_word
+					gosub *label_0416
 				}
 			}
 			else {
 				if ( cdata(CDATA_EVOCHAT_POINTS, tc) >= 10 ) {
 					hyouzyou = 3
@@ -43911,11 +43963,11 @@
 			wadai++
 		}
 		if ( hyouzyou2 == 111 ) {
 			customtalk tc, DBMODE_FLAVOR_TAG_EVO
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( tag \ 2 == 1 ) {
 					if ( wadai \ 2 == 0 ) {
 						buff = lang("(少し照れながらパートナーに耳打ちしている)", "(" + name(tc) + " seems to be a little pounding.)")
@@ -43935,11 +43987,11 @@
 			}
 		}
 		if ( hyouzyou2 == 110 ) {
 			customtalk tc, DBMODE_FLAVOR_TAG
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( tag \ 2 == 1 ) {
 					if ( wadai \ 2 == 0 ) {
 						buff = lang("(話に困って、しょうもないジョークを言い始めた…)", "(" + name(tc) + " seems to be a little pounding.)")
@@ -43996,11 +44048,11 @@
 			hyouzyou = 3
 		}
 		if ( hyouzyou == 0 ) {
 			customtalk tc, DBMODE_FLAVOR_DIALOG_B
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			else {
 				if ( rnd(2) == 0 ) {
 					buff = lang("(" + name(tc) + "は少し緊張しているようだ)", "(" + name(tc) + " seems to be a little pounding.)")
 				}
@@ -44010,11 +44062,11 @@
 			}
 		}
 		if ( hyouzyou == 2 ) {
 			customtalk tc, DBMODE_FLAVOR_DIALOG_E
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			else {
 				if ( rnd(2) == 0 ) {
 					buff = lang("(" + name(tc) + "は反応に困っている…)", "(" + name(tc) + " seems to be embarrassment.)")
 				}
@@ -44024,11 +44076,11 @@
 			}
 		}
 		if ( hyouzyou == 1 ) {
 			customtalk tc, DBMODE_FLAVOR_DIALOG_F
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			else {
 				if ( rnd(2) == 0 ) {
 					buff = lang("(" + name(tc) + "は喜んでいる！)", "(" + name(tc) + " is pleased.)")
 				}
@@ -44039,11 +44091,11 @@
 		}
 		if ( hyouzyou == 3 ) {
 			snd SOUNDLIST_MIND000
 			customtalk tc, DBMODE_FLAVOR_DIALOG_H
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			else {
 				if ( rnd(2) == 0 ) {
 					buff = lang("(" + name(tc) + "は幸せな表情であなたをじっと見ている)", "(" + name(tc) + " is staring at you in a happy expression.)")
 				}
@@ -44063,11 +44115,11 @@
 			msgtemp = "  "
 			msg_newline
 			msgtemp = "  "
 			customtalk tc, DBMODE_FLAVOR_HUG
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( rnd(3) == 0 ) {
 					txt lang(name(tc) + "は力を抜いた…。", name(tc) + " seems to be a little pounding.")
 				}
@@ -44090,11 +44142,11 @@
 			msgtemp = "  "
 			msg_newline
 			msgtemp = "  "
 			customtalk tc, DBMODE_FLAVOR_NADE
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( rnd(3) == 0 ) {
 					txt lang(name(tc) + "はリラックスしているようだ。", name(tc) + " seems to be a little relax.")
 				}
@@ -44117,11 +44169,11 @@
 			msgtemp = "  "
 			msg_newline
 			msgtemp = "  "
 			customtalk tc, DBMODE_FLAVOR_KISS
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( rnd(3) == 0 ) {
 					txt lang(name(tc) + "はうっとりしている…。", name(tc) + " is staring at you in a happy expression.")
 				}
@@ -44144,11 +44196,11 @@
 			msgtemp = "  "
 			msg_newline
 			msgtemp = "  "
 			customtalk tc, DBMODE_FLAVOR_DIALOG_E
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( rnd(3) == 0 ) {
 					txt lang(name(tc) + "は呆気にとられている。", name(tc) + " seems to be embarrassment.")
 				}
@@ -44171,11 +44223,11 @@
 			msgtemp = "  "
 			msg_newline
 			msgtemp = "  "
 			customtalk tc, DBMODE_FLAVOR_EX_REACT
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( rnd(3) == 0 ) {
 					txt lang(name(tc) + "は悪戯っぽい表情を浮かべた。", name(tc) + " is staring at you in a happy expression.")
 				}
@@ -44221,28 +44273,30 @@
 				txtef COLOR_PINK
 				snd SOUNDLIST_HEART1
 				cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
 				customtalk tc, DBMODE_FLAVOR_MIZU_ASOBI_END
 				if ( stat ) {
-					gosub *convert_word
+					gosub *label_0416
 				}
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						txt "「とてもよかった" + _yo(3) + "」", "「す、すごすぎる" + _yo(3) + "」", "「も、もうだめ" + _da(3) + "」", "「こ、心地よかった" + _yo(3) + "」", "「さ、最高" + _da(3) + "」"
 					}
 					if ( en ) {
 						txt "\"You are awesome!", "\"Oh my god....", "\"Okay, okay, you win!", "\"Holy...!"
 					}
 				}
+				gain_iden tc, 0, 15
+				gain_iden 0, tc, 15
 				gosub *music_play
 				goto *chat_end
 				return
 			}
 			txtef COLOR_PINK
 			customtalk tc, DBMODE_FLAVOR_MIZU_ASOBI
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( jp ) {
 					txt "「ぬれてるぅ」", "「びちゃびちゃ…」", "「うれしい、でも…」", "「ふぅふぅ」", "「うふふふ」"
 				}
@@ -44431,10 +44485,26 @@
 					if ( cbit(CHARA_BIT_NECRO, tc) == FALSE ) {
 						if ( cbit(CHARA_BIT_LIVESTOCK, tc) == FALSE ) {
 							list(0, listmax) = 34
 							listn(0, listmax) = lang("街で待機しろ", "Wait at the town.")
 							listmax++
+							if ( cbit(1034, tc) == TRUE ) {
+								if ( cdata(CDATA_FRIENDSHIP, tc) >= 10 ) {
+									if ( cdata(CDATA_LEVEL, tc) > (6 + cdata(CDATA_SPRITE_SIZE_MILK, tc)) * 10 | cdata(CDATA_AGE, tc) <= gdata(GDATA_YEAR) - 3 * (6 + cdata(CDATA_SPRITE_SIZE_MILK, tc)) ) {
+										list(0, listmax) = 114
+										listn(0, listmax) = lang("【子供が成長したことを認める】", "<Acknowledge child's growth>")
+										listmax++
+									}
+								}
+								if ( cdata(CDATA_FRIENDSHIP, tc) < 10 ) {
+									if ( cdata(CDATA_INTEREST, tc) >= 80 ) {
+										list(0, listmax) = 113
+										listn(0, listmax) = lang("【教育に投資】", "<Invest in education>")
+										listmax++
+									}
+								}
+							}
 							if ( cdata(CDATA_EVOCHAT_POINTS, CHARA_PLAYER) > 0 & cdata(CDATA_EVOCHAT_POINTS, tc) < 10 & cdata(CDATA_IMPRESSION, tc) >= 100 ) {
 								list(0, listmax) = 77
 								listn(0, listmax) = lang("【evochat】", "<evochat>")
 								listmax++
 								if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
@@ -44459,21 +44529,21 @@
 							if ( cdata(CDATA_PRAY, tc) == 0 ) {
 								list(0, listmax) = 67
 								listn(0, listmax) = lang("大事な仲間に指定", "Designated as precious ally.")
 								listmax++
 							}
-							if ( cdata(CDATA_PRAY, tc) == 1 ) {
+							if ( cdata(CDATA_PRAY, tc) != 0 ) {
 								list(0, listmax) = 68
 								listn(0, listmax) = lang("大事な仲間指定を解除", "Cancel precious ally specified.")
 								listmax++
 							}
-							if ( cdata(CDATA_TAMER_WHIP_PICKUP, tc) != 10 ) {
+							if ( cbit(1032, tc) != TRUE ) {
 								list(0, listmax) = 71
 								listn(0, listmax) = lang("足元のアイテム我慢", "Don't pick up items off the ground.")
 								listmax++
 							}
-							if ( cdata(CDATA_TAMER_WHIP_PICKUP, tc) == 10 ) {
+							if ( cbit(1032, tc) == TRUE ) {
 								list(0, listmax) = 72
 								listn(0, listmax) = lang("アイテム我慢解除", "Do as you like with items on the ground.")
 								listmax++
 							}
 							if ( cdata(CDATA_MASTER_SERVANT, tc) >= 150 ) {
@@ -45376,20 +45446,20 @@
 		goto *chat_end
 	}
 
 
 	if ( chatval == 85 ) {
-*label_6633
+*label_6643
 		if ( 1 == 0 ) {
-			goto *label_6635
+			goto *label_6645
 		}
 		txtnew
 		txt lang("誰を追い出す？", "Who do you drive out?")
 		allyctrl = 3
-		gosub *com_listNpc
+		gosub *label_5444
 		if ( stat == (-1) ) {
-			goto *label_6635
+			goto *label_6645
 		}
 		hometc = stat
 		txt lang(cdatan(CDATAN_NAME, hometc) + "を追い出した。", cdatan(CDATAN_NAME, hometc) + " " + is(tc) + " moved to the location.")
 		snd SOUNDLIST_BASH1
 		if ( cdata(CDATA_ID, hometc) == CREATURE_ID_IMARITUKA_THE_ZASIKI_WARAI ) {
@@ -45542,11 +45612,11 @@
 			goto *chat_default
 		}
 		tcbk = tc
 		txt lang("選択した冒険者の詳細を確認できる。", "If you select an adventurer, you can see the details.")
 		csctrl = 4
-		gosub *com_listAdv
+		gosub *label_5471
 		goto *chat_end
 	}
 	if ( chatval == 19 ) {
 		if ( cdata(CDATA_GOLD, CHARA_PLAYER) < calcrestorecost() ) {
 			buff = strnogold
@@ -45879,35 +45949,35 @@
 		ti = stat
 		item_copy deliver(1), ti
 		inv(INV_ITEM_NUM, ti) = 1
 		ci = ti
 		rc = tc
-		gosub *chara_item
+		gosub *label_8914
 		rq = deliver
 		inv(INV_ITEM_NUM, deliver(1))--
 		txt lang(itemname(deliver(1), 1) + "を手渡した。", "You hand over " + itemname(deliver(1), 1) + ".")
 		val = 3
 		gosub *talk_quest
 		gosub *quest_success
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *chat_default
 	}
 	if ( chatval == 26 ) {
 		gosub *chara_adjustInv
 		ti = stat
 		item_copy supply, ti
 		inv(INV_ITEM_NUM, ti) = 1
 		cbitmod CHARA_BIT_POISON_FLAG, tc, TRUE
 		ci = ti
 		rc = tc
-		gosub *chara_item
+		gosub *label_8914
 		inv(INV_ITEM_NUM, supply)--
 		txt lang(itemname(supply, 1) + "を手渡した。", "You hand over " + itemname(supply, 1) + ".")
 		val = 3
 		gosub *talk_quest
 		gosub *quest_success
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *chat_default
 	}
 	if ( chatval == 30 ) {
 		csctrl = 3
 		goto *chat_train
@@ -45976,11 +46046,11 @@
 				chatesc = 1
 				gosub *chat_select
 				modkarma 0, -5
 			}
 		}
-		gosub *calcBurdenPc
+		gosub *label_4102
 		buff = ""
 		goto *chat_default
 	}
 	if ( chatval == 33 ) {
 		allyctrl = 0
@@ -46020,11 +46090,11 @@
 			if ( chatval == 1 ) {
 				snd SOUNDLIST_PAYGOLD1
 				cdata(CDATA_GOLD, CHARA_PLAYER) -= calcresurrectvalue(rc)
 				buff = lang("(バーテンが店の奥から" + name(rc) + "を連れてきた)" + _dozo(), "(" + name(tc) + " brings " + name(rc) + " from the stable.) There you go.")
 				cdata(CDATA_CAN_REVIVE, rc)--
-				gosub *resurrect_ally
+				gosub *label_4138
 			}
 			else {
 				buff = lang("冷やかし" + _ka(1), "You kidding? ")
 			}
 		}
@@ -46057,11 +46127,11 @@
 			cdata(CDATA_RIDING, gdata(GDATA_RIDER)) = 0
 			ride_end
 		}
 		map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_CHARA_INDEX_PLUS_ONE) = 0
 		cdata(CDATA_EXIST, tc) = CHAR_STATE_ALLY_WAIT
-		cdata(CDATA_AREA, tc) = AREA_NONE
+		cdata(CDATA_AREA, tc) = 0
 		if ( cdata(CDATA_IN_TAGTEAM, tc) == (-1) ) {
 			ttc = cdata(CDATA_TAGTEAM_PARTNER, tc)
 			cell_setchara ttc, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
 			tag_end tc
 		}
@@ -46073,11 +46143,11 @@
 		goto *chat_end
 	}
 	if ( chatval == 66 ) {
 		txt lang(name(tc) + "は冒険の途中で集めたマテリアルを手渡してきた。", "You order " + name(tc) + " to wait at the town.")
 		customtalk tc, DBMODE_FLAVOR_MATERIAL
-		gosub *convert_word
+		gosub *label_0416
 		msg_halt
 		snd SOUNDLIST_ALERT1
 		snd SOUNDLIST_ALERT1
 		snd SOUNDLIST_ALERT1
 		m1 = 0
@@ -46382,11 +46452,11 @@
 		m5 = 0
 		m6 = 0
 		m7 = 0
 		customtalk tc, DBMODE_FLAVOR_DIALOG
 		if ( stat ) {
-			gosub *convert_word
+			gosub *label_0416
 		}
 		goto *chat_default
 	}
 	if ( chatval == 76 ) {
 		goto *evochat_portrait
@@ -46831,11 +46901,11 @@
 		if ( scenemode ) {
 			if ( scene_cut == 1 ) {
 				goto *chat_end
 			}
 		}
-		cdata(CDATA_TAMER_WHIP_PICKUP, tc) = 10
+		cbitmod 1032, tc, TRUE
 		goto *chat_end
 	}
 	if ( chatval == 72 ) {
 		listmax = 0
 		buff = lang("(" + name(tc) + "に、足元のアイテムを我慢しなくていいことを伝えた)", "(You told that there is no need to endure items of the ground)")
@@ -46848,11 +46918,11 @@
 		if ( scenemode ) {
 			if ( scene_cut == 1 ) {
 				goto *chat_end
 			}
 		}
-		cdata(CDATA_TAMER_WHIP_PICKUP, tc) = 0
+		cbitmod 1032, tc, FALSE
 		goto *chat_end
 	}
 	if ( chatval == 35 ) {
 		listmax = 0
 		buff = lang("(" + name(tc) + "は悲しそうな目であなたを見ている。本当に縁を切る？)", "(" + name(tc) + " looks at you sadly. Really abandon " + him(tc) + "? )")
@@ -46864,10 +46934,13 @@
 		listmax++
 		chatesc = 1
 		gosub *chat_select
 		if ( chatval == 1 ) {
 			txt lang("" + name(tc) + "と別れた…", "You abandoned " + name(tc) + "...")
+			if ( tc == gdata(GDATA_RIDER) ) {
+				ride_end
+			}
 			map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_CHARA_INDEX_PLUS_ONE) = 0
 			if ( cdata(CDATA_IN_TAGTEAM, tc) == (-1) ) {
 				ttc = cdata(CDATA_TAGTEAM_PARTNER, tc)
 				cell_setchara ttc, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
 				tag_end tc
@@ -46925,11 +46998,11 @@
 				if ( scene_cut == 1 ) {
 					goto *chat_end
 				}
 			}
 			inv(INV_ITEM_NUM, ci)--
-			gosub *calcBurdenPc
+			gosub *label_4102
 			snd SOUNDLIST_DING3
 			skillexp SKILL_ATTR_PER, CHARA_PLAYER, 30
 			skillexp SKILL_ATTR_PER, tc, 30
 			modimp2 tc, 10
 			cdata(CDATA_INTEREST, tc) -= 30
@@ -47009,10 +47082,193 @@
 			goto *chat_end
 		}
 		buff = ""
 		goto *chat_default
 	}
+	if ( chatval == 114 ) {
+		if ( cdata(CDATA_AGE, tc) >= gdata(GDATA_YEAR) - 3 * (6 + cdata(CDATA_SPRITE_SIZE_MILK, tc)) ) {
+			cdata(CDATA_AGE, tc) = gdata(GDATA_YEAR) - 3 * (6 + cdata(CDATA_SPRITE_SIZE_MILK, tc))
+		}
+		cdata(CDATA_SPRITE_SIZE_MILK, tc)++
+		cdata(CDATA_FRIENDSHIP, tc) = 0
+		snd SOUNDLIST_DING1
+		listmax = 0
+		buff = lang("(" + cdatan(CDATAN_NAME, tc) + "は、自分が少し大人に近づいたことを実感した！)", "(" + cdatan(CDATAN_NAME, tc) + " realized a little more grown-up!)")
+		tc = tc * (0 == 0) + (0 != 0) * 0
+		list(0, listmax) = 0
+		listn(0, listmax) = strmore
+		listmax++
+		chatesc = 1
+		gosub *chat_select
+		if ( scenemode ) {
+			if ( scene_cut == 1 ) {
+				goto *chat_end
+			}
+		}
+		if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-1) ) {
+			cdata(CDATA_TONE, tc) = rnd(7)
+			cdata(CDATA_TONE_SEX, tc) = rnd(2) + 1
+			txtef COLOR_YELLOW
+			txt lang(cdatan(CDATAN_NAME, child) + "の雰囲気が少し変わった気がする…。", "You feel like the atmosphere has changed a little...")
+		}
+		if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == 0 ) {
+			snd SOUNDLIST_DING3
+			cbitmod 1034, tc, FALSE
+			listmax = 0
+			buff = lang("(" + cdatan(CDATAN_NAME, tc) + "はもう一人前だ！)", "(" + cdatan(CDATAN_NAME, tc) + " has grown well!)")
+			tc = tc * (0 == 0) + (0 != 0) * 0
+			list(0, listmax) = 0
+			listn(0, listmax) = strmore
+			listmax++
+			chatesc = 1
+			gosub *chat_select
+			if ( scenemode ) {
+				if ( scene_cut == 1 ) {
+					goto *chat_end
+				}
+			}
+		}
+		goto *chat_end
+	}
+	if ( chatval == 113 ) {
+		cost = 10000
+		buff = lang("(" + cdatan(CDATAN_NAME, tc) + "の教育に" + cost + "goldを投資する？)", "(Invest " + cost + " gold pieces in " + cdatan(CDATAN_NAME, tc) + " education?)")
+		list(0, listmax) = 0
+		listn(0, listmax) = lang("やめておく", "Cancel")
+		listmax++
+		if ( cdata(CDATA_GOLD, CHARA_PLAYER) >= cost ) {
+			list(0, listmax) = 1
+			listn(0, listmax) = lang("興味のあることをやらせる(効果増)", "Invest in entrusting skills(EXP up).")
+			listmax++
+		}
+		if ( cdata(CDATA_GOLD, CHARA_PLAYER) >= cost ) {
+			list(0, listmax) = 2
+			listn(0, listmax) = lang("修行スキルの教育に投資する", "Invest in training skills.")
+			listmax++
+		}
+		if ( cdata(CDATA_GOLD, CHARA_PLAYER) >= cost ) {
+			list(0, listmax) = 3
+			listn(0, listmax) = lang("戦闘スキルの教育に投資する", "Invest in combat skills.")
+			listmax++
+		}
+		if ( cdata(CDATA_GOLD, CHARA_PLAYER) >= cost ) {
+			list(0, listmax) = 4
+			listn(0, listmax) = lang("仕事スキルの教育に投資する", "Invest in jobs skills.")
+			listmax++
+		}
+		if ( cdata(CDATA_GOLD, CHARA_PLAYER) >= cost ) {
+			list(0, listmax) = 5
+			listn(0, listmax) = lang("探索スキルの教育に投資する", "Invest in exploration skills.")
+			listmax++
+		}
+		if ( cdata(CDATA_GOLD, CHARA_PLAYER) >= cost ) {
+			list(0, listmax) = 6
+			listn(0, listmax) = lang("勉強スキルの教育に投資する", "Invest in study skills.")
+			listmax++
+		}
+		chatesc = 1
+		gosub *chat_select
+		if ( chatval == 0 ) {
+			buff = lang("冷やかし" + _ka(1), "You kidding? ")
+			goto *chat_default
+		}
+		snd SOUNDLIST_PAYGOLD1
+		cdata(CDATA_GOLD, CHARA_PLAYER) -= cost
+		cdata(CDATA_FRIENDSHIP, tc)++
+		gosub *expInvesting
+		cdata(CDATA_INTEREST, tc) -= 80
+		if ( 0 ) {
+			cdata(CDATA_INTEREST, tc) += 80
+		}
+		buff = lang(_thanks(2), "Thanks!")
+		kitae = 300 + sdata(SKILL_ATTR_LER, CHARA_PLAYER) / 20
+		gdata(GDATA_SENSE_OBJECT) = 1
+		if ( chatval == 1 ) {
+			modimp tc, 2
+			kitae = kitae * 2
+			repeat 15
+				repeat
+					p = rnd(400 - 100) + 100
+					if ( sdataref(SKILL_DATAREF_USE, p) != SKILL_NONE ) {
+						if ( sorg(p, tc) == 0 ) {
+							continue
+						}
+						skillexp p, tc, kitae
+						break
+					}
+				loop
+			loop
+		}
+		if ( chatval == 2 ) {
+			skillexp SKILL_NORMAL_WEIGHT_LIFTING, tc, kitae
+			skillexp SKILL_NORMAL_HEALING, tc, kitae
+			skillexp SKILL_NORMAL_MEDITATION, tc, kitae
+			skillexp SKILL_NORMAL_MAGIC_CAPACITY, tc, kitae
+			skillexp SKILL_NORMAL_HEAVY_ARMOR, tc, kitae
+			skillexp SKILL_NORMAL_MEDIUM_ARMOR, tc, kitae
+			skillexp SKILL_NORMAL_LIGHT_ARMOR, tc, kitae
+			skillexp SKILL_NORMAL_FAITH, tc, kitae
+		}
+		if ( chatval == 3 ) {
+			skillexp SKILL_WEAPON_LONGSWORD, tc, kitae
+			skillexp SKILL_WEAPON_SHORTSWORD, tc, kitae
+			skillexp SKILL_WEAPON_AXE, tc, kitae
+			skillexp SKILL_WEAPON_BLUNT, tc, kitae
+			skillexp SKILL_WEAPON_POLEARM, tc, kitae
+			skillexp SKILL_WEAPON_STAVE, tc, kitae
+			skillexp SKILL_WEAPON_MARTIAL_ARTS, tc, kitae
+			skillexp SKILL_WEAPON_SCYTHE, tc, kitae
+			skillexp SKILL_WEAPON_BOW, tc, kitae
+			skillexp SKILL_WEAPON_CROSSBOW, tc, kitae
+			skillexp SKILL_WEAPON_FIREARM, tc, kitae
+			skillexp SKILL_WEAPON_THROWING, tc, kitae
+			skillexp SKILL_NORMAL_TACTICS, tc, kitae
+			skillexp SKILL_NORMAL_DUAL_WIELD, tc, kitae
+			skillexp SKILL_NORMAL_TWO_HAND, tc, kitae
+			skillexp SKILL_NORMAL_TWO_HAND, tc, kitae
+			skillexp SKILL_NORMAL_SHIELD, tc, kitae
+			skillexp SKILL_NORMAL_EVASION, tc, kitae
+			skillexp SKILL_NORMAL_EYE_OF_MIND, tc, kitae
+			skillexp SKILL_NORMAL_GREATER_EVASION, tc, kitae
+			skillexp SKILL_NORMAL_MARKSMAN, tc, kitae
+		}
+		if ( chatval == 4 ) {
+			skillexp SKILL_NORMAL_NEGOTIATION, tc, kitae
+			skillexp SKILL_NORMAL_INVESTING, tc, kitae
+			skillexp SKILL_NORMAL_CARPENTRY, tc, kitae
+			skillexp SKILL_NORMAL_TAILORING, tc, kitae
+			skillexp SKILL_NORMAL_ALCHEMY, tc, kitae
+			skillexp SKILL_NORMAL_JEWELER, tc, kitae
+			skillexp SKILL_NORMAL_GARDENING, tc, kitae
+			skillexp SKILL_NORMAL_PERFORMER, tc, kitae
+			skillexp SKILL_NORMAL_COOKING, tc, kitae
+			skillexp SKILL_NORMAL_FISHING, tc, kitae
+			skillexp SKILL_ACTIVE_PICKPOCKET, tc, kitae
+		}
+		if ( chatval == 5 ) {
+			skillexp SKILL_NORMAL_STEALTH, tc, kitae
+			skillexp SKILL_NORMAL_LOCK_PICKING, tc, kitae
+			skillexp SKILL_NORMAL_DETECTION, tc, kitae
+			skillexp SKILL_NORMAL_MINING, tc, kitae
+			skillexp SKILL_NORMAL_DISARM_TRAP, tc, kitae
+			skillexp SKILL_NORMAL_TRAVELING, tc, kitae
+			skillexp SKILL_NORMAL_SWIMMING, tc, kitae
+			skillexp SKILL_ACTIVE_RIDING, tc, kitae
+		}
+		if ( chatval == 6 ) {
+			skillexp SKILL_NORMAL_LITERACY, tc, kitae
+			skillexp SKILL_NORMAL_GENE_ENGINEER, tc, kitae
+			skillexp SKILL_NORMAL_ANATOMY, tc, kitae
+			skillexp SKILL_NORMAL_SENSE_QUALITY, tc, kitae
+			skillexp SKILL_NORMAL_MEMORIZATION, tc, kitae
+			skillexp SKILL_NORMAL_CASTING, tc, kitae
+			skillexp SKILL_NORMAL_MAGIC_DEVICE, tc, kitae
+			skillexp SKILL_NORMAL_CONTROL_MAGIC, tc, kitae
+		}
+		gdata(GDATA_SENSE_OBJECT) = 0
+		goto *chat_default
+	}
 	if ( chatval == 37 ) {
 		allyctrl = 1
 		gosub *com_ally
 		if ( stat != (-1) ) {
 			rc = stat
@@ -48385,11 +48641,11 @@
 				goto *chat_end
 			}
 		}
 		tcbk = tc
 		csctrl = 5
-		gosub *com_listAdv
+		gosub *label_5471
 		goto *chat_end
 	}
 	if ( chatval == 82 ) {
 		if ( gdata(GDATA_FLAG_INFORMER_BIRTHDAY_MONTH) == 0 | gdata(GDATA_FLAG_INFORMER_BIRTHDAY_DAY) == 0 ) {
 			buff = lang("後で変更できないけど大丈夫" + _ka(1), "It can not be changed later. OK?")
@@ -48543,11 +48799,11 @@
 			cc = tcbk
 			gosub *insta_eat
 			cdata(CDATA_EMO_ICON, tc) = 6 + 100 * 3
 			customtalk tcbk, DBMODE_FLAVOR_MEAL
 			if ( stat ) {
-				gosub *convert_word
+				gosub *label_0416
 			}
 			else {
 				kaiwa = rnd(3)
 				if ( inv(INV_ITEM_PARAM2, ci) < 8 ) {
 					if ( kaiwa == 0 ) {
@@ -48743,14 +48999,14 @@
 				goto *chat_default
 			}
 			rc = tc
 			gosub *add_ally
 			cdata(CDATA_ROLE, rc) = ROLE_NONE
-			cdata(CDATA_AREA, rc) = AREA_NONE
+			cdata(CDATA_AREA, rc) = 0
 			cdata(CDATA_IMPRESSION, tc) = 100
 			rc = oc
-			gosub *adv_generate
+			gosub *label_8908
 			goto *chat_end
 		}
 		buff = lang(_kimi(3) + "の仲間になれと？悪い" + _ga(3) + "お断り" + _da(), "Huh? What made you think I'd want to join you? I don't even know you well.")
 		goto *chat_default
 	}
@@ -48865,11 +49121,11 @@
 		if ( scenemode ) {
 			if ( scene_cut == 1 ) {
 				goto *chat_end
 			}
 		}
-		gosub *sexsex
+		gosub *label_6019
 		goto *chat_end
 	}
 	if ( chatval == 58 ) {
 		if ( gdata(GDATA_TIME_STOP_TIME) == 0 & gdata(GDATA_FLAG_STOP_TIME_OTHER) == 0 ) {
 			gdata(GDATA_FLAG_HOUSE_VISITORS)++
@@ -48927,11 +49183,11 @@
 				goto *chat_end
 			}
 		}
 		cc = tc
 		tc = CHARA_PLAYER
-		gosub *sexsex
+		gosub *label_6019
 		cc = CHARA_PLAYER
 		goto *chat_end
 	}
 	if ( chatval == 61 ) {
 		if ( gdata(GDATA_FLAG_MAIN) >= 200 ) {
@@ -49089,21 +49345,21 @@
 			buff = lang("冷やかし" + _ka(1), "You kidding? ")
 		}
 		goto *chat_default
 	}
 	if ( chatval == 113 ) {
-		if ( cbit(CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, tc) == FALSE ) {
+		if ( cbit((974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), tc) == FALSE ) {
 			buff = lang("今は余ってない" + _na(2), "It's not left over now.")
 			goto *chat_default
 		}
 		buff = lang("何に使うのか知らない" + _ga(3) + "…廃棄品なら持って行っていい" + _yo(2), "I don't know what you're going to use it for...Bring what I was supposed to dispose of.")
 		snd SOUNDLIST_TM2_SWITCH001
 		plug = 5 + limit(cdata(CDATA_ROLE_SHOP_LEVEL, tc), 1, 200) / 10
 		gdata(GDATA_FLAG_TOTAL_POTION_PLUGS) += plug
 		txtef COLOR_GREEN
 		txt lang("ポーションの栓を" + plug + "個手に入れた。[残り" + gdata(GDATA_FLAG_TOTAL_POTION_PLUGS) + "個]", name(0) + " get " + plug + " potion plugs.[Remaining plug " + gdata(GDATA_FLAG_TOTAL_POTION_PLUGS) + "]")
-		cbitmod CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, tc, FALSE
+		cbitmod (974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), tc, FALSE
 		goto *chat_default
 	}
 	if ( chatval == 64 ) {
 		invsubroutine = 1
 		invctrl = INVCTRL_MATERIAL_ENCHANT, 18
@@ -49598,11 +49854,11 @@
 					gdata(GDATA_CARGO_LIMIT) -= 30 * 1000
 				}
 				if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 4 ) {
 					gdata(GDATA_CARGO_LIMIT) -= 100 * 1000
 				}
-				gosub *calcBurdenPc
+				gosub *label_4102
 				gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) = 0
 				snd SOUNDLIST_AMMO
 				listmax = 0
 				buff = lang("じゃあ後はこっちで手続きしておく" + _yo(3) + "。", "understood. I will handle.")
 				tc = tc * (0 == 0) + (0 != 0) * 0
@@ -51863,29 +52119,29 @@
 			cbitmod CHARA_BIT_BODYGUARD, rc, TRUE
 			qdata(QDATA_PARAM2, rq) = cdata(CDATA_ID, rc)
 		}
 		qdata(QDATA_STATE, rq) = QUEST_STATE_ONGOING
 		if ( qdata(QDATA_DEADLINE, rq) == (-1) ) {
-			goto *chat_instaQuest
+			goto *label_6675
 		}
 		buff = lang(_thanks() + "期待してい" + _ru(), "Thanks. I'm counting on you.")
 		if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_DELIVER ) {
 			qdata(QDATA_QUEST_TARGET, qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq))++
 			flt
 			itemcreate CHARA_PLAYER, qdata(QDATA_DEST_ITEM, rq), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 			txt lang(itemname(ci, 1) + "をバックパックに入れた。", "You put " + itemname(ci, 1) + " in your backpack.")
 			snd SOUNDLIST_INV
-			gosub *calcBurdenPc
+			gosub *label_4102
 			buff = lang("これが依頼の品物" + _da() + "期限には十分気をつけて" + _kure(), "Here's the package. Be aware of the deadline. I don't want to report you to the guards.")
 		}
 	}
 	else {
 		buff = lang("冷やかし" + _ka(1), "You kidding? ")
 	}
 	goto *chat_default
 
-*chat_instaQuest
+*label_6675
 	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_HUNT | qdata(QDATA_EXIST, rq) == QUEST_TYPE_HUNTEX ) {
 		listmax = 0
 		buff = lang("では、早速案内するので、モンスターを一匹残らず退治して" + _kure(), "Great! I'll guide you to the place, kill them all!")
 		tc = tc * (0 == 0) + (0 != 0) * 0
 		list(0, listmax) = 0
@@ -52610,14 +52866,32 @@
 	}
 	font lang(cfg_font1, cfg_font2), 10 - en * 2, 0
 	color 0, 0, 0
 	if ( scenemode == FALSE & evochat < 2 ) {
 		if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) < 0 ) {
-			pos wx + 35, wy + 160
+			pos wx + 35, wy + 157
 			mes lang("size:" + cdata(CDATA_SPRITE_SIZE_MILK, tc) + " ", "size:" + cdata(CDATA_SPRITE_SIZE_MILK, tc) + " ")
 		}
-		display_topic lang("友好", "Impress"), wx + 28, wy + 170
+		if ( cbit(1034, tc) == TRUE ) {
+			pos wx + 35, wy + 168
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-5) ) {
+				mes lang("幼年期", "baby phase")
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-4) ) {
+				mes lang("嫌々期", "NO phase")
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-3) ) {
+				mes lang("幼少期", "infancy phase")
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-2) ) {
+				mes lang("成長期", "growth phase")
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-1) ) {
+				mes lang("思春期", "puberty phase")
+			}
+		}
+		display_topic lang("友好", "Impress"), wx + 28, wy + 173
 		if ( evochat == 0 ) {
 			display_topic lang("興味", "Attract"), wx + 28, wy + 225
 			if ( cbit(CHARA_BIT_HIRED, tc) != FALSE ) {
 				display_topic lang("期限", "Duration"), wx + 28, wy + 280
 			}
@@ -52810,11 +53084,11 @@
 			mes s
 		loop
 	}
 	return
 
-*shop_init
+*label_6695
 	if ( tc > CHARA_PLAYER ) {
 		if ( cdata(CDATA_ROLE, tc) == ROLE_SHOP_TRADE ) {
 			gosub *shop_tradePrice
 		}
 	}
@@ -52828,17 +53102,17 @@
 		}
 		else {
 			gdata(GDATA_COUNT_SHOP)++
 			cdata(CDATA_ROLE_FILE_ID, tc) = gdata(GDATA_COUNT_SHOP)
 		}
-		gosub *shop_restock
+		gosub *label_6698
 	}
 	else {
 		file = "shop" + invfile + ".s2"
 		existwrapper exedir + "tmp\\" + file
 		if ( strsize == (-1) | gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 >= cdata(CDATA_ROLE_RESTOCK, tc) ) {
-			gosub *shop_restock
+			gosub *label_6698
 		}
 		else {
 			fmode = 3
 			gosub *game_ctrlFile
 		}
@@ -52870,11 +53144,11 @@
 	fmode = 3
 	gosub *game_ctrlFile
 	mode = MODELIST_MAIN
 	return
 
-*shop_restock
+*label_6698
 	inv_getheader -1
 	repeat invrange, invhead
 		inv(INV_ITEM_NUM, cnt) = 0
 	loop
 	p = 40 + cdata(CDATA_ROLE_SHOP_LEVEL, tc) * 2 / 3
@@ -53811,11 +54085,11 @@
 		trate(cnt) += rnd(15) - rnd(15)
 	loop
 	randomize
 	return
 
-*renew_economy
+*label_6708
 	if ( initeco ) {
 		gdata(GDATA_CAPITAL) = 15
 	}
 	bkdata = gdata(GDATA_AREA), gdata(GDATA_LEVEL), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
 	snd SOUNDLIST_WRITE1
@@ -54072,11 +54346,11 @@
 	ww = 540
 	wh = 440
 	wx = (windoww - ww) / 2 + inf_screenx
 	wy = winposy(wh)
 
-*com_politics_economy_loop
+*label_6721
 	if ( 1 == 0 ) {
 		goto *com_politics_rule
 	}
 	redraw 0
 	s = strhint2 + strhint3b
@@ -54252,11 +54526,11 @@
 	}
 	if ( key == key_cancel ) {
 		gosub *screen_draw
 		return
 	}
-	goto *com_politics_economy_loop
+	goto *label_6721
 
 *com_politics_rule
 	listmax = 0
 	page = 0
 	pagesize = 13
@@ -54440,11 +54714,11 @@
 	scy = cdata(CDATA_Y, CHARA_PLAYER)
 	gdata(GDATA_AREA) = gdata(GDATA_WORLD)
 	gdata(GDATA_LEVEL) = 1
 	gosub *map_init
 	msgtemp = ""
-	gosub *com_build
+	gosub *label_6735
 	gosub *map_save
 	gdata(GDATA_AREA) = bkdata2(0)
 	gdata(GDATA_LEVEL) = bkdata2(1)
 	cdata(CDATA_X, CHARA_PLAYER) = bkdata2(2)
 	cdata(CDATA_Y, CHARA_PLAYER) = bkdata2(3)
@@ -54452,29 +54726,29 @@
 	mapsubroutine = 1
 	gosub *map_init
 	msgtemp = ""
 	return
 
-*com_build
+*label_6735
 	area = bkdata2
 	city = adata(ADATA_ECONOMY, area)
 	tlocx = adata(ADATA_X, area)
 	tlocy = adata(ADATA_Y, area)
 	tlocinitx = tlocx
 	tlocinity = tlocy
 	scposval = 1
 	cityfov = 3
 	citybuilding = 3
 
-*com_build_WHILE1
+*label_6736
 	if ( 1 == 0 ) {
-		goto *com_build_WEND1
+		goto *label_6739
 	}
 	redraw 0
 	sxfix = 0
 	syfix = 0
-	gosub *screen_setPos
+	gosub *label_3908
 	val = cityfov
 	gosub *los_Loc
 	gosub *los_draw
 	gosub *screen_drawStatus
 	dx = (tlocx - scx) * inf_tiles + inf_screenx
@@ -54511,37 +54785,37 @@
 		loop
 		if ( p >= citybuilding ) {
 			txtnew
 			snd SOUNDLIST_FAIL1
 			txt lang("この街はこれ以上の施設を所有できない。", "The city can't hold any more building.")
-			goto *com_build_WHILE1_CONTINUE
+			goto *label_6738
 		}
 		cell_featread tlocx, tlocy
 		if ( feat(FEAT_CELL_PIC) != 0 ) {
 			txtnew
 			snd SOUNDLIST_FAIL1
 			txt lang("その場所には建てられない。", "You can't build here.")
-			goto *com_build_WHILE1_CONTINUE
+			goto *label_6738
 		}
 		if ( dist(tlocx, tlocy, tlocinitx, tlocinity) < cityfov ) {
 			gosub *com_select_building
 		}
 		else {
 			txtnew
 			snd SOUNDLIST_FAIL1
 			txt lang("その場所は街から離れすぎている。", "This location is too far from the town.")
 		}
-		goto *com_build_WHILE1_CONTINUE
+		goto *label_6738
 	}
 	if ( key == key_cancel ) {
-		goto *com_build_WEND1
+		goto *label_6739
 	}
 
-*com_build_WHILE1_CONTINUE
-	goto *com_build_WHILE1
+*label_6738
+	goto *label_6736
 
-*com_build_WEND1
+*label_6739
 	scposval = 0
 	return
 
 *com_select_building
 	snd SOUNDLIST_CHAT
@@ -54639,11 +54913,11 @@
 		mdata(MDATA_CITY_BUDGET) -= bdref(1, p)
 		snd SOUNDLIST_BUILD1
 		txtnew
 		txt lang(bdrefn(p) + "を建設した！", "You have built a " + bdrefn(p) + "!")
 		bddata(0, city, cbd) = p, tlocx, tlocy, bdref(0, p) + 363
-		gosub *world_refresh
+		gosub *label_4923
 		return p
 	}
 	if ( key == key_pageup ) {
 		if ( pagemax != 0 ) {
 			snd SOUNDLIST_POP1
@@ -54681,10 +54955,6063 @@
 	gcopy BUFFER_INF, 0, 392, 24, 24
 	pos x + 12, y + 7 - en * 2
 	mes lang("予算:", "Budget:") + " " + mdata(MDATA_CITY_BUDGET) + "k gp"
 	return
 
+*label_6750
+	if ( cdatan(CDATAN_RACE, r1) == "kobolt" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_KOBOLT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "orc" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_ORC
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "largeanimal" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_LARGE_ANIMAL
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "lizardman" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_LIZARDMAN
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "minotaur" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_MINOTAUR
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "yerles" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_YERLES
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "norland" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_NORLAND
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "eulderna" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_EULDERNA
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "fairy" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_FAIRY
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "asura" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_ASURA
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "slime" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SLIME
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "doggod" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_DOG_GOD
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "dwarf" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_DWARF
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "juere" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_JUERE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "zombie" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_ZOMBIE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "elea" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_ELEA
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "rabbit" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_RABBIT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "sheep" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SHEEP
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "frog" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_FROG
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "worm" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_WORM
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "snail" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SNAIL
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "mandrake" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_MANDRAKE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "beetle" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_BEETLE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "mushroom" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_MUSHROOM
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "bat" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_BAT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "ent" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_ENT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "lich" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_LICH
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "bacteria" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_BACTERIA
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "ghost" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_GHOST
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "spirit" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SPIRIT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "eye" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_EYE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "mazin" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_MAZIN
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "wasp" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_WASP
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "giant" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_GIANT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "imp" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_IMP
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "hand" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_HAND
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "snake" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SNAKE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "drake" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_DRAKE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "goblin" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_GOBLIN
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "bear" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_BEAR
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "armor" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_ARMOR
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "medusa" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_MEDUSA
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "cupid" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_CUPID
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "karune" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_KARUNE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "harpy" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_HARPY
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "dragon" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_DRAGON
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "dinosaur" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_DINOSAUR
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "beast" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_BEAST
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "spider" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SPIDER
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "golem" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_GOLEM
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "rock" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_ROCK
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "zanan" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_ZANAN
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "skeleton" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SKELETON
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "piece" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_PIECE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "cat" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_CAT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "dog" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_DOG
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "roran" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_RORAN
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "rat" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_RAT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "shell" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SHELL
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "catgod" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_CAT_GOD
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "machinegod" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_MACHINE_GOD
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "undeadgod" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_UNDEAD_GOD
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "machine" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_MACHINE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "wisp" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_WISP
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "bird" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_BIRD
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "seamonster" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SEA_MONSTER
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "catsister" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_CAT_SISTER
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "mutant" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_MUTANT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "yeek" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_YEEK
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "yith" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_YITH
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "servant" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_SERVANT
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "horse" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_HORSE
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "god" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_GOD
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "quickling" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_QUICKLING
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "metal" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_METAL
+		return
+	}
+	if ( cdatan(CDATAN_RACE, r1) == "vehicle" ) {
+		cdata(CDATA_RACE_ID, r1) = DB_RACE_BEHICLE
+		return
+	}
+	return
+
+*db_setFilterRace
+	dim racebit, 10, 78
+	return
+
+*db_race
+	if ( dbmode == DBMODE_FIND ) {
+		if ( val == 1 ) {
+			listn(1, listmax) = "kobolt"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "orc"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "largeanimal"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "lizardman"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "minotaur"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "yerles"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "norland"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "eulderna"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "fairy"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "asura"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "slime"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "doggod"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "dwarf"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "juere"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "zombie"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "elea"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "rabbit"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "sheep"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "frog"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "worm"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "snail"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "mandrake"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "beetle"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "mushroom"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "bat"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "ent"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "lich"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "bacteria"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "ghost"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "spirit"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "eye"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "mazin"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "wasp"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "giant"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "imp"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "hand"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "snake"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "drake"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "goblin"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "bear"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "armor"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "medusa"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "cupid"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "karune"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "harpy"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "dragon"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "dinosaur"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "beast"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "spider"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "golem"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "rock"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "zanan"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "skeleton"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "piece"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "cat"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "dog"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "roran"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "rat"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "shell"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "catgod"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "machinegod"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "undeadgod"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "machine"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "wisp"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "bird"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "seamonster"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "catsister"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 0 ) {
+			listn(1, listmax) = "mutant"
+			list(0, listmax) = 0
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "yeek"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "yith"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "servant"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "horse"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "god"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "quickling"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "metal"
+			list(0, listmax) = 1
+			listmax++
+		}
+		if ( val == 1 ) {
+			listn(1, listmax) = "vehicle"
+			list(0, listmax) = 1
+			listmax++
+		}
+		return
+	}
+	if ( dbidn == "kobolt" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 250
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("コボルト", cnven("kobolt"))
+			cpicref = 171
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 171
+			ref2 = 171
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "kobolt"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_KOBOLT
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
+			cdata(CDATA_HEIGHT, rc) = 150
+			if ( rnd(100) < 50 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(6, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 90
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 3
+			skillinit SKILL_ATTR_LER, rc, 2
+			skillinit SKILL_ATTR_WIL, rc, 2
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_ACTIVE_PICKPOCKET, rc, 3
+			skillinit SKILL_NORMAL_STEALTH, rc, 2
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 3
+			s(1) = "頭|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "orc" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 300
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("オーク", cnven("orc"))
+			cpicref = 165
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 165
+			ref2 = 165
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "orc"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_ORC
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
+			cdata(CDATA_HEIGHT, rc) = 150
+			if ( rnd(100) < 51 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(0, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 130
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 3
+			skillinit SKILL_ATTR_PER, rc, 2
+			skillinit SKILL_ATTR_LER, rc, 2
+			skillinit SKILL_ATTR_WIL, rc, 3
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_HEALING, rc, 3
+			skillinit SKILL_NORMAL_HEAVY_ARMOR, rc, 3
+			skillinit SKILL_NORMAL_SHIELD, rc, 3
+			s(1) = "頭|体|背|手|手|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "largeanimal" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 250
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("巨獣", cnven("largeanimal"))
+			cpicref = 439
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 439
+			ref2 = 439
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "largeanimal"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_LARGE_ANIMAL
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(5) + 10)
+			cdata(CDATA_HEIGHT, rc) = 400
+			if ( rnd(100) < 51 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(10, 13)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 160
+			skillinit SKILL_ATTR_MANA, rc, 60
+			skillinit SKILL_ATTR_STR, rc, 12
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 3
+			skillinit SKILL_ATTR_PER, rc, 12
+			skillinit SKILL_ATTR_LER, rc, 2
+			skillinit SKILL_ATTR_WIL, rc, 3
+			skillinit SKILL_ATTR_MAG, rc, 2
+			skillinit SKILL_ATTR_CHA, rc, 3
+			skillinit SKILL_ATTR_SPD, rc, 100
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_HEALING, rc, 30
+			skillinit SKILL_NORMAL_DISARM_TRAP, rc, 2
+			skillinit SKILL_NORMAL_SENSE_QUALITY, rc, 2
+			s(1) = "頭|首|体|背|手|足|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "lizardman" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 300
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("竜人", cnven("lizardman"))
+			cpicref = 397
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 397
+			ref2 = 397
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "lizardman"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_LIZARDMAN
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 15)
+			cdata(CDATA_HEIGHT, rc) = 240
+			if ( rnd(100) < 51 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(1, 12)
+			cdata(CDATA_DV_FIX, rc) = 120
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 70
+			skillinit SKILL_ATTR_STR, rc, 10
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 5
+			skillinit SKILL_ATTR_SPD, rc, 80
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_WEAPON_POLEARM, rc, 3
+			skillinit SKILL_NORMAL_SHIELD, rc, 3
+			skillinit SKILL_NORMAL_EVASION, rc, 2
+			s(1) = "頭|体|背|手|手|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "minotaur" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 300
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ミノタウロス", cnven("minotaur"))
+			cpicref = 398
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 398
+			ref2 = 398
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "minotaur"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_MINOTAUR
+			cdata(CDATA_MELEE_STYLE, rc) = 9
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
+			cdata(CDATA_HEIGHT, rc) = 350
+			if ( rnd(100) < 51 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(2, 12)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 160
+			skillinit SKILL_ATTR_MANA, rc, 60
+			skillinit SKILL_ATTR_STR, rc, 12
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 3
+			skillinit SKILL_ATTR_PER, rc, 4
+			skillinit SKILL_ATTR_LER, rc, 3
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 7
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 65
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_TACTICS, rc, 4
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 3
+			skillinit SKILL_NORMAL_MINING, rc, 2
+			s(1) = "頭|体|手|手|指|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "yerles" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 40
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("イェルス", cnven("yerles"))
+			cpicref = 1
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("シエラ・テール西方で急速に台頭してきた新王国の人間が、イェルスです。彼らは現実的な思考を好み、エイス・テールの文明を崇拝する一方で、それが例え自らの理解を超えていても、利益になるものであれば積極的にとりいれようとする柔軟性を持っています。彼らは高い学習能力を持ち、ほぼ全ての職業に適応することができます。イェルスは機械武装の扱いにたけ、追加の成長ボーナスを受け取ります。", "The young kingdom which worships the ancient scientific civilization called Eyth Terre has gained power in the west. While they are realists amd materialistic, they are also adaptable to things that are beyond their comprehension if it benefits the kingdom. Yerles fit well in every class with their outstanding learning ability. They receive extra skill points with every level that they gain.")
+			ref1 = 1
+			ref2 = 1
+			ref2 = 2
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "yerles"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_YERLES
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 15)
+			cdata(CDATA_HEIGHT, rc) = 165
+			if ( rnd(100) < 52 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(1, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(2, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 110
+			skillinit SKILL_ATTR_MANA, rc, 90
+			skillinit SKILL_ATTR_STR, rc, 7
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 8
+			skillinit SKILL_ATTR_LER, rc, 12
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 8
+			skillinit SKILL_ATTR_CHA, rc, 7
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_WEAPON_FIREARM, rc, 5
+			skillinit SKILL_NORMAL_LITERACY, rc, 3
+			skillinit SKILL_NORMAL_NEGOTIATION, rc, 2
+			skillinit SKILL_WEAPON_THROWING, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "norland" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 40
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ノーランド", cnven("norland"))
+			cpicref = 1
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 1
+			ref2 = 1
+			ref2 = 2
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "norland"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_NORLAND
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 15)
+			cdata(CDATA_HEIGHT, rc) = 170
+			if ( rnd(100) < 52 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(1, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(2, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 90
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 6
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 7
+			skillinit SKILL_ATTR_WIL, rc, 9
+			skillinit SKILL_ATTR_MAG, rc, 7
+			skillinit SKILL_ATTR_CHA, rc, 6
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_CASTING, rc, 3
+			skillinit SKILL_NORMAL_TACTICS, rc, 3
+			skillinit SKILL_NORMAL_TWO_HAND, rc, 3
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "eulderna" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 40
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("エウダーナ", cnven("eulderna"))
+			cpicref = 5
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("エウダーナは最も古い国の一つで、今もなお強力な大国です。彼らは、自分たちのみが世界を動かすに値すると考える選民意識の持ち主で、エリートであり、完ぺき主義者です。エウダーナは魔法や魔法道具の扱いにたけ、キャスターや中間的な職業に向いています。彼らは高い詠唱能力と魔法への耐性をもっています。", "Eulderna is one of the most ancient races in Sierra Terre. Egoism and elitism dominate every thought behind actions of these perfectionists. They, are suitable to caster or hybrid classes as they are adept at magics and using magical devices. Euldernas have resistance to magic.")
+			ref1 = 5
+			ref2 = 5
+			ref2 = 6
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "eulderna"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_EULDERNA
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 16)
+			cdata(CDATA_HEIGHT, rc) = 175
+			if ( rnd(100) < 52 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(5, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(6, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 6
+			skillinit SKILL_ATTR_CON, rc, 7
+			skillinit SKILL_ATTR_DEX, rc, 7
+			skillinit SKILL_ATTR_PER, rc, 10
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 10
+			skillinit SKILL_ATTR_MAG, rc, 12
+			skillinit SKILL_ATTR_CHA, rc, 8
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_CASTING, rc, 5
+			skillinit SKILL_NORMAL_LITERACY, rc, 3
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 3
+			skillinit SKILL_NORMAL_INVESTING, rc, 2
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "fairy" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 180
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("妖精", cnven("fairy"))
+			cpicref = 390
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("妖精は可憐で非力で儚い生物です。彼女達は、人間族と比べて高い魔力と回避力、目にも止まらぬすばしっこさを持ち、ほぼ全ての耐性に高い抵抗力を持っています。反面、妖精は重さ1s以上の装備を身につけることができず、防御力をあげるのは困難です。その体力の低さからも、まともな物理攻撃を一度でもくらうと危機に陥るでしょう。", "Fairies are cute, mysterious, and fragile. Compared to the human race, they are gifted with superior skills of using magic and evading. In contrast, the lack of physical power makes it difficult for them to carry even the smallest of things, making it impossible for them to wear equipment weighing more than 1s. Fairies have outstanding resistances to all elements.")
+			ref1 = 390
+			ref2 = 390
+			ref2 = 390
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "fairy"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_FAIRY
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(100) + 5)
+			cdata(CDATA_HEIGHT, rc) = 50
+			if ( rnd(100) < 52 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(27, 11)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(27, 11)
+			}
+			if ( 2 == 1 ) {
+				sdata(SKILL_RES_DARKNESS, rc) = 500
+				sdata(SKILL_RES_NERVE, rc) = 500
+				sdata(SKILL_RES_NETHER, rc) = 500
+				sdata(SKILL_RES_FIRE, rc) = 80
+			}
+			if ( 2 == 2 ) {
+				sdata(SKILL_RES_MAGIC, rc) = 200
+				sdata(SKILL_RES_DARKNESS, rc) = 200
+				sdata(SKILL_RES_NERVE, rc) = 200
+				sdata(SKILL_RES_NETHER, rc) = 200
+				sdata(SKILL_RES_MIND, rc) = 200
+				sdata(SKILL_RES_SOUND, rc) = 200
+				sdata(SKILL_RES_CHAOS, rc) = 200
+			}
+			cdata(CDATA_DV_FIX, rc) = 250
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 40
+			skillinit SKILL_ATTR_MANA, rc, 130
+			skillinit SKILL_ATTR_STR, rc, 3
+			skillinit SKILL_ATTR_CON, rc, 4
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 10
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 13
+			skillinit SKILL_ATTR_CHA, rc, 12
+			skillinit SKILL_ATTR_SPD, rc, 120
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_CASTING, rc, 5
+			skillinit SKILL_ACTIVE_PICKPOCKET, rc, 3
+			skillinit SKILL_NORMAL_LIGHT_ARMOR, rc, 3
+			skillinit SKILL_NORMAL_COOKING, rc, 2
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "asura" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 100
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("阿修羅", cnven("asura"))
+			cpicref = 405
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 405
+			ref2 = 405
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "asura"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_ASURA
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 15)
+			cdata(CDATA_HEIGHT, rc) = 220
+			if ( rnd(100) < 52 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(9, 12)
+			cdata(CDATA_DV_FIX, rc) = 200
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 90
+			skillinit SKILL_ATTR_MANA, rc, 70
+			skillinit SKILL_ATTR_STR, rc, 11
+			skillinit SKILL_ATTR_CON, rc, 9
+			skillinit SKILL_ATTR_DEX, rc, 14
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 5
+			skillinit SKILL_ATTR_CHA, rc, 5
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_DUAL_WIELD, rc, 30
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 6
+			skillinit SKILL_NORMAL_ANATOMY, rc, 4
+			skillinit SKILL_NORMAL_CARPENTRY, rc, 4
+			s(1) = "手|手|手|手|首|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "slime" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 700
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("スライム", cnven("slime"))
+			cpicref = 168
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 168
+			ref2 = 168
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "slime"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SLIME
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 2
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 1)
+			cdata(CDATA_HEIGHT, rc) = 40
+			if ( rnd(100) < 54 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(3, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 200
+			skillinit SKILL_ATTR_LIFE, rc, 80
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 4
+			skillinit SKILL_ATTR_CON, rc, 5
+			skillinit SKILL_ATTR_DEX, rc, 7
+			skillinit SKILL_ATTR_PER, rc, 5
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 13
+			skillinit SKILL_ATTR_SPD, rc, 55
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_EVASION, rc, 2
+			skillinit SKILL_NORMAL_PERFORMER, rc, 3
+			skillinit SKILL_NORMAL_HEALING, rc, 3
+			s(1) = "頭|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "doggod" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 5
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("犬の神", cnven("doggod"))
+			cpicref = 254
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 254
+			ref2 = 254
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "doggod"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_DOG_GOD
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(500) + 1000)
+			cdata(CDATA_HEIGHT, rc) = 820
+			if ( rnd(100) < 55 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(23, 7)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 60
+			skillinit SKILL_ATTR_STR, rc, 14
+			skillinit SKILL_ATTR_CON, rc, 14
+			skillinit SKILL_ATTR_DEX, rc, 21
+			skillinit SKILL_ATTR_PER, rc, 28
+			skillinit SKILL_ATTR_LER, rc, 9
+			skillinit SKILL_ATTR_WIL, rc, 10
+			skillinit SKILL_ATTR_MAG, rc, 8
+			skillinit SKILL_ATTR_CHA, rc, 20
+			skillinit SKILL_ATTR_SPD, rc, 400
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_TACTICS, rc, 4
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 2
+			s(1) = "頭|首|体|手|指|腕|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "dwarf" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 50
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("丘の民", cnven("dwarf"))
+			cpicref = 67
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("丘の民、別名ドワーフは頑強で無骨な背の低い種族です。彼らは高い耐久力と力を持ち、幾つかの生産系の技術にも精通しています。彼らには暗黒と強い毒への耐性があります。", "A Dwarf is a child of the earth. As tough and unyielding as the mountains they love, most Dwarves will live their whole lives underground, mining, smelting, and smithing. Some few leave the depths to become adventurers, hoping to make enough coin to start their own clan. Good with technology, and tough against things dark and poisonous.")
+			ref1 = 67
+			ref2 = 67
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "dwarf"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_DWARF
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(60) + 20)
+			cdata(CDATA_HEIGHT, rc) = 100
+			if ( rnd(100) < 56 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(1, 2)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 10
+			skillinit SKILL_ATTR_CON, rc, 11
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 7
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 6
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_COOKING, rc, 4
+			skillinit SKILL_NORMAL_JEWELER, rc, 3
+			skillinit SKILL_NORMAL_MINING, rc, 4
+			skillinit SKILL_NORMAL_GARDENING, rc, 2
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "juere" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 60
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ジューア", cnven("juere"))
+			cpicref = 9
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("ジューアは、元は盗賊や悪人のあつまりであり、今もならず者国家として嫌われる国です。彼らは束縛されることを嫌い、自分の意思を尊重し、自由に生きることを好みます。ジューアは手先が器用で、鋭い感覚と高い学習能力を持ち、多彩な技術に精通しています。彼らはパフォーマンスをすることで生計をたてることができ、食事をゆっくりと消化し、採取スポットでより長い時間採取できます。", "The Juere are a people wild and free. Scorning the \"weaker\" laws of others, they quickly learn the tricks and technologies of others before ever moving onwards. Their pride makes them great performers, and are used to being hungry for long periods of time. Nimble of hand, and Bold of character, no two Juere are ever the same.")
+			ref1 = 9
+			ref2 = 9
+			ref2 = 10
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "juere"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_JUERE
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
+			cdata(CDATA_HEIGHT, rc) = 165
+			if ( rnd(100) < 50 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(9, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(10, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 7
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 12
+			skillinit SKILL_ATTR_PER, rc, 10
+			skillinit SKILL_ATTR_LER, rc, 10
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 8
+			skillinit SKILL_ATTR_CHA, rc, 11
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_PERFORMER, rc, 4
+			skillinit SKILL_NORMAL_LOCK_PICKING, rc, 2
+			skillinit SKILL_NORMAL_NEGOTIATION, rc, 2
+			skillinit SKILL_WEAPON_THROWING, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "zombie" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 100
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ゾンビ", cnven("zombie"))
+			cpicref = 167
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 167
+			ref2 = 167
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "zombie"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_ZOMBIE
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 10)
+			cdata(CDATA_HEIGHT, rc) = 160
+			if ( rnd(100) < 50 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(2, 5)
+			if ( 1 == 1 ) {
+				sdata(SKILL_RES_DARKNESS, rc) = 500
+				sdata(SKILL_RES_NERVE, rc) = 500
+				sdata(SKILL_RES_NETHER, rc) = 500
+				sdata(SKILL_RES_FIRE, rc) = 80
+			}
+			if ( 1 == 2 ) {
+				sdata(SKILL_RES_MAGIC, rc) = 200
+				sdata(SKILL_RES_DARKNESS, rc) = 200
+				sdata(SKILL_RES_NERVE, rc) = 200
+				sdata(SKILL_RES_NETHER, rc) = 200
+				sdata(SKILL_RES_MIND, rc) = 200
+				sdata(SKILL_RES_SOUND, rc) = 200
+				sdata(SKILL_RES_CHAOS, rc) = 200
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 10
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 2
+			skillinit SKILL_ATTR_PER, rc, 2
+			skillinit SKILL_ATTR_LER, rc, 1
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 45
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_COOKING, rc, 3
+			skillinit SKILL_NORMAL_FISHING, rc, 3
+			skillinit SKILL_NORMAL_ANATOMY, rc, 2
+			s(1) = "頭|首|体|背|手|手|指|腕|腰|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "elea" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 20
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("エレア", cnven("elea"))
+			cpicref = 3
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("エレアは、幾つもの世代を生き抜いたエルフの末梢で、他の種族から姿を隠し、静かに生活しています。彼らこそが、レム・イドを滅ぼした災厄の元凶であるとするザナンの皇子のバッシングにより、彼らは他の種族から嫌われています。エレアはエーテルへの耐性と高い魔力を持ち、魔力の反動によるダメージを軽減することができます。", "Elea, known by the other peoples of the world as \"Elf's\", live quietly in their forests, far from man. Nimble and graceful, their bows are of legend, and their wizards have forgotten more of magic than many will ever know. Still, the young ones from time to time leave and go on adventures, if only to fill their memories for their long lives.")
+			ref1 = 3
+			ref2 = 3
+			ref2 = 4
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "elea"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_ELEA
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 10)
+			cdata(CDATA_HEIGHT, rc) = 180
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(3, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(4, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 90
+			skillinit SKILL_ATTR_MANA, rc, 110
+			skillinit SKILL_ATTR_STR, rc, 6
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 8
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 12
+			skillinit SKILL_ATTR_MAG, rc, 13
+			skillinit SKILL_ATTR_CHA, rc, 10
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 5
+			skillinit SKILL_NORMAL_CASTING, rc, 2
+			skillinit SKILL_NORMAL_MEMORIZATION, rc, 3
+			skillinit SKILL_NORMAL_COOKING, rc, 4
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "rabbit" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 800
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ウサギ", cnven("rabbit"))
+			cpicref = 169
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 169
+			ref2 = 169
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "rabbit"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_RABBIT
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(5) + 2)
+			cdata(CDATA_HEIGHT, rc) = 40
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(4, 5)
+			cdata(CDATA_DV_FIX, rc) = 120
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 90
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 4
+			skillinit SKILL_ATTR_DEX, rc, 6
+			skillinit SKILL_ATTR_PER, rc, 11
+			skillinit SKILL_ATTR_LER, rc, 5
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 10
+			skillinit SKILL_ATTR_SPD, rc, 100
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_ACTIVE_RIDING, rc, 3
+			skillinit SKILL_NORMAL_DETECTION, rc, 3
+			skillinit SKILL_NORMAL_TRAVELING, rc, 3
+			s(1) = "頭|首|体|背|腕|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "sheep" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 1000
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("羊", cnven("sheep"))
+			cpicref = 170
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 170
+			ref2 = 170
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "sheep"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SHEEP
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(5) + 2)
+			cdata(CDATA_HEIGHT, rc) = 150
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(5, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 120
+			skillinit SKILL_ATTR_LIFE, rc, 130
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 6
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 8
+			skillinit SKILL_ATTR_SPD, rc, 60
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_HEALING, rc, 3
+			skillinit SKILL_NORMAL_ANATOMY, rc, 3
+			skillinit SKILL_NORMAL_TAILORING, rc, 2
+			s(1) = "頭|首|体|背|腕|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "frog" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 600
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("蛙", cnven("frog"))
+			cpicref = 172
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 172
+			ref2 = 172
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "frog"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_FROG
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(5) + 2)
+			cdata(CDATA_HEIGHT, rc) = 10
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(7, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 80
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 6
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 6
+			skillinit SKILL_ATTR_PER, rc, 8
+			skillinit SKILL_ATTR_LER, rc, 5
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 5
+			skillinit SKILL_ATTR_CHA, rc, 6
+			skillinit SKILL_ATTR_SPD, rc, 60
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_PERFORMER, rc, 3
+			skillinit SKILL_NORMAL_INVESTING, rc, 2
+			skillinit SKILL_NORMAL_SWIMMING, rc, 4
+			s(1) = "体|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "worm" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 400
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ワーム", cnven("worm"))
+			cpicref = 173
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 173
+			ref2 = 173
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "worm"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_WORM
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 10
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(8, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 90
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 6
+			skillinit SKILL_ATTR_CON, rc, 5
+			skillinit SKILL_ATTR_DEX, rc, 10
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 3
+			skillinit SKILL_ATTR_WIL, rc, 2
+			skillinit SKILL_ATTR_MAG, rc, 2
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 3
+			skillinit SKILL_NORMAL_MINING, rc, 3
+			skillinit SKILL_NORMAL_STEALTH, rc, 3
+			s(1) = "背|指|指|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "snail" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 500
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("かたつむり", cnven("snail"))
+			cpicref = 174
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("カタツムリは非常に鈍い生き物です。彼らは脆く、非力で、不器用で、学習能力がなく、塩で溶けます。", "Despite the fears that one day the rats will inherit the World, thanks to the Etherwind it seems the snails have gotten a head start. Slow and dull, even the mightiest among them fears salt, garlic and butter. Still for those seeking a true challenge, ony can harly do worse than being a snail. Can you imagine the looks of others when you inch ever so slowly towards them?")
+			ref1 = 174
+			ref2 = 174
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "snail"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SNAIL
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 8
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(9, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 4
+			skillinit SKILL_ATTR_CON, rc, 5
+			skillinit SKILL_ATTR_DEX, rc, 3
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 3
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 2
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 25
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_WEAPON_THROWING, rc, 5
+			s(1) = "背|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "mandrake" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 80
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("マンドレイク", cnven("mandrake"))
+			cpicref = 175
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 175
+			ref2 = 175
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "mandrake"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_MANDRAKE
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 25
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(10, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 70
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 10
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 10
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 60
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_MEMORIZATION, rc, 3
+			skillinit SKILL_NORMAL_LITERACY, rc, 2
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 3
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 3
+			s(1) = "頭|背|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "beetle" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 750
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("昆虫", cnven("beetle"))
+			cpicref = 176
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 176
+			ref2 = 176
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "beetle"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_BEETLE
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 8
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 10
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(11, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 140
+			skillinit SKILL_ATTR_LIFE, rc, 80
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 3
+			skillinit SKILL_ATTR_SPD, rc, 75
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_CASTING, rc, 3
+			skillinit SKILL_NORMAL_STEALTH, rc, 3
+			skillinit SKILL_NORMAL_GARDENING, rc, 2
+			s(1) = "首|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "mushroom" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 440
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("きのこ", cnven("mushroom"))
+			cpicref = 177
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 177
+			ref2 = 177
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "mushroom"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_MUSHROOM
+			cdata(CDATA_MELEE_STYLE, rc) = 7
+			cdata(CDATA_CAST_STYLE, rc) = 5
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 20
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(12, 5)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 50
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 7
+			skillinit SKILL_ATTR_DEX, rc, 4
+			skillinit SKILL_ATTR_PER, rc, 8
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 10
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 60
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_TAILORING, rc, 3
+			skillinit SKILL_NORMAL_ALCHEMY, rc, 2
+			skillinit SKILL_NORMAL_GARDENING, rc, 4
+			s(1) = "頭|首|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "bat" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 350
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("コウモリ", cnven("bat"))
+			cpicref = 200
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 200
+			ref2 = 200
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "bat"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_BAT
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 70
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(2, 6)
+			sdata(SKILL_RES_DARKNESS, rc) = 500
+			if ( 0 != 0 ) {
+				sdata(rsres0, rc) = 500
+			}
+			if ( 0 != 0 ) {
+				sdata(rsres0, rc) = 500
+			}
+			cdata(CDATA_DV_FIX, rc) = 320
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 10
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 3
+			skillinit SKILL_ATTR_CON, rc, 5
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 9
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 3
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 140
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 3
+			skillinit SKILL_NORMAL_DETECTION, rc, 3
+			skillinit SKILL_NORMAL_NEGOTIATION, rc, 2
+			s(1) = "頭|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "ent" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 35
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("エント", cnven("ent"))
+			cpicref = 201
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 201
+			ref2 = 201
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "ent"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_ENT
+			cdata(CDATA_MELEE_STYLE, rc) = 8
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 1500
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(3, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 140
+			skillinit SKILL_ATTR_LIFE, rc, 170
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 9
+			skillinit SKILL_ATTR_CON, rc, 12
+			skillinit SKILL_ATTR_DEX, rc, 4
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 2
+			skillinit SKILL_ATTR_WIL, rc, 3
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 50
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_HEALING, rc, 2
+			skillinit SKILL_NORMAL_CARPENTRY, rc, 4
+			skillinit SKILL_NORMAL_GARDENING, rc, 3
+			s(1) = "手|指|指|腕|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "lich" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 25
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("リッチ", cnven("lich"))
+			cpicref = 202
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("リッチは高い知能と魔力を備えた不朽のアンデッドです。彼らは通常の種族よりも高いマナと瞑想の技術を得ますが、肉弾戦に耐え切れるほどの体力はありません。リッチは冷気と毒と強い暗黒への耐性を持っています。", "When a powerful magus grows near death, their desire to live on makes them attempt lichdom. Of the many who try every century, barely a handful succeed. Most fail and die, but some few partially make it, though the process robs them of much of their memories and skills. Their young \"age\" is their new \"life\" beginning anew, but they are patient. After all, they have all the time in the world now.")
+			ref1 = 202
+			ref2 = 202
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "lich"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_LICH
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 180
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(4, 6)
+			if ( 1 == 1 ) {
+				sdata(SKILL_RES_DARKNESS, rc) = 500
+				sdata(SKILL_RES_NERVE, rc) = 500
+				sdata(SKILL_RES_NETHER, rc) = 500
+				sdata(SKILL_RES_FIRE, rc) = 80
+			}
+			if ( 1 == 2 ) {
+				sdata(SKILL_RES_MAGIC, rc) = 200
+				sdata(SKILL_RES_DARKNESS, rc) = 200
+				sdata(SKILL_RES_NERVE, rc) = 200
+				sdata(SKILL_RES_NETHER, rc) = 200
+				sdata(SKILL_RES_MIND, rc) = 200
+				sdata(SKILL_RES_SOUND, rc) = 200
+				sdata(SKILL_RES_CHAOS, rc) = 200
+			}
+			cdata(CDATA_DV_FIX, rc) = 190
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 80
+			skillinit SKILL_ATTR_MANA, rc, 140
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 7
+			skillinit SKILL_ATTR_PER, rc, 10
+			skillinit SKILL_ATTR_LER, rc, 10
+			skillinit SKILL_ATTR_WIL, rc, 13
+			skillinit SKILL_ATTR_MAG, rc, 15
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_MEDITATION, rc, 5
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 3
+			skillinit SKILL_NORMAL_CASTING, rc, 3
+			skillinit SKILL_NORMAL_GENE_ENGINEER, rc, 2
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "bacteria" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 100
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("バクテリア", cnven("bacteria"))
+			cpicref = 460
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 460
+			ref2 = 460
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "bacteria"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_BACTERIA
+			cdata(CDATA_MELEE_STYLE, rc) = 7
+			cdata(CDATA_CAST_STYLE, rc) = 3
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 500
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(31, 13)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 180
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 13
+			skillinit SKILL_ATTR_CON, rc, 13
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 4
+			skillinit SKILL_ATTR_LER, rc, 1
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 11
+			skillinit SKILL_ATTR_CHA, rc, 1
+			skillinit SKILL_ATTR_SPD, rc, 75
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 4
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 4
+			skillinit SKILL_NORMAL_CASTING, rc, 3
+			skillinit SKILL_NORMAL_HEALING, rc, 30
+			skillinit SKILL_NORMAL_GENE_ENGINEER, rc, 2
+			s(1) = "体|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "ghost" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 30
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("幽霊", cnven("ghost"))
+			cpicref = 205
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 205
+			ref2 = 205
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "ghost"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_GHOST
+			cdata(CDATA_MELEE_STYLE, rc) = 6
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 160
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(7, 6)
+			if ( 1 == 1 ) {
+				sdata(SKILL_RES_DARKNESS, rc) = 500
+				sdata(SKILL_RES_NERVE, rc) = 500
+				sdata(SKILL_RES_NETHER, rc) = 500
+				sdata(SKILL_RES_FIRE, rc) = 80
+			}
+			if ( 1 == 2 ) {
+				sdata(SKILL_RES_MAGIC, rc) = 200
+				sdata(SKILL_RES_DARKNESS, rc) = 200
+				sdata(SKILL_RES_NERVE, rc) = 200
+				sdata(SKILL_RES_NETHER, rc) = 200
+				sdata(SKILL_RES_MIND, rc) = 200
+				sdata(SKILL_RES_SOUND, rc) = 200
+				sdata(SKILL_RES_CHAOS, rc) = 200
+			}
+			cdata(CDATA_DV_FIX, rc) = 160
+			cdata(CDATA_PV_FIX, rc) = 300
+			skillinit SKILL_ATTR_LIFE, rc, 70
+			skillinit SKILL_ATTR_MANA, rc, 90
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 6
+			skillinit SKILL_ATTR_PER, rc, 14
+			skillinit SKILL_ATTR_LER, rc, 7
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 11
+			skillinit SKILL_ATTR_CHA, rc, 11
+			skillinit SKILL_ATTR_SPD, rc, 85
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 4
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 2
+			skillinit SKILL_NORMAL_STEALTH, rc, 3
+			skillinit SKILL_NORMAL_DISARM_TRAP, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腰|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "spirit" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 25
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("精霊", cnven("spirit"))
+			cpicref = 206
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 206
+			ref2 = 206
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "spirit"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SPIRIT
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 100
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(8, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 9
+			skillinit SKILL_ATTR_CON, rc, 9
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 10
+			skillinit SKILL_ATTR_MAG, rc, 13
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 85
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_CASTING, rc, 4
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 2
+			skillinit SKILL_NORMAL_INVESTING, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "eye" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 50
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("目", cnven("eye"))
+			cpicref = 207
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 207
+			ref2 = 207
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "eye"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_EYE
+			cdata(CDATA_MELEE_STYLE, rc) = 4
+			cdata(CDATA_CAST_STYLE, rc) = 3
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 40
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(9, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 3
+			skillinit SKILL_ATTR_CON, rc, 9
+			skillinit SKILL_ATTR_DEX, rc, 4
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 7
+			skillinit SKILL_ATTR_MAG, rc, 10
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 25
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_DETECTION, rc, 3
+			skillinit SKILL_NORMAL_ANATOMY, rc, 3
+			skillinit SKILL_NORMAL_GENE_ENGINEER, rc, 3
+			s(1) = "頭|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "mazin" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 200
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("魔人", cnven("mazin"))
+			cpicref = 311
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 311
+			ref2 = 311
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "mazin"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_MAZIN
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 7
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 20)
+			cdata(CDATA_HEIGHT, rc) = 160
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(14, 9)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 110
+			skillinit SKILL_ATTR_MANA, rc, 90
+			skillinit SKILL_ATTR_STR, rc, 11
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 5
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 7
+			skillinit SKILL_ATTR_MAG, rc, 10
+			skillinit SKILL_ATTR_CHA, rc, 8
+			skillinit SKILL_ATTR_SPD, rc, 80
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_ANATOMY, rc, 3
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 3
+			skillinit SKILL_NORMAL_TACTICS, rc, 3
+			s(1) = "首|体|背|手|手|指|指|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "wasp" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 580
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ワスプ", cnven("wasp"))
+			cpicref = 210
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 210
+			ref2 = 210
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "wasp"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_WASP
+			cdata(CDATA_MELEE_STYLE, rc) = 5
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 80
+			if ( rnd(100) < 20 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(12, 6)
+			cdata(CDATA_DV_FIX, rc) = 220
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 50
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 7
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 13
+			skillinit SKILL_ATTR_PER, rc, 11
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 3
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 100
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 2
+			skillinit SKILL_NORMAL_GARDENING, rc, 3
+			skillinit SKILL_ACTIVE_PICKPOCKET, rc, 2
+			s(1) = "頭|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "giant" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 60
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("巨人", cnven("giant"))
+			cpicref = 232
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 232
+			ref2 = 232
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "giant"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_GIANT
+			cdata(CDATA_MELEE_STYLE, rc) = 9
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 1800
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(1, 7)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 200
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 12
+			skillinit SKILL_ATTR_CON, rc, 14
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 4
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 3
+			skillinit SKILL_ATTR_SPD, rc, 60
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 4
+			skillinit SKILL_NORMAL_ANATOMY, rc, 3
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 2
+			skillinit SKILL_NORMAL_CARPENTRY, rc, 3
+			s(1) = "体|背|手|手|腕|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "imp" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 240
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("悪魔", cnven("imp"))
+			cpicref = 212
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 212
+			ref2 = 212
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "imp"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_IMP
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 7
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(100) + 100)
+			cdata(CDATA_HEIGHT, rc) = 180
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(14, 6)
+			cdata(CDATA_DV_FIX, rc) = 200
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 120
+			skillinit SKILL_ATTR_STR, rc, 11
+			skillinit SKILL_ATTR_CON, rc, 10
+			skillinit SKILL_ATTR_DEX, rc, 7
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 5
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 12
+			skillinit SKILL_ATTR_CHA, rc, 9
+			skillinit SKILL_ATTR_SPD, rc, 90
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 4
+			skillinit SKILL_NORMAL_TACTICS, rc, 4
+			skillinit SKILL_NORMAL_NEGOTIATION, rc, 4
+			s(1) = "首|体|手|手|指|指|指|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "hand" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 160
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("手", cnven("hand"))
+			cpicref = 213
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 213
+			ref2 = 213
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "hand"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_HAND
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 70
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(15, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 9
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 4
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 5
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 4
+			skillinit SKILL_NORMAL_CARPENTRY, rc, 2
+			skillinit SKILL_NORMAL_COOKING, rc, 3
+			s(1) = "手|手|指|指|腕|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "snake" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 430
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("蛇", cnven("snake"))
+			cpicref = 216
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 216
+			ref2 = 216
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "snake"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SNAKE
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 50
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(18, 6)
+			cdata(CDATA_DV_FIX, rc) = 120
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 6
+			skillinit SKILL_ATTR_CON, rc, 9
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 10
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_STEALTH, rc, 4
+			skillinit SKILL_NORMAL_SWIMMING, rc, 2
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 2
+			s(1) = "体|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "drake" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 120
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("亜竜", cnven("drake"))
+			cpicref = 233
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 233
+			ref2 = 233
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "drake"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_DRAKE
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 1400
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(2, 7)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 120
+			skillinit SKILL_ATTR_LIFE, rc, 160
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 11
+			skillinit SKILL_ATTR_CON, rc, 12
+			skillinit SKILL_ATTR_DEX, rc, 11
+			skillinit SKILL_ATTR_PER, rc, 8
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 9
+			skillinit SKILL_ATTR_MAG, rc, 8
+			skillinit SKILL_ATTR_CHA, rc, 7
+			skillinit SKILL_ATTR_SPD, rc, 85
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_TRAVELING, rc, 3
+			skillinit SKILL_NORMAL_FISHING, rc, 2
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 3
+			s(1) = "首|体|指|指|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "goblin" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 290
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ゴブリン", cnven("goblin"))
+			cpicref = 220
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("ゴブリンは好戦的で獰猛な種族です。彼らは特筆するべき能力を持っておらず、またこれといった弱点もありません。ゴブリンははやや高い能力と、暗黒への耐性と、自然治癒の技術を持っています。また、採取スポットでより長く採取することができます。", "If Dwarves are the people of the earth, then the Goblins are the vermin. While clumsy and ugly, there are ever so many goblins about, and more every year. Their scrawny bodies heal quickly, and they love the taste of fish. Their beady little eyes miss little in the dark, and you never want to grapple with them, who knows what diseases you might get.")
+			ref1 = 220
+			ref2 = 220
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "goblin"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_GOBLIN
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 140
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(22, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 110
+			skillinit SKILL_ATTR_MANA, rc, 90
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 5
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 7
+			skillinit SKILL_ATTR_MAG, rc, 7
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_HEALING, rc, 5
+			skillinit SKILL_NORMAL_FISHING, rc, 2
+			skillinit SKILL_NORMAL_MINING, rc, 2
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "bear" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 350
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("熊", cnven("bear"))
+			cpicref = 222
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 222
+			ref2 = 222
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "bear"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_BEAR
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 280
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(24, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 160
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 9
+			skillinit SKILL_ATTR_CON, rc, 10
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 3
+			skillinit SKILL_ATTR_CHA, rc, 5
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_HEALING, rc, 3
+			skillinit SKILL_NORMAL_PERFORMER, rc, 2
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 3
+			s(1) = "手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "armor" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 1
+			}
+			if ( dbspec == 9 ) {
+				return 40
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("鎧", cnven("armor"))
+			cpicref = 223
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 223
+			ref2 = 223
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "armor"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_ARMOR
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 6
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 20)
+			cdata(CDATA_HEIGHT, rc) = 190
+			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(25, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 200
+			skillinit SKILL_ATTR_LIFE, rc, 50
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 9
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 7
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 7
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 50
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_LOCK_PICKING, rc, 3
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 2
+			skillinit SKILL_NORMAL_HEAVY_ARMOR, rc, 8
+			s(1) = "頭|首|体|背|手|手|腕|腰|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "medusa" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 180
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("メデューサ", cnven("medusa"))
+			cpicref = 224
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 224
+			ref2 = 224
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "medusa"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_MEDUSA
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 4
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 160
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(26, 6)
+			cdata(CDATA_DV_FIX, rc) = 140
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 110
+			skillinit SKILL_ATTR_STR, rc, 7
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 7
+			skillinit SKILL_ATTR_WIL, rc, 9
+			skillinit SKILL_ATTR_MAG, rc, 8
+			skillinit SKILL_ATTR_CHA, rc, 5
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 3
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 3
+			skillinit SKILL_NORMAL_ALCHEMY, rc, 2
+			s(1) = "体|手|手|指|指|腕|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "cupid" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 1
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("天使", cnven("cupid"))
+			cpicref = 225
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 225
+			ref2 = 225
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "cupid"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_CUPID
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 7
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 120
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(27, 6)
+			cdata(CDATA_DV_FIX, rc) = 200
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 80
+			skillinit SKILL_ATTR_MANA, rc, 150
+			skillinit SKILL_ATTR_STR, rc, 4
+			skillinit SKILL_ATTR_CON, rc, 7
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 11
+			skillinit SKILL_ATTR_LER, rc, 9
+			skillinit SKILL_ATTR_WIL, rc, 12
+			skillinit SKILL_ATTR_MAG, rc, 10
+			skillinit SKILL_ATTR_CHA, rc, 10
+			skillinit SKILL_ATTR_SPD, rc, 90
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 4
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 4
+			skillinit SKILL_NORMAL_CASTING, rc, 4
+			skillinit SKILL_NORMAL_INVESTING, rc, 3
+			s(1) = "首|体|手|手|指|指|腕|腰|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "karune" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 50
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("カルーン", cnven("karune"))
+			cpicref = 21
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 21
+			ref2 = 21
+			ref2 = 22
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "karune"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_KARUNE
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
+			cdata(CDATA_HEIGHT, rc) = 170
+			if ( rnd(100) < 50 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(21, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(22, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 9
+			skillinit SKILL_ATTR_CON, rc, 9
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 7
+			skillinit SKILL_ATTR_WIL, rc, 10
+			skillinit SKILL_ATTR_MAG, rc, 7
+			skillinit SKILL_ATTR_CHA, rc, 6
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_GARDENING, rc, 4
+			skillinit SKILL_NORMAL_ANATOMY, rc, 3
+			skillinit SKILL_NORMAL_WEIGHT_LIFTING, rc, 2
+			skillinit SKILL_NORMAL_TRAVELING, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "harpy" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 420
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("鳥人", cnven("harpy"))
+			cpicref = 227
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 227
+			ref2 = 227
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "harpy"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_HARPY
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 140
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(29, 6)
+			cdata(CDATA_DV_FIX, rc) = 150
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 90
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 9
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 9
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 80
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 3
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 2
+			skillinit SKILL_NORMAL_PERFORMER, rc, 2
+			s(1) = "首|背|手|手|指|指|腕|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "dragon" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 20
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ドラゴン", cnven("dragon"))
+			cpicref = 228
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 228
+			ref2 = 228
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "dragon"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_DRAGON
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 2400
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(30, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 120
+			skillinit SKILL_ATTR_LIFE, rc, 220
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 13
+			skillinit SKILL_ATTR_CON, rc, 15
+			skillinit SKILL_ATTR_DEX, rc, 10
+			skillinit SKILL_ATTR_PER, rc, 9
+			skillinit SKILL_ATTR_LER, rc, 10
+			skillinit SKILL_ATTR_WIL, rc, 9
+			skillinit SKILL_ATTR_MAG, rc, 13
+			skillinit SKILL_ATTR_CHA, rc, 9
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_TRAVELING, rc, 3
+			skillinit SKILL_NORMAL_JEWELER, rc, 3
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 3
+			s(1) = "首|体|指|指|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "dinosaur" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 100
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("恐竜", cnven("dinosaur"))
+			cpicref = 389
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 389
+			ref2 = 389
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "dinosaur"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_DINOSAUR
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 2000
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(26, 11)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 120
+			skillinit SKILL_ATTR_LIFE, rc, 140
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 10
+			skillinit SKILL_ATTR_DEX, rc, 6
+			skillinit SKILL_ATTR_PER, rc, 5
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 5
+			skillinit SKILL_ATTR_SPD, rc, 120
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 4
+			skillinit SKILL_NORMAL_TRAVELING, rc, 3
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 2
+			skillinit SKILL_NORMAL_HEALING, rc, 3
+			s(1) = "首|体|指|指|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "beast" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 80
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("幻獣", cnven("beast"))
+			cpicref = 229
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 229
+			ref2 = 229
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "beast"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_BEAST
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(500) + 400)
+			cdata(CDATA_HEIGHT, rc) = 1200
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(31, 6)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 160
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 11
+			skillinit SKILL_ATTR_CON, rc, 9
+			skillinit SKILL_ATTR_DEX, rc, 10
+			skillinit SKILL_ATTR_PER, rc, 11
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 10
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 90
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_DETECTION, rc, 3
+			skillinit SKILL_NORMAL_TAILORING, rc, 3
+			skillinit SKILL_NORMAL_CASTING, rc, 3
+			s(1) = "頭|首|体|背|手|足|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "spider" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 560
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("蜘蛛", cnven("spider"))
+			cpicref = 230
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 230
+			ref2 = 230
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "spider"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SPIDER
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 1
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 60
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(32, 6)
+			cdata(CDATA_DV_FIX, rc) = 170
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 50
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 5
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 12
+			skillinit SKILL_ATTR_LER, rc, 5
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 8
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 120
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_STEALTH, rc, 3
+			skillinit SKILL_NORMAL_ANATOMY, rc, 5
+			skillinit SKILL_NORMAL_TAILORING, rc, 3
+			s(1) = "指|指|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "golem" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 1
+			}
+			if ( dbspec == 9 ) {
+				return 40
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ゴーレム", cnven("golem"))
+			cpicref = 231
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("ゴーレムは魔力により生命を与えられた物質です。ゴーレムは他の種族に比べ遥かに高い体力を持っています。その代償としてか、彼らのマナと速度は、通常よりも劣っています。ゴーレムには毒への強い耐性があり、また朦朧状態にならないという利点があります。", "While certainly not a natural creature, the flows of the Etherwind have ingrained into them a spark of sentience. Strong as a team of oxen, and as tough as the rock they were sculpted from, those are pretty much the only strengths of a Golem. The wizards that made them wanted only laborers, not poets. Still, a Golem can slowly get better, and thankfully they lack the wit to even beome bored doing so.")
+			ref1 = 231
+			ref2 = 231
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "golem"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_GOLEM
+			cdata(CDATA_MELEE_STYLE, rc) = 9
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 700
+			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(0, 7)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 140
+			skillinit SKILL_ATTR_LIFE, rc, 150
+			skillinit SKILL_ATTR_MANA, rc, 70
+			skillinit SKILL_ATTR_STR, rc, 10
+			skillinit SKILL_ATTR_CON, rc, 14
+			skillinit SKILL_ATTR_DEX, rc, 4
+			skillinit SKILL_ATTR_PER, rc, 5
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 9
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 3
+			skillinit SKILL_ATTR_SPD, rc, 45
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 4
+			skillinit SKILL_NORMAL_WEIGHT_LIFTING, rc, 5
+			skillinit SKILL_NORMAL_MINING, rc, 3
+			skillinit SKILL_NORMAL_ALCHEMY, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "rock" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 1
+			}
+			if ( dbspec == 9 ) {
+				return 200
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("鉱物", cnven("rock"))
+			cpicref = 386
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 386
+			ref2 = 386
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "rock"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_ROCK
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 6
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 500
+			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(23, 11)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 200
+			skillinit SKILL_ATTR_LIFE, rc, 40
+			skillinit SKILL_ATTR_MANA, rc, 50
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 22
+			skillinit SKILL_ATTR_DEX, rc, 3
+			skillinit SKILL_ATTR_PER, rc, 8
+			skillinit SKILL_ATTR_LER, rc, 2
+			skillinit SKILL_ATTR_WIL, rc, 3
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 10
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_WEIGHT_LIFTING, rc, 3
+			skillinit SKILL_NORMAL_MINING, rc, 3
+			skillinit SKILL_NORMAL_MARKSMAN, rc, 3
+			s(1) = "頭|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "zanan" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 40
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ザナン", cnven("zanan"))
+			cpicref = 11
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 11
+			ref2 = 11
+			ref2 = 12
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "zanan"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_ZANAN
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 20)
+			cdata(CDATA_HEIGHT, rc) = 175
+			if ( rnd(100) < 50 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(11, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(12, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 11
+			skillinit SKILL_ATTR_PER, rc, 9
+			skillinit SKILL_ATTR_LER, rc, 9
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 9
+			skillinit SKILL_ATTR_CHA, rc, 10
+			skillinit SKILL_ATTR_SPD, rc, 80
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_PERFORMER, rc, 4
+			skillinit SKILL_NORMAL_HEALING, rc, 3
+			skillinit SKILL_NORMAL_TACTICS, rc, 3
+			skillinit SKILL_NORMAL_GENE_ENGINEER, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "skeleton" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 1
+			}
+			if ( dbspec == 9 ) {
+				return 30
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("骸骨", cnven("skeleton"))
+			cpicref = 241
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 241
+			ref2 = 241
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "skeleton"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SKELETON
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 5)
+			cdata(CDATA_HEIGHT, rc) = 160
+			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(10, 7)
+			if ( 1 == 1 ) {
+				sdata(SKILL_RES_DARKNESS, rc) = 500
+				sdata(SKILL_RES_NERVE, rc) = 500
+				sdata(SKILL_RES_NETHER, rc) = 500
+				sdata(SKILL_RES_FIRE, rc) = 80
+			}
+			if ( 1 == 2 ) {
+				sdata(SKILL_RES_MAGIC, rc) = 200
+				sdata(SKILL_RES_DARKNESS, rc) = 200
+				sdata(SKILL_RES_NERVE, rc) = 200
+				sdata(SKILL_RES_NETHER, rc) = 200
+				sdata(SKILL_RES_MIND, rc) = 200
+				sdata(SKILL_RES_SOUND, rc) = 200
+				sdata(SKILL_RES_CHAOS, rc) = 200
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 120
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 7
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 9
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_WEAPON_LONGSWORD, rc, 3
+			skillinit SKILL_NORMAL_SHIELD, rc, 2
+			skillinit SKILL_NORMAL_LOCK_PICKING, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "piece" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 1
+			}
+			if ( dbspec == 9 ) {
+				return 25
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("駒", cnven("piece"))
+			cpicref = 244
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 244
+			ref2 = 244
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "piece"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_PIECE
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 450
+			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(13, 7)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 9
+			skillinit SKILL_ATTR_CON, rc, 7
+			skillinit SKILL_ATTR_DEX, rc, 6
+			skillinit SKILL_ATTR_PER, rc, 4
+			skillinit SKILL_ATTR_LER, rc, 5
+			skillinit SKILL_ATTR_WIL, rc, 9
+			skillinit SKILL_ATTR_MAG, rc, 10
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 2
+			skillinit SKILL_NORMAL_LITERACY, rc, 3
+			skillinit SKILL_NORMAL_TACTICS, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "cat" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 50
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("猫", cnven("cat"))
+			cpicref = 253
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 253
+			ref2 = 253
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "cat"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_CAT
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 4
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 60
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(22, 7)
+			cdata(CDATA_DV_FIX, rc) = 200
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 120
+			skillinit SKILL_ATTR_STR, rc, 6
+			skillinit SKILL_ATTR_CON, rc, 7
+			skillinit SKILL_ATTR_DEX, rc, 7
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 7
+			skillinit SKILL_ATTR_CHA, rc, 12
+			skillinit SKILL_ATTR_SPD, rc, 110
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_PERFORMER, rc, 2
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 3
+			skillinit SKILL_NORMAL_EVASION, rc, 2
+			s(1) = "頭|首|体|背|手|足|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "dog" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 920
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("犬", cnven("dog"))
+			cpicref = 254
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 254
+			ref2 = 254
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "dog"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_DOG
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 80
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(23, 7)
+			cdata(CDATA_DV_FIX, rc) = 200
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 8
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 7
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 7
+			skillinit SKILL_ATTR_MAG, rc, 5
+			skillinit SKILL_ATTR_CHA, rc, 7
+			skillinit SKILL_ATTR_SPD, rc, 90
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 3
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 2
+			skillinit SKILL_NORMAL_SWIMMING, rc, 2
+			s(1) = "頭|首|体|背|手|足|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "roran" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 20
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ローラン", cnven("roran"))
+			cpicref = 4
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 4
+			ref2 = 4
+			ref2 = 4
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "roran"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_RORAN
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 150
+			if ( rnd(100) < 0 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(4, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(4, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 150
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 4
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 7
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 7
+			skillinit SKILL_ATTR_CHA, rc, 10
+			skillinit SKILL_ATTR_SPD, rc, 95
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_TRAVELING, rc, 3
+			skillinit SKILL_NORMAL_LITERACY, rc, 4
+			skillinit SKILL_NORMAL_INVESTING, rc, 2
+			skillinit SKILL_NORMAL_PERFORMER, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "rat" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 1100
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ねずみ", cnven("rat"))
+			cpicref = 255
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 255
+			ref2 = 255
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "rat"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_RAT
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 30
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(24, 7)
+			cdata(CDATA_DV_FIX, rc) = 250
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 80
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 4
+			skillinit SKILL_ATTR_DEX, rc, 8
+			skillinit SKILL_ATTR_PER, rc, 10
+			skillinit SKILL_ATTR_LER, rc, 3
+			skillinit SKILL_ATTR_WIL, rc, 3
+			skillinit SKILL_ATTR_MAG, rc, 2
+			skillinit SKILL_ATTR_CHA, rc, 3
+			skillinit SKILL_ATTR_SPD, rc, 85
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_STEALTH, rc, 3
+			skillinit SKILL_NORMAL_ANATOMY, rc, 2
+			skillinit SKILL_ACTIVE_RIDING, rc, 2
+			s(1) = "背|手|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "shell" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 450
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("甲殻", cnven("shell"))
+			cpicref = 256
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 256
+			ref2 = 256
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "shell"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SHELL
+			cdata(CDATA_MELEE_STYLE, rc) = 11
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 120
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(25, 7)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 300
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 7
+			skillinit SKILL_ATTR_CON, rc, 9
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 50
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_MEDITATION, rc, 3
+			skillinit SKILL_NORMAL_SENSE_QUALITY, rc, 3
+			skillinit SKILL_NORMAL_DISARM_TRAP, rc, 2
+			skillinit SKILL_NORMAL_SHIELD, rc, 3
+			skillinit SKILL_NORMAL_SWIMMING, rc, 2
+			s(1) = "背|手|手|指|指|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "catgod" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 5
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("猫の神", cnven("catgod"))
+			cpicref = 199
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 199
+			ref2 = 199
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "catgod"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_CAT_GOD
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 120
+			if ( rnd(100) < 0 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(1, 6)
+			cdata(CDATA_DV_FIX, rc) = 250
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 12
+			skillinit SKILL_ATTR_CON, rc, 13
+			skillinit SKILL_ATTR_DEX, rc, 21
+			skillinit SKILL_ATTR_PER, rc, 28
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 13
+			skillinit SKILL_ATTR_MAG, rc, 12
+			skillinit SKILL_ATTR_CHA, rc, 25
+			skillinit SKILL_ATTR_SPD, rc, 500
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_EVASION, rc, 3
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 3
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 2
+			s(1) = "頭|首|体|手|指|腕|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "machinegod" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 1
+			}
+			if ( dbspec == 9 ) {
+				return 5
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("機械の神", cnven("machinegod"))
+			cpicref = 349
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 349
+			ref2 = 349
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "machinegod"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_MACHINE_GOD
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 6
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 3000
+			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(19, 10)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 200
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 15
+			skillinit SKILL_ATTR_CON, rc, 14
+			skillinit SKILL_ATTR_DEX, rc, 11
+			skillinit SKILL_ATTR_PER, rc, 24
+			skillinit SKILL_ATTR_LER, rc, 12
+			skillinit SKILL_ATTR_WIL, rc, 15
+			skillinit SKILL_ATTR_MAG, rc, 8
+			skillinit SKILL_ATTR_CHA, rc, 10
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 5
+			skillinit SKILL_WEAPON_FIREARM, rc, 30
+			skillinit SKILL_NORMAL_MARKSMAN, rc, 3
+			s(1) = "頭|体|背|手|手|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "undeadgod" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 5
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("死霊の神", cnven("undeadgod"))
+			cpicref = 350
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 350
+			ref2 = 350
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "undeadgod"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_UNDEAD_GOD
+			cdata(CDATA_MELEE_STYLE, rc) = 6
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(300) + 300)
+			cdata(CDATA_HEIGHT, rc) = 1000
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(20, 10)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 150
+			skillinit SKILL_ATTR_MANA, rc, 500
+			skillinit SKILL_ATTR_STR, rc, 10
+			skillinit SKILL_ATTR_CON, rc, 13
+			skillinit SKILL_ATTR_DEX, rc, 14
+			skillinit SKILL_ATTR_PER, rc, 18
+			skillinit SKILL_ATTR_LER, rc, 16
+			skillinit SKILL_ATTR_WIL, rc, 18
+			skillinit SKILL_ATTR_MAG, rc, 28
+			skillinit SKILL_ATTR_CHA, rc, 7
+			skillinit SKILL_ATTR_SPD, rc, 110
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 4
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 3
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 5
+			s(1) = "首|体|背|手|手|指|指|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "machine" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 1
+			}
+			if ( dbspec == 9 ) {
+				return 15
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("機械", cnven("machine"))
+			cpicref = 270
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 270
+			ref2 = 270
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "machine"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_MACHINE
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 6
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 170
+			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(6, 8)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 7
+			skillinit SKILL_ATTR_CON, rc, 10
+			skillinit SKILL_ATTR_DEX, rc, 7
+			skillinit SKILL_ATTR_PER, rc, 9
+			skillinit SKILL_ATTR_LER, rc, 5
+			skillinit SKILL_ATTR_WIL, rc, 12
+			skillinit SKILL_ATTR_MAG, rc, 5
+			skillinit SKILL_ATTR_CHA, rc, 6
+			skillinit SKILL_ATTR_SPD, rc, 65
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_MEDITATION, rc, 3
+			skillinit SKILL_NORMAL_LOCK_PICKING, rc, 3
+			skillinit SKILL_NORMAL_DISARM_TRAP, rc, 3
+			skillinit SKILL_NORMAL_CARPENTRY, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "wisp" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 25
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ウィスプ", cnven("wisp"))
+			cpicref = 272
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 272
+			ref2 = 272
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "wisp"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_WISP
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 4
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 40
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(8, 8)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 150
+			skillinit SKILL_ATTR_MANA, rc, 150
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 10
+			skillinit SKILL_ATTR_DEX, rc, 10
+			skillinit SKILL_ATTR_PER, rc, 20
+			skillinit SKILL_ATTR_LER, rc, 10
+			skillinit SKILL_ATTR_WIL, rc, 15
+			skillinit SKILL_ATTR_MAG, rc, 15
+			skillinit SKILL_ATTR_CHA, rc, 4
+			skillinit SKILL_ATTR_SPD, rc, 35
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 3
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 5
+			skillinit SKILL_NORMAL_MEDITATION, rc, 4
+			s(1) = "頭|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "bird" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 1000
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("鳥", cnven("bird"))
+			cpicref = 274
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 274
+			ref2 = 274
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "bird"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_BIRD
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 40
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(10, 8)
+			cdata(CDATA_DV_FIX, rc) = 200
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 80
+			skillinit SKILL_ATTR_MANA, rc, 80
+			skillinit SKILL_ATTR_STR, rc, 5
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 10
+			skillinit SKILL_ATTR_PER, rc, 11
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 5
+			skillinit SKILL_ATTR_CHA, rc, 7
+			skillinit SKILL_ATTR_SPD, rc, 100
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_ANATOMY, rc, 3
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 3
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 2
+			s(1) = "頭|体|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "seamonster" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 25
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("海魔", cnven("seamonster"))
+			cpicref = 98
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 98
+			ref2 = 98
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "seamonster"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SEA_MONSTER
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 180
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(32, 2)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 10
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 7
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 9
+			skillinit SKILL_ATTR_CHA, rc, 2
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_FAITH, rc, 4
+			skillinit SKILL_NORMAL_STEALTH, rc, 2
+			skillinit SKILL_NORMAL_SWIMMING, rc, 30
+			s(1) = "頭|首|体|背|手|手|腕|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "catsister" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 5
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("ケモビト", cnven("catsister"))
+			cpicref = 354
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 354
+			ref2 = 354
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "catsister"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_CAT_SISTER
+			cdata(CDATA_MELEE_STYLE, rc) = 1
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (10 + rnd(4))
+			cdata(CDATA_HEIGHT, rc) = 140
+			if ( rnd(100) < 0 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(24, 10)
+			cdata(CDATA_DV_FIX, rc) = 200
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 30
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 7
+			skillinit SKILL_ATTR_CON, rc, 5
+			skillinit SKILL_ATTR_DEX, rc, 13
+			skillinit SKILL_ATTR_PER, rc, 15
+			skillinit SKILL_ATTR_LER, rc, 8
+			skillinit SKILL_ATTR_WIL, rc, 10
+			skillinit SKILL_ATTR_MAG, rc, 13
+			skillinit SKILL_ATTR_CHA, rc, 22
+			skillinit SKILL_ATTR_SPD, rc, 200
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 4
+			skillinit SKILL_NORMAL_TWO_HAND, rc, 6
+			skillinit SKILL_NORMAL_TACTICS, rc, 4
+			skillinit SKILL_NORMAL_JEWELER, rc, 2
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "mutant" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 50
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("カオスシェイプ", cnven("mutant"))
+			cpicref = 3
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("カオスシェイプについて分かっていることは、ほとんどありません。異形の人とも呼ばれる彼らは、かろうじて人の形を保っています。カオスシェイプは成長とともに新しい身体の部位を獲得しますが、何が生えてくるかは予測不可能です。", "A living warning of the perils of Gene-Engineering, Chaos, and why pregnant women should not be caught in the Etherwind, most mutants live short and pain-filled lives. Still, one in every thousand not only lives but thrives due to the changes wrought on them. Healing quickly due to their quickened blood, and at least starting out mostly human-like, Mutants are the proof that a third hand is always helpful.")
+			ref1 = 3
+			ref2 = 3
+			ref2 = 4
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 1
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "mutant"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_MUTANT
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 1)
+			cdata(CDATA_HEIGHT, rc) = 180
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(3, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(4, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 100
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 9
+			skillinit SKILL_ATTR_CON, rc, 5
+			skillinit SKILL_ATTR_DEX, rc, 5
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 7
+			skillinit SKILL_ATTR_WIL, rc, 9
+			skillinit SKILL_ATTR_MAG, rc, 7
+			skillinit SKILL_ATTR_CHA, rc, 1
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 3
+			skillinit SKILL_NORMAL_HEALING, rc, 4
+			skillinit SKILL_NORMAL_GENE_ENGINEER, rc, 4
+			s(1) = "体|手|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "yeek" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 500
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("イーク", cnven("yeek"))
+			cpicref = 378
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 378
+			ref2 = 378
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "yeek"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_YEEK
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
+			cdata(CDATA_HEIGHT, rc) = 90
+			if ( rnd(100) < 50 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(15, 11)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 80
+			skillinit SKILL_ATTR_MANA, rc, 90
+			skillinit SKILL_ATTR_STR, rc, 4
+			skillinit SKILL_ATTR_CON, rc, 7
+			skillinit SKILL_ATTR_DEX, rc, 6
+			skillinit SKILL_ATTR_PER, rc, 7
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 6
+			skillinit SKILL_ATTR_SPD, rc, 90
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_MEDITATION, rc, 3
+			skillinit SKILL_NORMAL_NEGOTIATION, rc, 4
+			skillinit SKILL_NORMAL_FISHING, rc, 2
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "yith" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 25
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("異星主", cnven("yith"))
+			cpicref = 429
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 429
+			ref2 = 429
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "yith"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_YITH
+			cdata(CDATA_MELEE_STYLE, rc) = 6
+			cdata(CDATA_CAST_STYLE, rc) = 3
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 1000)
+			cdata(CDATA_HEIGHT, rc) = 170
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(0, 13)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 150
+			skillinit SKILL_ATTR_MANA, rc, 200
+			skillinit SKILL_ATTR_STR, rc, 13
+			skillinit SKILL_ATTR_CON, rc, 14
+			skillinit SKILL_ATTR_DEX, rc, 9
+			skillinit SKILL_ATTR_PER, rc, 15
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 11
+			skillinit SKILL_ATTR_CHA, rc, 11
+			skillinit SKILL_ATTR_SPD, rc, 70
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 4
+			skillinit SKILL_NORMAL_CASTING, rc, 4
+			skillinit SKILL_NORMAL_MAGIC_DEVICE, rc, 3
+			s(1) = "手|手|手|手|指|指|指|指|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "servant" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 5
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("神の化身", cnven("servant"))
+			cpicref = 1
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 1
+			ref2 = 1
+			ref2 = 2
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "servant"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_SERVANT
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 100)
+			cdata(CDATA_HEIGHT, rc) = 165
+			if ( rnd(100) < 52 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(1, 0)
+			if ( cdata(CDATA_SEX, rc) == 1 ) {
+				cdata(CDATA_PIC, rc) = xy2pic(2, 0)
+			}
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 90
+			skillinit SKILL_ATTR_MANA, rc, 150
+			skillinit SKILL_ATTR_STR, rc, 6
+			skillinit SKILL_ATTR_CON, rc, 6
+			skillinit SKILL_ATTR_DEX, rc, 6
+			skillinit SKILL_ATTR_PER, rc, 6
+			skillinit SKILL_ATTR_LER, rc, 6
+			skillinit SKILL_ATTR_WIL, rc, 6
+			skillinit SKILL_ATTR_MAG, rc, 6
+			skillinit SKILL_ATTR_CHA, rc, 6
+			skillinit SKILL_ATTR_SPD, rc, 100
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 3
+			skillinit SKILL_NORMAL_TACTICS, rc, 3
+			skillinit SKILL_NORMAL_CASTING, rc, 4
+			skillinit SKILL_NORMAL_NEGOTIATION, rc, 3
+			skillinit SKILL_WEAPON_THROWING, rc, 3
+			skillinit SKILL_NORMAL_DUAL_WIELD, rc, 4
+			skillinit SKILL_WEAPON_FIREARM, rc, 4
+			skillinit SKILL_NORMAL_TWO_HAND, rc, 3
+			s(1) = "頭|首|体|背|手|手|指|指|腕|腰|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "horse" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 1000
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("馬", cnven("horse"))
+			cpicref = 262
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 262
+			ref2 = 262
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "horse"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_HORSE
+			cdata(CDATA_MELEE_STYLE, rc) = 3
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 250
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(31, 7)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 150
+			skillinit SKILL_ATTR_MANA, rc, 50
+			skillinit SKILL_ATTR_STR, rc, 9
+			skillinit SKILL_ATTR_CON, rc, 8
+			skillinit SKILL_ATTR_DEX, rc, 4
+			skillinit SKILL_ATTR_PER, rc, 5
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 3
+			skillinit SKILL_ATTR_CHA, rc, 6
+			skillinit SKILL_ATTR_SPD, rc, 125
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_HEALING, rc, 4
+			skillinit SKILL_NORMAL_WEIGHT_LIFTING, rc, 3
+			skillinit SKILL_ACTIVE_RIDING, rc, 2
+			s(1) = "体|足|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "god" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 1
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("神", cnven("god"))
+			cpicref = 393
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 393
+			ref2 = 393
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "god"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_GOD
+			cdata(CDATA_MELEE_STYLE, rc) = 0
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - 999999
+			cdata(CDATA_HEIGHT, rc) = 180
+			if ( rnd(100) < 50 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(30, 11)
+			cdata(CDATA_DV_FIX, rc) = 300
+			cdata(CDATA_PV_FIX, rc) = 200
+			skillinit SKILL_ATTR_LIFE, rc, 200
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 18
+			skillinit SKILL_ATTR_CON, rc, 18
+			skillinit SKILL_ATTR_DEX, rc, 18
+			skillinit SKILL_ATTR_PER, rc, 18
+			skillinit SKILL_ATTR_LER, rc, 18
+			skillinit SKILL_ATTR_WIL, rc, 18
+			skillinit SKILL_ATTR_MAG, rc, 18
+			skillinit SKILL_ATTR_CHA, rc, 18
+			skillinit SKILL_ATTR_SPD, rc, 150
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 6
+			skillinit SKILL_NORMAL_EVASION, rc, 3
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 3
+			skillinit SKILL_NORMAL_EYE_OF_MIND, rc, 3
+			skillinit SKILL_WEAPON_FIREARM, rc, 5
+			skillinit SKILL_WEAPON_BOW, rc, 5
+			skillinit SKILL_WEAPON_THROWING, rc, 5
+			skillinit SKILL_WEAPON_CROSSBOW, rc, 5
+			skillinit SKILL_WEAPON_SCYTHE, rc, 5
+			skillinit SKILL_WEAPON_STAVE, rc, 5
+			skillinit SKILL_WEAPON_POLEARM, rc, 5
+			skillinit SKILL_WEAPON_BLUNT, rc, 5
+			skillinit SKILL_WEAPON_AXE, rc, 5
+			skillinit SKILL_WEAPON_SHORTSWORD, rc, 5
+			skillinit SKILL_WEAPON_LONGSWORD, rc, 5
+			skillinit SKILL_NORMAL_DUAL_WIELD, rc, 5
+			skillinit SKILL_NORMAL_TWO_HAND, rc, 5
+			skillinit SKILL_NORMAL_TACTICS, rc, 6
+			skillinit SKILL_NORMAL_CASTING, rc, 6
+			skillinit SKILL_NORMAL_CONTROL_MAGIC, rc, 6
+			skillinit SKILL_NORMAL_MARKSMAN, rc, 6
+			skillinit SKILL_NORMAL_PERFORMER, rc, 3
+			s(1) = "手|手|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "quickling" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 1
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("クイックリング", cnven("quickling"))
+			cpicref = 281
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 281
+			ref2 = 281
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "quickling"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_QUICKLING
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 25
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(17, 8)
+			sdata(SKILL_RES_MAGIC, rc) = 500
+			if ( 0 != 0 ) {
+				sdata(rsres0, rc) = 500
+			}
+			if ( 0 != 0 ) {
+				sdata(rsres0, rc) = 500
+			}
+			cdata(CDATA_DV_FIX, rc) = 550
+			cdata(CDATA_PV_FIX, rc) = 100
+			skillinit SKILL_ATTR_LIFE, rc, 3
+			skillinit SKILL_ATTR_MANA, rc, 40
+			skillinit SKILL_ATTR_STR, rc, 2
+			skillinit SKILL_ATTR_CON, rc, 4
+			skillinit SKILL_ATTR_DEX, rc, 18
+			skillinit SKILL_ATTR_PER, rc, 16
+			skillinit SKILL_ATTR_LER, rc, 5
+			skillinit SKILL_ATTR_WIL, rc, 8
+			skillinit SKILL_ATTR_MAG, rc, 9
+			skillinit SKILL_ATTR_CHA, rc, 7
+			skillinit SKILL_ATTR_SPD, rc, 750
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_STEALTH, rc, 3
+			skillinit SKILL_NORMAL_EVASION, rc, 7
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 6
+			s(1) = "頭|体|背|手|手|指|指|腕|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "metal" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 0
+			}
+			if ( dbspec == 9 ) {
+				return 1
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("メタル", cnven("metal"))
+			cpicref = 252
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 252
+			ref2 = 252
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "metal"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_METAL
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 0
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 12
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(21, 7)
+			sdata(SKILL_RES_MAGIC, rc) = 800
+			if ( 0 != 0 ) {
+				sdata(rsres0, rc) = 800
+			}
+			if ( 0 != 0 ) {
+				sdata(rsres0, rc) = 800
+			}
+			cdata(CDATA_DV_FIX, rc) = 150
+			cdata(CDATA_PV_FIX, rc) = 1000
+			skillinit SKILL_ATTR_LIFE, rc, 1
+			skillinit SKILL_ATTR_MANA, rc, 100
+			skillinit SKILL_ATTR_STR, rc, 4
+			skillinit SKILL_ATTR_CON, rc, 1
+			skillinit SKILL_ATTR_DEX, rc, 3
+			skillinit SKILL_ATTR_PER, rc, 32
+			skillinit SKILL_ATTR_LER, rc, 2
+			skillinit SKILL_ATTR_WIL, rc, 4
+			skillinit SKILL_ATTR_MAG, rc, 4
+			skillinit SKILL_ATTR_CHA, rc, 16
+			skillinit SKILL_ATTR_SPD, rc, 640
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 1
+			skillinit SKILL_NORMAL_MAGIC_CAPACITY, rc, 4
+			skillinit SKILL_NORMAL_GREATER_EVASION, rc, 6
+			skillinit SKILL_NORMAL_JEWELER, rc, 2
+			s(1) = "頭|体|背|"
+			gosub *set_figure
+		}
+		return
+	}
+	if ( dbidn == "vehicle" ) {
+		if ( dbmode == DBMODE_REF_SPEC ) {
+			if ( dbspec == 7 ) {
+				return 1
+			}
+			if ( dbspec == 9 ) {
+				return 15
+			}
+			return
+		}
+		if ( dbmode == DBMODE_REF ) {
+			racename = lang("乗用機械", cnven("vehicle"))
+			cpicref = 471
+			return
+		}
+		if ( dbmode == DBMODE_REF_CM ) {
+			buff = lang("", "")
+			ref1 = 471
+			ref2 = 471
+		}
+		if ( dbmode == DBMODE_REF_PLAYABLE ) {
+			return 0
+		}
+		if ( dbmode == DBMODE_SET ) {
+			cdatan(CDATAN_RACE, rc) = "vehicle"
+			cdata(CDATA_RACE_ID, rc) = DB_RACE_BEHICLE
+			cdata(CDATA_MELEE_STYLE, rc) = 10
+			cdata(CDATA_CAST_STYLE, rc) = 6
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
+			cdata(CDATA_HEIGHT, rc) = 240
+			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
+			if ( rnd(100) < 53 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			else {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			if ( mode == MODELIST_CHARA_CREATION ) {
+				cdata(CDATA_SEX, rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cdata(CDATA_SEX, rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cdata(CDATA_SEX, rc) = 1
+			}
+			cdata(CDATA_PIC, rc) = xy2pic(9, 14)
+			cdata(CDATA_DV_FIX, rc) = 100
+			cdata(CDATA_PV_FIX, rc) = 150
+			skillinit SKILL_ATTR_LIFE, rc, 120
+			skillinit SKILL_ATTR_MANA, rc, 60
+			skillinit SKILL_ATTR_STR, rc, 11
+			skillinit SKILL_ATTR_CON, rc, 13
+			skillinit SKILL_ATTR_DEX, rc, 4
+			skillinit SKILL_ATTR_PER, rc, 3
+			skillinit SKILL_ATTR_LER, rc, 4
+			skillinit SKILL_ATTR_WIL, rc, 5
+			skillinit SKILL_ATTR_MAG, rc, 3
+			skillinit SKILL_ATTR_CHA, rc, 11
+			skillinit SKILL_ATTR_SPD, rc, 155
+			skillinit SKILL_WEAPON_MARTIAL_ARTS, rc, 2
+			skillinit SKILL_NORMAL_EVASION, rc, 11
+			skillinit SKILL_NORMAL_LOCK_PICKING, rc, 3
+			skillinit SKILL_NORMAL_DISARM_TRAP, rc, 3
+			s(1) = "頭|体|背|手|手|腰|足|足|"
+			gosub *set_figure
+		}
+		return
+	}
+	return
+
+
+
+
 
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/command.hsp ../2.14-borscht/command.hsp
--- ../2.13-borscht/command.hsp	2022-06-26 12:14:12.207102200 -0700
+++ ../2.14-borscht/command.hsp	2022-09-18 12:36:59.242112700 -0700
@@ -217,14 +217,14 @@
 	}
 	snd SOUNDLIST_ENC
 	comctrl = 2
 	gosub *com_import
 	if ( stat == 1 ) {
-		goto *extract_map
+		goto *label_5895
 	}
 	txt lang("どのルームを訪問する？ ", "Which room do you want to visit? ")
-	goto *turn_end
+	goto *label_9247
 
 *com_import
 	if ( dbg_noautosave == 0 & gdata(GDATA_WIZARD) == 0 ) {
 		snd SOUNDLIST_WRITE1
 		gosub *game_save
@@ -296,11 +296,11 @@
 		}
 	}
 
 *com_import_loop
 	if ( 1 == 0 ) {
-		goto *findLocation
+		goto *label_5349
 	}
 	redraw 0
 	if ( comctrl == 0 | comctrl == 2 ) {
 		s = lang("ルーム一覧", "Room List")
 	}
@@ -448,11 +448,11 @@
 		gosub *screen_draw
 		return 0
 	}
 	goto *com_import_loop
 
-*findLocation
+*label_5349
 	if ( tlocinitx != 0 | tlocinity != 0 ) {
 		tlocx = tlocinitx
 		tlocy = tlocinity
 	}
 	else {
@@ -463,13 +463,13 @@
 		scposval = 0
 	}
 	else {
 		scposval = 1
 		if ( cdata(CDATA_TARGET, CHARA_PLAYER) == 0 ) {
-			gosub *findTarget
+			gosub *label_5740
 		}
-		gosub *com_findTarget
+		gosub *label_5748
 		if ( listmax == 0 ) {
 			txt lang("視界内にターゲットは存在しない。", "You look around and find nothing.")
 		}
 		repeat listmax
 			if ( list(0, cnt) == 0 ) {
@@ -481,11 +481,11 @@
 				break
 			}
 		loop
 	}
 
-*findLocation_WHILE1
+*label_5352
 	if ( 1 == 0 ) {
 		goto *com_target
 	}
 	if ( tlochomex != 0 | tlochomey != 0 ) {
 		tlocx = tlochomex
@@ -566,11 +566,11 @@
 	if ( homemapmode == 1 ) {
 		if ( meadmap == 0 ) {
 			if ( key == key_enter ) {
 				gosub *com_mapset
 				keyrelease
-				goto *findLocation_WHILE1_CONTINUE
+				goto *label_5357
 			}
 		}
 		stick a, 768
 		if ( meadmap == 0 ) {
 			if ( a == 256 ) {
@@ -580,11 +580,11 @@
 		if ( meadmap == 0 ) {
 			if ( a == 512 ) {
 				if ( chipm(CHIPM_ROLE, map(tlocx, tlocy, MAP_TILE_ID)) == MAP_CHIP_ROLE_CROP | chipm(CHIPM_ROLE, map(tlocx, tlocy, MAP_TILE_ID)) == MAP_CHIP_ROLE_DRYROCK | chipm(CHIPM_ROLE, map(tlocx, tlocy, MAP_TILE_ID)) == MAP_CHIP_ROLE_COMPOST ) {
 					snd SOUNDLIST_FAIL1
 					keyrelease
-					goto *findLocation_WHILE1_CONTINUE
+					goto *label_5357
 				}
 				tile = map(tlocx, tlocy, MAP_TILE_ID)
 				snd SOUNDLIST_CURSOR1
 				keyrelease
 			}
@@ -687,11 +687,11 @@
 	}
 	if ( key == key_enter ) {
 		if ( findlocmode == 1 ) {
 			if ( cansee == 0 | (chipm(CHIPM_ATTRIB, map(tlocx, tlocy, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS) ) {
 				txt lang("その場所は見えない。", "You can't see the location.")
-				goto *findLocation_WHILE1_CONTINUE
+				goto *label_5357
 			}
 			snd SOUNDLIST_OK1
 			if ( tlocx == cdata(CDATA_X, CHARA_PLAYER) & tlocy == cdata(CDATA_Y, CHARA_PLAYER) ) {
 				if ( gdata(GDATA_RIDER) != 0 ) {
 					rc = gdata(GDATA_RIDER)
@@ -705,11 +705,11 @@
 						promptmax++
 					loop
 					val = promptx, prompty, 200, 1
 					gosub *prompt_key
 					if ( stat == 0 ) {
-						goto *findLocation_WHILE1_CONTINUE
+						goto *label_5357
 					}
 					if ( rtval == 1 ) {
 						rc = cdata(CDATA_TAGTEAM_PARTNER, rc)
 					}
 				}
@@ -743,20 +743,20 @@
 		scposval = 0
 		gosub *screen_draw
 		return -1
 	}
 
-*findLocation_WHILE1_CONTINUE
-	goto *findLocation_WHILE1
+*label_5357
+	goto *label_5352
 
 *com_target
 	procid = (procid + 1) \ 4
 	proclist(procid) = "com_target" + " ct:" + ct
 	page = 0
 	pagesize = 16
 	cs_bk = -1
-	gosub *com_findTarget
+	gosub *label_5748
 	if ( listmax == 0 ) {
 		msgdup++
 		txt lang("視界内にターゲットは存在しない。", "You look around and find nothing.")
 		gosub *screen_draw
 		goto *pc_turn
@@ -981,11 +981,11 @@
 		if ( allyctrl == 2 ) {
 			if ( cdata(CDATA_IN_TAGTEAM, cnt) != 0 ) {
 				continue
 			}
 		}
-		if ( cdata(CDATA_AREA, cnt) != AREA_NONE ) {
+		if ( cdata(CDATA_AREA, cnt) != 0 ) {
 			if ( allyctrl == 1 | allyctrl == 2 ) {
 				continue
 			}
 		}
 		if ( allyctrl != 1 ) {
@@ -1011,11 +1011,11 @@
 				continue
 			}
 			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
 				continue
 			}
-			if ( cdata(CDATA_AREA, cnt) != AREA_NONE ) {
+			if ( cdata(CDATA_AREA, cnt) != 0 ) {
 				continue
 			}
 		}
 		if ( cnt == 0 ) {
 			continue
@@ -1182,11 +1182,11 @@
 			cs_list lang("決定", "Proceed"), wx + 84, wy + 66 + cnt * 19 - 1, 19
 			continue
 		}
 		if ( allyctrl == 0 | allyctrl == 2 | allyctrl == 3 | allyctrl == 4 | allyctrl == 5 | allyctrl == 6 | allyctrl == 7 | allyctrl == 8 ) {
 			s = "" + cdatan(CDATAN_AKA, i) + " " + cdatan(CDATAN_NAME, i)
-			if ( cdata(CDATA_AREA, i) != AREA_NONE ) {
+			if ( cdata(CDATA_AREA, i) != 0 ) {
 				s = s + "(" + mapname(cdata(CDATA_AREA, i)) + ")"
 			}
 			if ( cbit(CHARA_BIT_RIDE, i) ) {
 				s += lang("(乗馬)", "(Riding")
 			}
@@ -1862,11 +1862,11 @@
 	cdata(CDATA_GOD, r1) = cdata(CDATA_GOD, tc)
 	repeat 600
 		sdata(cnt, r1) = 1
 	loop
 	if ( tc == CHARA_PLAYER ) {
-		gosub *god_effect
+		gosub *label_5210
 	}
 	if ( cdata(CDATA_GOD, CHARA_PLAYER) != GOD_EYTH ) {
 		buff += "<title1>◆ " + name(tc) + "の受けている影響<def>\n"
 		repeat 600
 			sdata(cnt, MAX_CHARA_NC) = sdata(cnt + STARTING_SKILL_SPACT, tc) / 1000000
@@ -2098,11 +2098,11 @@
 		}
 		listn(0, cnt) = s
 	loop
 	r1 = tc
 	if ( cdata(CDATA_RACE_ID, r1) == 0 ) {
-		gosub *raceID_fix
+		gosub *label_6750
 	}
 	if ( cbit(CHARA_BIT_INCOGNITO, tc) == TRUE ) {
 		list(0, listmax) = 1, 99999
 		listn(0, listmax) = lang("[bit]", "[bit]") + lang("あなたは変装している", "You are disguising yourself.")
 		listmax++
@@ -2379,16 +2379,16 @@
 		listn(0, listmax) = lang("[覚醒]", "[AWAKE]") + lang("あなたは矢系魔法を好む", "You prefer the magic arrows.")
 		listmax++
 	}
 	if ( cdata(CDATA_SEALED_MAGIC, tc) == 1 ) {
 		list(0, listmax) = 1, 99998
-		listn(0, listmax) = lang("[覚醒]", "[AWAKE]") + lang("あなたは魔法を封印している", "You got .")
+		listn(0, listmax) = lang("[覚醒]", "[AWAKE]") + lang("あなたは魔法を封印している", "You forbid using spells.")
 		listmax++
 	}
 	if ( cdata(CDATA_SEALED_ABILITY, tc) == 1 ) {
 		list(0, listmax) = 1, 99998
-		listn(0, listmax) = lang("[覚醒]", "[AWAKE]") + lang("あなたは技能を封印している", "You got .")
+		listn(0, listmax) = lang("[覚醒]", "[AWAKE]") + lang("あなたは技能を封印している", "You forbid using special actions.")
 		listmax++
 	}
 	if ( cbit(CHARA_BIT_SHOP_ELEGANCE, tc) == TRUE ) {
 		list(0, listmax) = 1, 99998
 		listn(0, listmax) = lang("[営業]", "[SHOP]") + lang("あなたには気品がある[店の客質上昇]", "You got elegance.")
@@ -2419,11 +2419,11 @@
 		listn(0, listmax) = lang("[性格]", "[CHARA]") + lang("あなたは" + _seikaku(cdata(CDATA_ROLE_SHOP_LEVEL, tc)) + "だ[マップ開始時の初期パワーゲージ+3]", "You are " + _seikaku(cdata(CDATA_ROLE_SHOP_LEVEL, tc)) + ". [Power gauge +3 at the start of the map]")
 		listmax++
 	}
 	if ( cdata(CDATA_ROLE_RESTOCK, tc) > 0 ) {
 		list(0, listmax) = 1, 99998
-		listn(0, listmax) = lang("[性格]", "[CHARA]") + lang("あなたには" + _seikaku(cdata(CDATA_ROLE_RESTOCK, tc)) + "な一面もある[被ダメージ時にパワーゲージ+1]", "You have a " + _seikaku(cdata(CDATA_ROLE_SHOP_LEVEL, tc)) + " aspect. [Power gauge +1 when damaged]")
+		listn(0, listmax) = lang("[性格]", "[CHARA]") + lang("あなたには" + _seikaku(cdata(CDATA_ROLE_RESTOCK, tc)) + "な一面もある[被ダメージ時にパワーゲージ+1]", "You have a " + _seikaku(cdata(CDATA_ROLE_RESTOCK, tc)) + " aspect. [Power gauge +1 when damaged]")
 		listmax++
 	}
 	if ( dump_return == 1 ) {
 		dump_return = 0
 		return
@@ -2440,14 +2440,14 @@
 		}
 		repeat 15
 			if ( kakunin == 100 ) {
 				break
 			}
-			if ( inv(40 + cnt * 2, ci) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 				break
 			}
-			val = inv(40 + cnt * 2, ci), inv(40 + cnt * 2 + 1, ci), 1, 0
+			val = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci), inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci), 1, 0
 			gosub *item_encdetail
 			if ( s == "" ) {
 				continue
 			}
 			xnoteadd s
@@ -2781,11 +2781,11 @@
 		rq = cnt
 		val = 2
 		gosub *talk_quest
 	loop
 	val = 0
-	gosub *quest_info2
+	gosub *itemNameSub
 	repeat pagesize / 2 - noteinfo(0) \ (pagesize / 2)
 		noteadd ""
 	loop
 	noteadd " - Quest Item - "
 	noteadd ""
@@ -2944,11 +2944,11 @@
 		loop
 	}
 	noteadd " - Completed Quests - "
 	noteadd ""
 	val = 1
-	gosub *quest_info2
+	gosub *itemNameSub
 	listmax = noteinfo(0)
 	redraw 0
 	showtitle lang("ジャーナル", "Journal"), strhint2 + strhint3, 236, 1
 	drawmenu 2
 	wx = (windoww - 736) / 2 + inf_screenx
@@ -3099,11 +3099,11 @@
 					}
 				}
 			}
 		}
 	}
-	gosub *quest_update
+	gosub *label_8933
 	listmax = 0
 	page = 0
 	pagesize = 4
 	cs = 0
 	cc = CHARA_PLAYER
@@ -3125,11 +3125,11 @@
 		list(0, listmax) = cnt, qdata(QDATA_LEVEL, cnt)
 		listmax++
 	loop
 	if ( listmax == 0 ) {
 		txt lang("新しい依頼は掲示されていないようだ。", "It seems there are no new notices.")
-		goto *turn_end
+		goto *label_9247
 	}
 	gosub *sort_list
 	gsel BUFFER_INF
 	pos 960, 96
 	picload exedir + "graphic\\deco_board.bmp", 1
@@ -3165,11 +3165,11 @@
 		}
 	}
 
 *com_quest_loop
 	if ( 1 == 0 ) {
-		goto *com_listNpc
+		goto *label_5444
 	}
 	redraw 0
 	s = lang("掲載されている依頼", "Notice Board"), strhint2 + strhint3b
 	gmode 0
 	pos 0, 0
@@ -3290,11 +3290,11 @@
 		client = -1
 		if ( chatteleport == 1 ) {
 			chatteleport = 0
 			goto *map_exit
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( key == key_pageup ) {
 		if ( pagemax != 0 ) {
 			snd SOUNDLIST_POP1
 			page++
@@ -3307,15 +3307,15 @@
 			page--
 			goto *com_quest_loop_pgchk
 		}
 	}
 	if ( key == key_cancel ) {
-		goto *turn_end
+		goto *label_9247
 	}
 	goto *com_quest_loop
 
-*com_listNpc
+*label_5444
 	snd SOUNDLIST_POP2
 	listmax = 0
 	page = 0
 	pagesize = 16
 	cs = 0
@@ -3359,23 +3359,36 @@
 			}
 			if ( cdata(CDATA_RELATION, cnt) != RELATION_ALLY & cnt >= 16 ) {
 				continue
 			}
 		}
-		if ( cnt == 0 ) {
-			continue
+		if ( allyctrl == 5 ) {
+			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+				continue
+			}
+			if ( cnt == rc ) {
+				continue
+			}
+			if ( dist(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt)) > 1 ) {
+				continue
+			}
+		}
+		if ( allyctrl != 5 ) {
+			if ( cnt == 0 ) {
+				continue
+			}
 		}
 		if ( cbit(CHARA_BIT_GUARD_TEMP, cnt) == TRUE ) {
 			continue
 		}
 		list(0, listmax) = cnt, -cdata(CDATA_LEVEL, cnt)
 		listmax++
 	loop
 	gosub *sort_list
 	windowshadow = 1
 
-*com_listNpc_loop_pgchk
+*label_5447
 	redraw 0
 	cs_bk = -1
 	pagemax = (listmax - 1) / pagesize
 	if ( page < 0 ) {
 		page = pagemax
@@ -3384,16 +3397,21 @@
 		if ( page > pagemax ) {
 			page = 0
 		}
 	}
 
-*com_listNpc_loop
+*label_5448
 	if ( 1 == 0 ) {
 		goto *com_reserve
 	}
 	redraw 0
-	s = lang("NPC一覧", "NPC List"), strhint2 + strhint3
+	if ( allyctrl != 5 ) {
+		s = lang("NPC一覧", "NPC List"), strhint2 + strhint3
+	}
+	if ( allyctrl == 5 ) {
+		s = lang("候補者一覧", "Chara List"), strhint2 + strhint3
+	}
 	display_window (windoww - 700) / 2 + inf_screenx, winposy(448), 700, 448
 	if ( allyctrl == 0 ) {
 		s = lang("給料", "Wage")
 	}
 	if ( allyctrl == 1 ) {
@@ -3403,11 +3421,19 @@
 		s = lang("レベル", "Level")
 	}
 	if ( allyctrl == 4 ) {
 		s = lang("ガードブレイク", "GuardBreak")
 	}
-	display_topic lang("NPCの名前", "Name"), wx + 28, wy + 36
+	if ( allyctrl == 5 ) {
+		s = lang("出血度", "Bleeding Lv")
+	}
+	if ( allyctrl != 5 ) {
+		display_topic lang("NPCの名前", "Name"), wx + 28, wy + 36
+	}
+	if ( allyctrl == 5 ) {
+		display_topic lang("候補者の名前", "Name"), wx + 28, wy + 36
+	}
 	display_topic lang("情報", "Info"), wx + 350, wy + 36
 	if ( allyctrl != 2 ) {
 		display_topic s, wx + 490, wy + 36
 	}
 	keyrange = 0
@@ -3492,11 +3518,13 @@
 				}
 				else {
 					s += cnven(strfemale)
 				}
 			}
-			s += lang(" ", "(") + calcage(i) + "" + lang("歳", ")")
+			if ( allyctrl != 5 ) {
+				s += lang(" ", "(") + calcage(i) + "" + lang("歳", ")")
+			}
 		}
 		if ( cdata(CDATA_EXIST, i) == CHAR_STATE_ALLY_DEAD | cdata(CDATA_EXIST, i) == CHAR_STATE_ADV_DEAD | cdata(CDATA_EXIST, i) == CHAR_STATE_DEAD ) {
 			if ( cdata(CDATA_CAN_REVIVE, i) <= 0 ) {
 				s += lang("(マップ切替えるまで復活不能)", "(revival impossible until switch area)")
 			}
@@ -3515,10 +3543,15 @@
 				mes s + lang(" gold", "gp")
 			}
 			if ( allyctrl == 3 ) {
 				s = "" + cdata(CDATA_LEVEL, i)
 			}
+			if ( allyctrl == 5 ) {
+				s = "" + cdata(CDATA_CONDITION_BLEED, i)
+				pos wx + 512, wy + 66 + cnt * 19 + 2
+				mes s
+			}
 		}
 	loop
 	if ( keyrange != 0 ) {
 		cs_bk = cs
 	}
@@ -3538,24 +3571,24 @@
 	}
 	if ( key == key_pageup ) {
 		if ( pagemax != 0 ) {
 			snd SOUNDLIST_POP1
 			page++
-			goto *com_listNpc_loop_pgchk
+			goto *label_5447
 		}
 	}
 	if ( key == key_pagedown ) {
 		if ( pagemax != 0 ) {
 			snd SOUNDLIST_POP1
 			page--
-			goto *com_listNpc_loop_pgchk
+			goto *label_5447
 		}
 	}
 	if ( key == key_cancel ) {
 		return -1
 	}
-	goto *com_listNpc_loop
+	goto *label_5448
 
 *com_reserve
 	snd SOUNDLIST_POP2
 	listmax = 0
 	page = 0
@@ -3757,11 +3790,11 @@
 		}
 	}
 
 *com_jukebox_loop
 	if ( 1 == 0 ) {
-		goto *com_listAdv
+		goto *label_5471
 	}
 	redraw 0
 	s = lang("再生リスト", "Reserve List"), strhint2 + strhint3
 	display_window (windoww - 340) / 2 + inf_screenx, winposy(448), 340, 448
 	display_topic lang("タイトル", "Name"), wx + 28, wy + 36
@@ -4087,11 +4120,11 @@
 	if ( key == key_cancel ) {
 		return -1
 	}
 	goto *com_jukebox_loop
 
-*com_listAdv
+*label_5471
 	listmax = 0
 	page = 0
 	pagesize = 16
 	cs = 0
 	cc = CHARA_PLAYER
@@ -4104,11 +4137,11 @@
 		listmax++
 	loop
 	gosub *sort_list
 	windowshadow = 1
 
-*com_listAdv_loop_pgchk
+*label_5474
 	redraw 0
 	cs_bk = -1
 	pagemax = (listmax - 1) / pagesize
 	if ( page < 0 ) {
 		page = pagemax
@@ -4117,11 +4150,11 @@
 		if ( page > pagemax ) {
 			page = 0
 		}
 	}
 
-*com_listAdv_loop
+*label_5475
 	if ( 1 == 0 ) {
 		goto *wish_fix
 	}
 	redraw 0
 	s = lang("冒険者ランク", "Adventurer Rank"), strhint2 + strhint3
@@ -4248,24 +4281,24 @@
 	}
 	if ( key == key_pageup ) {
 		if ( pagemax != 0 ) {
 			snd SOUNDLIST_POP1
 			page++
-			goto *com_listAdv_loop_pgchk
+			goto *label_5474
 		}
 	}
 	if ( key == key_pagedown ) {
 		if ( pagemax != 0 ) {
 			snd SOUNDLIST_POP1
 			page--
-			goto *com_listAdv_loop_pgchk
+			goto *label_5474
 		}
 	}
 	if ( key == key_cancel ) {
 		return
 	}
-	goto *com_listAdv_loop
+	goto *label_5475
 
 *wish_fix
 	if ( jp ) {
 		inputlog = del_str(inputlog, ",")
 		inputlog = del_str(inputlog, " ")
@@ -4723,14 +4756,14 @@
 	}
 	if ( instr(inputlog, 0, lang("アイテム", "item")) != (-1) ) {
 		goto *wish_item
 	}
 	if ( instr(inputlog, 0, lang("カード", "card")) != (-1) ) {
-		goto *wish_card
+		goto *label_5501
 	}
 	if ( instr(inputlog, 0, lang("剥製", "figure")) != (-1) | instr(inputlog, 0, "はく製") != (-1) ) {
-		goto *wish_figure
+		goto *label_5502
 	}
 
 *wish_item
 	gosub *wish_fix
 	i = 0
@@ -4946,11 +4979,11 @@
 		goto *com_wish_end
 	}
 	txt lang("何もおきない… ", "Nothing happens...")
 	goto *com_wish_end
 
-*wish_card
+*label_5501
 	gosub *wish_monster
 	flt
 	characreate MAX_CHARA_NC, dbid, -3, 0
 	flt
 	itemcreate -1, ITEM_ID_CARD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
@@ -4959,11 +4992,11 @@
 	chara_vanquish MAX_CHARA_NC
 	cell_refresh cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
 	txt lang("足元に" + itemname(ci) + "が転がってきた。", "" + itemname(ci) + " appear" + _s2(inv(INV_ITEM_NUM, ci)) + " from nowhere.")
 	goto *com_wish_end
 
-*wish_figure
+*label_5502
 	gosub *wish_monster
 	flt
 	characreate MAX_CHARA_NC, dbid, -3, 0
 	flt
 	itemcreate -1, ITEM_ID_FIGURINE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
@@ -5027,11 +5060,11 @@
 			txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
 			display_msg
 			redraw 1
 			goto *pc_turn
 		}
-		if ( efid < MAX_SKILL ) {
+		if ( efid < 846 ) {
 			if ( spact(efid - STARTING_SKILL_SPACT) == 0 ) {
 				txt lang("もうその行動はできない。", "You can't use this shortcut any more.")
 				gosub *screen_draw
 				goto *pc_turn
 			}
@@ -5071,11 +5104,11 @@
 	tlocy = y
 	if ( tlocx == cdata(CDATA_X, CHARA_PLAYER) ) {
 		if ( tlocy == cdata(CDATA_Y, CHARA_PLAYER) ) {
 			rowactre = 0
 			gosub *search
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( (chipm(CHIPM_ATTRIB, map(x, y, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS) == 0 | chipm(CHIPM_ROLE, map(x, y, MAP_TILE_ID)) == MAP_CHIP_ROLE_WATER | mdata(MDATA_TYPE) == MAP_TYPE_WORLD | map(x, y, MAP_TILE_ID) == xy2pic(8, 21) | map(x, y, MAP_TILE_ID) == xy2pic(14, 23) | map(x, y, MAP_TILE_ID) == xy2pic(17, 23) | map(x, y, MAP_TILE_ID) == xy2pic(20, 23) ) {
 		txt lang("それは無理だ。", "It's impossible.")
 		gosub *screen_draw
@@ -5100,11 +5133,11 @@
 	gosub *action
 	if ( stat == 0 ) {
 		gosub *screen_draw
 		goto *pc_turn
 	}
-	goto *turn_end
+	goto *label_9247
 
 *com_applySkill
 	listmax = 0
 	page = 0
 	pagesize = 16
@@ -5126,11 +5159,11 @@
 				list(0, listmax) = cnt, 15
 				listmax++
 			}
 		}
 	loop
-	repeat 843 - 600
+	repeat 846 - 600
 		if ( spact(cnt) == 1 ) {
 			if ( sdataref(SKILL_DATAREF_TG, cnt + 600) / 1000 * 1000 != 3000 & cnt + 600 != 746 & cnt + 600 != 667 & cnt + 600 != 693 & cnt + 600 != 740 ) {
 				list(0, listmax) = cnt + 600, sdataref(SKILL_DATAREF_USE, 600 + cnt)
 				listmax++
 			}
@@ -5272,11 +5305,11 @@
 	}
 	if ( key == key_msglog ) {
 		snd SOUNDLIST_CHEST1
 		txtef COLOR_GREEN
 		txt lang("【技能・全表示】", "[Sealed skills release]")
-		repeat 843 - 600
+		repeat 846 - 600
 			if ( spact(cnt) == 2 ) {
 				if ( sdataref(SKILL_DATAREF_TG, cnt + 600) / 1000 * 1000 != 3000 & cnt + 600 != 746 & cnt + 600 != 667 & cnt + 600 != 693 & cnt + 600 != 740 ) {
 					spact(cnt) = 1
 				}
 			}
@@ -5345,11 +5378,11 @@
 	cc = CHARA_PLAYER
 	cs_bk = -1
 	cs = commark(2) \ 1000
 	page = commark(2) / 1000
 	curmenu = 2
-	repeat 843 - 600
+	repeat 846 - 600
 		if ( spact(cnt) == 1 ) {
 			if ( sdataref(SKILL_DATAREF_TG, cnt + 600) / 1000 * 1000 == 3000 | cnt + 600 == 746 | cnt + 600 == 667 | cnt + 600 == 693 | cnt + 600 == 740 ) {
 				list(0, listmax) = cnt + 600, sdataref(SKILL_DATAREF_USE, 600 + cnt)
 				listmax++
 			}
@@ -5484,11 +5517,11 @@
 	}
 	if ( key == key_msglog ) {
 		snd SOUNDLIST_CHEST1
 		txtef COLOR_GREEN
 		txt lang("【広域技能・全表示】", "[Sealed skills release]")
-		repeat 843 - 600
+		repeat 846 - 600
 			if ( spact(cnt) == 2 ) {
 				if ( sdataref(SKILL_DATAREF_TG, cnt + 600) / 1000 * 1000 == 3000 | cnt + 600 == 746 | cnt + 600 == 667 | cnt + 600 == 693 | cnt + 600 == 740 ) {
 					spact(cnt) = 1
 				}
 			}
@@ -5757,18 +5790,18 @@
 				if ( trait(TRAIT_ETHER_TENTACLES) == (-2) ) {
 					tdmg = tdmg * 2
 				}
 				dmghp tc, tdmg, cc, SKILL_RESDMG_CRUSH, 1000
 				gosub *screen_draw
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 	}
 	txt lang(name(tc) + "に何をする？ ", "What action do you want to perform to " + him(tc) + "? ")
 	kakudo2 = cdata(CDATA_MARK_ITEM_ADJUST_R, tc) * 15
 	if ( 0 ) {
-		txt lang("itemが" + cdata(CDATA_ITEM_USING, tc) + "で腹が" + cdata(CDATA_HUNGER, tc) + "。", "You cannot leave livestock on hanging.")
+		txt lang("cTone(tc)が" + cdata(CDATA_TONE, tc) + "でcSexT(tc)で" + cdata(CDATA_TONE_SEX, tc) + "", "You cannot leave livestock on hanging.")
 	}
 	if ( cdata(CDATA_PV_FIX, tc) == 100 & cdata(CDATA_DV_FIX, tc) == 100 ) {
 		if ( cdatan(CDATAN_RACE, tc) == "slime" ) {
 			cdata(CDATA_PV_FIX, tc) = 200
 		}
@@ -5910,11 +5943,11 @@
 		promptmax++
 	}
 	if ( cbit(CHARA_BIT_BODYGUARD, tc) == FALSE & cbit(CHARA_BIT_GUARD_TEMP, tc) == FALSE ) {
 		if ( tc < MAX_CHARA_FOLLOWER ) {
 			if ( cdata(CDATA_IN_TAGTEAM, tc) != 1 ) {
-				if ( cdata(CDATA_AREA, tc) == AREA_NONE | tc == CHARA_PLAYER ) {
+				if ( cdata(CDATA_AREA, tc) == 0 | tc == CHARA_PLAYER ) {
 					if ( cdata(CDATA_IN_TAGTEAM, tc) == 0 ) {
 						promptl(0, promptmax) = lang("タッグ編成", "Tag organization."), "null", "" + 16
 						promptmax++
 					}
 					if ( cdata(CDATA_TAGTEAM_PARTNER, tc) > 0 ) {
@@ -5983,17 +6016,17 @@
 		if ( chatteleport == 1 ) {
 			chatteleport = 0
 			goto *map_exit
 		}
 		else {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( p == 1 ) {
 		gosub *screen_draw
-		gosub *act_melee
-		goto *turn_end
+		gosub *label_6394
+		goto *label_9247
 	}
 	if ( p == 2 ) {
 		gosub *screen_draw
 		invctrl = INVCTRL_GIVE
 		snd SOUNDLIST_INV
@@ -6016,13 +6049,13 @@
 			txt lang("仲間の最大数に達しているため連れ出せない。", "Your party is already full. You can't invite someone anymore.")
 			goto *pc_turn
 		}
 		rc = tc
 		gosub *add_ally
-		cdata(CDATA_AREA, rc) = AREA_NONE
+		cdata(CDATA_AREA, rc) = 0
 		gosub *screen_draw
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( p == 6 | p == 28 ) {
 		if ( 0 ) {
 		}
 		csctrl = 4
@@ -6059,11 +6092,11 @@
 			picload exedir + "graphic\\face2" + devfile + ".bmp", 1
 		}
 		gsel BUFFER_SCREEN
 		ccbk = cc
 		cc = tc
-		gosub *com_portrait
+		gosub *label_5658
 		cc = ccbk
 		gosub *screen_draw
 		goto *pc_turn
 	}
 	if ( p == 9 ) {
@@ -6169,42 +6202,42 @@
 		if ( rtval == 10 ) {
 			if ( cbit(CHARA_BIT_MARRIED, tc) != FALSE ) {
 				if ( gdata(GDATA_FLAG_GAME_MODE) == 2 | gdata(GDATA_FLAG_GAME_MODE) == 5 ) {
 					snd SOUNDLIST_FAIL1
 					txt lang("このゲームモードでは遺伝子を残せない。", "I do not make gene in this game mode.")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( gdata(GDATA_SLEEP) < 15 ) {
 					snd SOUNDLIST_FAIL1
 					txt lang("「まだ眠くない" + _yo(3) + "」", cdatan(CDATAN_NAME, tc) + " isn't sleepy yet.")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( gdata(GDATA_AREA) == AREA_SHELTER ) {
 					snd SOUNDLIST_FAIL1
 					txt lang("「こんな場所では嫌" + _yo(3) + "」", cdatan(CDATAN_NAME, tc) + " seems to want to get out of here.")
-					goto *turn_end
+					goto *label_9247
 				}
 				txt lang("「いやん、あなたったら…」", "*blush*")
 				if ( cdata(CDATA_ID, tc) == CREATURE_ID_JURE | cdata(CDATA_ID, tc) == CREATURE_ID_JURE ) {
 					repeat 245
 						if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
 							continue
 						}
 						if ( cdata(CDATA_ID, cnt) == CREATURE_ID_ROVID ) {
 							snd SOUNDLIST_AMMO
 							txt lang(cdatan(CDATAN_NAME, cnt) + "「やめなさい！ジュア様が嫌だと言っているでしょう！？」", "Action was arrested by " + cdatan(CDATAN_NAME, cnt) + ".")
-							goto *turn_end
+							goto *label_9247
 							break
 						}
 					loop
 				}
 				cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
 				cbitmod CHARA_BIT_MAKE_GENE, tc, TRUE
 				if ( gdata(GDATA_WIZARD) == 0 ) {
 					gdata(GDATA_SLEEP_GENE) = tc
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		if ( rtval == 10 ) {
 			if ( cbit(CHARA_BIT_MARRIED, tc) == FALSE ) {
 				if ( cdata(CDATA_ID, tc) == CREATURE_ID_JURE | cdata(CDATA_ID, tc) == CREATURE_ID_JURE ) {
@@ -6213,26 +6246,26 @@
 							continue
 						}
 						if ( cdata(CDATA_ID, cnt) == CREATURE_ID_ROVID ) {
 							snd SOUNDLIST_AMMO
 							txt lang(cdatan(CDATAN_NAME, cnt) + "「私が許しませんよ！」", "Action was arrested by " + cdatan(CDATAN_NAME, cnt) + ".")
-							goto *turn_end
+							goto *label_9247
 							break
 						}
 					loop
 				}
 				if ( cdata(CDATA_IMPRESSION, tc) < 200 ) {
 					txtef COLOR_PURPLE
 					snd SOUNDLIST_ATK_DARK
 					txt lang("…" + cdatan(CDATAN_NAME, tc) + "はやんわりと断った。", "..." + cdatan(CDATAN_NAME, tc) + " gently refuses your proposal. ")
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( cdata(CDATA_ALLIED, tc) == 0 ) {
 					txtef COLOR_PURPLE
 					snd SOUNDLIST_ATK_DARK
 					txt lang("「嬉しい" + _ga(3) + "、" + _ore(3) + "の立場も考えて" + _kure(3) + "」", "..." + cdatan(CDATAN_NAME, tc) + " sadly refuses your proposal. ")
-					goto *turn_end
+					goto *label_9247
 				}
 				cbitmod CHARA_BIT_MARRIED, tc, TRUE
 				txtef COLOR_PINK
 				txt lang("「はい…喜んで」", "..." + cdatan(CDATAN_NAME, tc) + " blushed and nodded!")
 				gdata(GDATA_FLAG_TIMES_MARRIED)++
@@ -6240,15 +6273,15 @@
 				cdata(CDATA_JOIN_DATE_DAY, tc) = gdata(GDATA_DAY)
 				cdata(CDATA_JOIN_DATE_YEAR, tc) = gdata(GDATA_YEAR)
 				cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
 				marry = tc
 				evadd EVENT_MARRY
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		gosub *screen_draw
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( p == 11 ) {
 		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ITZPALT ) {
 			if ( synccheck(cc, -1) ) {
 				txt lang("「では我が本来住まうべき世界へ帰還するとしよう」", cnvtalk("See you again."))
@@ -6304,11 +6337,11 @@
 		gosub *music_play
 		lovemiracle2 tc
 		txtmore
 		txtef COLOR_SKY_BLUE
 		customtalk tc, DBMODE_FLAVOR_CHOCO
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			if ( jp ) {
 				txt "「受け取って" + _kure() + "これが" + _ore(3) + "の気持ち" + _da(3) + "」", name(tc) + "はもじもじしながら懐から包みを取り出した。", name(tc) + "は赤面すると慌ててチョコを取り出し、あなたに突き出した。", name(tc) + "はにっこり微笑むと、後ろ手に隠していたチョコを見せた。", "「…本当に" + _ore(3) + "なんかのでいい" + _noka(1) + "」"
 			}
 			else {
@@ -6426,11 +6459,11 @@
 			if ( ttc == tc ) {
 				txt lang("何もおきない… ", "Nothing happens...")
 				goto *pc_turn
 			}
 			if ( tc != CHARA_PLAYER ) {
-				if ( cdata(CDATA_AREA, ttc) != AREA_NONE | cdata(CDATA_AREA, tc) != AREA_NONE ) {
+				if ( cdata(CDATA_AREA, ttc) != 0 | cdata(CDATA_AREA, tc) != 0 ) {
 					txt lang("滞在中の仲間はタッグを組めない。", "The ally currently stays in this area.")
 					goto *pc_turn
 				}
 			}
 			if ( cbit(CHARA_BIT_GUARD_TEMP, ttc) == TRUE ) {
@@ -6470,15 +6503,15 @@
 					txtmore
 					txtef COLOR_YELLOW
 					txt lang("あなたは「" + skillname(SKILL_SPACT_TAG_FORCE) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_TAG_FORCE) + ".")
 				}
 				gosub *screen_draw
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		gosub *screen_draw
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( p == 17 ) {
 		ttc = cdata(CDATA_TAGTEAM_PARTNER, tc)
 		cell_findspace cdata(CDATA_X, tc), cdata(CDATA_Y, tc), 1
 		if ( stat == 0 ) {
@@ -6486,11 +6519,11 @@
 			goto *pc_turn
 		}
 		cell_setchara ttc, rtval, rtval(1)
 		tag_end tc
 		gosub *screen_draw
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( p >= 18 & p <= 22 ) {
 		if ( sorg(SKILL_ATTR_LIFE, tc) < 4 ) {
 			txtef COLOR_RED
 			txt lang("無理に行うと死にそうだ。やめておこうか？", "If you squeeze more milk, " + name(tc) + " will die. Will you quit?")
@@ -6533,11 +6566,11 @@
 				itemcreate -1, ITEM_ID_SKIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				remain_make ci, tc
 			}
 			evadd EVENT_SQUEEZE, tc
 			gosub *screen_draw
-			goto *turn_end
+			goto *label_9247
 		}
 		snd SOUNDLIST_STAB
 		if ( p == 18 ) {
 			txt lang(name(tc) + "の骨を引きずり出した。", "You take out bone flom " + name(tc) + ".")
 			flt
@@ -6569,11 +6602,11 @@
 			remain_make ci, tc
 		}
 		dmghp tc, cdata(CDATA_MAX_HP, tc), DAMAGE_FROM_SCALP
 		skillmod SKILL_ATTR_LIFE, tc, sorg(SKILL_ATTR_LIFE, tc) * (-1) * 3 / 4 * 1000
 		gosub *screen_draw
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( p == 14 ) {
 		if ( cdata(CDATA_SHIFT_FORM, tc) != SHIFT_FORM_NONE ) {
 			gdata(GDATA_SENSE_OBJECT) = 1
 		}
@@ -7362,11 +7395,11 @@
 	tc = cc
 	gosub *cast
 	if ( stat == 0 ) {
 		goto *pc_turn
 	}
-	goto *turn_end
+	goto *label_9247
 
 *com_spell_loop
 	listmax = 0
 	page = 0
 	pagesize = 16
@@ -7623,11 +7656,11 @@
 		s += " "
 	}
 	s += skilldesc(i)
 	return
 
-*trainer_skill
+*label_5597
 	dbmax = 0
 	dblist(0, dbmax) = 159
 	dbmax++
 	dblist(0, dbmax) = 173
 	dbmax++
@@ -7948,11 +7981,11 @@
 			listmax++
 		}
 	loop
 	return
 
-*notable_skill
+*label_5599
 	dbmax = 0
 	dblist(0, dbmax) = 150
 	dbmax++
 	dblist(0, dbmax) = 151
 	dbmax++
@@ -8555,14 +8588,14 @@
 	}
 	list(0, listmax) = -1, 20000
 	listn(0, listmax) = lang("◆ スキルと特殊能力", "Skill")
 	listmax++
 	if ( csctrl == 300 ) {
-		gosub *notable_skill
+		gosub *label_5599
 	}
 	if ( csctrl == 3 ) {
-		gosub *trainer_skill
+		gosub *label_5597
 	}
 	else {
 		repeat 400 - 150, 150
 			f = 0
 			if ( sdata(cnt, cc) != 0 ) {
@@ -9318,11 +9351,11 @@
 	key_check
 	cursor_check
 	if ( page == 0 ) {
 		if ( key == "p" ) {
 			if ( cc < MAX_CHARA_FOLLOWER ) {
-				gosub *com_portrait
+				gosub *label_5658
 				if ( mode != MODELIST_CHARA_CREATION ) {
 					nowindowanime = 1
 				}
 				returnfromportrait = 1
 				goto *com_charainfo
@@ -9612,11 +9645,11 @@
 			rtvaln = ""
 		}
 	}
 	return
 
-*get_pic_selection
+*label_5634
 	rtval = -2
 	if ( page == 0 ) {
 		if ( val == 0 ) {
 			rtval = -2
 		}
@@ -9968,11 +10001,11 @@
 		keyrange++
 	loop
 
 *com_shape_change_WHILE1
 	if ( 1 == 0 ) {
-		goto *com_portrait
+		goto *label_5658
 	}
 	redraw 0
 	pagesize = 0
 	s = lang("個別画像の変更", "Appearence"), lang("左右キー [変更]  ｷｬﾝｾﾙ [閉じる]", "Right,left [Change]  Shift,Esc [Close]")
 	display_window (windoww - 380) / 2 + inf_screenx, winposy(340) - 12, 380, 300
@@ -10004,11 +10037,11 @@
 		p = cnt
 		if ( p >= listmax ) {
 			break
 		}
 		val = cnt, 0
-		gosub *get_pic_selection
+		gosub *label_5634
 		s = listn(0, p)
 		if ( rtval >= 0 ) {
 			if ( rtval(2) >= 0 ) {
 				s += " " + rtval(2)
 			}
@@ -10035,11 +10068,11 @@
 	redraw 1
 	await cfg_wait1
 	key_check
 	cursor_check
 	val = cs, 0
-	gosub *get_pic_selection
+	gosub *label_5634
 	p = 0
 	if ( rtval == (-2) | rtval == (-3) ) {
 		if ( rtval == (-2) ) {
 			if ( key == key_enter ) {
 				cbitmod CHARA_BIT_PCC, cc, FALSE
@@ -10103,11 +10136,11 @@
 	}
 
 *com_shape_change_WHILE1_CONTINUE
 	goto *com_shape_change_WHILE1
 
-*com_portrait
+*label_5658
 	create_pcpic cc, 0
 	page = 0
 	pagesize = 19
 	cs = 0
 	cs_bk = -1
@@ -10140,11 +10173,11 @@
 	pos 960, 96
 	picload exedir + "graphic\\deco_mirror.bmp", 1
 	gsel BUFFER_SCREEN
 	windowshadow = 1
 
-*com_portrait_loop
+*label_5661
 	listmax = 0
 	if ( page == 0 ) {
 		if ( jp ) {
 			s = "決定    ", "肖像　　", "髪　　　", "副髪　　", "髪の色　", "体　　　", "服　　　", "ﾊﾟﾝﾂ　　", "詳細設定"
 		}
@@ -10181,11 +10214,11 @@
 		}
 		key_list(cnt) = key_enter
 		keyrange++
 	loop
 
-*com_portrait_loop_WHILE1
+*label_5664
 	if ( 1 == 0 ) {
 		goto *com_mirror
 	}
 	redraw 0
 	pagesize = 0
@@ -10314,24 +10347,24 @@
 			}
 			else {
 				page = 0
 				cs = 8
 			}
-			goto *com_portrait_loop
+			goto *label_5661
 		}
 	}
 	if ( key == key_pageup ) {
 		snd SOUNDLIST_CURSOR1
 		if ( rtval == 100 ) {
 			if ( cdata(CDATA_PORTRAIT, cc) < 32 - 1 ) {
 				cdata(CDATA_PORTRAIT, cc)++
 			}
-			goto *com_portrait_loop_WHILE1_CONTINUE
+			goto *label_5666
 		}
 		if ( rtval == 101 ) {
 			cbitmod CHARA_BIT_PCC, cc, TRUE
-			goto *com_portrait_loop_WHILE1_CONTINUE
+			goto *label_5666
 		}
 		if ( rtval(1) == 0 ) {
 			exist exedir + "\\graphic\\PCCs\\pcc_" + rtvaln + "_" + (pcc(rtval, cc) \ 1000 + 1) + ".bmp"
 			if ( strsize != (-1) ) {
 				pcc(rtval, cc)++
@@ -10349,15 +10382,15 @@
 		snd SOUNDLIST_CURSOR1
 		if ( rtval == 100 ) {
 			if ( cdata(CDATA_PORTRAIT, cc) > (-41) ) {
 				cdata(CDATA_PORTRAIT, cc)--
 			}
-			goto *com_portrait_loop_WHILE1_CONTINUE
+			goto *label_5666
 		}
 		if ( rtval == 101 ) {
 			cbitmod CHARA_BIT_PCC, cc, FALSE
-			goto *com_portrait_loop_WHILE1_CONTINUE
+			goto *label_5666
 		}
 		if ( rtval(1) == 0 ) {
 			exist exedir + "\\graphic\\PCCs\\pcc_" + rtvaln + "_" + (pcc(rtval, cc) \ 1000 - 1) + ".bmp"
 			if ( pcc(rtval, cc) \ 1000 == 1 & rtval != 15 | strsize != (-1) ) {
 				pcc(rtval, cc)--
@@ -10381,12 +10414,12 @@
 		if ( p ) {
 			return -1
 		}
 	}
 
-*com_portrait_loop_WHILE1_CONTINUE
-	goto *com_portrait_loop_WHILE1
+*label_5666
+	goto *label_5664
 
 *com_mirror
 	create_pcpic cc, 1
 	snd SOUNDLIST_POP2
 	page = 0
@@ -10902,11 +10935,11 @@
 			if ( cdata(CDATA_CONDITION_BRAINWASH, cc) != 0 ) {
 				txt lang(name(cc) + "は頭がぼんやりして装備を変更できない…。", "It is impossible to change the equipment by confusing.")
 				goto *com_wear_loop_pgchk
 			}
 			r1 = cc
-			gosub *act_unequip
+			gosub *label_6353
 			r1 = cc
 			gosub *charaRefresh
 			snd SOUNDLIST_EQUIP1
 			txtnew
 			txt lang(itemname(ci) + "を外した。", "You unequip " + itemname(ci) + ".")
@@ -11011,16 +11044,16 @@
 				if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_PLANTED_SEED ) {
 					if ( gdata(GDATA_AREA) != AREA_SHOW_HOUSE ) {
 						if ( feat < tile_plant + 2 ) {
 							txt lang("芽を摘み取った。", "You nip a young plant.")
 							map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_FEATS_ON_TILE) = 0
-							goto *turn_end
+							goto *label_9247
 						}
 						if ( feat == tile_plant + 3 ) {
 							txt lang("枯れた草を摘み取った。", "You nip a dead plant.")
 							map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_FEATS_ON_TILE) = 0
-							goto *turn_end
+							goto *label_9247
 						}
 						if ( inv_getspace(CHARA_PLAYER) == 0 ) {
 							txt lang("バックパックが一杯だ。", "Your inventory is full.")
 							gosub *screen_draw
 							goto *pc_turn
@@ -11041,12 +11074,12 @@
 						}
 						gosub *item_seedRegrowth
 						if ( feat(FEAT_CELL_SUB_FEATURE_ID) \ 10 == 0 ) {
 							autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
 						}
-						gosub *calcBurdenPc
-						goto *turn_end
+						gosub *label_4102
+						goto *label_9247
 					}
 				}
 				if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 					if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_NEFIA ) {
 						if ( feat(FEAT_CELL_SUB_FEATURE_ID) + feat(FEAT_CELL_PARAM_1) * 100 >= 300 & feat(FEAT_CELL_SUB_FEATURE_ID) + feat(FEAT_CELL_PARAM_1) * 100 < 450 ) {
@@ -11068,16 +11101,16 @@
 							}
 							area = feat(FEAT_CELL_SUB_FEATURE_ID) + feat(FEAT_CELL_PARAM_1) * 100
 							map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_FEATS_ON_TILE) = 0
 							adata(ADATA_ID, area) = AREA_NONE
 							removeworker area
-							gosub *world_refresh
+							gosub *label_4923
 							fmode = 13
 							gosub *game_ctrlFile
 							snd SOUNDLIST_BUILD1
 							txt lang("建物を撤去した。", "You remove the building.")
-							goto *turn_end
+							goto *label_9247
 						}
 					}
 				}
 			}
 		}
@@ -11089,20 +11122,20 @@
 				snd SOUNDLIST_FOOT2A
 				txt lang("雪をかきあつめた。", "You rake up a handful of snow.")
 				actionsp CHARA_PLAYER, 10
 				if ( stat == 0 ) {
 					txt lang("疲労し過ぎて失敗した！", "You are too exhausted!")
-					goto *turn_end
+					goto *label_9247
 				}
 				flt
 				itemcreate CHARA_PLAYER, ITEM_ID_HANDFUL_SNOW, -1, -1, 0
 				if ( stat != 0 ) {
 					inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 					inv(INV_ITEM_KNOWN, ci) = ITEM_KNOWN_FULL
 					item_stack CHARA_PLAYER, ci, 1
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 		msgdup++
 		txt lang("あなたは空気をつかんだ。", "You grasp at the air.")
 		gosub *screen_draw
@@ -11127,11 +11160,11 @@
 		goto *pc_turn
 	}
 	in = inv(INV_ITEM_NUM, ci)
 	gosub *act_get
 	if ( stat == 1 | stat == (-1) ) {
-		goto *turn_end
+		goto *label_9247
 	}
 	else {
 		gosub *screen_draw
 		goto *pc_turn
 	}
@@ -11203,11 +11236,11 @@
 *com_inventory
 	procid = (procid + 1) \ 4
 	proclist(procid) = "com_inventory" + invctrl + "/" + invctrl(1) + " ct:" + ct
 	if ( invctrl == INVCTRL_INV_FILE_GET ) {
 		if ( invctrl(1) == 1 ) {
-			gosub *gene_itemfix
+			gosub *label_5776
 		}
 	}
 	if ( menucycle == 1 ) {
 		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 			p = 0
@@ -11834,11 +11867,11 @@
 		goto *pc_turn
 	}
 	gosub *sort_list
 	if ( invctrl == INVCTRL_GET ) {
 		if ( listmax == 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( returnfromidentify == 0 ) {
 		if ( invctrl == INVCTRL_DIP ) {
 			valn = itemname(cidip, 1)
@@ -12372,11 +12405,11 @@
 			if ( dropcontinue ) {
 				menucycle = 1
 				dropcontinue++
 				goto *com_inventory
 			}
-			goto *turn_end
+			goto *label_9247
 		}
 		if ( invctrl == INVCTRL_GET | invctrl == INVCTRL_SHOP_BUY | invctrl == INVCTRL_SHOP_SELL | invctrl == INVCTRL_INV_FILE_GET | (invctrl == INVCTRL_PUT & (invctrl(1) == 3 | invctrl(1) == 5 | invctrl(1) == 6 | invctrl(1) == 7 | invctrl(1) == 8 | invctrl(1) == 9)) ) {
 			if ( invctrl != INVCTRL_GET & invctrl != INVCTRL_INV_FILE_GET & invctrl != INVCTRL_MARK_ITEM ) {
 				if ( ibit(ITEM_BIT_NO_DROP, ci) ) {
 					snd SOUNDLIST_FAIL1
@@ -12532,11 +12565,11 @@
 			gosub *act_get
 			if ( stat == 0 ) {
 				goto *com_inventory
 			}
 			if ( stat == (-1) ) {
-				goto *turn_end
+				goto *label_9247
 			}
 			if ( invctrl == INVCTRL_INV_FILE_GET ) {
 				if ( invctrl(1) == 1 ) {
 					gdata(GDATA_HEIR_DEED)--
 					if ( invctrl(1) == 1 ) {
@@ -12593,11 +12626,11 @@
 					txt lang("それは反則すぎて装備できない。", "It's too unfair to equip.")
 					goto *com_inventory_loop
 				}
 			}
 			r1 = cc
-			gosub *act_equip
+			gosub *label_6352
 			r1 = cc
 			gosub *charaRefresh
 			screenupdate = -1
 			gosub *screen_draw
 			snd SOUNDLIST_EQUIP1
@@ -12677,11 +12710,11 @@
 			reftype = refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE)
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_GIFT ) {
 				snd SOUNDLIST_EQUIP1
 				txt lang("あなたは" + name(tc) + "に" + itemname(ci, 1) + "をプレゼントした。", "You give " + name(tc) + " " + itemname(ci, 1) + ".")
 				inv(INV_ITEM_NUM, ci)--
-				gosub *calcBurdenPc
+				gosub *label_4102
 				txt lang("「え、これを" + _ore(3) + "にくれるの" + _ka(1) + "" + _thanks(2) + "」", cnvtalk("Thank you!"))
 				if ( cdata(CDATA_JOIN_DATE_MONTH, tc) == gdata(GDATA_MONTH) & cdata(CDATA_JOIN_DATE_DAY, tc) == gdata(GDATA_DAY) & cdata(CDATA_JOIN_DATE_YEAR, tc) > gdata(GDATA_YEAR) ) {
 					txt lang("今日はあなたと" + name(tc) + "の記念日だ！", "Today is anniversary of " + name(tc) + " with you!")
 					modimp tc, giftvalue(inv(INV_ITEM_PARAM4, ci))
 				}
@@ -12691,11 +12724,11 @@
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOKEN_FRIENDSHIP ) {
 				snd SOUNDLIST_EQUIP1
 				txt lang("あなたは" + name(tc) + "に" + itemname(ci, 1) + "を渡した。", "You give " + name(tc) + " " + itemname(ci, 1) + ".")
 				inv(INV_ITEM_NUM, ci)--
-				gosub *calcBurdenPc
+				gosub *label_4102
 				if ( cdata(CDATA_IMPRESSION, tc) >= 100 ) {
 					txt lang("「こ、これが" + _ore(3) + "たちの友情の証！」", cnvtalk("Thank you!"))
 					if ( cdata(CDATA_JOIN_DATE_MONTH, tc) == gdata(GDATA_MONTH) & cdata(CDATA_JOIN_DATE_DAY, tc) == gdata(GDATA_DAY) & cdata(CDATA_JOIN_DATE_YEAR, tc) > gdata(GDATA_YEAR) ) {
 						txt lang("今日はあなたと" + name(tc) + "の記念日だ！", "Today is anniversary of " + name(tc) + " with you!")
 						modimp tc, 30
@@ -12774,18 +12807,18 @@
 					if ( cdata(CDATA_JOIN_DATE_MONTH, tc) == 12 ) {
 						modimp tc, 20
 					}
 				}
 				inv(INV_ITEM_NUM, ci)--
-				gosub *calcBurdenPc
+				gosub *label_4102
 				goto *com_inventory
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_LOVELY_BOUQUET ) {
 				snd SOUNDLIST_EQUIP1
 				txt lang("あなたは" + name(tc) + "に" + itemname(ci, 1) + "を渡した。", "You give " + name(tc) + " " + itemname(ci, 1) + ".")
 				inv(INV_ITEM_NUM, ci)--
-				gosub *calcBurdenPc
+				gosub *label_4102
 				if ( cdata(CDATA_IMPRESSION, tc) >= 150 ) {
 					txt lang("「素敵" + _dana(3) + "！」", cnvtalk("Thank you!"))
 					if ( cdata(CDATA_JOIN_DATE_MONTH, tc) == gdata(GDATA_MONTH) & cdata(CDATA_JOIN_DATE_DAY, tc) == gdata(GDATA_DAY) & cdata(CDATA_JOIN_DATE_YEAR, tc) > gdata(GDATA_YEAR) ) {
 						txt lang("今日はあなたと" + name(tc) + "の記念日だ！", "Today is anniversary of " + name(tc) + " with you!")
 						modimp tc, 20
@@ -12871,18 +12904,18 @@
 					inv(INV_ITEM_NUM, ci)--
 					inv(INV_ITEM_NUM, ti) = 1
 					item_stack tc, ti, 1
 					ci = ti
 					rc = tc
-					gosub *chara_item
-					gosub *chara_equipFull
+					gosub *label_8914
+					gosub *label_8919
 					if ( tc < MAX_CHARA_FOLLOWER ) {
 						create_pcpic tc, 1
 					}
 					r1 = tc
 					gosub *charaRefresh
-					gosub *calcBurdenPc
+					gosub *label_4102
 					goto *com_inventory
 				}
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BOTTLE_MILK & cbit(CHARA_BIT_LIVESTOCK, tc) == TRUE ) {
 				tcbk = tc
@@ -12890,19 +12923,19 @@
 					snd SOUNDLIST_FAIL1
 					txt lang("「今はおなかいっぱい！」", cnvtalk("I'm full now!"))
 					goto *com_inventory
 				}
 				inv(INV_ITEM_NUM, ci)--
-				gosub *calcBurdenPc
+				gosub *label_4102
 				tc = tcbk
 				efid = SKILL_EFFECT_POTION_MILK
 				gosub *effect
 				goto *pc_turn
 			}
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_LIVESTOCK_FEED & cdata(CDATA_HUNGER, tc) < 10000 & cbit(CHARA_BIT_LIVESTOCK, tc) == TRUE ) {
 				inv(INV_ITEM_NUM, ci)--
-				gosub *calcBurdenPc
+				gosub *label_4102
 				txt lang(name(tc) + "に家畜の餌を食べさせた。", "You gave " + name(tc) + " food for livestock.")
 				snd SOUNDLIST_EAT1
 				txt "「パッサパサ！」", "「パッサパサ！」", "「口のなかパッサパサ！」", "「口の中パッサパサだよ！」", "「パッサパサだよ！」", "「パッサパサだよ」"
 				inv_find ITEM_ID_BIO_BATTERY, tc
 				if ( stat == (-1) ) {
@@ -12916,10 +12949,19 @@
 			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_PUFF_PUFF_BREAD & cdata(CDATA_ID, tc) == CREATURE_ID_ALCHEMIST_NAPLUS ) {
 				snd SOUNDLIST_FAIL1
 				txt lang("「い、いらない！ふかふかパンなんてもういらない！！」", cnvtalk("I dont't want it!!!"))
 				goto *com_inventory_loop
 			}
+			if ( cbit(1034, tc) == TRUE & cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-4) ) {
+				f = rnd(8) + 1
+				if ( f <= 4 ) {
+					s = "", lang("イヤぁぁあ！", "Nooooo!"), lang("イヤ〜！", "No!"), lang("イヤ♪", "No! No!"), lang("イヤッ！", "No!!!!!!")
+					snd SOUNDLIST_FAIL1
+					txt lang(name(tc) + "「" + s(f) + "」", cnvtalk(s(f)))
+					goto *pc_turn
+				}
+			}
 			f = 0
 			p = sdata(SKILL_ATTR_STR, tc) * 500 + sdata(SKILL_ATTR_CON, tc) * 500 + sdata(SKILL_NORMAL_WEIGHT_LIFTING, tc) * 2500 + 25000
 			if ( cdata(CDATA_ID, tc) == CREATURE_ID_GOLDEN_KNIGHT ) {
 				p *= 5
 			}
@@ -13059,11 +13101,11 @@
 				inv(INV_ITEM_NUM, ci)--
 				inv(INV_ITEM_NUM, ti) = 1
 				item_stack tc, ti, 1
 				ci = ti
 				rc = tc
-				gosub *chara_item
+				gosub *label_8914
 				if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_ROD ) {
 					cdata(CDATA_AI_ITEM, tc) = ci
 				}
 				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_LASER_BAZOOKA | inv(INV_ITEM_ID, ci) == ITEM_ID_M202_SPECIAL | inv(INV_ITEM_ID, ci) == ITEM_ID_PANZERFAUST_X ) {
 					cdata(CDATA_AI_ITEM, tc) = ci
@@ -13118,22 +13160,22 @@
 							}
 							in = 0
 						}
 					}
 				}
-				gosub *chara_equipFull
+				gosub *label_8919
 				if ( tc < MAX_CHARA_FOLLOWER ) {
 					create_pcpic tc, 1
 				}
 				r1 = tc
 				gosub *charaRefresh
-				gosub *calcBurdenPc
+				gosub *label_4102
 				if ( invally == 1 ) {
 					goto *com_inventory
 				}
 				gosub *screen_draw
-				goto *turn_end
+				goto *label_9247
 			}
 			snd SOUNDLIST_FAIL1
 			txt lang(name(tc) + "は" + itemname(ci, 1) + "を受け取らない。", name(tc) + " refuse" + _s(tc) + " to take " + itemname(ci, 1) + ".")
 			goto *com_inventory_loop
 		}
@@ -13230,18 +13272,18 @@
 			rc = tc
 			ci = citrade
 			if ( cdata(CDATA_AI_ITEM, rc) == ci ) {
 				cdata(CDATA_AI_ITEM, rc) = 0
 			}
-			gosub *chara_equipFull
+			gosub *label_8919
 			if ( tc >= MAX_CHARA_FOLLOWER ) {
 				gosub *supplyEquip
 			}
 			gosub *chara_adjustInv
 			r1 = tc
 			gosub *charaRefresh
-			gosub *calcBurdenPc
+			gosub *label_4102
 			invsubroutine = 0
 			return 1
 		}
 		if ( invctrl == INVCTRL_MATERIAL_ENCHANT ) {
 			if ( invctrl(1) != 21 & invctrl(1) != 23 & invctrl(1) != 24 ) {
@@ -13270,11 +13312,11 @@
 					qdata(QDATA_PARAM2, gdata(GDATA_QUEST_REF)) += inv(INV_ITEM_WEIGHT, ci) * inv(INV_ITEM_NUM, ci)
 					txtef COLOR_GREEN
 					txt lang(itemname(ci) + "を納入した。", "You deliver" + itemname(ci) + ".") + " +" + cnvweight(inv(INV_ITEM_WEIGHT, ci) * inv(INV_ITEM_NUM, ci)) + lang("  納入済み", " Delivered ") + "(" + cnvweight(qdata(QDATA_PARAM2, gdata(GDATA_QUEST_REF))) + ") " + lang("納入ノルマ", "Quota ") + "(" + cnvweight(qdata(QDATA_PARAM1, gdata(GDATA_QUEST_REF))) + ")"
 				}
 				inv(INV_ITEM_NUM, ci) = 0
-				gosub *calcBurdenPc
+				gosub *label_4102
 				goto *com_inventory
 			}
 			if ( invctrl(1) == 2 ) {
 				if ( cdata(CDATA_GOLD, CHARA_PLAYER) < inv(INV_ITEM_SUB_NAME, ci) & inv(INV_ITEM_ID, ci) == ITEM_ID_BILL ) {
 					snd SOUNDLIST_FAIL1
@@ -13316,11 +13358,11 @@
 				}
 				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_12_MILLION_TAX_CERTIFICATE ) {
 					gdata(GDATA_FLAG_TAX_PREPAID_BALANCE) += 12000000
 				}
 				inv(INV_ITEM_NUM, ci)--
-				gosub *calcBurdenPc
+				gosub *label_4102
 				screenupdate = -1
 				gosub *screen_draw
 				goto *com_inventory
 			}
 		}
@@ -13334,10 +13376,19 @@
 				if ( inv_sum(CHARA_PLAYER) > 20 ) {
 					txt lang("バックパックが一杯だ。", "Your inventory is full.")
 					goto *com_inventory_loop
 				}
 			}
+			if ( cbit(1034, tc) == TRUE & cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-4) ) {
+				f = rnd(8) + 1
+				if ( f <= 4 ) {
+					s = "", lang("イヤぁぁあ！", "Nooooo!"), lang("イヤ〜！", "No!"), lang("イヤ♪", "No! No!"), lang("イヤッ！", "No!!!!!!")
+					snd SOUNDLIST_FAIL1
+					txt lang(name(tc) + "「" + s(f) + "」", cnvtalk(s(f)))
+					goto *pc_turn
+				}
+			}
 			f = 0
 			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ORE ) {
 				f = 2
 			}
 			if ( f != 0 ) {
@@ -13396,22 +13447,22 @@
 				inv(INV_ITEM_NUM, ti) = in
 				item_stack CHARA_PLAYER, ti, 1
 				convertartifact ti
 			}
 			rc = tc
-			gosub *chara_equipFull
+			gosub *label_8919
 			if ( tc < MAX_CHARA_FOLLOWER ) {
 				create_pcpic tc, 1
 			}
 			r1 = tc
 			gosub *charaRefresh
-			gosub *calcBurdenPc
+			gosub *label_4102
 			goto *com_inventory
 		}
 		if ( invctrl == INVCTRL_THROW ) {
 			savecycle
-			gosub *findLocation
+			gosub *label_5349
 			if ( stat != 1 ) {
 				if ( stat == 0 ) {
 					txt lang("その場所は見えない。", "You can't see the location.")
 					gosub *screen_draw
 				}
@@ -13423,11 +13474,11 @@
 				goto *pc_turn
 			}
 			goto *act_throw
 		}
 		if ( invctrl == INVCTRL_PICKPOCKET ) {
-			gosub *act_pickpocket
+			gosub *label_6529
 			invsubroutine = 0
 			return 1
 		}
 		if ( invctrl == INVCTRL_METAL ) {
 			if ( invctrl(1) == 0 ) {
@@ -13646,11 +13697,11 @@
 		if ( invally == 1 ) {
 			invally = 0
 		}
 		if ( dropcontinue ) {
 			dropcontinue = 0
-			goto *turn_end
+			goto *label_9247
 		}
 		screenupdate = 0
 		gosub *screen_draw
 		goto *pc_turn
 	}
@@ -13991,10 +14042,15 @@
 		if ( ibit(ITEM_BIT_FIREPROOF, ci) ) {
 			list(0, p) = 7
 			listn(0, p) = lang("それは炎では燃えない", "It is fireproof.")
 			p++
 		}
+		if ( ibit(ITEM_BIT_COLDPROOF, ci) ) {
+			list(0, p) = 7
+			listn(0, p) = lang("それは冷気では砕けない", "It is coldproof.")
+			p++
+		}
 		if ( ibit(ITEM_BIT_PRECIOUS, ci) ) {
 			list(0, p) = 7
 			listn(0, p) = lang("それは貴重な品だ", "It is precious.")
 			p++
 		}
@@ -14066,14 +14122,14 @@
 		listn(0, p) = lang("このアイテムに関する知識を得るには、鑑定する必要がある。", "You have to identify the item to gain knowledge.")
 		p++
 	}
 	if ( inv(INV_ITEM_KNOWN, ci) >= ITEM_KNOWN_FULL ) {
 		repeat 15
-			if ( inv(40 + cnt * 2, ci) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 				break
 			}
-			val = inv(40 + cnt * 2, ci), inv(40 + cnt * 2 + 1, ci), 0, reftype
+			val = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci), inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci), 0, reftype
 			gosub *item_encdetail
 			listn(0, p) = lang("それは", "It ") + s
 			list(0, p) = rtval, rtval(1)
 			if ( inhmax > 0 ) {
 				cnt2 = cnt
@@ -14460,11 +14516,11 @@
 		}
 	}
 
 *com_identify_loop
 	if ( 1 == 0 ) {
-		goto *findTarget
+		goto *label_5740
 	}
 	redraw 0
 	s = lang("アイテムの知識", "Known Information"), strhint4 + strhint3
 	display_window (windoww - 600) / 2 + inf_screenx, winposy(408), 600, 408
 	display_topic itemname(ci), wx + 28, wy + 34
@@ -14533,21 +14589,21 @@
 		returnfromidentify = 1
 		return
 	}
 	goto *com_identify_loop
 
-*findTarget
+*label_5740
 	if ( cdata(CDATA_EXIST, cdata(CDATA_TARGET, cc)) != CHAR_STATE_ALIVE ) {
 		cdata(CDATA_TARGET, cc) = 0
 	}
 	else {
 		if ( synccheck(cdata(CDATA_TARGET, cc), -1) == 0 ) {
 			cdata(CDATA_TARGET, cc) = 0
 		}
 	}
 	if ( cdata(CDATA_TARGET, cc) == 0 ) {
-		gosub *com_findTarget
+		gosub *label_5748
 		if ( listmax != 0 ) {
 			f = 0
 			if ( cc == CHARA_PLAYER | cdata(CDATA_RELATION, cc) >= RELATION_NEUTRAL ) {
 				p = -3, -1, 0
 			}
@@ -14603,11 +14659,11 @@
 		return 0
 	}
 
 *com_fire
 	cc = CHARA_PLAYER
-	gosub *findTarget
+	gosub *label_5740
 	if ( stat == 0 ) {
 		goto *pc_turn
 	}
 	tc = cdata(CDATA_TARGET, CHARA_PLAYER)
 	if ( cdata(CDATA_RELATION, tc) >= RELATION_NEUTRAL ) {
@@ -14634,11 +14690,11 @@
 		txt lang("矢/弾丸の種類が適していない。", "You're equipped with wrong type of ammos.")
 		gosub *screen_draw
 		goto *pc_turn
 	}
 	gosub *act_fire
-	goto *turn_end
+	goto *label_9247
 
 *FindRangeWeapon
 	cw = -1
 	ammo = -1
 	repeat 30
@@ -14687,11 +14743,11 @@
 	if ( iequiploc(cw) == 5 ) {
 		attackskill = SKILL_WEAPON_THROWING
 	}
 	return 1
 
-*com_findTarget
+*label_5748
 	listmax = 0
 	repeat 2
 		repeat 245
 			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
 				continue
@@ -14759,11 +14815,11 @@
 	return
 
 *com_rest
 	r1 = 50
 	gosub *rest
-	goto *turn_end
+	goto *label_9247
 
 *com_rowActCancel
 	txt lang(actlistn(cdata(CDATA_ROW_ACT, cc)) + "を中断したほうがいいだろうか？ ", "Do you want to cancel " + actlistn(cdata(CDATA_ROW_ACT, cc)) + "? ")
 	promptl(0, 0) = stryes, "y", "0"
 	promptl(0, 1) = strno, "n", "1"
@@ -14811,11 +14867,11 @@
 		goto *com_config
 	}
 	gosub *screen_draw
 	goto *pc_turn
 
-*check_return
+*label_5756
 	f = 0
 	repeat 5
 		p = gdata(GDATA_QUEST_POOL + cnt)
 		if ( qdata(QDATA_STATE, p) == QUEST_STATE_ONGOING ) {
 			if ( qdata(QDATA_EXIST, p) == QUEST_TYPE_ESCORT | qdata(QDATA_EXIST, p) == QUEST_TYPE_DELIVER ) {
@@ -14825,11 +14881,11 @@
 		}
 	loop
 	return f
 
 *com_return
-	gosub *check_return
+	gosub *label_5756
 	if ( stat == 1 ) {
 		txt lang("依頼請負中の帰還は法律で禁止されている。それでも帰還する？", "Returning while taking a quest if forbidden. Are you sure you want to return?")
 		promptl(0, 0) = stryes, "y", "0"
 		promptl(0, 1) = strno, "n", "1"
 		promptmax = 2
@@ -14979,13 +15035,13 @@
 		}
 		else {
 			txt lang("" + matname(tmat) + "を持っていない…", "You don't have " + matname(tmat) + ".")
 		}
 	}
-	goto *turn_end
+	goto *label_9247
 
-*com_train
+*label_5761
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SKILLBOOK ) {
 		if ( sorg(inv(INV_ITEM_PARAM1, ci), CHARA_PLAYER) == 0 ) {
 			txt lang("この本の内容には興味がない。それでも読む？ ", "You are not interested in this book. Do you want to read it anyway? ")
 			promptl(0, 0) = stryes, "y", "0"
 			promptl(0, 1) = strno, "n", "1"
@@ -14996,11 +15052,11 @@
 				return 0
 			}
 		}
 	}
 	gdata(GDATA_ROW_ACT) = ACTION_TRAIN
-	gosub *generalAct
+	gosub *label_6023
 	return 1
 
 *com_dump
 	if ( gdata(GDATA_WIZARD) ) {
 		snd SOUNDLIST_FAIL1
@@ -15099,11 +15155,11 @@
 		_fdialog fileext, 17, filedsc, exedir + "user", "default.pet"
 		if ( stat == 0 ) {
 			return
 		}
 		userfile = refstr
-		gosub *export_chara
+		gosub *label_5880
 		txtef COLOR_GREEN
 		txt lang("ペットチームを" + userfile + "に保存した。", "Your team is saved to " + userfile + ".")
 		return
 	}
 	if ( rtval == 2 ) {
@@ -15154,11 +15210,11 @@
 	gosub *db_class
 	buff = ""
 	notesel buff
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Dump:1" + " ct:" + ct
-	noteadd "Elona Version " + "6.13" + " キャラクター情報 " + gdata(GDATA_YEAR) + "年" + gdata(GDATA_MONTH) + "月" + gdata(GDATA_DAY) + "日 " + gdata(GDATA_HOUR) + "時" + gdata(GDATA_MIN) + "分  " + mdatan(0)
+	noteadd "Elona Version " + "6.14" + " キャラクター情報 " + gdata(GDATA_YEAR) + "年" + gdata(GDATA_MONTH) + "月" + gdata(GDATA_DAY) + "日 " + gdata(GDATA_HOUR) + "時" + gdata(GDATA_MIN) + "分  " + mdatan(0)
 	noteadd ""
 	noteadd "  " + fixtxt("" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER), 34) + _sex(cdata(CDATA_SEX, CHARA_PLAYER)) + " " + calcage(0) + "歳" + "  " + cdata(CDATA_HEIGHT, CHARA_PLAYER) + "cm" + " " + cdata(CDATA_WEIGHT, CHARA_PLAYER) + "kg"
 	noteadd ""
 	noteadd fixtxt("種族       : " + racename, 30) + fixtxt("信仰      : " + godname(cdata(CDATA_GOD, CHARA_PLAYER)), 32)
 	noteadd fixtxt("職業       : " + classname, 30) + fixtxt("所属      : " + guildname(), 32)
@@ -15393,14 +15449,14 @@
 		goto *pc_turn
 	}
 	listmax = 0
 	cs = -1
 	repeat 15
-		if ( inv(40 + cnt * 2, ci) == 0 ) {
+		if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 			break
 		}
-		enc = inv(40 + cnt * 2, ci)
+		enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci)
 		i = enc / 10000
 		if ( i != 0 ) {
 			enc = enc \ 10000
 			if ( i == 9 ) {
 				if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == cnt ) {
@@ -15430,12 +15486,12 @@
 		if ( cnt == 0 ) {
 			s = lang("通常弾", "Normal"), lang("無限", "Unlimited")
 		}
 		else {
 			p = list(0, cnt - 1)
-			i = inv(40 + p * 2 + 1, ci) \ 1000, inv(40 + p * 2 + 1, ci) / 1000
-			s = ammoname(inv(40 + p * 2, ci) \ 10000), "" + i + "/" + i(1)
+			i = inv(STARTING_INV_ITEM_ENCHANT + p * 2 + 1, ci) \ 1000, inv(STARTING_INV_ITEM_ENCHANT + p * 2 + 1, ci) / 1000
+			s = ammoname(inv(STARTING_INV_ITEM_ENCHANT + p * 2, ci) \ 10000), "" + i + "/" + i(1)
 		}
 		s = s + ":" + s(1)
 		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == cnt - 1 ) {
 			s = "[" + s + "]"
 			txtef COLOR_BLUE
@@ -15446,10 +15502,4197 @@
 		txtmore
 		txt " " + s
 	loop
 	goto *pc_turn
 
+*label_5776
+	inv_getheader -1
+	repeat invrange, invhead
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_CARD | inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+			inv(INV_ITEM_NUM, cnt) = 0
+		}
+	loop
+	return
+
+*label_5778
+	procid = (procid + 1) \ 4
+	proclist(procid) = "fixOnMapEnter" + " ct:" + ct
+	repeat 245
+		if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
+			if ( cdata(CDATA_X, cnt) < 0 | cdata(CDATA_X, cnt) >= mdata(MDATA_WIDTH) | cdata(CDATA_Y, cnt) < 0 | cdata(CDATA_Y, cnt) >= mdata(MDATA_HEIGHT) ) {
+				cdata(CDATA_X, cnt) = 0
+				cdata(CDATA_Y, cnt) = 0
+			}
+		}
+	loop
+	if ( mdata(MDATA_TYPE) != MAP_TYPE_HOME ) {
+		if ( mdata(MDATA_MAX_INV) != 0 ) {
+			mdata(MDATA_MAX_INV) = 0
+		}
+	}
+	if ( gdata(GDATA_AREA) == AREA_HOME ) {
+		if ( gdata(GDATA_FLAG_INVITED_GOD) != 0 ) {
+			evadd EVENT_SPAWN_EVENT_NPCS
+		}
+		adata(ADATA_MIN_LEVEL, gdata(GDATA_AREA)) = 0
+		adata(ADATA_MAX_LEVEL, gdata(GDATA_AREA)) = 10
+		adata(ADATA_RESTORE_POS, gdata(GDATA_AREA)) = 1
+		mdata(MDATA_RESTORE_POS) = 1
+		if ( gdata(GDATA_TEMPORARY_FLAGS2) == 0 ) {
+			evadd EVENT_WELCOME
+		}
+		calccosthire
+	}
+	gdata(GDATA_TEMPORARY_FLAGS2) = 0
+	return
+
+*label_5780
+	if ( gdata(GDATA_VERSION) != int(double("6.14") * 1000) ) {
+		dialog lang("Ver." + gdata(GDATA_VERSION) + "のセーブデータをアップデートします。", "Updating your save data from Ver." + gdata(GDATA_VERSION) + " now.")
+	}
+	if ( gdata(GDATA_HEIR_DEED) < 0 ) {
+		gdata(GDATA_HEIR_DEED) = 1
+	}
+	if ( gdata(GDATA_TRAVEL_TIME) == 0 ) {
+		gdata(GDATA_TRAVEL_TIME) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
+	}
+	if ( gdata(GDATA_VERSION) == 940 ) {
+		if ( gdata(STARTING_GDATA_RANK + 4) != 0 ) {
+			gdata(STARTING_GDATA_RANK + 2) = gdata(STARTING_GDATA_RANK + 4)
+		}
+	}
+	repeat 20
+		if ( gdata(STARTING_GDATA_RANK + cnt) == 0 ) {
+			gdata(STARTING_GDATA_RANK + cnt) = 10000
+		}
+	loop
+	itemmemory(2, ITEM_ID_SPELLBOOK_WISHING) = 0
+	itemmemory(2, ITEM_ID_SPELLBOOK_HARVEST) = 0
+	if ( gdata(GDATA_VERSION) < 950 ) {
+		itemcreate CHARA_PLAYER, ITEM_ID_PLAYBACK_DISC, -1, -1, 0
+		itemcreate CHARA_PLAYER, ITEM_ID_FREEZER, -1, -1, 0
+		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 6
+	}
+	if ( gdata(GDATA_VERSION) < 952 ) {
+		gdata(GDATA_WORLD_RENEW) = TRUE
+	}
+	if ( gdata(GDATA_VERSION) < 954 ) {
+		repeat 16
+			if ( cnt == 0 | cdata(CDATA_EXIST, cnt) == CHAR_STATE_DEAD ) {
+				continue
+			}
+			inv_getheader cnt
+			cnt2 = cnt
+			repeat invrange, invhead
+				if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
+					if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_GOLD_PIECE ) {
+						inv(INV_ITEM_WEIGHT, cnt) = 0
+					}
+					item_stack cnt2, cnt
+				}
+			loop
+		loop
+		gdata(GDATA_LIGHT) = 90
+	}
+	if ( gdata(GDATA_VERSION) < 960 ) {
+		gdata(GDATA_FLAG_HOLY_WELL) = 2
+	}
+	if ( gdata(GDATA_VERSION) < 973 ) {
+		gdata(GDATA_CORRUPTION) = 0
+		repeat 228
+			if ( trait(cnt) != 0 ) {
+				if ( cnt > 37 ) {
+					trait(cnt) = 0
+				}
+			}
+		loop
+		gosub *label_0046
+	}
+	if ( gdata(GDATA_VERSION) < 975 ) {
+		file = exedir + "tmp\\"
+		existwrapper file + "mdata_5_103.s2"
+		if ( strsize != (-1) ) {
+			deletewrapper file + "mdata_5_103.s2"
+		}
+		if ( gdata(GDATA_AREA) == AREA_VERNIS ) {
+			dialog "マップをアップデートするため、一度ヴェルニースに出入りしてください。"
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 1010 ) {
+		gdata(GDATA_SISTER_KILLED) = 0
+	}
+	if ( gdata(GDATA_VERSION) < 1060 ) {
+		repeat 57
+			cdata(CDATA_RELATION_ORG, cnt) = RELATION_ALLY
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 1070 ) {
+		repeat 57
+			cdata(CDATA_LEVEL_ORG, cnt) = cdata(CDATA_LEVEL, cnt)
+			if ( cnt >= 16 ) {
+				cdata(CDATA_RELATION, cnt) = RELATION_NEUTRAL
+				cdata(CDATA_RELATION_ORG, cnt) = RELATION_NEUTRAL
+			}
+			else {
+				cdata(CDATA_RELATION, cnt) = RELATION_ALLY
+				cdata(CDATA_RELATION_ORG, cnt) = RELATION_ALLY
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 1100 ) {
+		gdata(GDATA_WELL_WISH) = 0
+		gosub *label_0046
+	}
+	if ( gdata(GDATA_VERSION) < 1110 ) {
+		gdata(GDATA_GUEST) = 0
+		gdata(GDATA_WORLD_RENEW) = TRUE
+		repeat 57
+			if ( cdata(CDATA_ROLE, cnt) == ROLE_ADVENTURER ) {
+				cdata(CDATA_AI_INT, cnt) = 100
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 1111 ) {
+		gdata(GDATA_WORLD_RENEW) = TRUE
+		dialog lang("ユーザー物件の情報をアップデートするため、ゲーム開始後一度ワールドマップに出てください。", "Please exit the current area and enter the world map once to update game data.")
+	}
+	if ( gdata(GDATA_VERSION) < 1130 ) {
+		cfg_net = 1
+		valn = "net.", "1"
+		gosub *cfg_write
+		cfg_netwish = 1
+		valn = "netWish.", "1"
+		gosub *cfg_write
+		cfg_netchat = 0
+		valn = "netChat.", "0"
+		gosub *cfg_write
+	}
+	if ( gdata(GDATA_VERSION) < 1140 ) {
+		cfg_exanime = 1
+		valn = "exAnime.", "1"
+		gosub *cfg_write
+		gdata(GDATA_WORLD_RENEW) = TRUE
+		gosub *label_5817
+	}
+	if ( gdata(GDATA_VERSION) < 1150 ) {
+		if ( gdata(GDATA_PLAY_TIME) < 0 ) {
+			gdata(GDATA_PLAY_TIME) = 600 * 60 * 60
+		}
+		else {
+			gdata(GDATA_PLAY_TIME) /= 1000
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 1170 ) {
+		if ( 0 == 0 ) {
+			if ( adata(ADATA_TYPE, gdata(GDATA_AREA)) != MAP_TYPE_TOWN ) {
+				dialog lang("アップデートを行うには、街中でセーブしたセーブデータが必要です。", "To update your game, please save your game in a town in the previous version then retry.")
+				goto *exit_game
+			}
+		}
+		dialog lang("次のプロセスの完了までには、しばらく時間がかかることがあります。", "The next updating process may take a while to complete.")
+		memcpy adata(ADATA_TYPE, 300), adata(ADATA_TYPE, 100), 40 * (150 - 100) * 4
+		memcpy adata(ADATA_TYPE, 450), adata(ADATA_TYPE, 150), 40 * (200 - 150) * 4
+		repeat 200 - 100, 100
+			p = cnt
+			sdim file_cnv
+			repeat 40
+				adata(cnt, p) = 0
+			loop
+			folder = exedir + "tmp"
+			dirlistwrapper buff, folder + "\\*_" + p + "_*.*"
+			if ( stat != 0 ) {
+				notesel buff
+				repeat stat
+					noteget file, cnt
+					p1 = instr(file, 0, "_")
+					p2 = instr(file, p1 + 1, "_")
+					if ( p >= 150 ) {
+						p3 = p - 150 + 450
+					}
+					else {
+						p3 = p - 100 + 300
+					}
+					file_cnv = folder + "\\" + strmid(file, 0, p1 + 1) + p3 + strmid(file, p1 + p2 + 1, 20)
+					file = folder + "\\" + file
+					bcopy file, file_cnv
+					fileadd file_cnv
+					delete file
+					fileadd file, 1
+				loop
+			}
+		loop
+		repeat 500
+			if ( adata(ADATA_ID, cnt) != AREA_NONE ) {
+				if ( adata(ADATA_PARENT, cnt) == AREA_NONE ) {
+					adata(ADATA_PARENT, cnt) = AREA_NORTH_TYRIS
+				}
+			}
+		loop
+		gdata(GDATA_WORLD) = AREA_NORTH_TYRIS
+	}
+	if ( gdata(GDATA_VERSION) < 2130 ) {
+		if ( gdata(GDATA_QUEST) == QUEST_TYPE_THIEVES ) {
+			gdata(GDATA_QUEST) = QUEST_TYPE_NONE
+			dialog lang("盗賊団フラグ抹消。", "Death bug is corrected.")
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 2160 ) {
+		repeat 57
+			aphantei = 0
+			if ( cbit(CHARA_BIT_AWAKE_DIM_ATTACKER, cnt) ) {
+				aphantei += 1
+			}
+			if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_EVASION, cnt) ) {
+				aphantei += 1
+			}
+			if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_DAMAGE, cnt) ) {
+				aphantei += 1
+			}
+			if ( cbit(CHARA_BIT_AWAKE_MP_BARRIER, cnt) ) {
+				aphantei += 1
+			}
+			if ( aphantei == 3 ) {
+				if ( cbit(CHARA_BIT_AWAKE_DIM_ATTACKER, cnt) != TRUE ) {
+					cbitmod CHARA_BIT_AWAKE_NEAR_DEATH_EVASION, cnt, FALSE
+					cdata(CDATA_AP_CURRENT, cnt) += 1800
+				}
+				if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_EVASION, cnt) != TRUE ) {
+					cbitmod CHARA_BIT_AWAKE_NEAR_DEATH_DAMAGE, cnt, FALSE
+					cdata(CDATA_AP_CURRENT, cnt) += 2000
+				}
+				if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_DAMAGE, cnt) != TRUE ) {
+					cbitmod CHARA_BIT_AWAKE_MP_BARRIER, cnt, FALSE
+					cdata(CDATA_AP_CURRENT, cnt) += 2000
+				}
+				if ( cbit(CHARA_BIT_AWAKE_MP_BARRIER, cnt) != TRUE ) {
+					cbitmod CHARA_BIT_AWAKE_DIM_ATTACKER, cnt, FALSE
+					cdata(CDATA_AP_CURRENT, cnt) += 1500
+				}
+			}
+			if ( aphantei == 4 ) {
+				cbitmod CHARA_BIT_AWAKE_DIM_ATTACKER, cnt, FALSE
+				cbitmod CHARA_BIT_AWAKE_NEAR_DEATH_EVASION, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 3300
+			}
+			aphantei = 0
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 2180 ) {
+		repeat 57
+			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_GALACTICA_PHANTOM | cdata(CDATA_ID, cnt) == CREATURE_ID_SHADOW | cdata(CDATA_ID, cnt) == CREATURE_ID_VOL_PHANTOM | cdata(CDATA_ID, cnt) == CREATURE_ID_LESSER_PHANTOM ) {
+				cdatan(CDATAN_RACE, cnt) = "ghost"
+			}
+			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_HELL_CRAB | cdata(CDATA_ID, cnt) == CREATURE_ID_FIRE_CRAB ) {
+				cdatan(CDATAN_RACE, cnt) = "shell"
+			}
+			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_BOMB_THROWER | cdata(CDATA_ID, cnt) == CREATURE_ID_MAD_SCIENTIST | cdata(CDATA_ID, cnt) == CREATURE_ID_WHOM_DWELL_IN_THE_VANITY | cdata(CDATA_ID, cnt) == CREATURE_ID_LOYTER_THE_CRIMSON_OF_ZANAN | cdata(CDATA_ID, cnt) == CREATURE_ID_NOBLE | cdata(CDATA_ID, cnt) == CREATURE_ID_GANGSTER | cdata(CDATA_ID, cnt) == CREATURE_ID_ROCK_THROWER | cdata(CDATA_ID, cnt) == CREATURE_ID_PUBLIC_PERFORMER | cdata(CDATA_ID, cnt) == CREATURE_ID_NURSE | cdata(CDATA_ID, cnt) == CREATURE_ID_RICH_PERSON | cdata(CDATA_ID, cnt) == CREATURE_ID_NOBLE_CHILD ) {
+				cdatan(CDATAN_RACE, cnt) = "zanan"
+			}
+			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_PART_TIME_WORKER2 | cdata(CDATA_ID, cnt) == CREATURE_ID_TRAVELER | cdata(CDATA_ID, cnt) == CREATURE_ID_SWIMMER | cdata(CDATA_ID, cnt) == CREATURE_ID_KARAM_THE_LONELY_WOLF_OF_KARUNE | cdata(CDATA_ID, cnt) == CREATURE_ID_MERCENARY | cdata(CDATA_ID, cnt) == CREATURE_ID_FARMER | cdata(CDATA_ID, cnt) == CREATURE_ID_MINER | cdata(CDATA_ID, cnt) == CREATURE_ID_PART_TIME_WORKER | cdata(CDATA_ID, cnt) == CREATURE_ID_PRISONER ) {
+				cdatan(CDATAN_RACE, cnt) = "karune"
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) == 2170 ) {
+		repeat 57
+			if ( cnt == 0 ) {
+				continue
+			}
+			if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_EVASION, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_NEAR_DEATH_EVASION, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 1800
+			}
+			if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_DAMAGE, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_NEAR_DEATH_DAMAGE, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 2000
+			}
+			if ( cbit(CHARA_BIT_AWAKE_MP_BARRIER, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_MP_BARRIER, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 2000
+			}
+			if ( cbit(CHARA_BIT_AWAKE_DIM_ATTACKER, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_DIM_ATTACKER, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 1500
+			}
+			if ( cbit(CHARA_BIT_AWAKE_INSULT, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_INSULT, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 100
+			}
+			if ( cbit(CHARA_BIT_AWAKE_CRYSTAL_SPEAR, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_CRYSTAL_SPEAR, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 600
+			}
+			if ( cbit(CHARA_BIT_AWAKE_TACTICAL_HEAL, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_TACTICAL_HEAL, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 500
+			}
+			if ( cbit(CHARA_BIT_AWAKE_DIMENSIONAL_MOVE, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_DIMENSIONAL_MOVE, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 100
+			}
+			if ( cbit(CHARA_BIT_AWAKE_TACTICAL_ATTACK, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_TACTICAL_ATTACK, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 400
+			}
+			if ( cbit(CHARA_BIT_AWAKE_TACTICAL_MARTIAL_ARTS, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_TACTICAL_MARTIAL_ARTS, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 600
+			}
+			if ( cbit(CHARA_BIT_AWAKE_CHARGE_ATTACK, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_CHARGE_ATTACK, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 1000
+			}
+			if ( cbit(CHARA_BIT_AWAKE_PROVOKE, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_PROVOKE, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 200
+			}
+			if ( cbit(CHARA_BIT_AWAKE_TACTICAL_CURSE, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_TACTICAL_CURSE, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 500
+			}
+			if ( cbit(CHARA_BIT_AWAKE_VARIABLE_BREATH, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_VARIABLE_BREATH, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 400
+			}
+			if ( cbit(CHARA_BIT_AWAKE_VARIABLE_STORM, cnt) == TRUE ) {
+				cbitmod CHARA_BIT_AWAKE_VARIABLE_STORM, cnt, FALSE
+				cdata(CDATA_AP_CURRENT, cnt) += 800
+			}
+			if ( cdata(CDATA_AP_CURRENT, cnt) > 20000 ) {
+				cdata(CDATA_AP_CURRENT, cnt) = rnd(500)
+				cbitmod CHARA_BIT_UNKNOWN_1010, cnt, TRUE
+			}
+			if ( cdata(CDATA_AP_CURRENT, cnt) > 12000 ) {
+				cdata(CDATA_AP_CURRENT, cnt) = 3000 + rnd(500)
+			}
+			if ( cdata(CDATA_AP_CURRENT, cnt) > 11000 ) {
+				cdata(CDATA_AP_CURRENT, cnt) = 4000 + rnd(500)
+			}
+			if ( cdata(CDATA_AP_CURRENT, cnt) > 10000 ) {
+				cdata(CDATA_AP_CURRENT, cnt) = 5000 + rnd(500)
+			}
+			if ( cdata(CDATA_AP_CURRENT, cnt) > 9000 ) {
+				cdata(CDATA_AP_CURRENT, cnt) = 6000 + rnd(500)
+			}
+			if ( cdata(CDATA_AP_CURRENT, cnt) > 8000 ) {
+				cdata(CDATA_AP_CURRENT, cnt) = 7000 + rnd(500)
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) == 2180 ) {
+		dialog lang("アップデートを行うには、1.1555以外のセーブデータが必要です。", "To update your game, please save not 1.1555 version then retry.")
+		goto *exit_game
+	}
+	if ( gdata(GDATA_VERSION) < 2210 ) {
+		repeat 5480
+			inv(INV_ITEM_PARAM4, cnt) = 0
+		loop
+	}
+	if ( gdata(GDATA_VERSION) == 2220 ) {
+		dialog lang("1.18fix以外のセーブデータは使えません。", "To update your game, please save not 1.18fix version then retry.")
+		goto *exit_game
+	}
+	if ( gdata(GDATA_VERSION) < 2260 ) {
+		repeat 57
+			if ( cnt == 0 ) {
+				continue
+			}
+			if ( cdata(CDATA_DIRECTIVE_MODE, cnt) > DIRECTIVE_MODE_OFFENSIVE ) {
+				cdata(CDATA_DIRECTIVE_MODE, cnt) = DIRECTIVE_MODE_DEFENSIVE
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 2280 ) {
+		repeat 57
+			if ( cnt == 0 ) {
+				continue
+			}
+			if ( cdata(CDATA_SEX, cnt) == 0 ) {
+				cdata(CDATA_TONE_SEX, cnt) = 1
+			}
+			else {
+				cdata(CDATA_TONE_SEX, cnt) = 2
+			}
+		loop
+		repeat 5480
+			saiseiseimode = 0
+			ci = cnt
+			if ( inv(INV_ITEM_ATTACK, ci) == 0 & inv(INV_ITEM_DAMAGE, ci) == 0 & inv(INV_ITEM_DV, ci) == 0 & inv(INV_ITEM_PV, ci) == 0 ) {
+				continue
+			}
+			oldcol = inv(INV_ITEM_COL, ci)
+			oldweight = inv(INV_ITEM_WEIGHT, ci)
+			if ( inv(INV_ITEM_CHARA_PIC, ci) != xy2pic(0, 0) ) {
+				inv(INV_ITEM_PV, ci) = inv(INV_ITEM_CHARA_PIC, ci)
+			}
+			if ( inv(INV_ITEM_NEED_SLEEP, ci) != 0 ) {
+				inv(INV_ITEM_DV, ci) = inv(INV_ITEM_NEED_SLEEP, ci)
+			}
+			if ( inv(INV_ITEM_AMUR_CAGE, ci) != 0 ) {
+				inv(INV_ITEM_DAMAGE, ci) = inv(INV_ITEM_AMUR_CAGE, ci)
+			}
+			if ( inv(INV_ITEM_SHOP_SAMPLE, ci) != 0 ) {
+				inv(INV_ITEM_ATTACK, ci) = inv(INV_ITEM_SHOP_SAMPLE, ci)
+			}
+			if ( inv(INV_ITEM_QUALITY, ci) == FIX_QUALITY_UNIQUE ) {
+				saiseiseimode = 50
+			}
+			else {
+				saiseiseimode = 100
+			}
+			fixmaterial = inv(INV_ITEM_MATERIAL, ci)
+			gosub *remake_material
+			inv(INV_ITEM_WEIGHT, ci) = oldweight
+			inv(INV_ITEM_COL, ci) = oldcol
+			if ( ci >= 5080 ) {
+				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+			}
+		loop
+		saiseiseimode = 0
+	}
+	if ( gdata(GDATA_VERSION) < 2300 ) {
+		gdata(GDATA_FLAG_PROSTITUTION_COUNTER) = 0
+	}
+	if ( gdata(GDATA_VERSION) < 2310 ) {
+		gdata(GDATA_FLAG_HIGHEST_NORMAL_DAMAGE) = 0
+	}
+	if ( gdata(GDATA_VERSION) == 2310 ) {
+		dialog lang("アップデートを行うには、1.25以外のセーブデータが必要です。", "To update your game, please save not 1.25 version then retry.")
+		goto *exit_game
+	}
+	if ( gdata(GDATA_VERSION) <= 2390 ) {
+		repeat 5
+			p = gdata(GDATA_QUEST_POOL + cnt)
+			qdata(QDATA_EXIST, p) = QUEST_TYPE_NONE
+			qdata(QDATA_STATE, p) = QUEST_STATE_NONE
+		loop
+		repeat 16
+			cdata(CDATA_ALLIED, cnt) = 100
+			if ( cnt != 0 ) {
+				if ( cbit(CHARA_BIT_BODYGUARD, cnt) == TRUE ) {
+					if ( qdata(QDATA_PARAM2, rq) == cdata(CDATA_ID, cnt) ) {
+						tc = cnt
+						cbitmod CHARA_BIT_BODYGUARD, cnt, FALSE
+						if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
+							s = lang("「おい、暗殺者が私の後ろにいるぞ」", cnvtalk("Hey, the assassins are killing me."))
+							p = -11
+							txtef COLOR_SKY_BLUE
+							txtmore
+							txt s
+							dmghp tc, 999999, p
+						}
+						cdata(CDATA_EXIST, tc) = CHAR_STATE_DEAD
+						break
+					}
+				}
+			}
+		loop
+		repeat 500
+			qdata(QDATA_CLIENT, cnt) = 0
+			qdata(QDATA_MAP, cnt) = 0
+			gdata(GDATA_CLIENT) = 0
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 2430 ) {
+		repeat 245
+			cdata(CDATA_CAN_REVIVE, cnt) = 1
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 2440 ) {
+		gdata(GDATA_FLAG_HIGHEST_NORMAL_DAMAGE) = 0
+	}
+	if ( gdata(GDATA_VERSION) < 2480 ) {
+		repeat 245
+			tc = cnt
+			if ( cdata(CDATA_ID, tc) == CREATURE_ID_WASP | cdata(CDATA_ID, tc) == CREATURE_ID_RED_WASP | cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_HORNET ) {
+				if ( cdata(CDATA_EVOLUTION_STAGE, tc) != 0 ) {
+					resistmod tc, SKILL_RES_MAGIC, 50 * 10
+				}
+			}
+			if ( cdata(CDATA_ID, tc) == CREATURE_ID_RAT ) {
+				if ( cdata(CDATA_EVOLUTION_STAGE, tc) != 0 ) {
+					resistmod tc, SKILL_RES_FIRE, 50 * 10
+				}
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) == 2500 ) {
+		dialog lang("1.38のセーブデータはアップデートできません。", "To update your game, please save not 1.38 version then retry.")
+		goto *exit_game
+	}
+	if ( gdata(GDATA_VERSION) < 2510 ) {
+		repeat 57
+			if ( cdata(CDATA_AP_CURRENT, cnt) > 2000 ) {
+				cdata(CDATA_AP_CURRENT, cnt) = 2000
+			}
+			cdata(CDATA_INIT_LIFEMANA, cnt) = limit(sorg(SKILL_ATTR_LIFE, cnt), 50, 200) * 2 + limit(sorg(SKILL_ATTR_MANA, cnt), 50, 200) / 2
+			if ( cnt != 0 ) {
+				cdata(CDATA_SKILLPOINT, cnt) = 0
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 2530 ) {
+		kamen = 100
+	}
+	if ( gdata(GDATA_VERSION) < 2540 ) {
+		if ( spact(SKILL_SPACT_GAUGE_RELEASE - STARTING_SKILL_SPACT) == 0 ) {
+			spact(SKILL_SPACT_GAUGE_RELEASE - STARTING_SKILL_SPACT) = 1
+			txtmore
+			txtef COLOR_YELLOW
+			txt lang("あなたは「" + skillname(SKILL_SPACT_GAUGE_RELEASE) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_GAUGE_RELEASE) + ".")
+		}
+		repeat 57
+			if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_DAMAGE, cnt) ) {
+				cdata(CDATA_AP_CURRENT, cnt) += 500
+			}
+		loop
+		if ( gdata(GDATA_DEEPEST_LEVEL) > gdata(GDATA_FLAG_MAIN) / 4 + 1 ) {
+			gdata(GDATA_DEEPEST_LEVEL) = gdata(GDATA_FLAG_MAIN) / 4 + 1
+		}
+	}
+	if ( gdata(GDATA_VERSION) <= 2550 & gdata(GDATA_VERSION) >= 2540 ) {
+		repeat 57
+			if ( cdata(CDATA_ALLIED, cnt) == 0 ) {
+				continue
+			}
+			tc = cnt
+			repeat 30, 100
+				if ( cnt != 120 & cnt != 121 & cnt != 122 ) {
+					continue
+				}
+				p = cdata(cnt, tc) \ EXT_EQUIP_SLOTS
+				if ( p == 0 ) {
+					continue
+				}
+				p--
+				inv(INV_ITEM_EQUIP, p) = 0
+				cdata(cnt, tc) = cdata(cnt, tc) / EXT_EQUIP_SLOTS * 10000
+			loop
+			cdata(CDATA_EQUIP_SLOT_21, tc) = 0
+			cdata(CDATA_EQUIP_SLOT_22, tc) = 0
+			cdata(CDATA_EQUIP_SLOT_23, tc) = 0
+			r1 = tc
+			gosub *charaRefresh
+		loop
+		tuikabui = 100
+	}
+	if ( gdata(GDATA_VERSION) <= 2570 & gdata(GDATA_VERSION) >= 2540 ) {
+		repeat 30, 100
+			if ( cnt != 120 & cnt != 121 & cnt != 122 ) {
+				continue
+			}
+			p = cdata(cnt, CHARA_PLAYER) \ EXT_EQUIP_SLOTS
+			if ( p == 0 ) {
+				continue
+			}
+			p--
+			inv(INV_ITEM_EQUIP, p) = 0
+			cdata(cnt, CHARA_PLAYER) = cdata(cnt, CHARA_PLAYER) / EXT_EQUIP_SLOTS * 10000
+		loop
+		cdata(CDATA_EQUIP_SLOT_21, CHARA_PLAYER) = 0
+		cdata(CDATA_EQUIP_SLOT_22, CHARA_PLAYER) = 0
+		cdata(CDATA_EQUIP_SLOT_23, CHARA_PLAYER) = 0
+		r1 = 0
+		gosub *charaRefresh
+		tuikabui = 100
+	}
+	if ( gdata(GDATA_VERSION) < 2620 ) {
+		kamen = 1000
+	}
+	if ( gdata(GDATA_VERSION) < 2670 ) {
+		gdata(GDATA_FLAG_SUB_THE_TRUE_APPEARANCE) = 0
+	}
+	if ( gdata(GDATA_VERSION) == 2710 ) {
+		if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) == 1002 ) {
+			gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) = 1003
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 2730 ) {
+		kamen2 = 100
+	}
+	if ( gdata(GDATA_VERSION) < 2750 ) {
+		gdata(GDATA_WORLD_RENEW) = TRUE
+	}
+	if ( gdata(GDATA_VERSION) < 2760 ) {
+		adata(ADATA_ECONOMY, 85) = 0
+		adata(ADATA_ECONOMY, 79) = 0
+		adata(ADATA_ECONOMY, 75) = 0
+		adata(ADATA_ECONOMY, 74) = 0
+		adata(ADATA_ECONOMY, 73) = 0
+		adata(ADATA_ECONOMY, 72) = 0
+		adata(ADATA_ECONOMY, 71) = 0
+		adata(ADATA_ECONOMY, 80) = 0
+		adata(ADATA_ECONOMY, 81) = 0
+		adata(ADATA_ECONOMY, 80) = 0
+	}
+	if ( gdata(GDATA_VERSION) < 2880 ) {
+		gdata(GDATA_FLAG_BIRTHDAY_CURRENT_YEAR) = int(gettime(0))
+	}
+	if ( gdata(GDATA_VERSION) < 2990 ) {
+		if ( int(gettime(1)) == 12 ) {
+			if ( int(gettime(3)) <= 25 ) {
+				kamen3 = 100
+			}
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 3050 ) {
+		repeat 57
+			if ( cnt == 0 ) {
+				cdata(CDATA_THIRST, cnt) = 9000
+			}
+			else {
+				cdata(CDATA_THIRST, cnt) = 10000 - 1000 + rnd(4000)
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 3060 ) {
+		repeat 450 - 300, 300
+			if ( adata(ADATA_ID, cnt) != AREA_SHOP ) {
+				continue
+			}
+			adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), cnt) = 0
+			adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), cnt) = 0
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 3080 ) {
+		if ( gdata(GDATA_FLAG_GAME_MODE) == 5 ) {
+			kamen4 = 100
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 3120 ) {
+		repeat 40 - 1, 16
+			if ( cdata(CDATA_HIRE_DATE, cnt) != 0 ) {
+				cdata(CDATA_AREA, cnt) = gdata(GDATA_AREA)
+				cdata(CDATA_EXIST, cnt) = CHAR_STATE_ALIVE
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) < 3140 ) {
+		if ( gdata(GDATA_DAY) > 31 ) {
+			gdata(GDATA_DAY) = 30
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 3170 ) {
+		kamen5 = 100
+	}
+	if ( gdata(GDATA_VERSION) < 3180 ) {
+		kamen6 = 100
+	}
+	if ( gdata(GDATA_VERSION) < 3930 ) {
+		repeat 245
+			cdata(CDATA_CUSTOM_TALK_LINE, cnt) = 0
+		loop
+		gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) = cdata(CDATA_LEVEL, CHARA_PLAYER) * 5
+		if ( gdata(GDATA_FLAG_GAME_MODE) == 5 ) {
+			gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) += 10000
+		}
+		txt lang("あなたはスペルボーナスを獲得した。", "You gain spellbonus points.")
+	}
+	if ( gdata(GDATA_VERSION) < 3990 ) {
+		repeat 245
+			if ( cdata(CDATA_EVOLUTION_STAGE, cnt) != 1 ) {
+				continue
+			}
+			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_FLOATING_EYE | cdata(CDATA_ID, cnt) == CREATURE_ID_CHAOS_EYE | cdata(CDATA_ID, cnt) == CREATURE_ID_MAD_GAZE | cdata(CDATA_ID, cnt) == CREATURE_ID_DEATH_GAZE | cdata(CDATA_ID, cnt) == CREATURE_ID_DEFORMED_EYE | cdata(CDATA_ID, cnt) == CREATURE_ID_IMPURE_EYE ) {
+				cdata(CDATA_CHARA_PIC, cnt) = xy2pic(1, 0)
+				txt lang("目系進化体グラフィック修正。", "The graphic of the eye evolution character have been corrected.")
+			}
+		loop
+		gdata(GDATA_CARGO_LIMIT) = gdata(GDATA_CARGO_LIMIT) / 10000 * 10000
+		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 1 ) {
+			gdata(GDATA_CARGO_LIMIT) += 10 * 1000
+		}
+		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 2 ) {
+			gdata(GDATA_CARGO_LIMIT) += 20 * 1000
+		}
+		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 3 ) {
+			gdata(GDATA_CARGO_LIMIT) += 30 * 1000
+		}
+		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 4 ) {
+			gdata(GDATA_CARGO_LIMIT) += 100 * 1000
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 5980 ) {
+		gdata(GDATA_FLAG_PC_SKILL_BONUS_OBTAINED) = cdata(CDATA_SKILLPOINT, CHARA_PLAYER)
+		gdata(GDATA_FLAG_SPELL_BONUS_OBTAINED) = gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS)
+		if ( gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) >= 100 | cdata(CDATA_SKILLPOINT, CHARA_PLAYER) >= 100 | cdata(CDATA_PLATINUM, CHARA_PLAYER) >= 100 ) {
+			if ( gdata(GDATA_FLAG_GAME_MODE) != 2 & gdata(GDATA_FLAG_GAME_MODE) != 5 ) {
+				dialog lang("注意！スペルボーナス、スキルボーナス、プラチナ硬貨は100以上所持していると新たに獲得できない。", "Caution! While the spell bonus is 100 or more, you cannot get new.")
+			}
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 6020 ) {
+		gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) = 0
+	}
+	if ( gdata(GDATA_VERSION) < 6050 ) {
+		if ( gdata(GDATA_FLAG_MAIN) >= 180 ) {
+			kamen7 = 100
+		}
+		if ( gdata(GDATA_FLAG_MAIN) >= 340 ) {
+			kamen8 = 100
+		}
+		if ( gdata(GDATA_FLAG_MAIN) >= 680 ) {
+			kamen9 = 100
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 6060 ) {
+		if ( gdata(GDATA_FLAG_SUB_AMURDAD) >= 10 ) {
+			gdata(GDATA_FLAG_SUB_AMURDAD) = 0
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "slime" ) {
+			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 200
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "sheep" ) {
+			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 120
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "zombie" ) {
+			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 150
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "ent" ) {
+			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 140
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "armor" ) {
+			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 200
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "skeleton" ) {
+			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 120
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "wisp" ) {
+			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 150
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "rabbit" ) {
+			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 120
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "cat" ) {
+			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 200
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "dog" ) {
+			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 200
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "rat" ) {
+			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 250
+		}
+		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "catsister" ) {
+			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 200
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 6070 ) {
+		if ( trait(TRAIT_NORMAL_SKILL_CASTING) != 0 ) {
+			if ( spact(SKILL_SPACT_MAGNECOAT - STARTING_SKILL_SPACT) == 0 ) {
+				spact(SKILL_SPACT_MAGNECOAT - STARTING_SKILL_SPACT) = 1
+				txtmore
+				txtef COLOR_YELLOW
+				txt lang("あなたは「" + skillname(SKILL_SPACT_MAGNECOAT) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_MAGNECOAT) + ".")
+			}
+		}
+		repeat 245
+			if ( cdata(CDATA_CONDITION_JIU_JITSU, cnt) != 0 ) {
+				cdata(CDATA_CONDITION_JIU_JITSU, cnt) = 0
+				cbitmod CHARA_BIT_VINDALIAN_JIUJITSU_ACTIVE, cnt, TRUE
+			}
+		loop
+	}
+	repeat 16
+		if ( cdata(CDATA_CHARA_PIC_ORG, cnt) == 1 ) {
+			cdata(CDATA_CHARA_PIC, cnt) = xy2pic(1, 0)
+		}
+		if ( cnt == 0 ) {
+			continue
+		}
+		if ( gdata(GDATA_AREA) == AREA_ARENA ) {
+			continue
+		}
+		if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_SUSPEND ) {
+			continue
+		}
+		if ( cdata(CDATA_IN_TAGTEAM, cnt) != 0 ) {
+			map(cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt), MAP_CHARA_INDEX_PLUS_ONE) = 0
+			cdata(CDATA_EXIST, cdata(CDATA_TAGTEAM_PARTNER, cnt)) = CHAR_STATE_SUSPEND
+			hagureta = 100
+		}
+	loop
+	if ( gdata(GDATA_VERSION) < 6090 ) {
+		if ( trait(TRAIT_NORMAL_STAT_SPD) != 0 ) {
+			cdata(CDATA_MATERIAL2_COUNTER, CHARA_PLAYER) = 1
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 6100 ) {
+		gdata(GDATA_FLAG_ABYSS_POWER) = gdata(GDATA_FLAG_ABYSS_POWER) * 20
+		if ( gdata(GDATA_FLAG_ABYSS_POWER) > 100000 ) {
+			gdata(GDATA_FLAG_ABYSS_POWER) = 100000
+		}
+	}
+	if ( gdata(GDATA_VERSION) < 6140 ) {
+		gdata(250 + 442) = gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND)
+		repeat 245
+			cdata(CDATA_SP_EARNED, cnt) = 0
+			if ( cdata(CDATA_TAMER_WHIP_PICKUP, cnt) != 0 ) {
+				cdata(CDATA_TAMER_WHIP_PICKUP, cnt) = 0
+				cbitmod 1032, cnt, TRUE
+			}
+			if ( cdata(CDATA_TAMER_WHIP_EAT, cnt) != 0 ) {
+				cdata(CDATA_TAMER_WHIP_EAT, cnt) = 0
+				cbitmod 1033, cnt, TRUE
+			}
+		loop
+	}
+	if ( gdata(GDATA_VERSION) != int(double("6.14") * 1000) ) {
+		gdata(GDATA_WORLD_RENEW) = TRUE
+	}
+	del_chara 56
+	if ( gdata(GDATA_VERSION) > int(double("6.14") * 1000) ) {
+		dialog "invalid version"
+		goto *exit_game
+	}
+	if ( gdata(GDATA_PLAY_TIME) < 0 ) {
+		gdata(GDATA_PLAY_TIME) = 0
+	}
+	if ( gdata(GDATA_FLAG_GAME_MODE) == 3 ) {
+		if ( gdata(GDATA_GAMEMODE_PENALTY) == 4 ) {
+			dialog lang("その冒険者は蘇らない…。", "The adventurer is not revived again...")
+			goto *exit_game
+		}
+	}
+	ima = int(gettime(5)) + int(gettime(4)) * 60 + int(gettime(3)) * 24 * 60
+	if ( int(gettime(1)) == gdata(GDATA_FLAG_REALTIME_HOURS) & int(gettime(0)) == gdata(GDATA_FLAG_REALTIME_DAYS) | gdata(GDATA_FLAG_REALTIME_MINUTES) == 0 ) {
+		if ( ima >= gdata(GDATA_FLAG_REALTIME_MINUTES) + 10 ) {
+			gdata(GDATA_FLAG_RARE_DROP) = 100
+		}
+		else {
+			gdata(GDATA_FLAG_RARE_DROP) = 0
+		}
+	}
+	else {
+		if ( ima >= 1440 + 10 ) {
+			gdata(GDATA_FLAG_RARE_DROP) = 100
+		}
+		else {
+			gdata(GDATA_FLAG_RARE_DROP) = 0
+		}
+	}
+	ima = 0
+	gdata(GDATA_FLAG_REALTIME_MINUTES) = int(gettime(5)) + int(gettime(4)) * 60 + int(gettime(3)) * 24 * 60
+	gdata(GDATA_FLAG_REALTIME_HOURS) = int(gettime(1))
+	gdata(GDATA_FLAG_REALTIME_DAYS) = int(gettime(0))
+	deru = 44
+	if ( gdata(GDATA_FLAG_GAME_MODE) == 5 ) {
+		gdata(GDATA_FLAG_RARE_DROP) = 100
+		dbg_noautosave = 1
+	}
+	if ( gdata(GDATA_FLAG_GAME_MODE) == 1 | gdata(GDATA_FLAG_GAME_MODE) == 3 | gdata(GDATA_FLAG_GAME_MODE) == 4 ) {
+		if ( gdata(GDATA_GAMEMODE_PENALTY) == 0 ) {
+			dialog lang("Escキーでセーブ後自動終了せずに、強制終了したセーブデータにはペナルティが与えられます。", "It is a nosave penalty.")
+			modkarma 0, -100
+			skillmod SKILL_ATTR_LIFE, CHARA_PLAYER, -5000
+			skillmod SKILL_ATTR_MANA, CHARA_PLAYER, -5000
+			cdata(CDATA_GOLD, CHARA_PLAYER) = cdata(CDATA_GOLD, CHARA_PLAYER) / 2
+			cdata(CDATA_PLATINUM, CHARA_PLAYER) = cdata(CDATA_PLATINUM, CHARA_PLAYER) / 2
+			addbuff CHARA_PLAYER, BUFF_PUNISHMENT, 100000, 100
+		}
+		if ( gdata(GDATA_GAMEMODE_PENALTY) == 1 ) {
+			gdata(GDATA_GAMEMODE_PENALTY) = 0
+			snd SOUNDLIST_ENC
+		}
+	}
+	gdata(GDATA_VERSION) = int(double("6.14") * 1000)
+	cbitmod CHARA_BIT_PCC, CHARA_PLAYER, TRUE
+	gdata(GDATA_SPEEDSUM_RESET) = 1
+	gosub *initial_recipe
+	return
+
+*label_5817
+	gdata(GDATA_MAP_VERSION)++
+	dim qdata, 20, 500
+	sdim qname, 40, 500
+	gdata(GDATA_CLIENT) = 0
+	gosub *label_4932
+	return
+
+*apply_gene
+	file = "shop" + 3 + ".s2"
+	fmode = 4
+	gosub *game_ctrlFile
+	pbigin = (pbigin - 250) / 7
+	if ( pbigin < 5 ) {
+		pbigin = 5
+	}
+	else {
+		if ( pbigin > 50 ) {
+			pbigin = 50
+		}
+	}
+	ibigin = (ibigin - 250) / 8
+	if ( ibigin < 5 ) {
+		ibigin = 5
+	}
+	else {
+		if ( ibigin > 40 ) {
+			ibigin = 40
+		}
+	}
+	cdata(CDATA_GOLD, CHARA_PLAYER) += goldbigin
+	cdata(CDATA_PLATINUM, CHARA_PLAYER) += pbigin
+	cdata(CDATA_SKILLPOINT, CHARA_PLAYER) += ibigin
+	repeat 400
+		mat(cnt) = mat(cnt) / 3
+	loop
+	return
+
+*label_5820
+	fmode = 15
+	gosub *game_ctrlFile
+	dim spell, 200
+	dim spact, 500
+	pbigin = 0
+	ibigin = 0
+	repeat 600
+		if ( cnt >= 10 & cnt < 20 ) {
+			pbigin += sorg(cnt, CHARA_PLAYER)
+		}
+		if ( cnt >= 100 & cnt < 400 ) {
+			ibigin += sorg(cnt, CHARA_PLAYER)
+		}
+	loop
+	goldbigin += limit(cdata(CDATA_GOLD, CHARA_PLAYER) / 100, 1000, 100000)
+	repeat 245
+		cdata(CDATA_EXIST, cnt) = CHAR_STATE_DEAD
+	loop
+	repeat 1200
+		sdata(cnt, MAX_CHARA_NC) = sdata(cnt, CHARA_PLAYER)
+		sdata(cnt, CHARA_PLAYER) = 0
+	loop
+	repeat 500
+		cdata(cnt, MAX_CHARA_NC) = cdata(cnt, CHARA_PLAYER)
+		cdata(cnt, CHARA_PLAYER) = 0
+	loop
+	inv_getheader -1
+	repeat invrange, invhead
+		inv(INV_ITEM_NUM, cnt) = 0
+	loop
+	inv_getheader 0
+	repeat invrange, invhead
+		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_SECRET_EXP_LOMIAS ) {
+			lomiaseaster = 1
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_DEED_HEIRSHIP | refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE_MINOR) == FILTER_ITEM_DEED ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_KITTY_BANK ) {
+			continue
+		}
+		if ( inv(INV_ITEM_QUALITY, cnt) == FIX_QUALITY_UNIQUE ) {
+			continue
+		}
+		if ( ibit(ITEM_BIT_PRECIOUS, cnt) ) {
+			continue
+		}
+		if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) == FILTER_AMMO ) {
+			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), cnt) = -1
+		}
+		inv(INV_ITEM_EQUIP, cnt) = 0
+		item_copy cnt, inv_getfreeid(-1)
+	loop
+	gdata(GDATA_FLAG_END_TAGTEAM) = 1000
+	repeat 245
+		del_chara cnt
+	loop
+	gdata(GDATA_FLAG_END_TAGTEAM) = 0
+	gdata(GDATA_PLAY_TIME) = genetemp(GDATA_PLAY_TIME)
+	return
+
+*generate_gene
+	fmode = 14
+	gosub *game_ctrlFile
+	return
+
+#deffunc zipadd str zipadd_arg1
+	p = 12
+	exist folder + zipadd_arg1
+	len = strsize + p * 2
+	lenhead = lensum
+	lensum += len
+	sdim ziptmp1, p
+	ziptmp1 += zipadd_arg1
+	sdim ziptmp2, p
+	ziptmp2 += str(len)
+	memexpand filebuff, lensum
+	memcpy filebuff, ziptmp1, p, lenhead
+	memcpy filebuff, ziptmp2, p, lenhead + p
+	sdim filetemp, len - p * 2
+	bload folder + zipadd_arg1, filetemp, , 0
+	memcpy filebuff, filetemp, len - p * 2, lenhead + p * 2
+	return
+
+*unzip
+	p = 12
+	folder = exedir + "user\\"
+	bload folder + file, headtemp, 1024
+	gosub *dump_config_import
+	exist folder + file
+	zipsize = strsize
+	sdim filebuff, zipsize
+	bload folder + file, filebuff, zipsize
+	lenhead = 1024
+	repeat 10000
+		sdim ziptmp1, p
+		sdim ziptmp2, p
+		memcpy ziptmp1, filebuff, p, 0, lenhead
+		memcpy ziptmp2, filebuff, p, 0, lenhead + p
+		len = int(ziptmp2)
+		sdim filetemp, len - p * 2
+		memcpy filetemp, filebuff, len - p * 2, 0, lenhead + p * 2
+		bsave folder + ziptmp1, filetemp
+		lenhead += len
+		if ( lenhead >= zipsize ) {
+			break
+		}
+	loop
+	return
+	goto *label_5837
+
+#deffunc zipinit2 str zipinit2_arg1, str zipinit2_arg2
+	locvar_zipinit2_lensum = 0
+	locvar_zipinit2_zipfolder = zipinit2_arg1
+	locvar_zipinit2_zipfinalfile = zipinit2_arg2
+	sdim locvar_zipinit2_filebuff
+	return
+
+#deffunc zipadd2 str zipadd2_arg1
+	locvar_zipadd2_p = 50, 40, 10
+	exist locvar_zipinit2_zipfolder + zipadd2_arg1
+	locvar_zipadd2_len = strsize + locvar_zipadd2_p
+	locvar_zipadd2_lenhead = locvar_zipinit2_lensum
+	locvar_zipinit2_lensum += locvar_zipadd2_len
+	sdim locvar_zipadd2_ziptmp1, locvar_zipadd2_p(1)
+	locvar_zipadd2_ziptmp1 += zipadd2_arg1
+	sdim locvar_zipadd2_ziptmp2, locvar_zipadd2_p(2)
+	locvar_zipadd2_ziptmp2 += str(locvar_zipadd2_len)
+	memexpand locvar_zipinit2_filebuff, locvar_zipinit2_lensum
+	memcpy locvar_zipinit2_filebuff, locvar_zipadd2_ziptmp1, locvar_zipadd2_p(1), locvar_zipadd2_lenhead
+	memcpy locvar_zipinit2_filebuff, locvar_zipadd2_ziptmp2, locvar_zipadd2_p(2), locvar_zipadd2_lenhead + locvar_zipadd2_p(1)
+	sdim locvar_zipadd2_filetemp, locvar_zipadd2_len - locvar_zipadd2_p
+	bload locvar_zipinit2_zipfolder + zipadd2_arg1, locvar_zipadd2_filetemp, , 0
+	memcpy locvar_zipinit2_filebuff, locvar_zipadd2_filetemp, locvar_zipadd2_len - locvar_zipadd2_p, locvar_zipadd2_lenhead + locvar_zipadd2_p
+	return
+
+#deffunc zipend2
+	bsave locvar_zipinit2_zipfolder + locvar_zipinit2_zipfinalfile, locvar_zipinit2_filebuff
+	return
+
+#deffunc unzip2 str unzip2_arg1, str unzip2_arg2
+	locvar_zipadd2_p = 50, 40, 10
+	exist unzip2_arg1 + unzip2_arg2
+	locvar_unzip2_zipsize = strsize
+	sdim locvar_zipinit2_filebuff, locvar_unzip2_zipsize
+	bload unzip2_arg1 + unzip2_arg2, locvar_zipinit2_filebuff, locvar_unzip2_zipsize
+	locvar_zipadd2_lenhead = 0
+	repeat 10000
+		sdim locvar_zipadd2_ziptmp1, locvar_zipadd2_p(1)
+		sdim locvar_zipadd2_ziptmp2, locvar_zipadd2_p(2)
+		memcpy locvar_zipadd2_ziptmp1, locvar_zipinit2_filebuff, locvar_zipadd2_p(1), 0, locvar_zipadd2_lenhead
+		memcpy locvar_zipadd2_ziptmp2, locvar_zipinit2_filebuff, locvar_zipadd2_p(2), 0, locvar_zipadd2_lenhead + locvar_zipadd2_p(1)
+		locvar_zipadd2_len = int(locvar_zipadd2_ziptmp2)
+		if ( locvar_zipadd2_len == 0 ) {
+			break
+		}
+		sdim locvar_zipadd2_filetemp, locvar_zipadd2_len - locvar_zipadd2_p
+		memcpy locvar_zipadd2_filetemp, locvar_zipinit2_filebuff, locvar_zipadd2_len - locvar_zipadd2_p, 0, locvar_zipadd2_lenhead + locvar_zipadd2_p
+		bsave unzip2_arg1 + locvar_zipadd2_ziptmp1, locvar_zipadd2_filetemp
+		locvar_zipadd2_lenhead += locvar_zipadd2_len
+		if ( locvar_zipadd2_lenhead >= locvar_unzip2_zipsize ) {
+			break
+		}
+	loop
+	return
+
+*label_5837
+	goto *label_5841
+
+#defcfunc getnpctxt str getnpctxt_arg1, str getnpctxt_arg2
+	locvar_getnpctxt_p = instr(txtbuff, 0, getnpctxt_arg1)
+	if ( locvar_getnpctxt_p == (-1) ) {
+		return getnpctxt_arg2
+	}
+	locvar_getnpctxt_p += instr(txtbuff, locvar_getnpctxt_p, "\"")
+	if ( locvar_getnpctxt_p == (-1) ) {
+		return getnpctxt_arg2
+	}
+	return strmid(txtbuff, locvar_getnpctxt_p + 1, limit(instr(txtbuff, locvar_getnpctxt_p + 1, "\""), 0, 70))
+
+#deffunc cnvvar var cnvvar_arg1, str cnvvar_arg2
+	locvar_cnvvar_ref = cnvvar_arg2
+	locvar_getnpctxt_p = 0
+	repeat
+		getstr cnvvar_arg1(cnt), locvar_cnvvar_ref, locvar_getnpctxt_p, 44
+		if ( cnvvar_arg1 == "" ) {
+			break
+		}
+		locvar_getnpctxt_p += strsize
+	loop
+	return
+
+*label_5841
+	if ( initunid ) {
+		cdata(CDATA_USERNPC_ID, rc) = initunid - 1
+		initunid = 0
+	}
+	cun = cdata(CDATA_USERNPC_ID, rc)
+	cdata(CDATA_ID, rc) = CREATURE_ID_USER
+	if ( initlv != 0 ) {
+		cdata(CDATA_LEVEL, rc) = initlv
+	}
+	else {
+		cdata(CDATA_LEVEL, rc) = limit(userdata(2, cun), 1, 350)
+	}
+	if ( cdata(CDATA_LEVEL, rc) > gdata(GDATA_DEEPEST_LEVEL) * 2 ) {
+		cdata(CDATA_LEVEL, rc) = limit(gdata(GDATA_DEEPEST_LEVEL) * 2, 1, 350)
+	}
+	cdata(CDATA_PORTRAIT, rc) = -1
+	creaturepack = FILTER_NOTHING
+	cdata(CDATA_ACT_INDEX, rc) = 55
+	cdata(CDATA_AI_SUB, rc) = unaiactsubfreq(cun)
+	repeat 5
+		cdata(STARTING_CDATA_ACT_MAIN + cnt, rc) = userdata(15 + cnt, cun)
+		cdata(STARTING_CDATA_ACT_SUB + cnt, rc) = userdata(20 + cnt, cun)
+	loop
+	if ( userdatan(5, cun) != "" ) {
+		sdim unres, 6, 32
+		csvstr2 unres, userdatan(5, cun)
+		repeat
+			if ( cnt > 15 | unres(cnt) == "" ) {
+				break
+			}
+			sdata(int(unres(cnt * 2)), rc) += int(unres(cnt * 2 + 1)) * 50
+		loop
+	}
+	cdata(CDATA_TXT, rc) = 1
+	cdata(CDATA_ALIGNMENT, rc) = -10000
+	cdatan(CDATAN_NAME, rc) = userdatan(1, cun)
+	cdatan(CDATAN_USER_NPC_TAG, rc) = userdatan(0, cun)
+	cdata(CDATA_RELATION, rc) = limit(userdata(4, cun), -3, 10)
+	cdata(CDATA_AI_CALM, rc) = limit(userdata(7, cun), 1, 4)
+	cdata(CDATA_AI_MOVE_FREQ, rc) = limit(userdata(8, cun), 0, 100)
+	cdata(CDATA_AI_DISTANCE, rc) = limit(userdata(9, cun), 1, 100)
+	if ( userdata(11, cun) ) {
+		cdata(CDATA_ELEMENT, rc) = limit(userdata(11, cun), SKILL_RES_FIRE * 100000, MAX_SKILL_RESDMG * 100000)
+	}
+	cdata(CDATA_ACT_HEAL, rc) = userdata(10, cun)
+	dbidn = userdatan(2, cun)
+	dbmode = DBMODE_SET
+	gosub *db_race
+	dbidn = userdatan(3, cun)
+	dbmode = DBMODE_SET
+	gosub *db_class
+	cdata(CDATA_SEX, rc) = userdata(3, cun)
+	if ( userdata(3, cun) != 0 ) {
+		if ( userdata(3, cun) != 1 ) {
+			cdata(CDATA_SEX, rc) = rnd(2)
+		}
+	}
+	if ( userdata(5, cun) ) {
+		fixlv = limit(userdata(5, cun), 0, 6)
+	}
+	cspecialeq = 0
+	cdata(CDATA_RELATION_ORG, rc) = cdata(CDATA_RELATION, rc)
+	fixaiact rc
+	setunid rc, cun
+	return
+
+*userNpc_update
+	procid = (procid + 1) \ 4
+	proclist(procid) = "userNpc_update" + " ct:" + ct
+	dirlist buff, exedir + "user\\*.npc"
+	notesel buff
+	usernpcmax = noteinfo(0)
+	if ( usernpcmax >= 240 ) {
+		usernpcmax = 240
+	}
+	dim userdata, 70, usernpcmax + 1
+	sdim userdatan, 40, 15, usernpcmax + 1
+	sdim usertxt, 80 * 100, usernpcmax + 1
+	sdim untaglist
+	gdata(GDATA_USERNPC_COUNT) = 0
+	buffer BUFFER_CHR, 33 * 48, (34 + (usernpcmax / 33 + 1) * 2) * 48
+	pos 0, 0
+	picload exedir + "\\graphic\\character" + devfile + ".bmp", 1
+	gmode 0
+	fread = 1
+	procid = (procid + 1) \ 4
+	proclist(procid) = "userNpc_update:1" + " ct:" + ct
+	func_1 buff, 1
+	tg = 0
+	repeat usernpcmax
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:2" + " ct:" + ct
+		noteget s, cnt
+		cnt2 = tg
+		unzip2 exedir + "user\\", s
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:2a" + " ct:" + ct
+		if ( fread == 0 ) {
+			zOpen hgz, exedir + "user\\npc1.t", 1, 3
+			zWrite userdata(0, tg), hgz, 70 * 4
+			zClose hgz
+		}
+		else {
+			zOpen hgz, exedir + "user\\npc1.t", 0
+			zRead userdata(0, tg), hgz, 70 * 4
+			zClose hgz
+		}
+		dim bmpbuff, userdata(0, tg)
+		sdim txtbuff, userdata(1, tg)
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:2c" + " ct:" + ct
+		if ( fread == 0 ) {
+			zOpen hgz, exedir + "user\\npc2.t", 1, 3
+			zWrite bmpbuff, hgz, userdata(0, tg)
+			zClose hgz
+		}
+		else {
+			zOpen hgz, exedir + "user\\npc2.t", 0
+			zRead bmpbuff, hgz, userdata(0, tg)
+			zClose hgz
+		}
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:2d" + " ct:" + ct
+		if ( fread == 0 ) {
+			zOpen hgz, exedir + "user\\npc3.t", 1, 3
+			zWrite txtbuff, hgz, userdata(1, tg)
+			zClose hgz
+		}
+		else {
+			zOpen hgz, exedir + "user\\npc3.t", 0
+			zRead txtbuff, hgz, userdata(1, tg)
+			zClose hgz
+		}
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:2e" + " ct:" + ct
+		s = getnpctxt("name.", "unknown,unknown")
+		csvstr2 s, s
+		userdatan(0, tg) = s
+		userdatan(1, tg) = s(jp)
+		noteget s, cnt
+		userdatan(6, tg) = s
+		if ( instr(untaglist, 0, "/" + userdatan(0, tg) + "/") != (-1) ) {
+			usernpcmax--
+			if ( instr(s, 0, "_tmp_") == (-1) ) {
+				msgtemp += lang("同名NPCは読み込まれない。", "A npc of the same name exists.") + "(skipped:" + userdatan(0, tg) + "," + s + ") "
+			}
+			continue
+		}
+		untaglist += "/" + userdatan(0, tg) + "/"
+		if ( instr(s, 0, "_tmp_") != (-1) ) {
+			gdata(GDATA_USERNPC_COUNT)++
+		}
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:set info" + " ct:" + ct
+		userdatan(2, tg) = getnpctxt("race.", "slime")
+		userdatan(3, tg) = getnpctxt("class.", "tourist")
+		userdatan(4, tg) = getnpctxt("filter.", "")
+		userdatan(5, tg) = getnpctxt("resist.", "")
+		s = getnpctxt("meleeElem.", "0,0")
+		csvstr2 s, s
+		userdata(11, tg) = int(s) * 100000 + int(s(1))
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:set bits" + " ct:" + ct
+		s = getnpctxt("bitOn.", "0,0")
+		csvstr2 s, s
+		repeat
+			p = int(s(cnt))
+			if ( cnt > 20 | p == 0 ) {
+				break
+			}
+			HMMBITON userdata(40 + p / 32, cnt2), p \ 32
+		loop
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:set actions" + " ct:" + ct
+		s = getnpctxt("aiAct.", "0,0,0,0,0")
+		csvstr2 s, s
+		repeat 5
+			userdata(15 + cnt, cnt2) = int(s(cnt))
+		loop
+		s = getnpctxt("aiActSub.", "0,0,0,0,0")
+		csvstr2 s, s
+		repeat 5
+			userdata(20 + cnt, cnt2) = int(s(cnt))
+		loop
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:set ref" + " ct:" + ct
+		userdata(12, tg) = int(getnpctxt("select.", "0"))
+		userdata(2, tg) = int(getnpctxt("level.", "1"))
+		userdata(3, tg) = int(getnpctxt("sex.", "-1"))
+		userdata(4, tg) = int(getnpctxt("relation.", "-1"))
+		userdata(5, tg) = int(getnpctxt("fixLv.", "0"))
+		userdata(6, tg) = int(getnpctxt("rare.", "0"))
+		userdata(7, tg) = int(getnpctxt("aiCalm.", "1"))
+		userdata(8, tg) = int(getnpctxt("aiMove.", "50"))
+		userdata(9, tg) = int(getnpctxt("aiDist.", "1"))
+		userdata(10, tg) = int(getnpctxt("aiHeal.", "0"))
+		unaiactsubfreq(tg) = int(getnpctxt("aiActSubFreq.", "0"))
+		p = instr(txtbuff, 0, "%txt")
+		txtbuff = strmid(txtbuff, p, instr(txtbuff, 0, "%endTxt") - p)
+		usertxt(tg) = strmid(txtbuff, 0, 80 * 100 - 2)
+		procid = (procid + 1) \ 4
+		proclist(procid) = "userNpc_update:2.1" + " ct:" + ct
+		gsel BUFFER_PIC2
+		memfile bmpbuff
+		picload "MEM:temp.bmp"
+		if ( ginfo(13) > 50 ) {
+			chipc(CHIPC_X, 33 * 34 + tg) = tg \ 33 * inf_tiles, 34 * inf_tiles + tg / 33 * inf_tiles * 2, inf_tiles, inf_tiles * 2, inf_tiles + 8
+		}
+		else {
+			chipc(CHIPC_X, 33 * 34 + tg) = tg \ 33 * inf_tiles, 34 * inf_tiles + tg / 33 * inf_tiles * 2, inf_tiles, inf_tiles, 16
+		}
+		gsel BUFFER_CHR
+		pos tg \ 33 * 48, 34 * 48 + tg / 33 * 96
+		gcopy BUFFER_PIC2, 0, 0, 48, 96
+		tg++
+	loop
+	procid = (procid + 1) \ 4
+	proclist(procid) = "userNpc_update:3" + " ct:" + ct
+	gosub *del_userTemp
+	gosub *del_userNpc
+	procid = (procid + 1) \ 4
+	proclist(procid) = "userNpc_update:Replace bmp" + " ct:" + ct
+	gsel BUFFER_CHR
+	folder = exedir + "user\\graphic\\"
+	dirlist buff, folder + "chara_*.bmp"
+	notesel buff
+	repeat stat
+		noteget file, cnt
+		p = int(strmid(file, 6, instr(file, 6, ".")))
+		pos p \ 33 * inf_tiles, p / 33 * inf_tiles
+		picload folder + file, 1
+	loop
+	gsel BUFFER_SCREEN
+	gsel BUFFER_CHR
+	folder = exedir + "user\\graphic\\"
+	dirlist buff, folder + "Pic_*.bmp"
+	notesel buff
+	repeat stat
+		noteget file, cnt
+		p = int(strmid(file, 4, instr(file, 4, "."))) + 692
+		pos p \ 33 * inf_tiles, p / 33 * inf_tiles
+		picload folder + file, 1
+	loop
+	gsel BUFFER_SCREEN
+	gsel BUFFER_ITEM
+	folder = exedir + "user\\item\\"
+	dirlist buff, folder + "plan*.bmp"
+	notesel buff
+	repeat stat
+		noteget file, cnt
+		p = int(strmid(file, 4, instr(file, 4, "."))) + 890
+		pos p \ 33 * inf_tiles, p / 33 * inf_tiles
+		picload folder + file, 1
+	loop
+	gsel BUFFER_SCREEN
+	gsel BUFFER_ITEM
+	folder = exedir + "user\\graphic\\"
+	dirlist buff, folder + "item_*.bmp"
+	notesel buff
+	repeat stat
+		noteget file, cnt
+		p = int(strmid(file, 5, instr(file, 5, ".")))
+		pos p \ 33 * inf_tiles, p / 33 * inf_tiles
+		picload folder + file, 1
+	loop
+	gsel BUFFER_SCREEN
+	return
+	inv_getheader rc
+	repeat invrange, invhead
+		inv(INV_ITEM_EQUIP, cnt) = 0
+	loop
+	repeat 30, 100
+		cdata(cnt, rc) = cdata(cnt, rc) / EXT_EQUIP_SLOTS * 10000
+	loop
+	gosub *label_8919
+	cdata(CDATA_AI_ITEM, rc) = 0
+	rowactend rc
+	cbitmod CHARA_BIT_PCC, rc, FALSE
+	cbitmod CHARA_BIT_LEASHED, rc, FALSE
+	cdata(CDATA_HP, rc) = cdata(CDATA_MAX_HP, rc)
+	cdata(CDATA_MP, rc) = cdata(CDATA_MAX_MP, rc)
+	cbitmod CHARA_BIT_LIVESTOCK, rc, FALSE
+	return
+
+*user_npc
+	fread = 0
+	cun = usernpcmax
+	if ( dbg_usernpc ) {
+	}
+	else {
+		txt lang("どのファイルからNPCを作成する？", "Choose the original file.")
+		redraw 1
+		fileext = "txt"
+		filedsc = "Custom Npc Text"
+		_fdialog fileext, 16, filedsc, exedir + "user", ""
+		if ( stat == 0 ) {
+			return
+		}
+		txtfile = refstr
+	}
+	exist txtfile
+	userdata(1, cun) = strsize
+	sdim txtbuff, strsize
+	bload txtfile, txtbuff
+	if ( instr(txtbuff, 0, "%Elona Custom Npc") == (-1) ) {
+		txt "Invalid File. Aborting."
+		return
+	}
+	if ( dbg_usernpc ) {
+	}
+	else {
+		txt lang("どの画像を埋め込む？", "Choose the graphic file.")
+		redraw 1
+		fileext = "bmp"
+		filedsc = "Bit Map File"
+		_fdialog fileext, 16, filedsc, exedir + "user", ""
+		if ( stat == 0 ) {
+			return
+		}
+		bmpfile = refstr
+	}
+	exist bmpfile
+	if ( strsize > 30000 ) {
+		txt "The file size must be lower than 30KB. Aborting."
+		return
+	}
+	userdata(0, cun) = strsize
+	dim bmpbuff, strsize
+	bload bmpfile, bmpbuff
+	if ( fread == 0 ) {
+		zOpen hgz, exedir + "user\\npc1.t", 1, 3
+		zWrite userdata(0, cun), hgz, 70 * 4
+		zClose hgz
+	}
+	else {
+		zOpen hgz, exedir + "user\\npc1.t", 0
+		zRead userdata(0, cun), hgz, 70 * 4
+		zClose hgz
+	}
+	if ( fread == 0 ) {
+		zOpen hgz, exedir + "user\\npc2.t", 1, 3
+		zWrite bmpbuff, hgz, userdata(0, cun)
+		zClose hgz
+	}
+	else {
+		zOpen hgz, exedir + "user\\npc2.t", 0
+		zRead bmpbuff, hgz, userdata(0, cun)
+		zClose hgz
+	}
+	if ( fread == 0 ) {
+		zOpen hgz, exedir + "user\\npc3.t", 1, 3
+		zWrite txtbuff, hgz, userdata(1, cun)
+		zClose hgz
+	}
+	else {
+		zOpen hgz, exedir + "user\\npc3.t", 0
+		zRead txtbuff, hgz, userdata(1, cun)
+		zClose hgz
+	}
+	s = getnpctxt("name.", "unknown,unknown")
+	csvstr2 s, s
+	cnv_filestr s
+	if ( instr(s, 0, "_tmp_") != (-1) ) {
+		dialog "The name contains an invalid word \"_tmp_\""
+		return
+	}
+	if ( peek(s) >= 65 & peek(s) <= 90 | (peek(s) >= 97 & peek(s) <= 122) ) {
+	}
+	else {
+		dialog "The first letter of the name must be alphabetic."
+		return
+	}
+	if ( strlen(s) >= 32 | strlen(s(1)) >= 32 ) {
+		dialog "The name is too long."
+		return
+	}
+	zipinit2 exedir + "user\\", s + ".npc"
+	zipadd2 "npc1.t"
+	zipadd2 "npc2.t"
+	zipadd2 "npc3.t"
+	zipend2
+	q = s
+	gosub *userNpc_update
+	initunid = findunid(q)
+	txt lang("カスタムNPCを作成した！", "A custom NPC has been successfully generated!")
+	if ( cdata(CDATA_X, CHARA_PLAYER) > 1 ) {
+		sux = cdata(CDATA_X, CHARA_PLAYER) - 1
+	}
+	flt
+	characreate -1, CREATURE_ID_USER, sux, cdata(CDATA_Y, CHARA_PLAYER)
+	repeat 245
+		if ( cdata(CDATA_ID, cnt) == CREATURE_ID_USER ) {
+			getunid cnt
+		}
+	loop
+	if ( dbg_usernpc ) {
+		cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
+	}
+	else {
+		cdata(CDATA_RELATION, rc) = RELATION_ENEMY
+		txt lang(name(rc) + "は興奮して襲い掛かってきた。", name(rc) + " is excited and attacks you.")
+	}
+	folder = exedir + "user\\"
+	gosub *del_userTemp
+	return
+
+*game_ctrlFile
+	notesel filemod
+	if ( timeGetTime() / 1000 - time_begin < 0 ) {
+		time_begin = timeGetTime() / 1000
+	}
+	gdata(GDATA_PLAY_TIME) = gdata(GDATA_PLAY_TIME) + timeGetTime() / 1000 - time_begin
+	time_begin = timeGetTime() / 1000
+	if ( fmode == 8 | fmode == 7 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile:game" + fread + " ct:" + ct
+		folder = exedir + "save\\" + playerid + "\\"
+		if ( fmode == 8 ) {
+			fread = 0
+		}
+		if ( fmode == 7 ) {
+			fread = 1
+		}
+		if ( fmode == 8 ) {
+			playerheader = "" + cdatan(CDATAN_NAME, CHARA_PLAYER) + " Lv:" + cdata(CDATA_LEVEL, CHARA_PLAYER) + " " + mdatan(0)
+			bsave folder + "header.txt", playerheader
+		}
+		repeat 16
+			procid = (procid + 1) \ 4
+			proclist(procid) = "ctrlFile:game" + fread + ":" + cnt + " ct:" + ct
+			file = folder
+			if ( cnt == 0 ) {
+				file += "gdata.s1"
+				fsize = 1000 * 4
+			}
+			if ( cnt == 1 ) {
+				file += "cdata.s1"
+				fsize = 114000
+			}
+			if ( cnt == 2 ) {
+				file += "sdata.s1"
+				fsize = 273600
+			}
+			if ( cnt == 3 ) {
+				file += "spell.s1"
+				fsize = 800
+			}
+			if ( cnt == 4 ) {
+				file += "inv.s1"
+				fsize = 369600
+			}
+			if ( cnt == 5 ) {
+				file += "kitem.s1"
+				fsize = 17988
+			}
+			if ( cnt == 6 ) {
+				file += "knpc.s1"
+				fsize = 11992
+			}
+			if ( cnt == 7 ) {
+				file += "adata.s1"
+				fsize = 80000
+			}
+			if ( cnt == 8 ) {
+				file += "spact.s1"
+				fsize = 2000
+			}
+			if ( cnt == 9 ) {
+				file += "qdata.s1"
+				fsize = 40000
+			}
+			if ( cnt == 10 ) {
+				file += "mat.s1"
+				fsize = 1600
+			}
+			if ( cnt == 11 ) {
+				file += "trait.s1"
+				fsize = 2000
+			}
+			if ( cnt == 12 ) {
+				file += "pcc.s1"
+				fsize = 2400
+			}
+			if ( cnt == 13 ) {
+				file += "card.s1"
+				fsize = 24000
+			}
+			if ( cnt == 14 ) {
+				file += "krecipe.s1"
+				fsize = 7596
+			}
+			if ( cnt == 15 ) {
+				file += "spells.s1"
+				fsize = 800
+			}
+			if ( cnt != 14 | gdata(GDATA_VERSION) >= 1200 ) {
+				if ( fread == 1 ) {
+					exist file
+					if ( strsize == (-1) ) {
+						if ( cnt != 15 ) {
+							dialog lang("セーブファイル：" + file + "が存在しません。ファイル移植ミスの可能性があるので該当フォルダ内を確認してください。", "Save file: " + file + " does not exist. Please check the appropriate folder.")
+							goto *exit_game
+						}
+					}
+				}
+			}
+			else {
+				if ( fread == 1 ) {
+					exist file
+					if ( strsize == (-1) ) {
+						continue
+					}
+				}
+			}
+			if ( fread == 0 ) {
+				zOpen hgz, file, 1, 3
+			}
+			if ( cnt != 14 | gdata(GDATA_VERSION) >= 1200 ) {
+				if ( fread == 1 ) {
+					zOpen hgz, file, 0
+					if ( stat != 0 ) {
+						if ( cnt != 15 ) {
+							dialog lang("セーブファイル：" + file + "が読み込めませんでした。該当のファイルが破損している可能性があります。", "Save file: " + file + " could not be read. There is a possibility that the file in question is corrupted.")
+							goto *exit_game
+						}
+					}
+				}
+			}
+			else {
+				if ( fread == 1 ) {
+					zOpen hgz, file, 0
+				}
+			}
+			if ( cnt == 0 ) {
+				if ( fread == 0 ) {
+					zWrite gdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead gdata, hgz, fsize
+				}
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 0 ) {
+					zWrite cdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead cdata, hgz, fsize
+				}
+			}
+			if ( cnt == 2 ) {
+				if ( fread == 0 ) {
+					zWrite sdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead sdata, hgz, fsize
+				}
+			}
+			if ( cnt == 3 ) {
+				if ( fread == 0 ) {
+					zWrite spell, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead spell, hgz, fsize
+				}
+			}
+			if ( cnt == 4 ) {
+				if ( fread == 0 ) {
+					zWrite inv, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead inv, hgz, fsize
+				}
+			}
+			if ( cnt == 5 ) {
+				if ( fread == 0 ) {
+					zWrite itemmemory, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead itemmemory, hgz, fsize
+				}
+			}
+			if ( cnt == 6 ) {
+				if ( fread == 0 ) {
+					zWrite npcmemory, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead npcmemory, hgz, fsize
+				}
+			}
+			if ( cnt == 7 ) {
+				if ( fread == 0 ) {
+					zWrite adata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead adata, hgz, fsize
+				}
+			}
+			if ( cnt == 8 ) {
+				if ( fread == 0 ) {
+					zWrite spact, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead spact, hgz, fsize
+				}
+			}
+			if ( cnt == 9 ) {
+				if ( fread == 0 ) {
+					zWrite qdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead qdata, hgz, fsize
+				}
+			}
+			if ( cnt == 10 ) {
+				if ( fread == 0 ) {
+					zWrite mat, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead mat, hgz, fsize
+				}
+			}
+			if ( cnt == 11 ) {
+				if ( fread == 0 ) {
+					zWrite trait, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead trait, hgz, fsize
+				}
+			}
+			if ( cnt == 12 ) {
+				if ( fread == 0 ) {
+					zWrite pcc, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead pcc, hgz, fsize
+				}
+			}
+			if ( cnt == 13 ) {
+				if ( fread == 0 ) {
+					zWrite card, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead card, hgz, fsize
+				}
+			}
+			if ( cnt == 14 ) {
+				if ( fread == 0 ) {
+					zWrite recipememory, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					if ( gdata(GDATA_VERSION) >= 1200 ) {
+						zRead recipememory, hgz, fsize
+					}
+				}
+			}
+			if ( cnt == 15 ) {
+				if ( fread == 0 ) {
+					zWrite spells, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead spells, hgz, fsize
+				}
+			}
+			zClose hgz
+		loop
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile:game" + fread + ":logs" + " ct:" + ct
+		file = folder + "art.log"
+		notesel artifactlocation
+		if ( fread == 0 ) {
+			notesave file
+		}
+		if ( fread == 1 ) {
+			noteload file
+		}
+		file = folder + "news.log"
+		notesel newsbuff
+		if ( fread == 0 ) {
+			notesave file
+		}
+		if ( fread == 1 ) {
+			noteload file
+		}
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile:game" + fread + ":array" + " ct:" + ct
+		file = folder + "cdatan.s1"
+		fmode = "cdatan1"
+		arrayfile
+		file = folder + "qname.s1"
+		fmode = "qname"
+		arrayfile
+		file = folder + "gdatan.s1"
+		fmode = "gdatan"
+		arrayfile
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile:game" + fread + ":evs" + " ct:" + ct
+		if ( fread == 0 ) {
+			bsave folder + "evnum.s1", evnum
+			bsave folder + "evdata1.s1", evdata1
+			bsave folder + "evdata2.s1", evdata2
+			bsave folder + "evlist.s1", evlist
+		}
+		else {
+			exist folder + "evnum.s1"
+			if ( strsize != (-1) ) {
+				bload folder + "evnum.s1", evnum
+			}
+			exist folder + "evdata1.s1"
+			if ( strsize != (-1) ) {
+				bload folder + "evdata1.s1", evdata1
+			}
+			exist folder + "evdata2.s1"
+			if ( strsize != (-1) ) {
+				bload folder + "evdata2.s1", evdata2
+			}
+			exist folder + "evlist.s1"
+			if ( strsize != (-1) ) {
+				bload folder + "evlist.s1", evlist
+			}
+		}
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile:game" + fread + ":end" + " ct:" + ct
+	}
+	if ( fmode == 14 | fmode == 15 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		if ( fmode == 14 ) {
+			fread = 0
+			folder = exedir + "tmp\\"
+		}
+		if ( fmode == 15 ) {
+			fread = 1
+			folder = exedir + "save\\" + geneuse + "\\"
+		}
+		if ( fmode == 14 ) {
+			playerheader = "" + cdatan(CDATAN_NAME, CHARA_PLAYER) + "(Lv" + cdata(CDATA_LEVEL, CHARA_PLAYER) + ")の遺伝子"
+			file = folder + "gene_header.txt"
+			bsave file, playerheader
+			fileadd file
+		}
+		repeat 9
+			file = folder
+			if ( cnt == 0 ) {
+				file += "gene.s1"
+				fsize = 100 * 4
+			}
+			if ( cnt == 1 ) {
+				file += "g_cdata.s1"
+				fsize = 114000
+			}
+			if ( cnt == 2 ) {
+				file += "g_sdata.s1"
+				fsize = 273600
+			}
+			if ( cnt == 3 ) {
+				file += "g_spell.s1"
+				fsize = 800
+			}
+			if ( cnt == 4 ) {
+				file += "g_inv.s1"
+				fsize = 369600
+			}
+			if ( cnt == 5 ) {
+				file += "g_spact.s1"
+				fsize = 2000
+			}
+			if ( cnt == 6 ) {
+				file += "g_mat.s1"
+				fsize = 1600
+			}
+			if ( cnt == 7 ) {
+				file += "g_card.s1"
+				fsize = 24000
+			}
+			if ( cnt == 8 ) {
+				file += "g_genetemp.s1"
+				fsize = 4000
+			}
+			if ( fread == 1 ) {
+				exist file
+				if ( strsize == (-1) ) {
+					continue
+				}
+			}
+			if ( fread == 0 ) {
+				zOpen hgz, file, 1, 3
+				fileadd "" + file
+			}
+			if ( fread == 1 ) {
+				zOpen hgz, file, 0
+			}
+			if ( cnt == 0 ) {
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 0 ) {
+					zWrite cdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead cdata, hgz, fsize
+				}
+			}
+			if ( cnt == 2 ) {
+				if ( fread == 0 ) {
+					zWrite sdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead sdata, hgz, fsize
+				}
+			}
+			if ( cnt == 3 ) {
+				if ( fread == 0 ) {
+					zWrite spell, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead spell, hgz, fsize
+				}
+			}
+			if ( cnt == 4 ) {
+				if ( fread == 0 ) {
+					zWrite inv, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead inv, hgz, fsize
+				}
+			}
+			if ( cnt == 5 ) {
+				if ( fread == 0 ) {
+					zWrite spact, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead spact, hgz, fsize
+				}
+			}
+			if ( cnt == 6 ) {
+				if ( fread == 0 ) {
+					zWrite mat, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead mat, hgz, fsize
+				}
+			}
+			if ( cnt == 7 ) {
+				if ( fread == 0 ) {
+					zWrite card, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead card, hgz, fsize
+				}
+			}
+			if ( cnt == 8 ) {
+				if ( fread == 0 ) {
+					zWrite gdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead genetemp, hgz, fsize
+				}
+			}
+			zClose hgz
+		loop
+	}
+	if ( fmode == 2 | fmode == 1 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		folder = exedir + "tmp\\"
+		if ( fmode == 2 ) {
+			fread = 0
+		}
+		if ( fmode == 1 ) {
+			fread = 1
+		}
+		repeat 5
+			file = folder
+			if ( cnt == 0 ) {
+				file += "mdata_" + mid + ".s2"
+				fsize = 400
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 1 ) {
+					dim map, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT), 10
+					dim mapsync, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT)
+					dim mef, 9, 200
+				}
+				file += "map_" + mid + ".s2"
+				fsize = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) * 10 * 4
+			}
+			if ( cnt == 2 ) {
+				file += "cdata_" + mid + ".s2"
+				fsize = 376000
+			}
+			if ( cnt == 3 ) {
+				file += "sdata_" + mid + ".s2"
+				fsize = 902400
+			}
+			if ( cnt == 4 ) {
+				if ( fread ) {
+					if ( mdata(MDATA_VERSION_FIX1) == 0 ) {
+						repeat mdata(MDATA_HEIGHT)
+							cnt2 = cnt
+							repeat mdata(MDATA_WIDTH)
+								map(cnt, cnt2, MAP_MEF_INDEX_PLUS_ONE) = 0
+							loop
+						loop
+						mdata(MDATA_VERSION_FIX1) = 1
+						continue
+					}
+				}
+				file += "mef_" + mid + ".s2"
+				fsize = 7200
+			}
+			if ( fread == 0 ) {
+				zOpen hgz, file, 1, 3
+				fileadd "" + file
+			}
+			if ( fread == 1 ) {
+				zopenwrapper hgz, file, 0
+			}
+			if ( cnt == 0 ) {
+				if ( fread == 0 ) {
+					zWrite mdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead mdata, hgz, fsize
+				}
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 0 ) {
+					zWrite map, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead map, hgz, fsize
+				}
+			}
+			if ( cnt == 2 ) {
+				if ( fread == 0 ) {
+					zWrite cdata(CDATA_EXIST, MAX_CHARA_SAVE), hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead cdata(CDATA_EXIST, MAX_CHARA_SAVE), hgz, fsize
+				}
+			}
+			if ( cnt == 3 ) {
+				if ( fread == 0 ) {
+					zWrite sdata(SKILL_NONE, MAX_CHARA_SAVE), hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead sdata(SKILL_NONE, MAX_CHARA_SAVE), hgz, fsize
+				}
+			}
+			if ( cnt == 4 ) {
+				if ( fread == 0 ) {
+					zWrite mef, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead mef, hgz, fsize
+				}
+			}
+			zClose hgz
+		loop
+		file = folder + "cdatan_" + mid + ".s2"
+		fmode = "cdatan2"
+		arrayfilewrapper
+		file = folder + "mdatan_" + mid + ".s2"
+		fmode = "mdatan"
+		arrayfilewrapper
+	}
+	if ( fmode == 20 | fmode == 19 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		folder = exedir + "user\\"
+		if ( fmode == 20 ) {
+			fread = 0
+		}
+		if ( fmode == 19 ) {
+			fread = 1
+		}
+		repeat 3
+			file = folder
+			if ( cnt == 0 ) {
+				file += "m1_" + id + ".t"
+				fsize = 400
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 1 ) {
+					dim map, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT), 10
+					dim mapsync, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT)
+					dim mef, 9, 200
+				}
+				file += "m2_" + id + ".t"
+				fsize = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) * 10 * 4
+			}
+			if ( cnt == 2 ) {
+				file += "m3_" + id + ".t"
+				fsize = 1164800
+			}
+			if ( fread == 0 ) {
+				zOpen hgz, file, 1, 3
+			}
+			if ( fread == 1 ) {
+				zOpen hgz, file, 0
+			}
+			if ( cnt == 0 ) {
+				if ( fread == 0 ) {
+					zWrite mdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead mdata, hgz, fsize
+				}
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 0 ) {
+					zWrite map, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead map, hgz, fsize
+				}
+			}
+			if ( cnt == 2 ) {
+				if ( fread == 0 ) {
+					zWrite inv(INV_ITEM_NUM, 1320), hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead inv(INV_ITEM_NUM, 1320), hgz, fsize
+				}
+			}
+			zClose hgz
+		loop
+		file = folder + "m4_" + id + ".t"
+		fmode = "mdatan"
+		export = 1
+		arrayfile
+		if ( fread == 0 ) {
+			zipadd "m1_" + id + ".t"
+			zipadd "m2_" + id + ".t"
+			zipadd "m3_" + id + ".t"
+			zipadd "m4_" + id + ".t"
+		}
+	}
+	if ( fmode == 22 | fmode == 21 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		folder = exedir + "user\\"
+		if ( fmode == 22 ) {
+			fread = 0
+			tg = 1
+		}
+		if ( fmode == 21 ) {
+			fread = 1
+			tg = 0
+		}
+		enemyteam = -1
+		gdata(GDATA_USERNPC_COUNT) = 0
+		sdim untaglist
+		repeat 245
+			if ( fread == 0 ) {
+				if ( list(0, cnt) == 0 ) {
+					continue
+				}
+				tg = cnt
+			}
+			else {
+				exist folder + "c1_" + id + ".t"
+				if ( strsize == (-1) ) {
+					break
+				}
+				tg = 0
+				repeat 245 - 57, 57
+					if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_DEAD ) {
+						tg = cnt
+						break
+					}
+				loop
+				if ( tg == 0 ) {
+					break
+				}
+			}
+			repeat 3
+				file = folder
+				if ( cnt == 0 ) {
+					file += "c1_" + id + ".t"
+					fsize = 2000
+				}
+				if ( cnt == 1 ) {
+					file += "c2_" + id + ".t"
+					fsize = 4800
+				}
+				if ( cnt == 2 ) {
+					file += "c3_" + id + ".t"
+					inv_getheader tg
+					fsize = 70 * 4 * invrange
+				}
+				if ( fread == 0 ) {
+					zOpen hgz, file, 1, 3
+				}
+				if ( fread == 1 ) {
+					zOpen hgz, file, 0
+				}
+				if ( cnt == 0 ) {
+					if ( fread == 0 ) {
+						zWrite cdata(CDATA_EXIST, tg), hgz, fsize
+					}
+					if ( fread == 1 ) {
+						zRead cdata(CDATA_EXIST, tg), hgz, fsize
+					}
+				}
+				if ( cnt == 1 ) {
+					if ( fread == 0 ) {
+						zWrite sdata(SKILL_NONE, tg), hgz, fsize
+					}
+					if ( fread == 1 ) {
+						zRead sdata(SKILL_NONE, tg), hgz, fsize
+					}
+				}
+				if ( cnt == 2 ) {
+					if ( fread == 0 ) {
+						zWrite inv(INV_ITEM_NUM, invhead), hgz, fsize
+					}
+					if ( fread == 1 ) {
+						zRead inv(INV_ITEM_NUM, invhead), hgz, fsize
+					}
+				}
+				zClose hgz
+			loop
+			file = folder + "c4_" + id + ".t"
+			fmode = "cdatan3"
+			export = 1
+			arrayfile
+			if ( fread == 0 ) {
+				zipadd "c1_" + id + ".t"
+				zipadd "c2_" + id + ".t"
+				zipadd "c3_" + id + ".t"
+				zipadd "c4_" + id + ".t"
+				if ( cdata(CDATA_ID, tg) == CREATURE_ID_USER ) {
+					exist folder + userdatan(6, cdata(CDATA_USERNPC_ID, tg))
+					if ( strsize != (-1) ) {
+						if ( cdata(CDATA_USERNPC_ID, tg) != usernpcmax ) {
+							if ( instr(untaglist, 0, "/" + userdatan(0, cdata(CDATA_USERNPC_ID, tg)) + "/") == (-1) ) {
+								if ( gdata(GDATA_USERNPC_COUNT) < 10 ) {
+									bcopy folder + userdatan(6, cdata(CDATA_USERNPC_ID, tg)), folder + "_tmp_" + gdata(GDATA_USERNPC_COUNT) + ".npc"
+									zipadd "_tmp_" + gdata(GDATA_USERNPC_COUNT) + ".npc"
+									untaglist += "/" + userdatan(0, cdata(CDATA_USERNPC_ID, tg)) + "/"
+									gdata(GDATA_USERNPC_COUNT)++
+								}
+							}
+						}
+					}
+				}
+			}
+			else {
+				inv_getheader tg
+				repeat invrange, invhead
+					inv(INV_ITEM_EQUIP, cnt) = 0
+				loop
+				repeat 30, 100
+					cdata(cnt, tg) = cdata(cnt, tg) / EXT_EQUIP_SLOTS * 10000
+				loop
+				rc = tg
+				gosub *label_8919
+				cdata(CDATA_AI_ITEM, rc) = 0
+				rowactend rc
+				cbitmod CHARA_BIT_PCC, rc, FALSE
+				cbitmod CHARA_BIT_LEASHED, rc, FALSE
+				cdata(CDATA_HP, rc) = cdata(CDATA_MAX_HP, rc)
+				cdata(CDATA_MP, rc) = cdata(CDATA_MAX_MP, rc)
+				cbitmod CHARA_BIT_LIVESTOCK, rc, FALSE
+				cbitmod CHARA_BIT_MSG_FILE, rc, FALSE
+				if ( importmode == 0 ) {
+					cdata(CDATA_ROLE, tg) = ROLE_USER
+					cdata(CDATA_GOLD, tg) = 0
+					if ( cdata(CDATA_RELATION, tg) >= RELATION_ALLY ) {
+						if ( userrelation == 0 ) {
+							cdata(CDATA_RELATION, tg) = RELATION_NEUTRAL
+							cdata(CDATA_RELATION_ORG, tg) = RELATION_NEUTRAL
+						}
+						else {
+							cdata(CDATA_RELATION, tg) = RELATION_ENEMY
+							cdata(CDATA_RELATION_ORG, tg) = RELATION_ENEMY
+						}
+					}
+					cxinit = cdata(CDATA_X, tg)
+					cyinit = cdata(CDATA_Y, tg)
+					gosub *label_4125
+				}
+				if ( importmode == 1 ) {
+					if ( enemyteam == (-1) ) {
+						enemyteam = rc
+					}
+					cdata(CDATA_RELATION, rc) = RELATION_ENEMY
+					cdata(CDATA_RELATION_ORG, rc) = RELATION_ENEMY
+					map_placearena rc, 1
+				}
+			}
+			id++
+		loop
+	}
+	if ( fmode == 16 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		dim cmapdata, 5, 400
+		repeat 2
+			if ( cnt == 0 ) {
+				file = fmapfile + ".map"
+				fsize = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) * 3 * 4
+			}
+			if ( cnt == 1 ) {
+				file = fmapfile + ".obj"
+				fsize = 8000
+			}
+			if ( cnt == 1 ) {
+				exist file
+				if ( strsize == (-1) ) {
+					continue
+				}
+			}
+			zOpen hgz, file, 0
+			if ( cnt == 0 ) {
+				zRead map, hgz, fsize
+			}
+			if ( cnt == 1 ) {
+				zRead cmapdata, hgz, fsize
+			}
+			zClose hgz
+		loop
+	}
+	if ( fmode == 6 | fmode == 5 ) {
+		if ( fmode == 6 ) {
+			fread = 0
+		}
+		if ( fmode == 5 ) {
+			fread = 1
+			dim cmapdata, 5, 400
+		}
+		repeat 3
+			if ( cnt == 0 ) {
+				file = fmapfile + ".idx"
+				fsize = 400
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 1 ) {
+					dim map, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT), 10
+					dim mapsync, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT)
+					dim mef, 9, 200
+				}
+				file = fmapfile + ".map"
+				fsize = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) * 10 * 4
+			}
+			if ( cnt == 2 ) {
+				file = fmapfile + ".obj"
+				fsize = 8000
+			}
+			if ( cnt == 2 & fread == 1 ) {
+				exist file
+				if ( strsize == (-1) ) {
+					continue
+				}
+			}
+			if ( fread == 0 ) {
+				zOpen hgz, file, 1, 3
+			}
+			if ( fread == 1 ) {
+				zOpen hgz, file, 0
+			}
+			if ( cnt == 0 ) {
+				if ( fread == 0 ) {
+					zWrite mdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead mdatatmp, hgz, fsize
+					repeat 5
+						mdata(cnt) = mdatatmp(cnt)
+					loop
+				}
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 0 ) {
+					zWrite map, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead map, hgz, fsize
+				}
+			}
+			if ( cnt == 2 ) {
+				if ( fread == 0 ) {
+					zWrite cmapdata, hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead cmapdata, hgz, fsize
+				}
+			}
+			zClose hgz
+		loop
+	}
+	if ( fmode == 4 | fmode == 3 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		folder = exedir + "tmp\\"
+		if ( fmode == 4 ) {
+			fread = 0
+		}
+		if ( fmode == 3 ) {
+			fread = 1
+		}
+		file = folder + file
+		fsize = 1164800
+		if ( fread == 0 ) {
+			zOpen hgz, file, 1, 3
+			fileadd file
+		}
+		if ( fread == 1 ) {
+			zopenwrapper hgz, file, 0
+		}
+		if ( fread == 0 ) {
+			zWrite inv(INV_ITEM_NUM, 1320), hgz, fsize
+		}
+		if ( fread == 1 ) {
+			zRead inv(INV_ITEM_NUM, 1320), hgz, fsize
+		}
+		zClose hgz
+	}
+	if ( fmode == 23 | fmode == 24 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		if ( fmode == 23 ) {
+			fread = 0
+		}
+		if ( fmode == 24 ) {
+			fread = 1
+		}
+		fsize = 6000
+		if ( fread == 0 ) {
+			zOpen hgz, file, 1, 3
+			fileadd "" + file
+		}
+		if ( fread == 1 ) {
+			zOpen hgz, file, 0
+		}
+		if ( fread == 0 ) {
+			zWrite deck, hgz, fsize
+		}
+		if ( fread == 1 ) {
+			zRead deck, hgz, fsize
+		}
+		zClose hgz
+	}
+	if ( fmode == 18 | fmode == 17 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		folder = exedir + "tmp\\"
+		if ( fmode == 18 ) {
+			fread = 0
+		}
+		if ( fmode == 17 ) {
+			fread = 1
+		}
+		existwrapper folder + "cdata_" + mid + ".s2"
+		if ( strsize == (-1) ) {
+			return
+		}
+		repeat 5
+			file = folder
+			if ( cnt == 0 ) {
+				file += "cdata_" + mid + ".s2"
+				fsize = 376000
+			}
+			if ( cnt == 1 ) {
+				file += "sdata_" + mid + ".s2"
+				fsize = 902400
+			}
+			if ( fread == 0 ) {
+				zOpen hgz, file, 1, 3
+				fileadd "" + file
+			}
+			if ( fread == 1 ) {
+				zopenwrapper hgz, file, 0
+			}
+			if ( cnt == 0 ) {
+				if ( fread == 0 ) {
+					zWrite cdata(CDATA_EXIST, MAX_CHARA_SAVE), hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead cdata(CDATA_EXIST, MAX_CHARA_SAVE), hgz, fsize
+				}
+			}
+			if ( cnt == 1 ) {
+				if ( fread == 0 ) {
+					zWrite sdata(SKILL_NONE, MAX_CHARA_SAVE), hgz, fsize
+				}
+				if ( fread == 1 ) {
+					zRead sdata(SKILL_NONE, MAX_CHARA_SAVE), hgz, fsize
+				}
+			}
+			zClose hgz
+		loop
+		file = folder + "cdatan_" + mid + ".s2"
+		fmode = "cdatan2"
+		arrayfilewrapper
+	}
+	if ( fmode == 10 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		dirlist buff, exedir + "tmp\\*.*"
+		if ( stat == 0 ) {
+			return stat
+		}
+		notesel buff
+		repeat stat
+			noteget file, cnt
+			file = exedir + "tmp\\" + file
+			exist file
+			if ( strsize != (-1) ) {
+				delete file
+			}
+		loop
+	}
+	if ( fmode == 9 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		folder = exedir + "save\\" + playerid
+		dirlist buff, folder + "\\*.*"
+		if ( stat != 0 ) {
+			notesel buff
+			repeat stat
+				noteget file, cnt
+				delete folder + "\\" + file
+			loop
+		}
+		RemoveDirectoryA folder
+	}
+	if ( fmode == 11 | fmode == 12 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		if ( fmode == 12 ) {
+			existwrapper exedir + "tmp\\mdata_" + mid + ".s2"
+			if ( strsize == (-1) ) {
+				return
+			}
+		}
+		file = exedir + "tmp\\map_" + mid + ".s2"
+		existwrapper file
+		if ( strsize == (-1) ) {
+			return
+		}
+		deletewrapper file
+		fileadd file, 1
+		if ( fmode == 11 ) {
+			file = exedir + "tmp\\cdata_" + mid + ".s2"
+			deletewrapper file
+			fileadd file, 1
+			file = exedir + "tmp\\sdata_" + mid + ".s2"
+			deletewrapper file
+			fileadd file, 1
+			file = exedir + "tmp\\cdatan_" + mid + ".s2"
+			deletewrapper file
+			fileadd file, 1
+			file = exedir + "tmp\\inv_" + mid + ".s2"
+			deletewrapper file
+			fileadd file, 1
+		}
+		file = exedir + "tmp\\mdata_" + mid + ".s2"
+		deletewrapper file
+		fileadd file, 1
+		file = exedir + "tmp\\mdatan_" + mid + ".s2"
+		deletewrapper file
+		fileadd file, 1
+		file = exedir + "tmp\\mef_" + mid + ".s2"
+		deletewrapper file
+		fileadd file, 1
+	}
+	if ( fmode == 25 ) {
+	}
+	if ( fmode == 13 ) {
+		procid = (procid + 1) \ 4
+		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
+		repeat 40
+			adata(cnt, area) = 0
+		loop
+		fmode13replacer area
+	}
+	procid = (procid + 1) \ 4
+	proclist(procid) = "ctrlFile" + fmode + "/end" + " ct:" + ct
+	return
+
+*export_map
+	sdim headtemp, 1024
+	id = 0
+	lensum = 1024
+	sdim filebuff, lensum
+	if ( usertitle != "" ) {
+		headtemp = "[＋製]【" + usertitle + "】\n"
+	}
+	else {
+		headtemp = "[＋製]【" + mdatan(0) + "】\n"
+	}
+	headtemp += "" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "\n"
+	headtemp += "\n"
+	headtemp += "\n"
+	headtemp += "" + 100002 + "\n"
+	headtemp += "[＋製]" + usermsg + "\n"
+	headtemp += "" + userrelation + "\n"
+	memcpy filebuff, headtemp, 1024, 0
+	fmode = 20
+	gosub *game_ctrlFile
+	repeat 245
+		list(0, cnt) = 0
+		if ( cnt != 0 ) {
+			if ( cdata(CDATA_IN_TAGTEAM, cnt) != 1 ) {
+				if ( cdata(CDATA_ROLE, cnt) != ROLE_ADVENTURER ) {
+					if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
+						if ( cbit(CHARA_BIT_RIDE, cnt) == FALSE ) {
+							list(0, cnt) = 1
+						}
+					}
+				}
+			}
+		}
+	loop
+	fmode = 22
+	gosub *game_ctrlFile
+	bsave userfile, filebuff
+	gosub *del_userTemp
+	return
+
+*label_5880
+	sdim headtemp, 1024
+	id = 0
+	lensum = 1024
+	sdim filebuff, lensum
+	headtemp = "【" + gdatan(GDATAN_TEAM1) + "】(" + n + "体) Lv" + lv + "\n"
+	headtemp += "" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "\n"
+	headtemp += "\n"
+	headtemp += "\n"
+	headtemp += "" + 100002 + "\n"
+	headtemp += "" + n + "\n"
+	headtemp += "" + lv + "\n"
+	memcpy filebuff, headtemp, 1024, 0
+	fmode = 22
+	gosub *game_ctrlFile
+	bsave userfile, filebuff
+	gosub *del_userTemp
+	return
+
+*del_userNpc
+	procid = (procid + 1) \ 4
+	proclist(procid) = "del_userNpc" + " ct:" + ct
+	dirlist buff, exedir + "user\\_tmp_*.npc"
+	notesel buff
+	repeat stat
+		noteget file, cnt
+		delete exedir + "user\\" + file
+	loop
+	dirlist buff, exedir + "user\\!tmp*.npc"
+	notesel buff
+	repeat stat
+		noteget file, cnt
+		delete exedir + "user\\" + file
+	loop
+	return
+
+*del_userTemp
+	procid = (procid + 1) \ 4
+	proclist(procid) = "del_userTemp" + " ct:" + ct
+	dirlist buff, exedir + "user\\*.t"
+	notesel buff
+	repeat stat
+		noteget file, cnt
+		delete exedir + "user\\" + file
+	loop
+	return
+	arenaop = 1, 2, (100 - gdata(GDATA_RANK_PET_ARENA) / 100) / 2 + 1
+	arenaop(1) = rnd(9 - 1) + 2
+	dim followerexist, 16
+	repeat 16
+		followerexist(cnt) = cdata(CDATA_EXIST, cnt)
+		if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
+			followerin(cnt) = 1
+		}
+		else {
+			followerin(cnt) = 0
+		}
+	loop
+	gdata(GDATA_QUEST) = QUEST_SUBTYPE_DELIVER, 0, 0, 1
+	gdata(GDATA_RETURN_AREA) = gdata(GDATA_AREA), gdata(GDATA_LEVEL), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
+	gdata(GDATA_TELEPORT_AREA) = AREA_PET_ARENA
+	gdata(GDATA_TELEPORT_LEVEL) = 1
+	levelexitby = MAP_EXIT_TELEPORT
+	arenaimport = 1
+	goto *map_exit
+
+*label_5888
+	filemod = ""
+	fmode = 10
+	gosub *game_ctrlFile
+	folder = exedir + "save\\" + playerid + "\\"
+	exist folder + "filelist.txt"
+	if ( strsize != (-1) ) {
+		delete folder + "filelist.txt"
+	}
+	fmode = 7
+	gosub *game_ctrlFile
+	gosub *label_5780
+	gosub *db_setItem
+	repeat 16
+		if ( cbit(CHARA_BIT_PCC, cnt) == TRUE | cnt == 0 ) {
+			create_pcpic cnt, 1
+		}
+	loop
+	if ( gdata(GDATA_WIZARD) == 1 ) {
+		cdatan(CDATAN_AKA, CHARA_PLAYER) = "*Debug*"
+	}
+	refreshspeed 0
+	time_begin = timeGetTime() / 1000
+	return
+	procid = (procid + 1) \ 4
+	proclist(procid) = "generate_dump" + " ct:" + ct
+	file = exedir + "save\\" + playerid + "_html"
+	dirlist save_buff, file, 5
+	notesel save_buff
+	save_f = 0
+	repeat noteinfo(0)
+		noteget save_s, cnt
+		if ( save_s == playerid + "_html" ) {
+			save_f = 1
+			break
+		}
+	loop
+	if ( save_f == 0 ) {
+		mkdir file
+	}
+	else {
+	}
+	diaryhead = "<HTML><TITLE>" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "の冒険日誌</TITLE>"
+	diarystat = ""
+	diarylog = ""
+	diaryfoot = "</HTML>"
+	buff = diaryhead + diarystat + diarylog + diaryfoot
+	notesel buff
+	notesave exedir + "save\\" + playerid + "_html\\diary.html"
+	return
+
+*game_save
+	if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE | (gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179) | (gdata(GDATA_AREA) == AREA_AMUR_CAGE & gdata(GDATA_LEVEL) >= 10) ) {
+		txtef COLOR_RED
+		txt lang("ここではセーブされない。", "The game is not saved in this map.")
+		gosub *screen_draw
+		return
+	}
+	procid = (procid + 1) \ 4
+	proclist(procid) = "game_save" + " ct:" + ct
+	fmode = 2
+	gosub *game_ctrlFile
+	file = "inv_" + mid + ".s2"
+	fmode = 4
+	gosub *game_ctrlFile
+	file = exedir + "save\\" + playerid
+	dirlist save_buff, file, 5
+	notesel save_buff
+	save_f = 0
+	repeat noteinfo(0)
+		noteget save_s, cnt
+		if ( save_s == playerid ) {
+			save_f = 1
+			break
+		}
+	loop
+	if ( save_f == 0 ) {
+		mkdir file
+	}
+	else {
+	}
+	file += "\\"
+	notesel filemod
+	repeat noteinfo(0)
+		noteget save_s, cnt
+		if ( strmid(save_s, 0, 1) == "*" ) {
+			save_p = 0
+		}
+		else {
+			save_p = 1
+		}
+		save_s = strmid(save_s, 1, strlen(save_s))
+		if ( save_p == 0 ) {
+			bcopy save_s, file + getpath(save_s, 8)
+		}
+		else {
+			exist file + getpath(save_s, 8)
+			if ( strsize != (-1) ) {
+				delete file + getpath(save_s, 8)
+			}
+		}
+	loop
+	fmode = 8
+	gosub *game_ctrlFile
+	filemod = ""
+	return
+
+*label_5895
+	snd SOUNDLIST_EXITMAP1
+	gdata(GDATA_RETURN_AREA) = gdata(GDATA_AREA), gdata(GDATA_LEVEL), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
+	gdata(GDATA_TELEPORT_AREA) = AREA_SHOW_HOUSE
+	gdata(GDATA_TELEPORT_LEVEL) = 1
+	levelexitby = MAP_EXIT_TELEPORT
+	goto *map_exit
+
+*game_title
+	if ( cfg_titledialog ) {
+		dialog lang("＜利用規約＞\n\n elonaplusはフリーウェアであり、elonaの二次創作です。\n・本ソフトウェアは現在開発中です。不具合やバランスの急激な変動があります。\n・原作および他二次創作の作者・バランス・設定等を否定する意図はありません。\n・暴力的・性的・猟奇的な表現、描写が多数存在します。\n・本ソフトの利用によっていかなる不利益が発生した場合でも作者は一切の責任を負いません。自己責任で利用してください。\n・興味を持っていない人への過度の推薦や紹介は控え、wikiへの誘導程度に留めてください。\n・βテストプレイヤーとしてデバッグ義務なく普通に遊ぶことができますが、プレイ中にバグに遭遇した場合は報告していただけると助かります(任意)。\nただし、せっかく報告していただいても内容が不足しているとバグ修正に結びつかないため、テンプレートを用いた報告や検証にご協力ください。\n\n同梱の説明書(elona,elonaplus)にも目を通し、上記項目を含めて理解・承服できる方のみ利用できます。", "Elonaplus is a freeware, This is a secondary creation of elona. \n * This software is currently in development. There are defect and abrupt change of balance. \n * There is no intention to deny the author, balance, setting, of the other secondary creations and original creation. \n * There are many violent, sexual, bizarre, depictions. \n * Even if any disadvantage was caused by use of this software, the author does not take any responsibility. Please use at your own risk. \n * If you can comply the instructions and the above-mentioned items, you can use this software.")
+	}
+	mode = MODELIST_TITLE
+	lomiaseaster = 0
+	music = MUSICLIST_MCOPENING
+	gosub *music_play
+	cs = 0
+	cs_bk = -1
+	keyrange = 6
+	key_list = "a", "b", "c", "d", "e", "f"
+	pagesize = 0
+	redraw 0
+	gsel BUFFER_MAP
+	repeat 8
+		pos cnt \ 4 * 180, cnt / 4 * 300
+		picload exedir + "\\graphic\\g" + (cnt + 1) + ".bmp", 1
+	loop
+	gsel BUFFER_BUF
+	gmode 0
+	pos 0, 0
+	picload exedir + "\\graphic\\title" + devfile + ".bmp", 1
+	gzoom windoww, windowh, 4, 0, 0, 800, 600
+	gmode 2
+	font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
+	color 255, 255, 255
+	pos 20, 2
+	mes "Elona  Developed by Noa"
+	pos 20, 20
+	mes "ElonaPlus  Developed by Ano"
+	pos 20, 38
+	if ( jp ) {
+		mes "Contributor MSL / View the credits for more"
+	}
+	else {
+		mes "Contributor f1r3fly, Sunstrike, Schmidt, Elvenspirit / View the credits for more"
+	}
+	if ( jp ) {
+		s = "冒険の道標", strhint1
+	}
+	else {
+		s = "Starting Menu", strhint1
+	}
+	windowshadow = 1
+	display_window 80, winposy(308, 1), 320, 320
+	cmbg = 4
+	x = ww / 5 * 4
+	y = wh - 80
+	gmode 4, 180, 300, 50
+	pos wx + 160, wy + wh / 2
+	grotate BUFFER_MAP, cmbg / 2 * 180, cmbg \ 2 * 300, 0, x, y
+	gmode 2
+	if ( jp ) {
+		s = "Restore an adventurer", "冒険を再開する", "Generate an adventurer", "新しい冒険者を作成する", "Incarnate an adventurer", "冒険者の引継ぎ", "View the homepage", "本家Elonaホームページ", "Configure", "設定の変更", "Exit", "終了"
+	}
+	if ( en ) {
+		s = "Restore an Adventurer", "Generate an Adventurer", "Incarnate an Adventurer", "View the Homepage", "Options", "Exit"
+	}
+	if ( water_debug == 0 ) {
+		water_getimage
+		water_debug = 1
+	}
+	gsel BUFFER_SCREEN
+	gmode 0
+	pos 0, 0
+	gcopy BUFFER_BUF, 0, 0, windoww, windowh
+	gmode 2
+
+*game_title_WHILE1
+	if ( 1 == 0 ) {
+		goto *game_title_selectID
+	}
+	if ( cfg_autonumlock ) {
+		GetKeyboardState keybd_st
+		if ( peek(keybd_st, 144) == 1 ) {
+			keybd_event 144
+			keybd_event 144, 0, 2
+		}
+	}
+	redraw 0
+	if ( cfg_titleeffect ) {
+		tx += (rnd(10) + 2) * p(1)
+		ty += (rnd(10) + 2) * p(2)
+		if ( rnd(10) == 0 ) {
+			tx = rnd(800)
+			ty = rnd(600)
+			p(1) = rnd(9) - 4, rnd(9) - 4
+		}
+		f = 0
+		if ( tx > 40 & tx < 500 & ty > 100 & ty < 450 ) {
+			f = 1
+		}
+		if ( f == 0 ) {
+			if ( rnd(10) == 0 ) {
+				f = 2
+			}
+		}
+		if ( f == 0 ) {
+			water_setripple tx, ty, rnd(300), rnd(4)
+		}
+		water_calc
+	}
+	else {
+		water_refresh
+	}
+	water_draw
+	cs_listbk
+	repeat 6
+		x = wx + 40
+		y = cnt * 35 + wy + 50
+		display_customkey key_list(cnt), x, y
+		if ( jp ) {
+			font lang(cfg_font1, cfg_font2), 11 - en * 2, 0
+			pos x + 40, y - 4
+			mes s(cnt * 2)
+			font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
+			cs_list s(cnt * 2 + 1), x + 40, y + 8, 19
+		}
+		else {
+			font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
+			cs_list s(cnt), x + 40, y + 1, 19
+		}
+	loop
+	cs_bk = cs
+	redraw 1
+	await cfg_wait1
+	key_check
+	cursor_check
+	if ( key == "b" ) {
+		snd SOUNDLIST_OK1
+		geneuse = ""
+		goto *cm_init
+	}
+	if ( key == "a" ) {
+		snd SOUNDLIST_OK1
+		goto *game_title_selectID
+	}
+	if ( key == "c" ) {
+		snd SOUNDLIST_OK1
+		goto *game_title_selectGen
+	}
+	if ( key == "d" ) {
+		snd SOUNDLIST_OK1
+		exec homepage, 16
+	}
+	if ( key == "e" ) {
+		snd SOUNDLIST_OK1
+		goto *com_config
+	}
+	if ( key == "f" ) {
+		snd SOUNDLIST_OK1
+		await 400
+		goto *exit_game
+	}
+	goto *game_title_WHILE1
+
+*game_title_selectID
+	cs = 0
+	cs_bk = -1
+	redraw 0
+	gsel BUFFER_BUF
+	pos 0, 0
+	picload exedir + "\\graphic\\void.bmp", 1
+	gzoom windoww, windowh, 4, 0, 0, 800, 600
+	gsel BUFFER_SCREEN
+	gmode 0
+	pos 0, 0
+	gcopy BUFFER_BUF, 0, 0, windoww, windowh
+	gmode 2
+	if ( jp ) {
+		s = "どの冒険を再開するんだい？"
+	}
+	else {
+		s = "Which save game do you want to continue?"
+	}
+	gosub *screen_drawMsg2
+	file = exedir + "save\\*"
+	dirlist buff, file, 5
+	notesel buff
+	keyrange = 0
+	repeat noteinfo(0)
+		noteget s, cnt
+		file = exedir + "save\\" + s + "\\header.txt"
+		exist file
+		if ( strsize == (-1) ) {
+			notedel cnt
+			if ( cnt < noteinfo(0) ) {
+				continue cnt
+			}
+			else {
+				break
+			}
+		}
+		bload file, playerheader
+		list(0, cnt) = cnt
+		listn(0, cnt) = s, "" + playerheader
+		key_list(cnt) = key_select(cnt)
+		keyrange++
+	loop
+	windowshadow = 1
+
+*game_title_selectID_WHILE1
+	if ( 1 == 0 ) {
+		goto *game_title_selectGen
+	}
+	redraw 0
+	if ( jp ) {
+		s = "冒険者の選択", "BackSpace [削除]  " + strhint3b
+	}
+	else {
+		s = "Game Selection", "BackSpace [Delete]  " + strhint3b
+	}
+	display_window (windoww - 440) / 2 + inf_screenx, winposy(288, 1), 440, 288
+	cs_listbk
+	repeat noteinfo(0)
+		x = wx + 20
+		y = cnt * 40 + wy + 50
+		display_key x + 20, y - 2, cnt
+		font lang(cfg_font1, cfg_font2), 11 - en * 2, 0
+		pos x + 48, y - 4
+		mes listn(0, cnt)
+		font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
+		cs_list listn(1, cnt), x + 48, y + 8, 19
+	loop
+	cs_bk = cs
+	if ( noteinfo(0) == 0 ) {
+		font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
+		color 0, 0, 0
+		pos wx + 140, wy + 120
+		mes "No save files found"
+	}
+	redraw 1
+	await cfg_wait1
+	key_check
+	cursor_check
+	p = -1
+	repeat keyrange
+		if ( key == key_select(cnt) ) {
+			p = list(0, cnt)
+			break
+		}
+	loop
+	if ( p != (-1) ) {
+		playerid = listn(0, p)
+		snd SOUNDLIST_OK1
+		await 200
+		mode = MODELIST_CONTINUE
+		music = MUSICLIST_NONE
+		goto *world_init
+	}
+	getkey a, 8
+	if ( ginfo(2) == 0 ) {
+		if ( noteinfo(0) != 0 ) {
+			if ( a == 1 ) {
+				p = list(0, cs)
+				playerid = listn(0, p)
+				if ( jp ) {
+					s = "本当に" + playerid + "を削除していいのかい？"
+				}
+				else {
+					s = "Do you really want to delete " + playerid + " ?"
+				}
+				gosub *screen_drawMsg2
+				promptl(0, 0) = stryes, "y", "0"
+				promptl(0, 1) = strno, "n", "1"
+				promptmax = 2
+				val = promptx, prompty, 200, 1
+				gosub *prompt_key
+				if ( rtval != 0 ) {
+					goto *game_title_selectID
+				}
+				if ( jp ) {
+					s = "本当の本当に" + playerid + "を削除していいのかい？"
+				}
+				else {
+					s = "Are you sure you really want to delete " + playerid + " ?"
+				}
+				gosub *screen_drawMsg2
+				promptl(0, 0) = stryes, "y", "0"
+				promptl(0, 1) = strno, "n", "1"
+				promptmax = 2
+				val = promptx, prompty, 200, 1
+				gosub *prompt_key
+				if ( rtval == 0 ) {
+					snd SOUNDLIST_OK1
+					fmode = 9
+					gosub *game_ctrlFile
+				}
+				goto *game_title_selectID
+			}
+		}
+	}
+	if ( key == key_cancel ) {
+		goto *game_title
+	}
+	goto *game_title_selectID_WHILE1
+
+*game_title_selectGen
+	cs = 0
+	cs_bk = -1
+	redraw 0
+	gsel BUFFER_BUF
+	pos 0, 0
+	picload exedir + "\\graphic\\void.bmp", 1
+	gzoom windoww, windowh, 4, 0, 0, 800, 600
+	gsel BUFFER_SCREEN
+	gmode 0
+	pos 0, 0
+	gcopy BUFFER_BUF, 0, 0, windoww, windowh
+	gmode 2
+	if ( jp ) {
+		s = "どの遺伝子を引き継ぐ？"
+	}
+	else {
+		s = "Which gene do you want to incarnate?"
+	}
+	gosub *screen_drawMsg2
+	file = exedir + "save\\*"
+	dirlist buff, file, 5
+	notesel buff
+	keyrange = 0
+	listmax = 0
+	repeat noteinfo(0)
+		noteget s, cnt
+		file = exedir + "save\\" + s + "\\gene_header.txt"
+		exist file
+		await
+		if ( strsize == (-1) ) {
+			continue
+		}
+		bload file, playerheader
+		list(0, listmax) = listmax
+		listn(0, listmax) = s, "" + playerheader
+		key_list(listmax) = key_select(listmax)
+		keyrange++
+		listmax++
+	loop
+	windowshadow = 1
+
+*game_title_selectGen_WHILE1
+	if ( 1 == 0 ) {
+		goto *define_los
+	}
+	redraw 0
+	if ( jp ) {
+		s = "遺伝子の選択", strhint3b
+	}
+	else {
+		s = "Gene Selection", strhint3b
+	}
+	display_window (windoww - 440) / 2 + inf_screenx, winposy(288, 1), 440, 288
+	cs_listbk
+	repeat listmax
+		x = wx + 20
+		y = cnt * 40 + wy + 50
+		display_key x + 20, y - 2, cnt
+		font lang(cfg_font1, cfg_font2), 11 - en * 2, 0
+		pos x + 48, y - 4
+		mes listn(0, cnt)
+		font lang(cfg_font1, cfg_font2), 13 - en * 2, 0
+		cs_list listn(1, cnt), x + 48, y + 8, 19
+	loop
+	cs_bk = cs
+	if ( listmax == 0 ) {
+		font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
+		color 0, 0, 0
+		pos wx + 140, wy + 120
+		mes "No gene files found"
+	}
+	redraw 1
+	await cfg_wait1
+	key_check
+	cursor_check
+	p = -1
+	repeat keyrange
+		if ( key == key_select(cnt) ) {
+			p = list(0, cnt)
+			break
+		}
+	loop
+	if ( p != (-1) ) {
+		snd SOUNDLIST_OK1
+		geneuse = listn(0, p)
+		playerid = listn(0, p)
+		goto *cm_init
+	}
+	if ( key == key_cancel ) {
+		goto *game_title
+	}
+	goto *game_title_selectGen_WHILE1
+
+*define_los
+	dim fovlist, 2, 17
+	dim fovmap, 17 * 2 + 4, 17 * 2
+	if ( cdata(CDATA_FOV, CHARA_PLAYER) < 1 ) {
+		cdata(CDATA_FOV, CHARA_PLAYER) = 1
+	}
+	if ( cdata(CDATA_FOV, CHARA_PLAYER) >= 17 ) {
+		cdata(CDATA_FOV, CHARA_PLAYER) = 17 - 1
+	}
+	repeat 17
+		y = cnt
+		repeat 17
+			x = cnt
+			if ( dist(x, y, 17 / 2, 17 / 2) < (17 - 2) / 2 + 1 ) {
+				fovmap(x, y) = 1
+			}
+		loop
+	loop
+	repeat 17
+		y = cnt
+		p(1) = 0
+		repeat 17
+			x = cnt
+			p = fovmap(x, y)
+			if ( p != 0 & p(1) == 0 ) {
+				fovlist(0, y) = x
+				p(1) = 1
+			}
+			if ( p == 0 & p(1) == 1 ) {
+				fovlist(1, y) = x
+				break
+			}
+		loop
+	loop
+	return
+
+*esc_check
+	if ( wparam == 27 ) {
+		if ( ginfo(2) == 0 ) {
+			ime_esc = 1
+		}
+	}
+	return
+
+*prompt_word
+	snd SOUNDLIST_POP2
+	x = val
+	y = val(1)
+	dx = val(2) * 16 + 60
+	font lang(cfg_font1, cfg_font2), 16 - en * 2, 0
+	inputfail = 0
+	sdim inputlog2
+	if ( val(4) != 0 ) {
+		val(5) = val(4)
+		if ( strlen(str(val(5))) >= 3 ) {
+			dx += strlen(str(val(5))) * 8
+		}
+		redraw 0
+		pos x + 24, y + 4
+		gfini dx - 42, 35
+		gfdec 60, 60, 60
+		repeat
+			redraw 0
+			window2 x + 20, y, dx - 40, 36, 0, 2
+			pos x + dx / 2 - 56, y - 32
+			gcopy BUFFER_INF, 128, 288, 128, 32
+			pos x + 28, y + 4
+			gcopy BUFFER_INF, 312, 336, 24, 24
+			pos x + dx - 51, y + 4
+			gcopy BUFFER_INF, 336, 336, 24, 24
+			inputlog2 = "" + int(inputlog) + "(" + val(5) + ")"
+			pos x + dx - 70 - strlen(inputlog2) * 8 + 8, y + 11
+			color 255, 255, 255
+			mes inputlog2
+			redraw 1
+			await cfg_wait1
+			key_check
+			if ( key == key_enter ) {
+				f = 1
+				break
+			}
+			if ( key == key_cancel ) {
+				if ( val(3) == 1 ) {
+					f = -1
+					break
+				}
+			}
+			if ( key == key_west ) {
+				snd SOUNDLIST_CURSOR1
+				val(4)--
+				if ( val(4) < 1 ) {
+					val(4) = val(5)
+				}
+			}
+			if ( key == key_east ) {
+				snd SOUNDLIST_CURSOR1
+				val(4)++
+				if ( val(4) > val(5) ) {
+					val(4) = 1
+				}
+			}
+			if ( key == key_south ) {
+				snd SOUNDLIST_CURSOR1
+				val(4) = 1
+			}
+			if ( key == key_north ) {
+				snd SOUNDLIST_CURSOR1
+				val(4) = val(5)
+			}
+			inputlog = "" + val(4)
+		loop
+		if ( f == (-1) ) {
+			inputlog = ""
+			rtval = -1
+		}
+		keywait = 1
+		key = ""
+		rtval = 0
+		return
+	}
+	redraw 0
+	objmode 2, 0
+	if ( cfg_msg_box == 0 ) {
+		pos x + 4, y + 4
+		mesbox inputlog, dx - 8, 26, 1, val(2) * (1 + en)
+	}
+	else {
+		pos x, y
+		mesbox inputlog, 600, 0, 5, val(2) * (1 + en)
+		pos x + 4, y + 4
+		gfini dx - 1, 35
+		gfdec 60, 60, 60
+		aplsel "ElonaPlus 2.14"
+		if ( stat == 1 ) {
+			dialog "Failed to get WINDOW ID", 1
+			clrobj 1
+			cfg_msg_box = 0
+			goto *prompt_word
+		}
+		aplobj "", 1
+		if ( stat == 1 ) {
+			dialog "Failed to get OBJECT ID", 1
+			clrobj 1
+			cfg_msg_box = 0
+			goto *prompt_word
+		}
+	}
+	notesel inputlog
+	p(1) = 2
+	ime_esc = 0
+	onkey 1
+	repeat
+		if ( ginfo(2) == 0 ) {
+			objsel 1
+		}
+		else {
+			objprm 1, ""
+			inputlog = ""
+			await 100
+			continue cnt
+		}
+		redraw 0
+		await 40
+		window2 x, y, dx, 36, 0, 2
+		pos x + dx / 2 - 60, y - 32
+		gcopy BUFFER_INF, 128, 288, 128, 32
+		if ( cfg_msg_box == 1 ) {
+			pos x + 8, y + 4
+			if ( imeget() != 0 ) {
+				gcopy BUFFER_INF, 48, 336, 24, 24
+			}
+			else {
+				gcopy BUFFER_INF, 24, 336, 24, 24
+			}
+			apledit p(2), 2, 0
+			if ( p(2) > val(2) * (1 + en) - 2 ) {
+				pos x + 8, y + 4
+				gcopy BUFFER_INF, 72, 336, 24, 24
+			}
+			if ( cnt \ 20 < 10 ) {
+				p(1) = p(1) * 2
+			}
+			else {
+				p(1) = p(1) / 2
+			}
+			apledit p(2), 0
+			p(4) = 0
+			repeat p(2)
+				p(3) = peek(inputlog, p(4))
+				if ( p(3) >= 129 & p(3) <= 159 | (p(3) >= 224 & p(3) <= 252) ) {
+					p(4) += 2
+				}
+				else {
+					p(4) += 1
+				}
+			loop
+			gmode 4, , , p(1) / 2 + 50
+			pos x + 34 + p(4) * 8, y + 5
+			color 0, 0, 0
+			gcopy BUFFER_INF, 0, 336, 12, 24
+			gmode 2
+			color 255, 255, 255
+			pos x + 36, y + 9
+			noteget s, 0
+			mes s
+		}
+		if ( instr(inputlog, 0, "\n") != (-1) ) {
+			rtval = 0
+			break
+		}
+		if ( instr(inputlog, 0, "\t") != (-1) ) {
+			objprm 1, ""
+			inputlog = ""
+			if ( val(3) == 1 ) {
+				ime_esc = 1
+			}
+		}
+		redraw 1
+		if ( val(3) == 1 ) {
+			if ( ime_esc == 1 ) {
+				inputlog = ""
+				keywait = 1
+				key = ""
+				break
+			}
+		}
+	loop
+	gmode 2
+	clrobj 1
+	if ( inputfail ) {
+		cfg_msg_box = 0
+		goto *prompt_word
+	}
+	if ( input_mode == 1 ) {
+		cnv_filestr inputlog
+	}
+	input_mode = 0
+	if ( en ) {
+		cnv_str inputlog, "\"", "'"
+	}
+	rm_crlf inputlog
+	onkey 0
+	return
+
+*prompt_direction
+	snd SOUNDLIST_POP2
+	redraw 0
+	gsel BUFFER_BUF
+	x = (cdata(CDATA_X, CHARA_PLAYER) - scx) * inf_tiles + inf_screenx - 48
+	y = (cdata(CDATA_Y, CHARA_PLAYER) - scy) * inf_tiles + inf_screeny - 48
+	gmode 0
+	pos 0, 0
+	gcopy BUFFER_SCREEN, x, y, 48 * 3, 48 * 3
+	gsel BUFFER_SCREEN
+	t = 0
+
+*prompt_direction_WHILE1
+	if ( 1 == 0 ) {
+		goto *prompt_key
+	}
+	t++
+	gmode 4, 28, 28, 200 - t / 2 \ 20 * (t / 2 \ 20)
+	color 0, 0, 0
+	x = (cdata(CDATA_X, CHARA_PLAYER) - scx) * inf_tiles + inf_screenx + 24
+	y = (cdata(CDATA_Y, CHARA_PLAYER) - scy) * inf_tiles + inf_screeny + 24
+	if ( key_alt == 0 ) {
+		pos x, y - 48
+		grotate BUFFER_INF, 212, 432, 0, 28, 28
+		pos x, y + 48
+		grotate BUFFER_INF, 212, 432, 1.0 * 3.14, 28, 28
+		pos x + 48, y
+		grotate BUFFER_INF, 212, 432, 0.5 * 3.14, 28, 28
+		pos x - 48, y
+		grotate BUFFER_INF, 212, 432, 1.5 * 3.14, 28, 28
+	}
+	pos x - 48, y - 48
+	grotate BUFFER_INF, 212, 432, 1.75 * 3.14, 28, 28
+	pos x + 48, y + 48
+	grotate BUFFER_INF, 212, 432, 0.75 * 3.14, 28, 28
+	pos x + 48, y - 48
+	grotate BUFFER_INF, 212, 432, 0.25 * 3.14, 28, 28
+	pos x - 48, y + 48
+	grotate BUFFER_INF, 212, 432, 1.25 * 3.14, 28, 28
+	redraw 1
+	redraw 0
+	gmode 0
+	pos x - 48 - 24, y - 48 - 24
+	gcopy BUFFER_BUF, 0, 0, 48 * 3, 48 * 3
+	gmode 2
+	await 30
+	key_check 1
+	x = cdata(CDATA_X, CHARA_PLAYER)
+	y = cdata(CDATA_Y, CHARA_PLAYER)
+	if ( key == key_alter ) {
+		goto *prompt_direction_WHILE1_CONTINUE
+	}
+	if ( key == key_wait | key == key_enter ) {
+		tlocx = x
+		tlocy = y
+		keyhalt = 1
+		return 1
+	}
+	if ( key == key_north ) {
+		if ( key_alt ) {
+			goto *prompt_direction_WHILE1_CONTINUE
+		}
+		else {
+			y -= 1
+		}
+	}
+	if ( key == key_south ) {
+		if ( key_alt ) {
+			goto *prompt_direction_WHILE1_CONTINUE
+		}
+		else {
+			y += 1
+		}
+	}
+	if ( key == key_west ) {
+		if ( key_alt ) {
+			goto *prompt_direction_WHILE1_CONTINUE
+		}
+		else {
+			x -= 1
+		}
+	}
+	if ( key == key_east ) {
+		if ( key_alt ) {
+			goto *prompt_direction_WHILE1_CONTINUE
+		}
+		else {
+			x += 1
+		}
+	}
+	if ( key == key_northwest ) {
+		x -= 1
+		y -= 1
+	}
+	if ( key == key_northeast ) {
+		x += 1
+		y -= 1
+	}
+	if ( key == key_southwest ) {
+		x -= 1
+		y += 1
+	}
+	if ( key == key_southeast ) {
+		x += 1
+		y += 1
+	}
+	if ( key != "" ) {
+		if ( x < 0 | y < 0 | x >= mdata(MDATA_WIDTH) | y >= mdata(MDATA_HEIGHT) ) {
+			x = cdata(CDATA_X, CHARA_PLAYER)
+			y = cdata(CDATA_Y, CHARA_PLAYER)
+			keyhalt = 1
+			return 0
+		}
+		if ( x == cdata(CDATA_X, CHARA_PLAYER) & y == cdata(CDATA_Y, CHARA_PLAYER) ) {
+			return 0
+		}
+		tlocx = x
+		tlocy = y
+		keyhalt = 1
+		return 1
+	}
+
+*prompt_direction_WHILE1_CONTINUE
+	goto *prompt_direction_WHILE1
+
+*prompt_key
+	snd SOUNDLIST_POP2
+	csprev = cs
+	cs = 0
+	cs_bk = -1
+	redraw 0
+	gsel BUFFER_INF
+	gmode 0
+	font lang(cfg_font1, cfg_font2), 15 - en * 2, 0
+	repeat promptmax
+		if ( promptl(1, cnt) == "null" ) {
+			promptl(1, cnt) = key_select(cnt)
+		}
+		pos cnt * 24 + 624, 30
+		gcopy BUFFER_INF, 0, 30, 24, 18
+		pos cnt * 24 + 629, 31
+		color 50, 60, 80
+		bmes promptl(1, cnt), 250, 240, 230
+	loop
+	gsel BUFFER_SCREEN
+	sx = val - val(2) / 2
+	sy = val(1) - promptmax * 10
+	pos sx + 12, sy + 12
+	gfini val(2) - 17, promptmax * 20 + 43 - 18
+	gfdec 60, 60, 60
+	keyhalt = 1
+	if ( val(3) == 2 ) {
+		dx = 200, 10
+		dy = sy + 140
+		val(5) = val(4)
+		val(4) = 1
+		val = 1
+		if ( strlen(str(val(5))) >= 3 ) {
+			dx += strlen(str(val(5))) * 8
+		}
+		pos dx(1) + sx + 24, dy + 4
+		gfini dx - 42, 35
+		gfdec 60, 60, 60
+	}
+
+*prompt_key_WHILE1
+	if ( 1 == 0 ) {
+		goto *game_debug
+	}
+	redraw 0
+	gmode 2
+	if ( val(3) == 2 ) {
+		window2 dx(1) + sx + 20, dy, dx - 40, 36, 0, 2
+		pos dx(1) + sx + dx / 2 - 56, dy - 32
+		gcopy BUFFER_INF, 128, 288, 128, 32
+		pos dx(1) + sx + 28, dy + 4
+		gcopy BUFFER_INF, 312, 336, 24, 24
+		pos dx(1) + sx + dx - 51, dy + 4
+		gcopy BUFFER_INF, 336, 336, 24, 24
+		inputlog2 = "" + int(inputlog) + "(" + val(5) + ")"
+		pos dx(1) + sx + dx - 70 - strlen(inputlog2) * 8 + 8, dy + 11
+		color 255, 255, 255
+		mes inputlog2
+		inputlog = "" + val(4)
+	}
+	window2 sx + 8, sy + 8, val(2) - 16, promptmax * 20 + 42 - 16, 0, 0
+	pos sx - 16, sy
+	gcopy BUFFER_INF, 64, 288, 50, 32
+	color 255, 255, 255
+	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
+	keyrange = 0
+	cs_listbk
+	repeat promptmax
+		pos sx + 30, cnt * 20 + sy + 22
+		gcopy BUFFER_INF, cnt * 24 + 624, 30, 24, 24
+		cs_list promptl(0, cnt), sx + 56, cnt * 20 + sy + 21, 19
+		key_list(cnt) = promptl(1, cnt)
+		keyrange++
+	loop
+	cs_bk = cs
+	if ( rpmode ) {
+		window_recipe2
+		color 255, 255, 255
+		font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
+	}
+	redraw 1
+	await cfg_wait1
+	key_check
+	cursor_check
+	rtval = -1
+	repeat promptmax
+		if ( key == promptl(1, cnt) ) {
+			rtval = int(promptl(2, cnt))
+			break
+		}
+	loop
+	if ( val(3) == 2 ) {
+		val = int(inputlog)
+		if ( key == key_west | key == key_pagedown ) {
+			snd SOUNDLIST_CURSOR1
+			val(4)--
+			if ( val(4) < 1 ) {
+				val(4) = val(5)
+			}
+		}
+		if ( key == key_east | key == key_pageup ) {
+			snd SOUNDLIST_CURSOR1
+			val(4)++
+			if ( val(4) > val(5) ) {
+				val(4) = 1
+			}
+		}
+	}
+	if ( rtval != (-1) ) {
+		promptmax = 0
+		cs = csprev
+		return 1
+	}
+	if ( val(3) != 0 ) {
+		if ( key == key_cancel ) {
+			promptmax = 0
+			cs = csprev
+			return 0
+		}
+	}
+	goto *prompt_key_WHILE1
+
+*game_debug
+	notesel dbm
+	buff = ""
+	if ( dbm == "" ) {
+		noteadd "ElonaPlus 2.14" + " v" + "6.14" + " Debug Console    Type \"?\" for help. Hit ESC to exit."
+		noteadd ""
+	}
+	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
+	objmode 2
+	pos 0, 24
+	mesbox dbm, 800, 576, 0
+	pos 0, 0
+	mesbox buff, 800, 24, 1
+	objsel 2
+
+*game_debug_WHILE1
+	if ( 1 == 0 ) {
+		goto *game_debug_WEND1
+	}
+	await 20
+	stick a
+	if ( a == 128 ) {
+		goto *game_debug_WEND1
+	}
+	if ( a == 32 ) {
+		gosub *dbg_GetInfo
+	}
+	goto *game_debug_WHILE1
+
+*game_debug_WEND1
+	clrobj 1
+	clrobj 2
+	if ( dbg_exitshowroom == 1 ) {
+		dbg_exitshowroom = 0
+		levelexitby = MAP_EXIT_NORMAL
+		goto *map_exit
+	}
+	goto *pc_turn
+
+*dbg_GetInfo
+	if ( 1 == 0 ) {
+		goto *console_write
+	}
+	if ( instr(buff, 0, "?") != (-1) ) {
+		noteadd "\t1\t\tShows charainfo."
+		noteadd "\t2\t\tShows pc equipment."
+		noteadd "\t3\t\tShows pc inventory."
+		noteadd "\t4\t\tBegin/end var-comparison."
+		noteadd "\t5\t\tShows core game data."
+		noteadd "\tdel\t\tDeletes current log."
+		noteadd "\tquest\t\tLists all the quests."
+		noteadd "\tclient\t\tLists all the clients."
+		noteadd "\texitroom\tLeaves current show-room."
+		noteadd "\twizard\t\tEnables wizard mode."
+		noteadd ""
+		noteadd "\tThe commands below can be used in the Wizard mode."
+		noteadd "\tgain_spell\tPC gains all spells."
+		noteadd "\tgain_spact\tPC gains all special actions."
+		noteadd "\tgain_exp\tPC gains a billion of exp."
+		noteadd "\tgain_fame\tPC gains fame."
+		noteadd "\tallinv\t\tDisplays all the items in the map."
+		noteadd ""
+		noteadd "\tThe commands below should be only used to deal with certain problems."
+		noteadd "\t108fix\t\tTurns all the NPCs in the map hostile."
+		noteadd "\tadvreset\tRemoves all items from adventureres."
+		noteadd "\tfixcorrupt1\tTries to fix corrputed save files."
+		noteadd "\tfreemove\tEnables freemove."
+		noteadd "\tresetmap\tResets towns and some areas."
+		noteadd "\tfixmap\t\tFixes possible bugs for current map."
+		noteadd "\tmapinfo\t\tShows map info."
+		goto *console_write
+	}
+	if ( int(buff) == 1 ) {
+		repeat 245
+			noteadd "" + cnt + "\t" + cdatan(CDATAN_NAME, cnt) + "\tExist:" + cdata(CDATA_EXIST, cnt) + "\tRespawn:" + cdata(CDATA_RESPAWN, cnt) + "\tRole:" + cdata(CDATA_ROLE, cnt)
+		loop
+		goto *console_write
+	}
+	if ( int(buff) == 2 ) {
+		repeat 30
+			p = 100 + cnt
+			if ( cdata(p, CHARA_PLAYER) != 0 ) {
+				p(1) = cdata(p, CHARA_PLAYER)
+				s = "" + p + "\t" + p(1) + "\t"
+				if ( p(1) \ 10000 > 0 ) {
+					s += itemname(p(1) \ 10000 - 1)
+				}
+				noteadd s
+			}
+		loop
+		goto *console_write
+	}
+	if ( int(buff) == 3 ) {
+		inv_getheader 0
+		repeat invrange, invhead
+			noteadd "" + cnt + "\t" + itemname(cnt) + "\t"
+		loop
+		goto *console_write
+	}
+	if ( int(buff) == 4 ) {
+		if ( dbg_compare == 0 ) {
+			sdim cdatan2, 40, 10, 245
+			dim cdata2, 500, 245
+			dim sdata2, 600 * 2, 245
+			dim inv2, 70, 5480
+		}
+		noteadd "cdata"
+		repeat 245
+			cnt2 = cnt
+			repeat 500
+				s = ""
+				if ( cnt == 6 | cnt == 10 ) {
+					s = "*"
+				}
+				if ( dbg_compare == 0 ) {
+					cdata2(cnt, cnt2) = cdata(cnt, cnt2)
+				}
+				if ( dbg_compare == 1 ) {
+					if ( cdata2(cnt, cnt2) != cdata(cnt, cnt2) ) {
+						noteadd s + "" + cnt2 + "\t" + cnt + "\t" + cdata2(cnt, cnt2) + "\t->" + cdata(cnt, cnt2)
+					}
+				}
+			loop
+		loop
+		noteadd "cdatan"
+		repeat 245
+			cnt2 = cnt
+			repeat 10
+				s = ""
+				if ( dbg_compare == 0 ) {
+					cdatan2(cnt, cnt2) = cdatan(cnt, cnt2)
+				}
+				if ( dbg_compare == 1 ) {
+					if ( cdatan2(cnt, cnt2) != cdatan(cnt, cnt2) ) {
+						noteadd s + "" + cnt2 + "\t" + cnt + "\t" + cdatan2(cnt, cnt2) + "\t->" + cdatan(cnt, cnt2)
+					}
+				}
+			loop
+		loop
+		noteadd "skill"
+		repeat 245
+			cnt2 = cnt
+			repeat 600 * 2
+				s = ""
+				if ( dbg_compare == 0 ) {
+					sdata2(cnt, cnt2) = sdata(cnt, cnt2)
+				}
+				if ( dbg_compare == 1 ) {
+					if ( sdata2(cnt, cnt2) != sdata(cnt, cnt2) ) {
+						noteadd s + "" + cnt2 + "\t" + cnt + "\t" + sdata2(cnt, cnt2) + "\t->" + sdata(cnt, cnt2)
+					}
+				}
+			loop
+		loop
+		noteadd "inv"
+		repeat 5480
+			cnt2 = cnt
+			repeat 70
+				s = ""
+				if ( dbg_compare == 0 ) {
+					inv2(cnt, cnt2) = inv(cnt, cnt2)
+				}
+				if ( dbg_compare == 1 ) {
+					if ( inv2(cnt, cnt2) != inv(cnt, cnt2) ) {
+						noteadd s + "" + cnt2 + "\t" + cnt + "\t" + inv2(cnt, cnt2) + "\t->" + inv(cnt, cnt2)
+					}
+				}
+			loop
+		loop
+		if ( dbg_compare == 0 ) {
+			dbg_compare = 1
+			noteadd "Var_comparison begins."
+		}
+		else {
+			dbg_compare = 0
+		}
+		goto *console_write
+	}
+	if ( int(buff) == 5 ) {
+		repeat 1000
+			noteadd "" + cnt + "\t" + gdata(cnt)
+		loop
+		goto *console_write
+	}
+	if ( instr(buff, 0, "del") != (-1) | buff == "\n" ) {
+		dbm = ""
+		goto *console_write
+	}
+	if ( instr(buff, 0, "freemove") != (-1) ) {
+		dbg_freemove = 1
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "resetmap") != (-1) ) {
+		gosub *label_5817
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "exitroom") != (-1) ) {
+		if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
+			dbg_exitshowroom = 1
+			noteadd "Done."
+		}
+		else {
+			noteadd "Wrong map."
+		}
+		goto *console_write
+	}
+	if ( instr(buff, 0, "removequest") != (-1) ) {
+		repeat gdata(GDATA_CLIENT)
+			if ( qdata(QDATA_STATE, cnt) != QUEST_STATE_NONE ) {
+				if ( qdata(QDATA_DEADLINE, cnt) == (-1) ) {
+					qdata(QDATA_STATE, cnt) = QUEST_STATE_NONE
+				}
+			}
+		loop
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "fixmap") != (-1) ) {
+		repeat 245
+			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+				continue
+			}
+			if ( cdata(CDATA_X, cnt) < 0 | cdata(CDATA_X, cnt) >= mdata(MDATA_WIDTH) | cdata(CDATA_Y, cnt) < 0 | cdata(CDATA_Y, cnt) >= mdata(MDATA_HEIGHT) ) {
+				cdata(CDATA_X, cnt) = 0
+				cdata(CDATA_Y, cnt) = 0
+			}
+		loop
+		repeat 400, 5080
+			if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+				continue
+			}
+			if ( inv(INV_ITEM_X, cnt) < 0 | inv(INV_ITEM_X, cnt) >= mdata(MDATA_WIDTH) | inv(INV_ITEM_Y, cnt) < 0 | inv(INV_ITEM_Y, cnt) >= mdata(MDATA_HEIGHT) ) {
+				inv(INV_ITEM_X, cnt) = 0
+				inv(INV_ITEM_Y, cnt) = 0
+			}
+		loop
+		cell_refresh 0, 0
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "advreset") != (-1) ) {
+		repeat 40 - 1, 16
+			rc = cnt
+			inv_getheader rc
+			repeat invrange, invhead
+				cnt2 = cnt
+				repeat 70
+					inv(cnt, cnt2) = 0
+				loop
+			loop
+			repeat 30, 100
+				cdata(cnt, rc) = 0
+			loop
+		loop
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "fixcorrupt1") != (-1) ) {
+		repeat 57
+			rc = cnt
+			inv_getheader rc
+			repeat invrange, invhead
+				cnt2 = cnt
+				if ( inv(INV_ITEM_ID, cnt) >= MAX_ITEM_DBID | inv(INV_ITEM_ID, cnt) <= ITEM_ID_DUMMY | inv(INV_ITEM_NUM, cnt) <= 0 ) {
+					repeat 70
+						inv(cnt, cnt2) = 0
+					loop
+				}
+				if ( inv(INV_ITEM_EQUIP, cnt) != 0 ) {
+					inv(INV_ITEM_EQUIP, cnt) = 0
+				}
+			loop
+			repeat 30, 100
+				cdata(cnt, rc) = cdata(cnt, rc) / EXT_EQUIP_SLOTS * 10000
+			loop
+			if ( cnt >= 16 ) {
+				cdata(CDATA_EXIST, cnt) = CHAR_STATE_ADV_DEAD
+				gosub *label_8908
+			}
+		loop
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "client") != (-1) ) {
+		dim mapclient, 1000
+		repeat 500
+			if ( qdata(QDATA_CLIENT, cnt) == 0 ) {
+				i = cnt
+				continue
+			}
+			noteadd "id:" + cnt + " name:" + qname(cnt) + " map:" + mapname(qdata(QDATA_MAP, cnt))
+			mapclient(qdata(QDATA_MAP, cnt))++
+		loop
+		repeat 1000
+			if ( mapclient(cnt) != 0 ) {
+				noteadd "" + mapname(cnt) + ":" + mapclient(cnt), 1
+			}
+		loop
+		goto *console_write
+	}
+	if ( instr(buff, 0, "108fix") != (-1) ) {
+		repeat 245
+			if ( cnt < 57 ) {
+				continue
+			}
+			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
+				cdata(CDATA_RELATION, cnt) = RELATION_ENEMY
+				cdata(CDATA_RELATION_ORG, cnt) = RELATION_ENEMY
+			}
+		loop
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "test") != (-1) ) {
+		repeat 500
+			noteadd "" + cnt + ":" + mapname(cnt) + "/" + adata(ADATA_ID, cnt)
+		loop
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "mapinfo") != (-1) ) {
+		noteadd "gArea\t\t:" + gdata(GDATA_AREA)
+		noteadd "gLevel\t\t:" + gdata(GDATA_LEVEL)
+		noteadd "file\t\t:" + "mdata_" + mid + ".s2"
+		noteadd "pc x/y\t\t:" + cdata(CDATA_X, CHARA_PLAYER) + "/" + cdata(CDATA_Y, CHARA_PLAYER)
+		noteadd "map max w/h\t:" + mdata(MDATA_WIDTH) + "/" + mdata(MDATA_HEIGHT)
+		noteadd "Done."
+		goto *console_write
+	}
+	if ( instr(buff, 0, "quest") != (-1) ) {
+		noteadd "gQuest:" + gdata(GDATA_QUEST) + " gQuestRef:" + gdata(GDATA_QUEST_REF) + " gQuestStatus:" + gdata(GDATA_QUEST_STATE) + " rq:" + rq
+		repeat 5
+			p = gdata(GDATA_QUEST_POOL + cnt)
+			noteadd "quest" + cnt + " " + p + " exist" + qdata(QDATA_EXIST, p) + " status" + qdata(QDATA_STATE, p) + " var" + qdata(QDATA_VAR, p) + " encount" + qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), p)
+		loop
+		repeat gdata(GDATA_CLIENT)
+			noteadd "" + cnt + " " + qdata(QDATA_CLIENT, cnt) + "/" + qdata(QDATA_MAP, cnt)
+		loop
+		goto *console_write
+	}
+	if ( instr(buff, 0, "wizard") != (-1) ) {
+		gdata(GDATA_WIZARD) = 1
+		cdatan(CDATAN_AKA, CHARA_PLAYER) = "*Debug*"
+		noteadd "Wizard mode activated."
+		goto *console_write
+	}
+	if ( gdata(GDATA_WIZARD) | 0 ) {
+		if ( instr(buff, 0, "gain_spell") != (-1) ) {
+			repeat 492 - 400, 400
+				skillgain CHARA_PLAYER, cnt, cdata(CDATA_LEVEL, r1), 100 * 100
+			loop
+			noteadd "Done."
+			goto *console_write
+		}
+		if ( instr(buff, 0, "gain_spact") != (-1) ) {
+			repeat 846 - 600
+				spact(cnt + STARTING_SKILL_SPACT - STARTING_SKILL_SPACT) = 1
+			loop
+			noteadd "Done."
+			goto *console_write
+		}
+		if ( instr(buff, 0, "allinv") != (-1) ) {
+			repeat 5480
+				if ( cnt < 5080 ) {
+					if ( cnt >= 200 ) {
+						if ( (cnt - 200) \ 20 == 0 ) {
+							noteadd "-----------" + cdatan(CDATAN_NAME, (cnt - 200) / 20 + 1)
+						}
+					}
+				}
+				if ( cnt == 5080 ) {
+					noteadd "-----------------------MAP INV"
+				}
+				noteadd "" + cnt + "\t" + inv(INV_ITEM_NUM, cnt) + "\t" + itemname(cnt) + " it:" + inv(INV_ITEM_TURN, cnt)
+			loop
+			goto *console_write
+		}
+		if ( instr(buff, 0, "mapinv") != (-1) ) {
+			repeat 5480 - 5080
+				if ( cnt == 5080 ) {
+					noteadd "-----------------------MAP INV"
+				}
+				if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
+					noteadd "" + cnt + "\t" + inv(INV_ITEM_NUM, cnt) + "\t" + itemname(cnt) + " it:" + inv(INV_ITEM_TURN, cnt)
+				}
+			loop
+			goto *console_write
+		}
+		if ( instr(buff, 0, "gain_exp") != (-1) ) {
+			cdata(CDATA_EXP, CHARA_PLAYER) += 1000000000
+			r1 = 0
+			r2 = 0
+			gosub *label_3967
+			noteadd "Done."
+			goto *console_write
+		}
+		if ( instr(buff, 0, "gain_fame") != (-1) ) {
+			cdata(CDATA_FAME, CHARA_PLAYER) += 10000
+			noteadd "Done."
+			goto *console_write
+		}
+	}
+	noteadd "Unknown command. Type \"?\" for help. Hit ESC to exit."
+	goto *console_write
+	goto *dbg_GetInfo
+
+*console_write
+	noteadd ""
+	objprm 1, dbm
+	objprm 2, ""
+	return
+
+*mutexobj
+	CreateMutexA 0, 0, "ElonaPlus 2.14"
+	mutex_handle = stat
+	func_3
+	if ( stat == 183 ) {
+		dialog lang("二重起動のため終了します。", "The program is already running."), 1
+		end
+	}
+	return
+	goto *randomSite
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
 
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/db_race.hsp ../2.14-borscht/db_race.hsp
--- ../2.13-borscht/db_race.hsp	2022-06-26 12:14:16.234815600 -0700
+++ ../2.14-borscht/db_race.hsp	2022-09-18 12:37:01.123859400 -0700
@@ -1,308 +1,308 @@
 *raceID_fix
-	if ( cdatan(CDATAN_RACE, r1) == "kobolt" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_KOBOLT
+	if ( cnRace(r1) == "kobolt" ) {
+		cRaceId(r1) = DB_RACE_KOBOLT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "orc" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_ORC
+	if ( cnRace(r1) == "orc" ) {
+		cRaceId(r1) = DB_RACE_ORC
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "largeanimal" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_LARGE_ANIMAL
+	if ( cnRace(r1) == "largeanimal" ) {
+		cRaceId(r1) = DB_RACE_LARGE_ANIMAL
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "lizardman" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_LIZARDMAN
+	if ( cnRace(r1) == "lizardman" ) {
+		cRaceId(r1) = DB_RACE_LIZARDMAN
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "minotaur" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_MINOTAUR
+	if ( cnRace(r1) == "minotaur" ) {
+		cRaceId(r1) = DB_RACE_MINOTAUR
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "yerles" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_YERLES
+	if ( cnRace(r1) == "yerles" ) {
+		cRaceId(r1) = DB_RACE_YERLES
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "norland" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_NORLAND
+	if ( cnRace(r1) == "norland" ) {
+		cRaceId(r1) = DB_RACE_NORLAND
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "eulderna" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_EULDERNA
+	if ( cnRace(r1) == "eulderna" ) {
+		cRaceId(r1) = DB_RACE_EULDERNA
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "fairy" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_FAIRY
+	if ( cnRace(r1) == "fairy" ) {
+		cRaceId(r1) = DB_RACE_FAIRY
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "asura" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_ASURA
+	if ( cnRace(r1) == "asura" ) {
+		cRaceId(r1) = DB_RACE_ASURA
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "slime" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SLIME
+	if ( cnRace(r1) == "slime" ) {
+		cRaceId(r1) = DB_RACE_SLIME
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "doggod" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_DOG_GOD
+	if ( cnRace(r1) == "doggod" ) {
+		cRaceId(r1) = DB_RACE_DOG_GOD
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "dwarf" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_DWARF
+	if ( cnRace(r1) == "dwarf" ) {
+		cRaceId(r1) = DB_RACE_DWARF
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "juere" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_JUERE
+	if ( cnRace(r1) == "juere" ) {
+		cRaceId(r1) = DB_RACE_JUERE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "zombie" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_ZOMBIE
+	if ( cnRace(r1) == "zombie" ) {
+		cRaceId(r1) = DB_RACE_ZOMBIE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "elea" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_ELEA
+	if ( cnRace(r1) == "elea" ) {
+		cRaceId(r1) = DB_RACE_ELEA
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "rabbit" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_RABBIT
+	if ( cnRace(r1) == "rabbit" ) {
+		cRaceId(r1) = DB_RACE_RABBIT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "sheep" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SHEEP
+	if ( cnRace(r1) == "sheep" ) {
+		cRaceId(r1) = DB_RACE_SHEEP
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "frog" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_FROG
+	if ( cnRace(r1) == "frog" ) {
+		cRaceId(r1) = DB_RACE_FROG
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "worm" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_WORM
+	if ( cnRace(r1) == "worm" ) {
+		cRaceId(r1) = DB_RACE_WORM
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "snail" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SNAIL
+	if ( cnRace(r1) == "snail" ) {
+		cRaceId(r1) = DB_RACE_SNAIL
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "mandrake" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_MANDRAKE
+	if ( cnRace(r1) == "mandrake" ) {
+		cRaceId(r1) = DB_RACE_MANDRAKE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "beetle" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_BEETLE
+	if ( cnRace(r1) == "beetle" ) {
+		cRaceId(r1) = DB_RACE_BEETLE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "mushroom" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_MUSHROOM
+	if ( cnRace(r1) == "mushroom" ) {
+		cRaceId(r1) = DB_RACE_MUSHROOM
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "bat" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_BAT
+	if ( cnRace(r1) == "bat" ) {
+		cRaceId(r1) = DB_RACE_BAT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "ent" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_ENT
+	if ( cnRace(r1) == "ent" ) {
+		cRaceId(r1) = DB_RACE_ENT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "lich" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_LICH
+	if ( cnRace(r1) == "lich" ) {
+		cRaceId(r1) = DB_RACE_LICH
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "bacteria" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_BACTERIA
+	if ( cnRace(r1) == "bacteria" ) {
+		cRaceId(r1) = DB_RACE_BACTERIA
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "ghost" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_GHOST
+	if ( cnRace(r1) == "ghost" ) {
+		cRaceId(r1) = DB_RACE_GHOST
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "spirit" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SPIRIT
+	if ( cnRace(r1) == "spirit" ) {
+		cRaceId(r1) = DB_RACE_SPIRIT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "eye" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_EYE
+	if ( cnRace(r1) == "eye" ) {
+		cRaceId(r1) = DB_RACE_EYE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "mazin" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_MAZIN
+	if ( cnRace(r1) == "mazin" ) {
+		cRaceId(r1) = DB_RACE_MAZIN
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "wasp" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_WASP
+	if ( cnRace(r1) == "wasp" ) {
+		cRaceId(r1) = DB_RACE_WASP
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "giant" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_GIANT
+	if ( cnRace(r1) == "giant" ) {
+		cRaceId(r1) = DB_RACE_GIANT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "imp" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_IMP
+	if ( cnRace(r1) == "imp" ) {
+		cRaceId(r1) = DB_RACE_IMP
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "hand" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_HAND
+	if ( cnRace(r1) == "hand" ) {
+		cRaceId(r1) = DB_RACE_HAND
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "snake" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SNAKE
+	if ( cnRace(r1) == "snake" ) {
+		cRaceId(r1) = DB_RACE_SNAKE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "drake" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_DRAKE
+	if ( cnRace(r1) == "drake" ) {
+		cRaceId(r1) = DB_RACE_DRAKE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "goblin" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_GOBLIN
+	if ( cnRace(r1) == "goblin" ) {
+		cRaceId(r1) = DB_RACE_GOBLIN
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "bear" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_BEAR
+	if ( cnRace(r1) == "bear" ) {
+		cRaceId(r1) = DB_RACE_BEAR
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "armor" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_ARMOR
+	if ( cnRace(r1) == "armor" ) {
+		cRaceId(r1) = DB_RACE_ARMOR
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "medusa" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_MEDUSA
+	if ( cnRace(r1) == "medusa" ) {
+		cRaceId(r1) = DB_RACE_MEDUSA
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "cupid" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_CUPID
+	if ( cnRace(r1) == "cupid" ) {
+		cRaceId(r1) = DB_RACE_CUPID
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "karune" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_KARUNE
+	if ( cnRace(r1) == "karune" ) {
+		cRaceId(r1) = DB_RACE_KARUNE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "harpy" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_HARPY
+	if ( cnRace(r1) == "harpy" ) {
+		cRaceId(r1) = DB_RACE_HARPY
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "dragon" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_DRAGON
+	if ( cnRace(r1) == "dragon" ) {
+		cRaceId(r1) = DB_RACE_DRAGON
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "dinosaur" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_DINOSAUR
+	if ( cnRace(r1) == "dinosaur" ) {
+		cRaceId(r1) = DB_RACE_DINOSAUR
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "beast" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_BEAST
+	if ( cnRace(r1) == "beast" ) {
+		cRaceId(r1) = DB_RACE_BEAST
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "spider" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SPIDER
+	if ( cnRace(r1) == "spider" ) {
+		cRaceId(r1) = DB_RACE_SPIDER
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "golem" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_GOLEM
+	if ( cnRace(r1) == "golem" ) {
+		cRaceId(r1) = DB_RACE_GOLEM
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "rock" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_ROCK
+	if ( cnRace(r1) == "rock" ) {
+		cRaceId(r1) = DB_RACE_ROCK
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "zanan" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_ZANAN
+	if ( cnRace(r1) == "zanan" ) {
+		cRaceId(r1) = DB_RACE_ZANAN
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "skeleton" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SKELETON
+	if ( cnRace(r1) == "skeleton" ) {
+		cRaceId(r1) = DB_RACE_SKELETON
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "piece" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_PIECE
+	if ( cnRace(r1) == "piece" ) {
+		cRaceId(r1) = DB_RACE_PIECE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "cat" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_CAT
+	if ( cnRace(r1) == "cat" ) {
+		cRaceId(r1) = DB_RACE_CAT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "dog" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_DOG
+	if ( cnRace(r1) == "dog" ) {
+		cRaceId(r1) = DB_RACE_DOG
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "roran" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_RORAN
+	if ( cnRace(r1) == "roran" ) {
+		cRaceId(r1) = DB_RACE_RORAN
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "rat" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_RAT
+	if ( cnRace(r1) == "rat" ) {
+		cRaceId(r1) = DB_RACE_RAT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "shell" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SHELL
+	if ( cnRace(r1) == "shell" ) {
+		cRaceId(r1) = DB_RACE_SHELL
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "catgod" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_CAT_GOD
+	if ( cnRace(r1) == "catgod" ) {
+		cRaceId(r1) = DB_RACE_CAT_GOD
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "machinegod" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_MACHINE_GOD
+	if ( cnRace(r1) == "machinegod" ) {
+		cRaceId(r1) = DB_RACE_MACHINE_GOD
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "undeadgod" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_UNDEAD_GOD
+	if ( cnRace(r1) == "undeadgod" ) {
+		cRaceId(r1) = DB_RACE_UNDEAD_GOD
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "machine" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_MACHINE
+	if ( cnRace(r1) == "machine" ) {
+		cRaceId(r1) = DB_RACE_MACHINE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "wisp" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_WISP
+	if ( cnRace(r1) == "wisp" ) {
+		cRaceId(r1) = DB_RACE_WISP
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "bird" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_BIRD
+	if ( cnRace(r1) == "bird" ) {
+		cRaceId(r1) = DB_RACE_BIRD
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "seamonster" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SEA_MONSTER
+	if ( cnRace(r1) == "seamonster" ) {
+		cRaceId(r1) = DB_RACE_SEA_MONSTER
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "catsister" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_CAT_SISTER
+	if ( cnRace(r1) == "catsister" ) {
+		cRaceId(r1) = DB_RACE_CAT_SISTER
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "mutant" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_MUTANT
+	if ( cnRace(r1) == "mutant" ) {
+		cRaceId(r1) = DB_RACE_MUTANT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "yeek" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_YEEK
+	if ( cnRace(r1) == "yeek" ) {
+		cRaceId(r1) = DB_RACE_YEEK
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "yith" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_YITH
+	if ( cnRace(r1) == "yith" ) {
+		cRaceId(r1) = DB_RACE_YITH
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "servant" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_SERVANT
+	if ( cnRace(r1) == "servant" ) {
+		cRaceId(r1) = DB_RACE_SERVANT
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "horse" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_HORSE
+	if ( cnRace(r1) == "horse" ) {
+		cRaceId(r1) = DB_RACE_HORSE
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "god" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_GOD
+	if ( cnRace(r1) == "god" ) {
+		cRaceId(r1) = DB_RACE_GOD
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "quickling" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_QUICKLING
+	if ( cnRace(r1) == "quickling" ) {
+		cRaceId(r1) = DB_RACE_QUICKLING
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "metal" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_METAL
+	if ( cnRace(r1) == "metal" ) {
+		cRaceId(r1) = DB_RACE_METAL
 		return
 	}
-	if ( cdatan(CDATAN_RACE, r1) == "vehicle" ) {
-		cdata(CDATA_RACE_ID, r1) = DB_RACE_BEHICLE
+	if ( cnRace(r1) == "vehicle" ) {
+		cRaceId(r1) = DB_RACE_BEHICLE
 		return
 	}
 	return
 
 *db_setFilterRace
@@ -715,28 +715,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "kobolt"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_KOBOLT
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
-			cdata(CDATA_HEIGHT, rc) = 150
+			cnRace(rc) = "kobolt"
+			cRaceId(rc) = DB_RACE_KOBOLT
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(30) + 15)
+			cHeight(rc) = 150
 			if ( rnd(100) < 50 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(6, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(6, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 90
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -777,28 +783,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "orc"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_ORC
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
-			cdata(CDATA_HEIGHT, rc) = 150
+			cnRace(rc) = "orc"
+			cRaceId(rc) = DB_RACE_ORC
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(30) + 15)
+			cHeight(rc) = 150
 			if ( rnd(100) < 51 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(0, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(0, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 130
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 3
@@ -839,28 +851,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "largeanimal"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_LARGE_ANIMAL
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(5) + 10)
-			cdata(CDATA_HEIGHT, rc) = 400
+			cnRace(rc) = "largeanimal"
+			cRaceId(rc) = DB_RACE_LARGE_ANIMAL
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(5) + 10)
+			cHeight(rc) = 400
 			if ( rnd(100) < 51 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(10, 13)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(10, 13)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 160
 			skillinit SKILL_ATTR_MANA, rc, 60
 			skillinit SKILL_ATTR_STR, rc, 12
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 3
@@ -901,28 +919,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "lizardman"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_LIZARDMAN
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 15)
-			cdata(CDATA_HEIGHT, rc) = 240
+			cnRace(rc) = "lizardman"
+			cRaceId(rc) = DB_RACE_LIZARDMAN
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(20) + 15)
+			cHeight(rc) = 240
 			if ( rnd(100) < 51 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(1, 12)
-			cdata(CDATA_DV_FIX, rc) = 120
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(1, 12)
+			cDvFix(rc) = 120
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 70
 			skillinit SKILL_ATTR_STR, rc, 10
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -963,28 +987,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "minotaur"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_MINOTAUR
-			cdata(CDATA_MELEE_STYLE, rc) = 9
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
-			cdata(CDATA_HEIGHT, rc) = 350
+			cnRace(rc) = "minotaur"
+			cRaceId(rc) = DB_RACE_MINOTAUR
+			cMeleeStyle(rc) = 9
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(30) + 15)
+			cHeight(rc) = 350
 			if ( rnd(100) < 51 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(2, 12)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(2, 12)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 160
 			skillinit SKILL_ATTR_MANA, rc, 60
 			skillinit SKILL_ATTR_STR, rc, 12
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 3
@@ -1026,31 +1056,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "yerles"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_YERLES
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 15)
-			cdata(CDATA_HEIGHT, rc) = 165
+			cnRace(rc) = "yerles"
+			cRaceId(rc) = DB_RACE_YERLES
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(20) + 15)
+			cHeight(rc) = 165
 			if ( rnd(100) < 52 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(1, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(2, 0)
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(1, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(2, 0)
+			}
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 110
 			skillinit SKILL_ATTR_MANA, rc, 90
 			skillinit SKILL_ATTR_STR, rc, 7
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -1093,31 +1129,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "norland"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_NORLAND
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 15)
-			cdata(CDATA_HEIGHT, rc) = 170
+			cnRace(rc) = "norland"
+			cRaceId(rc) = DB_RACE_NORLAND
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(20) + 15)
+			cHeight(rc) = 170
 			if ( rnd(100) < 52 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(1, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(2, 0)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(1, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(2, 0)
+			}
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 90
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 6
@@ -1160,31 +1202,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "eulderna"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_EULDERNA
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 16)
-			cdata(CDATA_HEIGHT, rc) = 175
+			cnRace(rc) = "eulderna"
+			cRaceId(rc) = DB_RACE_EULDERNA
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(20) + 16)
+			cHeight(rc) = 175
 			if ( rnd(100) < 52 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(5, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(6, 0)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(5, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(6, 0)
+			}
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 6
 			skillinit SKILL_ATTR_CON, rc, 7
 			skillinit SKILL_ATTR_DEX, rc, 7
@@ -1227,46 +1275,52 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "fairy"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_FAIRY
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(100) + 5)
-			cdata(CDATA_HEIGHT, rc) = 50
+			cnRace(rc) = "fairy"
+			cRaceId(rc) = DB_RACE_FAIRY
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(100) + 5)
+			cHeight(rc) = 50
 			if ( rnd(100) < 52 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(27, 11)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(27, 11)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(27, 11)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(27, 11)
 			}
 			if ( 2 == 1 ) {
-				sdata(SKILL_RES_DARKNESS, rc) = 500
-				sdata(SKILL_RES_NERVE, rc) = 500
-				sdata(SKILL_RES_NETHER, rc) = 500
-				sdata(SKILL_RES_FIRE, rc) = 80
+				sResNether(rc) = 500
+				sResChaos(rc) = 500
+				sResPoison(rc) = 500
+				sResFire(rc) = 80
 			}
 			if ( 2 == 2 ) {
-				sdata(SKILL_RES_MAGIC, rc) = 200
-				sdata(SKILL_RES_DARKNESS, rc) = 200
-				sdata(SKILL_RES_NERVE, rc) = 200
-				sdata(SKILL_RES_NETHER, rc) = 200
-				sdata(SKILL_RES_MIND, rc) = 200
-				sdata(SKILL_RES_SOUND, rc) = 200
-				sdata(SKILL_RES_CHAOS, rc) = 200
+				sResMagic(rc) = 200
+				sResNether(rc) = 200
+				sResChaos(rc) = 200
+				sResPoison(rc) = 200
+				sResDarkness(rc) = 200
+				sResSound(rc) = 200
+				sResNerve(rc) = 200
 			}
-			cdata(CDATA_DV_FIX, rc) = 250
-			cdata(CDATA_PV_FIX, rc) = 100
+			cDvFix(rc) = 250
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 40
 			skillinit SKILL_ATTR_MANA, rc, 130
 			skillinit SKILL_ATTR_STR, rc, 3
 			skillinit SKILL_ATTR_CON, rc, 4
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -1308,28 +1362,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "asura"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_ASURA
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 15)
-			cdata(CDATA_HEIGHT, rc) = 220
+			cnRace(rc) = "asura"
+			cRaceId(rc) = DB_RACE_ASURA
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(20) + 15)
+			cHeight(rc) = 220
 			if ( rnd(100) < 52 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(9, 12)
-			cdata(CDATA_DV_FIX, rc) = 200
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(9, 12)
+			cDvFix(rc) = 200
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 90
 			skillinit SKILL_ATTR_MANA, rc, 70
 			skillinit SKILL_ATTR_STR, rc, 11
 			skillinit SKILL_ATTR_CON, rc, 9
 			skillinit SKILL_ATTR_DEX, rc, 14
@@ -1371,28 +1431,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "slime"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SLIME
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 2
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 1)
-			cdata(CDATA_HEIGHT, rc) = 40
+			cnRace(rc) = "slime"
+			cRaceId(rc) = DB_RACE_SLIME
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 2
+			cAge(rc) = gYear - (rnd(10) + 1)
+			cHeight(rc) = 40
 			if ( rnd(100) < 54 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(3, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 200
+			cPic(rc) = xy2pic(3, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 200
 			skillinit SKILL_ATTR_LIFE, rc, 80
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 4
 			skillinit SKILL_ATTR_CON, rc, 5
 			skillinit SKILL_ATTR_DEX, rc, 7
@@ -1433,28 +1499,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "doggod"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_DOG_GOD
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(500) + 1000)
-			cdata(CDATA_HEIGHT, rc) = 820
+			cnRace(rc) = "doggod"
+			cRaceId(rc) = DB_RACE_DOG_GOD
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(500) + 1000)
+			cHeight(rc) = 820
 			if ( rnd(100) < 55 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(23, 7)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 150
+			cPic(rc) = xy2pic(23, 7)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 60
 			skillinit SKILL_ATTR_STR, rc, 14
 			skillinit SKILL_ATTR_CON, rc, 14
 			skillinit SKILL_ATTR_DEX, rc, 21
@@ -1494,28 +1566,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "dwarf"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_DWARF
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(60) + 20)
-			cdata(CDATA_HEIGHT, rc) = 100
+			cnRace(rc) = "dwarf"
+			cRaceId(rc) = DB_RACE_DWARF
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(60) + 20)
+			cHeight(rc) = 100
 			if ( rnd(100) < 56 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(1, 2)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(1, 2)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 10
 			skillinit SKILL_ATTR_CON, rc, 11
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -1558,31 +1636,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "juere"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_JUERE
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
-			cdata(CDATA_HEIGHT, rc) = 165
+			cnRace(rc) = "juere"
+			cRaceId(rc) = DB_RACE_JUERE
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(30) + 15)
+			cHeight(rc) = 165
 			if ( rnd(100) < 50 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(9, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(10, 0)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(9, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(10, 0)
+			}
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 7
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 12
@@ -1624,43 +1708,49 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "zombie"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_ZOMBIE
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 10)
-			cdata(CDATA_HEIGHT, rc) = 160
+			cnRace(rc) = "zombie"
+			cRaceId(rc) = DB_RACE_ZOMBIE
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(200) + 10)
+			cHeight(rc) = 160
 			if ( rnd(100) < 50 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(2, 5)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(2, 5)
 			if ( 1 == 1 ) {
-				sdata(SKILL_RES_DARKNESS, rc) = 500
-				sdata(SKILL_RES_NERVE, rc) = 500
-				sdata(SKILL_RES_NETHER, rc) = 500
-				sdata(SKILL_RES_FIRE, rc) = 80
+				sResNether(rc) = 500
+				sResChaos(rc) = 500
+				sResPoison(rc) = 500
+				sResFire(rc) = 80
 			}
 			if ( 1 == 2 ) {
-				sdata(SKILL_RES_MAGIC, rc) = 200
-				sdata(SKILL_RES_DARKNESS, rc) = 200
-				sdata(SKILL_RES_NERVE, rc) = 200
-				sdata(SKILL_RES_NETHER, rc) = 200
-				sdata(SKILL_RES_MIND, rc) = 200
-				sdata(SKILL_RES_SOUND, rc) = 200
-				sdata(SKILL_RES_CHAOS, rc) = 200
+				sResMagic(rc) = 200
+				sResNether(rc) = 200
+				sResChaos(rc) = 200
+				sResPoison(rc) = 200
+				sResDarkness(rc) = 200
+				sResSound(rc) = 200
+				sResNerve(rc) = 200
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 150
+			cDvFix(rc) = 100
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 10
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 2
@@ -1702,31 +1792,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "elea"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_ELEA
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 10)
-			cdata(CDATA_HEIGHT, rc) = 180
+			cnRace(rc) = "elea"
+			cRaceId(rc) = DB_RACE_ELEA
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(200) + 10)
+			cHeight(rc) = 180
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(3, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(4, 0)
+			cPic(rc) = xy2pic(3, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(4, 0)
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 90
 			skillinit SKILL_ATTR_MANA, rc, 110
 			skillinit SKILL_ATTR_STR, rc, 6
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -1768,28 +1864,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "rabbit"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_RABBIT
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(5) + 2)
-			cdata(CDATA_HEIGHT, rc) = 40
+			cnRace(rc) = "rabbit"
+			cRaceId(rc) = DB_RACE_RABBIT
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(5) + 2)
+			cHeight(rc) = 40
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(4, 5)
-			cdata(CDATA_DV_FIX, rc) = 120
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(4, 5)
+			cDvFix(rc) = 120
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 90
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 4
 			skillinit SKILL_ATTR_DEX, rc, 6
@@ -1830,28 +1932,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "sheep"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SHEEP
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(5) + 2)
-			cdata(CDATA_HEIGHT, rc) = 150
+			cnRace(rc) = "sheep"
+			cRaceId(rc) = DB_RACE_SHEEP
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(5) + 2)
+			cHeight(rc) = 150
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(5, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 120
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(5, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 120
 			skillinit SKILL_ATTR_LIFE, rc, 130
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 6
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -1892,28 +2000,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "frog"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_FROG
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(5) + 2)
-			cdata(CDATA_HEIGHT, rc) = 10
+			cnRace(rc) = "frog"
+			cRaceId(rc) = DB_RACE_FROG
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(5) + 2)
+			cHeight(rc) = 10
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(7, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(7, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 80
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 6
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 6
@@ -1954,28 +2068,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "worm"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_WORM
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 10
+			cnRace(rc) = "worm"
+			cRaceId(rc) = DB_RACE_WORM
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 10
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(8, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(8, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 90
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 6
 			skillinit SKILL_ATTR_CON, rc, 5
 			skillinit SKILL_ATTR_DEX, rc, 10
@@ -2016,28 +2136,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "snail"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SNAIL
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 8
+			cnRace(rc) = "snail"
+			cRaceId(rc) = DB_RACE_SNAIL
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 8
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(9, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(9, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 4
 			skillinit SKILL_ATTR_CON, rc, 5
 			skillinit SKILL_ATTR_DEX, rc, 3
@@ -2076,28 +2202,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "mandrake"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_MANDRAKE
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 25
+			cnRace(rc) = "mandrake"
+			cRaceId(rc) = DB_RACE_MANDRAKE
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 25
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(10, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(10, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 70
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -2139,28 +2271,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "beetle"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_BEETLE
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 8
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 10
+			cnRace(rc) = "beetle"
+			cRaceId(rc) = DB_RACE_BEETLE
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 8
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 10
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(11, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 140
+			cPic(rc) = xy2pic(11, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 140
 			skillinit SKILL_ATTR_LIFE, rc, 80
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -2201,28 +2339,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "mushroom"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_MUSHROOM
-			cdata(CDATA_MELEE_STYLE, rc) = 7
-			cdata(CDATA_CAST_STYLE, rc) = 5
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 20
+			cnRace(rc) = "mushroom"
+			cRaceId(rc) = DB_RACE_MUSHROOM
+			cMeleeStyle(rc) = 7
+			cCastStyle(rc) = 5
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 20
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(12, 5)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(12, 5)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 50
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 7
 			skillinit SKILL_ATTR_DEX, rc, 4
@@ -2263,35 +2407,41 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "bat"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_BAT
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 70
+			cnRace(rc) = "bat"
+			cRaceId(rc) = DB_RACE_BAT
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 70
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(2, 6)
-			sdata(SKILL_RES_DARKNESS, rc) = 500
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(2, 6)
+			sResNether(rc) = 500
 			if ( 0 != 0 ) {
 				sdata(rsres0, rc) = 500
 			}
 			if ( 0 != 0 ) {
 				sdata(rsres0, rc) = 500
 			}
-			cdata(CDATA_DV_FIX, rc) = 320
-			cdata(CDATA_PV_FIX, rc) = 100
+			cDvFix(rc) = 320
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 10
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 3
 			skillinit SKILL_ATTR_CON, rc, 5
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -2332,28 +2482,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "ent"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_ENT
-			cdata(CDATA_MELEE_STYLE, rc) = 8
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 1500
+			cnRace(rc) = "ent"
+			cRaceId(rc) = DB_RACE_ENT
+			cMeleeStyle(rc) = 8
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 1500
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(3, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 140
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(3, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 140
 			skillinit SKILL_ATTR_LIFE, rc, 170
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 9
 			skillinit SKILL_ATTR_CON, rc, 12
 			skillinit SKILL_ATTR_DEX, rc, 4
@@ -2394,43 +2550,49 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "lich"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_LICH
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 180
+			cnRace(rc) = "lich"
+			cRaceId(rc) = DB_RACE_LICH
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 180
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(4, 6)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(4, 6)
 			if ( 1 == 1 ) {
-				sdata(SKILL_RES_DARKNESS, rc) = 500
-				sdata(SKILL_RES_NERVE, rc) = 500
-				sdata(SKILL_RES_NETHER, rc) = 500
-				sdata(SKILL_RES_FIRE, rc) = 80
+				sResNether(rc) = 500
+				sResChaos(rc) = 500
+				sResPoison(rc) = 500
+				sResFire(rc) = 80
 			}
 			if ( 1 == 2 ) {
-				sdata(SKILL_RES_MAGIC, rc) = 200
-				sdata(SKILL_RES_DARKNESS, rc) = 200
-				sdata(SKILL_RES_NERVE, rc) = 200
-				sdata(SKILL_RES_NETHER, rc) = 200
-				sdata(SKILL_RES_MIND, rc) = 200
-				sdata(SKILL_RES_SOUND, rc) = 200
-				sdata(SKILL_RES_CHAOS, rc) = 200
+				sResMagic(rc) = 200
+				sResNether(rc) = 200
+				sResChaos(rc) = 200
+				sResPoison(rc) = 200
+				sResDarkness(rc) = 200
+				sResSound(rc) = 200
+				sResNerve(rc) = 200
 			}
-			cdata(CDATA_DV_FIX, rc) = 190
-			cdata(CDATA_PV_FIX, rc) = 150
+			cDvFix(rc) = 190
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 80
 			skillinit SKILL_ATTR_MANA, rc, 140
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 7
@@ -2472,28 +2634,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "bacteria"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_BACTERIA
-			cdata(CDATA_MELEE_STYLE, rc) = 7
-			cdata(CDATA_CAST_STYLE, rc) = 3
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 500
+			cnRace(rc) = "bacteria"
+			cRaceId(rc) = DB_RACE_BACTERIA
+			cMeleeStyle(rc) = 7
+			cCastStyle(rc) = 3
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 500
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(31, 13)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 150
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(31, 13)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 180
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 13
 			skillinit SKILL_ATTR_CON, rc, 13
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -2535,43 +2703,49 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "ghost"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_GHOST
-			cdata(CDATA_MELEE_STYLE, rc) = 6
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 160
+			cnRace(rc) = "ghost"
+			cRaceId(rc) = DB_RACE_GHOST
+			cMeleeStyle(rc) = 6
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 160
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(7, 6)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(7, 6)
 			if ( 1 == 1 ) {
-				sdata(SKILL_RES_DARKNESS, rc) = 500
-				sdata(SKILL_RES_NERVE, rc) = 500
-				sdata(SKILL_RES_NETHER, rc) = 500
-				sdata(SKILL_RES_FIRE, rc) = 80
+				sResNether(rc) = 500
+				sResChaos(rc) = 500
+				sResPoison(rc) = 500
+				sResFire(rc) = 80
 			}
 			if ( 1 == 2 ) {
-				sdata(SKILL_RES_MAGIC, rc) = 200
-				sdata(SKILL_RES_DARKNESS, rc) = 200
-				sdata(SKILL_RES_NERVE, rc) = 200
-				sdata(SKILL_RES_NETHER, rc) = 200
-				sdata(SKILL_RES_MIND, rc) = 200
-				sdata(SKILL_RES_SOUND, rc) = 200
-				sdata(SKILL_RES_CHAOS, rc) = 200
+				sResMagic(rc) = 200
+				sResNether(rc) = 200
+				sResChaos(rc) = 200
+				sResPoison(rc) = 200
+				sResDarkness(rc) = 200
+				sResSound(rc) = 200
+				sResNerve(rc) = 200
 			}
-			cdata(CDATA_DV_FIX, rc) = 160
-			cdata(CDATA_PV_FIX, rc) = 300
+			cDvFix(rc) = 160
+			cPvFix(rc) = 300
 			skillinit SKILL_ATTR_LIFE, rc, 70
 			skillinit SKILL_ATTR_MANA, rc, 90
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 6
@@ -2613,28 +2787,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "spirit"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SPIRIT
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 100
+			cnRace(rc) = "spirit"
+			cRaceId(rc) = DB_RACE_SPIRIT
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 100
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(8, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(8, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 9
 			skillinit SKILL_ATTR_CON, rc, 9
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -2675,28 +2855,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "eye"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_EYE
-			cdata(CDATA_MELEE_STYLE, rc) = 4
-			cdata(CDATA_CAST_STYLE, rc) = 3
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 40
+			cnRace(rc) = "eye"
+			cRaceId(rc) = DB_RACE_EYE
+			cMeleeStyle(rc) = 4
+			cCastStyle(rc) = 3
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 40
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(9, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(9, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 3
 			skillinit SKILL_ATTR_CON, rc, 9
 			skillinit SKILL_ATTR_DEX, rc, 4
@@ -2737,28 +2923,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "mazin"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_MAZIN
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 7
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 20)
-			cdata(CDATA_HEIGHT, rc) = 160
+			cnRace(rc) = "mazin"
+			cRaceId(rc) = DB_RACE_MAZIN
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 7
+			cAge(rc) = gYear - (rnd(10) + 20)
+			cHeight(rc) = 160
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(14, 9)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(14, 9)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 110
 			skillinit SKILL_ATTR_MANA, rc, 90
 			skillinit SKILL_ATTR_STR, rc, 11
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -2799,28 +2991,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "wasp"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_WASP
-			cdata(CDATA_MELEE_STYLE, rc) = 5
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 80
+			cnRace(rc) = "wasp"
+			cRaceId(rc) = DB_RACE_WASP
+			cMeleeStyle(rc) = 5
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 80
 			if ( rnd(100) < 20 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(12, 6)
-			cdata(CDATA_DV_FIX, rc) = 220
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(12, 6)
+			cDvFix(rc) = 220
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 50
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 7
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 13
@@ -2861,28 +3059,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "giant"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_GIANT
-			cdata(CDATA_MELEE_STYLE, rc) = 9
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 1800
+			cnRace(rc) = "giant"
+			cRaceId(rc) = DB_RACE_GIANT
+			cMeleeStyle(rc) = 9
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 1800
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(1, 7)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(1, 7)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 200
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 12
 			skillinit SKILL_ATTR_CON, rc, 14
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -2923,28 +3127,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "imp"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_IMP
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 7
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(100) + 100)
-			cdata(CDATA_HEIGHT, rc) = 180
+			cnRace(rc) = "imp"
+			cRaceId(rc) = DB_RACE_IMP
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 7
+			cAge(rc) = gYear - (rnd(100) + 100)
+			cHeight(rc) = 180
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(14, 6)
-			cdata(CDATA_DV_FIX, rc) = 200
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(14, 6)
+			cDvFix(rc) = 200
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 120
 			skillinit SKILL_ATTR_STR, rc, 11
 			skillinit SKILL_ATTR_CON, rc, 10
 			skillinit SKILL_ATTR_DEX, rc, 7
@@ -2985,28 +3195,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "hand"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_HAND
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 70
+			cnRace(rc) = "hand"
+			cRaceId(rc) = DB_RACE_HAND
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 70
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(15, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(15, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 9
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -3047,28 +3263,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "snake"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SNAKE
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 50
+			cnRace(rc) = "snake"
+			cRaceId(rc) = DB_RACE_SNAKE
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 50
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(18, 6)
-			cdata(CDATA_DV_FIX, rc) = 120
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(18, 6)
+			cDvFix(rc) = 120
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 6
 			skillinit SKILL_ATTR_CON, rc, 9
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -3109,28 +3331,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "drake"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_DRAKE
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 1400
+			cnRace(rc) = "drake"
+			cRaceId(rc) = DB_RACE_DRAKE
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 1400
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(2, 7)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 120
+			cPic(rc) = xy2pic(2, 7)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 120
 			skillinit SKILL_ATTR_LIFE, rc, 160
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 11
 			skillinit SKILL_ATTR_CON, rc, 12
 			skillinit SKILL_ATTR_DEX, rc, 11
@@ -3171,28 +3399,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "goblin"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_GOBLIN
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 140
+			cnRace(rc) = "goblin"
+			cRaceId(rc) = DB_RACE_GOBLIN
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 140
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(22, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(22, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 110
 			skillinit SKILL_ATTR_MANA, rc, 90
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -3234,28 +3468,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "bear"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_BEAR
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 280
+			cnRace(rc) = "bear"
+			cRaceId(rc) = DB_RACE_BEAR
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 280
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(24, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(24, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 160
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 9
 			skillinit SKILL_ATTR_CON, rc, 10
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -3296,29 +3536,35 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "armor"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_ARMOR
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 6
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 20)
-			cdata(CDATA_HEIGHT, rc) = 190
+			cnRace(rc) = "armor"
+			cRaceId(rc) = DB_RACE_ARMOR
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 6
+			cAge(rc) = gYear - (rnd(20) + 20)
+			cHeight(rc) = 190
 			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(25, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 200
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(25, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 200
 			skillinit SKILL_ATTR_LIFE, rc, 50
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 9
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 7
@@ -3359,28 +3605,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "medusa"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_MEDUSA
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 4
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 160
+			cnRace(rc) = "medusa"
+			cRaceId(rc) = DB_RACE_MEDUSA
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 4
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 160
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(26, 6)
-			cdata(CDATA_DV_FIX, rc) = 140
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(26, 6)
+			cDvFix(rc) = 140
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 110
 			skillinit SKILL_ATTR_STR, rc, 7
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -3421,28 +3673,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "cupid"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_CUPID
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 7
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 120
+			cnRace(rc) = "cupid"
+			cRaceId(rc) = DB_RACE_CUPID
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 7
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 120
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(27, 6)
-			cdata(CDATA_DV_FIX, rc) = 200
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(27, 6)
+			cDvFix(rc) = 200
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 80
 			skillinit SKILL_ATTR_MANA, rc, 150
 			skillinit SKILL_ATTR_STR, rc, 4
 			skillinit SKILL_ATTR_CON, rc, 7
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -3485,31 +3743,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "karune"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_KARUNE
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
-			cdata(CDATA_HEIGHT, rc) = 170
+			cnRace(rc) = "karune"
+			cRaceId(rc) = DB_RACE_KARUNE
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(30) + 15)
+			cHeight(rc) = 170
 			if ( rnd(100) < 50 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(21, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(22, 0)
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(21, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(22, 0)
+			}
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 9
 			skillinit SKILL_ATTR_CON, rc, 9
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -3551,28 +3815,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "harpy"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_HARPY
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 140
+			cnRace(rc) = "harpy"
+			cRaceId(rc) = DB_RACE_HARPY
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 140
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(29, 6)
-			cdata(CDATA_DV_FIX, rc) = 150
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(29, 6)
+			cDvFix(rc) = 150
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 90
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -3613,28 +3883,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "dragon"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_DRAGON
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 2400
+			cnRace(rc) = "dragon"
+			cRaceId(rc) = DB_RACE_DRAGON
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 2400
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(30, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 120
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(30, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 120
 			skillinit SKILL_ATTR_LIFE, rc, 220
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 13
 			skillinit SKILL_ATTR_CON, rc, 15
 			skillinit SKILL_ATTR_DEX, rc, 10
@@ -3675,28 +3951,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "dinosaur"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_DINOSAUR
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 2000
+			cnRace(rc) = "dinosaur"
+			cRaceId(rc) = DB_RACE_DINOSAUR
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 2000
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(26, 11)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 120
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(26, 11)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 120
 			skillinit SKILL_ATTR_LIFE, rc, 140
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 10
 			skillinit SKILL_ATTR_DEX, rc, 6
@@ -3737,28 +4019,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "beast"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_BEAST
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(500) + 400)
-			cdata(CDATA_HEIGHT, rc) = 1200
+			cnRace(rc) = "beast"
+			cRaceId(rc) = DB_RACE_BEAST
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(500) + 400)
+			cHeight(rc) = 1200
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(31, 6)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(31, 6)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 160
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 11
 			skillinit SKILL_ATTR_CON, rc, 9
 			skillinit SKILL_ATTR_DEX, rc, 10
@@ -3799,28 +4087,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "spider"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SPIDER
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 1
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 60
+			cnRace(rc) = "spider"
+			cRaceId(rc) = DB_RACE_SPIDER
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 1
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 60
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(32, 6)
-			cdata(CDATA_DV_FIX, rc) = 170
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(32, 6)
+			cDvFix(rc) = 170
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 50
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 5
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -3861,29 +4155,35 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "golem"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_GOLEM
-			cdata(CDATA_MELEE_STYLE, rc) = 9
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 700
+			cnRace(rc) = "golem"
+			cRaceId(rc) = DB_RACE_GOLEM
+			cMeleeStyle(rc) = 9
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 700
 			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(0, 7)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 140
+			cPic(rc) = xy2pic(0, 7)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 140
 			skillinit SKILL_ATTR_LIFE, rc, 150
 			skillinit SKILL_ATTR_MANA, rc, 70
 			skillinit SKILL_ATTR_STR, rc, 10
 			skillinit SKILL_ATTR_CON, rc, 14
 			skillinit SKILL_ATTR_DEX, rc, 4
@@ -3924,29 +4224,35 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "rock"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_ROCK
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 6
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 500
+			cnRace(rc) = "rock"
+			cRaceId(rc) = DB_RACE_ROCK
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 6
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 500
 			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(23, 11)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 200
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(23, 11)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 200
 			skillinit SKILL_ATTR_LIFE, rc, 40
 			skillinit SKILL_ATTR_MANA, rc, 50
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 22
 			skillinit SKILL_ATTR_DEX, rc, 3
@@ -3988,31 +4294,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "zanan"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_ZANAN
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(20) + 20)
-			cdata(CDATA_HEIGHT, rc) = 175
+			cnRace(rc) = "zanan"
+			cRaceId(rc) = DB_RACE_ZANAN
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(20) + 20)
+			cHeight(rc) = 175
 			if ( rnd(100) < 50 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(11, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(12, 0)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(11, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(12, 0)
+			}
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 11
@@ -4054,44 +4366,50 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "skeleton"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SKELETON
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 5)
-			cdata(CDATA_HEIGHT, rc) = 160
+			cnRace(rc) = "skeleton"
+			cRaceId(rc) = DB_RACE_SKELETON
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(200) + 5)
+			cHeight(rc) = 160
 			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(10, 7)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(10, 7)
 			if ( 1 == 1 ) {
-				sdata(SKILL_RES_DARKNESS, rc) = 500
-				sdata(SKILL_RES_NERVE, rc) = 500
-				sdata(SKILL_RES_NETHER, rc) = 500
-				sdata(SKILL_RES_FIRE, rc) = 80
+				sResNether(rc) = 500
+				sResChaos(rc) = 500
+				sResPoison(rc) = 500
+				sResFire(rc) = 80
 			}
 			if ( 1 == 2 ) {
-				sdata(SKILL_RES_MAGIC, rc) = 200
-				sdata(SKILL_RES_DARKNESS, rc) = 200
-				sdata(SKILL_RES_NERVE, rc) = 200
-				sdata(SKILL_RES_NETHER, rc) = 200
-				sdata(SKILL_RES_MIND, rc) = 200
-				sdata(SKILL_RES_SOUND, rc) = 200
-				sdata(SKILL_RES_CHAOS, rc) = 200
+				sResMagic(rc) = 200
+				sResNether(rc) = 200
+				sResChaos(rc) = 200
+				sResPoison(rc) = 200
+				sResDarkness(rc) = 200
+				sResSound(rc) = 200
+				sResNerve(rc) = 200
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 120
+			cDvFix(rc) = 100
+			cPvFix(rc) = 120
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 7
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -4132,29 +4450,35 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "piece"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_PIECE
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 450
+			cnRace(rc) = "piece"
+			cRaceId(rc) = DB_RACE_PIECE
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 450
 			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(13, 7)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 150
+			cPic(rc) = xy2pic(13, 7)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 9
 			skillinit SKILL_ATTR_CON, rc, 7
 			skillinit SKILL_ATTR_DEX, rc, 6
@@ -4195,28 +4519,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "cat"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_CAT
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 4
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 60
+			cnRace(rc) = "cat"
+			cRaceId(rc) = DB_RACE_CAT
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 4
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 60
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(22, 7)
-			cdata(CDATA_DV_FIX, rc) = 200
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(22, 7)
+			cDvFix(rc) = 200
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 120
 			skillinit SKILL_ATTR_STR, rc, 6
 			skillinit SKILL_ATTR_CON, rc, 7
 			skillinit SKILL_ATTR_DEX, rc, 7
@@ -4257,28 +4587,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "dog"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_DOG
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 80
+			cnRace(rc) = "dog"
+			cRaceId(rc) = DB_RACE_DOG
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 80
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(23, 7)
-			cdata(CDATA_DV_FIX, rc) = 200
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(23, 7)
+			cDvFix(rc) = 200
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 8
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 7
@@ -4320,31 +4656,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "roran"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_RORAN
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 150
+			cnRace(rc) = "roran"
+			cRaceId(rc) = DB_RACE_RORAN
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 150
 			if ( rnd(100) < 0 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(4, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(4, 0)
+			cPic(rc) = xy2pic(4, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(4, 0)
 			}
-			cdata(CDATA_DV_FIX, rc) = 150
-			cdata(CDATA_PV_FIX, rc) = 100
+			cDvFix(rc) = 150
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 4
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -4386,28 +4728,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "rat"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_RAT
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 30
+			cnRace(rc) = "rat"
+			cRaceId(rc) = DB_RACE_RAT
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 30
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(24, 7)
-			cdata(CDATA_DV_FIX, rc) = 250
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(24, 7)
+			cDvFix(rc) = 250
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 80
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 4
 			skillinit SKILL_ATTR_DEX, rc, 8
@@ -4448,28 +4796,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "shell"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SHELL
-			cdata(CDATA_MELEE_STYLE, rc) = 11
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 120
+			cnRace(rc) = "shell"
+			cRaceId(rc) = DB_RACE_SHELL
+			cMeleeStyle(rc) = 11
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 120
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(25, 7)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 300
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(25, 7)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 300
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 7
 			skillinit SKILL_ATTR_CON, rc, 9
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -4512,28 +4866,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "catgod"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_CAT_GOD
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 120
+			cnRace(rc) = "catgod"
+			cRaceId(rc) = DB_RACE_CAT_GOD
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 120
 			if ( rnd(100) < 0 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(1, 6)
-			cdata(CDATA_DV_FIX, rc) = 250
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(1, 6)
+			cDvFix(rc) = 250
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 12
 			skillinit SKILL_ATTR_CON, rc, 13
 			skillinit SKILL_ATTR_DEX, rc, 21
@@ -4574,29 +4934,35 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "machinegod"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_MACHINE_GOD
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 6
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 3000
+			cnRace(rc) = "machinegod"
+			cRaceId(rc) = DB_RACE_MACHINE_GOD
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 6
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 3000
 			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(19, 10)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 150
+			cPic(rc) = xy2pic(19, 10)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 200
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 15
 			skillinit SKILL_ATTR_CON, rc, 14
 			skillinit SKILL_ATTR_DEX, rc, 11
@@ -4636,28 +5002,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "undeadgod"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_UNDEAD_GOD
-			cdata(CDATA_MELEE_STYLE, rc) = 6
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(300) + 300)
-			cdata(CDATA_HEIGHT, rc) = 1000
+			cnRace(rc) = "undeadgod"
+			cRaceId(rc) = DB_RACE_UNDEAD_GOD
+			cMeleeStyle(rc) = 6
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(300) + 300)
+			cHeight(rc) = 1000
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(20, 10)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(20, 10)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 150
 			skillinit SKILL_ATTR_MANA, rc, 500
 			skillinit SKILL_ATTR_STR, rc, 10
 			skillinit SKILL_ATTR_CON, rc, 13
 			skillinit SKILL_ATTR_DEX, rc, 14
@@ -4697,29 +5069,35 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "machine"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_MACHINE
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 6
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 170
+			cnRace(rc) = "machine"
+			cRaceId(rc) = DB_RACE_MACHINE
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 6
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 170
 			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(6, 8)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 150
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(6, 8)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 7
 			skillinit SKILL_ATTR_CON, rc, 10
 			skillinit SKILL_ATTR_DEX, rc, 7
@@ -4761,28 +5139,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "wisp"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_WISP
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 4
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 40
+			cnRace(rc) = "wisp"
+			cRaceId(rc) = DB_RACE_WISP
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 4
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 40
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(8, 8)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 150
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(8, 8)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 150
 			skillinit SKILL_ATTR_MANA, rc, 150
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 10
 			skillinit SKILL_ATTR_DEX, rc, 10
@@ -4823,28 +5207,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "bird"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_BIRD
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 40
+			cnRace(rc) = "bird"
+			cRaceId(rc) = DB_RACE_BIRD
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 40
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(10, 8)
-			cdata(CDATA_DV_FIX, rc) = 200
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(10, 8)
+			cDvFix(rc) = 200
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 80
 			skillinit SKILL_ATTR_MANA, rc, 80
 			skillinit SKILL_ATTR_STR, rc, 5
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 10
@@ -4885,28 +5275,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "seamonster"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SEA_MONSTER
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 180
+			cnRace(rc) = "seamonster"
+			cRaceId(rc) = DB_RACE_SEA_MONSTER
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 180
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(32, 2)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(32, 2)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 10
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -4947,28 +5343,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "catsister"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_CAT_SISTER
-			cdata(CDATA_MELEE_STYLE, rc) = 1
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (10 + rnd(4))
-			cdata(CDATA_HEIGHT, rc) = 140
+			cnRace(rc) = "catsister"
+			cRaceId(rc) = DB_RACE_CAT_SISTER
+			cMeleeStyle(rc) = 1
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (10 + rnd(4))
+			cHeight(rc) = 140
 			if ( rnd(100) < 0 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(24, 10)
-			cdata(CDATA_DV_FIX, rc) = 200
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(24, 10)
+			cDvFix(rc) = 200
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 30
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 7
 			skillinit SKILL_ATTR_CON, rc, 5
 			skillinit SKILL_ATTR_DEX, rc, 13
@@ -5010,31 +5412,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 1
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "mutant"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_MUTANT
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 1)
-			cdata(CDATA_HEIGHT, rc) = 180
+			cnRace(rc) = "mutant"
+			cRaceId(rc) = DB_RACE_MUTANT
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 1)
+			cHeight(rc) = 180
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(3, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(4, 0)
+			cPic(rc) = xy2pic(3, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(4, 0)
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 100
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 9
 			skillinit SKILL_ATTR_CON, rc, 5
 			skillinit SKILL_ATTR_DEX, rc, 5
@@ -5075,28 +5483,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "yeek"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_YEEK
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(30) + 15)
-			cdata(CDATA_HEIGHT, rc) = 90
+			cnRace(rc) = "yeek"
+			cRaceId(rc) = DB_RACE_YEEK
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(30) + 15)
+			cHeight(rc) = 90
 			if ( rnd(100) < 50 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(15, 11)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(15, 11)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 80
 			skillinit SKILL_ATTR_MANA, rc, 90
 			skillinit SKILL_ATTR_STR, rc, 4
 			skillinit SKILL_ATTR_CON, rc, 7
 			skillinit SKILL_ATTR_DEX, rc, 6
@@ -5137,28 +5551,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "yith"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_YITH
-			cdata(CDATA_MELEE_STYLE, rc) = 6
-			cdata(CDATA_CAST_STYLE, rc) = 3
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 1000)
-			cdata(CDATA_HEIGHT, rc) = 170
+			cnRace(rc) = "yith"
+			cRaceId(rc) = DB_RACE_YITH
+			cMeleeStyle(rc) = 6
+			cCastStyle(rc) = 3
+			cAge(rc) = gYear - (rnd(200) + 1000)
+			cHeight(rc) = 170
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(0, 13)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(0, 13)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 150
 			skillinit SKILL_ATTR_MANA, rc, 200
 			skillinit SKILL_ATTR_STR, rc, 13
 			skillinit SKILL_ATTR_CON, rc, 14
 			skillinit SKILL_ATTR_DEX, rc, 9
@@ -5200,31 +5620,37 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "servant"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_SERVANT
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(200) + 100)
-			cdata(CDATA_HEIGHT, rc) = 165
+			cnRace(rc) = "servant"
+			cRaceId(rc) = DB_RACE_SERVANT
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(200) + 100)
+			cHeight(rc) = 165
 			if ( rnd(100) < 52 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(1, 0)
-			if ( cdata(CDATA_SEX, rc) == 1 ) {
-				cdata(CDATA_PIC, rc) = xy2pic(2, 0)
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			cPic(rc) = xy2pic(1, 0)
+			if ( cSex(rc) == 1 ) {
+				cPic(rc) = xy2pic(2, 0)
+			}
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 90
 			skillinit SKILL_ATTR_MANA, rc, 150
 			skillinit SKILL_ATTR_STR, rc, 6
 			skillinit SKILL_ATTR_CON, rc, 6
 			skillinit SKILL_ATTR_DEX, rc, 6
@@ -5269,28 +5695,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "horse"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_HORSE
-			cdata(CDATA_MELEE_STYLE, rc) = 3
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 250
+			cnRace(rc) = "horse"
+			cRaceId(rc) = DB_RACE_HORSE
+			cMeleeStyle(rc) = 3
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 250
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(31, 7)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 100
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(31, 7)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 150
 			skillinit SKILL_ATTR_MANA, rc, 50
 			skillinit SKILL_ATTR_STR, rc, 9
 			skillinit SKILL_ATTR_CON, rc, 8
 			skillinit SKILL_ATTR_DEX, rc, 4
@@ -5331,28 +5763,34 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "god"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_GOD
-			cdata(CDATA_MELEE_STYLE, rc) = 0
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - 999999
-			cdata(CDATA_HEIGHT, rc) = 180
+			cnRace(rc) = "god"
+			cRaceId(rc) = DB_RACE_GOD
+			cMeleeStyle(rc) = 0
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - 999999
+			cHeight(rc) = 180
 			if ( rnd(100) < 50 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(30, 11)
-			cdata(CDATA_DV_FIX, rc) = 300
-			cdata(CDATA_PV_FIX, rc) = 200
+			cPic(rc) = xy2pic(30, 11)
+			cDvFix(rc) = 300
+			cPvFix(rc) = 200
 			skillinit SKILL_ATTR_LIFE, rc, 200
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 18
 			skillinit SKILL_ATTR_CON, rc, 18
 			skillinit SKILL_ATTR_DEX, rc, 18
@@ -5411,35 +5849,41 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "quickling"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_QUICKLING
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 25
+			cnRace(rc) = "quickling"
+			cRaceId(rc) = DB_RACE_QUICKLING
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 25
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(17, 8)
-			sdata(SKILL_RES_MAGIC, rc) = 500
+			cPic(rc) = xy2pic(17, 8)
+			sResMagic(rc) = 500
 			if ( 0 != 0 ) {
 				sdata(rsres0, rc) = 500
 			}
 			if ( 0 != 0 ) {
 				sdata(rsres0, rc) = 500
 			}
-			cdata(CDATA_DV_FIX, rc) = 550
-			cdata(CDATA_PV_FIX, rc) = 100
+			cDvFix(rc) = 550
+			cPvFix(rc) = 100
 			skillinit SKILL_ATTR_LIFE, rc, 3
 			skillinit SKILL_ATTR_MANA, rc, 40
 			skillinit SKILL_ATTR_STR, rc, 2
 			skillinit SKILL_ATTR_CON, rc, 4
 			skillinit SKILL_ATTR_DEX, rc, 18
@@ -5480,35 +5924,41 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "metal"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_METAL
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 0
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 12
+			cnRace(rc) = "metal"
+			cRaceId(rc) = DB_RACE_METAL
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 0
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 12
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(21, 7)
-			sdata(SKILL_RES_MAGIC, rc) = 800
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
+			}
+			cPic(rc) = xy2pic(21, 7)
+			sResMagic(rc) = 800
 			if ( 0 != 0 ) {
 				sdata(rsres0, rc) = 800
 			}
 			if ( 0 != 0 ) {
 				sdata(rsres0, rc) = 800
 			}
-			cdata(CDATA_DV_FIX, rc) = 150
-			cdata(CDATA_PV_FIX, rc) = 1000
+			cDvFix(rc) = 150
+			cPvFix(rc) = 1000
 			skillinit SKILL_ATTR_LIFE, rc, 1
 			skillinit SKILL_ATTR_MANA, rc, 100
 			skillinit SKILL_ATTR_STR, rc, 4
 			skillinit SKILL_ATTR_CON, rc, 1
 			skillinit SKILL_ATTR_DEX, rc, 3
@@ -5549,29 +5999,35 @@
 		}
 		if ( dbmode == DBMODE_REF_PLAYABLE ) {
 			return 0
 		}
 		if ( dbmode == DBMODE_SET ) {
-			cdatan(CDATAN_RACE, rc) = "vehicle"
-			cdata(CDATA_RACE_ID, rc) = DB_RACE_BEHICLE
-			cdata(CDATA_MELEE_STYLE, rc) = 10
-			cdata(CDATA_CAST_STYLE, rc) = 6
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR) - (rnd(10) + 10)
-			cdata(CDATA_HEIGHT, rc) = 240
+			cnRace(rc) = "vehicle"
+			cRaceId(rc) = DB_RACE_BEHICLE
+			cMeleeStyle(rc) = 10
+			cCastStyle(rc) = 6
+			cAge(rc) = gYear - (rnd(10) + 10)
+			cHeight(rc) = 240
 			cbitmod CHARA_BIT_STONE_BLOOD, rc, TRUE
 			if ( rnd(100) < 53 ) {
-				cdata(CDATA_SEX, rc) = 0
+				cSex(rc) = 0
 			}
 			else {
-				cdata(CDATA_SEX, rc) = 1
+				cSex(rc) = 1
 			}
 			if ( mode == MODELIST_CHARA_CREATION ) {
-				cdata(CDATA_SEX, rc) = cmsex
+				cSex(rc) = cmsex
+			}
+			if ( babysex == 10 ) {
+				cSex(rc) = 0
+			}
+			if ( babysex == 11 ) {
+				cSex(rc) = 1
 			}
-			cdata(CDATA_PIC, rc) = xy2pic(9, 14)
-			cdata(CDATA_DV_FIX, rc) = 100
-			cdata(CDATA_PV_FIX, rc) = 150
+			cPic(rc) = xy2pic(9, 14)
+			cDvFix(rc) = 100
+			cPvFix(rc) = 150
 			skillinit SKILL_ATTR_LIFE, rc, 120
 			skillinit SKILL_ATTR_MANA, rc, 60
 			skillinit SKILL_ATTR_STR, rc, 11
 			skillinit SKILL_ATTR_CON, rc, 13
 			skillinit SKILL_ATTR_DEX, rc, 4
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/event.hsp ../2.14-borscht/event.hsp
--- ../2.13-borscht/event.hsp	2022-06-26 12:14:16.300876600 -0700
+++ ../2.14-borscht/event.hsp	2022-09-18 12:37:01.180912200 -0700
@@ -31,10 +31,50 @@
 			id = 31
 			goto *random_eventProc
 		}
 	}
 	if ( breakfast < 100 & kitune != 10 ) {
+		child = 0
+		repeat 245
+			if ( cbit(1034, cnt) != TRUE ) {
+				continue
+			}
+			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+				continue
+			}
+			if ( cdata(CDATA_CONDITION_SLEEP, cnt) > 0 ) {
+				continue
+			}
+			if ( cdata(CDATA_CONDITION_DIM, cnt) >= 60 ) {
+				continue
+			}
+			if ( rnd(100) > 10 ) {
+				continue
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-4) ) {
+				if ( rnd(10) > 7 ) {
+					continue
+				}
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-3) ) {
+				if ( rnd(10) > 5 ) {
+					continue
+				}
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-2) ) {
+				if ( rnd(10) > 3 ) {
+					continue
+				}
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-1) ) {
+				if ( rnd(10) > 3 ) {
+					continue
+				}
+			}
+			child = cnt
+			break
+		loop
 		kitune = 0
 		if ( mode == MODELIST_TXT_ADV ) {
 			if ( cdata(CDATA_GOD, CHARA_PLAYER) != GOD_EYTH ) {
 				if ( rnd(12) == 0 ) {
 					id = 18
@@ -101,10 +141,15 @@
 					if ( rnd(60) == 0 ) {
 						id = 24
 					}
 				}
 			}
+			if ( child > 0 ) {
+				if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-5) ) {
+					id = 36
+				}
+			}
 			if ( rnd(200) == 0 ) {
 				id = 20
 			}
 			if ( rnd(250) == 0 ) {
 				if ( inv_getfreeid(CHARA_PLAYER) != (-1) ) {
@@ -132,10 +177,65 @@
 		if ( gdata(GDATA_AREA) == AREA_VALM ) {
 			if ( gdata(GDATA_LEVEL) == 3 ) {
 				return
 			}
 		}
+		if ( child > 0 ) {
+			kaiwa = 0
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-5) ) {
+				id = 36
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-4) ) {
+				id = 37
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-3) ) {
+				if ( cdata(CDATA_PERSONALITY, child) > 2 ) {
+					cdata(CDATA_PERSONALITY, child) = 0
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 0 ) {
+					id = 38
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 1 ) {
+					id = 39
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 2 ) {
+					id = 40
+				}
+				cdata(CDATA_PERSONALITY, child)++
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-2) ) {
+				if ( cdata(CDATA_PERSONALITY, child) > 2 ) {
+					cdata(CDATA_PERSONALITY, child) = 0
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 0 ) {
+					id = 41
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 1 ) {
+					id = 42
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 2 ) {
+					id = 43
+				}
+				cdata(CDATA_PERSONALITY, child)++
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, child) == (-1) ) {
+				if ( cdata(CDATA_PERSONALITY, child) > 2 ) {
+					cdata(CDATA_PERSONALITY, child) = 0
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 0 ) {
+					id = 44
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 1 ) {
+					id = 45
+				}
+				if ( cdata(CDATA_PERSONALITY, child) == 2 ) {
+					id = 46
+				}
+				cdata(CDATA_PERSONALITY, child)++
+			}
+			goto *random_eventProc
+		}
 		if ( rnd(30) == 0 ) {
 			id = 17
 		}
 		if ( rnd(25) == 0 ) {
 			id = 16
@@ -390,11 +490,11 @@
 		}
 		snd SOUNDLIST_CHAT
 		await 400
 		snd SOUNDLIST_CHAT
 		customtalk tc, DBMODE_FLAVOR_BREAKFAST
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			if ( jp ) {
 				txtef COLOR_SKY_BLUE
 				if ( jp ) {
 					txt name(tc) + "は一仕事やりとげた顔をしている。", name(tc) + "はなんだかそわそわしている。", "「早く来ないとなくなる" + _yo(3) + "」", "「一日の元気は朝食から" + _da(3) + "」"
@@ -539,11 +639,11 @@
 		cre1 = 176
 		snd SOUNDLIST_CHAT
 		await 400
 		snd SOUNDLIST_CHAT
 		customtalk tc, DBMODE_FLAVOR_CREATE
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			if ( jp ) {
 				txtef COLOR_SKY_BLUE
 				if ( jp ) {
 					txt name(tc) + "は一仕事やりとげた顔をしている。", name(tc) + "は誇らしげにお手製の品を取り出した。", "「割と自信作" + _dana(3) + "」", "「どやぁ」"
@@ -717,11 +817,11 @@
 		cre1 = 177
 		snd SOUNDLIST_CHAT
 		await 400
 		snd SOUNDLIST_CHAT
 		customtalk tc, DBMODE_FLAVOR_CREATE
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			if ( jp ) {
 				txtef COLOR_SKY_BLUE
 				if ( jp ) {
 					txt name(tc) + "は怪我を隠している。", "「頑張って作った" + _yo(3) + "」", "「家計の足しにでも…」", "「ちょっと不恰好だけど…」"
@@ -943,10 +1043,766 @@
 		listmax++
 		gosub *re_select
 		goto *random_eventProc_SWEND1
 		_switch_sw++
 	}
+	if ( _switch_val == 36 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		item_find ITEM_ID_BOTTLE_MILK, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
+		if ( stat != (-1) ) {
+			ci = stat
+			cibk = ci
+			milk = inv(INV_ITEM_NUM, cibk)
+		}
+		else {
+			milk = 0
+		}
+		snd 302
+		s = lang("原因は何だ？", "Cause Unknown")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "が突然泣き始めた！", cdatan(CDATAN_NAME, child) + " suddenly started crying out loud!")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("そっとしておく", "(Leave alone)")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("あやす", "(Soothe)")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("一緒に泣く", "(Cry together)")
+		listmax++
+		list(0, listmax) = 4
+		listn(0, listmax) = lang("乳を与える（所持数" + milk + "）", "(Give a milk :" + milk + " possession)")
+		listmax++
+		seikai = 1
+		if ( cdata(CDATA_POWER_GAUGE, child) <= 0 ) {
+			seikai = 2
+		}
+		if ( cdata(CDATA_HP, child) < cdata(CDATA_MAX_HP, child) * 9 / 10 ) {
+			seikai = 3
+		}
+		if ( cdata(CDATA_HUNGER, child) <= 5000 ) {
+			seikai = 4
+		}
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( seikai != 1 ) {
+				txtef COLOR_RED
+				txt lang(cdatan(CDATAN_NAME, child) + "は泣き疲れるまで泣き続けた…。", cdatan(CDATAN_NAME, child) + " kept crying until he was tired of crying...")
+				modimp2 child, -10
+				snd SOUNDLIST_GET1
+				goto *random_eventProc_SWEND1
+			}
+			if ( seikai == 1 ) {
+				txtef COLOR_GREEN
+				txt lang(cdatan(CDATAN_NAME, child) + "が突然泣き止んだ。結局何だったのだろう…？", cdatan(CDATAN_NAME, child) + " suddenly stopped crying. What was it...?")
+				modimp2 child, 10
+				snd SOUNDLIST_GET1
+				goto *random_eventProc_SWEND1
+			}
+		}
+		if ( rtval == 2 ) {
+			if ( seikai != 2 ) {
+				txtef COLOR_RED
+				txt lang(cdatan(CDATAN_NAME, child) + "を抱っこしようが子守歌を歌おうが、全然泣き止まなくて困った…。", "Hugs and lullaby songs had little effect on " + cdatan(CDATAN_NAME, child) + "...")
+				modimp2 child, -10
+				snd SOUNDLIST_GET1
+				goto *random_eventProc_SWEND1
+			}
+			if ( seikai == 2 ) {
+				txtef COLOR_GREEN
+				txt lang(cdatan(CDATAN_NAME, child) + "をあやし始めるとスッと泣き止んだ。…もう笑ってる！", cdatan(CDATAN_NAME, child) + " stopped crying when comforted!")
+				modimp child, 10
+				snd SOUNDLIST_GET1
+				goto *random_eventProc_SWEND1
+			}
+		}
+		if ( rtval == 3 ) {
+			if ( seikai != 3 ) {
+				txtef COLOR_RED
+				txt lang(cdatan(CDATAN_NAME, child) + "は目を見開いて呆然としている。", cdatan(CDATAN_NAME, child) + " is dumbfounded...")
+				modimp child, -10
+				snd SOUNDLIST_GET1
+				goto *random_eventProc_SWEND1
+			}
+			if ( seikai == 3 ) {
+				txtef COLOR_GREEN
+				txt lang(cdatan(CDATAN_NAME, child) + "はあなたをぺちぺち叩き始めた。…慰めているつもりなのだろうか？", cdatan(CDATAN_NAME, child) + " started stroking you..." + cdatan(CDATAN_NAME, child) + " seems to be trying to comfort you.")
+				modimp child, 10
+				snd SOUNDLIST_GET1
+				goto *random_eventProc_SWEND1
+			}
+		}
+		if ( rtval == 4 ) {
+			if ( milk == 0 ) {
+				txtef COLOR_RED
+				txt lang("自前でなんとかしようとしたが、そんなに都合よく乳は出なかった。", "You tried to get your milk out, but it didn't work.")
+				modimp child, -10
+				snd SOUNDLIST_GET1
+				goto *random_eventProc_SWEND1
+			}
+			inv(INV_ITEM_NUM, cibk)--
+			cell_refresh inv(INV_ITEM_X, cibk), inv(INV_ITEM_Y, cibk)
+			cdata(CDATA_HUNGER, child) += 1000
+			gosub *label_4102
+			snd SOUNDLIST_DRINK1
+			if ( seikai != 4 ) {
+				txtef COLOR_RED
+				txt lang("ちょっと飲んだが、特に乳がほしいわけではなかったようだ。", cdatan(CDATAN_NAME, child) + " drank some milk, but didn't seem to want it.")
+				goto *random_eventProc_SWEND1
+			}
+			if ( seikai == 4 ) {
+				txtef COLOR_GREEN
+				txt lang(cdatan(CDATAN_NAME, child) + "は乳を飲んで急に大人しくなった。…小さくげっぷしている。", cdatan(CDATAN_NAME, child) + " drank the milk and suddenly calmed down and let out a small burp.")
+				modimp tc, 10
+				modimp2 child, 10
+				goto *random_eventProc_SWEND1
+			}
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 37 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd 302
+		s = lang("子供の自己表現", "Child Self-Expression")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "が突然座り込んで、駄々をこね始めた！", cdatan(CDATAN_NAME, child) + " suddenly sat down and started whining!")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("放置する", "(Leave alone)")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("話を聞く", "(Listen to feelings)")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("そのまま引きずっていく", "(Forcibly dragging)")
+		listmax++
+		list(0, listmax) = 4
+		listn(0, listmax) = lang("お小遣い500goldを与える", "(Give 500 gold pieces)")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			txt lang(cdatan(CDATAN_NAME, child) + "はしばらく転げ回っていたが、無駄だと判断して動きを止めた。", cdatan(CDATAN_NAME, child) + " rolled around for a while, but decided it was useless and calmed down.")
+			modimp child, -5
+			modimp2 child, 5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			txtef COLOR_GREEN
+			txt lang(cdatan(CDATAN_NAME, child) + "は乏しい語彙力で気持ちを懸命に伝えようとしている…。", cdatan(CDATAN_NAME, child) + " tries hard to convey feelings with limited vocabulary...")
+			modimp child, 5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			txtef COLOR_GREEN
+			txt lang(cdatan(CDATAN_NAME, child) + "は泣きべそをかきながらも逆にあなたを引きずろうと頑張っている…。", cdatan(CDATAN_NAME, child) + " is crying and trying to drag you...")
+			modimp2 child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 4 ) {
+			if ( cdata(CDATA_GOLD, CHARA_PLAYER) < 500 ) {
+				txt lang(cdatan(CDATAN_NAME, child) + "はあなたの財布の中身が寂しいことに気づき、丁寧に断った。", cdatan(CDATAN_NAME, child) + " notices that you don't have much money and politely declines.")
+				modimp2 child, -5
+				snd SOUNDLIST_GET1
+				goto *random_eventProc_SWEND1
+			}
+			snd SOUNDLIST_PAYGOLD1
+			cdata(CDATA_GOLD, CHARA_PLAYER) -= 500
+			cdata(CDATA_GOLD, tc) += 500
+			txt lang(cdatan(CDATAN_NAME, child) + "は喜んで金貨を数え始めた！味を占めなければいいが…。", cdatan(CDATAN_NAME, child) + " happily began to count the coins!")
+			modimp child, 5
+			modimp2 child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 38 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		bvar = sdata(SKILL_ATTR_STR, child)
+		pvar = 10
+		if ( sdata(SKILL_ATTR_CON, child) > bvar ) {
+			pvar = 11
+			bvar = sdata(SKILL_ATTR_CON, child)
+		}
+		if ( sdata(SKILL_ATTR_DEX, child) > bvar ) {
+			pvar = 12
+			bvar = sdata(SKILL_ATTR_DEX, child)
+		}
+		if ( sdata(SKILL_ATTR_PER, child) > bvar ) {
+			pvar = 13
+			bvar = sdata(SKILL_ATTR_PER, child)
+		}
+		if ( sdata(SKILL_ATTR_LER, child) > bvar ) {
+			pvar = 14
+			bvar = sdata(SKILL_ATTR_LER, child)
+		}
+		if ( sdata(SKILL_ATTR_WIL, child) > bvar ) {
+			pvar = 15
+			bvar = sdata(SKILL_ATTR_WIL, child)
+		}
+		if ( sdata(SKILL_ATTR_MAG, child) > bvar ) {
+			pvar = 16
+			bvar = sdata(SKILL_ATTR_MAG, child)
+		}
+		if ( sdata(SKILL_ATTR_CHA, child) > bvar ) {
+			pvar = 17
+		}
+		bvar = 0
+		if ( pvar == 10 ) {
+			yume = lang("世界最強", "a world's strongest")
+		}
+		if ( pvar == 11 ) {
+			yume = lang("機関車", "a locomotive")
+		}
+		if ( pvar == 12 ) {
+			yume = lang("サブパイロット", "a co-pilot")
+		}
+		if ( pvar == 13 ) {
+			yume = lang("サンタさん", "Santa Claus")
+		}
+		if ( pvar == 14 ) {
+			yume = lang("発明家", "an inventor")
+		}
+		if ( pvar == 15 ) {
+			yume = lang("ヒーロー", "a hero")
+		}
+		if ( pvar == 16 ) {
+			yume = lang("お花屋さん", "a florist")
+		}
+		if ( pvar == 17 ) {
+			yume = lang("カッパ巻き", "a california roll")
+		}
+		s = lang("将来の夢", "Dream for the Future")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "は将来、" + yume + "になりたいと言っている…。", cdatan(CDATAN_NAME, child) + " seems to want to be " + yume + " in the future.")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("素敵な夢だね", "Nice dream...")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("真面目に考えようね", "Please reconsider.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("なれるように勉強しようね", "Let's study so that you can!")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「へへへ…」", cdatan(CDATAN_NAME, child) + "「" + _ore(3) + "の夢を真似してもいいよ！」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Hehehe..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("I don't mind if you imitate me!")
+			}
+			modimp child, 5
+			modimp2 child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「真面目に考えてる" + _yo(3) + "！」", cdatan(CDATAN_NAME, child) + "「ダメ" + _ka(3) + "？」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I'm serious!"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Is it no good?")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「じゃあやめとく」", cdatan(CDATAN_NAME, child) + "「ええ〜？」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I'll stop then"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Huh?")
+			}
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 39 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		bvar = sdata(SKILL_ATTR_STR, child)
+		pvar = 10
+		if ( sdata(SKILL_ATTR_CON, child) > bvar ) {
+			pvar = 11
+			bvar = sdata(SKILL_ATTR_CON, child)
+		}
+		if ( sdata(SKILL_ATTR_DEX, child) > bvar ) {
+			pvar = 12
+			bvar = sdata(SKILL_ATTR_DEX, child)
+		}
+		if ( sdata(SKILL_ATTR_PER, child) > bvar ) {
+			pvar = 13
+			bvar = sdata(SKILL_ATTR_PER, child)
+		}
+		if ( sdata(SKILL_ATTR_LER, child) > bvar ) {
+			pvar = 14
+			bvar = sdata(SKILL_ATTR_LER, child)
+		}
+		if ( sdata(SKILL_ATTR_WIL, child) > bvar ) {
+			pvar = 15
+			bvar = sdata(SKILL_ATTR_WIL, child)
+		}
+		if ( sdata(SKILL_ATTR_MAG, child) > bvar ) {
+			pvar = 16
+			bvar = sdata(SKILL_ATTR_MAG, child)
+		}
+		if ( sdata(SKILL_ATTR_CHA, child) > bvar ) {
+			pvar = 17
+		}
+		bvar = 0
+		if ( pvar == 10 ) {
+			yume = lang("ツルツルな石ころ", "the smooth stone")
+		}
+		if ( pvar == 11 ) {
+			yume = lang("何かのネジ", "the screw of something")
+		}
+		if ( pvar == 12 ) {
+			yume = lang("セミの抜け殻", "the cicada shell")
+		}
+		if ( pvar == 13 ) {
+			yume = lang("鮮やかな落ち葉", "the vivid leave")
+		}
+		if ( pvar == 14 ) {
+			yume = lang("謎の綿毛", "the mystery fluff")
+		}
+		if ( pvar == 15 ) {
+			yume = lang("抜け羽根", "the fallen feather")
+		}
+		if ( pvar == 16 ) {
+			yume = lang("むしった花びら", "the small petal")
+		}
+		if ( pvar == 17 ) {
+			yume = lang("ダンゴムシ", "the wood lousel")
+		}
+		s = lang("お宝発見", "Treasure Discovery")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "は満面の笑みで" + yume + "を差し出してきた…。", cdatan(CDATAN_NAME, child) + " handed you " + yume + " with a big smile...")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("コレクションに加える", "I'll add it to my collection!")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("受け取ってこっそり捨てる", "(Receive and secretly throw away)")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("ゴミ拾ってないで勉強しろ", "Study without picking up junk!!")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「あげないよ！？」", cdatan(CDATAN_NAME, child) + "「見せるだけ！見せるだけだから！」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I won't give it to you!?"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Just show! I just want to show you!")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「大事にしてね♪」", cdatan(CDATAN_NAME, child) + "「見つけるの大変だった" + _nda(3) + "！」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("You don't throw it away, do you?"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("It was hard to find...")
+			}
+			modimp child, 5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「ごめんなさい…」", cdatan(CDATAN_NAME, child) + "「ゴミじゃないのに…」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I am sorry..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("It's not junk...")
+			}
+			modimp2 child, 5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 40 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		s = lang("自分のルーツ", "Roots")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "は、自分がどこから来たのかを知りたがっている…。", cdatan(CDATAN_NAME, child) + " wants to know where a baby came from...")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("遺伝子を組み合わせて産まれたんだよ", "It is produced by a combination of genes.")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("コウノトリさんが運んできた", "The white stork brings it.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("橋の下から拾ってきた", "It can be picked up in a cabbage patch.")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「遺伝子…？？？」", cdatan(CDATAN_NAME, child) + "「意味わからない！」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Gene...???"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("I do not know the meaning!")
+			}
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「コウノトリさんは" + _ore(3) + "をどこから運んで来たの" + _kana(3) + "」", cdatan(CDATAN_NAME, child) + "「絶対ウソだ〜」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Where does the white stork bring the baby from?"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("It's a lie!")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「ショック！」", cdatan(CDATAN_NAME, child) + "「" + _ore(3) + "、この家の子じゃない" + _noka(3) + "！？」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I am shocked!"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Was I also a cabbage!?")
+			}
+			modimp2 child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 41 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		s = lang("脳内バトル", "Battle in the brain")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "は、空想上の敵と戦っているようだ…。", cdatan(CDATAN_NAME, child) + " seems to be fighting an imaginary enemy...")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("まぁイメトレの一種か…", "Image training?")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("もっと現実世界でがんばらなくちゃ", "Try harder in the real world.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("するなら戦いの勉強をするべき", "If you do, you should study fighting.")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「とうっ！」", cdatan(CDATAN_NAME, child) + "「なかなかやるな！」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Huh!"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("This guy is a formidable enemy!")
+			}
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「いいところだったのに…」", cdatan(CDATAN_NAME, child) + "「し、しかし…」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Do not disturb..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("But...")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「つまらないからイヤ」", cdatan(CDATAN_NAME, child) + "「そういうのは戦術スキルの勉強だけで十分！」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I hate it because it's boring!"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Just studying tactical skills is enough!")
+			}
+			modimp2 child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 42 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		s = lang("この世はキャンバス", "This world is canvas")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "は、黙々と地面に絵を描いている…。", cdatan(CDATAN_NAME, child) + " silently draws on the ground...")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("いいセンスだ", "You're pretty good.")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("最後はちゃんと消しておくように", "Erase it properly at the end.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("本格的な絵の勉強してみる？", "Do you want to study painting?")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「恥ずかしい" + _na(3) + "」", cdatan(CDATAN_NAME, child) + "「勝手に見ないでー」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I'm embarrassed..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Don't look at this...")
+			}
+			modimp child, 5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「そんなのわかってる" + _yo(3) + "」", cdatan(CDATAN_NAME, child) + "「じゃあもう今消す！」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I know that!"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("I'll delete it now!")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「勉強？やめとく」", cdatan(CDATAN_NAME, child) + "「" + _ore(3) + "は上手な絵が描きたいわけじゃない" + _nda(3) + "」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I will refrain from studying..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("I don't want to draw a good picture...")
+			}
+			modimp2 child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 43 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		s = lang("勉強の意味", "Meaning of Study")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "が、どうして子供は勉強しないといけないのか問い詰めてきた！", cdatan(CDATAN_NAME, child) + " asked why children should study!")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("将来の選択肢を増やすため", "Studying increases future options.")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("大人になっても仕事の勉強が続く", "Even when you grow up, you need to study for a job.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("子供が馬鹿だと親が恥ずかしいから", "Parents are embarrassed that their children are stupid.")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「意味がよくわからない…」", cdatan(CDATAN_NAME, child) + "「" + _ore(3) + "はどうせ冒険者になるから関係ない" + _daro(3) + "」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I don't know what you mean..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("I'm going to be an adventurer anyway, so it doesn't matter!")
+			}
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「" + _ore(3) + "、大人になったら勉強しなくていいと思ってい" + _ta(3) + "」", cdatan(CDATAN_NAME, child) + "「今のうちしか学べないことがあるの" + _ka(3) + "…」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I thought I wouldn't have to study when I grew up..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Does that mean that there are things I can learn only now?")
+			}
+			modimp2 child, 5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「大人っていつもそう" + _dana(3) + "…！子供たちのことなんだと思ってる" + _noka(3) + "！？」", cdatan(CDATAN_NAME, child) + "「そんな答えしか出せないことは恥ずかしくない" + _noka(3) + "？」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("You think of children as decorations?"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Isn't it embarrassing that you can only answer like that?")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 44 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		s = lang("自己顕示", "Self Revelation")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "は、自分の異名を自分で考えているようだ…。", cdatan(CDATAN_NAME, child) + " seems to be thinking of own aka...")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("呼ばれ方より先に自分を変えよう", "Change yourself before your aka.")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("一緒に考えてあげる", "I'll think about it with you.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("勉強して語彙力つけなさい", "Study hard and improve your vocabulary.")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「意味不明」", cdatan(CDATAN_NAME, child) + "「決めポーズの練習するからあっち行ってて" + _kure(3) + "」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("I don't know what you mean..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("I'll practice poses, so go over there!")
+			}
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「センス古臭いから遠慮しておく" + _yo(3) + "」", cdatan(CDATAN_NAME, child) + "「鬱陶しいからあっち行って！」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Your taste is so old-fashioned that I don't need it..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Annoying!")
+			}
+			modimp2 child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「勉強、勉強ってうるさい" + _yo(3) + "」", cdatan(CDATAN_NAME, child) + "「お説教できるほどの語彙力がある" + _noka(3) + "？」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Study, study, study! It's noisy!!"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Do you have enough vocabulary to preach?")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 45 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		s = lang("自意識", "Self Awareness")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "は、自分の格好が周りと比べてダサいのではないかと気にしている…。", cdatan(CDATAN_NAME, child) + " worried that own clothes aren't as good as those arounds...")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("そんなに変？", "Is it so weird?")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("個性的でいいと思う", "I think it's good to be individual.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("オシャレの勉強する？", "Do you want to study fashion?")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「もういい…」", cdatan(CDATAN_NAME, child) + "「相談する相手を間違えた" + _kana(3) + "」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("You don't know..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("I took the wrong person for advice!")
+			}
+			modimp2 child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「個性的じゃ馬鹿にされる" + _daro(3) + "！」", cdatan(CDATAN_NAME, child) + "「みんなと違いすぎるのは嫌" + _da(3) + "…」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("There is a risk in the individual appearance!"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("I don't like being too different from everyone...")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「" + _ore(3) + "にできる" + _kana(3) + "…？」", cdatan(CDATAN_NAME, child) + "「そこまで言うならちょっとやってみてもいいかも」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Can I do it?"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("It might be a good idea to try it for a while...")
+			}
+			modimp child, 5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
+	if ( _switch_val == 46 | _switch_sw ) {
+		_switch_sw = 0
+		tc = child
+		snd SOUNDLIST_PORT
+		s = lang("マージナルマン", "Marginal Man")
+		file = "bg_re21"
+		buff = lang(cdatan(CDATAN_NAME, child) + "は、子供扱いしないでほしいと強く主張している！", cdatan(CDATAN_NAME, child) + " doesn't like being treated like a child by you...")
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("大人には相応の責任と義務が発生する", "Adults have responsibilities and obligations.")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("そんなこと言ってる間はまだまだ子供", "As long as you care about such things, you are still a child.")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("どうやら勉強が足りないようだな", "It seems that you haven't studied enough.")
+		listmax++
+		gosub *re_select
+		if ( rtval == 1 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「難しい言葉で誤魔化さないで…」", cdatan(CDATAN_NAME, child) + "「…大人もつらい" + _noka(3) + "？」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Don't mislead me with difficult words..."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("...Are adults struggling too?")
+			}
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 2 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「" + _ore(3) + "を馬鹿にしないで" + _kure(3) + "！」", cdatan(CDATAN_NAME, child) + "「真の大人は子供扱いされても涼しい顔していられるってこと？」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("Damn it!"), cdatan(CDATAN_NAME, child) + " " + cnvtalk("Does that mean that a true adult can keep a cool face even if he's treated like a child?")
+			}
+			modimp child, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		if ( rtval == 3 ) {
+			if ( jp ) {
+				txt cdatan(CDATAN_NAME, child) + "「マージナルマンとは複数の集団の境界上に存在する者のこと。特に心理学では子供と大人の狭間、すなわち青年のことを指す」", cdatan(CDATAN_NAME, child) + "「どこまで勉強したら" + _ore(3) + "を大人と認めてくれるの？」"
+			}
+			if ( en ) {
+				txt cdatan(CDATAN_NAME, child) + " " + cnvtalk("A marginal man is someone who exists on the border of multiple groups. Especially in psychology, it refers to the gap between children and adults, that is, adolescents."), cdatan(CDATAN_NAME, child) + " " + cnvtalk("How far do I have to study before you will recognize me as an adult?")
+			}
+			modimp child2, -5
+			snd SOUNDLIST_GET1
+			goto *random_eventProc_SWEND1
+		}
+		goto *random_eventProc_SWEND1
+		_switch_sw++
+	}
 	if ( _switch_val == 10 | _switch_sw ) {
 		_switch_sw = 0
 		s = lang("野営跡の発見", "Camping Site")
 		file = "bg_re3"
 		buff = lang("あなたは何者かが野営した跡を見つけた。辺りには食べ残しやがらくたが散らばっている。もしかしたら、何か役に立つものがあるかもしれない。", "You discover a camping site someone left behind. Chunks of leftovers and junks remain here. You may possibly find some usefull items.")
@@ -1333,11 +2189,11 @@
 		}
 		cdata(CDATA_POWER_GAUGE, tc) = 0
 		cdata(CDATA_POWER_GAUGE, CHARA_PLAYER) = 0
 		txt lang("あなたはふと目を覚ました。隣に" + cdatan(CDATAN_NAME, tc) + "が寝ている…。", "You wake up suddenly.")
 		customtalk tc, DBMODE_FLAVOR_NIGHT
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			txtef COLOR_SKY_BLUE
 			if ( jp ) {
 				txt "「むにゃ…もう食べられない…」", "「怖い夢、見ちゃった…」", "「お邪魔してます」", "…" + cdatan(CDATAN_NAME, tc) + "はすやすやと寝息をたてている。"
 			}
@@ -1481,11 +2337,11 @@
 			}
 			if ( rtval == 7 ) {
 				cdata(CDATA_POWER_GAUGE, CHARA_PLAYER) += rnd(20) + 5
 				cdata(CDATA_POWER_GAUGE, tc) += rnd(20) + 5
 				customtalk tc, DBMODE_FLAVOR_EX_REACT
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						txtef COLOR_YELLOW
 						txt "「なんて大胆な」", "「なっ…！？」", "…" + cdatan(CDATAN_NAME, tc) + "はすごく恥ずかしそうだ。"
 					}
@@ -1506,10 +2362,11 @@
 					}
 					await 800
 					gosub *screen_fade
 					redraw 0
 					gosub *sleep_draw_init
+					gain_iden 0, tc, 18
 					break
 				}
 			}
 			if ( cdata(CDATA_POWER_GAUGE, tc) >= 100 ) {
 				if ( cdata(CDATA_POWER_GAUGE, CHARA_PLAYER) >= 100 ) {
@@ -1527,14 +2384,14 @@
 				snd SOUNDLIST_ATK_FIRE
 				flt
 				itemcreate -1, ITEM_ID_BLOOD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 				inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, tc)
 				customtalk tc, DBMODE_FLAVOR_LIMIT
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					customtalk tc, DBMODE_FLAVOR_RIDE_ON_PC
-					gosub *convert_word
+					gosub *label_0416
 				}
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						if ( cdata(CDATA_MASTER_SERVANT2, tc) < 5 ) {
 							txt cdatan(CDATAN_NAME, tc) + "はあなたに抱きついて目を閉じた…。"
@@ -1546,10 +2403,12 @@
 				}
 				await 800
 				gosub *screen_fade
 				redraw 0
 				gosub *sleep_draw_init
+				gain_iden 0, tc, 18
+				gain_iden tc, 0, 18
 				break
 			}
 		loop
 		cdata(CDATA_POWER_GAUGE, tc) = 0
 		cdata(CDATA_POWER_GAUGE, CHARA_PLAYER) = 0
@@ -1632,11 +2491,11 @@
 		list(0, listmax) = 5
 		listn(0, listmax) = lang("撫でまわす", "(Rub)")
 		listmax++
 		repeat 20
 			customtalk tc, DBMODE_FLAVOR_MIDNIGHT
-			gosub *convert_word
+			gosub *label_0416
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( jp ) {
 					if ( cdata(CDATA_MASTER_SERVANT, tc) < 200 ) {
 						txt name(tc) + "は静かに泣いている…。", name(tc) + "は悲しそうな目でどこか遠くを見ている…。", name(tc) + "はあなたのやり方を非難している。", name(tc) + "はあなたを鋭く睨みつけている。"
 					}
@@ -1757,11 +2616,11 @@
 					txt lang("しかし、あなたは逃げ出す" + cdatan(CDATAN_NAME, tc) + "を捕まえると容赦なくベッドに引き戻した…。", "But you caught " + cdatan(CDATAN_NAME, tc) + " and pulled back to bed without mercy.")
 					modimp2 tc, 20
 					snd SOUNDLIST_GET1
 				}
 				customtalk CHARA_PLAYER, DBMODE_FLAVOR_LIMIT
-				gosub *convert_word
+				gosub *label_0416
 				await 800
 				gosub *screen_fade
 				redraw 0
 				gosub *sleep_draw_init
 				break
@@ -1770,11 +2629,11 @@
 				snd SOUNDLIST_ATK_FIRE
 				txtef COLOR_RED
 				txtmore
 				txt lang("あなたはこれ以上我慢できない！", "You can not stand any more!")
 				customtalk CHARA_PLAYER, DBMODE_FLAVOR_LIMIT
-				gosub *convert_word
+				gosub *label_0416
 				await 800
 				gosub *screen_fade
 				redraw 0
 				gosub *sleep_draw_init
 				break
@@ -2394,11 +3253,11 @@
 		txtef COLOR_YELLOW
 		txt lang(s + "が給料として振り込まれた。", "As a salary, " + s + " have been sent to your house.")
 		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
 	}
 	if ( gdata(GDATA_DAY) == 1 ) {
-		if ( cdata(CDATA_LEVEL, CHARA_PLAYER) >= 10 ) {
+		if ( gdata(GDATA_YEAR) > 517 ) {
 			autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
 			if ( gdata(GDATA_FLAG_TAX_PREPAID_BALANCE) <= 0 ) {
 				gdata(GDATA_FLAG_TAX_PREPAID_BALANCE) = 0
 				inv_getheader -1
 				p = -1
@@ -2459,11 +3318,11 @@
 				modkarma 0, (-30) * 2
 			}
 		}
 		else {
 			txtmore
-			txt lang("レベルが10に達していないので納税の義務はない。", "You don't have to pay tax until you hit level 10.")
+			txt lang("初年度は納税の義務がない。", "You don't have to pay tax until new Year.")
 		}
 	}
 	file = "shop" + invfile + ".s2"
 	fmode = 4
 	gosub *game_ctrlFile
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/god.hsp ../2.14-borscht/god.hsp
--- ../2.13-borscht/god.hsp	2022-06-26 12:14:16.314889500 -0700
+++ ../2.14-borscht/god.hsp	2022-09-18 12:37:01.196927100 -0700
@@ -22,11 +22,11 @@
 		return 0
 	}
 	cdata(CDATA_PIETY, CHARA_PLAYER) += modpiety_arg1 / (1 + (gdata(GDATA_AREA) == AREA_SHOW_HOUSE) * 9)
 	return 1
 
-*set_npcGod
+*label_5207
 	if ( cdata(CDATA_GOD, tc) != GOD_EYTH | cbit(CHARA_BIT_NO_GOD, tc) | tc == CHARA_PLAYER ) {
 		return
 	}
 	cdata(CDATA_GOD, tc) = rnd(9)
 	randomize
@@ -73,11 +73,11 @@
 	godname(6) = lang("癒しのジュア", "Jure of Healing")
 	godname(7) = lang("収穫のクミロミ", "Kumiromi of Harvest")
 	godname(8) = lang("富のヤカテクト", "Yacatect of Wealth")
 	return
 
-*god_effect
+*label_5210
 	if ( cdata(CDATA_GOD, r1) == GOD_MANI ) {
 		if ( sdata(SKILL_ATTR_DEX, r1) > 0 ) {
 			sdata(SKILL_ATTR_DEX, r1) += limit(cdata(CDATA_PIETY, r1) / 400, 1, 12 + sdata(SKILL_NORMAL_FAITH, CHARA_PLAYER) / 10)
 		}
 		if ( sdata(SKILL_ATTR_PER, r1) > 0 ) {
@@ -304,11 +304,11 @@
 
 *god_select
 	if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179 ) {
 		txtef COLOR_PURPLE
 		txt lang("ここからでは神に届かないようだ…。", "It seems that it will not reach God from here...")
-		goto *turn_end
+		goto *label_9247
 	}
 	cs = 0
 	page = 0
 	pagemax = 0
 	pagesize = 16
@@ -491,11 +491,11 @@
 	return
 
 *god_pray
 	if ( cdata(CDATA_GOD, CHARA_PLAYER) == GOD_EYTH ) {
 		txt lang(name(0) + "は神を信仰していないが、試しに祈ってみた。", "You don't believe in God.")
-		goto *turn_end
+		goto *label_9247
 	}
 	txtnew
 	txt lang("あなたの神に祈りを乞う？", "Really pray to your God?")
 	promptl(0, 0) = stryes, "y", "0"
 	promptl(0, 1) = strno, "n", "1"
@@ -509,11 +509,11 @@
 	txt lang(godname(cdata(CDATA_GOD, CHARA_PLAYER)) + "に祈った。", "You pray to " + godname(cdata(CDATA_GOD, CHARA_PLAYER)) + ".")
 	if ( 0 == 0 ) {
 		if ( cdata(CDATA_PIETY, CHARA_PLAYER) < 200 | cdata(CDATA_PRAY, CHARA_PLAYER) < 1000 ) {
 			txtmore
 			txt lang(godname(cdata(CDATA_GOD, CHARA_PLAYER)) + "はあなたに無関心だ。", godname(cdata(CDATA_GOD, CHARA_PLAYER)) + " is indifferent to you.")
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179 ) {
 		if ( gdata(GDATA_FLAG_MAIN) < 845 ) {
 			txtef COLOR_PURPLE
@@ -523,11 +523,11 @@
 		if ( gdata(GDATA_FLAG_MAIN) >= 845 & gdata(GDATA_FLAG_MAIN) < 900 ) {
 			txtef COLOR_PURPLE
 			txtmore
 			txt lang(godname(cdata(CDATA_GOD, CHARA_PLAYER)) + "も、今は余裕がないようだ…。", "It seems that " + godname(cdata(CDATA_GOD, CHARA_PLAYER)) + " cannot afford now...")
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	animeid = ANIMATION_HOLY
 	animode = 100
 	gosub *anime
 	snd SOUNDLIST_PRAY2
@@ -576,11 +576,11 @@
 				val = promptx, prompty, 160, 1
 				gosub *prompt_key
 				if ( rtval == 0 ) {
 					gdata(GDATA_GOD_RANK)++
 				}
-				goto *turn_end
+				goto *label_9247
 			}
 			flt
 			dbid = 0
 			txtef COLOR_BLUE
 			txtmore
@@ -778,21 +778,21 @@
 					}
 				}
 			}
 		}
 	}
-	goto *turn_end
+	goto *label_9247
 
 *god_offer
 	if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179 ) {
 		txtef COLOR_PURPLE
 		txt lang("ここからでは神に届かないようだ…。", "It seems that it will not reach God from here...")
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( cdata(CDATA_GOD, CHARA_PLAYER) == GOD_EYTH ) {
 		txt lang("あなたは神を信仰していないが、試しに捧げてみた。", "You don't believe in God.")
-		goto *turn_end
+		goto *label_9247
 	}
 	rowact_item ci
 	item_separate ci
 	txt lang("あなたは" + itemname(ci) + "を" + godname(cdata(CDATA_GOD, CHARA_PLAYER)) + "に捧げ、その名を唱えた。", "You put " + itemname(ci) + " on the altar and mutter the name of " + godname(cdata(CDATA_GOD, CHARA_PLAYER)) + ".")
 	snd SOUNDLIST_OFFER2
@@ -802,11 +802,11 @@
 	item_find 60002
 	if ( stat != (-1) ) {
 		ti = stat
 	}
 	else {
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CORPSE ) {
 		i = limit(inv(INV_ITEM_WEIGHT, ci) / 200, 1, 50)
 		if ( inv(INV_ITEM_PARAM3, ci) < 0 ) {
 			i = 1
@@ -816,10 +816,13 @@
 		i = 25
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_COCONUT_CRAB ) {
 		i = 60
 	}
+	if ( inv(INV_ITEM_ID, ci) == 1264 ) {
+		i = 60
+	}
 	if ( inv(INV_ITEM_PARAM1, ti) != cdata(CDATA_GOD, CHARA_PLAYER) ) {
 		f = 0
 		if ( inv(INV_ITEM_PARAM1, ti) == 0 ) {
 			f = 1
 			txt lang("異世界で、" + godname(cdata(CDATA_GOD, CHARA_PLAYER)) + "が空白の祭壇の権利を主張した。", godname(cdata(CDATA_GOD, CHARA_PLAYER)) + " claims the empty altar.")
@@ -857,15 +860,21 @@
 	else {
 		txtef COLOR_GREEN
 		repeat 1
 			if ( i == 60 ) {
 				if ( cdata(CDATA_GOD, CHARA_PLAYER) == GOD_EHEKATL ) {
-					txt lang(itemname(ci) + "ははまばゆく輝いて消え、四つ葉のクローバーがふってきた。", itemname(ci) + " shine" + _s2(inv(INV_ITEM_NUM, ci)) + " all around and disappear" + _s2(inv(INV_ITEM_NUM, ci)) + ".")
+					txt lang(itemname(ci) + "はまばゆく輝いて消え、四つ葉のクローバーがふってきた。", itemname(ci) + " shine" + _s2(inv(INV_ITEM_NUM, ci)) + " all around and disappear" + _s2(inv(INV_ITEM_NUM, ci)) + ". A three-leaved falls from the altar.")
 					txtef COLOR_YELLOW
 					txt lang("「たらばがに？…たらばがに！！！！！」", cnvtalk("Coconut crab!!!!"))
 					break
 				}
+				if ( cdata(CDATA_GOD, CHARA_PLAYER) == GOD_JURE ) {
+					txt lang(itemname(ci) + "はまばゆく輝いて消え、四つ葉のクローバーがふってきた。", itemname(ci) + " shine" + _s2(inv(INV_ITEM_NUM, ci)) + " all around and disappear" + _s2(inv(INV_ITEM_NUM, ci)) + ". A three-leaved falls from the altar.")
+					txtef COLOR_YELLOW
+					txt lang("「わぁっ♪………な、何よ！？別に喜んでいるわけじゃないから！」", cnvtalk("I'm glad....j-just a little!!"))
+					break
+				}
 			}
 			if ( i >= 15 ) {
 				txt lang(itemname(ci) + "はまばゆく輝いて消えた。", itemname(ci) + " shine" + _s2(inv(INV_ITEM_NUM, ci)) + " all around and disappear" + _s2(inv(INV_ITEM_NUM, ci)) + ".")
 				txtgod cdata(CDATA_GOD, CHARA_PLAYER), GOD_TEXT_OFFER_GREAT
 				break
@@ -885,11 +894,11 @@
 		loop
 		modpiety i
 		cdata(CDATA_PRAY, CHARA_PLAYER) += i * 7
 	}
 	removeitem ci, inv(INV_ITEM_NUM, ci)
-	goto *turn_end
+	goto *label_9247
 
 *god_punish
 	efid = SKILL_EFFECT_CURSE
 	efp = 500
 	tc = CHARA_PLAYER
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/help.hsp ../2.14-borscht/help.hsp
--- ../2.13-borscht/help.hsp	2022-06-26 12:14:16.405973700 -0700
+++ ../2.14-borscht/help.hsp	2022-09-18 12:37:01.265990600 -0700
@@ -5351,11 +5351,11 @@
 	}
 	if ( mode == MODELIST_QUICK_START ) {
 		repeat 9
 			gdata(STARTING_GDATA_RANK + cnt) = 5000
 		loop
-		gdata(GDATA_VERSION) = int(double("6.13") * 1000)
+		gdata(GDATA_VERSION) = int(double("6.14") * 1000)
 		gdata(STARTING_GDATA_SHORTCUT + 1) = 424
 		gdata(STARTING_GDATA_SHORTCUT + 2) = 300
 		gdata(STARTING_GDATA_SHORTCUT + 3) = 631
 		gdata(GDATA_COUNT_SHOP) = 1000
 		gdata(GDATA_COUNT_SHELTER) = 100
@@ -5378,11 +5378,11 @@
 		mapstarty = 23
 		initlv = 3000
 		rc = CHARA_PLAYER
 		flt 100
 		characreate CHARA_PLAYER, CREATURE_ID_HELLABYRINTH_RULER, -3, 0
-		gosub *cm_finishPC
+		gosub *label_4136
 		repeat 3
 		loop
 		gdata(GDATA_YEAR) = 517, 12, 30, 1, 10
 		gdata(GDATA_STORY_BOOKMARK) = 10000
 		gdata(GDATA_DEEPEST) = 100
@@ -5471,14 +5471,14 @@
 		inv(INV_ITEM_NUM, ci) = 60
 		flt
 		itemcreate CHARA_PLAYER, ITEM_ID_JERKY, -1, -1, 0
 		inv(INV_ITEM_LEVEL, ci) = 10
 		flt
-		itemcreate CHARA_PLAYER, ITEM_ID_KISERU, -1, -1, 0
+		itemcreate CHARA_PLAYER, ITEM_ID_SURVIVABILITY_EXTENDER_Y, -1, -1, 0
 		inv(INV_ITEM_NUM, ci) = 30
 		flt
-		itemcreate CHARA_PLAYER, ITEM_ID_TOBACCO_PIPE, -1, -1, 0
+		itemcreate CHARA_PLAYER, ITEM_ID_SURVIVABILITY_EXTENDER_X, -1, -1, 0
 		inv(INV_ITEM_NUM, ci) = 30
 		flt
 		itemcreate CHARA_PLAYER, ITEM_ID_HAMAKI, -1, -1, 0
 		inv(INV_ITEM_NUM, ci) = 30
 		flt
@@ -5936,11 +5936,11 @@
 			flt
 			itemcreate CHARA_PLAYER, ITEM_ID_RED_BOOK, -1, -1, 0
 		loop
 		cbitmod CHARA_BIT_RAPID_MAGIC, CHARA_PLAYER, TRUE
 		mode = MODELIST_MAIN
-		gosub *calcBurdenPc
+		gosub *label_4102
 		repeat 59
 			mat(cnt) = 200
 		loop
 		gosub *adv_init
 		create_pcpic 0, 1
@@ -5955,14 +5955,14 @@
 		gdata(GDATA_AREA_PREV) = -1
 		gdata(GDATA_WORLD) = AREA_NORTH_TYRIS
 		ghelp = 1
 		gdata(GDATA_AREA) = AREA_HOME
 		gdata(GDATA_HOME_LEVEL) = 0
-		gosub *setArea
+		gosub *label_4932
 		gdata(GDATA_LEVEL) = 1
 		gdata(GDATA_LEVEL_START_ON) = 4
-		gdata(GDATA_VERSION) = int(double("6.13") * 1000)
+		gdata(GDATA_VERSION) = int(double("6.14") * 1000)
 		gdata(GDATA_WEATHER) = WEATHER_RAIN, 6
 		repeat 20
 			gdata(STARTING_GDATA_RANK + cnt) = 10000
 		loop
 		gosub *adv_init
@@ -5978,11 +5978,11 @@
 		gdata(GDATA_COUNT_SHOP) = 1000
 		gdata(GDATA_COUNT_SHELTER) = 100
 		gosub *initial_recipe
 	}
 	if ( mode == MODELIST_CONTINUE ) {
-		gosub *game_load
+		gosub *label_5888
 	}
 	gosub *define_los
 	goto *map_init
 
 *main_init
@@ -6124,11 +6124,11 @@
 	}
 	if ( gdata(GDATA_SEC) >= 60 ) {
 		gdata(GDATA_TURN)++
 		cc = CHARA_PLAYER
 		if ( gdata(GDATA_TURN) \ 10 == 0 ) {
-			gosub *chara_spawn
+			gosub *label_4647
 		}
 		if ( gdata(GDATA_TURN) \ 10 == 1 ) {
 			gosub *item_senseQuality
 		}
 		gdata(GDATA_MIN) += gdata(GDATA_SEC) / 60
@@ -6147,18 +6147,18 @@
 		}
 		gdata(GDATA_SEC) = gdata(GDATA_SEC) \ 60
 		if ( gdata(GDATA_MIN) >= 60 ) {
 			gdata(GDATA_HOUR) += gdata(GDATA_MIN) / 60
 			gdata(GDATA_MIN) = gdata(GDATA_MIN) \ 60
-			gosub *advance_hour
+			gosub *label_9228
 		}
 	}
 	procid = (procid + 1) \ 4
 	proclist(procid) = "main_init:End" + " ct:" + ct
-	goto *game_main
+	goto *label_9234
 
-*weather_change
+*label_9227
 	if ( gdata(GDATA_WEATHER) == WEATHER_SNOW ) {
 		if ( gdata(GDATA_AREA) == AREA_NORTH_TYRIS & gdata(GDATA_WORLD_X) < 65 & gdata(GDATA_WORLD_Y) > 10 ) {
 			gdata(GDATA_WEATHER) = WEATHER_RAIN
 			envonly = 1
 			gosub *music_play
@@ -6190,11 +6190,11 @@
 			gdata(GDATA_WEATHER) = WEATHER_CLEAR
 		}
 	}
 	return
 
-*advance_hour
+*label_9228
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Advance_hour:Begin" + " ct:" + ct
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM ) {
 		gosub *museum_update
 	}
@@ -6243,11 +6243,11 @@
 				}
 			}
 		}
 	}
 	gdata(GDATA_NEXT_WEATHER)--
-	gosub *weather_change
+	gosub *label_9227
 	if ( gdata(GDATA_NEXT_WEATHER) < 0 ) {
 		gdata(GDATA_NEXT_WEATHER) = rnd(22) + 2
 		p = gdata(GDATA_WEATHER)
 		repeat 1
 			if ( gdata(GDATA_MONTH) \ 3 == 0 ) {
@@ -6386,11 +6386,11 @@
 		if ( p != gdata(GDATA_WEATHER) ) {
 			envonly = 1
 			gosub *music_play
 		}
 	}
-	gosub *map_prepareTile
+	gosub *label_4912
 	gosub *adv_action
 	gosub *item_rot
 	gosub *calcThirst
 	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 		if ( rnd(3) == 0 ) {
@@ -6589,11 +6589,11 @@
 			}
 			if ( kitune == 10 ) {
 				gosub *random_event
 			}
 		}
-		gosub *shop_turn
+		gosub *label_4612
 		repeat 9
 			p = 120 + cnt
 			if ( gdata(p) >= 10000 ) {
 				gdata(p) = 10000
 				continue
@@ -6611,10 +6611,11 @@
 		evadd EVENT_QUEST_CHECK
 		gdata(GDATA_DAY_PAST) += gdata(GDATA_HOUR) / 24
 		gdata(GDATA_DAY) += gdata(GDATA_HOUR) / 24
 		gdata(GDATA_HOUR) = gdata(GDATA_HOUR) \ 24
 		if ( gdata(GDATA_DAY) >= 31 ) {
+			gdata(250 + 442) = 0
 			gdata(GDATA_MONTH)++
 			gdata(GDATA_DAY) = gdata(GDATA_DAY) - 30
 			gdata(GDATA_YACTECT_GEMSTONE_MSG) = 0
 			if ( gdata(GDATA_MONTH) \ 2 == 0 ) {
 				gdata(GDATA_FLAG_HOLY_WELL)++
@@ -6751,27 +6752,27 @@
 	}
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Advance_hour:End" + " ct:" + ct
 	return
 
-*game_main
+*label_9234
 	if ( ct >= 245 ) {
 		goto *main_init
 	}
 	if ( cdata(CDATA_SPEED_SUM, ct) >= mdata(MDATA_TIMESCALE) ) {
 		cdata(CDATA_SPEED_SUM, ct) -= mdata(MDATA_TIMESCALE)
 	}
 	else {
 		ct++
-		goto *game_main
+		goto *label_9234
 	}
 
-*game_main_redo
+*label_9235
 	cc = ct
 	cdata(CDATA_TIME_SCALE, cc) = cdata(CDATA_SPEED_FIX, cc)
 	cdata(CDATA_TURN, cc)++
-	gosub *turn_init
+	gosub *label_9246
 
 
 	if ( ct == 0 ) {
 		tnew = 1
 		pcnoise = 0
@@ -6831,11 +6832,11 @@
 					healsp cnt, 2
 				}
 			}
 		loop
 		if ( gdata(GDATA_RETURN) != 0 ) {
-*game_main_redo_WHILE1
+*label_9240
 			if ( 1 == 0 ) {
 				goto *game_main_redo_WEND1
 			}
 			gdata(GDATA_RETURN)--
 			if ( mdata(MDATA_TYPE) == MAP_TYPE_QUEST | gdata(GDATA_AREA) == AREA_SHELTER | gdata(GDATA_AREA) == AREA_JAIL | (gdata(GDATA_AREA) == AREA_AMUR_CAGE & gdata(GDATA_LEVEL) >= 10) ) {
@@ -6867,11 +6868,11 @@
 					if ( gdata(GDATA_AREA) == gdata(GDATA_WORLD) ) {
 						txt lang("何もおきない… ", "Nothing happens...")
 						goto *game_main_redo_WEND1
 					}
 				}
-				gosub *check_return
+				gosub *label_5756
 				if ( stat == 1 ) {
 					txtmore
 					txt lang("あなたは法を犯した。", "You commit a crime.")
 					modkarma 0, -10
 				}
@@ -6893,14 +6894,14 @@
 				gosub *screen_draw
 				levelexitby = MAP_EXIT_TELEPORT
 				goto *map_exit
 			}
 			goto *game_main_redo_WEND1
-			goto *game_main_redo_WHILE1
+			goto *label_9240
 		}
 *game_main_redo_WEND1
-		gosub *mapEvent
+		gosub *label_4937
 		if ( cdata(CDATA_EXIST, CHARA_PLAYER) != CHAR_STATE_ALIVE ) {
 			goto *pc_dead
 		}
 		if ( gdata(GDATA_WEATHER) == WEATHER_ETHER ) {
 			if ( mdata(MDATA_FIELD) == MAP_FIELD_OUTDOOR ) {
@@ -7029,11 +7030,11 @@
 					if ( soulstage >= 2 ) {
 						soulstage = 0
 						chara_vanquish findallyguard(CREATURE_ID_STRAY_SOUL)
 					}
 					evadd EVENT_AMURDEAD_SUB_CREATE_STAIRS, 0
-					goto *turn_end
+					goto *label_9247
 				}
 			}
 		}
 	}
 	if ( cdata(CDATA_FRIENDSHIP, CHARA_PLAYER) == 1 ) {
@@ -7041,21 +7042,53 @@
 			if ( rnd(2) == 0 ) {
 				cdata(CDATA_CONDITION_PARALYZE, cc) = 1
 			}
 		}
 	}
+	if ( cbit(1034, cc) == TRUE ) {
+		if ( cdata(CDATA_CONDITION_SLEEP, cc) == 0 ) {
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-5) ) {
+				if ( rnd(100) < 5 ) {
+					txt lang(cdatan(CDATAN_NAME, cc) + "はスヤスヤと眠り始めた…。", cdatan(CDATAN_NAME, cc) + " fell asleep soundly...")
+					cdata(CDATA_CONDITION_SLEEP, cc) = rnd(301) + 100
+				}
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-4) ) {
+				if ( rnd(100) < 5 ) {
+					txt lang(cdatan(CDATAN_NAME, cc) + "はまるで電池が切れたように急に眠り始めた…。", cdatan(CDATAN_NAME, cc) + " suddenly fell asleep as if the battery had run out...")
+					cdata(CDATA_CONDITION_SLEEP, cc) = rnd(151) + 50
+				}
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-3) ) {
+				if ( rnd(100) < 5 ) {
+					if ( gdata(GDATA_HOUR) <= 6 | gdata(GDATA_HOUR) >= 23 ) {
+						txt lang(cdatan(CDATAN_NAME, cc) + "は遊び疲れて眠り始めた…。", cdatan(CDATAN_NAME, cc) + " got tired of playing and fell asleep...")
+						cdata(CDATA_CONDITION_SLEEP, cc) = rnd(151) + 50
+					}
+				}
+			}
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, cc) == (-2) ) {
+				if ( rnd(100) < 2 ) {
+					if ( gdata(GDATA_HOUR) <= 6 | gdata(GDATA_HOUR) >= 23 ) {
+						txt lang(cdatan(CDATAN_NAME, cc) + "はあくびをすると、静かに眠り始めた…。", cdatan(CDATAN_NAME, cc) + " yawned and went to sleep...")
+						cdata(CDATA_CONDITION_SLEEP, cc) = rnd(151) + 50
+					}
+				}
+			}
+		}
+	}
 	if ( cdata(CDATA_CONDITION_SUFFOCATION, cc) >= 15 | cdata(CDATA_CONDITION_SLEEP, cc) > 0 | cdata(CDATA_CONDITION_PARALYZE, cc) > 0 | cdata(CDATA_CONDITION_DIM, cc) >= 60 | (findbuff(cc, BUFF_MELANCHOLY) != (-1) & rnd(10) == 0) ) {
 		if ( cc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_CONDITION_SUFFOCATION, cc) >= 15 ) {
 				await 120
 			}
 			await 60
 			sxfix = 0
 			syfix = 0
 			gosub *screen_draw
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_ITEM_CHIPS_MEMORY) != 0 ) {
 		if ( mapitemfind(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), ITEM_ID_LULWYS_PHOTO_COLLECTION) != (-1) ) {
 			if ( cdata(CDATA_ID, cc) != CREATURE_ID_LULWY & cdata(CDATA_ID, cc) != CREATURE_ID_DEVASTATE_LULWY ) {
 				if ( rnd(20) == 0 ) {
@@ -7071,11 +7104,11 @@
 						txt lang("「こ、これは！？」", cnvtalk("I...will have no mercy..for vermins..."))
 					}
 					txtef COLOR_PURPLE
 					txt lang(name(cc) + "はページをめくっている…。", name(cc) + "  weakened.")
 					snd SOUNDLIST_BOOK1
-					goto *turn_end
+					goto *label_9247
 				}
 				if ( rnd(10) == 0 ) {
 					kaiwa = rnd(3)
 					if ( kaiwa == 0 ) {
 						txt lang("「わけがわからない" + _yo(3) + "」", cnvtalk("A vermin...I can't...tolerate...."))
@@ -7137,17 +7170,17 @@
 		}
 	}
 	if ( cdata(CDATA_CONDITION_DRUNK, cc) >= 45 | cdata(CDATA_HUNGER, cc) > 35000 ) {
 		if ( rnd(60 + cdata(CDATA_ALCOHOL_CONSUMED, cc) * 5) == 0 ) {
 			chara_vomit cc
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( cdata(CDATA_THIRST, cc) > 35000 ) {
 		if ( rnd(60) == 0 ) {
 			chara_morasi cc
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	if ( cdata(CDATA_ROW_ACT_WARNING, cc) == 1 ) {
 		if ( cc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_ROW_ACT, cc) != ACTION_PERFORM_DANCE & cdata(CDATA_ROW_ACT, cc) != ACTION_EAT & cdata(CDATA_ROW_ACT, cc) != ACTION_READ & cdata(CDATA_ROW_ACT, cc) != ACTION_TRAVEL & cdata(CDATA_ROW_ACT, cc) != ACTION_WRITING ) {
@@ -7230,59 +7263,59 @@
 			at 25
 			goto *act_read
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_SEX ) {
 			at 50
-			gosub *sexsex
+			gosub *label_6019
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_TUIN_DER_LUSTEN ) {
 			at 50
-			gosub *skill_tuin_der_lusten
+			gosub *label_6021
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_CHARGE ) {
 			at 5
-			gosub *skill_charge
+			gosub *label_5999
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_MEAL ) {
 			at 5
-			gosub *eat_meal
+			gosub *label_6016
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_XMAS_CAKE ) {
 			at 5
-			gosub *eat_meal_xmas_cake
+			gosub *label_6018
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERSUASION ) {
 			at 5
-			gosub *skill_persuasion
+			gosub *label_6001
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PECULIAR_JOKE ) {
 			at 5
-			gosub *skill_peculiar_joke
+			gosub *label_6004
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_BLENDED_LIE ) {
 			at 5
-			gosub *skill_blended_lie
+			gosub *label_6007
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_INTIMIDATION ) {
 			at 5
-			gosub *skill_intimidation
+			gosub *label_6010
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_MYSTERIOUS_SONG ) {
 			at 5
-			gosub *skill_mysterious_song
+			gosub *label_6013
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_WORK_A ) {
 			at 5
-			gosub *label_6008
+			gosub *label_6017
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_WORK_B ) {
 			at 5
-			gosub *label_6008
+			gosub *label_6017
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_WORK_C ) {
 			at 5
-			gosub *label_6008
+			gosub *label_6017
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_GENERAL ) {
 			if ( gdata(GDATA_ROW_ACT) == ACTION_HARVEST ) {
 				at 40
 			}
@@ -7297,42 +7330,42 @@
 					else {
 						at 20
 					}
 				}
 			}
-			gosub *generalAct
+			gosub *label_6023
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_BLEND ) {
 			at 20
 			gosub *blend
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERFORM ) {
 			at 40
-			gosub *perform
+			gosub *label_5986
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERFORM_PREACH ) {
 			at 40
-			gosub *perform_preach
+			gosub *label_5996
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_BEGGING ) {
 			at 40
-			gosub *label_5985
+			gosub *label_5994
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_PERFORM_DANCE ) {
 			at 40
-			gosub *perform_dance
+			gosub *label_5991
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_WRITING ) {
 			at 40
 			gosub *start_writing
 		}
 		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_TRAVEL ) {
 			gosub *travel
 			goto *act_move
 		}
 		if ( cdata(CDATA_ACTION_PERIOD, cc) > 0 ) {
-			goto *turn_end
+			goto *label_9247
 		}
 		rowactend cc
 		if ( cc == CHARA_PLAYER ) {
 			if ( chatteleport == 1 ) {
 				chatteleport = 0
@@ -7363,13 +7396,13 @@
 		}
 		else {
 			goto *ai_turn
 		}
 	}
-	goto *game_main
+	goto *label_9234
 
-*turn_init
+*label_9246
 	cdata(CDATA_EMO_ICON, cc) -= 100
 	if ( cdata(CDATA_EMO_ICON, cc) < 0 ) {
 		cdata(CDATA_EMO_ICON, cc) = 0
 	}
 	if ( mdata(MDATA_FIELD) == MAP_FIELD_OUTDOOR ) {
@@ -7382,31 +7415,31 @@
 			snd SOUNDLIST_DING1
 			msgalert = 1
 		}
 		r1 = cc
 		r2 = 0
-		gosub *calcLevelUp
-		goto *turn_init
+		gosub *label_3967
+		goto *label_9246
 	}
 	return
 
-*turn_end
+*label_9247
 	buffact = 0
 	cc = ct
 	if ( cdata(CDATA_EXIST, cc) != CHAR_STATE_ALIVE ) {
-		goto *game_main
+		goto *label_9234
 	}
 	hear = 0
 	r1 = cc
 	gosub *calcCondition
 	if ( cc == CHARA_PLAYER ) {
 		chatturn = 10
 		if ( gdata(GDATA_SLEEP_GENE) != 0 ) {
 			if ( gdata(GDATA_SLEEP_GENE) < 10000 ) {
 				gdata(GDATA_SLEEP_GENE) += 10000
 				gdata(GDATA_ROW_ACT) = ACTION_SLEEP
-				gosub *generalAct
+				gosub *label_6023
 			}
 		}
 		if ( cdata(CDATA_BURDEN, CHARA_PLAYER) >= 3 ) {
 			if ( dbg_noweight == 0 ) {
 				if ( rnd(20) == 0 ) {
@@ -7464,11 +7497,11 @@
 			if ( gdata(GDATA_FLAG_STOP_TIME_OTHER_CHARA_INDEX) != 0 ) {
 				if ( gdata(GDATA_FLAG_STOP_TIME_OTHER) == 0 ) {
 					gdata(GDATA_FLAG_STOP_TIME_OTHER) = gdata(GDATA_TIME_STOP_TIME) + 1
 				}
 			}
-			goto *game_main_redo
+			goto *label_9235
 		}
 	}
 	if ( gdata(GDATA_FLAG_STOP_TIME_OTHER) > 0 ) {
 		if ( cc == gdata(GDATA_FLAG_STOP_TIME_OTHER_CHARA_INDEX) & cc != CHARA_PLAYER ) {
 			gdata(GDATA_FLAG_STOP_TIME_OTHER)--
@@ -7483,11 +7516,11 @@
 					gosub *screen_draw
 					await 200
 				}
 				txtef COLOR_SKY_BLUE
 				txt " *tick* "
-				goto *game_main_redo
+				goto *label_9235
 			}
 		}
 	}
 	if ( gdata(GDATA_FLAG_CURTAIN_CALL) > 9999 ) {
 		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
@@ -7501,11 +7534,11 @@
 				cdata(CDATA_AI_AGGRO, rc) = 300
 			loop
 			gdata(GDATA_FLAG_CURTAIN_CALL) = -9999
 		}
 	}
-	goto *game_main
+	goto *label_9234
 
 *pc_turn_init
 	procid = (procid + 1) \ 4
 	proclist(procid) = "pc_turn_init" + " ct:" + ct
 	if ( gdata(GDATA_GOD_TALK) ) {
@@ -7740,11 +7773,11 @@
 			txtef COLOR_RED2
 			txt lang("*判定負け*", " *Loss on points* ")
 			gdata(GDATA_FLAG_CURTAIN_CALL) = 0
 			await 1000
 			petarenawin = 2
-			goto *turn_end
+			goto *label_9247
 			goto *pc_turn_init_WHILE1_CONTINUE
 		}
 		if ( key == key_goup | key_escape == 1 ) {
 			txt lang("試合を放棄する？", "Do you want to give up the game?")
 			promptl(0, 0) = stryes, "y", "0"
@@ -7752,26 +7785,26 @@
 			promptmax = 2
 			val = promptx, prompty, 160, 1
 			gosub *prompt_key
 			if ( rtval == 0 ) {
 				petarenawin = 2
-				goto *turn_end
+				goto *label_9247
 			}
 			goto *pc_turn_init_WHILE1_CONTINUE
 		}
 		if ( key != key_cancel ) {
 			if ( key != "" ) {
-				goto *turn_end
+				goto *label_9247
 			}
 		}
 *pc_turn_init_WHILE1_CONTINUE
 		goto *pc_turn_init_WHILE1
 	}
 
 *pc_turn_init_WEND1
 	if ( dbg_titleinfo ) {
-		title "ElonaPlus 2.13" + " ver " + "6.13" + " " + exedir + " Seed: " + randseed + "  Loop:" + looplev + " SubLoop:" + sublev + " x:" + cdata(CDATA_X, CHARA_PLAYER) + " y:" + cdata(CDATA_Y, CHARA_PLAYER) + " ev:" + evnum + " q:" + gdata(GDATA_QUEST) + " tile:" + map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_TILE_ID) + " unpc:" + usernpcmax + "/" + gdata(GDATA_USERNPC_COUNT)
+		title "ElonaPlus 2.14" + " ver " + "6.14" + " " + exedir + " Seed: " + randseed + "  Loop:" + looplev + " SubLoop:" + sublev + " x:" + cdata(CDATA_X, CHARA_PLAYER) + " y:" + cdata(CDATA_Y, CHARA_PLAYER) + " ev:" + evnum + " q:" + gdata(GDATA_QUEST) + " tile:" + map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_TILE_ID) + " unpc:" + usernpcmax + "/" + gdata(GDATA_USERNPC_COUNT)
 	}
 	if ( trait(TRAIT_ETHER_ADDICTED_POTION) != 0 ) {
 		if ( rnd(5) == 0 ) {
 			inv_getheader 0
 			ci = rnd(invrange) + invhead
@@ -7813,11 +7846,11 @@
 	}
 	if ( gdata(GDATA_EQUIP_CHANGE) ) {
 		if ( cdata(CDATA_CONDITION_BRAINWASH, CHARA_PLAYER) == 0 ) {
 			txt lang("装備を変更した。", "You change your equipment.")
 		}
-		goto *turn_end
+		goto *label_9247
 	}
 	t++
 	if ( cdata(CDATA_CHAIN_ATTACK_COUNT, CHARA_PLAYER) != 0 ) {
 		cdata(CDATA_CHAIN_ATTACK_COUNT, CHARA_PLAYER) = 0
 	}
@@ -7869,22 +7902,22 @@
 		getkey a, 113
 		if ( a ) {
 			msg_newline
 			msgtemp = "  "
 			firstturn = 1
-			gosub *game_load
+			gosub *label_5888
 			mode = MODELIST_CONTINUE
 			goto *map_init
 		}
 	}
 	if ( gdata(GDATA_WIZARD) | 0 ) {
 		getkey a, 113
 		if ( a ) {
 			msg_newline
 			msgtemp = "  "
 			firstturn = 1
-			gosub *game_load
+			gosub *label_5888
 			mode = MODELIST_CONTINUE
 			goto *map_init
 		}
 		getkey a, 114
 		if ( a ) {
@@ -7897,31 +7930,31 @@
 		if ( a ) {
 			repeat 10, 10
 				txt skillname(cnt) + ":" + cdata(STARTING_CDATA_FOOD_EXP + cnt - 10, CHARA_PLAYER) + "%"
 			loop
 			chara_vomit CHARA_PLAYER
-			goto *turn_end
+			goto *label_9247
 			repeat 100
 				flt 100
 				fltn "cnpc"
 				characreate -1, CREATURE_ID_BUG, -3, 0
 				cdatan(CDATAN_NAME, rc) += "" + cdata(CDATA_USERNPC_ID, rc)
 			loop
 		}
 		getkey a, 116
 		if ( a ) {
 			gosub *com_wish
-			goto *turn_end
+			goto *label_9247
 		}
 		getkey a, 117
 		if ( a ) {
 			dbg_skipevent = 1
 			gdata(GDATA_HOUR)++
-			gosub *advance_hour
+			gosub *label_9228
 			dbg_skipevent = 0
 			mode = MODELIST_MAIN
-			goto *turn_end
+			goto *label_9247
 		}
 		getkey a, 118
 		if ( a ) {
 			if ( mdata(MDATA_TYPE) != MAP_TYPE_TOWN ) {
 				dbg_revealmap = 1
@@ -7936,11 +7969,11 @@
 		}
 	}
 	else {
 		getkey a, 114
 		if ( a ) {
-			goto *turn_end
+			goto *label_9247
 		}
 	}
 	getkey a, 112
 	if ( a ) {
 		gosub *game_save
@@ -7959,12 +7992,12 @@
 	if ( a ) {
 		redraw 0
 		gmode 2
 		sxfix = 0
 		syfix = 0
-		gosub *screen_setPos
-		gosub *los
+		gosub *label_3908
+		gosub *label_3912
 		gosub *los_draw
 		p = windoww / 192
 		repeat p + 1
 			if ( cnt == p ) {
 				sx = windoww \ 192
@@ -8091,11 +8124,11 @@
 			}
 		loop
 		await 100
 	}
 	if ( key != "" ) {
-		gosub *pcQuitY
+		gosub *label_9266
 	}
 	if ( gdata(GDATA_FLAG_MAIN) < 875 | gdata(GDATA_FLAG_MAIN) >= 900 ) {
 		if ( key == key_quick ) {
 			gosub *com_quick
 			gosub *screen_draw
@@ -8309,11 +8342,11 @@
 		if ( key == key_itemstack ) {
 			goto *com_stack
 		}
 		if ( key == key_target ) {
 			findlocmode = 1
-			gosub *findLocation
+			gosub *label_5349
 			findlocmode = 0
 			goto *pc_turn
 		}
 		if ( key == key_fire ) {
 			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD & 0 == 0 ) {
@@ -8345,11 +8378,11 @@
 		if ( key == key_look ) {
 			if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
 				goto *com_target
 			}
 			else {
-				gosub *findLocation
+				gosub *label_5349
 				goto *pc_turn
 			}
 		}
 		if ( key == key_save | key_escape == 1 ) {
 			goto *com_save
@@ -8473,11 +8506,11 @@
 	if ( key == key_goup ) {
 		val = 2
 		goto *act_moveLevel
 	}
 	if ( key == key_wait ) {
-		goto *turn_end
+		goto *label_9247
 	}
 	if ( key == key_enter ) {
 		gosub *screen_draw
 		goto *pc_turn
 	}
@@ -8492,11 +8525,11 @@
 			}
 		}
 	}
 	goto *pc_turn
 
-*pcQuitY
+*label_9266
 	if ( gdata(GDATA_QUIT_Y) != (-1) ) {
 		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
 			if ( gdata(GDATA_QUIT_Y) == 0 ) {
 				if ( key == "Q" ) {
 					txt lang("え…", "What...")
@@ -8522,11 +8555,11 @@
 								flt
 								characreate -1, CREATURE_ID_AT_SIGN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
 							loop
 							gdata(GDATA_QUIT_Y) = -1
 							gosub *screen_draw
-							goto *turn_end
+							goto *label_9247
 						}
 					}
 					gdata(GDATA_QUIT_Y) = 0
 				}
 				gdata(GDATA_QUIT_Y) = 0
@@ -9020,11 +9053,11 @@
 	if ( 0 ) {
 		_switch_sw++
 	}
 	if ( _switch_val == 8 | _switch_sw ) {
 		_switch_sw = 0
-		gosub *quest_eliminate
+		gosub *label_8954
 		goto *event_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 81 | _switch_sw ) {
 		_switch_sw = 0
@@ -9328,11 +9361,11 @@
 		_switch_sw++
 	}
 	if ( _switch_val == 24 | _switch_sw ) {
 		_switch_sw = 0
 		initeco = 1
-		gosub *renew_economy
+		gosub *label_6708
 		goto *event_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 3 | _switch_sw ) {
 		_switch_sw = 0
@@ -10928,10 +10961,131 @@
 			evadd EVENT_EAR_CLEANING
 		}
 		goto *event_SWEND1
 		_switch_sw++
 	}
+	if ( _switch_val == 93 | _switch_sw ) {
+		_switch_sw = 0
+		s = lang("誕生", "Birth")
+		file = "bg39"
+		buff = lang("今、この世界で新たな生命活動が開始…産まれたのだ。", "Now, a small first cry echoes in this world...")
+		listmax = 0
+		list(0, listmax) = 1
+		listn(0, listmax) = lang("遂に…！", "Finally!")
+		listmax++
+		list(0, listmax) = 2
+		listn(0, listmax) = lang("おぉぉぉぉ！", "Woooooo!")
+		listmax++
+		list(0, listmax) = 3
+		listn(0, listmax) = lang("今日は眠れないな", "I can't sleep tonight.")
+		listmax++
+		gosub *re_select
+		snd SOUNDLIST_OFFER2
+		if ( ccbk != 0 ) {
+			babyid = cdata(CDATA_ID, ccbk)
+		}
+		if ( ccbk == 0 ) {
+			babyid = cdata(CDATA_INFANT, ccbk)
+		}
+		babyai = cdata(CDATA_INFANT, ccbk)
+		cdata(CDATA_SP_EARNED, ccbk) = -cdata(CDATA_SP_EARNED, ccbk) \ 10000
+		if ( 0 ) {
+			txt lang(name(ccbk) + "の" + babyid + "と" + babyai + "ステージ端数" + cdata(CDATA_SP_EARNED, ccbk) + "。", name(cc) + " get genes of " + _s(cc) + ".")
+		}
+		bsid = cdata(CDATA_SP_EARNED, ccbk) / 100
+		bsids = cdata(CDATA_SP_EARNED, ccbk) \ 100
+		babymake = 1
+		repeat 20
+			if ( cdata(CDATA_TAMER_WHIP_PICKUP, ccbk) <= 0 & cdata(CDATA_TAMER_WHIP_EAT, ccbk) <= 0 ) {
+				break
+			}
+			if ( cdata(CDATA_TAMER_WHIP_PICKUP, ccbk) > 0 ) {
+				babysex = 10
+				flt
+				characreate MAX_CHARA_NC, babyai, -3, 0
+				flt
+				initlv = 1
+				novoidlv = 1
+				characreate -1, babyid, cdata(CDATA_X, ccbk), cdata(CDATA_Y, ccbk)
+				cdata(CDATA_SPRITE_SIZE_MILK, rc) = -5
+				cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR)
+				cdata(CDATA_QUALITY, rc) = FIX_QUALITY_UNIQUE
+				cbitmod 1034, rc, TRUE
+				cdata(CDATA_SEX, rc) = 0
+				cdata(CDATA_PORTRAIT, rc) = -1
+				cdatan(CDATAN_NAME, rc) = lang(cdatan(CDATAN_NAME, ccbk) + "の息子", "son of " + cdatan(CDATAN_NAME, ccbk))
+				cdatan(CDATAN_NAME, rc) = lang("《", "{") + cdatan(CDATAN_NAME, rc) + lang("》", "}")
+				cdata(CDATA_AI_MOVE_FREQ, rc) = cdata(CDATA_AI_MOVE_FREQ, MAX_CHARA_NC)
+				cdata(CDATA_AI_DISTANCE, rc) = cdata(CDATA_AI_DISTANCE, MAX_CHARA_NC)
+				cdata(CDATA_AI_SUB, rc) = cdata(CDATA_AI_SUB, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN, rc) = cdata(STARTING_CDATA_ACT_MAIN, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN + 1, rc) = cdata(STARTING_CDATA_ACT_MAIN + 1, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN + 2, rc) = cdata(STARTING_CDATA_ACT_MAIN + 2, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN + 3, rc) = cdata(STARTING_CDATA_ACT_MAIN + 3, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN + 4, rc) = cdata(STARTING_CDATA_ACT_MAIN + 4, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB, rc) = cdata(STARTING_CDATA_ACT_SUB, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB + 1, rc) = cdata(STARTING_CDATA_ACT_SUB + 1, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB + 2, rc) = cdata(STARTING_CDATA_ACT_SUB + 2, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB + 3, rc) = cdata(STARTING_CDATA_ACT_SUB + 3, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB + 4, rc) = cdata(STARTING_CDATA_ACT_SUB + 4, MAX_CHARA_NC)
+				cdata(CDATA_ACT_INDEX, rc) = cdata(CDATA_ACT_INDEX, MAX_CHARA_NC)
+				chara_vanquish MAX_CHARA_NC
+				cdata(CDATA_TAMER_WHIP_PICKUP, ccbk)--
+				wishally = 200
+				gdata(GDATA_TEMPORARY_FLAGS2) = 200
+				gosub *add_ally
+			}
+			if ( cdata(CDATA_TAMER_WHIP_EAT, ccbk) > 0 ) {
+				babysex = 11
+				flt
+				characreate MAX_CHARA_NC, babyai, -3, 0
+				flt
+				initlv = 1
+				novoidlv = 1
+				characreate -1, babyid, cdata(CDATA_X, ccbk), cdata(CDATA_Y, ccbk)
+				cdata(CDATA_SPRITE_SIZE_MILK, rc) = -5
+				cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR)
+				cdata(CDATA_QUALITY, rc) = FIX_QUALITY_UNIQUE
+				cbitmod 1034, rc, TRUE
+				cdata(CDATA_SEX, rc) = 1
+				cdata(CDATA_PORTRAIT, rc) = -1
+				cdatan(CDATAN_NAME, rc) = lang(cdatan(CDATAN_NAME, ccbk) + "の娘", "daughter of " + cdatan(CDATAN_NAME, ccbk))
+				cdatan(CDATAN_NAME, rc) = lang("《", "{") + cdatan(CDATAN_NAME, rc) + lang("》", "}")
+				cdata(CDATA_AI_MOVE_FREQ, rc) = cdata(CDATA_AI_MOVE_FREQ, MAX_CHARA_NC)
+				cdata(CDATA_AI_DISTANCE, rc) = cdata(CDATA_AI_DISTANCE, MAX_CHARA_NC)
+				cdata(CDATA_AI_SUB, rc) = cdata(CDATA_AI_SUB, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN, rc) = cdata(STARTING_CDATA_ACT_MAIN, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN + 1, rc) = cdata(STARTING_CDATA_ACT_MAIN + 1, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN + 2, rc) = cdata(STARTING_CDATA_ACT_MAIN + 2, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN + 3, rc) = cdata(STARTING_CDATA_ACT_MAIN + 3, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_MAIN + 4, rc) = cdata(STARTING_CDATA_ACT_MAIN + 4, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB, rc) = cdata(STARTING_CDATA_ACT_SUB, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB + 1, rc) = cdata(STARTING_CDATA_ACT_SUB + 1, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB + 2, rc) = cdata(STARTING_CDATA_ACT_SUB + 2, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB + 3, rc) = cdata(STARTING_CDATA_ACT_SUB + 3, MAX_CHARA_NC)
+				cdata(STARTING_CDATA_ACT_SUB + 4, rc) = cdata(STARTING_CDATA_ACT_SUB + 4, MAX_CHARA_NC)
+				cdata(CDATA_ACT_INDEX, rc) = cdata(CDATA_ACT_INDEX, MAX_CHARA_NC)
+				chara_vanquish MAX_CHARA_NC
+				cdata(CDATA_TAMER_WHIP_EAT, ccbk)--
+				wishally = 200
+				gdata(GDATA_TEMPORARY_FLAGS2) = 200
+				gosub *add_ally
+			}
+		loop
+		gdata(GDATA_TEMPORARY_FLAGS2) = 0
+		babymake = 0
+		babysex = 0
+		wishally = 0
+		cdata(CDATA_SP_EARNED, ccbk) = 0
+		cdata(CDATA_INFANT, ccbk) = 0
+		flt
+		novoidlv = 1
+		characreate -1, CREATURE_ID_BOYCIANA, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
+		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
+		goto *event_SWEND1
+		_switch_sw++
+	}
 	if ( _switch_val == 82 | _switch_sw ) {
 		_switch_sw = 0
 		s = lang("くじ引き", "Lottery")
 		file = "bg38"
 		buff = lang("あなたの目の前に富の女神が現れ、くじ引きの箱を置いた。", "The goddess of wealth appears in front of you and places a lottery box.")
@@ -12590,11 +12744,11 @@
 		goto *event_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 10 | _switch_sw ) {
 		_switch_sw = 0
-		gosub *quest_check
+		gosub *label_8945
 		goto *event_SWEND1
 		_switch_sw++
 	}
 	if ( _switch_val == 19 | _switch_sw ) {
 		_switch_sw = 0
@@ -12672,11 +12826,11 @@
 			}
 			cdata(CDATA_EXIST, tc) = CHAR_STATE_ALIVE
 			rc = tc
 			cxinit = cdata(CDATA_X, CHARA_PLAYER)
 			cyinit = cdata(CDATA_Y, CHARA_PLAYER)
-			gosub *place_chara
+			gosub *label_4125
 		}
 		else {
 			flt 0, FIX_QUALITY_GOOD
 			repeat 1
 				if ( gdata(GDATA_MONTH) == 10 ) {
@@ -12887,11 +13041,11 @@
 				continue
 			}
 			cdata(CDATA_EMO_ICON, cnt) = 6 + 100 * 20
 			tc = cnt
 			customtalk tc, DBMODE_FLAVOR_WELCOME
-			gosub *convert_word
+			gosub *label_0416
 			if ( stat == 0 ) {
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					i++
 				}
 			}
@@ -12931,11 +13085,11 @@
 				if ( cdata(CDATA_ROLE, cnt) != ROLE_SPECIAL ) {
 					if ( cdata(CDATA_ROLE, cnt) != ROLE_NONE | cdata(CDATA_RELATION, cnt) == RELATION_NEUTRAL | cdata(CDATA_AREA, cnt) == gdata(GDATA_AREA) ) {
 						cdata(CDATA_EMO_ICON, cnt) = 6 + 100 * 20
 						tc = cnt
 						customtalk tc, DBMODE_FLAVOR_WELCOME
-						gosub *convert_word
+						gosub *label_0416
 						if ( stat == 0 ) {
 							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 								i++
 							}
 						}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/init.hsp ../2.14-borscht/init.hsp
--- ../2.13-borscht/init.hsp	2022-06-26 12:14:16.572126700 -0700
+++ ../2.14-borscht/init.hsp	2022-09-18 12:37:01.440228600 -0700
@@ -1466,13 +1466,13 @@
 		return
 	}
 	return
 
 *sRefDefine
-	dim sdataref, 7, 843
-	sdim skillname, 16, 843
-	sdim skilldesc, 40, 843
+	dim sdataref, 7, 846
+	sdim skillname, 16, 846
+	sdim skilldesc, 40, 846
 	sdim skillencdesc, 40, 600
 	sdataref(SKILL_DATAREF_USE, SKILL_ATTR_LIFE) = SKILL_NONE, SKILL_TYPE_SP, 0, TARGET_TYPE_NONE, 0
 	skillname(SKILL_ATTR_LIFE) = lang("生命力", "Life")
 	skilldesc(SKILL_ATTR_LIFE) = lang("", "")
 	if ( 2 < 600 ) {
@@ -2012,11 +2012,11 @@
 	if ( 411 < 600 ) {
 		skillencdesc(SKILL_SPELL_IDENTIFY) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPELL_UNCURSE) = SKILL_ATTR_WIL, SKILL_TYPE_SP, 35, TARGET_TYPE_SELF, 700
 	skillname(SKILL_SPELL_UNCURSE) = lang("解呪", "Uncurse")
-	skilldesc(SKILL_SPELL_UNCURSE) = lang("アイテム解呪", "Uncurse items")
+	skilldesc(SKILL_SPELL_UNCURSE) = lang("装備品の解呪", "Uncurse equipments")
 	if ( 412 < 600 ) {
 		skillencdesc(SKILL_SPELL_UNCURSE) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPELL_ORACLE) = SKILL_ATTR_MAG, SKILL_TYPE_SP, 150, TARGET_TYPE_SELF, 1500
 	skillname(SKILL_SPELL_ORACLE) = lang("神託", "Oracle")
@@ -2419,12 +2419,12 @@
 	skilldesc(SKILL_SPELL_RESURRECTION) = lang("死者の蘇生", "Resurrect dead")
 	if ( 461 < 600 ) {
 		skillencdesc(SKILL_SPELL_RESURRECTION) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPELL_WISH) = SKILL_ATTR_MAG, SKILL_TYPE_SP, 580, TARGET_TYPE_SELF_ONLY, 5250
-	skillname(SKILL_SPELL_WISH) = lang("願い", "Wish")
-	skilldesc(SKILL_SPELL_WISH) = lang("願いの効果", "Wish")
+	skillname(SKILL_SPELL_WISH) = lang("願い", "Wish/The higher LV, the higher difficulty")
+	skilldesc(SKILL_SPELL_WISH) = lang("願いの効果/LV高いほど難易度増加", "Wish")
 	if ( 441 < 600 ) {
 		skillencdesc(SKILL_SPELL_WISH) = lang("", "")
 	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPELL_METEOR) = SKILL_ATTR_MAG, SKILL_TYPE_SP, 220, TARGET_TYPE_SELF_ONLY, 1450
 	skillname(SKILL_SPELL_METEOR) = lang("メテオ", "Meteor")
@@ -2790,10 +2790,28 @@
 	skillname(SKILL_SPACT_RUBBING) = lang("愛撫の手", "Rubbing")
 	skilldesc(SKILL_SPACT_RUBBING) = lang("撫でまわす", "Rub npc")
 	if ( 701 < 600 ) {
 		skillencdesc(SKILL_SPACT_RUBBING) = lang("", "")
 	}
+	sdataref(SKILL_DATAREF_USE, MAX_SKILL) = SKILL_ATTR_DEX, SKILL_TYPE_SP, 10, TARGET_TYPE_SELF_ONLY, 500
+	skillname(MAX_SKILL) = lang("直輸血", "Direct Transfusion")
+	skilldesc(MAX_SKILL) = lang("近くのキャラ間で血と遺伝子受け渡し", "Transfer blood and genes between nearby characters")
+	if ( 843 < 600 ) {
+		skillencdesc(MAX_SKILL) = lang("", "")
+	}
+	sdataref(SKILL_DATAREF_USE, 844) = SKILL_ATTR_DEX, SKILL_TYPE_SP, 20, TARGET_TYPE_DIRECTION, 0
+	skillname(844) = lang("電気衝駆", "Electric Shock")
+	skilldesc(844) = lang("生化学依存電撃/味方は呼吸困難半減", "Lightning attack/SP and Dyspnea recovery")
+	if ( 844 < 600 ) {
+		skillencdesc(844) = lang("", "")
+	}
+	sdataref(SKILL_DATAREF_USE, 845) = SKILL_ATTR_DEX, SKILL_TYPE_SP, 15, TARGET_TYPE_DIRECTION, 0
+	skillname(845) = lang("神速縫合", "Instant Suture")
+	skilldesc(845) = lang("敵を束縛/味方は出血半減", "Bind enemy/Halved bleeding")
+	if ( 845 < 600 ) {
+		skillencdesc(845) = lang("", "")
+	}
 	sdataref(SKILL_DATAREF_USE, SKILL_SPACT_BLADE_STRINGS) = SKILL_ATTR_DEX, SKILL_TYPE_SP, 10, TARGET_TYPE_DIRECTION, 0
 	skillname(SKILL_SPACT_BLADE_STRINGS) = lang("ブレードストリングス", "Blade Strings")
 	skilldesc(SKILL_SPACT_BLADE_STRINGS) = lang("戦術器用依存攻撃/トラップ設置", "Cutting attack/Trap installation")
 	if ( 769 < 600 ) {
 		skillencdesc(SKILL_SPACT_BLADE_STRINGS) = lang("", "")
@@ -5822,11 +5840,11 @@
 		}
 		return 1
 	}
 	return 0
 
-*cm_putTrait
+*label_0046
 	if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "dwarf" ) {
 		trait(TRAIT_RACE_RES_POISON) = 2
 		trait(TRAIT_RACE_RES_DARKNESS) = 1
 	}
 	if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "elea" ) {
@@ -6306,10 +6324,11 @@
 	sndload folder + "semi4.wav", SOUNDLIST_SEMI4
 	sndload folder + "semi5.wav", SOUNDLIST_SEMI5
 	sndload folder + "crash14.wav", SOUNDLIST_CRASH14
 	sndload folder + "whistle00.wav", SOUNDLIST_WHISTLE00
 	sndload folder + "gun10.wav", SOUNDLIST_GUN10
+	sndload folder + "chandler23.wav", 302
 	folder = exedir + "user\\sound\\"
 	sndload folder + "se0.wav", SOUNDLIST_USER_SE00
 	sndload folder + "se1.wav", SOUNDLIST_USER_SE01
 	sndload folder + "se2.wav", SOUNDLIST_USER_SE02
 	sndload folder + "se3.wav", SOUNDLIST_USER_SE03
@@ -11263,17 +11282,17 @@
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_CYBER_DOME ) {
 		s = lang("アクリ・テオラ", "Cyber Dome"), lang("何やら奇妙な建物がある。", "You see a very strange building.")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_BEAST_FORT ) {
-		s = lang("混沌の城《獣》", "Fort of Chaos <Beast>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は80階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 80) ")
+		s = lang("混沌の城《獣》", "Fort of Chaos <Beast>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は80階階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 80) ")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_MACHINE_FORT ) {
-		s = lang("混沌の城《機甲》", "Fort of Chaos <Machine>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は80階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 80) ")
+		s = lang("混沌の城《機甲》", "Fort of Chaos <Machine>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は80階階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 80) ")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_COLLAPSED_FORT ) {
-		s = lang("混沌の城《奇形》", "Fort of Chaos <Collapsed>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は80階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 80) ")
+		s = lang("混沌の城《奇形》", "Fort of Chaos <Collapsed>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は80階階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 80) ")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_PET_ARENA ) {
 		s = lang("コロシアム", "Pet Arena")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_MUSEUM ) {
@@ -11501,17 +11520,17 @@
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_DOJO ) {
 		s = lang("道場", "Doujyou")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_DESTRUCTION_FORT ) {
-		s = lang("混沌の城《破壊》", "Fort of Chaos <Destruction>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は200階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 200) ")
+		s = lang("混沌の城《破壊》", "Fort of Chaos <Destruction>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は200階階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 200) ")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_WEAPONS_FORT ) {
-		s = lang("混沌の城《機皇》", "Fort of Chaos <Weapons>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は200階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 200) ")
+		s = lang("混沌の城《機皇》", "Fort of Chaos <Weapons>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は200階階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 200) ")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_HELL_FORT ) {
-		s = lang("混沌の城《地獄》", "Fort of Chaos <Hell>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は200階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 200) ")
+		s = lang("混沌の城《地獄》", "Fort of Chaos <Hell>"), lang("不気味な城がある。絶対に入ってはいけない予感がする。(危険度は200階階相当)", "You see an unearthly fort. Your inner voice wanrs you to not go there. (Approximate danger level: 200) ")
 	}
 	if ( adata(ADATA_ID, mapname_mapid) == AREA_QUEST ) {
 		if ( gdata(GDATA_QUEST) == QUEST_TYPE_HUNT ) {
 			s = lang("街近辺", "The outskirts")
 		}
@@ -11555,11 +11574,11 @@
 		}
 		if ( s(1) != "" ) {
 			return s(1)
 		}
 		if ( adata(ADATA_TYPE, mapname_mapid) >= (20 /*!!!@[MAP_TYPE_DUNGEON @@@ MAP_TYPE_DUNGEON_MIN]@!!! */) ) {
-			return lang(s + "への入り口がある(入り口の危険度は" + adata(ADATA_MIN_LEVEL, mapname_mapid) + "階相当)。", "You see an entrance leading to " + s + ".(Approximate danger level: " + adata(ADATA_MIN_LEVEL, mapname_mapid) + ") ")
+			return lang(s + "への入り口がある(入り口の危険度は" + adata(ADATA_MIN_LEVEL, mapname_mapid) + "階階相当)。", "You see an entrance leading to " + s + ".(Approximate danger level: " + adata(ADATA_MIN_LEVEL, mapname_mapid) + ") ")
 		}
 		return lang(s + "がある。", "You see " + s + ".")
 	}
 	return s
 	goto *label_0385
@@ -12837,11 +12856,11 @@
 	picfood(0, FOOD_TYPE_SWEET) = xy2pic(32, 6), xy2pic(23, 24), xy2pic(24, 24), xy2pic(24, 23), xy2pic(25, 23), xy2pic(26, 23), xy2pic(27, 23), xy2pic(28, 23), xy2pic(29, 23), xy2pic(30, 23)
 	picfood(0, FOOD_TYPE_PASTA) = xy2pic(32, 6), xy2pic(25, 24), xy2pic(26, 24), xy2pic(17, 23), xy2pic(18, 23), xy2pic(19, 23), xy2pic(20, 23), xy2pic(21, 23), xy2pic(22, 23), xy2pic(23, 23)
 	picfood(0, FOOD_TYPE_FISH) = xy2pic(32, 6), xy2pic(27, 24), xy2pic(28, 24), xy2pic(10, 23), xy2pic(11, 23), xy2pic(12, 23), xy2pic(13, 23), xy2pic(14, 23), xy2pic(15, 23), xy2pic(16, 23)
 	picfood(0, FOOD_TYPE_BREAD) = xy2pic(32, 6), xy2pic(7, 24), xy2pic(8, 24), xy2pic(9, 24), xy2pic(10, 24), xy2pic(11, 24), xy2pic(12, 24), xy2pic(13, 24), xy2pic(14, 24), xy2pic(15, 24)
 	return
-	goto *convert_word
+	goto *label_0416
 
 #defcfunc _yoro int _yoro_arg1
 	if ( cdata(CDATA_TONE, tc) == 0 ) {
 		if ( cdata(CDATA_TONE_SEX, tc) == 1 ) {
 			locvar__yoro__tone = "よろしくお願いします", "どうぞ、よろしくです", "", "", ""
@@ -15188,11 +15207,11 @@
 			locvar__yoro__tone = locvar__yoro__tone(rnd(locvar__yoro_p)) + _mark(_trick_arg1)
 		}
 	}
 	return locvar__yoro__tone
 
-*convert_word
+*label_0416
 	repeat 30
 		await
 		p = instr(buff, 0, "{"), instr(buff, p, "}"), strlen(buff)
 		if ( p == (-1) ) {
 			break
@@ -15886,11 +15905,11 @@
 		txt buff
 	}
 	gdata(GDATA_CUSTOM_TEXT_DIALOG) = 0
 	return
 
-*convert_guide
+*label_0420
 	repeat 30
 		await
 		pg = instr(buffg, 0, "{"), instr(buffg, pg, "}"), strlen(buffg)
 		if ( pg == (-1) ) {
 			break
@@ -16519,55 +16538,55 @@
 		loop
 		buffg = sg(1) + sg + sg(2)
 	loop
 	return
 
-*convert_talk
+*label_0423
 	buff = strmid(buff, p, instr(buff, p, "%END"))
 	if ( noteinfo(0) <= 1 ) {
 		noteload exedir + "data\\talk.txt"
 		p = instr(buff, 0, "%DEFAULT," + lang("JP", "EN"))
 		buff = strmid(buff, p, instr(buff, p, "%END"))
 	}
 	notedel 0
 	p = rnd(noteinfo(0))
 	noteget s, p
 	buff = s
-	gosub *convert_word
+	gosub *label_0416
 	return
 
-*guide_talk_2
+*label_0424
 	buffg = strmid(buffg, pg, instr(buffg, pg, "%END"))
 	if ( noteinfo(0) <= 1 ) {
 		noteload exedir + "guide\\guide.txt"
 		pg = instr(buffg, 0, "%DEFAULT," + lang("JP", "EN"))
 		buffg = strmid(buffg, pg, instr(buffg, pg, "%END"))
 	}
 	notedel 0
 	pg = rnd(noteinfo(0))
 	noteget sg, pg
 	buffg = sg
-	gosub *convert_guide
+	gosub *label_0420
 	return
 
-*guide_talk
+*label_0425
 	buffg = ""
 	notesel buffg
 	noteload exedir + "guide\\guide.txt"
 	pg = instr(buffg, 0, valn + "," + lang("JP", "EN"))
-	gosub *guide_talk_2
+	gosub *label_0424
 	return
 
-*spec_talk
+*label_0426
 	buff = ""
 	notesel buff
 	noteload exedir + "data\\talk.txt"
 	p = instr(buff, 0, valn + "," + lang("JP", "EN"))
-	gosub *convert_talk
+	gosub *label_0423
 	return
 
-*random_talk
+*label_0427
 	buff = ""
 	notesel buff
 	noteload exedir + "data\\talk.txt"
 	p = -1
 	repeat 1
@@ -16777,11 +16796,11 @@
 		}
 		else {
 			p = instr(buff, 0, "%DEFAULT," + lang("JP", "EN"))
 		}
 	}
-	gosub *convert_talk
+	gosub *label_0423
 	return
 	goto *quest_info
 
 #defcfunc cnvweight int cnvweight_arg1
 	locvar_cnvweight_s = "" + abs(cnvweight_arg1) / 1000 + "." + abs(cnvweight_arg1) \ 1000 / 100 + "" + strweight
@@ -16839,179 +16858,179 @@
 	if ( gdata(GDATA_FLAG_MAIN) >= 1010 ) {
 		noteadd lang("@QM[後日談　旅路の最果て]", "@QM[After story.Farthest of journey]")
 	}
 	noteadd lang("@QM<進行度：" + gdata(GDATA_FLAG_MAIN) + ">", "@QM<Progress " + gdata(GDATA_FLAG_MAIN) + ">")
 	if ( gdata(GDATA_FLAG_MAIN) >= 0 & gdata(GDATA_FLAG_MAIN) < 30 ) {
-		s1 = lang("ヴェルニースの南にあるネフィアの迷宮群のひとつ《レシマス》で、何かが見つかるかもしれない。", "I should check the dungeon called Lesimas. It's located south of Vernis.")
+		s1 = lang("ヴェルニースの南にあるネフィアの迷宮群のひとつ《レシマス》で、何かが見つかるかもしれない。 3階相当", "I should check the dungeon called Lesimas. It's located south of Vernis.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 30 & gdata(GDATA_FLAG_MAIN) < 50 ) {
-		s1 = lang("致命傷を負った斥候に、パルミアのジャビ王へ書簡を渡すよう頼まれた。パルミアには、ヴェルニースから東の街道を進めば辿り着ける。", "The injured scout asked me to devliver a letter to the king of Palmia. Palmia is located east of Vernis.")
+		s1 = lang("致命傷を負った斥候に、パルミアのジャビ王へ書簡を渡すよう頼まれた。パルミアには、ヴェルニースから東の街道を進めば辿り着ける。 3階相当", "The injured scout asked me to devliver a letter to the king of Palmia. Palmia is located east of Vernis.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 50 & gdata(GDATA_FLAG_MAIN) < 60 ) {
-		s1 = lang("ジャビ王によると、仕事が欲しい時は城の図書館にいるエリステアを訪ねればいいようだ。", "Eristia will have some tasks for me if I want to work for Palmia. She's in the library of the castle.")
+		s1 = lang("ジャビ王によると、仕事が欲しい時は城の図書館にいるエリステアを訪ねればいいようだ。 3階相当", "Eristia will have some tasks for me if I want to work for Palmia. She's in the library of the castle.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 60 & gdata(GDATA_FLAG_MAIN) < 100 ) {
-		s1 = lang("レシマスに赴き、冒険者カラムという人物を探すよう依頼された。彼は最低でもレシマスの16階より先の階層にいるらしい。", "Eristia asked to look for an adventurer called Karam in the dungeon of Lesimas. He was on the 16th level of the dungeon the last time he sent a report. I may have to go deeper if I am to find him.")
+		s1 = lang("レシマスに赴き、冒険者カラムという人物を探すよう依頼された。彼は最低でもレシマスの16階より先の階層にいるらしい。 16階相当", "Eristia asked to look for an adventurer called Karam in the dungeon of Lesimas. He was on the 16th level of the dungeon the last time he sent a report. I may have to go deeper if I am to find him.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 100 & gdata(GDATA_FLAG_MAIN) < 110 ) {
-		s1 = lang("瀕死のカラムから得た情報を、パルミアのエリステアに伝えなければならない。", "I need to bring information Karam gave me to Eristia at once.")
+		s1 = lang("瀕死のカラムから得た情報を、パルミアのエリステアに伝えなければならない。 16階相当", "I need to bring information Karam gave me to Eristia at once.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 110 & gdata(GDATA_FLAG_MAIN) < 125 ) {
-		s1 = lang("レシマス最下層の封印を解く為に必要な三つの魔石の入手を依頼された。賢者の魔石は《灼熱の塔》に、愚者の魔石は《死者の洞窟》に、覇者の魔石は《古城》にある。", "I need to find 3 magic stones to break the seal of Lesimas. They can be found at the Tower of Fire, the crypt of the damned and the Ancient Castle")
+		s1 = lang("レシマス最下層の封印を解く為に必要な三つの魔石の入手を依頼された。賢者の魔石は《灼熱の塔》に、愚者の魔石は《死者の洞窟》に、覇者の魔石は《古城》にある。 17〜28階相当", "I need to find 3 magic stones to break the seal of Lesimas. They can be found at the Tower of Fire, the crypt of the damned and the Ancient Castle")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 125 & gdata(GDATA_FLAG_MAIN) < 180 ) {
-		s1 = lang("三つの魔石の力で最下層の封印を解き、レシマスの秘宝を持ち帰るようエリステアに依頼された。", "With 3 magic stones I have, I need to get to the deepest level of Lesimas and break the seal. Then bring back an item called Hidden Artifact of Lesimas, whatever it is.")
+		s1 = lang("三つの魔石の力で最下層の封印を解き、レシマスの秘宝を持ち帰るようエリステアに依頼された。17〜55階相当", "With 3 magic stones I have, I need to get to the deepest level of Lesimas and break the seal. Then bring back an item called Hidden Artifact of Lesimas, whatever it is.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 180 & gdata(GDATA_FLAG_MAIN) < 210 ) {
-		s1 = lang("サウスティリスがあなたを呼んでいる。", "South Tyris calls me.")
+		s1 = lang("サウスティリスがあなたを呼んでいる。 55階相当", "South Tyris calls me.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 210 & gdata(GDATA_FLAG_MAIN) < 220 ) {
-		s1 = lang("サウスティリス中央部にある古代ネフィア《レミード遺跡》で、何かが見つかるかもしれない。", "I should check the dungeon called Rehmido. It's located center of Southteiris.")
+		s1 = lang("サウスティリス中央部にある古代ネフィア《レミード遺跡》で、何かが見つかるかもしれない。 55階相当", "I should check the dungeon called Rehmido. It's located center of Southteiris.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 220 & gdata(GDATA_FLAG_MAIN) < 221 ) {
-		s1 = lang("メルガスのラボにいるガベラという男に接触しよう。", "I should contact Gavela in the lab of Melugas .")
+		s1 = lang("メルガスのラボにいるガベラという男に接触しよう。 55階相当", "I should contact Gavela in the lab of Melugas .")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 223 & gdata(GDATA_FLAG_MAIN) < 250 ) {
-		s1 = lang("カードキーを発行してもらう代わりに依頼品を持ってくるようにガベラに言われている。", "I was told to bring out Gavela request instead take out a card key.")
+		s1 = lang("カードキーを発行してもらう代わりに依頼品を持ってくるようにガベラに言われている。 60〜80階相当", "I was told to bring out Gavela request instead take out a card key.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 250 & gdata(GDATA_FLAG_MAIN) < 266 ) {
-		s1 = lang("サウスティリス中央部にある古代ネフィア《レミード遺跡》に潜り調査部隊と合流しよう。", "I have to join forces of investigation in the  Rehmido.")
+		s1 = lang("サウスティリス中央部にある古代ネフィア《レミード遺跡》に潜り調査部隊と合流しよう。 100階相当", "I have to join forces of investigation in the  Rehmido.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 266 | gdata(GDATA_FLAG_MAIN) == 281 ) {
-		s1 = lang("ガベラに呼ばれている。一度メルガスへ行こう。", "I have been called to Gavela. I have to go to Melugas once.")
+		s1 = lang("ガベラに呼ばれている。一度メルガスへ行こう。 100階相当", "I have been called to Gavela. I have to go to Melugas once.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 267 & gdata(GDATA_FLAG_MAIN) < 281 ) {
-		s1 = lang("サウスティリス中央部にある古代ネフィア《レミード遺跡》に潜り調査部隊と合流しよう。", "I have to join forces of investigation in the  Rehmido.")
+		s1 = lang("サウスティリス中央部にある古代ネフィア《レミード遺跡》に潜り調査部隊と合流しよう。 100〜130階相当", "I have to join forces of investigation in the  Rehmido.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 282 & gdata(GDATA_FLAG_MAIN) < 290 ) {
-		s1 = lang("サウスティリス中央部にある古代ネフィア《レミード遺跡》に潜り調査部隊と合流しよう。", "I have to join forces of investigation in the  Rehmido.")
+		s1 = lang("サウスティリス中央部にある古代ネフィア《レミード遺跡》に潜り調査部隊と合流しよう。 100〜130階相当", "I have to join forces of investigation in the  Rehmido.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 290 & gdata(GDATA_FLAG_MAIN) < 295 ) {
-		s1 = lang("レミード最下層の怪物を倒せないかガベラに相談してみよう。", "I will have to talk Gavela to kill the monster in the bottom layer of Rehmido .")
+		s1 = lang("レミード最下層の怪物を倒せないかガベラに相談してみよう。 100〜130階相当", "I will have to talk Gavela to kill the monster in the bottom layer of Rehmido .")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 295 & gdata(GDATA_FLAG_MAIN) < 320 ) {
-		s1 = lang("エイレル南東の山岳地帯に行き、超高純度のエーテルを回収しガベラに渡そう。", "I went to the mountains of southeast Eirel to recover very high concentrations ether, and pass to Gavela.")
+		s1 = lang("エイレル南東の山岳地帯に行き、超高純度のエーテルを回収しガベラに渡そう。 100〜130階相当", "I went to the mountains of southeast Eirel to recover very high concentrations ether, and pass to Gavela.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 320 & gdata(GDATA_FLAG_MAIN) < 340 ) {
-		s1 = lang("レミード遺跡最下層の怪物を倒そう。", "I will beat the monster in the bottom layer of Rehmido.")
+		s1 = lang("レミード遺跡最下層の怪物を倒そう。 130階相当", "I will beat the monster in the bottom layer of Rehmido.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 340 & gdata(GDATA_FLAG_MAIN) < 345 ) {
-		s1 = lang("制圧した遺跡内を調査しよう。", "I need more search in Rehmido.")
+		s1 = lang("制圧した遺跡内を調査しよう。 130階相当", "I need more search in Rehmido.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 345 ) {
-		s1 = lang("地上へ帰ろう。", "I should return to ground.")
+		s1 = lang("地上へ帰ろう。 130階相当", "I should return to ground.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 350 ) {
-		s1 = lang("ノースティリスは今どうなっているだろう？関所を通過して様子を見に行こう。", "I will go to see the state of North Tyris through the north border.")
+		s1 = lang("ノースティリスは今どうなっているだろう？関所を通過して様子を見に行こう。 130階相当", "I will go to see the state of North Tyris through the north border.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 355 ) {
-		s1 = lang("パルミアで情報収集でもしようか。", "I am going to collect information at Palmia.")
+		s1 = lang("パルミアで情報収集でもしようか。 130階相当", "I am going to collect information at Palmia.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 360 | gdata(GDATA_FLAG_MAIN) == 361 ) {
-		s1 = lang("パルミアのエリステアと話をしてみよう。", "I should return to ground.")
+		s1 = lang("パルミアのエリステアと話をしてみよう。 130階相当", "I should return to ground.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 362 ) {
-		s1 = lang("ポート・カプールの船長に紹介状を見せよう。", "I should return to ground.")
+		s1 = lang("ポート・カプールの船長に紹介状を見せよう。 130階相当", "I should return to ground.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 363 & gdata(GDATA_FLAG_MAIN) < 365 ) {
-		s1 = lang("浮遊大陸にある西の森の遺跡に人が集まっているらしい。", "continue to be....")
+		s1 = lang("浮遊大陸にある西の森の遺跡に人が集まっているらしい。 130階相当", "continue to be....")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 365 ) {
-		s1 = lang("帰る方法を探そう。", "I should return to Tyris.")
+		s1 = lang("帰る方法を探そう。 130階相当", "I should return to Tyris.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 366 ) {
-		s1 = lang("メルガスでガベラに話をきこう。", "I should contact Gavela in the lab of Melugas.")
+		s1 = lang("メルガスでガベラに話をきこう。 130階相当", "I should contact Gavela in the lab of Melugas.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 367 & gdata(GDATA_FLAG_MAIN) < 370 ) {
-		s1 = lang("古の庭園からメルガストでロストイルヴァへ行き、調査してまわろう。", "I should research in LostIrva.")
+		s1 = lang("古の庭園からメルガストでロストイルヴァへ行き、調査してまわろう。 130階相当", "I should research in LostIrva.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 370 ) {
-		s1 = lang("ロストイルヴァの調査をしつつ神の間を目指そう。", "I should research in LostIrva.")
+		s1 = lang("ロストイルヴァの調査をしつつ神の間を目指そう。 140階相当", "I should research in LostIrva.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 370 & gdata(GDATA_FLAG_MAIN) < 400 ) {
-		s1 = lang("混沌の巨城の最深層、神の間を目指そう。", "I should aim for the bottom of Cradle of Chaos.")
+		s1 = lang("混沌の巨城の最深層、神の間を目指そう。 140階相当", "I should aim for the bottom of Cradle of Chaos.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 378 & gdata(GDATA_FLAG_MAIN) < 382 ) {
-		s1 = lang("一度、エリステアに銀熊のことを報告しよう。", "I need to bring information of the silver bear to Eristia at once.")
+		s1 = lang("一度、エリステアに銀熊のことを報告しよう。 140階相当", "I need to bring information of the silver bear to Eristia at once.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 382 & gdata(GDATA_FLAG_MAIN) < 394 ) {
-		s1 = lang("混沌の巨城の最深層、神の間を目指そう。", "I should aim for the bottom of Cradle of Chaos.")
+		s1 = lang("混沌の巨城の最深層、神の間を目指そう。 145階相当", "I should aim for the bottom of Cradle of Chaos.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 394 & gdata(GDATA_FLAG_MAIN) < 396 ) {
-		s1 = lang("ノルンの言うとおりにノースティリスと往復が出来るのか確かめよう。", "I will ascertain whether I can back and forth with the NorthTyris.")
+		s1 = lang("ノルンの言うとおりにノースティリスと往復が出来るのか確かめよう。 145階相当", "I will ascertain whether I can back and forth with the NorthTyris.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 396 & gdata(GDATA_FLAG_MAIN) < 398 ) {
-		s1 = lang("サウスティリスの方向から、何かに呼ばれているような感覚がする。", "I feel like has been called by something from SouthTyris.")
+		s1 = lang("サウスティリスの方向から、何かに呼ばれているような感覚がする。 145階相当", "I feel like has been called by something from SouthTyris.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 398 & gdata(GDATA_FLAG_MAIN) < 400 ) {
-		s1 = lang("海底から城が浮上し、世界が狂気に包まれようとしている。城へはサウスティリス南西のヴァルムから行ける。", "Castle has emerged from the sea floor, the world is about to be wrapped in madness. I can go to the castle from Valm of SouthTyris southwest.")
+		s1 = lang("海底から城が浮上し、世界が狂気に包まれようとしている。城へはサウスティリス南西のヴァルムから行ける。 160階相当", "Castle has emerged from the sea floor, the world is about to be wrapped in madness. I can go to the castle from Valm of SouthTyris southwest.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 400 & gdata(GDATA_FLAG_MAIN) < 440 ) {
-		s1 = lang("パルミアのエリステアから依頼を受けよう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("パルミアのエリステアから依頼を受けよう。 160階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) > 0 & gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) < 100 ) {
-		s1 = lang("関所にいるエユルとともに生体兵器を殲滅しよう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("関所にいるエユルとともに生体兵器を殲滅しよう。 150階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) >= 100 & gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) < 1000 ) {
-		s1 = lang("生体兵器の殲滅をエリステアに報告しよう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("生体兵器の殲滅をエリステアに報告しよう。 150階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_SUB_REGULUS_MAYROON) > 0 & gdata(GDATA_FLAG_SUB_REGULUS_MAYROON) < 100 ) {
-		s1 = lang("ノイエルにいるマルカとともにメイルーンへ悪魔討伐に向かおう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("ノイエルにいるマルカとともにメイルーンへ悪魔討伐に向かおう。 160階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_SUB_REGULUS_MAYROON) >= 100 & gdata(GDATA_FLAG_SUB_REGULUS_MAYROON) < 1000 ) {
-		s1 = lang("メイルーンの悪魔の討伐をエリステアに報告しよう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("メイルーンの悪魔の討伐をエリステアに報告しよう。 160階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_SUB_REGULUS_EULDERNA) > 0 & gdata(GDATA_FLAG_SUB_REGULUS_EULDERNA) < 100 ) {
-		s1 = lang("ロストイルヴァの魔導船にいるライゼルとともにエウダーナへ悪魔討伐に向かおう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("ロストイルヴァの魔導船にいるライゼルとともにエウダーナへ悪魔討伐に向かおう。 160階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_SUB_REGULUS_EULDERNA) >= 100 & gdata(GDATA_FLAG_SUB_REGULUS_EULDERNA) < 1000 ) {
-		s1 = lang("エウダーナの悪魔の討伐をエリステアに報告しよう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("エウダーナの悪魔の討伐をエリステアに報告しよう。 160階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_SUB_REGULUS_KIKKASU) > 0 & gdata(GDATA_FLAG_SUB_REGULUS_KIKKASU) < 100 ) {
-		s1 = lang("ロストイルヴァ北端に存在する神艦から傭兵と一緒にキッカスへ悪魔討伐に向かおう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("ロストイルヴァ北端に存在する神艦から傭兵と一緒にキッカスへ悪魔討伐に向かおう。 160階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_SUB_REGULUS_KIKKASU) >= 100 & gdata(GDATA_FLAG_SUB_REGULUS_KIKKASU) < 1000 ) {
-		s1 = lang("キッカスの悪魔の討伐をエリステアに報告しよう。", "Sorry, this is untranslated sentence.")
+		s1 = lang("キッカスの悪魔の討伐をエリステアに報告しよう。 160階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 440 & gdata(GDATA_FLAG_MAIN) < 455 ) {
 		s1 = lang("メルガスへ行き依頼を確認しよう。", "I have to go to Melugas once.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 455 & gdata(GDATA_FLAG_MAIN) < 480 ) {
-		s1 = lang("混沌の巨城、10階の敵を倒そう。 ", "Sorry, this is untranslated sentence.")
+		s1 = lang("混沌の巨城、10階の敵を倒そう。 180階相当", "Sorry, this is untranslated sentence.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) == 480 ) {
-		s1 = lang("悪魔の討伐をガベラに報告しよう。", "I should report to Gavela in the lab of Melugas.")
+		s1 = lang("悪魔の討伐をガベラに報告しよう。 180階相当", "I should report to Gavela in the lab of Melugas.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 490 & gdata(GDATA_FLAG_MAIN) < 685 ) {
-		s1 = lang("混沌の巨城の最深層、神の間を目指そう。", "I should aim for the bottom of Cradle of Chaos.")
+		s1 = lang("混沌の巨城の最深層、神の間を目指そう。 180〜200階相当", "I should aim for the bottom of Cradle of Chaos.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 685 & gdata(GDATA_FLAG_MAIN) < 695 ) {
-		s1 = lang("神立図書館でソピアーと話そう。", "I have to talk with <Sophia> at Sacred Library of Irva.")
+		s1 = lang("神立図書館でソピアーと話そう。 180〜200階相当", "I have to talk with <Sophia> at Sacred Library of Irva.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 695 & gdata(GDATA_FLAG_MAIN) < 700 ) {
-		s1 = lang("混沌の巨城の最深層、神の間を目指そう。", "I should aim for the bottom of Cradle of Chaos.")
+		s1 = lang("混沌の巨城の最深層、神の間を目指そう。180〜200階相当", "I should aim for the bottom of Cradle of Chaos.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 700 & gdata(GDATA_FLAG_MAIN) < 720 ) {
-		s1 = lang("混沌の神を倒す時が来た。", "It is time to beat the god of chaos.")
+		s1 = lang("混沌の神を倒す時が来た。 200階相当", "It is time to beat the god of chaos.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 720 & gdata(GDATA_FLAG_MAIN) < 760 ) {
-		s1 = lang("混沌の超児を無力化しよう。", "I have to disable Chaos Child.")
+		s1 = lang("混沌の超児を無力化しよう。 200階相当", "I have to disable Chaos Child.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 760 & gdata(GDATA_FLAG_MAIN) < 770 ) {
-		s1 = lang("ロストイルヴァは平和になっただろうか？", "If I become a spare time, I will do request of Norne.")
+		s1 = lang("ロストイルヴァは平和になっただろうか？ 200階相当", "If I become a spare time, I will do request of Norne.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 770 & gdata(GDATA_FLAG_MAIN) < 780 ) {
-		s1 = lang("気が向いたらノルンの頼み通りヴェルニースに向かおう。", "If I become a spare time, I will do request of Norne.")
+		s1 = lang("気が向いたらノルンの頼み通りヴェルニースに向かおう。 200階相当", "If I become a spare time, I will do request of Norne.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 780 & gdata(GDATA_FLAG_MAIN) < 850 ) {
-		s1 = lang("ロイターと接触して世界を行き来しつつ、探索していこう。", "Let's explore while traveling around the world by speaking with <Loyter>.")
+		s1 = lang("ロイターと接触して世界を行き来しつつ、探索していこう。 200階相当", "Let's explore while traveling around the world by speaking with <Loyter>.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 850 & gdata(GDATA_FLAG_MAIN) < 950 ) {
-		s1 = lang("ロイターと接触して世界を行き来しつつ、探索していこう。", "Let's explore while traveling around the world by speaking with <Loyter>.")
+		s1 = lang("ロイターと接触して世界を行き来しつつ、探索していこう。 200階相当", "Let's explore while traveling around the world by speaking with <Loyter>.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 820 & gdata(GDATA_FLAG_MAIN) < 850 ) {
-		s1 = lang("混沌の巨城の最深層、神の間を再び目指そう。", "I should aim for the bottom of Cradle of Chaos again.")
+		s1 = lang("混沌の巨城の最深層、神の間を再び目指そう。 200階相当", "I should aim for the bottom of Cradle of Chaos again.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 850 & gdata(GDATA_FLAG_MAIN) < 1000 ) {
 		s1 = lang("最後まであきらめずに戦おう。", "I will fight until the end without giving up.")
 	}
 	if ( gdata(GDATA_FLAG_MAIN) >= 1000 & gdata(GDATA_FLAG_MAIN) < 1010 ) {
@@ -17029,18 +17048,18 @@
 		buff += s0
 	}
 	noteadd ""
 	return
 
-*quest_info2
+*itemNameSub
 	if ( val == 0 ) {
 		noteadd ""
 		noteadd lang("@QM[サブクエスト]", "@QM[Sub Quest]")
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_SLIME) != 0 ) {
-		s = lang("ぬいぐるみを守れ！ Lv6相当", "Putit attacks Lv6")
+		s = lang("ぬいぐるみを守れ！ 6階相当", "Putit attacks Lv6")
 		p = gdata(GDATA_FLAG_SUB_SLIME)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17062,11 +17081,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_ROGUE) != 0 ) {
-		s = lang("お酒泥棒 Lv2相当", "Thieves' hideout Lv2")
+		s = lang("お酒泥棒 2階相当", "Thieves' hideout Lv2")
 		p = gdata(GDATA_FLAG_SUB_ROGUE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17088,11 +17107,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_DOG) != 0 ) {
-		s = lang("迷子の子犬 Lv4相当", "Puppy's cave Lv4")
+		s = lang("迷子の子犬 4階相当", "Puppy's cave Lv4")
 		p = gdata(GDATA_FLAG_SUB_DOG)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17106,11 +17125,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_NIGHTMARE) != 0 ) {
-		s = lang("実験場のナイトメア Lv50相当", "Nightmare Lv50")
+		s = lang("実験場のナイトメア 50階相当", "Nightmare Lv50")
 		p = gdata(GDATA_FLAG_SUB_NIGHTMARE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17140,11 +17159,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_MOTHER) != 0 ) {
-		s = lang("エーテル病を治せ Lv20相当", "Pael and her mom Lv20")
+		s = lang("エーテル病を治せ 20階相当", "Pael and her mom Lv20")
 		p = gdata(GDATA_FLAG_SUB_MOTHER)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17230,11 +17249,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_WIFE) != 0 ) {
-		s = lang("嫁泥棒 Lv3相当", "Wife collector LV3")
+		s = lang("嫁泥棒 3階相当", "Wife collector LV3")
 		p = gdata(GDATA_FLAG_SUB_WIFE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17248,11 +17267,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_CAT) != 0 ) {
-		s = lang("猫退治 Lv25相当", "Cat house Lv25")
+		s = lang("猫退治 25階相当", "Cat house Lv25")
 		p = gdata(GDATA_FLAG_SUB_CAT)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17274,11 +17293,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_WAR) != 0 ) {
-		s = lang("防衛戦線の死闘 Lv17相当", "Defense line Lv17")
+		s = lang("防衛戦線の死闘 17階相当", "Defense line Lv17")
 		p = gdata(GDATA_FLAG_SUB_WAR)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17308,11 +17327,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_YEEK) != 0 ) {
-		s = lang("騎士昇格試験の手伝い Lv8相当", "Novice knightLv8")
+		s = lang("騎士昇格試験の手伝い 8階相当", "Novice knightLv8")
 		p = gdata(GDATA_FLAG_SUB_YEEK)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17334,11 +17353,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_KAMIKAZE) != 0 ) {
-		s = lang("カミカゼ特攻隊 Lv14相当", "Kamikaze attack Lv14")
+		s = lang("カミカゼ特攻隊 14階相当", "Kamikaze attack Lv14")
 		p = gdata(GDATA_FLAG_SUB_KAMIKAZE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17368,11 +17387,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_MIAS_DREAM) != 0 ) {
-		s = lang("ミーアの夢 Lv1相当", "Mia's dream Lv1")
+		s = lang("ミーアの夢 1階相当", "Mia's dream Lv1")
 		p = gdata(GDATA_FLAG_SUB_MIAS_DREAM)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17386,11 +17405,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_VEIN) != 0 ) {
-		s = lang("幻の絵本 Lv12相当", "Rare books Lv12")
+		s = lang("幻の絵本 12階相当", "Rare books Lv12")
 		p = gdata(GDATA_FLAG_SUB_VEIN)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17404,11 +17423,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_PYRAMID) != 0 ) {
-		s = lang("ピラミッドからの挑戦状 Lv16相当", "Pyramid trial Lv16")
+		s = lang("ピラミッドからの挑戦状 16階相当", "Pyramid trial Lv16")
 		p = gdata(GDATA_FLAG_SUB_PYRAMID)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17422,11 +17441,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_NUKE) != 0 ) {
-		s = lang("パルミアに赤い花を Lv14相当", "Red blossom in Palmia Lv14")
+		s = lang("パルミアに赤い花を 14階相当", "Red blossom in Palmia Lv14")
 		p = gdata(GDATA_FLAG_SUB_NUKE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17448,11 +17467,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_BIOLOGIST) != 0 ) {
-		s = lang("生化学者の野望 Lv5相当", "Ambitious scientist Lv5")
+		s = lang("生化学者の野望 5階相当", "Ambitious scientist Lv5")
 		p = gdata(GDATA_FLAG_SUB_BIOLOGIST)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17466,11 +17485,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_SEWER) != 0 ) {
-		s = lang("下水道大作戦 Lv23相当", "Sewer sweeping Lv23")
+		s = lang("下水道大作戦 23階相当", "Sewer sweeping Lv23")
 		p = gdata(GDATA_FLAG_SUB_SEWER)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17600,11 +17619,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_MINOTAUR) != 0 ) {
-		s = lang("ミノタウロスの王 Lv24相当", "Minotaur king Lv24")
+		s = lang("ミノタウロスの王 24階相当", "Minotaur king Lv24")
 		p = gdata(GDATA_FLAG_SUB_MINOTAUR)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17626,11 +17645,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_DADDY) != 0 ) {
-		s = lang("リトルシスター Lv30相当", "Little sister Lv30")
+		s = lang("リトルシスター 30階相当", "Little sister Lv30")
 		p = gdata(GDATA_FLAG_SUB_DADDY)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17644,11 +17663,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_FALLEN_PRINCESS) != 0 ) {
-		s = lang("堕ちた皇女 Lv80相当", "Fallen princess Lv80")
+		s = lang("堕ちた皇女 80階相当", "Fallen princess Lv80")
 		p = gdata(GDATA_FLAG_SUB_FALLEN_PRINCESS)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17678,11 +17697,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_LOST_KITTY) != 0 ) {
-		s = lang("迷子の子猫ちゃん Lv5相当", "Lost kitty Lv5")
+		s = lang("迷子の子猫ちゃん 5階相当", "Lost kitty Lv5")
 		p = gdata(GDATA_FLAG_SUB_LOST_KITTY)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17696,11 +17715,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_DIVERSIONARY_TACTICS) != 0 ) {
-		s = lang("陽動作戦 Lv60相当", "Demonstration Lv60")
+		s = lang("陽動作戦 60階相当", "Demonstration Lv60")
 		p = gdata(GDATA_FLAG_SUB_DIVERSIONARY_TACTICS)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17730,11 +17749,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_JUERES_IMPERTINENCE) != 0 ) {
-		s = lang("ジューアのくせに生意気だ Lv50相当", "Control of underground passage Lv50")
+		s = lang("ジューアのくせに生意気だ 50階相当", "Control of underground passage Lv50")
 		p = gdata(GDATA_FLAG_SUB_JUERES_IMPERTINENCE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17756,11 +17775,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_PIRATE_HUNTING) != 0 ) {
-		s = lang("海賊狩り Lv100相当", "Pirate huntting Lv100")
+		s = lang("海賊狩り 100階相当", "Pirate huntting Lv100")
 		p = gdata(GDATA_FLAG_SUB_PIRATE_HUNTING)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17790,11 +17809,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_UNPAID_COMPENSATION) != 0 ) {
-		s = lang("払われなかった報酬 Lv2相当", "Resentment of remuneration Lv2")
+		s = lang("払われなかった報酬 2階相当", "Resentment of remuneration Lv2")
 		p = gdata(GDATA_FLAG_SUB_UNPAID_COMPENSATION)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17808,11 +17827,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_THE_RESULT_OF_REVENGE) != 0 ) {
-		s = lang("復讐の果てに Lv40相当", "Revenge mountain Lv40")
+		s = lang("復讐の果てに 40階相当", "Revenge mountain Lv40")
 		p = gdata(GDATA_FLAG_SUB_THE_RESULT_OF_REVENGE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17834,11 +17853,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_MANSION_FOR_SALE) != 0 ) {
-		s = lang("屋敷売り出し中！ Lv70相当", "Maid and house Lv70")
+		s = lang("屋敷売り出し中！ 70階相当", "Maid and house Lv70")
 		p = gdata(GDATA_FLAG_SUB_MANSION_FOR_SALE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17860,11 +17879,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_PRINCESS_COMPANION) != 0 ) {
-		s = lang("姫の話し相手 Lv1相当", "Companion of Princess Lv1")
+		s = lang("姫の話し相手 1階相当", "Companion of Princess Lv1")
 		p = gdata(GDATA_FLAG_SUB_PRINCESS_COMPANION)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17878,11 +17897,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_H_SISTER) != 0 ) {
-		s = lang("えっちないもうと Lv80相当", "Removal of sister Lv80")
+		s = lang("えっちないもうと 80階相当", "Removal of sister Lv80")
 		p = gdata(GDATA_FLAG_SUB_H_SISTER)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17904,11 +17923,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_STRUGGLE_AGAINST_INSANITY) != 0 ) {
-		s = lang("狂気との戦い Lv30相当", "Struggle against insanity Lv30")
+		s = lang("狂気との戦い 30階相当", "Struggle against insanity Lv30")
 		p = gdata(GDATA_FLAG_SUB_STRUGGLE_AGAINST_INSANITY)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17922,11 +17941,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_MONOCHROME_DELIVERY_SERVICE) != 0 ) {
-		s = lang("モノクロ定期便 Lv10相当", "Outrageous revenge Lv2")
+		s = lang("モノクロ定期便 10階相当", "Outrageous revenge Lv2")
 		p = gdata(GDATA_FLAG_SUB_MONOCHROME_DELIVERY_SERVICE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17940,11 +17959,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_MONOCHROME_DELIVERY_SERVICE) != 0 ) {
-		s = lang("モノクロ定期便 Lv10相当", "Outrageous revenge Lv2")
+		s = lang("モノクロ定期便 10階相当", "Outrageous revenge Lv2")
 		p = gdata(GDATA_FLAG_SUB_MONOCHROME_DELIVERY_SERVICE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17958,11 +17977,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_MONOCHROME_DELIVERY_SERVICE) != 0 ) {
-		s = lang("モノクロ定期便 Lv10相当", "Outrageous revenge Lv2")
+		s = lang("モノクロ定期便 10階相当", "Outrageous revenge Lv2")
 		p = gdata(GDATA_FLAG_SUB_MONOCHROME_DELIVERY_SERVICE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -17976,11 +17995,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_LAW_OF_NINJAS) != 0 ) {
-		s = lang("忍者の掟 Lv120相当", "Rule of Ninja Lv120")
+		s = lang("忍者の掟 120階相当", "Rule of Ninja Lv120")
 		p = gdata(GDATA_FLAG_SUB_LAW_OF_NINJAS)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18010,11 +18029,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_GUILD_WARS1) != 0 ) {
-		s = lang("ギルドウォーズ Lv40相当", "Guild quest Lv40")
+		s = lang("ギルドウォーズ 40階相当", "Guild quest Lv40")
 		p = gdata(GDATA_FLAG_SUB_GUILD_WARS1)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18036,11 +18055,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_GUILD_WARS3) != 0 ) {
-		s = lang("ギルドウォーズ Lv40相当", "Guild quest Lv40")
+		s = lang("ギルドウォーズ 40階相当", "Guild quest Lv40")
 		p = gdata(GDATA_FLAG_SUB_GUILD_WARS3)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18062,11 +18081,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_GUILD_WARS2) != 0 ) {
-		s = lang("ギルドウォーズ Lv40相当", "Guild quest Lv40")
+		s = lang("ギルドウォーズ 40階相当", "Guild quest Lv40")
 		p = gdata(GDATA_FLAG_SUB_GUILD_WARS2)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18088,11 +18107,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_DOGS_TAIL) != 0 ) {
-		s = lang("犬の尻尾 Lv150相当", "Dog tail Lv150")
+		s = lang("犬の尻尾 150階相当", "Dog tail Lv150")
 		p = gdata(GDATA_FLAG_SUB_DOGS_TAIL)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18114,11 +18133,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_THE_LIFE_IN_THIS_WORLD) != 0 ) {
-		s = lang("この世界に生きる者 Lv50相当", "Live in this world Lv50")
+		s = lang("この世界に生きる者 50階相当", "Live in this world Lv50")
 		p = gdata(GDATA_FLAG_SUB_THE_LIFE_IN_THIS_WORLD)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18132,11 +18151,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_THE_TRUE_APPEARANCE) != 0 ) {
-		s = lang("ありのままの姿を Lv40相当", "Insect curse Lv40")
+		s = lang("ありのままの姿を 40階相当", "Insect curse Lv40")
 		p = gdata(GDATA_FLAG_SUB_THE_TRUE_APPEARANCE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18166,11 +18185,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_THE_ABYSS_OF_MAGIC) != 0 ) {
-		s = lang("魔術の深淵 Lv130相当", " Lv130")
+		s = lang("魔術の深淵 130階相当", " Lv130")
 		p = gdata(GDATA_FLAG_SUB_THE_ABYSS_OF_MAGIC)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18192,11 +18211,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_THE_DISTANT_SEA_OF_STARS) != 0 ) {
-		s = lang("遥かなる星の海から Lv140相当", "From the sea of stars Lv140")
+		s = lang("遥かなる星の海から 140階相当", "From the sea of stars Lv140")
 		p = gdata(GDATA_FLAG_SUB_THE_DISTANT_SEA_OF_STARS)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18226,11 +18245,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_URCAGUARY_THE_TENACIOUS_GEM) != 0 ) {
-		s = lang("剛石のウリカグアル Lv150相当", "Mission from Urcaguary Lv150")
+		s = lang("剛石のウリカグアル 150階相当", "Mission from Urcaguary Lv150")
 		p = gdata(GDATA_FLAG_SUB_URCAGUARY_THE_TENACIOUS_GEM)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18253,11 +18272,11 @@
 		}
 	}
 	if ( gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE) != 0 ) {
 		p = 0
 		if ( gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE) != 0 ) {
-			s = lang("叡智のソピアー Lv150相当", "Mission from Sophia Lv150")
+			s = lang("叡智のソピアー 150階相当", "Mission from Sophia Lv150")
 			p = gdata(GDATA_FLAG_SUB_SOPHIA_THE_WISE)
 			if ( val == 1 ) {
 				if ( p >= 1000 ) {
 					noteadd lang("[達成]", "[Done]") + s
 				}
@@ -18285,11 +18304,11 @@
 		}
 	}
 	if ( gdata(GDATA_FLAG_SUB_AMURDAD) != 0 ) {
 		p = 0
 		if ( gdata(GDATA_FLAG_SUB_AMURDAD) != 0 ) {
-			s = lang("永遠のネヘルタード Lv150相当", "Mission from Amurdad Lv150")
+			s = lang("永遠のネヘルタード 150階相当", "Mission from Amurdad Lv150")
 			p = gdata(GDATA_FLAG_SUB_AMURDAD)
 			if ( val == 1 ) {
 				if ( p >= 1000 ) {
 					noteadd lang("[達成]", "[Done]") + s
 				}
@@ -18327,11 +18346,11 @@
 		}
 	}
 	if ( gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) != 0 ) {
 		p = 0
 		if ( gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) != 0 ) {
-			s = lang("鉄騎のガルジエム Lv150相当", "Mission from Garziem Lv150")
+			s = lang("鉄騎のガルジエム 150階相当", "Mission from Garziem Lv150")
 			p = gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM)
 			if ( val == 1 ) {
 				if ( p >= 1000 ) {
 					noteadd lang("[達成]", "[Done]") + s
 				}
@@ -18369,11 +18388,11 @@
 		}
 	}
 	if ( gdata(GDATA_FLAG_SUB_KARAVIKA_OF_SONG_AND_DANCE) != 0 ) {
 		p = 0
 		if ( gdata(GDATA_FLAG_SUB_KARAVIKA_OF_SONG_AND_DANCE) != 0 ) {
-			s = lang("歌踊のカラヴィカ Lv150相当", "Mission from Karavika Lv150")
+			s = lang("歌踊のカラヴィカ 150階相当", "Mission from Karavika Lv150")
 			p = gdata(GDATA_FLAG_SUB_KARAVIKA_OF_SONG_AND_DANCE)
 			if ( val == 1 ) {
 				if ( p >= 1000 ) {
 					noteadd lang("[達成]", "[Done]") + s
 				}
@@ -18401,11 +18420,11 @@
 		}
 	}
 	if ( gdata(GDATA_FLAG_SUB_ARASIEL_OF_THE_SANDSTORM) != 0 ) {
 		p = 0
 		if ( gdata(GDATA_FLAG_SUB_ARASIEL_OF_THE_SANDSTORM) != 0 ) {
-			s = lang("砂嵐のラシエル Lv150相当", "Mission from Arasiel Lv150")
+			s = lang("砂嵐のラシエル 150階相当", "Mission from Arasiel Lv150")
 			p = gdata(GDATA_FLAG_SUB_ARASIEL_OF_THE_SANDSTORM)
 			if ( val == 1 ) {
 				if ( p >= 1000 ) {
 					noteadd lang("[達成]", "[Done]") + s
 				}
@@ -18432,11 +18451,11 @@
 			}
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_BEYOND_THE_GENERATIONS) != 0 ) {
-		s = lang("幾百もの世を越えて Lv20相当", "Beyond the generations Lv20")
+		s = lang("幾百もの世を越えて 20階相当", "Beyond the generations Lv20")
 		p = gdata(GDATA_FLAG_SUB_BEYOND_THE_GENERATIONS)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18514,11 +18533,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_WHEN_THE_FLAME_BURNS_OUT) != 0 ) {
-		s = lang("炎、燃え尽きる時 Lv160相当", "Ancient fire dragon Lv160")
+		s = lang("炎、燃え尽きる時 160階相当", "Ancient fire dragon Lv160")
 		p = gdata(GDATA_FLAG_SUB_WHEN_THE_FLAME_BURNS_OUT)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18540,11 +18559,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_LEOLD_JOB_STAGE) != 0 ) {
-		s = lang("更なる高みを Lv" + gdata(GDATA_FLAG_LEOLD_JOB_TIER) + "相当", "Reach new heights Lv" + gdata(GDATA_FLAG_LEOLD_JOB_TIER) + " ")
+		s = lang("更なる高みを " + gdata(GDATA_FLAG_LEOLD_JOB_TIER) + "階相当", "Reach new heights Lv" + gdata(GDATA_FLAG_LEOLD_JOB_TIER) + " ")
 		p = gdata(GDATA_FLAG_LEOLD_JOB_STAGE)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -18566,11 +18585,11 @@
 			noteadd ""
 		}
 	}
 	p = 0
 	if ( gdata(GDATA_FLAG_SUB_RESEARCH_DESTRUCTION_CRISIS) != 0 ) {
-		s = lang("調査隊壊滅の危機 Lv180相当", "Researcher crisis Lv180")
+		s = lang("調査隊壊滅の危機 180階相当", "Researcher crisis Lv180")
 		p = gdata(GDATA_FLAG_SUB_RESEARCH_DESTRUCTION_CRISIS)
 		if ( val == 1 ) {
 			if ( p >= 1000 ) {
 				noteadd lang("[達成]", "[Done]") + s
 			}
@@ -19707,11 +19726,11 @@
 	dim floorstack, 400
 	sdim key_list, 2, 20
 	sdim playerheader, 100
 	sdim artifactlocation
 	sdim newsbuff
-	sdim soundfile, 30, 302
+	sdim soundfile, 30, 303
 	sdim musicfile, 30, 137 + 5
 	dim slight, inf_screenw + 4, inf_screenh + 4
 	dim slightbk, inf_screenw + 4, inf_screenh + 4
 	gsel BUFFER_INF
 	gmode 0
@@ -19762,11 +19781,11 @@
 	gosub *db_setFilterRace
 	gosub *db_setFilterCreature
 	gosub *db_setFilterItem
 	gosub *chip_init
 	gosub *building_init
-	gosub *setArea
+	gosub *label_4932
 	gosub *setCellObj
 	gosub *random_titleInit
 	gdata(GDATA_RAND_SEED_A) = rnd(800) + 2
 	gdata(GDATA_RAND_SEED_B) = rnd(200) + 2
 	gosub *god_init
@@ -19780,11 +19799,11 @@
 	gosub *convertartifact_WEND1
 	gosub *item_foodInit
 	gosub *recipe_init
 	gosub *fish_init
 	gosub *map_randNameInit
-	gosub *setHome
+	gosub *label_4578
 	gosub *label_0003
 	gosub *userNpc_update
 	if ( cfg_music == 1 ) {
 		DMINIT
 		if ( stat == 0 ) {
@@ -19856,11 +19875,11 @@
 		goto *exit_game
 	}
 	else {
 		errorhack++
 	}
-	buf = "HspError " + wparam + " WinError " + GetLastError() + " Ver " + int(double("6.13") * 1000) + " Mode " + mode + "\n"
+	buf = "HspError " + wparam + " WinError " + GetLastError() + " Ver " + int(double("6.14") * 1000) + " Mode " + mode + "\n"
 	buf += "efId " + efid + " efP " + efp + " Area " + gdata(GDATA_AREA) + "/" + gdata(GDATA_LEVEL) + "\n"
 	buf += "ci "
 	if ( ci < 200 ) {
 		buf += "0"
 		if ( ci >= 0 ) {
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/item.hsp ../2.14-borscht/item.hsp
--- ../2.13-borscht/item.hsp	2022-06-26 12:14:16.660207800 -0700
+++ ../2.14-borscht/item.hsp	2022-09-18 12:37:01.516298800 -0700
@@ -132,11 +132,11 @@
 		}
 	loop
 	magebookn = lang("ヴォイニッチ写本", "Voynich Manuscript"), lang("ドール賛歌", "Dhol Chants"), lang("ポナペ教教典", "Ponape Scripture"), lang("グラーキ黙示録", "Revelations of Glaaki"), lang("グ＝ハーン断章", "G'harne Fragments"), lang("断罪の書", "Liber Damnatus"), lang("ドジアンの書", "Book of Dzyan"), lang("エイボンの書", "Book of Eibon"), lang("大いなる教書", "Grand Grimoire"), lang("セラエノ断章", "Celaeno Fragments"), lang("ネクロノミコン", "Necronomicon"), lang("ルルイエ異本", "The R'lyeh Text"), lang("エルトダウン・シャールズ", "Eltdown Shards"), lang("金枝篇", "The Golden Bough"), lang("終焉の書", "Apocalypse"), lang("真なる終焉の書", "True Apocalypse")
 	return
 
-*item_loot
+*label_4225
 	if ( rc == CHARA_PLAYER ) {
 		if ( gdata(GDATA_QUEST) != QUEST_TYPE_NONE ) {
 			return
 		}
 		inv_getheader rc
@@ -636,11 +636,11 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_ITEM_POTION
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND1
+		goto *label_4228
 		_switch_sw++
 	}
 	if ( _switch_val == 7 | _switch_sw ) {
 		_switch_sw = 0
 		if ( rnd(20) == 0 ) {
@@ -648,11 +648,11 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_ITEM_POTION
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND1
+		goto *label_4228
 		_switch_sw++
 	}
 	if ( _switch_val == 3 | _switch_sw ) {
 		_switch_sw = 0
 		if ( rnd(20) == 0 ) {
@@ -660,11 +660,11 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_ITEM_POTION
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND1
+		goto *label_4228
 		_switch_sw++
 	}
 	if ( _switch_val == 2 | _switch_sw ) {
 		_switch_sw = 0
 		if ( rnd(20) == 0 ) {
@@ -679,11 +679,11 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_ITEM_SPELLBOOK
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND1
+		goto *label_4228
 		_switch_sw++
 	}
 	if ( _switch_val == 4 | _switch_sw ) {
 		_switch_sw = 0
 		if ( rnd(20) == 0 ) {
@@ -691,11 +691,11 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_ITEM_POTION
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND1
+		goto *label_4228
 		_switch_sw++
 	}
 	if ( _switch_val == 5 | _switch_sw ) {
 		_switch_sw = 0
 		if ( rnd(50) == 0 ) {
@@ -703,14 +703,14 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_ITEM_SPELLBOOK
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND1
+		goto *label_4228
 	}
 
-*item_loot_SWEND1
+*label_4228
 	_switch_val = refchara(cdata(CDATA_ID, rc), DBSPEC_CHARA_LOOT)
 	if ( 0 ) {
 		_switch_sw++
 	}
 	if ( _switch_val == 3 | _switch_sw ) {
@@ -748,11 +748,11 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_GOLD
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND2
+		goto *label_4229
 		_switch_sw++
 	}
 	if ( _switch_val == 1 | _switch_sw ) {
 		_switch_sw = 0
 		if ( gdata(GDATA_FLAG_FLESH_DOLL_LOOT_SPAWN) == 0 & gdata(GDATA_FLAG_TALKING_USED) == 0 ) {
@@ -763,11 +763,11 @@
 				flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 				itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 				remain_make ci, rc
 			}
 		}
-		goto *item_loot_SWEND2
+		goto *label_4229
 		_switch_sw++
 	}
 	if ( _switch_val == 2 | _switch_sw ) {
 		_switch_sw = 0
 		if ( gdata(GDATA_FLAG_FLESH_DOLL_LOOT_SPAWN) == 0 & gdata(GDATA_FLAG_TALKING_USED) == 0 ) {
@@ -778,11 +778,11 @@
 				flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 				itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 				remain_make ci, rc
 			}
 		}
-		goto *item_loot_SWEND2
+		goto *label_4229
 		_switch_sw++
 	}
 	if ( _switch_val == 6 | _switch_sw ) {
 		_switch_sw = 0
 		if ( rnd(10) == 0 ) {
@@ -839,11 +839,11 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_ORE
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND2
+		goto *label_4229
 		_switch_sw++
 	}
 	if ( _switch_val == 4 | _switch_sw ) {
 		_switch_sw = 0
 		if ( rnd(5) == 0 ) {
@@ -872,11 +872,11 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_GOLD
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND2
+		goto *label_4229
 		_switch_sw++
 	}
 	if ( _switch_val == 5 | _switch_sw ) {
 		_switch_sw = 0
 		if ( rnd(5) == 0 ) {
@@ -933,14 +933,14 @@
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_ORE
 			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, rc), cdata(CDATA_Y, rc), 0
 		}
-		goto *item_loot_SWEND2
+		goto *label_4229
 	}
 
-*item_loot_SWEND2
+*label_4229
 	if ( gdata(GDATA_FLAG_FLESH_DOLL_LOOT_SPAWN) == 0 & gdata(GDATA_FLAG_TALKING_USED) == 0 ) {
 		if ( rnd(40) == 0 ) {
 			p = 0
 			flt calcobjlv(cdata(CDATA_LEVEL, tc)), calcfixlv(FIX_QUALITY_GOOD)
 			flttypemajor = FILTER_REMAINS
@@ -1872,60 +1872,60 @@
 		if ( cdata(cnt, cc) \ EXT_EQUIP_SLOTS == 0 ) {
 			continue
 		}
 		ci = cdata(cnt, cc) \ EXT_EQUIP_SLOTS - 1
 		repeat 15
-			if ( inv(40 + cnt * 2, ci) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 				break
 			}
-			if ( inv(40 + cnt * 2, ci) == 21 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 21 ) {
 				if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
-					if ( rnd(25) < limit(abs(inv(40 + cnt * 2 + 1, ci)) / 50, 1, 25) ) {
+					if ( rnd(25) < limit(abs(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci)) / 50, 1, 25) ) {
 						efid = SKILL_SPELL_TELEPORT
 						tc = cc
 						gosub *effect
 						continue
 					}
 				}
 			}
-			if ( inv(40 + cnt * 2, ci) == 45 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 45 ) {
 				if ( rnd(4) == 0 ) {
 					if ( synccheck(cc, -1) ) {
 						txtef COLOR_PURPLE
 						txt lang("何かが" + name(cc) + "の血を吸った。", "Something sucks " + name(cc) + your(cc) + " blood.")
 					}
-					cdata(CDATA_CONDITION_BLEED, cc) += abs(inv(40 + cnt * 2 + 1, ci)) / 25 + 3
+					cdata(CDATA_CONDITION_BLEED, cc) += abs(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci)) / 25 + 3
 					continue
 				}
 			}
-			if ( inv(40 + cnt * 2, ci) == 72 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 72 ) {
 				if ( rnd(5) == 0 ) {
 					if ( synccheck(cc, -1) ) {
 						txtef COLOR_PURPLE
 						txt lang("何かが" + name(cc) + "のMPを吸った。", "Something sucks " + name(cc) + your(cc) + " MP.")
 					}
-					cdata(CDATA_CONDITION_MPOISON, cc) += abs(inv(40 + cnt * 2 + 1, ci)) / 50 + 3
+					cdata(CDATA_CONDITION_MPOISON, cc) += abs(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci)) / 50 + 3
 					continue
 				}
 			}
-			if ( inv(40 + cnt * 2, ci) == 46 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 46 ) {
 				if ( rnd(20) == 0 ) {
 					if ( synccheck(cc, -1) ) {
 						txtef COLOR_PURPLE
 						txt lang(name(cc) + "は未熟になった。", name(cc) + " become" + _s(cc) + " inexperienced.")
 					}
-					cdata(CDATA_EXP, cc) -= cdata(CDATA_EXP_TO_NEXT_LVL, cc) / (300 - limit(abs(inv(40 + cnt * 2 + 1, ci)) / 2, 0, 50)) + rnd(100)
+					cdata(CDATA_EXP, cc) -= cdata(CDATA_EXP_TO_NEXT_LVL, cc) / (300 - limit(abs(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci)) / 2, 0, 50)) + rnd(100)
 					if ( cdata(CDATA_EXP, cc) < 0 ) {
 						cdata(CDATA_EXP, cc) = 0
 					}
 					continue
 				}
 			}
-			if ( inv(40 + cnt * 2, ci) == 47 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 47 ) {
 				if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
 					if ( mdata(MDATA_TYPE) != MAP_TYPE_HOME ) {
-						if ( rnd(50) < limit(abs(inv(40 + cnt * 2 + 1, ci)) / 50, 1, 50) ) {
+						if ( rnd(50) < limit(abs(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci)) / 50, 1, 50) ) {
 							if ( synccheck(cc, -1) ) {
 								txtef COLOR_PURPLE
 								txt lang("魔力の渦が何かを召喚した！", "Several creatures are summoned from a vortex of magic.")
 							}
 							repeat 1 + rnd(3)
@@ -2601,11 +2601,11 @@
 					inv(INV_ITEM_KNOWN, ci) = ITEM_KNOWN_QUALITY
 				}
 			}
 		}
 	}
-	gosub *item_value
+	gosub *label_4251
 	itemturn ci
 	if ( initnum != 0 ) {
 		inv(INV_ITEM_NUM, ci) = initnum
 	}
 	if ( nostack == 1 ) {
@@ -2621,11 +2621,11 @@
 	if ( val == (-1) ) {
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 	}
 	return 1
 
-*item_value
+*label_4251
 	if ( reftype == FILTER_FURNITURE ) {
 		if ( inv(INV_ITEM_SUB_NAME, ci) != 0 ) {
 			inv(INV_ITEM_VALUE, ci) = inv(INV_ITEM_VALUE, ci) * (80 + inv(INV_ITEM_SUB_NAME, ci) * 20) / 100
 		}
 	}
@@ -2645,11 +2645,11 @@
 				continue
 			}
 			if ( iequiploc(cnt) == cdata(body, rc) / EXT_EQUIP_SLOTS ) {
 				ci = cnt
 				r1 = rc
-				gosub *act_equip
+				gosub *label_6352
 				if ( stat == 1 ) {
 					break
 				}
 			}
 		loop
@@ -2834,11 +2834,11 @@
 	}
 	if ( r1 > 2 ) {
 		skillexp SKILL_NORMAL_COOKING, cc, 30 + r1 * 5
 	}
 	item_stack CHARA_PLAYER, ci
-	gosub *calcBurdenPc
+	gosub *label_4102
 	return
 
 *eatEffect
 	tc = cc
 	dim fdlist, 2, 10
@@ -3519,11 +3519,11 @@
 		healsp cc, 5 + inv(INV_ITEM_PARAM2, ci) * 3 + inv(INV_ITEM_LEVEL, ci) * 3
 	}
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_CUTE_FAIRY ) {
 		if ( cdata(CDATA_RELATION, cc) == RELATION_ALLY ) {
 			if ( nutrition >= 1000 ) {
-				if ( cbit(CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, cc) != FALSE ) {
+				if ( cbit((974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), cc) != FALSE ) {
 					cibk = ci
 					gdata(GDATA_FLAG_CUTE_FAIRY_SEEDS_SPIT)++
 					flt
 					itemcreate -1, ITEM_ID_VEGETABLE_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 2
 					inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
@@ -3545,11 +3545,11 @@
 					else {
 						flt
 						itemcreate -1, ITEM_ID_GEM_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 2
 						inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
 					}
-					cbitmod CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, cc, FALSE
+					cbitmod (974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), cc, FALSE
 					txtef COLOR_SKY_BLUE
 					txtmore
 					txt lang("「げふぅ」" + name(cc) + "は種を吐き出した。", "「Ugh-Ughu」 " + name(cc) + " spews up " + itemname(ci, 1) + ".")
 					ci = cibk
 				}
@@ -3557,16 +3557,16 @@
 		}
 	}
 	if ( cdata(CDATA_ID, cc) == CREATURE_ID_GOOSE ) {
 		if ( cdata(CDATA_RELATION, cc) == RELATION_ALLY ) {
 			if ( nutrition >= 1000 ) {
-				if ( cbit(CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, cc) != FALSE ) {
+				if ( cbit((974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), cc) != FALSE ) {
 					snd SOUNDLIST_DING3
 					cibk = ci
 					flt
 					itemcreate -1, ITEM_ID_PLATINUM_COIN, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 2
-					cbitmod CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, cc, FALSE
+					cbitmod (974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), cc, FALSE
 					txtef COLOR_SKY_BLUE
 					txtmore
 					txt lang(name(cc) + "の産んだ卵が割れて中からプラチナが出てきた。", "「Ugh-Ughu」 " + name(cc) + " laid a platina.")
 					ci = cibk
 				}
@@ -3727,14 +3727,14 @@
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_FORTUNE_COOKIE ) {
 		if ( cc < MAX_CHARA_FOLLOWER ) {
 			txt lang(name(cc) + "はクッキーの中のおみくじを読んだ。", name(cc) + " read" + _s(cc) + " the paper fortune.")
 			valn = "%COOKIE2"
-			gosub *spec_talk
+			gosub *label_0426
 			if ( inv(INV_ITEM_STATUS, ci) >= ITEM_STATUS_BLESSED | (inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_NORMAL & rnd(2)) ) {
 				valn = "%COOKIE1"
-				gosub *spec_talk
+				gosub *label_0426
 			}
 			txtef COLOR_YELLOW
 			txt "" + buff
 		}
 	}
@@ -3931,77 +3931,98 @@
 		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_PANTY ) {
 			gdata(GDATA_FLAG_PANTIES_EATEN)++
 		}
 	}
 	repeat 15
-		if ( inv(40 + cnt * 2, ci) == 0 ) {
+		if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 			break
 		}
-		enc = inv(40 + cnt * 2, ci)
+		enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci)
 		if ( enc == 36 ) {
-			p = rnd(inv(40 + cnt * 2 + 1, ci) / 50 + 1) + 1
-			healsp cc, p
+			p = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 40 + 1
+			healsp cc, p * cdata(CDATA_MAX_SP, cc) / 100
 			continue
 		}
 		if ( enc == 38 ) {
-			p = rnd(inv(40 + cnt * 2 + 1, ci) / 25 + 1) + 1
-			healmp cc, p / 5
+			p = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 20 + 1
+			healmp cc, p * cdata(CDATA_MAX_MP, cc) / 100 + 1
 			continue
 		}
 		if ( enc == 37 ) {
 			evadd EVENT_RAGNAROK, cc
 			continue
 		}
 		if ( enc == 40 ) {
 			if ( gdata(GDATA_TIME_STOP_TIME) == 0 & gdata(GDATA_FLAG_STOP_TIME_OTHER) == 0 ) {
 				txtef COLOR_SKY_BLUE
 				txt lang(name(cc) + "は時を止めた。", name(cc) + " stop" + _s(cc) + " time.")
-				gdata(GDATA_TIME_STOP_TIME) = inv(40 + cnt * 2 + 1, ci) / 100 + 1 + 1
+				gdata(GDATA_TIME_STOP_TIME) = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 100 + 1 + 1
 				continue
 			}
 		}
 		enc2 = enc / 10000
 		if ( enc2 != 0 ) {
 			enc = enc \ 10000
 			if ( enc2 == 3 ) {
-				skillexp enc, cc, (inv(40 + cnt * 2 + 1, ci) / 50 + 1) * 100 * (1 + (cc != CHARA_PLAYER) * 5)
-				if ( inv(40 + cnt * 2 + 1, ci) / 50 + 1 >= 0 ) {
+				skillexp enc, cc, (inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 50 + 1) * 100 * (1 + (cc != CHARA_PLAYER) * 5)
+				if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 50 + 1 >= 0 ) {
 					txt lang(skillname(enc) + "の参考になる！", skillname(enc) + " develops.")
 				}
 				else {
 					txt lang(skillname(enc) + "がよくわからなくなった。", skillname(enc) + " deteriorates.")
 				}
 				continue
 			}
 			if ( enc2 == 1 ) {
-				skillexp enc, cc, (inv(40 + cnt * 2 + 1, ci) / 50 + 1) * 100 * (1 + (cc != CHARA_PLAYER) * 5)
-				if ( inv(40 + cnt * 2 + 1, ci) / 50 + 1 >= 0 ) {
+				skillexp enc, cc, (inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 50 + 1) * 100 * (1 + (cc != CHARA_PLAYER) * 5)
+				if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 50 + 1 >= 0 ) {
 					txt lang(skillname(enc) + "が発達した。", skillname(enc) + " develops.")
 				}
 				else {
 					txt lang(skillname(enc) + "が衰えた。", skillname(enc) + " deteriorates.")
 				}
 				continue
 			}
 			if ( enc2 == 10 ) {
-				modgrowth cc, enc, limit((inv(40 + cnt * 2 + 1, ci) / 50 + 1) * 5, -50, 50)
-				if ( inv(40 + cnt * 2 + 1, ci) >= 0 ) {
+				modgrowth cc, enc, limit((inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 50 + 1) * 5, -50, 50)
+				if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) >= 0 ) {
 				}
-				if ( inv(40 + cnt * 2 + 1, ci) / 50 + 1 >= 0 ) {
+				if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 50 + 1 >= 0 ) {
 					txt lang(skillname(enc) + "が回復した。", skillname(enc) + " heals.")
 				}
 				else {
 					txt lang(skillname(enc) + "が消耗した。", skillname(enc) + " hurts.")
 				}
 				continue
 			}
 			if ( enc2 == 6 & enc != 19 ) {
-				addbuff cc, 20 + (enc - 10), (inv(40 + cnt * 2 + 1, ci) / 50 + 1) * 5 * (1 + (cc != CHARA_PLAYER) * 2), 2000
+				addbuff cc, 20 + (enc - 10), (inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, ci) / 50 + 1) * 5 * (1 + (cc != CHARA_PLAYER) * 2), 2000
 				continue
 			}
 		}
 	loop
+	if ( cdata(CDATA_SP_EARNED, cc) <= (-2000000) & cdata(CDATA_SP_EARNED, cc) > (-12000000) ) {
+		cdata(CDATA_SP_EARNED, cc) -= limit(nutrition / 1000, 1, 5) * 100000
+		if ( 0 ) {
+			cdata(CDATA_SP_EARNED, cc) -= 50 * 100000
+		}
+		sintyoku = (cdata(CDATA_SP_EARNED, cc) + 2000000) * (-1) / 100000
+		if ( 0 ) {
+			txt lang("満腹" + nutrition + "でステージ" + cdata(CDATA_SP_EARNED, cc) + "。", name(cc) + " get genes of " + _s(cc) + ".")
+		}
+		if ( cdata(CDATA_SP_EARNED, cc) > (-12000000) ) {
+			txtef COLOR_YELLOW
+			txt lang("[フェイズ2進捗率：" + sintyoku + "％]", "[Phase 2 progress " + sintyoku + " %]")
+		}
+		if ( cdata(CDATA_SP_EARNED, cc) <= (-12000000) ) {
+			snd SOUNDLIST_DING1
+			txtef COLOR_GREEN
+			txt lang("[HAPPY BIRTHDAY！！]　フェイズ2が完了した。", "[HAPPY BIRTHDAY!!] Phase 2 completed.")
+			ccbk = cc
+			evadd 93
+		}
+	}
 	eatstatusfood inv(INV_ITEM_STATUS, cieat), cc
 	return
 
 *eatHard
 	if ( synccheck(cc, -1) ) {
@@ -4057,21 +4078,21 @@
 	if ( inv(INV_ITEM_AMUR_CAGE, ci) != 1 ) {
 		if ( synccheck(cc, -1) ) {
 			txtef COLOR_GREEN
 			txt lang(name(cc) + "の体は一瞬燃え上がった。", name(cc) + your(cc) + " body burns up for a second.")
 		}
-		resistmod cc, SKILL_RES_FIRE, 50 * 2
+		resistmodh cc, SKILL_RES_FIRE, 50
 	}
 	return
 
-*eatIssizzle
+*label_4274
 	if ( inv(INV_ITEM_AMUR_CAGE, ci) != 1 ) {
 		if ( synccheck(cc, -1) ) {
 			txtef COLOR_PURPLE
 			txt lang(name(cc) + "の胃は狂気で満たされた。", "Sheer madness!")
 		}
-		resistmod cc, SKILL_RES_MIND, 50
+		resistmodh cc, SKILL_RES_MIND, 50
 		dmgsan cc, 200
 		dmgcon cc, CONDITION_INSANE, 1000
 	}
 	return
 
@@ -4146,11 +4167,11 @@
 		txt lang("この肉は心を落ち着かせる効果があるようだ。", "Eating this brings " + name(cc) + " inner peace.")
 	}
 	healsan cc, 20
 	return
 
-*eatYith
+*label_4284
 	if ( synccheck(cc, -1) ) {
 		txtef COLOR_PURPLE
 		txt lang(name(cc) + "の胃は狂気で満たされた。", "Sheer madness!")
 	}
 	dmgsan cc, 50
@@ -4242,10 +4263,17 @@
 	tc = cc
 	gosub *alien_effect
 	return
 
 *alien_effect
+	if ( cdata(CDATA_SP_EARNED, tc) <= (-1000000) ) {
+		if ( synccheck(tc, -1) ) {
+			txt lang("しかしすぐに分解された。", "But it was immediately turned into fetus nutrients.")
+		}
+		ninsin = 0
+		return
+	}
 	if ( tc == CHARA_PLAYER ) {
 		if ( trait(TRAIT_ETHER_BLOOMING_FLOWER) != 0 ) {
 			if ( synccheck(tc, -1) ) {
 				txt lang("しかしすぐに花の養分に変えられた。", "But it was immediately turned into flower nutrients.")
 			}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/item_data.hsp ../2.14-borscht/item_data.hsp
--- ../2.13-borscht/item_data.hsp	2022-06-26 12:14:16.689234700 -0700
+++ ../2.14-borscht/item_data.hsp	2022-09-18 12:37:01.543323900 -0700
@@ -2,11 +2,11 @@
 	randomize inv(INV_ITEM_TURN, getinheritance_arg1) + 1
 	dim getinheritance_arg2, 15
 	getinheritance_arg3 = 0
 	repeat 10
 		locvar_getinheritance_p = rnd(15)
-		if ( inv(40 + locvar_getinheritance_p * 2, getinheritance_arg1) == 0 ) {
+		if ( inv(STARTING_INV_ITEM_ENCHANT + locvar_getinheritance_p * 2, getinheritance_arg1) == 0 ) {
 			continue
 		}
 		locvar_getinheritance_f = 0
 		repeat getinheritance_arg3 + 1
 			if ( locvar_getinheritance_p == getinheritance_arg2(cnt) ) {
@@ -15,11 +15,11 @@
 			}
 		loop
 		if ( locvar_getinheritance_f == 1 ) {
 			continue
 		}
-		if ( rnd(4) > getinheritance_arg3 | inv(40 + locvar_getinheritance_p * 2 + 1, getinheritance_arg1) < 0 ) {
+		if ( rnd(4) > getinheritance_arg3 | inv(STARTING_INV_ITEM_ENCHANT + locvar_getinheritance_p * 2 + 1, getinheritance_arg1) < 0 ) {
 			getinheritance_arg2(getinheritance_arg3) = locvar_getinheritance_p
 			getinheritance_arg3++
 		}
 	loop
 	randomize
@@ -252,11 +252,11 @@
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_RES_CURSE) = 99, 150, 2000, (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_PROC) = 99, 300, 15000, (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_REWARD_QUALITY) = 100, 120, 300, FILTER_FURNITURE
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_DRUNK_LISTENER) = 100, 120, 300, FILTER_FURNITURE
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_FOOD) = 100, 120, 300, FILTER_ITEM_FOOD
-	encref(ENCREF_GENERATE_CHANCE, ENCHANT_BANE_GOD) = 2, 170, 150, FILTER_WEAPON, FILTER_RANGE
+	encref(ENCREF_GENERATE_CHANCE, ENCHANT_GOD_BANE) = 2, 170, 150, FILTER_WEAPON, FILTER_RANGE
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_BANE_FLYING) = 2, 170, 150, FILTER_WEAPON, FILTER_RANGE
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_BANE_METAL) = 2, 170, 150, FILTER_WEAPON, FILTER_RANGE
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_REFLECT_MAGIC) = 3, 180, 250, FILTER_SHIELD, FILTER_CLOAK
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_REMOTE_BLOW) = 100, 120, 5000, FILTER_WEAPON
 	encref(ENCREF_GENERATE_CHANCE, ENCHANT_DEC_ENEMY_CRIT_CHANCE) = 99, 300, 5000, FILTER_ARMOR, FILTER_HELM, 19000
@@ -320,19 +320,19 @@
 		if ( val(10) == 1 ) {
 			rtval = 2
 			if ( val(1) / 50 + 1 < 0 ) {
 				rtval = 9
 				s = lang("" + skillname(sid) + "を" + abs(val(1) / 50 + 1) + "下げる", "decreases your " + skillname(sid) + " by " + abs(val(1) / 50 + 1) + ".")
-				if ( val(3) == 57000 ) {
+				if ( val(3) == 57000 | val(3) == 64000 ) {
 					s = lang("" + skillname(sid) + "を減衰させる毒素を含んでいる", "has which deteriorates your " + skillname(sid) + ".") + " ["
 					putenclv val(1) / 50
 					s += "]"
 				}
 			}
 			else {
 				s = lang("" + skillname(sid) + "を" + abs(val(1) / 50 + 1) + "上げる", "increases your " + skillname(sid) + " by " + abs(val(1) / 50 + 1) + ".")
-				if ( val(3) == 57000 ) {
+				if ( val(3) == 57000 | val(3) == 64000 ) {
 					s = lang("" + skillname(sid) + "を増強させる栄養をもっている", "has essential nutrients to enhance your " + skillname(sid) + ".") + " ["
 					putenclv val(1) / 50
 					s += "]"
 				}
 			}
@@ -372,31 +372,31 @@
 			rtval = 1
 			i = val(1) / 50 + 1
 			if ( val(1) / 50 + 1 < 0 ) {
 				rtval = 9
 				s = lang("" + skillname(sid) + "の技能を下げる", "decreases your " + skillname(sid) + " skill.")
-				if ( val(3) == 57000 ) {
+				if ( val(3) == 57000 | val(3) == 64000 ) {
 					s = lang("" + skillname(sid) + "の技術を損なう", "hurts technique of " + skillname(sid) + " skill.")
 				}
 			}
 			else {
 				s = skillencdesc(sid)
 				if ( s == "" ) {
 					s = lang("" + skillname(sid) + "の技能を上げる", "improves your " + skillname(sid) + " skill.")
 				}
-				if ( val(3) == 57000 ) {
+				if ( val(3) == 57000 | val(3) == 64000 ) {
 					s = lang("" + skillname(sid) + "の見識を深める", "will be experience of " + skillname(sid) + ".")
 				}
 			}
 			s += " ["
 			putenclv i / 5
 			s += "]"
 		}
 		if ( val(10) == 6 ) {
 			rtval = 8
 			s = lang(skillname(sid) + "を弱体化から守る", "protects " + skillname(sid) + " from weakening.")
-			if ( val(3) == 57000 ) {
+			if ( val(3) == 57000 | val(3) == 64000 ) {
 				s = lang("" + skillname(sid) + "の成長を助ける栄養をもっている", "can help you exercise your " + skillname(sid) + " faster.") + " ["
 				putenclv val(1) / 50
 				s += "]"
 			}
 		}
@@ -425,10 +425,32 @@
 			s = lang("" + ammoname(sid) + "を装填できる", "can be loaded with " + ammoname(sid) + ".")
 			s += lang(" [最大", " [Max ") + val(1) / 1000 + lang("発]", "]")
 		}
 		return
 	}
+	if ( val == 38 ) {
+		rtval = 4
+		s = lang("攻撃対象からMPを吸収する", "absorbs MP from an enemy.") + " ["
+		putenclv val(1) / 50
+		s += "]"
+		if ( val(3) == 57000 | val(3) == 64000 ) {
+			s = lang("MPを回復する成分を含む", "can heal your MP.") + " ["
+			putenclv val(1) / 50
+			s += "]"
+		}
+	}
+	if ( val == 36 ) {
+		rtval = 4
+		s = lang("攻撃対象からスタミナを吸収する", "absorbs stamina from an enemy.") + " ["
+		putenclv val(1) / 50
+		s += "]"
+		if ( val(3) == 57000 | val(3) == 64000 ) {
+			s = lang("スタミナを回復する成分を含む", "can heal your SP.") + " ["
+			putenclv val(1) / 50
+			s += "]"
+		}
+	}
 	if ( val == 0 ) {
 		s = "?????"
 	}
 	if ( val == 21 ) {
 		rtval = 9
@@ -998,29 +1020,10 @@
 				rtval(1) = -1
 				return
 			}
 		}
 	}
-	if ( val == 36 ) {
-		rtval = 4
-		s = lang("攻撃対象からスタミナを吸収する", "absorbs stamina from an enemy.")
-		if ( val(1) / 50 == (-1) ) {
-			return
-		}
-		else {
-			if ( val(2) == 0 ) {
-				s += " ["
-				putenclv val(1) / 50
-				s += "]"
-				return
-			}
-			else {
-				rtval(1) = val(1) / 50
-				return
-			}
-		}
-	}
 	if ( val == 37 ) {
 		rtval = 4
 		s = lang("全てを終結させる", "brings an end.")
 		if ( (-1) == (-1) ) {
 			return
@@ -1036,29 +1039,10 @@
 				rtval(1) = -1
 				return
 			}
 		}
 	}
-	if ( val == 38 ) {
-		rtval = 4
-		s = lang("攻撃対象からマナを吸収する", "absorbs MP from an enemy.")
-		if ( val(1) / 50 == (-1) ) {
-			return
-		}
-		else {
-			if ( val(2) == 0 ) {
-				s += " ["
-				putenclv val(1) / 50
-				s += "]"
-				return
-			}
-			else {
-				rtval(1) = val(1) / 50
-				return
-			}
-		}
-	}
 	if ( val == 39 ) {
 		rtval = 4
 		s = lang("完全貫通攻撃発動の機会を増やす", "gives you a chance to throw an absolute piercing attak.")
 		if ( val(1) / 50 == (-1) ) {
 			return
@@ -1739,16 +1723,16 @@
 #deffunc sortenc int sortenc_arg1
 	repeat
 		locvar_sortenc_f = 0
 		repeat 15 - 1
 			locvar_sortenc_cnt2 = cnt + 1
-			if ( inv(40 + cnt * 2, sortenc_arg1) < inv(40 + locvar_sortenc_cnt2 * 2, sortenc_arg1) ) {
-				locvar_randomenc_p = inv(40 + cnt * 2, sortenc_arg1), inv(40 + cnt * 2 + 1, sortenc_arg1)
-				inv(40 + cnt * 2, sortenc_arg1) = inv(40 + locvar_sortenc_cnt2 * 2, sortenc_arg1)
-				inv(40 + locvar_sortenc_cnt2 * 2, sortenc_arg1) = locvar_randomenc_p
-				inv(40 + cnt * 2 + 1, sortenc_arg1) = inv(40 + locvar_sortenc_cnt2 * 2 + 1, sortenc_arg1)
-				inv(40 + locvar_sortenc_cnt2 * 2 + 1, sortenc_arg1) = locvar_randomenc_p(1)
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, sortenc_arg1) < inv(STARTING_INV_ITEM_ENCHANT + locvar_sortenc_cnt2 * 2, sortenc_arg1) ) {
+				locvar_randomenc_p = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, sortenc_arg1), inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, sortenc_arg1)
+				inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, sortenc_arg1) = inv(STARTING_INV_ITEM_ENCHANT + locvar_sortenc_cnt2 * 2, sortenc_arg1)
+				inv(STARTING_INV_ITEM_ENCHANT + locvar_sortenc_cnt2 * 2, sortenc_arg1) = locvar_randomenc_p
+				inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, sortenc_arg1) = inv(STARTING_INV_ITEM_ENCHANT + locvar_sortenc_cnt2 * 2 + 1, sortenc_arg1)
+				inv(STARTING_INV_ITEM_ENCHANT + locvar_sortenc_cnt2 * 2 + 1, sortenc_arg1) = locvar_randomenc_p(1)
 				locvar_sortenc_f = 1
 			}
 		loop
 		if ( locvar_sortenc_f == 0 ) {
 			break
@@ -1770,14 +1754,14 @@
 		locvar_encremove_enc = encremove_arg2
 	}
 	locvar_encremove_enc = encremove_arg2
 	locvar_encremove_encp = encremove_arg3
 	repeat 15
-		if ( inv(40 + cnt * 2, encremove_arg1) == locvar_encremove_enc ) {
-			inv(40 + cnt * 2 + 1, encremove_arg1) -= locvar_encremove_encp
-			if ( inv(40 + cnt * 2 + 1, encremove_arg1) == 0 ) {
-				inv(40 + cnt * 2, encremove_arg1) = 0
+		if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, encremove_arg1) == locvar_encremove_enc ) {
+			inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, encremove_arg1) -= locvar_encremove_encp
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, encremove_arg1) == 0 ) {
+				inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, encremove_arg1) = 0
 			}
 			break
 		}
 	loop
 	if ( encremove_arg2 < 10000 ) {
@@ -1918,43 +1902,43 @@
 			locvar_encremove_encp += locvar_encremove_encp * 1000
 		}
 	}
 	locvar_encadd_i = -1
 	repeat 15
-		if ( inv(40 + cnt * 2, encadd_itemidx) == locvar_encremove_enc ) {
+		if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, encadd_itemidx) == locvar_encremove_enc ) {
 			locvar_encadd_i = cnt
 			continue
 		}
 		if ( locvar_encadd_i == (-1) ) {
-			if ( inv(40 + cnt * 2, encadd_itemidx) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, encadd_itemidx) == 0 ) {
 				locvar_encadd_i = cnt
 			}
 		}
 	loop
 	if ( locvar_encadd_i == (-1) ) {
 		return 0
 	}
-	if ( inv(40 + locvar_encadd_i * 2, encadd_itemidx) == locvar_encremove_enc ) {
+	if ( inv(STARTING_INV_ITEM_ENCHANT + locvar_encadd_i * 2, encadd_itemidx) == locvar_encremove_enc ) {
 		if ( reftype == FILTER_AMMO ) {
 			return
 		}
 		if ( encadd_arg5 ) {
 		}
 		else {
-			if ( inv(40 + locvar_encadd_i * 2 + 1, encadd_itemidx) > 300 | ibit(ITEM_BIT_PRECIOUS, encadd_itemidx) == TRUE ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + locvar_encadd_i * 2 + 1, encadd_itemidx) > 300 | ibit(ITEM_BIT_PRECIOUS, encadd_itemidx) == TRUE ) {
 				locvar_encremove_encp /= 2
 			}
 		}
 	}
 	if ( encadd_arg6 ) {
 		rtval = locvar_encremove_enc, locvar_encremove_encp
 		return
 	}
-	if ( inv(40 + locvar_encadd_i * 2, encadd_itemidx) == locvar_encremove_enc ) {
-		locvar_encremove_encp += inv(40 + locvar_encadd_i * 2 + 1, encadd_itemidx)
+	if ( inv(STARTING_INV_ITEM_ENCHANT + locvar_encadd_i * 2, encadd_itemidx) == locvar_encremove_enc ) {
+		locvar_encremove_encp += inv(STARTING_INV_ITEM_ENCHANT + locvar_encadd_i * 2 + 1, encadd_itemidx)
 	}
-	inv(40 + locvar_encadd_i * 2, encadd_itemidx) = locvar_encremove_enc, locvar_encremove_encp
+	inv(STARTING_INV_ITEM_ENCHANT + locvar_encadd_i * 2, encadd_itemidx) = locvar_encremove_enc, locvar_encremove_encp
 	if ( encadd_enchant < EXT_ENCHANTMENT ) {
 		locvar_encremove_p = encadd_enchant
 	}
 	else {
 		locvar_encremove_p = encadd_enchant / 10000
@@ -2269,19 +2253,21 @@
 	else {
 		mtname(0, p) = "bamboo", "tasteful"
 	}
 	mtref(MTREF_WEIGHT, p) = 120, 30, 17, 3, 14, 9, 100, 2
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_MEDITATION, 100
+	mtbit(0, p) = 3
 	p = 43
 	if ( jp ) {
 		mtname(0, p) = "木", "古き"
 	}
 	else {
 		mtname(0, p) = "wood", "old"
 	}
 	mtref(MTREF_WEIGHT, p) = 150, 80, 14, 7, 20, 13, 120, 6
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_MIND, 100
+	mtbit(0, p) = 3
 	p = 34
 	if ( jp ) {
 		mtname(0, p) = "鉛", "重き"
 	}
 	else {
@@ -2478,28 +2464,31 @@
 	else {
 		mtname(0, p) = "cloth", "charming"
 	}
 	mtref(MTREF_WEIGHT, p) = 20, 30, 6, -5, 7, 2, 100, 10
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_COLD, 25
+	mtbit(0, p) = 3
 	p = 2
 	if ( jp ) {
 		mtname(0, p) = "シルク", "美しき"
 	}
 	else {
 		mtname(0, p) = "silk", "beautiful"
 	}
 	mtref(MTREF_WEIGHT, p) = 40, 190, 9, -2, 10, 2, 100, 5
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_MIND, 50
+	mtbit(0, p) = 3
 	p = 16
 	if ( jp ) {
 		mtname(0, p) = "紙", "ふざけた"
 	}
 	else {
 		mtname(0, p) = "paper", "silly"
 	}
 	mtref(MTREF_WEIGHT, p) = 10, 20, 15, -10, 12, 0, 100, 0
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_EVASION, 100
+	mtbit(0, p) = 3
 	p = 18
 	if ( jp ) {
 		mtname(0, p) = "ボーン", "不死なる"
 	}
 	else {
@@ -2515,10 +2504,11 @@
 	else {
 		mtname(0, p) = "leather", "mysterious"
 	}
 	mtref(MTREF_WEIGHT, p) = 100, 150, 12, 2, 13, 6, 100, 6
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_SOUND, 25
+	mtbit(0, p) = 3
 	p = 4
 	if ( jp ) {
 		mtname(0, p) = "鱗", "逆鱗に触れし"
 	}
 	else {
@@ -2543,10 +2533,11 @@
 	else {
 		mtname(0, p) = "zylon", "foreign"
 	}
 	mtref(MTREF_WEIGHT, p) = 50, 500, 5, 4, 21, 16, 100, 4
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_NETHER, 50
+	mtbit(0, p) = 3
 	p = 32
 	if ( jp ) {
 		mtname(0, p) = "ゴールデン", "黄金に輝く"
 	}
 	else {
@@ -2562,11 +2553,11 @@
 	else {
 		mtname(0, p) = "spirit cloth", "amazing"
 	}
 	mtref(MTREF_WEIGHT, p) = 40, 750, 3, 2, 34, 6, 100, 4
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_SPD, 200
-	mtbit(0, p) = 1
+	mtbit(0, p) = 1, 3
 	p = 24
 	if ( jp ) {
 		mtname(0, p) = "竜鱗", "竜を統べし"
 	}
 	else {
@@ -2582,19 +2573,21 @@
 	else {
 		mtname(0, p) = "dawn cloth", "dawn"
 	}
 	mtref(MTREF_WEIGHT, p) = 45, 850, 10, 8, 35, 15, 100, 4
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_MANA, 200
+	mtbit(0, p) = 3
 	p = 28
 	if ( jp ) {
 		mtname(0, p) = "翼鳥鱗", "翼を折られし"
 	}
 	else {
 		mtname(0, p) = "griffon scale", "fallen"
 	}
 	mtref(MTREF_WEIGHT, p) = 70, 1000, 16, 17, 32, 24, 120, 2
 	mtenc(MTENC_ENCHANTMENT, p) = ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_EVASION, 100
+	mtbit(0, p) = 3
 	dim mtlistmetal, 4, 5
 	dim mtlistleather, 4, 5
 	mtlistmetal(0, 0) = ITEM_MATERIAL_BRONZE, ITEM_MATERIAL_IRON, ITEM_MATERIAL_MICA, ITEM_MATERIAL_CORAL
 	mtlistmetal(0, 1) = ITEM_MATERIAL_METAL, ITEM_MATERIAL_SILVER, ITEM_MATERIAL_GLASS, ITEM_MATERIAL_OBSIDIAN
 	mtlistmetal(0, 2) = ITEM_MATERIAL_STEEL, ITEM_MATERIAL_PLATINUM, ITEM_MATERIAL_PEARL, ITEM_MATERIAL_MITHRIL
@@ -2747,11 +2740,11 @@
 		gosub *apply_material
 	}
 	else {
 		gosub *apply_materialEnc
 	}
-	gosub *item_value
+	gosub *label_4251
 	r1 = cc
 	gosub *charaRefresh
 	return
 
 *apply_material
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/item_func.hsp ../2.14-borscht/item_func.hsp
--- ../2.13-borscht/item_func.hsp	2022-06-26 12:14:16.729271500 -0700
+++ ../2.14-borscht/item_func.hsp	2022-09-18 12:37:01.586363600 -0700
@@ -158,16 +158,16 @@
 		if ( cdata(cnt, encfind_charid) \ EXT_EQUIP_SLOTS == 0 ) {
 			continue
 		}
 		locvar_encfind_i = cdata(cnt, encfind_charid) \ EXT_EQUIP_SLOTS - 1
 		repeat 15
-			if ( inv(40 + cnt * 2, locvar_encfind_i) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, locvar_encfind_i) == 0 ) {
 				break
 			}
-			if ( inv(40 + cnt * 2, locvar_encfind_i) == encfind_encid ) {
-				if ( inv(40 + cnt * 2 + 1, locvar_encfind_i) > locvar_encfind_f ) {
-					locvar_encfind_f = inv(40 + cnt * 2 + 1, locvar_encfind_i)
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, locvar_encfind_i) == encfind_encid ) {
+				if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_encfind_i) > locvar_encfind_f ) {
+					locvar_encfind_f = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_encfind_i)
 					break
 				}
 			}
 		loop
 	loop
@@ -179,27 +179,27 @@
 		if ( cdata(cnt, encfindpower_charid) \ EXT_EQUIP_SLOTS == 0 ) {
 			continue
 		}
 		locvar_encfind_i = cdata(cnt, encfindpower_charid) \ EXT_EQUIP_SLOTS - 1
 		repeat 15
-			if ( inv(40 + cnt * 2, locvar_encfind_i) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, locvar_encfind_i) == 0 ) {
 				break
 			}
-			if ( inv(40 + cnt * 2, locvar_encfind_i) == encfindpower_encid ) {
-				locvar_encfind_f += inv(40 + cnt * 2 + 1, locvar_encfind_i)
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, locvar_encfind_i) == encfindpower_encid ) {
+				locvar_encfind_f += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, locvar_encfind_i)
 			}
 		loop
 	loop
 	return locvar_encfind_f
 
 #defcfunc encfindspec int encfindspec_itemid, int encfindspec_encid
 	locvar_encfind_f = -1
 	repeat 15
-		if ( inv(40 + cnt * 2, encfindspec_itemid) == 0 ) {
+		if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, encfindspec_itemid) == 0 ) {
 			break
 		}
-		if ( inv(40 + cnt * 2, encfindspec_itemid) == encfindspec_encid ) {
+		if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, encfindspec_itemid) == encfindspec_encid ) {
 			locvar_encfind_f = 1
 			break
 		}
 	loop
 	return locvar_encfind_f
@@ -405,11 +405,11 @@
 	if ( locvar_removeitem_n == 0 ) {
 		locvar_removeitem_n = 1
 	}
 	inv(INV_ITEM_NUM, removeitem_itemid) -= locvar_removeitem_n
 	if ( removeitem_itemid < SIZE_INV1 ) {
-		gosub *calcBurdenPc
+		gosub *label_4102
 	}
 	if ( inv(INV_ITEM_NUM, removeitem_itemid) <= 0 ) {
 		inv(INV_ITEM_NUM, removeitem_itemid) = 0
 		if ( mode != MODELIST_SHOP ) {
 			if ( removeitem_itemid >= RANGE_INV2 ) {
@@ -560,11 +560,11 @@
 	}
 	if ( item_num_itemid >= RANGE_INV2 ) {
 		cell_refresh inv(INV_ITEM_X, item_num_itemid), inv(INV_ITEM_Y, item_num_itemid)
 	}
 	else {
-		gosub *calcBurdenPc
+		gosub *label_4102
 	}
 	return
 
 *label_0687
 	goto *label_0691
@@ -594,11 +594,11 @@
 			inv(INV_ITEM_X, locvar_item_separate_ti) = inv(INV_ITEM_X, item_separate_itemid)
 			inv(INV_ITEM_Y, locvar_item_separate_ti) = inv(INV_ITEM_Y, item_separate_itemid)
 			itemturn locvar_item_separate_ti
 			cell_refresh inv(INV_ITEM_X, locvar_item_separate_ti), inv(INV_ITEM_Y, locvar_item_separate_ti)
 			txt lang("何かが地面に落ちた。", "Something falls to the ground from your backpack.")
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 	}
 	return locvar_item_separate_ti
 
 #deffunc item_separatefish var item_separatefish_itemid
@@ -626,11 +626,11 @@
 			inv(INV_ITEM_X, locvar_item_separate_ti) = inv(INV_ITEM_X, item_separatefish_itemid)
 			inv(INV_ITEM_Y, locvar_item_separate_ti) = inv(INV_ITEM_Y, item_separatefish_itemid)
 			itemturn locvar_item_separate_ti
 			cell_refresh inv(INV_ITEM_X, locvar_item_separate_ti), inv(INV_ITEM_Y, locvar_item_separate_ti)
 			txt lang("何かが餌に気づいて浮かんできた。", "Something has emerged in order to get the bait.")
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 	}
 	return locvar_item_separate_ti
 
 #deffunc chara_unequip int chara_unequip_itemid
@@ -711,11 +711,11 @@
 			return 1
 		}
 	}
 	return 0
 
-*itemNameSub
+*label_0699
 	if ( inv(INV_ITEM_ID, itemowner_itemid) == ITEM_ID_KITTY_BANK ) {
 		locvar_itemowner_s += lang("" + moneyboxn(inv(INV_ITEM_PARAM2, itemowner_itemid)), "(" + moneyboxn(inv(INV_ITEM_PARAM2, itemowner_itemid)) + ")")
 	}
 	if ( inv(INV_ITEM_ID, itemowner_itemid) == ITEM_ID_BAIT ) {
 		locvar_itemowner_s += lang("" + biten(inv(INV_ITEM_PARAM1, itemowner_itemid)), " <" + biten(inv(INV_ITEM_PARAM1, itemowner_itemid)) + ">")
@@ -1221,11 +1221,11 @@
 				locvar_itemowner_s += "god "
 			}
 		}
 	}
 	if ( jp ) {
-		gosub *itemNameSub
+		gosub *label_0699
 	}
 	if ( locvar_itemowner_a == 60000 ) {
 		if ( inv(INV_ITEM_ID, itemname_itemid) != ITEM_ID_WILD_FLOWER ) {
 			if ( inv(INV_ITEM_MATERIAL, itemname_itemid) != ITEM_MATERIAL_SAND ) {
 				if ( jp ) {
@@ -1634,11 +1634,11 @@
 				if ( locvar_itemname_num2 > 1 ) {
 					locvar_itemowner_s += "s"
 				}
 			}
 		}
-		gosub *itemNameSub
+		gosub *label_0699
 	}
 	if ( inv(INV_ITEM_KNOWN, itemname_itemid) >= ITEM_KNOWN_FULL ) {
 		if ( inv(INV_ITEM_LEVEL, itemname_itemid) != 0 ) {
 			locvar_itemowner_s += "" + cnvfix(inv(INV_ITEM_LEVEL, itemname_itemid)) + " "
 		}
@@ -2111,30 +2111,30 @@
 #deffunc equipinfo int equipinfo_arg1, int equipinfo_arg2, int equipinfo_arg3
 	if ( inv(INV_ITEM_KNOWN, equipinfo_arg1) < ITEM_KNOWN_FULL ) {
 		return
 	}
 	repeat 15
-		locvar_equipinfo_p = inv(40 + cnt * 2, equipinfo_arg1)
+		locvar_equipinfo_p = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, equipinfo_arg1)
 		if ( locvar_equipinfo_p == 0 ) {
 			break
 		}
 		locvar_colorres_i = locvar_equipinfo_p / 10000
 		if ( locvar_colorres_i != 2 ) {
 			continue
 		}
 		locvar_colorres_i = locvar_equipinfo_p \ 10000
 		pos equipinfo_arg2 + (locvar_colorres_i - 50) * 20, equipinfo_arg3
-		locvar_equipinfo_p = abs(inv(40 + cnt * 2 + 1, equipinfo_arg1) / 2 / 50) + 1
+		locvar_equipinfo_p = abs(inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, equipinfo_arg1) / 2 / 50) + 1
 		if ( locvar_equipinfo_p > 5 ) {
 			locvar_equipinfo_s = "+"
 		}
 		else {
 			locvar_equipinfo_s = "" + locvar_equipinfo_p
 		}
 		if ( jp ) {
 			colorres
-			if ( inv(40 + cnt * 2 + 1, equipinfo_arg1) >= 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, equipinfo_arg1) >= 0 ) {
 				mes "●"
 			}
 			else {
 				mes "▼"
 			}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/main.hsp ../2.14-borscht/main.hsp
--- ../2.13-borscht/main.hsp	2022-06-26 12:14:16.736278000 -0700
+++ ../2.14-borscht/main.hsp	2022-09-18 12:37:01.593370000 -0700
@@ -181,11 +181,11 @@
 	if ( dbg_randseed != 0 ) {
 		randseed = dbg_randseed
 	}
 	randomize randseed
 	exrand_randomize randseed
-	title "ElonaPlus 2.13"
+	title "ElonaPlus 2.14"
 	goto *system_init
 	goto *label_0003
 
 #deffunc netload str netload_filename
 	netrequest netload_filename
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/map.hsp ../2.14-borscht/map.hsp
--- ../2.13-borscht/map.hsp	2022-06-26 12:14:16.864396100 -0700
+++ ../2.14-borscht/map.hsp	2022-09-18 12:37:01.675445800 -0700
@@ -425,11 +425,11 @@
 		}
 	}
 	flt calcobjlv(cdata(CDATA_LEVEL, CHARA_PLAYER)), calcfixlv(FIX_QUALITY_GOOD)
 	return
 
-*chara_spawn
+*label_4647
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
 		if ( gdata(GDATA_CROWD) < mdata(MDATA_MODERATE_CROWD) / 2 ) {
 			if ( rnd(4) == 0 ) {
 				gosub *fltChara
 				characreate -1, dbid, -2, 0
@@ -671,19 +671,19 @@
 				}
 				cdata(CDATA_CONDITION_BLEED, cnt) = 0
 				cdata(CDATA_CONDITION_POISON, cnt) = 0
 			loop
 			gdata(GDATA_HOUR) += 2
-			gosub *advance_hour
+			gosub *label_9228
 		}
 	}
 	if ( gdata(GDATA_AREA_PREV) == 73 ) {
 		if ( gdata(GDATA_LEVEL) == 100 ) {
 			snd SOUNDLIST_BOLT1
 			txt lang("あなた達はエウダーナ王都から帰還した。", "Sorry, this is untranslated sentence.")
 			gdata(GDATA_HOUR) += 2
-			gosub *advance_hour
+			gosub *label_9228
 		}
 	}
 	if ( gdata(GDATA_AREA_PREV) == 33 ) {
 		if ( gdata(GDATA_LEVEL) == 100 ) {
 			snd SOUNDLIST_BOLT1
@@ -710,11 +710,11 @@
 					cdata(CDATA_HP, cnt) = 1
 				}
 			loop
 			txt lang("あなた達はどうにかノイエルに戻ってこられた。", "Sorry, this is untranslated sentence.")
 			gdata(GDATA_HOUR) += 2
-			gosub *advance_hour
+			gosub *label_9228
 		}
 	}
 	if ( gdata(GDATA_AREA_PREV) == 43 ) {
 		if ( gdata(GDATA_LEVEL) == 100 ) {
 			snd SOUNDLIST_LOCKED1
@@ -740,11 +740,11 @@
 					cdata(CDATA_HP, cnt) = 1
 				}
 			loop
 			txt lang("あなた達はどうにか関所に戻ってこられた。", "Sorry, this is untranslated sentence.")
 			gdata(GDATA_HOUR) += 2
-			gosub *advance_hour
+			gosub *label_9228
 		}
 	}
 	if ( gdata(GDATA_AREA_PREV) == 30 ) {
 		gdata(GDATA_AREA) = gdata(GDATA_RETURN_AREA)
 		gdata(GDATA_LEVEL) = gdata(GDATA_RETURN_LEVEL)
@@ -927,11 +927,11 @@
 			}
 		}
 	}
 	if ( mdata(MDATA_TYPE) == MAP_TYPE_QUEST ) {
 		rq = gdata(GDATA_QUEST_REF)
-		gosub *quest_exit
+		gosub *label_8947
 		gdata(GDATA_AREA) = gdata(GDATA_RETURN_AREA)
 		gdata(GDATA_LEVEL) = gdata(GDATA_RETURN_LEVEL)
 		mapstartx = gdata(GDATA_RETURN_X)
 		mapstarty = gdata(GDATA_RETURN_Y)
 		gdata(GDATA_LEVEL_START_ON) = 7
@@ -942,11 +942,11 @@
 		gdata(GDATA_LEVEL) = gdata(GDATA_TELEPORT_LEVEL)
 		if ( gdata(GDATA_QUEST) == QUEST_TYPE_NONE ) {
 			if ( gdata(GDATA_AREA_PREV) != 2 ) {
 				gdata(GDATA_WORLD_X) = adata(ADATA_X, gdata(GDATA_AREA))
 				gdata(GDATA_WORLD_Y) = adata(ADATA_Y, gdata(GDATA_AREA))
-				gosub *weather_change
+				gosub *label_9227
 			}
 		}
 		if ( gdata(GDATA_AREA) == AREA_VALM ) {
 			if ( gdata(GDATA_LEVEL) == 30 ) {
 				mapstartx = 18
@@ -1026,11 +1026,11 @@
 		if ( fixstart == 0 ) {
 			gdata(GDATA_LEVEL_START_ON) = adata(ADATA_START_ON, gdata(GDATA_AREA))
 		}
 		if ( evfind(6) ) {
 			msgtemp += lang("あなたは復帰ポイントまで運ばれた。", "You were delivered to your home.")
-			gosub *weather_change
+			gosub *label_9227
 		}
 		else {
 			if ( adata(ADATA_TYPE, gdata(GDATA_AREA_PREV)) == MAP_TYPE_WORLD ) {
 				if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) > 0 ) {
 					msgtemp += lang("乗り物から降りて" + mapname(gdata(GDATA_AREA)) + "に入った。", "You got off the world-vehicle and entered " + mapname(gdata(GDATA_AREA)) + ".")
@@ -1126,20 +1126,20 @@
 			}
 			continue
 		}
 		map(cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt), MAP_CHARA_INDEX_PLUS_ONE) = 0
 		if ( cnt != 0 ) {
-			if ( cdata(CDATA_AREA, cnt) != AREA_NONE ) {
+			if ( cdata(CDATA_AREA, cnt) != 0 ) {
 				cdata(CDATA_EXIST, cnt) = CHAR_STATE_ALLY_WORK
 			}
 		}
 	loop
 	if ( mdata(MDATA_CAN_SAVE) == 1 ) {
 		gosub *map_save
 	}
 	else {
-		gosub *map_clean
+		gosub *label_4658
 		existwrapper exedir + "tmp\\mdata_" + mid + ".s2"
 		if ( strsize != (-1) ) {
 			fmode = 11
 			gosub *game_ctrlFile
 		}
@@ -1157,11 +1157,11 @@
 		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
 	}
 	mode = MODELIST_NEW
 	goto *map_init
 
-*map_clean
+*label_4658
 	repeat 57
 		rowactend cnt
 		if ( cdata(CDATA_AI_ITEM, cnt) == 0 ) {
 			continue
 		}
@@ -1180,11 +1180,11 @@
 		}
 	loop
 	return
 
 *map_save
-	gosub *map_clean
+	gosub *label_4658
 	repeat mdata(MDATA_HEIGHT)
 		y = cnt
 		repeat mdata(MDATA_WIDTH)
 			map(cnt, y, MAP_BLOOD_AND_DEBRIS) = 0
 		loop
@@ -1216,18 +1216,18 @@
 	}
 	repeat 16
 		if ( cnt == 0 ) {
 			continue
 		}
-		if ( cdata(CDATA_AREA, cnt) != AREA_NONE ) {
+		if ( cdata(CDATA_AREA, cnt) != 0 ) {
 			if ( cdata(CDATA_AREA, cnt) == gdata(GDATA_AREA) ) {
 				if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALLY_WORK ) {
 					cdata(CDATA_EXIST, cnt) = CHAR_STATE_ALIVE
 				}
 			}
 		}
-		if ( cdata(CDATA_AREA, cnt) == AREA_HOME & gdata(GDATA_LEVEL) != cdata(CDATA_HOME, cnt) ) {
+		if ( cdata(CDATA_AREA, cnt) == 7 & gdata(GDATA_LEVEL) != cdata(CDATA_HOME, cnt) ) {
 			cdata(CDATA_EXIST, cnt) = CHAR_STATE_ALLY_WORK
 		}
 	loop
 	mid = "" + gdata(GDATA_AREA) + "_" + (100 + gdata(GDATA_LEVEL))
 	if ( mode == MODELIST_CONTINUE ) {
@@ -2283,36 +2283,36 @@
 		}
 		else {
 			flt
 			itemcreate -1, ITEM_ID_TIGHT_ROPE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
 		}
-		gosub *home_setup
+		gosub *label_4573
 		map_placeplayer
 	}
 	if ( gdata(GDATA_AREA) == AREA_NORTH_TYRIS ) {
 		map_initcustom "ntyris"
-		gosub *world_newRandArea
+		gosub *label_4913
 		map_placeplayer
 	}
 	if ( gdata(GDATA_AREA) == AREA_SOUTH_TYRIS ) {
 		map_initcustom "styris"
-		gosub *world_newRandArea
+		gosub *label_4913
 		map_placeplayer
 	}
 	if ( gdata(GDATA_AREA) == AREA_LOST_YLVA ) {
 		map_initcustom "lost"
-		gosub *world_newRandArea
+		gosub *label_4913
 		map_placeplayer
 	}
 	if ( gdata(GDATA_AREA) == AREA_AIMWELL ) {
 		map_initcustom "ether"
-		gosub *world_newRandArea
+		gosub *label_4913
 		map_placeplayer
 	}
 	if ( gdata(GDATA_AREA) == AREA_TEST_WORLD ) {
 		map_initcustom "test"
-		gosub *world_newRandArea
+		gosub *label_4913
 		map_placeplayer
 	}
 	if ( gdata(GDATA_AREA) == AREA_DERPHY ) {
 		if ( gdata(GDATA_LEVEL) == 1 ) {
 			mdata(MDATA_MODERATE_CROWD) = 35
@@ -2382,11 +2382,11 @@
 				cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
 				flt
 				characreate -1, CREATURE_ID_CITIZEN2, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 20
 				dbid = 0
 				gosub *fltChara
 				characreate -1, dbid, -3, 0
 			loop
@@ -2569,11 +2569,11 @@
 		repeat 4
 			flt
 			characreate -1, CREATURE_ID_GUARD2, -3, 0
 			cdata(CDATA_ROLE, rc) = ROLE_GUARD
 		loop
-		gosub *client_update
+		gosub *label_8928
 		repeat 25
 			dbid = 0
 			gosub *fltChara
 			characreate -1, dbid, -3, 0
 		loop
@@ -2674,11 +2674,11 @@
 			repeat 7
 				flt
 				characreate -1, CREATURE_ID_GUARD2, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_GUARD
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 25
 				dbid = 0
 				gosub *fltChara
 				characreate -1, dbid, -3, 0
 			loop
@@ -2809,11 +2809,11 @@
 				flt
 				characreate -1, CREATURE_ID_MITO_THE_SEMINAR_LECTURER, 7, 3
 				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
 			}
 			flt
-			characreate -1, CREATURE_ID_KARATA_THE_SEMINAR_MASCOT, 6, 3
+			characreate -1, CREATURE_ID_KARATA_THE_SEMINAR_MASCOT, 15, 1
 			cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
 			flt
 			characreate -1, CREATURE_ID_NOVICE, 2, 6
 			flt
 			characreate -1, CREATURE_ID_NOVICE, 2, 8
@@ -2920,11 +2920,11 @@
 			repeat 3
 				flt
 				characreate -1, CREATURE_ID_GUARD2, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_GUARD
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 15
 				dbid = 0
 				gosub *fltChara
 				characreate -1, dbid, -3, 0
 			loop
@@ -3077,11 +3077,11 @@
 			repeat 3
 				flt
 				characreate -1, CREATURE_ID_GUARD2, rnd(32), rnd(mdata(MDATA_HEIGHT))
 				cdata(CDATA_ROLE, rc) = ROLE_GUARD
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 8
 				gosub *fltChara
 				characreate -1, CREATURE_ID_TOWN_CHILD, rnd(11) + 25, rnd(5) + 15
 				cdata(CDATA_ROLE, rc) = ROLE_SPECIAL
 			loop
@@ -3222,11 +3222,11 @@
 				cdata(CDATA_ROLE, rc) = ROLE_GUARD
 			loop
 			flt
 			characreate -1, CREATURE_ID_CAPTAIN, 7, 6
 			cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
-			gosub *client_update
+			gosub *label_8928
 			repeat 20
 				gosub *fltChara
 				characreate -1, CREATURE_ID_BUG, -3, 0
 			loop
 		}
@@ -3378,11 +3378,11 @@
 			repeat 4
 				flt
 				characreate -1, CREATURE_ID_GUARD2, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_GUARD
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 25
 				dbid = 0
 				gosub *fltChara
 				characreate -1, dbid, -3, 0
 			loop
@@ -3729,11 +3729,11 @@
 			cdatan(CDATAN_NAME, rc) = lang("行商人の" + cdatan(CDATAN_NAME, rc), sncnv(cdatan(CDATAN_NAME, rc)) + "the wandering vendor")
 			generatemoney rc
 			repeat encounterlv / 2 + 1
 				r1 = rc
 				r2 = 1
-				gosub *calcLevelUp
+				gosub *label_3967
 			loop
 			evadd EVENT_SHOP_WANDER
 			repeat 6 + rnd(6)
 				flt
 				initlv = encounterlv + rnd(10)
@@ -4172,11 +4172,11 @@
 					mdatan(0) = lang("神の間<復元>", "God's prison")
 					procid = (procid + 1) \ 4
 					proclist(procid) = "Chaos10" + " ct:" + ct
 					map_placeplayer
 					tc = CHARA_PLAYER
-					gosub *effect_elixer
+					gosub *label_6338
 					r1 = 0
 					gosub *charaRefresh
 					break
 				}
 				if ( gdata(GDATA_FLAG_MAIN) >= 845 & gdata(GDATA_FLAG_MAIN) < 990 ) {
@@ -5243,11 +5243,11 @@
 				cdata(CDATA_AI_CALM, rc) = 2
 				cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
 				cdata(CDATA_RELATION_ORG, rc) = RELATION_NEUTRAL
 				cdata(CDATA_ROLE, rc) = ROLE_GUARD
 			}
-			gosub *client_update
+			gosub *label_8928
 			flt
 			characreate -1, CREATURE_ID_ARKHAI, 37, 40
 			cdata(CDATA_AI_CALM, rc) = 3
 			cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
 			cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
@@ -7361,11 +7361,11 @@
 			flt
 			characreate -1, CREATURE_ID_SHOPKEEPER_CROW, 3, 26
 			cdata(CDATA_AI_CALM, rc) = 3
 			cdata(CDATA_ROLE, rc) = ROLE_SHOP_MAGIC, 21
 			snmagic cdatan(CDATAN_NAME, rc)
-			gosub *client_update
+			gosub *label_8928
 			repeat 10
 				flt
 				characreate -1, CREATURE_ID_HILL_CHILD, -3, 0
 			loop
 		}
@@ -7568,11 +7568,11 @@
 			repeat 4
 				flt
 				characreate -1, CREATURE_ID_GUARD2, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_GUARD
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 11
 				dbid = 0
 				gosub *fltChara
 				characreate -1, dbid, -3, 0
 			loop
@@ -7800,11 +7800,11 @@
 			repeat 5
 				flt
 				characreate -1, CREATURE_ID_BOUNTY_HUNTER, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_BOUNTY_HUNTER
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 20
 				dbid = 0
 				gosub *fltChara
 				characreate -1, dbid, -3, 0
 			loop
@@ -7959,11 +7959,11 @@
 				cdata(CDATA_ROLE, rc) = ROLE_BOUNTY_HUNTER
 			loop
 			flt
 			characreate -1, CREATURE_ID_CAPTAIN, 44, 31
 			cdata(CDATA_ROLE, rc) = ROLE_CITIZEN
-			gosub *client_update
+			gosub *label_8928
 			repeat 20
 				gosub *fltChara
 				characreate -1, CREATURE_ID_BUG, -3, 0
 			loop
 		}
@@ -8076,11 +8076,11 @@
 			loop
 			repeat 4
 				flt
 				characreate -1, CREATURE_ID_SWIMMER, -3, 0
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 11
 				gosub *fltChara
 				characreate -1, CREATURE_ID_BUG, -3, 0
 			loop
 		}
@@ -8264,11 +8264,11 @@
 			repeat 5
 				flt
 				characreate -1, CREATURE_ID_GUARD2, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_GUARD
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 10
 				gosub *fltChara
 				characreate -1, CREATURE_ID_BUG, -3, 0
 			loop
 		}
@@ -8395,11 +8395,11 @@
 			repeat 2
 				flt
 				characreate -1, CREATURE_ID_BOUNTY_HUNTER, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_BOUNTY_HUNTER
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 10
 				dbid = 0
 				gosub *fltChara
 				characreate -1, dbid, -3, 0
 			loop
@@ -8464,11 +8464,11 @@
 			repeat 2
 				flt
 				characreate -1, CREATURE_ID_BOUNTY_HUNTER, -3, 0
 				cdata(CDATA_ROLE, rc) = ROLE_BOUNTY_HUNTER
 			loop
-			gosub *client_update
+			gosub *label_8928
 			repeat 11
 				dbid = 0
 				gosub *fltChara
 				characreate -1, dbid, -3, 0
 			loop
@@ -8795,11 +8795,11 @@
 						}
 					}
 				loop
 			loop
 			prevsekai = 0
-			gosub *world_refresh
+			gosub *label_4923
 		}
 		mapupdate = 0
 		repeat 245
 			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_DEAD ) {
 				continue
@@ -8838,11 +8838,11 @@
 				pos p \ 34 * inf_tiles, p / 34 * inf_tiles
 				picload folder + file, 1
 			loop
 			gsel BUFFER_SCREEN
 			sekaikousin = 0
-			gosub *world_refresh
+			gosub *label_4923
 		}
 	}
 	if ( gdata(GDATA_AREA) == AREA_NORTH_TYRIS ) {
 		if ( gdata(GDATA_FLAG_MAIN) == 180 ) {
 			cdata(CDATA_X, CHARA_PLAYER) = adata(ADATA_X, 11)
@@ -8889,15 +8889,15 @@
 		rc = cnt
 		cdata(CDATA_EXIST, rc) = CHAR_STATE_ALIVE
 		if ( cbit(CHARA_BIT_HIRED, cnt) == TRUE ) {
 			cxinit = cdata(CDATA_X, CHARA_PLAYER)
 			cyinit = cdata(CDATA_Y, CHARA_PLAYER)
-			gosub *place_chara
+			gosub *label_4125
 		}
 		else {
 			cxinit = -1
-			gosub *place_chara
+			gosub *label_4125
 			cdata(CDATA_HP, rc) = cdata(CDATA_MAX_HP, rc)
 			cdata(CDATA_MP, rc) = cdata(CDATA_MAX_MP, rc)
 			cdata(CDATA_SP, rc) = cdata(CDATA_MAX_SP, rc)
 		}
 	loop
@@ -9135,20 +9135,20 @@
 				if ( rc >= MAX_CHARA_FOLLOWER & cbit(CHARA_BIT_LIVESTOCK, rc) != TRUE ) {
 					if ( cdata(CDATA_KARMA, CHARA_PLAYER) < (-30) ) {
 						if ( cdata(CDATA_LEVEL, CHARA_PLAYER) > cdata(CDATA_LEVEL, rc) ) {
 							r1 = rc
 							r2 = 1
-							gosub *calcLevelUp
+							gosub *label_3967
 						}
 					}
 				}
 			}
 			if ( cdata(CDATA_ID, rc) == CREATURE_ID_GWEN_THE_PITILESS & cdata(CDATA_ROLE, rc) == ROLE_SPECIAL & rc >= MAX_CHARA_FOLLOWER & cbit(CHARA_BIT_LIVESTOCK, rc) != TRUE & cdata(CDATA_LEVEL, rc) < 500 & cdata(CDATA_ALLIED, rc) == 0 ) {
 				repeat gdata(GDATA_GWEN_PITILESS_LVL)
 					r1 = rc
 					r2 = 1
-					gosub *calcLevelUp
+					gosub *label_3967
 				loop
 				gdata(GDATA_GWEN_PITILESS_LVL) = 0
 			}
 			if ( rc >= MAX_CHARA_SAVE ) {
 				cdata(CDATA_HP, rc) = cdata(CDATA_MAX_HP, rc)
@@ -9455,20 +9455,20 @@
 	raderw = 120 / mdata(MDATA_WIDTH) + 2
 	raderh = 84 / mdata(MDATA_HEIGHT) + 2
 	scx = cdata(CDATA_X, CHARA_PLAYER)
 	scy = cdata(CDATA_Y, CHARA_PLAYER)
 	msync = 1
-	gosub *map_prepareTile
+	gosub *label_4912
 	gosub *rader_preDraw
-	gosub *screen_setPos
+	gosub *label_3908
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Map:Update quest" + " ct:" + ct
 	if ( mdata(MDATA_TYPE) == MAP_TYPE_TOWN | gdata(GDATA_AREA) == AREA_LUDUS ) {
 		if ( gdata(GDATA_AREA) != AREA_GUARDIAN_SHRINE & gdata(GDATA_AREA) != AREA_BLIMP ) {
 			if ( adata(ADATA_QUEST_RENEW, gdata(GDATA_AREA)) != 4 ) {
-				gosub *client_update
-				gosub *quest_update
+				gosub *label_8928
+				gosub *label_8933
 			}
 		}
 	}
 	if ( mode == MODELIST_MAP ) {
 		return
@@ -11259,21 +11259,21 @@
 		}
 	}
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Map:Init music" + " ct:" + ct
 	gosub *music_play
-	gosub *fixOnMapEnter
+	gosub *label_5778
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Map:Init world" + " ct:" + ct
 	noaggrorefresh = 0
 	if ( adata(ADATA_TYPE, gdata(GDATA_AREA)) == MAP_TYPE_WORLD ) {
 		gosub *cloud_init
 		if ( rnd(150) == 0 ) {
 			gdata(GDATA_WORLD_RENEW) = TRUE
-			gosub *world_newRandArea
+			gosub *label_4913
 		}
-		gosub *world_update
+		gosub *label_4919
 	}
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Map:Continue" + " ct:" + ct
 	if ( mode == MODELIST_CONTINUE ) {
 		mode = MODELIST_MAIN
@@ -11415,18 +11415,18 @@
 		loop
 		mdata(MDATA_TYPE) = mtypebk
 	}
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
 		repeat 5
-			gosub *chara_spawn
+			gosub *label_4647
 		loop
 	}
 	if ( mdata(MDATA_CAN_SAVE) == 1 ) {
 		gosub *item_rot
 	}
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
-		gosub *shop_update
+		gosub *label_4622
 	}
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM ) {
 		gosub *museum_update
 	}
 	if ( gdata(GDATA_AREA) == AREA_HOME ) {
@@ -11918,11 +11918,11 @@
 									val = 1
 								}
 								else {
 									val = 0
 								}
-								gosub *item_seedGrowth
+								gosub *label_6525
 							loop
 							cell_featset cnt, y, feat, feat(FEAT_CELL_FEATURE_ID), feat(FEAT_CELL_SUB_FEATURE_ID), feat(FEAT_CELL_PARAM_1)
 						}
 					}
 				loop
@@ -11970,11 +11970,11 @@
 		}
 		mdata(MDATA_RENEW_MINOR) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + 24
 	}
 	return
 
-*map_prepareTile
+*label_4912
 	procid = (procid + 1) \ 4
 	proclist(procid) = "map_prepareTile:begin" + " ct:" + ct
 	if ( gdata(GDATA_AREA) == AREA_ZAILE ) {
 		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) != 3 ) {
 			adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) = 3
@@ -12124,11 +12124,11 @@
 	gmode 2, 24, 24
 	procid = (procid + 1) \ 4
 	proclist(procid) = "map_prepareTile:end" + " ct:" + ct
 	return
 
-*world_newRandArea
+*label_4913
 	procid = (procid + 1) \ 4
 	proclist(procid) = "world_newRandArea" + " ct:" + ct
 	p = 0
 	repeat 500 - 450, 450
 		if ( adata(ADATA_ID, cnt) == AREA_RANDOM_DUNGEON ) {
@@ -12143,15 +12143,15 @@
 	}
 	if ( gdata(GDATA_WORLD) != AREA_AIMWELL ) {
 		repeat p
 			cxinit = rnd(mdata(MDATA_WIDTH))
 			cyinit = rnd(mdata(MDATA_HEIGHT))
-			gosub *map_createRandArea
+			gosub *label_4933
 		loop
 	}
 	gdata(GDATA_FLAG_STATUE_OPATOS) = 0
-	gosub *world_refresh
+	gosub *label_4923
 	return 1
 	repeat 500 - 450, 450
 		if ( adata(ADATA_ID, cnt) == AREA_NONE ) {
 			continue
 		}
@@ -12159,11 +12159,11 @@
 			if ( rnd(3) == 0 ) {
 				adata(ADATA_BOSS, cnt) = -1
 			}
 		}
 	loop
-	gosub *world_update
+	gosub *label_4919
 	repeat 500 - 450, 450
 		if ( adata(ADATA_ID, cnt) == AREA_NONE ) {
 			continue
 		}
 		if ( adata(ADATA_ID, cnt) == AREA_RANDOM_DUNGEON ) {
@@ -12171,46 +12171,46 @@
 			adata(ADATA_Y, cnt) = cnt * 3 \ mdata(MDATA_HEIGHT)
 			adata(ADATA_MIN_LEVEL, cnt) = 33
 			adata(ADATA_MAX_LEVEL, cnt) = 33
 		}
 	loop
-	gosub *world_clear
-	gosub *world_setArea
+	gosub *label_4929
+	gosub *label_4924
 	return
 
-*world_update
+*label_4919
 	procid = (procid + 1) \ 4
 	proclist(procid) = "world_update" + " ct:" + ct
 	if ( gdata(GDATA_WORLD_RENEW) == TRUE ) {
-		gosub *setArea
-		gosub *world_refresh
+		gosub *label_4932
+		gosub *label_4923
 		repeat 500 - 450, 450
 			adata(ADATA_ID, cnt) = AREA_NONE
 		loop
 		if ( gdata(GDATA_AREA) == AREA_NORTH_TYRIS ) {
 			map_initcustom "ntyris"
-			gosub *world_newRandArea
+			gosub *label_4913
 			map_placeplayer
 		}
 		if ( gdata(GDATA_AREA) == AREA_SOUTH_TYRIS ) {
 			map_initcustom "styris"
-			gosub *world_newRandArea
+			gosub *label_4913
 			map_placeplayer
 		}
 		if ( gdata(GDATA_AREA) == AREA_TEST_WORLD ) {
 			map_initcustom "test"
-			gosub *world_newRandArea
+			gosub *label_4913
 			map_placeplayer
 		}
 		if ( gdata(GDATA_AREA) == AREA_LOST_YLVA ) {
 			map_initcustom "lost"
-			gosub *world_newRandArea
+			gosub *label_4913
 			map_placeplayer
 		}
 		if ( gdata(GDATA_AREA) == AREA_AIMWELL ) {
 			map_initcustom "ether"
-			gosub *world_newRandArea
+			gosub *label_4913
 			map_placeplayer
 		}
 	}
 	p = 0
 	repeat 500 - 450, 450
@@ -12234,22 +12234,22 @@
 					adata(ADATA_ID, cnt) = AREA_NONE
 					map(adata(ADATA_X, cnt), adata(ADATA_Y, cnt), MAP_TILE_ID) = xy2pic(0, 0)
 				}
 			}
 		loop
-		gosub *world_newRandArea
-		gosub *world_refresh
+		gosub *label_4913
+		gosub *label_4923
 	}
 	gdata(GDATA_WORLD_RENEW) = FALSE
 	return
 
-*world_refresh
-	gosub *world_clear
-	gosub *world_setArea
+*label_4923
+	gosub *label_4929
+	gosub *label_4924
 	return
 
-*world_setArea
+*label_4924
 	procid = (procid + 1) \ 4
 	proclist(procid) = "world_setArea:building" + " ct:" + ct
 	gosub *mapchip_init
 	repeat 20
 		cnt2 = cnt
@@ -12331,11 +12331,11 @@
 	loop
 	procid = (procid + 1) \ 4
 	proclist(procid) = "world_setArea:end" + " ct:" + ct
 	return
 
-*world_clear
+*label_4929
 	repeat mdata(MDATA_HEIGHT)
 		y = cnt
 		repeat mdata(MDATA_WIDTH)
 			x = cnt
 			cell_featread x, y
@@ -12347,11 +12347,11 @@
 			map(x, y, MAP_LIGHT_TYPE) = 0
 		loop
 	loop
 	return
 
-*setArea
+*label_4932
 	p = 91
 	adata(ADATA_ID, p) = AREA_AIMWELL
 	adata(ADATA_ICON, p) = xy2pic(0, 0)
 	adata(ADATA_TYPE, p) = MAP_TYPE_WORLD
 	adata(ADATA_X, p) = 20
@@ -13851,11 +13851,11 @@
 	adata(ADATA_CAN_SAVE, p) = 0
 	adata(ADATA_RESTORE_POS, p) = 0
 	adata(ADATA_PARENT, p) = AREA_NORTH_TYRIS
 	return
 
-*map_createRandArea
+*label_4933
 	repeat 500 - 450, 450
 		if ( adata(ADATA_ID, cnt) != AREA_NONE ) {
 			continue
 		}
 		f = -1
@@ -13992,11 +13992,11 @@
 		}
 		break
 	loop
 	return p
 
-*mapEvent
+*label_4937
 	if ( gdata(GDATA_AREA) == AREA_NOYEL ) {
 		if ( gdata(GDATA_FLAG_FIRE_GIANT) == 1 ) {
 			if ( cdata(CDATA_EXIST, gdata(GDATA_FLAG_GIANT_ID)) == CHAR_STATE_ALIVE ) {
 				if ( gdata(GDATA_CROWD) < 30 ) {
 					if ( rnd(4) == 0 ) {
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/map_func.hsp ../2.14-borscht/map_func.hsp
--- ../2.13-borscht/map_func.hsp	2022-06-26 12:14:16.898427500 -0700
+++ ../2.14-borscht/map_func.hsp	2022-09-18 12:37:01.709477600 -0700
@@ -612,14 +612,14 @@
 		locvar_map_placecharaonentrance_y = mapstarty
 	}
 	cxinit = locvar_map_placecharaonentrance_x
 	cyinit = locvar_map_placecharaonentrance_y
 	rc = map_placecharaonentrance_arg1
-	gosub *place_chara
+	gosub *label_4125
 	return
 
-*label_4307
+*label_4314
 
 #deffunc map_placearena int map_placearena_arg1, int map_placearena_arg2
 	repeat
 		await
 		x = rnd(7) + 5
@@ -628,11 +628,11 @@
 			x += 8
 		}
 		cxinit = x
 		cyinit = y
 		rc = map_placearena_arg1
-		gosub *place_chara
+		gosub *label_4125
 		if ( map_placearena_arg2 == 0 ) {
 			if ( cdata(CDATA_X, map_placearena_arg1) >= 13 & cdata(CDATA_Y, map_placearena_arg1) >= 6 & cdata(CDATA_X, map_placearena_arg1) < 20 & cdata(CDATA_Y, map_placearena_arg1) < 12 ) {
 				break
 			}
 		}
@@ -679,11 +679,11 @@
 		if ( cdata(CDATA_AREA, cnt) == gdata(GDATA_AREA) ) {
 			if ( cnt != 0 ) {
 				cxinit = cdata(CDATA_X_ORG, cnt)
 				cyinit = cdata(CDATA_Y_ORG, cnt)
 				rc = cnt
-				gosub *place_chara
+				gosub *label_4125
 				continue
 			}
 		}
 		map_placecharaonentrance cnt, gdata(GDATA_LEVEL_START_ON)
 	loop
@@ -2038,11 +2038,11 @@
 	picload exedir + "\\graphic\\item" + devfile + ".bmp", 1
 	gsel BUFFER_SCREEN
 	gosub *mapEditor_main_WEND1
 	gosub *cmap_init2
 	gosub *cmap_init3
-	gosub *map_prepareTile
+	gosub *label_4912
 
 *mapEditor_main
 	map_tileset dbg_tileset
 	gosub *mapEditor_editMode
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/map_rand.hsp ../2.14-borscht/map_rand.hsp
--- ../2.13-borscht/map_rand.hsp	2022-06-26 12:14:16.931457800 -0700
+++ ../2.14-borscht/map_rand.hsp	2022-09-18 12:37:01.761525300 -0700
@@ -237,11 +237,11 @@
 			mdata(MDATA_WIDTH) = 28 + rnd(6)
 			mdata(MDATA_HEIGHT) = 20 + rnd(6)
 			rdtype = RANDOM_DUNGEON_HUNT
 		}
 		if ( gdata(GDATA_QUEST) == QUEST_TYPE_PARTY ) {
-			gosub *map_createDungeonPerform
+			gosub *label_4520
 			return
 		}
 		if ( gdata(GDATA_QUEST) == QUEST_TYPE_HARVEST ) {
 			gosub *map_createDungeonHarvest
 			return
@@ -249,15 +249,15 @@
 		if ( gdata(GDATA_QUEST) == QUEST_TYPE_MINEFIELD ) {
 			gosub *map_createDungeonMinefield
 			return
 		}
 		if ( gdata(GDATA_QUEST) == QUEST_TYPE_CONQUER ) {
-			gosub *map_createDungeonConquer
+			gosub *label_4533
 			return
 		}
 		if ( gdata(GDATA_QUEST) == QUEST_TYPE_HUNTEX ) {
-			gosub *map_createDungeonConquer
+			gosub *label_4533
 			return
 		}
 	}
 	if ( dbg_rdtype ) {
 		rdtype = dbg_rdtype
@@ -281,11 +281,11 @@
 		mdata(MDATA_FIELD) = MAP_FIELD_OUTDOOR
 		gosub *map_createDungeonHunt
 		return
 	}
 	if ( rdtype == RANDOM_DUNGEON_LONG ) {
-		gosub *map_createDungeonHighPass
+		gosub *label_4544
 	}
 	if ( rdtype == RANDOM_DUNGEON_DOG ) {
 		_mclass = 5 + rnd(4)
 		_bold = 2
 		gosub *map_createDungeonDog
@@ -439,18 +439,23 @@
 		p = limit(rnd(mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) / 500 + 1) + 1, 3, 15)
 		repeat p
 			map_barrel 0, 0
 		loop
 	}
-	bdderu = limit(15 + gdata(GDATA_SISTER_KILLED) * 2, 15, 35) * 2 / 3
 	if ( mdata(MDATA_CAN_SAVE) == 1 ) {
+		bdderu = limit(15 + gdata(GDATA_SISTER_KILLED) * 2, 15, 35) * 2 / 3
 		if ( rnd(bdderu) == 0 ) {
 			flt
 			initlv = limit(gdata(GDATA_LEVEL), 30, 300)
 			novoidlv = 1
 			characreate -1, CREATURE_ID_BIG_DADDY, -3, 0
 		}
+		dernefia = limit(140 - gdata(GDATA_LEVEL), 40, 140) / 2
+		if ( rnd(dernefia) == 0 ) {
+			flt
+			itemcreate -1, 1264, -1, -1, 0
+		}
 	}
 	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANDOM_DUNGEON ) {
 		if ( gdata(GDATA_LEVEL) != adata(ADATA_MIN_LEVEL, gdata(GDATA_AREA)) ) {
 			nkane = limit(gdata(GDATA_LEVEL), 1, 400)
 			flt
@@ -1011,11 +1016,11 @@
 	}
 	map_placeupstairs p, rnd(mdata(MDATA_HEIGHT) - 4) + 2
 	map_placedownstairs p(1) + 1, rnd(mdata(MDATA_HEIGHT) - 4) + 2
 	return 1
 
-*map_createDungeonPerform
+*label_4520
 	gdata(GDATA_TIME_LIMIT) = 60
 	gdata(GDATA_COUNT_NOTICE) = 9999
 	rdroomsizemin = 5
 	mdatan(0) = lang("パーティー場", "Party Room")
 	mdata(MDATA_FIELD) = MAP_FIELD_INDOOR
@@ -1494,11 +1499,11 @@
 			inv(INV_ITEM_PROPERTY, cnt) = PROP_NPC
 		}
 	loop
 	return 1
 
-*map_createDungeonConquer
+*label_4533
 	mdata(MDATA_MODERATE_CROWD) = 0
 	mdata(MDATA_FIELD) = MAP_FIELD_OUTDOOR
 	map_initcustom mapfile(gdata(GDATA_RETURN_AREA))
 	mdatan(0) = lang("市街地", "Urban Area")
 	randomize
@@ -1639,11 +1644,11 @@
 			w = mdata(MDATA_WIDTH) - dx
 		}
 	loop
 	return
 
-*map_createDungeonHighPass
+*label_4544
 	mdata(MDATA_WIDTH) = 30
 	mdata(MDATA_HEIGHT) = 60 + rnd(60)
 	mdata(MDATA_MODERATE_CROWD) = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) / 20
 	map_initialize
 	w = 6
@@ -2011,10 +2016,2822 @@
 			}
 		loop
 	loop
 	return
 
+*label_4573
+	if ( gdata(GDATA_HOME_LEVEL) == 0 ) {
+		mdata(MDATA_MAX_INV) = 100
+		gdata(GDATA_HOME_BASE) = 1000
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 1 ) {
+		mdata(MDATA_MAX_INV) = 150
+		gdata(GDATA_HOME_BASE) = 3000
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 2 ) {
+		mdata(MDATA_MAX_INV) = 200
+		gdata(GDATA_HOME_BASE) = 5000
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 3 ) {
+		mdata(MDATA_MAX_INV) = 300
+		gdata(GDATA_HOME_BASE) = 7000
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 4 ) {
+		mdata(MDATA_MAX_INV) = 350
+		gdata(GDATA_HOME_BASE) = 8000
+		mdata(MDATA_TILESET) = MAP_TILESET_SF
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 5 ) {
+		mdata(MDATA_MAX_INV) = 400
+		gdata(GDATA_HOME_BASE) = 10000
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 6 ) {
+		mdata(MDATA_MAX_INV) = 400
+		gdata(GDATA_HOME_BASE) = 15000
+	}
+	return
+
+*building_new
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
+		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
+			if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CROP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_STORAGE_HOUSE | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DISCARDED_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DUNGEON ) {
+				item_separate ci
+				inv(INV_ITEM_PARAM2, ci) = gdata(GDATA_AREA)
+				txt lang("物件No" + inv(INV_ITEM_PARAM2, ci) + "を登録" + adata(ADATA_ARENA_WIN, gdata(GDATA_AREA)) + "した。", "You can only use it in the world map.")
+				adata(ADATA_ARENA_WIN, gdata(GDATA_AREA)) = -1
+				snd SOUNDLIST_ENC
+				gosub *screen_draw
+				goto *pc_turn
+			}
+		}
+		if ( inv(INV_ITEM_PARAM2, ci) == 0 ) {
+			snd SOUNDLIST_FAIL1
+			txt lang("移設したい物件内で読むとNoを登録できる。", "You can only use it in the world map.")
+			gosub *screen_draw
+			goto *pc_turn
+		}
+	}
+	if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
+		txt lang("それはワールドマップでしか使えない。", "You can only use it in the world map.")
+		gosub *screen_draw
+		goto *pc_turn
+	}
+	cell_featread cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
+	if ( feat(FEAT_CELL_PIC) != 0 ) {
+		txt lang("その場所には建てられない。", "You can't build it here.")
+		gosub *screen_draw
+		goto *pc_turn
+	}
+	area = -1
+	repeat 450 - 300, 300
+		if ( adata(ADATA_ID, cnt) == AREA_NONE ) {
+			area = cnt
+			break
+		}
+	loop
+	if ( area == (-1) ) {
+		txt lang("もうこれ以上建物は建てられない。", "You can't build a building anymore.")
+		gosub *screen_draw
+		goto *pc_turn
+	}
+	if ( inv(INV_ITEM_ID, ci) != ITEM_ID_DEED_PROPERTY_TRANSFER ) {
+		txt lang("本当にこの場所に建設する？ ", "Really build it here? ")
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
+		txt lang("本当にこの場所に移設する？ ", "Really move it here? ")
+	}
+	promptl(0, 0) = stryes, "y", "0"
+	promptl(0, 1) = strno, "n", "1"
+	promptmax = 2
+	val = promptx, prompty, 160, 1
+	gosub *prompt_key
+	if ( rtval != 0 ) {
+		gosub *screen_draw
+		goto *pc_turn
+	}
+	if ( spact(SKILL_SPACT_MARKING - STARTING_SKILL_SPACT) == 0 ) {
+		spact(SKILL_SPACT_MARKING - STARTING_SKILL_SPACT) = 1
+		txtmore
+		txtef COLOR_YELLOW
+		txt lang("あなたは「" + skillname(SKILL_SPACT_MARKING) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_MARKING) + ".")
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED ) {
+		gdata(GDATA_HOME_LEVEL) = inv(INV_ITEM_PARAM1, ci)
+		inv(INV_ITEM_NUM, ci)--
+		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+		gosub *label_4578
+		midbk = mid
+		mid = "" + 7 + "_" + (100 + 1)
+		fmode = 12
+		gosub *game_ctrlFile
+		mid = midbk
+		gosub *label_4923
+		levelexitby = MAP_EXIT_TELEPORT
+		gdata(GDATA_TELEPORT_AREA) = AREA_HOME
+		gdata(GDATA_TELEPORT_LEVEL) = 1
+		gdata(GDATA_WORLD_X) = adata(ADATA_X, 7)
+		gdata(GDATA_WORLD_Y) = adata(ADATA_Y, 7)
+		snd SOUNDLIST_BUILD1
+		txtef COLOR_GREEN
+		txt lang("新しい家を建てた！ ", "You've built a new house!")
+		msg_halt
+		snd SOUNDLIST_EXITMAP1
+		exgauge = 10
+		goto *map_exit
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_HOME_RELOCATION ) {
+		inv(INV_ITEM_NUM, ci)--
+		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+		doukutu = 100
+		gosub *label_4578
+		gosub *label_4923
+		levelexitby = MAP_EXIT_TELEPORT
+		gdata(GDATA_TELEPORT_AREA) = AREA_HOME
+		gdata(GDATA_TELEPORT_LEVEL) = 1
+		gdata(GDATA_WORLD_X) = adata(ADATA_X, 7)
+		gdata(GDATA_WORLD_Y) = adata(ADATA_Y, 7)
+		snd SOUNDLIST_BUILD1
+		txtef COLOR_GREEN
+		txt lang("引っ越しが完了した！ ", "You've move house!")
+		msg_halt
+		snd SOUNDLIST_EXITMAP1
+		if ( gdata(GDATA_HOME_LEVEL) == 0 ) {
+			gdata(GDATA_FLAG_HOME_MOVED) = 1
+		}
+		goto *map_exit
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
+		bukken = inv(INV_ITEM_PARAM2, ci)
+		inv(INV_ITEM_NUM, ci)--
+		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+		adata(ADATA_X, bukken) = cdata(CDATA_X, CHARA_PLAYER)
+		adata(ADATA_Y, bukken) = cdata(CDATA_Y, CHARA_PLAYER)
+		adata(ADATA_PARENT, bukken) = gdata(GDATA_WORLD)
+		gosub *label_4923
+		levelexitby = MAP_EXIT_TELEPORT
+		gdata(GDATA_TELEPORT_AREA) = bukken
+		gdata(GDATA_TELEPORT_LEVEL) = 1
+		gdata(GDATA_WORLD_X) = adata(ADATA_X, bukken)
+		gdata(GDATA_WORLD_Y) = adata(ADATA_Y, bukken)
+		snd SOUNDLIST_BUILD1
+		txtef COLOR_GREEN
+		txt lang("移設が完了した！ ", "You've move property!")
+		msg_halt
+		adata(ADATA_ARENA_WIN, bukken) = 0
+		snd SOUNDLIST_EXITMAP1
+		goto *map_exit
+	}
+	fmode = 13
+	gosub *game_ctrlFile
+	p = area
+	adata(ADATA_X, p) = cdata(CDATA_X, CHARA_PLAYER)
+	adata(ADATA_Y, p) = cdata(CDATA_Y, CHARA_PLAYER)
+	adata(ADATA_TYPE, p) = MAP_TYPE_HOME
+	adata(ADATA_CAN_SAVE, p) = 1
+	adata(ADATA_RESTORE_POS, p) = 0
+	adata(ADATA_TILESET, p) = 3
+	adata(ADATA_TIME_SCALE, p) = 10000
+	adata(ADATA_MIN_LEVEL, p) = 1
+	adata(ADATA_MAX_LEVEL, p) = 1
+	adata(ADATA_TILE_FILE, p) = 1
+	adata(ADATA_START_ON, p) = 8
+	adata(ADATA_PARENT, p) = gdata(GDATA_WORLD)
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_MUSEUM ) {
+		adata(ADATA_ID, p) = AREA_MUSEUM
+		adata(ADATA_ICON, p) = xy2pic(19, 4)
+		adata(ADATA_FIELD, p) = 1
+		s = lang("博物館", "museum")
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_SHOP ) {
+		adata(ADATA_ID, p) = AREA_SHOP
+		adata(ADATA_ICON, p) = xy2pic(18, 4)
+		adata(ADATA_FIELD, p) = 1
+		s = lang("店", "shop")
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_FARM ) {
+		adata(ADATA_ID, p) = AREA_CROP
+		adata(ADATA_ICON, p) = xy2pic(20, 4)
+		adata(ADATA_FIELD, p) = 2
+		s = lang("畑", "crop")
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_STORAGE_HOUSE ) {
+		adata(ADATA_ID, p) = AREA_STORAGE_HOUSE
+		adata(ADATA_ICON, p) = xy2pic(21, 4)
+		adata(ADATA_FIELD, p) = 1
+		s = lang("倉庫", "storage")
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_RANCH ) {
+		adata(ADATA_ID, p) = AREA_RANCH
+		adata(ADATA_ICON, p) = xy2pic(22, 4)
+		adata(ADATA_FIELD, p) = 2
+		adata(ADATA_RESTORE_POS, p) = 1
+		s = lang("牧場", "ranch")
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_DUNGEON ) {
+		adata(ADATA_ID, p) = AREA_DUNGEON
+		adata(ADATA_ICON, p) = xy2pic(6, 4)
+		adata(ADATA_FIELD, p) = 1
+		adata(ADATA_RESTORE_POS, p) = 1
+		s = lang("ダンジョン", "dungeon")
+	}
+	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_DISCARDED_RANCH ) {
+		adata(ADATA_ID, p) = AREA_DISCARDED_RANCH
+		adata(ADATA_ICON, p) = xy2pic(10, 4)
+		adata(ADATA_FIELD, p) = 2
+		adata(ADATA_RESTORE_POS, p) = 1
+		s = lang("廃モンスター牧場", "discarded ranch")
+	}
+	snd SOUNDLIST_BUILD1
+	txtef COLOR_YELLOW
+	txt lang("あなたは" + s + "を建設した！ ", "You've built a " + s + "!")
+	gosub *label_4923
+	inv(INV_ITEM_NUM, ci)--
+	cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+	goto *label_9247
+	area = -1
+	repeat 450 - 300, 300
+		if ( adata(ADATA_ID, cnt) == AREA_NONE ) {
+			area = cnt
+			break
+		}
+	loop
+	p = area
+	adata(ADATA_TYPE, p) = MAP_TYPE_HOME
+	adata(ADATA_CAN_SAVE, p) = 1
+	adata(ADATA_RESTORE_POS, p) = 0
+	adata(ADATA_TILESET, p) = 3
+	adata(ADATA_TIME_SCALE, p) = 10000
+	adata(ADATA_MIN_LEVEL, p) = 1
+	adata(ADATA_MAX_LEVEL, p) = 1
+	adata(ADATA_TILE_FILE, p) = 1
+	adata(ADATA_START_ON, p) = 8
+	adata(ADATA_ID, p) = AREA_DUNGEON
+	adata(ADATA_ICON, p) = xy2pic(6, 4)
+	adata(ADATA_FIELD, p) = 1
+	adata(ADATA_RESTORE_POS, p) = 1
+	s = lang("ダンジョン", "dungeon")
+	gdata(GDATA_AREA) = area
+	gdata(GDATA_LEVEL) = 1
+	gdata(GDATA_LEVEL_START_ON) = 8
+	return
+
+*label_4578
+	p = 7
+	adata(ADATA_ICON, p) = xy2pic(11, 4)
+	if ( gdata(GDATA_HOME_LEVEL) == 0 ) {
+		adata(ADATA_ICON, p) = xy2pic(6, 4)
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 4 ) {
+		adata(ADATA_ICON, p) = xy2pic(16, 4)
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 5 ) {
+		adata(ADATA_ICON, p) = xy2pic(12, 4)
+	}
+	if ( gdata(GDATA_HOME_LEVEL) == 6 ) {
+		adata(ADATA_ICON, p) = xy2pic(4, 4)
+	}
+	if ( doukutu == 100 | gdata(GDATA_HOME_LEVEL) != 0 ) {
+		adata(ADATA_X, p) = cdata(CDATA_X, CHARA_PLAYER)
+		adata(ADATA_Y, p) = cdata(CDATA_Y, CHARA_PLAYER)
+		doukutu = 0
+	}
+	adata(ADATA_PARENT, p) = gdata(GDATA_WORLD)
+	return
+
+*com_home
+	txtnew
+	if ( 0 == 0 ) {
+		if ( mdata(MDATA_TYPE) != MAP_TYPE_HOME ) {
+			msgdup++
+			txt lang("ここはあなたの家ではない。", "You can only use it in your home.")
+			gosub *screen_draw
+			goto *pc_turn
+		}
+	}
+	inv_getheader -1
+	p = 0, 0, 0
+	repeat invrange, invhead
+		p(2)++
+		if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
+			if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) != FILTER_FURNITURE ) {
+				p++
+			}
+			else {
+				p(1)++
+			}
+		}
+	loop
+	if ( mdata(MDATA_MAX_INV) != 0 ) {
+		p(2) = mdata(MDATA_MAX_INV)
+	}
+	txt lang(mapname(gdata(GDATA_AREA)) + "には" + p + "個のアイテムと" + p(1) + "個の家具がある(アイテム最大" + p(2) + "個) ", "There are " + p + " items and " + p(1) + " furniture in " + mapname(gdata(GDATA_AREA)) + ".(Max: " + p(2) + ") ")
+	txtmore
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_GOODS ) {
+			shops = lang("何でも屋", "Goods shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_FOOD ) {
+			shops = lang("食品店", "Food shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_MAGIC ) {
+			shops = lang("魔法店", "Magic shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_BLACKSMITH ) {
+			shops = lang("武具店", "Blacksmith")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_INN ) {
+			shops = lang("宿屋", "Inn shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_DECORATIVE_ARTS ) {
+			shops = lang("装飾家具店", "Decorative arts shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_JUNK ) {
+			shops = lang("ジャンク屋", "Junk shop")
+		}
+		txt lang("店タイプ：" + shops + "。", "Shop type : " + shops + ".")
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 0 ) {
+			txt lang("販売制限なし。", "Shop type : " + shops + ".")
+		}
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 1 ) {
+			txt lang("1日15品限定販売。", "15 items limited sale.")
+		}
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 2 ) {
+			txt lang("1日5品限定販売。", "5 items limited sale")
+		}
+		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+			txt lang("現在の店主：" + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + " ", "Current shopkeeper is " + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + ".")
+		}
+		else {
+			txt lang("現在店主はいない。", "You haven't assigned a shopkeeper yet.")
+		}
+		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+			sc = getworker(gdata(GDATA_AREA))
+			p = sdata(156 + STARTING_SKILL_SPACT, sc) \ 1000
+			if ( p >= 400 ) {
+				txt lang("[交渉潜在：Supreme]", "[Trade potential : Supreme]")
+			}
+			if ( p >= 300 & p < 400 ) {
+				txt lang("[交渉潜在：Amazing]", "[Trade potential : Amazing]")
+			}
+			if ( p >= 200 & p < 300 ) {
+				txt lang("[交渉潜在：Superb]", "[Trade potential : Superb]")
+			}
+			if ( p >= 150 & p < 200 ) {
+				txt lang("[交渉潜在：Great]", "[Trade potential : Great]")
+			}
+			if ( p >= 100 & p < 150 ) {
+				txt lang("[交渉潜在：Good]", "[Trade potential : Good]")
+			}
+			if ( p >= 50 & p < 100 ) {
+				txt lang("[交渉潜在：Bad]", "[Trade potential : Bad]")
+			}
+			if ( p < 50 ) {
+				txt lang("[交渉潜在：Hopeless]", "[Trade potential : Hopeless]")
+			}
+			p = sdata(17 + STARTING_SKILL_SPACT, sc) \ 1000
+			if ( p >= 400 ) {
+				txt lang("[魅力潜在：Supreme]", "[Charisma potential : Supreme]")
+			}
+			if ( p >= 300 & p < 400 ) {
+				txt lang("[魅力潜在：Amazing]", "[Charisma potential : Amazing]")
+			}
+			if ( p >= 200 & p < 300 ) {
+				txt lang("[魅力潜在：Superb]", "[Charisma potential : Superb]")
+			}
+			if ( p >= 150 & p < 200 ) {
+				txt lang("[魅力潜在：Great]", "[Charisma potential : Great]")
+			}
+			if ( p >= 100 & p < 150 ) {
+				txt lang("[魅力潜在：Good]", "[Charisma potential : Good]")
+			}
+			if ( p >= 50 & p < 100 ) {
+				txt lang("[魅力潜在：Bad]", "[Charisma potential : Bad]")
+			}
+			if ( p < 50 ) {
+				txt lang("[魅力潜在：Hopeless]", "[Charisma potential : Hopeless]")
+			}
+			txt lang("[営業実績：" + cdata(CDATA_SALES_EXP, sc) + "]", "[Sales exp: " + cdata(CDATA_SALES_EXP, sc) + "]")
+		}
+	}
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH ) {
+		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+			txt lang("現在のブリーダーは" + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + "だ。", "Current breeder is " + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + ".")
+		}
+		else {
+			txt lang("現在ブリーダーはいない。", "You haven't assigned a breeder yet.")
+		}
+	}
+	if ( gdata(GDATA_AREA) == AREA_HOME ) {
+		p = 0
+		repeat 245 - 57, 57
+			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE | cdata(CDATA_EXIST, cnt) == CHAR_STATE_SPIRIT ) {
+				if ( cdata(CDATA_ROLE, cnt) != ROLE_NONE ) {
+					p++
+				}
+			}
+		loop
+		txtmore
+		txt lang("現在" + p + "人の滞在者がいる(最大" + (gdata(GDATA_HOME_LEVEL) + 2) + "人) ", "" + p + " members are staying at your home. (Max: " + (gdata(GDATA_HOME_LEVEL) + 2) + ").")
+	}
+	txtnew
+	txt lang("何をする？", "What do you want to do?")
+	p = 0
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
+		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+			kunren = 0
+			sc = getworker(gdata(GDATA_AREA))
+			kunren = limit((sdata(SKILL_NORMAL_NEGOTIATION, sc) + sdata(SKILL_ATTR_CHA, sc)) / 100 + 1, 1, 20)
+			if ( sorg(SKILL_NORMAL_NEGOTIATION, sc) == 0 ) {
+				kunren = 1000000
+			}
+		}
+		promptl(0, promptmax) = lang("仲間に店主を頼む", "Assign a shopkeeper"), "null", "" + 4
+		promptmax++
+		if ( mdata(MDATA_MAX_INV) < 400 ) {
+			promptl(0, promptmax) = lang("店を拡張", "Extend") + "(" + calcshopreform() + " GP)", "null", "" + 5
+			promptmax++
+		}
+		promptl(0, promptmax) = lang("店の種類変更", "Change shop type"), "null", "" + 11
+		promptmax++
+		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+			if ( kunren != 1000000 ) {
+				promptl(0, promptmax) = lang("店主訓練 (ブロンズ硬貨" + kunren + "枚)", "Training of shopkeeper by " + kunren + " bronze coin"), "null", "" + 12
+				promptmax++
+			}
+		}
+		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+			promptl(0, promptmax) = lang("営業フィート獲得", "Get shopkeeper feat"), "null", "" + 13
+			promptmax++
+		}
+		promptl(0, promptmax) = lang("1日の販売数を制限", "Limited sales per day"), "null", "" + 14
+		promptmax++
+		promptl(0, promptmax) = lang("バイトを雇う（未実装）", "Hire part time worker (Unimplemented) "), "null", "" + 15
+		promptmax++
+	}
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH ) {
+		promptl(0, promptmax) = lang("ブリーダーを任命する", "Assign a breeder"), "null", "" + 4
+		promptmax++
+		promptl(0, promptmax) = lang("家畜・ブリーダー移動", "Move a livestock"), "null", "" + 3
+		promptmax++
+		promptl(0, promptmax) = lang("餌を撒く（家畜の餌消費）", "Consume livestock feed"), "null", "" + 17
+		promptmax++
+		promptl(0, promptmax) = lang("場内消毒（浄化消毒薬消費）", "Consume disinfectant"), "null", "" + 18
+		promptmax++
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 0 ) {
+			promptl(0, promptmax) = lang("繁殖防止コード発動", "Activate breeding-prevent code"), "null", "" + 19
+			promptmax++
+		}
+		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) == 0 ) {
+			promptl(0, promptmax) = lang("生産防止コード発動", "Activate production-prevent code"), "null", "" + 20
+			promptmax++
+		}
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) != 0 ) {
+			promptl(0, promptmax) = lang("繁殖防止コード解除", "Cancel breeding-prevent code"), "null", "" + 21
+			promptmax++
+		}
+		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) != 0 ) {
+			promptl(0, promptmax) = lang("生産防止コード解除", "Cancel production-prevent code"), "null", "" + 22
+			promptmax++
+		}
+	}
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DISCARDED_RANCH ) {
+		promptl(0, promptmax) = lang("ペットを放す", "release ally"), "null", "" + 8
+		promptmax++
+		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
+		promptmax++
+	}
+	if ( 0 ) {
+		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
+		promptmax++
+	}
+	promptl(0, promptmax) = lang("家の模様替え", "Design"), "null", "" + 0
+	promptmax++
+	if ( gdata(GDATA_AREA) == AREA_HOME ) {
+		promptl(0, promptmax) = lang("家の情報", "Home rank"), "null", "" + 2
+		promptmax++
+		promptl(0, promptmax) = lang("仲間の滞在", "Allies in your home"), "null", "" + 4
+		promptmax++
+		if ( gdata(GDATA_LEVEL) == 1 ) {
+			promptl(0, promptmax) = lang("使用人を募集する", "Recruit a servant"), "null", "" + 6
+			promptmax++
+		}
+		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
+		promptmax++
+	}
+	if ( gdata(GDATA_AREA) == AREA_MAID_MANSION ) {
+		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
+		promptmax++
+	}
+	promptl(0, promptmax) = lang("生成される扉変更", "Change door type"), "null", "" + 7
+	promptmax++
+	promptl(0, promptmax) = lang("タイルグループ変更", "Change tile group"), "null", "" + 16
+	promptmax++
+	promptl(0, promptmax) = lang("外装変更", "Change Map Icon"), "null", "" + 9
+	promptmax++
+	if ( gdata(GDATA_AREA) != AREA_HOME ) {
+		if ( gdata(GDATA_AREA) != AREA_MAID_MANSION ) {
+			promptl(0, promptmax) = lang("施設名称変更", "Change Map Name"), "null", "" + 10
+			promptmax++
+		}
+	}
+	promptl(0, promptmax) = lang("お片付け機能", "Collecting function"), "null", "" + 23
+	promptmax++
+	homemakewall = 0
+	val = promptx, prompty, 280, 1
+	gosub *prompt_key
+	if ( stat == 0 ) {
+		gosub *screen_draw
+		goto *pc_turn
+	}
+	_switch_val = rtval
+	if ( 0 ) {
+		_switch_sw++
+	}
+	if ( _switch_val == 0 | _switch_sw ) {
+		_switch_sw = 0
+		homemapmode = 1
+		cxbk = cdata(CDATA_X, CHARA_PLAYER)
+		cybk = cdata(CDATA_Y, CHARA_PLAYER)
+		gosub *label_4610
+		n = 0
+		txtnew
+		txt lang("マウスの左クリックでタイルの敷設、右クリックでタイルの取得、移動キーでスクリーン移動、決定キーでタイル一覧、キャンセルキーで終了。", "Left click to place the tile, right click to pick the tile under your mouse cursor, movement keys to move current position, hit the enter key to show the list of tiles, hit the cancel key to exit.")
+		tlocinitx = cdata(CDATA_X, CHARA_PLAYER)
+		tlocinity = cdata(CDATA_Y, CHARA_PLAYER)
+		tile = 0
+		repeat
+			await
+			homemakewall = 1
+			gosub *label_5349
+			if ( stat == (-1) ) {
+				break
+			}
+			if ( (chipm(CHIPM_ATTRIB, tile) & CHIPM_ATTRIB_CANT_PASS) == 0 ) {
+				map(tlocx, tlocy, MAP_TILE_ID) = tile
+				map(tlocx, tlocy, MAP_TILE_ID_MEMORY) = tile
+			}
+			else {
+				efid = SKILL_SPELL_WALL_CREATION
+				gosub *effect
+			}
+			tlocinitx = tlocx
+			tlocinity = tlocy
+		loop
+		homemapmode = 0
+		cdata(CDATA_X, CHARA_PLAYER) = cxbk
+		cdata(CDATA_Y, CHARA_PLAYER) = cybk
+		dblistmax = 0
+		inv_getheader -1
+		repeat invrange, invhead
+			if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_SHOP ) {
+				break
+			}
+			if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+				continue
+			}
+			if ( chipm(CHIPM_ROLE, map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_TILE_ID)) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
+				inv(INV_ITEM_SHOP_SAMPLE, cnt) = 100
+			}
+			else {
+				inv(INV_ITEM_SHOP_SAMPLE, cnt) = 0
+			}
+		loop
+		goto *label_9247
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 10 | _switch_sw ) {
+		_switch_sw = 0
+		txt lang(mdatan(0) + "を何と呼ぶ？ ", "What do you want to call " + mdatan(0) + "? ")
+		val = (windoww - 290) / 2 + inf_screenx, winposy(90), 16, 1, 0
+		inputlog = ""
+		input_mode = 1
+		gosub *prompt_word
+		if ( inputlog == "" ) {
+			txt lang("名前をつけるのはやめた。", "You changed your mind.")
+			adata(ADATA_FESTIVAL, gdata(GDATA_AREA)) = 0
+		}
+		else {
+			mdatan(0) = "" + inputlog
+			adata(ADATA_FESTIVAL, gdata(GDATA_AREA)) = 9999
+			txt lang("" + mdatan(0) + "という名前で呼ぶことにした。", "You named " + him(tc) + " " + cdatan(CDATAN_NAME, tc) + ".")
+			gosub *screen_refreshFull
+		}
+		gosub *screen_refresh
+		goto *pc_turn
+		goto *label_4609
+		_switch_sw++
+	}
+
+
+	if ( _switch_val == 2 | _switch_sw ) {
+		_switch_sw = 0
+		gsel BUFFER_BUF
+		repeat 8
+			pos cnt \ 4 * 180, cnt / 4 * 300
+			picload exedir + "\\graphic\\g" + (cnt + 1) + ".bmp", 1
+		loop
+		gsel BUFFER_SCREEN
+		snd SOUNDLIST_POP2
+		redraw 0
+		pagesize = 0
+		keyrange = 0
+		key_list = key_cancel
+		s = lang("家の情報", "Home Value"), lang("決定ｷｰ,", "Enter key,") + strhint3
+		windowshadow = 1
+		display_window (windoww - 440) / 2 + inf_screenx, winposy(360), 440, 360
+		display_topic lang("価値", "Value"), wx + 28, wy + 36
+		display_topic lang("家宝ランク", "Heirloom Rank"), wx + 28, wy + 106
+		cmbg++
+		x = ww / 5 * 2
+		y = wh - 80
+		gmode 4, 180, 300, 50
+		pos wx + ww / 4, wy + wh / 2
+		grotate BUFFER_BUF, cmbg / 4 \ 4 * 180, cmbg / 4 / 4 \ 2 * 300, 0, x, y
+		gmode 2
+		gosub *house_update
+		s = lang("基本.", "Base"), lang("家具.", "Deco"), lang("家宝.", "Heir"), lang("総合.", "Total")
+		p = gdata(GDATA_HOME_BASE), gdata(GDATA_HOME_FURNITURE), gdata(GDATA_HOME_VALUE)
+		p(3) = (p + p(1) + p(2)) / 3
+		repeat 4
+			x = wx + 45 + cnt / 2 * 190
+			y = wy + 68 + cnt \ 2 * 18
+			font lang(cfg_font1, cfg_font2), 12 + sizefix - en * 2, 0
+			color 0, 0, 0
+			pos x, y
+			mes s(cnt)
+			font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
+			repeat limit(p(cnt) / 1000, 1, 10)
+				color 0, 0, 0
+				pos x + 35 + cnt * 13 + en * 8, y - 2
+				bmes lang("★", "*"), 255, 255, 50
+			loop
+		loop
+		font lang(cfg_font1, cfg_font2), 12 + sizefix - en * 2, 0
+		color 0, 0, 0
+		listmax = 10
+		gosub *sort_list
+		repeat 10
+			p = list(0, cnt)
+			if ( p == 0 ) {
+				continue
+			}
+			if ( inv(INV_ITEM_PIC, p) / 1000 < 1 ) {
+				p(1) = inv(INV_ITEM_PIC, p) \ 1000
+			}
+			if ( inv(INV_ITEM_PIC, p) / 1000 >= 1 ) {
+				p(1) = inv(INV_ITEM_PIC, p)
+			}
+			gsel BUFFER_ITEM
+			color 0
+			boxf 0, 960, chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1)) + 960
+			if ( p(1) == 528 ) {
+				gmode 2
+				pos 0, 960
+				gcopy BUFFER_ITEM, 0, 768, inf_tiles, inf_tiles
+				pos 0, 1008
+				gzoom 22, 20, 5, chipc(CHIPC_X, inv(INV_ITEM_COL, p)) + 8, chipc(CHIPC_Y, inv(INV_ITEM_COL, p)) + 4 + (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) > inf_tiles) * 8, chipc(CHIPC_WIDTH, inv(INV_ITEM_COL, p)) - 16, chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) - 8 - (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) > inf_tiles) * 10, 1
+				pos 6, 974
+				gcopy BUFFER_ITEM, 0, 1008, 22, 20
+				gsel selcur
+			}
+			else {
+				if ( p(1) == 1119 ) {
+					pos 0, 1055 - chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
+					gcopy BUFFER_CHR, chipc(CHIPC_X, inv(INV_ITEM_COL, p)), chipc(CHIPC_Y, inv(INV_ITEM_COL, p)), chipc(CHIPC_WIDTH, inv(INV_ITEM_COL, p)), chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
+					gmode 2
+					gsel selcur
+				}
+				else {
+					if ( p(1) == 1206 ) {
+						pos 0, 1055 - chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
+						gcopy BUFFER_CHR, chipc(CHIPC_X, inv(INV_ITEM_COL, p)), chipc(CHIPC_Y, inv(INV_ITEM_COL, p)), chipc(CHIPC_WIDTH, inv(INV_ITEM_COL, p)), chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
+						gfini chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
+						gfdec2 0, 0, 255
+						gsel selcur
+					}
+					else {
+						if ( p(1) == 531 ) {
+							pos 8, 1058 - chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
+							gcopy BUFFER_CHR, chipc(CHIPC_X, inv(INV_ITEM_COL, p)) + 8, chipc(CHIPC_Y, inv(INV_ITEM_COL, p)) + 2, chipc(CHIPC_WIDTH, inv(INV_ITEM_COL, p)) - 16, chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) - 8
+							gmode 4, , , 150
+							color 0, 0, 0
+							pos 0, 960 + (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) == inf_tiles) * 48
+							gcopy BUFFER_ITEM, 144, 768 + (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) > inf_tiles) * 48, inf_tiles, chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) + (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) > inf_tiles) * 48 * 0
+							gmode 2
+							gsel selcur
+						}
+						else {
+							pos 0, 960
+							gcopy BUFFER_ITEM, chipi(CHIPI_X, p(1)), chipi(CHIPI_Y, p(1)), chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
+							gfini chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
+							gfdec2 c_col(0, inv(INV_ITEM_COL, p)), c_col(1, inv(INV_ITEM_COL, p)), c_col(2, inv(INV_ITEM_COL, p))
+							gsel selcur
+						}
+					}
+				}
+			}
+			pos wx + 37, cnt * 16 + wy + 138
+			gmode 2, chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
+			grotate BUFFER_ITEM, 0, 960, 0, chipi(CHIPI_WIDTH, p(1)) * inf_tiles / chipi(CHIPI_HEIGHT, p(1)), inf_tiles
+			pos wx + 68, cnt * 16 + wy + 138
+			mes "" + cnvrank(10 - cnt) + lang("位.", "")
+			pos wx + 110, cnt * 16 + wy + 138
+			mes itemname(p)
+		loop
+*com_home_WHILE1
+		if ( 1 == 0 ) {
+			goto *com_home_WEND1
+		}
+		redraw 1
+		await cfg_wait1
+		key_check
+		cursor_check
+		if ( key == key_cancel ) {
+			goto *com_home_WEND1
+		}
+		goto *com_home_WHILE1
+*com_home_WEND1
+		goto *label_4609
+		_switch_sw++
+	}
+
+
+
+
+
+	if ( _switch_val == 3 | _switch_sw ) {
+		_switch_sw = 0
+*com_home_WHILE2
+		if ( 1 == 0 ) {
+			goto *com_home_WEND3
+		}
+		txtnew
+		txt lang("誰を移動させる？", "Move who?")
+		allyctrl = 0
+		gosub *label_5444
+		if ( stat == (-1) ) {
+			goto *com_home_WEND3
+		}
+		if ( cdata(CDATA_RELATION, stat) <= RELATION_ENEMY ) {
+			txtnew
+			txtef COLOR_SKY_BLUE
+			txt cdatan(CDATAN_NAME, stat) + lang("「触るな！」", " " + cnvtalk("Don't touch me!"))
+			goto *com_home_WEND3
+		}
+		tchome = stat
+		tc = stat
+		snd SOUNDLIST_OK1
+*com_home_WHILE3
+		if ( 1 == 0 ) {
+			goto *com_home_WEND2
+		}
+		txtnew
+		txt lang(cdatan(CDATAN_NAME, tc) + "をどこに移動させる？", "Where do you want to move " + cdatan(CDATAN_NAME, tc) + "?")
+		gosub *label_5349
+		if ( stat == (-1) ) {
+			goto *com_home_WEND2
+		}
+		if ( chipm(CHIPM_ATTRIB, map(tlocx, tlocy, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS | map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
+			txt lang("その場所には移動させることができない。", "The location is invalid.")
+			tc = tchome
+			tlochomex = tlocx
+			tlochomey = tlocy
+			goto *com_home_SWEND1
+		}
+		tc = tchome
+		map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_CHARA_INDEX_PLUS_ONE) = 0
+		map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) = tc + 1
+		cdata(CDATA_X, tc) = tlocx
+		cdata(CDATA_X_ORG, tc) = tlocx
+		cdata(CDATA_Y, tc) = tlocy
+		cdata(CDATA_Y_ORG, tc) = tlocy
+		rowactend tc
+		txtnew
+		txt lang(cdatan(CDATAN_NAME, tc) + "を移動させた。", cdatan(CDATAN_NAME, tc) + " " + is(tc) + " moved to the location.")
+		snd SOUNDLIST_FOOT
+		goto *com_home_WEND2
+*com_home_SWEND1
+		goto *com_home_WHILE3
+*com_home_WEND2
+		goto *com_home_WHILE2
+*com_home_WEND3
+		goto *label_9247
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 4 | _switch_sw ) {
+		_switch_sw = 0
+		allyctrl = 3
+		gosub *com_ally
+		if ( stat != (-1) ) {
+			c = stat
+			snd SOUNDLIST_OK1
+			txtnew
+			if ( cdata(CDATA_IN_TAGTEAM, c) != 0 ) {
+				snd SOUNDLIST_FAIL1
+				txtef COLOR_RED
+				txt lang("タッグを解散する必要がある。", "It is need to dissolve the tag.")
+				goto *label_4609
+			}
+			if ( getworker(gdata(GDATA_AREA), c) == c ) {
+				f = get_freeallyne()
+				if ( f == 0 ) {
+					snd SOUNDLIST_FAIL1
+					txt lang("仲間の最大数に達しているため、連れていけない。", "Your party is already full. You can't invite someone anymore.")
+					goto *label_4609
+				}
+				if ( gdata(GDATA_AREA) == AREA_HOME ) {
+					cdata(CDATA_AREA, c) = 0
+					txt lang(cdatan(CDATAN_NAME, c) + "の滞在を取り消した。", cdatan(CDATAN_NAME, c) + " " + is(c) + " no longer staying at your home.")
+					cdata(CDATA_HOME, c) = 0
+				}
+				else {
+					removeworker gdata(GDATA_AREA)
+					txt lang(cdatan(CDATAN_NAME, c) + "を役目から外した。", "You remove " + cdatan(CDATAN_NAME, c) + " from " + his(c) + " job.")
+				}
+			}
+			else {
+				if ( gdata(GDATA_AREA) == AREA_HOME ) {
+					cdata(CDATA_X_ORG, c) = cdata(CDATA_X, c)
+					cdata(CDATA_Y_ORG, c) = cdata(CDATA_Y, c)
+					cdata(CDATA_HOME, c) = gdata(GDATA_LEVEL)
+					txt lang(cdatan(CDATAN_NAME, c) + "を滞在させた。", cdatan(CDATAN_NAME, c) + " stay" + _s(c) + " at your home now.")
+				}
+				else {
+					removeworker gdata(GDATA_AREA)
+					txt lang(cdatan(CDATAN_NAME, c) + "を任命した。", cdatan(CDATAN_NAME, c) + " take" + _s(c) + " charge of the job now.")
+				}
+				cdata(CDATA_AREA, c) = gdata(GDATA_AREA)
+			}
+		}
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 8 | _switch_sw ) {
+		_switch_sw = 0
+		pet = 0
+		repeat 245
+			if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == TRUE ) {
+				pet++
+			}
+		loop
+		if ( pet >= 150 ) {
+			snd SOUNDLIST_FAIL1
+			txt lang("150体までしか放せない。", "You can not let go only 150 in this ranch.")
+			goto *label_4609
+		}
+		allyctrl = 3
+		gosub *com_ally
+		if ( stat != (-1) ) {
+			c = stat
+			snd SOUNDLIST_OK1
+			txtnew
+			cdata(CDATA_X_ORG, c) = cdata(CDATA_X, c)
+			cdata(CDATA_Y_ORG, c) = cdata(CDATA_Y, c)
+			if ( cbit(CHARA_BIT_BODYGUARD, c) != FALSE | cbit(CHARA_BIT_GUARD_TEMP, c) != FALSE ) {
+				snd SOUNDLIST_FAIL1
+				txt lang("護衛対象は放せない。", "You can not let go escort target in this ranch.")
+				goto *label_4609
+			}
+			cbitmod CHARA_BIT_LIVESTOCK, c, TRUE
+			txt lang(cdatan(CDATAN_NAME, c) + "を放してやった。", cdatan(CDATAN_NAME, c) + " stay" + _s(c) + " at this ranch.")
+			if ( cbit(CHARA_BIT_PCC, c) == TRUE ) {
+				txtef COLOR_YELLOW
+				txtmore
+				txt lang(cdatan(CDATAN_NAME, c) + "は元々の姿に着替えた。", cdatan(CDATAN_NAME, c) + " changed original cloth.")
+				cbitmod CHARA_BIT_PCC, c, FALSE
+			}
+			if ( cdata(CDATA_EXIST, c) != CHAR_STATE_DEAD ) {
+				if ( cdatan(CDATAN_RACE, c) == "servant" ) {
+					gdata(GDATA_ACTIVE_GOD_PETS)++
+				}
+			}
+			cdata(CDATA_AREA, c) = gdata(GDATA_AREA)
+			relocate_chara c, -1
+			cdata(CDATA_RELATION, c) = RELATION_DISLIKE
+			cdata(CDATA_RELATION_ORG, c) = RELATION_DISLIKE
+			cdata(CDATA_ROLE, c) = ROLE_SPECIAL
+			if ( mdata(MDATA_MAX_INV) <= 80 ) {
+				mdata(MDATA_MAX_INV) = 400
+			}
+		}
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 17 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		item_find ITEM_ID_LIVESTOCK_FEED, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
+		if ( stat == (-1) ) {
+			snd SOUNDLIST_FAIL1
+			txtef COLOR_RED
+			txt lang("家畜の餌を持っていない。", "You need a livestock feed.")
+			goto *label_4609
+		}
+		else {
+			ci = stat
+			txt lang(itemname(ci, 1) + "を使う？", "Really use " + itemname(ci, 1) + "?")
+			promptl(0, 0) = stryes, "y", "0"
+			promptl(0, 1) = strno, "n", "1"
+			promptmax = 2
+			val = promptx, prompty, 160, 1
+			gosub *prompt_key
+			if ( rtval != 0 ) {
+				gosub *screen_draw
+				goto *pc_turn
+			}
+			txt lang("辺りに餌を撒いた。", name(0) + " sprinkled " + itemname(ci, 1) + ".")
+			inv(INV_ITEM_NUM, ci) -= 1
+			gosub *label_4102
+			snd SOUNDLIST_BUSH1
+			ccbk = cc
+			repeat 245
+				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+					continue
+				}
+				if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == FALSE ) {
+					continue
+				}
+				if ( cdata(CDATA_CONDITION_DIM, cnt) > 60 ) {
+					cdata(CDATA_CONDITION_DIM, cnt) = 59
+				}
+				cdata(CDATA_CONDITION_SLEEP, cnt) = 0
+				cdata(CDATA_CONDITION_SUFFOCATION, cnt) = 0
+				cdata(CDATA_CONDITION_PARALYZE, cnt) = 0
+				cc = cnt
+				if ( cnt != 0 ) {
+					tc = CHARA_PLAYER
+					efid = SKILL_SPACT_SHADOW_STEP
+					gosub *effect
+				}
+				modweight cc, limit(10000 - cdata(CDATA_HUNGER, cnt), 1, 5000) / 1000, cdata(CDATA_HUNGER, cc) > 0
+				cdata(CDATA_HUNGER, cnt) = 10000
+				cdata(CDATA_EMO_ICON, cc) = 16 + 100 * 1
+				modimp2 cc, 15
+			loop
+		}
+		cc = ccbk
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 18 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		item_find ITEM_ID_DISINFECTANT, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
+		if ( stat == (-1) ) {
+			snd SOUNDLIST_FAIL1
+			txtef COLOR_RED
+			txt lang("浄化消毒薬を持っていない。", "You need a disinfectant.")
+			goto *label_4609
+		}
+		else {
+			ci = stat
+			txt lang(itemname(ci, 1) + "を使う？", "Really use " + itemname(ci, 1) + "?")
+			promptl(0, 0) = stryes, "y", "0"
+			promptl(0, 1) = strno, "n", "1"
+			promptmax = 2
+			val = promptx, prompty, 160, 1
+			gosub *prompt_key
+			if ( rtval != 0 ) {
+				gosub *screen_draw
+				goto *pc_turn
+			}
+			txt lang("場内を消毒した。", name(0) + " sprinkled " + itemname(ci, 1) + ".")
+			disip = 40
+			if ( inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_NORMAL ) {
+				disip = 20
+			}
+			if ( inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_CURSED ) {
+				disip = 10
+			}
+			if ( inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_DOOMED ) {
+				disip = 5
+			}
+			inv(INV_ITEM_NUM, ci) -= 1
+			gosub *label_4102
+			snd SOUNDLIST_MIZU
+			repeat 245
+				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+					continue
+				}
+				if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == FALSE ) {
+					continue
+				}
+				cdata(CDATA_EMO_ICON, cnt) = 6 + 100 * 1
+				healcon cnt, CONDITION_POISON, disip
+				healcon cnt, CONDITION_SICK, disip
+				if ( findbuff(cnt, BUFF_DISINFECTION) == (-1) ) {
+					addbuff cnt, BUFF_DISINFECTION, 50, 600
+				}
+				modimp cnt, 15
+			loop
+		}
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 19 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		snd SOUNDLIST_AMMO
+		txtef COLOR_RED
+		txt lang("この牧場では繁殖が行われない。", "This area will prevent breeding.")
+		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 10
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 20 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		snd SOUNDLIST_AMMO
+		txtef COLOR_RED
+		txt lang("この牧場では生産が行われない。", "This area will prevent production.")
+		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = 10
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 21 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		snd SOUNDLIST_ENC
+		txtef COLOR_GREEN
+		txt lang("繁殖が通常通り行われるようになった。", "This area does not prevent breeding.")
+		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 0
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 22 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		snd SOUNDLIST_ENC
+		txtef COLOR_GREEN
+		txt lang("生産が通常通り行われるようになった。", "This area does not prevent production.")
+		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = 0
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 23 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		txtef COLOR_RED
+		txt lang("落ちているアイテム全てを足元に集める機能だ。", "It is a function to collect all the dropped items at your feet.")
+		txtselectuse 2
+		repeat 2
+			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
+			promptmax++
+		loop
+		val = promptx, prompty, 200, 1
+		gosub *prompt_key
+		if ( stat == 0 ) {
+			gosub *screen_draw
+			goto *label_4609
+		}
+		if ( rtval == 1 ) {
+			snd SOUNDLIST_ENC
+			repeat 400, 5080
+				if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+					continue
+				}
+				if ( inv(INV_ITEM_PROPERTY, cnt) == PROP_NPC | inv(INV_ITEM_PROPERTY, cnt) == PROP_SPECIAL ) {
+					continue
+				}
+				bkx = inv(INV_ITEM_X, cnt)
+				bky = inv(INV_ITEM_Y, cnt)
+				inv(INV_ITEM_X, cnt) = cdata(CDATA_X, CHARA_PLAYER)
+				inv(INV_ITEM_Y, cnt) = cdata(CDATA_Y, CHARA_PLAYER)
+				cell_refresh bkx, bky
+			loop
+			cell_refresh cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
+		}
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 5 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		if ( cdata(CDATA_GOLD, CHARA_PLAYER) < calcshopreform() ) {
+			txt lang("お金が足りない…", "You don't have enough money...")
+		}
+		else {
+			snd SOUNDLIST_PAYGOLD1
+			cdata(CDATA_GOLD, CHARA_PLAYER) -= calcshopreform()
+			mdata(MDATA_MAX_INV) = limit(mdata(MDATA_MAX_INV) + 10, 1, 400)
+			txtef COLOR_GREEN
+			txt lang("店を拡張した！これからは" + mdata(MDATA_MAX_INV) + "個のアイテムを陳列できる。", "You extend your shop! You can display max of " + mdata(MDATA_MAX_INV) + " items now!")
+		}
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 11 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) > gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 ) {
+			txt lang("次に変更できるのは" + cnvdate(adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)), 1) + "だ。", "This Shop will be changeable again at " + cnvdate(adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)), 1) + ".")
+			snd SOUNDLIST_FAIL1
+			goto *label_4609
+		}
+		txtsetshop 8
+		repeat 8
+			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
+			promptmax++
+		loop
+		val = promptx, prompty, 350, 0
+		gosub *prompt_key
+		if ( rtval == 0 ) {
+			goto *label_4609
+		}
+		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + 24 * 15
+		adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) = rtval - 1
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_GOODS ) {
+			shops = lang("何でも屋", "Goods shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_FOOD ) {
+			shops = lang("食品店", "Food shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_MAGIC ) {
+			shops = lang("魔法店", "Magic shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_BLACKSMITH ) {
+			shops = lang("武具店", "Blacksmith")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_INN ) {
+			shops = lang("宿屋", "Inn shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_DECORATIVE_ARTS ) {
+			shops = lang("装飾家具店", "Decorative arts shop")
+		}
+		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_JUNK ) {
+			shops = lang("ジャンク屋", "Junk shop")
+		}
+		txtef COLOR_GREEN
+		txt lang("店種類変更：" + shops + "。", "Shop type changed: " + shops + ".")
+		snd SOUNDLIST_BUILD1
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 12 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		item_find ITEM_ID_BRONZE_COIN, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
+		if ( stat != (-1) ) {
+			ci = stat
+			if ( inv(INV_ITEM_NUM, ci) >= kunren ) {
+				sc = getworker(gdata(GDATA_AREA))
+				snd SOUNDLIST_PAYGOLD1
+				inv(INV_ITEM_NUM, ci) -= kunren
+				modgrowth sc, SKILL_NORMAL_NEGOTIATION, 150
+				modgrowth sc, SKILL_ATTR_CHA, 150
+				snd SOUNDLIST_DING3
+				txtef COLOR_SKY_BLUE
+				txt lang(cdatan(CDATAN_NAME, sc) + "は講師を呼び、潜在能力を伸ばした！", cdatan(CDATAN_NAME, sc) + " calls a trainer and develops " + his(sc) + " potential!")
+				goto *label_9247
+			}
+		}
+		txt lang("ブロンズ硬貨が足りない…", "You don't have enough bronze coin...")
+		snd SOUNDLIST_FAIL1
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 13 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		sc = getworker(gdata(GDATA_AREA))
+		if ( 0 ) {
+			cdata(CDATA_SALES_EXP, sc) = 500
+		}
+		if ( cdata(CDATA_SALES_FEATS, sc) == 0 ) {
+			if ( cdata(CDATA_SALES_EXP, sc) < 120 ) {
+				txt lang("営業実績が120は必要だ…。", cdatan(CDATAN_NAME, sc) + " don't have enough sales exp...")
+				snd SOUNDLIST_FAIL1
+				goto *label_4609
+			}
+		}
+		if ( cdata(CDATA_SALES_FEATS, sc) == 1 ) {
+			if ( cdata(CDATA_SALES_EXP, sc) < 360 ) {
+				txt lang("営業実績が360は必要だ…。", cdatan(CDATAN_NAME, sc) + " don't have enough sales exp...")
+				snd SOUNDLIST_FAIL1
+				goto *label_4609
+			}
+		}
+		if ( cdata(CDATA_SALES_FEATS, sc) >= 2 ) {
+			txt lang("これ以上は獲得できない。", cdatan(CDATAN_NAME, sc) + " can't get shopkeeper feat...")
+			snd SOUNDLIST_FAIL1
+			goto *label_4609
+		}
+		txtef COLOR_GREEN
+		txt lang(cdatan(CDATAN_NAME, sc) + "は営業で得た経験をもとにフィートを獲得できる！それは…", itemname(ci) + " sucked enough blood and ready to grow!")
+		txtsetshopfeat 6
+		repeat 6
+			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
+			promptmax++
+		loop
+		val = promptx, prompty, 280, 0
+		gosub *prompt_key
+		shopval = rtval
+		txtnew
+		if ( shopval == 0 ) {
+			txtef COLOR_GREEN
+			txt lang(cdatan(CDATAN_NAME, sc) + "はずっこけた。", cdatan(CDATAN_NAME, sc) + " seems dissatisfied.")
+			goto *label_4609
+		}
+		if ( shopval > 0 & shopval <= 5 ) {
+			if ( shopval == 1 ) {
+				bitp = CHARA_BIT_SHOP_ELEGANCE
+			}
+			if ( shopval == 2 ) {
+				bitp = CHARA_BIT_SHOP_AESTHETIC_SENSE
+			}
+			if ( shopval == 3 ) {
+				bitp = CHARA_BIT_SHOP_SALES_ROUTE
+			}
+			if ( shopval == 4 ) {
+				bitp = CHARA_BIT_SHOP_STRONG_ALLY
+			}
+			if ( shopval == 5 ) {
+				bitp = CHARA_BIT_SHOP_BUSINESS_SMILE
+			}
+			if ( cbit(bitp, sc) ) {
+				txtef COLOR_RED
+				txt lang(cdatan(CDATAN_NAME, sc) + "はそのフィートを既に持っている。", cdatan(CDATAN_NAME, sc) + " already has that feat.")
+				snd SOUNDLIST_FAIL1
+				goto *label_4609
+			}
+			cbitmod bitp, sc, TRUE
+			if ( bitp == CHARA_BIT_SHOP_ELEGANCE ) {
+				skillmod SKILL_ATTR_CHA, sc, 30000
+			}
+			cdata(CDATA_SALES_FEATS, sc)++
+			snd SOUNDLIST_PRAY1
+			txtef COLOR_GREEN
+			txt lang(cdatan(CDATAN_NAME, sc) + "はフィートを獲得した。", cdatan(CDATAN_NAME, sc) + " got the new feat!")
+		}
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 14 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		txtsetshopkazu 4
+		repeat 4
+			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
+			promptmax++
+		loop
+		val = promptx, prompty, 300, 0
+		gosub *prompt_key
+		if ( rtval == 0 ) {
+			goto *label_4609
+		}
+		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = rtval - 1
+		snd SOUNDLIST_BUILD1
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 15 | _switch_sw ) {
+		_switch_sw = 0
+		snd SOUNDLIST_FAIL1
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 7 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		if ( mdata(MDATA_TILESET) == MAP_TILESET_UNKNOWN ) {
+			tilep = 9
+		}
+		if ( mdata(MDATA_TILESET) == MAP_TILESET_EASTERN ) {
+			tilep = 3
+		}
+		if ( mdata(MDATA_TILESET) == MAP_TILESET_HOME ) {
+			tilep = 8
+		}
+		if ( mdata(MDATA_TILESET) == MAP_TILESET_SF ) {
+			tilep = 14
+		}
+		snd SOUNDLIST_BUILD1
+		mdata(MDATA_TILESET) = tilep
+		adata(ADATA_TILESET, gdata(GDATA_AREA)) = tilep
+		if ( tilep == 9 ) {
+			txtef COLOR_GREEN
+			txt lang("和風な扉が生成されるようになった。", "You changed door to Japan type.")
+		}
+		if ( tilep == 3 ) {
+			txtef COLOR_GREEN
+			txt lang("普通の扉が生成されるようになった。", "You changed door to normal type.")
+		}
+		if ( tilep == 8 ) {
+			txtef COLOR_GREEN
+			txt lang("機械仕掛けの扉が生成されるようになった。", "You changed door to SF type.")
+		}
+		if ( tilep == 14 ) {
+			txtef COLOR_GREEN
+			txt lang("片開きの扉が生成されるようになった。", "You changed door to EW type.")
+		}
+		txtef COLOR_GREEN
+		txt lang("変更を完全に適用するにはマップに入りなおす必要がある。", "You have to enter map again to apply changes.")
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 16 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) == 0 ) {
+			tilep = 1
+		}
+		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) == 1 ) {
+			tilep = 2
+		}
+		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) == 2 ) {
+			tilep = 3
+		}
+		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) == 3 ) {
+			tilep = 0
+		}
+		snd SOUNDLIST_BUILD1
+		mdata(MDATA_TILE_FILE) = tilep
+		adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) = tilep
+		if ( mdata(MDATA_TILE_FILE) == 0 ) {
+			txtef COLOR_GREEN
+			txt lang("タイルグループをmap0に変更した。", "You changed tile group map0.")
+		}
+		if ( mdata(MDATA_TILE_FILE) == 1 ) {
+			txtef COLOR_GREEN
+			txt lang("タイルグループをmap1に変更した。", "You changed tile group map1.")
+		}
+		if ( mdata(MDATA_TILE_FILE) == 2 ) {
+			txtef COLOR_GREEN
+			txt lang("タイルグループをmap2に変更した。", "You changed tile group map2.")
+		}
+		if ( mdata(MDATA_TILE_FILE) == 3 ) {
+			txtef COLOR_GREEN
+			txt lang("タイルグループをmap3に変更した。", "You changed tile group map3.")
+		}
+		txtef COLOR_GREEN
+		txt lang("変更を完全に適用するにはマップに入りなおす必要がある。", "You have to enter map again to apply changes.")
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 9 | _switch_sw ) {
+		_switch_sw = 0
+		if ( adata(ADATA_ICON, gdata(GDATA_AREA)) < xy2pic(0, 10) | adata(ADATA_ICON, gdata(GDATA_AREA)) > xy2pic(32, 10) ) {
+			adata(ADATA_ICON_ORG, gdata(GDATA_AREA)) = adata(ADATA_ICON, gdata(GDATA_AREA))
+		}
+		txtef COLOR_YELLOW
+		txt lang("対応する画像の番号は？（1〜33で入力。0を入力するとデフォルトに。）", "Input the number of map_ . (1-33) / If input 0, undo.")
+		val = (windoww - 100) / 2 + inf_screenx, winposy(90), 5, 0, 0
+		inputlog = ""
+		gosub *prompt_word
+		if ( inputlog == "0" ) {
+			if ( adata(ADATA_ICON_ORG, gdata(GDATA_AREA)) != 0 ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = adata(ADATA_ICON_ORG, gdata(GDATA_AREA))
+				txtef COLOR_GREEN
+				txt lang("元の外装に戻した。", "You put back the original graphic.")
+			}
+			sekaikousin = 100
+		}
+		else {
+			if ( inputlog == "1" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(0, 10)
+			}
+			if ( inputlog == "2" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(1, 10)
+			}
+			if ( inputlog == "3" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(2, 10)
+			}
+			if ( inputlog == "4" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(3, 10)
+			}
+			if ( inputlog == "5" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(4, 10)
+			}
+			if ( inputlog == "6" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(5, 10)
+			}
+			if ( inputlog == "7" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(6, 10)
+			}
+			if ( inputlog == "8" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(7, 10)
+			}
+			if ( inputlog == "9" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(8, 10)
+			}
+			if ( inputlog == "10" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(9, 10)
+			}
+			if ( inputlog == "11" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(10, 10)
+			}
+			if ( inputlog == "12" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(11, 10)
+			}
+			if ( inputlog == "13" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(12, 10)
+			}
+			if ( inputlog == "14" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(13, 10)
+			}
+			if ( inputlog == "15" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(14, 10)
+			}
+			if ( inputlog == "16" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(15, 10)
+			}
+			if ( inputlog == "17" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(16, 10)
+			}
+			if ( inputlog == "18" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(17, 10)
+			}
+			if ( inputlog == "19" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(18, 10)
+			}
+			if ( inputlog == "20" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(19, 10)
+			}
+			if ( inputlog == "21" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(20, 10)
+			}
+			if ( inputlog == "22" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(21, 10)
+			}
+			if ( inputlog == "23" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(22, 10)
+			}
+			if ( inputlog == "24" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(23, 10)
+			}
+			if ( inputlog == "25" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(24, 10)
+			}
+			if ( inputlog == "26" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(25, 10)
+			}
+			if ( inputlog == "27" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(26, 10)
+			}
+			if ( inputlog == "28" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(27, 10)
+			}
+			if ( inputlog == "29" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(28, 10)
+			}
+			if ( inputlog == "30" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(29, 10)
+			}
+			if ( inputlog == "31" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(30, 10)
+			}
+			if ( inputlog == "32" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(31, 10)
+			}
+			if ( inputlog == "33" ) {
+				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(32, 10)
+			}
+			if ( adata(ADATA_ICON, gdata(GDATA_AREA)) >= xy2pic(0, 10) & adata(ADATA_ICON, gdata(GDATA_AREA)) <= xy2pic(32, 10) ) {
+				snd SOUNDLIST_DING2
+				sekaikousin = 100
+			}
+		}
+		goto *pc_turn
+		goto *label_4609
+		_switch_sw++
+	}
+	if ( _switch_val == 6 | _switch_sw ) {
+		_switch_sw = 0
+		txtnew
+		p = 0
+		repeat 245 - 57, 57
+			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE | cdata(CDATA_EXIST, cnt) == CHAR_STATE_SPIRIT ) {
+				if ( cdata(CDATA_ROLE, cnt) != ROLE_NONE ) {
+					p++
+				}
+			}
+		loop
+		if ( p >= gdata(GDATA_HOME_LEVEL) + 2 ) {
+			txt lang("家はすでに人であふれかえっている。", "You already have too many guests in your home.")
+			goto *label_4609
+		}
+		repeat 10
+			if ( 0 == 0 ) {
+				randomize gdata(GDATA_DAY) + cnt
+			}
+			if ( rnd(2) ) {
+				continue
+			}
+			if ( cnt == 0 ) {
+				hire = 0
+			}
+			else {
+				hire = rnd(length(isethire))
+			}
+			dbid = isethire(hire)
+			if ( 0 == 0 ) {
+				randomize gdata(GDATA_DAY) + cnt
+			}
+			flt 20
+			characreate -1, dbid, -3, 0
+			if ( stat == 0 ) {
+				continue
+			}
+			cdata(CDATA_EXIST, rc) = CHAR_STATE_TEMP
+			cdata(CDATA_ROLE, rc) = isethirerole(hire)
+			if ( cdata(CDATA_ID, rc) == CREATURE_ID_SHOPKEEPER ) {
+				p = rnd(6)
+				if ( p == 0 ) {
+					cdata(CDATA_ROLE, rc) = ROLE_SHOP_ARMOR
+					cdatan(CDATAN_NAME, rc) = lang("武具店の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of armory")
+				}
+				if ( p == 1 ) {
+					cdata(CDATA_ROLE, rc) = ROLE_SHOP_GENERAL
+					cdatan(CDATAN_NAME, rc) = lang("雑貨屋の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of general store")
+				}
+				if ( p == 2 ) {
+					cdata(CDATA_ROLE, rc) = ROLE_SHOP_MAGIC
+					cdatan(CDATAN_NAME, rc) = lang("魔法店の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of magic store")
+				}
+				if ( p == 3 ) {
+					cdata(CDATA_ROLE, rc) = ROLE_SHOP_GOODS
+					cdatan(CDATAN_NAME, rc) = lang("何でも屋の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of goods store")
+				}
+				if ( p == 4 ) {
+					cdata(CDATA_ROLE, rc) = ROLE_SHOP_ARMOR
+					cdatan(CDATAN_NAME, rc) = lang("武具店の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of armory")
+				}
+				if ( p == 5 ) {
+					cdata(CDATA_ROLE, rc) = ROLE_SHOP_BLACKMARKET
+					cdatan(CDATAN_NAME, rc) = lang("ブラックマーケットの" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of blackmarket")
+				}
+				randomize
+				cdata(CDATA_ROLE_SHOP_LEVEL, rc) = rnd(15) + 1
+			}
+			cnt2 = cnt
+			repeat 245 - 57, 57
+				if ( cnt == rc ) {
+					continue
+				}
+				if ( cdatan(CDATAN_NAME, cnt) == cdatan(CDATAN_NAME, rc) ) {
+					if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_DEAD ) {
+						chara_vanquish rc
+					}
+				}
+			loop
+		loop
+		randomize
+		txtnew
+		txt lang("誰を雇用する？", "Who do you want to hire?")
+		allyctrl = 1
+		gosub *label_5444
+		if ( stat != (-1) ) {
+			tc = stat
+			txtnew
+			if ( cdata(CDATA_GOLD, CHARA_PLAYER) < calchirecost(tc) * 20 ) {
+				txt lang("お金が足りない…", "You dont't have enough money...")
+			}
+			else {
+				snd SOUNDLIST_PAYGOLD1
+				cdata(CDATA_GOLD, CHARA_PLAYER) -= calchirecost(tc) * 20
+				await 250
+				cdata(CDATA_EXIST, tc) = CHAR_STATE_ALIVE
+				txtef COLOR_GREEN
+				txt lang(cdatan(CDATAN_NAME, tc) + "を家に迎えた。", "You hire " + cdatan(CDATAN_NAME, tc) + ".")
+				snd SOUNDLIST_PRAY1
+			}
+		}
+		repeat 245
+			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_TEMP ) {
+				chara_vanquish cnt
+			}
+		loop
+		calccosthire
+		goto *label_4609
+	}
+
+*label_4609
+	tlocinitx = 0
+	tlocinity = 0
+	screenupdate = -1
+	gosub *screen_draw
+	goto *com_home
+
+*label_4610
+	p = 0
+	gsel BUFFER_MAP
+	repeat 7 * 33 * 12
+		f = 0
+		if ( cnt < 802 ) {
+			f = 1
+		}
+		if ( f == 0 ) {
+			continue
+		}
+		f = 1
+		pget cnt \ 33 * 48, cnt / 33 * 48
+		if ( mdata(MDATA_TILE_FILE) != 2 | cnt >= 297 ) {
+			if ( ginfo(16) == 0 ) {
+				if ( ginfo(17) == 0 ) {
+					if ( ginfo(18) == 0 ) {
+						f = 0
+					}
+				}
+			}
+		}
+		if ( mdata(MDATA_TILE_FILE) == 1 & cnt == 267 ) {
+			f = 0
+		}
+		if ( chipm(CHIPM_ROLE, cnt) == MAP_CHIP_ROLE_CROP ) {
+			f = 0
+		}
+		if ( chipm(CHIPM_ROLE, cnt) == MAP_CHIP_ROLE_DRYROCK ) {
+			f = 0
+		}
+		if ( chipm(CHIPM_ROLE, cnt) == MAP_CHIP_ROLE_COMPOST ) {
+			f = 0
+		}
+		if ( f ) {
+			list(0, p) = cnt
+			p++
+		}
+		if ( mdata(MDATA_TILE_FILE) == 3 ) {
+			if ( chipm(CHIPM_ANIM, cnt) != 0 ) {
+				continue cnt + chipm(CHIPM_ANIM, cnt)
+			}
+		}
+	loop
+	listmax = p
+	gsel BUFFER_SCREEN
+	return
+
+*label_4612
+	area = -1
+	midbk = mid
+	repeat 450 - 300, 300
+		if ( adata(ADATA_ID, cnt) == AREA_SHOP ) {
+			area = cnt
+			mid = "" + area + "_" + (100 + 1)
+			gosub *shop_turn_main
+		}
+	loop
+	mid = midbk
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
+		worker = getworker(gdata(GDATA_AREA))
+		if ( worker != (-1) ) {
+			gosub *label_4622
+		}
+	}
+	return
+
+*shop_turn_main
+	yaca = 0
+	worker = getworker(area)
+	if ( worker == (-1) ) {
+		txt lang("[店]店には店番がいない。", "[Shop]You shop doesn't have a shopkeeper.")
+		return
+	}
+	sold = 0
+	income = 0, 0
+	listmax = 0
+	shoplv = 100 - gdata(GDATA_RANK_SHOP) / 100
+	customer = 0
+	repeat 3
+		customer += rnd(shoplv / 3 + 5)
+	loop
+	customer = customer * (80 + sdata(SKILL_ATTR_CHA, worker) * 3 / 2) / 100
+	if ( customer < 1 ) {
+		customer = 1
+	}
+	if ( gdata(GDATA_AREA) != area ) {
+		file = "shoptmp.s2"
+		fmode = 4
+		gosub *game_ctrlFile
+		file = "inv_" + mid + ".s2"
+		fmode = 3
+		gosub *game_ctrlFile
+	}
+	mode = MODELIST_SHOP
+	dblistmax = 0
+	inv_getheader -1
+	repeat invrange, invhead
+		if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_SHOP_STRONGBOX ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_REGISTER ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_YACA_POINT_CARD ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_RED_BOOK ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_GOLD_PIECE ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_SHELTER ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_DEED ) {
+			continue
+		}
+		if ( inv(INV_ITEM_WEIGHT, cnt) < 0 ) {
+			continue
+		}
+		if ( inv(INV_ITEM_QUALITY, cnt) >= FIX_QUALITY_UNIQUE ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_ROD_WISHING ) {
+			continue
+		}
+		if ( inv(INV_ITEM_SHOP_SAMPLE, cnt) == 100 ) {
+			continue
+		}
+		if ( area == gdata(GDATA_AREA) ) {
+			if ( chipm(CHIPM_ROLE, map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_TILE_ID)) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
+				continue
+			}
+		}
+		a = refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE)
+		if ( adata(ADATA_SHOP_TYPE, area) != SHOP_TYPE_DECORATIVE_ARTS ) {
+			if ( a == 60000 & inv(INV_ITEM_ID, cnt) != ITEM_ID_WILD_FLOWER ) {
+				continue
+			}
+		}
+		dblist(0, dblistmax) = cnt, a
+		dblistmax++
+	loop
+	repeat customer
+		if ( dblistmax == 0 ) {
+			break
+		}
+		p = rnd(dblistmax)
+		ci = dblist(0, p)
+		a = dblist(1, p)
+		val = calcitemvalue(ci, 2)
+		val = val * int(10 + sqrt(sdata(SKILL_NORMAL_NEGOTIATION, worker) * 200)) / 100 + 10
+		if ( limitvalue > 0 ) {
+			if ( val > limitvalue ) {
+				val = limitvalue
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_FOOD ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
+				val = val * 6 / 5
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_MAGIC ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_SCROLL | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_SPELLBOOK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_ROD | inv(INV_ITEM_ID, ci) == ITEM_ID_OHUDA ) {
+				val = val * 6 / 5
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_BLACKSMITH ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_WEAPON | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_RANGE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_AMMO | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_HELM | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ARMOR | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_CLOAK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_GIRDLE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_BOOTS | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_GLOVES | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_SHIELD | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ACCESSORY_RING | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ACCESSORY_AMULET ) {
+				val = val * 6 / 5
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_INN ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_CONTAINER | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_POTION ) {
+				val = val * 6 / 5
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_DECORATIVE_ARTS ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ENVIRONMENT | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE_WELL | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE_ALTAR ) {
+				val = val * 6 / 5
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_JUNK ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_JUNK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_REMAINS | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_TOOL ) {
+				val = val * 6 / 5
+			}
+		}
+		if ( val <= 1 ) {
+			continue
+		}
+		if ( rnd(val) > shoplv * 100 + 500 ) {
+			continue
+		}
+		if ( inv(INV_ITEM_NUM, ci) <= 0 ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_YACA_POINT_CARD ) {
+			continue
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_GOODS ) {
+			if ( rnd(8) ) {
+				continue
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_FOOD ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_FOOD ) {
+				if ( rnd(5) ) {
+					continue
+				}
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_MAGIC ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_SCROLL & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_SPELLBOOK & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_ROD & inv(INV_ITEM_ID, ci) != ITEM_ID_OHUDA ) {
+				if ( rnd(5) ) {
+					continue
+				}
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_BLACKSMITH ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_WEAPON & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_RANGE & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_AMMO & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_HELM & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ARMOR & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_CLOAK & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_GIRDLE & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_BOOTS & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_GLOVES & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_SHIELD & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ACCESSORY_RING & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ACCESSORY_AMULET ) {
+				if ( rnd(5) ) {
+					continue
+				}
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_INN ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_CONTAINER & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_POTION ) {
+				if ( rnd(5) ) {
+					continue
+				}
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_DECORATIVE_ARTS ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ENVIRONMENT & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_FURNITURE & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_FURNITURE_WELL & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_FURNITURE_ALTAR ) {
+				if ( rnd(5) ) {
+					continue
+				}
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_JUNK ) {
+			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_JUNK & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_REMAINS & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_TOOL ) {
+				if ( rnd(5) ) {
+					continue
+				}
+			}
+		}
+		if ( adata(ADATA_SHOP_TYPE, area) != SHOP_TYPE_GOODS ) {
+			if ( rnd(2) ) {
+				continue
+			}
+		}
+		in = rnd(inv(INV_ITEM_NUM, ci)) + 1
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 1 ) {
+			if ( in + sold > 15 ) {
+				in = 15 - sold
+			}
+		}
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 2 ) {
+			if ( in + sold > 5 ) {
+				in = 5 - sold
+			}
+		}
+		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_PRODUCED_BOOK ) {
+			if ( inv(INV_ITEM_PARAM2, ci) == 0 ) {
+				bookfame = (inv(INV_ITEM_PARAM3, ci) + 5) * in
+				cdata(CDATA_FAME, CHARA_PLAYER) += bookfame
+				if ( 0 ) {
+					txtef COLOR_GREEN
+					txt lang("" + bookfame + "の名声値を手に入れた。", "You gain " + bookfame + " fame.")
+				}
+			}
+		}
+		inv(INV_ITEM_NUM, ci) -= in
+		sold += in
+		val = val * in
+		if ( rnd(4) == 0 ) {
+			list(0, listmax) = refitem(inv(INV_ITEM_ID, ci), DBSPEC_OBJ_LEVEL), inv(INV_ITEM_QUALITY, ci)
+			listn(0, listmax) = str(a), str(val)
+			listmax++
+		}
+		else {
+			income += val
+		}
+		if ( area == gdata(GDATA_AREA) ) {
+			repeat 245
+				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+					continue
+				}
+				if ( cdata(CDATA_ROW_ACT, cnt) == ACTION_NONE | cdata(CDATA_ACTION_PERIOD, cnt) == 0 ) {
+					continue
+				}
+				if ( cdata(CDATA_ITEM_USING, cnt) == ci ) {
+					rowactend cnt
+				}
+			loop
+		}
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 1 ) {
+			if ( sold >= 15 ) {
+				break
+			}
+		}
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 2 ) {
+			if ( sold >= 5 ) {
+				break
+			}
+		}
+	loop
+	mode = MODELIST_MAIN
+	if ( gdata(GDATA_AREA) != area ) {
+		file = "inv_" + mid + ".s2"
+		fmode = 4
+		gosub *game_ctrlFile
+	}
+	else {
+		file = "shoptmp.s2"
+		fmode = 4
+		gosub *game_ctrlFile
+	}
+	file = "shop" + 5 + ".s2"
+	existwrapper exedir + "tmp\\" + file
+	if ( strsize != (-1) ) {
+		fmode = 3
+		gosub *game_ctrlFile
+	}
+	else {
+		inv_getheader -1
+		repeat invrange, invhead
+			inv(INV_ITEM_NUM, cnt) = 0
+		loop
+	}
+	mode = MODELIST_SHOP
+	if ( income != 0 ) {
+		flt
+		itemcreate -1, ITEM_ID_GOLD_PIECE, -1, -1, income
+	}
+	repeat listmax
+		cnt2 = cnt
+		eye = 0
+		if ( cbit(CHARA_BIT_SHOP_AESTHETIC_SENSE, worker) ) {
+			eye = 1
+		}
+		repeat 4
+			flt list(0, cnt2), list(1, cnt2)
+			flttypemajor = int(listn(0, cnt2))
+			itemcreate -1, ITEM_ID_DUMMY, -1, -1, 0
+			if ( stat == 0 ) {
+				f = 0
+				break
+			}
+			if ( inv(INV_ITEM_VALUE, ci) > int(listn(1, cnt2)) * 2 * (3 + eye) / 3 + 300 * eye ) {
+				yaca += inv(INV_ITEM_VALUE, ci) / 1000
+				f = 1
+				break
+			}
+			else {
+				inv(INV_ITEM_NUM, ci) = 0
+				if ( cnt == 3 ) {
+					f = 0
+					break
+				}
+				else {
+					continue
+				}
+			}
+		loop
+		if ( f == 0 ) {
+			itemcreate -1, ITEM_ID_GOLD_PIECE, -1, -1, int(listn(1, cnt))
+			income += int(listn(1, cnt))
+		}
+		else {
+			income(1)++
+		}
+	loop
+	eye = 0
+	yaca += income / 1000 + customer / 10
+	if ( gdata(GDATA_MONTH) == 12 ) {
+		yaca *= 5
+	}
+	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
+		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
+	}
+	if ( sold == 0 ) {
+		yaca = 0
+		if ( cfg_hideshopresult == 0 ) {
+			txt lang("[店]" + customer + "人が来客したが、" + cdatan(CDATAN_NAME, worker) + "はアイテムを一つも売れなかった。", "[Shop]" + customer + " customers visited your shop but " + cdatan(CDATAN_NAME, worker) + " couldn't sell any item.")
+		}
+	}
+	else {
+		if ( cfg_hideshopresult <= 1 ) {
+			if ( gdata(GDATA_FLAG_YACA_POINTS) >= 100000 ) {
+				yaca = 0
+			}
+			s = "" + income + lang("gold", " gold pieces")
+			if ( income(1) != 0 ) {
+				s += lang("と" + income(1) + "個のアイテム", " and " + income(1) + " items")
+			}
+			snd SOUNDLIST_DING2
+			txtmore
+			txtef COLOR_YELLOW
+			txt lang("[店]" + customer + "人の来客があり、" + cdatan(CDATAN_NAME, worker) + "は" + sold + "個のアイテムを売却した。" + s + "が売り上げとして金庫に保管された。そして" + yaca + "ヤカポイントを獲得した。", "[Shop]" + customer + " customers visited your shop and " + cdatan(CDATAN_NAME, worker) + " sold " + sold + " items. " + cdatan(CDATAN_NAME, worker) + " put " + s + " in the shop strong box. You got " + yaca + " yaca points.")
+		}
+		skillexp SKILL_NORMAL_NEGOTIATION, worker, limit(int(sqrt(income)) * 10, 25, 2000) * (adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) + 2) / 2
+		cdata(CDATA_SALES_EXP, worker)++
+		if ( 0 ) {
+			cdata(CDATA_SALES_EXP, worker) += 360
+		}
+		gdata(GDATA_FLAG_YACA_POINTS) += yaca
+		if ( gdata(GDATA_FLAG_YACA_POINTS) >= 100000 ) {
+			gdata(GDATA_FLAG_YACA_POINTS) = 100000
+		}
+	}
+	if ( sold > (110 - gdata(GDATA_RANK_SHOP) / 100) / 10 ) {
+		modrank 5, 30, 2
+	}
+	if ( cbit(CHARA_BIT_SHOP_SALES_ROUTE, worker) ) {
+		dokuzi = sdata(SKILL_NORMAL_NEGOTIATION, worker) * 5 + sdata(SKILL_NORMAL_NEGOTIATION, worker) * rnd(6)
+		if ( gdata(GDATA_AREA) == AREA_VALM ) {
+			if ( gdata(GDATA_LEVEL) == 3 ) {
+				dokuzi = 1
+			}
+		}
+		flt
+		itemcreate -1, ITEM_ID_GOLD_PIECE, -1, -1, dokuzi
+		yaca = dokuzi / 100
+		if ( gdata(GDATA_MONTH) == 12 ) {
+			yaca *= 5
+		}
+		if ( gdata(GDATA_FLAG_YACA_POINTS) >= 100000 ) {
+			yaca = 0
+		}
+		txtef COLOR_YELLOW
+		txt lang("[店]" + cdatan(CDATAN_NAME, worker) + "は独自に" + dokuzi + "gold稼ぎ、金庫に保管した。そして" + yaca + "ヤカポイントを獲得した。", "[Shop]" + customer + " customers visited your shop and " + cdatan(CDATAN_NAME, worker) + " sold " + sold + " items. " + cdatan(CDATAN_NAME, worker) + " put " + s + " in the shop strong box. You got " + yaca + " yaca points.")
+		dokuzi = 0
+		gdata(GDATA_FLAG_YACA_POINTS) += yaca
+		if ( gdata(GDATA_FLAG_YACA_POINTS) >= 100000 ) {
+			gdata(GDATA_FLAG_YACA_POINTS) = 100000
+		}
+	}
+	mode = MODELIST_MAIN
+	file = "shop" + 5 + ".s2"
+	fmode = 4
+	gosub *game_ctrlFile
+	file = "shoptmp.s2"
+	fmode = 3
+	gosub *game_ctrlFile
+	return
+
+*label_4622
+	mdata(MDATA_MODERATE_CROWD) = (100 - gdata(GDATA_RANK_SHOP) / 100) / 4 + 1
+	inv_getheader -1
+	repeat mdata(MDATA_HEIGHT)
+		y = cnt
+		repeat mdata(MDATA_WIDTH)
+			map(cnt, y, MAP_ITEM_CHIPS) = 0
+			map(cnt, y, MAP_LIGHT_TYPE) = 0
+		loop
+	loop
+	repeat invrange, invhead
+		if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+			continue
+		}
+		x = inv(INV_ITEM_X, cnt)
+		y = inv(INV_ITEM_Y, cnt)
+		if ( x < 0 | x >= mdata(MDATA_WIDTH) | y < 0 | y >= mdata(MDATA_HEIGHT) ) {
+			continue
+		}
+		cell_refresh x, y
+	loop
+	return
+
+*museum_value
+	rc = MAX_CHARA_NC
+	fixlv = FIX_QUALITY_GOOD
+	dbmode = DBMODE_SET
+	gosub *db_creature
+	dblist(val, cdata(CDATA_ID, MAX_CHARA_NC))++
+	if ( fixlv == FIX_QUALITY_UNIQUE ) {
+		rtval = 70 + cdata(CDATA_LEVEL, MAX_CHARA_NC)
+	}
+	else {
+		rtval = cdata(CDATA_LEVEL, MAX_CHARA_NC) / 10 + 2
+		if ( chipc(CHIPC_HEIGHT, cdata(CDATA_PIC, MAX_CHARA_NC) \ 1000) > inf_tiles ) {
+			rtval = rtval / 2 * 3 + 40
+		}
+		p = refchara(cdata(CDATA_ID, MAX_CHARA_NC), DBSPEC_CHARA_RARE)
+		if ( p < 80 ) {
+			rtval = rtval + 80 - p
+		}
+	}
+	if ( dblist(val, cdata(CDATA_ID, MAX_CHARA_NC)) > 1 ) {
+		rtval /= 3
+		if ( rtval > 15 ) {
+			rtval = 15
+		}
+	}
+	return
+
+*label_4627
+	rtval = 0
+	rc = MAX_CHARA_NC
+	fixlv = FIX_QUALITY_GOOD
+	dbmode = DBMODE_SET
+	gosub *db_creature
+	dblist(val, cdata(CDATA_ID, MAX_CHARA_NC))++
+	if ( fixlv == FIX_QUALITY_UNIQUE | cdata(CDATA_ID, MAX_CHARA_NC) == CREATURE_ID_AILE_THE_ATTENDANT | cdata(CDATA_ID, MAX_CHARA_NC) == CREATURE_ID_LEND_THE_TAKER | cdata(CDATA_ID, MAX_CHARA_NC) == CREATURE_ID_MOYER_THE_CROOKED ) {
+		rtval = cdata(CDATA_LEVEL, MAX_CHARA_NC)
+	}
+	if ( cdata(CDATA_LEVEL, MAX_CHARA_NC) >= gdata(GDATA_DEEPEST_LEVEL) * 2 ) {
+		rtval = 0
+	}
+	if ( dblist(val, cdata(CDATA_ID, MAX_CHARA_NC)) > 1 ) {
+		rtval = 0
+	}
+	return
+
+*museum_update
+	rankorg = gdata(GDATA_RANK_MUSEUM)
+	inv_getheader -1
+	rankcur = 0
+	dim dblist, 2, 1499
+	repeat invrange, invhead
+		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) != ITEM_ID_FIGURINE & inv(INV_ITEM_ID, cnt) != ITEM_ID_CARD ) {
+			continue
+		}
+		if ( wpeek(map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_ITEM_CHIPS), 0) != inv(INV_ITEM_PIC, cnt) ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_CARD & inv(INV_ITEM_COL, cnt) == 0 ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+			val = 0
+		}
+		else {
+			val = 1
+		}
+		dbid = inv(INV_ITEM_SUB_NAME, cnt)
+		gosub *museum_value
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+			rankcur += rtval
+		}
+		else {
+			rankcur += rtval / 2
+		}
+	loop
+	rankcur = 10000 - int(sqrt(rankcur) * 70)
+	if ( rankcur < 100 ) {
+		rankcur = 100
+	}
+	gdata(GDATA_RANK_MUSEUM) = rankcur
+	if ( rankorg != rankcur ) {
+		if ( rankorg > rankcur ) {
+			txtef COLOR_GREEN
+		}
+		else {
+			txtef COLOR_PURPLE
+		}
+		txtnew
+		txt lang("ランク変動(" + rankn(10, 3) + " " + rankorg / 100 + "位 → " + rankcur / 100 + "位 )《" + ranktitle(3) + "》", "Museum Rank:" + cnvrank(rankorg / 100) + "->" + cnvrank(rankcur / 100) + " Your museum is now known as <" + ranktitle(3) + ">.")
+	}
+	mdata(MDATA_MODERATE_CROWD) = (100 - gdata(GDATA_RANK_MUSEUM) / 100) / 2 + 1
+	rankorg = gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+	inv_getheader -1
+	gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) = 0
+	dim dblist, 2, 1499
+	repeat invrange, invhead
+		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) != ITEM_ID_FIGURINE ) {
+			continue
+		}
+		if ( wpeek(map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_ITEM_CHIPS), 0) != inv(INV_ITEM_PIC, cnt) ) {
+			continue
+		}
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+			val = 0
+		}
+		else {
+			val = 1
+		}
+		dbid = inv(INV_ITEM_SUB_NAME, cnt)
+		gosub *label_4627
+		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+			gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) += rtval
+		}
+	loop
+	if ( rankorg != gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) ) {
+		nokori = 0
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 15400 ) {
+			nokori = 15400 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 13700 ) {
+			nokori = 13700 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 12100 ) {
+			nokori = 12100 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 10600 ) {
+			nokori = 10600 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 9200 ) {
+			nokori = 9200 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 7900 ) {
+			nokori = 7900 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 6700 ) {
+			nokori = 6700 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 5600 ) {
+			nokori = 5600 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 4600 ) {
+			nokori = 4600 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 3700 ) {
+			nokori = 3700 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 2900 ) {
+			nokori = 2900 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 2200 ) {
+			nokori = 2200 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 1600 ) {
+			nokori = 1600 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 1100 ) {
+			nokori = 1100 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 700 ) {
+			nokori = 700 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 400 ) {
+			nokori = 400 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 200 ) {
+			nokori = 200 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 100 ) {
+			nokori = 100 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 50 ) {
+			nokori = 50 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) < 1 ) {
+			nokori = 1 - gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
+		}
+		if ( gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) > rankorg ) {
+			txtef COLOR_GREEN
+		}
+		else {
+			txtef COLOR_PURPLE
+		}
+		txtnew
+		txt lang("ユニークレベル変動(" + rankorg + " → " + gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) + ") ", "Unique Level:" + rankorg + "->" + gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) + " ")
+		txtvalid = 0
+		txt lang("[次の目標まであと" + nokori + "] ", "/ Next stage:" + nokori + " ")
+	}
+	return
+
+*label_4631
+	a = refitem(inv(INV_ITEM_ID, val), DBSPEC_TYPE)
+	if ( a == 60000 ) {
+		gdata(GDATA_HOME_FURNITURE) += limit(inv(INV_ITEM_VALUE, val) / 50, 50, 500)
+	}
+	p = inv(INV_ITEM_VALUE, val)
+	repeat 1
+		if ( a == 60000 ) {
+			p /= 20
+			break
+		}
+		if ( a == 80000 ) {
+			p /= 10
+			break
+		}
+		if ( a == 77000 ) {
+			p /= 10
+			break
+		}
+		p /= 1000
+	loop
+	if ( p > list(1, n) ) {
+		list(0, n) = val, p
+		repeat 10
+			if ( list(1, cnt) < list(1, n) ) {
+				n = cnt
+			}
+		loop
+	}
+	return
+
+*house_update
+	if ( gdata(GDATA_LEVEL) != 1 ) {
+		return
+	}
+	rankorg = gdata(GDATA_RANK_HOME)
+	inv_getheader -1
+	rankcur = 0
+	gdata(GDATA_HOME_FURNITURE) = 0
+	gdata(GDATA_HOME_VALUE) = 0
+	n = 0
+	repeat 10
+		list(0, cnt) = 0, 0
+	loop
+	repeat invrange, invhead
+		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
+			continue
+		}
+		if ( wpeek(map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_ITEM_CHIPS), 0) != inv(INV_ITEM_PIC, cnt) ) {
+			continue
+		}
+		val = cnt
+		gosub *label_4631
+	loop
+	repeat 10
+		if ( list(0, cnt) != 0 ) {
+			gdata(GDATA_HOME_VALUE) += limit(list(1, cnt), 100, 2000)
+		}
+	loop
+	if ( gdata(GDATA_HOME_FURNITURE) > 10000 ) {
+		gdata(GDATA_HOME_FURNITURE) = 10000
+	}
+	if ( gdata(GDATA_HOME_VALUE) > 10000 ) {
+		gdata(GDATA_HOME_VALUE) = 10000
+	}
+	rankcur = 10000 - (gdata(GDATA_HOME_BASE) + gdata(GDATA_HOME_FURNITURE) + gdata(GDATA_HOME_VALUE)) / 3
+	if ( rankcur < 100 ) {
+		rankcur = 100
+	}
+	gdata(GDATA_RANK_HOME) = rankcur
+	if ( rankorg != rankcur ) {
+		if ( rankorg > rankcur ) {
+			txtef COLOR_GREEN
+		}
+		else {
+			txtef COLOR_PURPLE
+		}
+		txtnew
+		txt lang("家具(" + gdata(GDATA_HOME_FURNITURE) / 100 + "点) 家宝(" + gdata(GDATA_HOME_VALUE) / 100 + "点) ランク変動(" + rankn(10, 4) + " " + rankorg / 100 + "位 → " + rankcur / 100 + "位 )《" + ranktitle(4) + "》", "Furniture Value:" + gdata(GDATA_HOME_FURNITURE) / 100 + " Heirloom Value:" + gdata(GDATA_HOME_VALUE) / 100 + " Home Rank:" + cnvrank(rankorg / 100) + "->" + cnvrank(rankcur / 100) + " Your home is now known as <" + ranktitle(4) + ">.")
+	}
+	return
+	goto *ranch_update
+
+#defcfunc cbreeder int cbreeder_charid
+	locvar_cbreeder_s = refchara(cdata(CDATA_ID, cbreeder_charid), DBSPEC_CHARA_FILTER, 1)
+	locvar_cbreeder_p = refrace(cdatan(CDATAN_RACE, cbreeder_charid), DBSPEC_RACE_BREEDER)
+	locvar_cbreeder_p = locvar_cbreeder_p * 100 / (100 + cdata(CDATA_LEVEL, cbreeder_charid) * 5)
+	return locvar_cbreeder_p
+
+*ranch_update
+	worker = getworker(gdata(GDATA_AREA))
+	livestock = 0
+	ooitama = 0
+	ooititi = 0
+	sickp = 0
+	inv_getheader -1
+	repeat invrange, invhead
+		if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
+			if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_SHIT ) {
+				sicp += 100
+			}
+		}
+	loop
+	repeat 245
+		if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+			continue
+		}
+		if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == FALSE ) {
+			continue
+		}
+		if ( cdata(CDATA_CONDITION_SICK, cnt) > 0 ) {
+			sicp += 500
+		}
+		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) >= 7 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) <= 9 ) {
+			ooitama += cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt)
+		}
+		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) >= 4 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) <= 6 ) {
+			ooitama -= cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt)
+		}
+		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) >= 10 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) <= 12 ) {
+			ooititi += cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt)
+		}
+		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) >= 1 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) <= 3 ) {
+			ooititi -= cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt)
+		}
+		cdata(CDATA_HUNGER, cnt) -= renewmulti * 300
+		if ( cdata(CDATA_HUNGER, cnt) < 4000 ) {
+			cdata(CDATA_HUNGER, cnt) = 4000
+		}
+		livestock++
+	loop
+	repeat renewmulti
+		if ( worker == (-1) ) {
+			goto *skipBreeder
+		}
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 10 ) {
+			goto *skipBreeder
+		}
+		if ( cdatan(CDATAN_RACE, worker) == "quickling" ) {
+			if ( rnd(10) >= 8 ) {
+				goto *skipBreeder
+			}
+		}
+		if ( rnd(5000) > cbreeder(worker) * 100 / (100 + livestock * 20) - livestock * 2 ) {
+			if ( livestock != 0 | rnd(30) != 0 ) {
+				goto *skipBreeder
+			}
+		}
+		keisitu = 0
+		if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 2 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 3 ) {
+			if ( rnd(5) == 0 ) {
+				keisitu = 3
+			}
+		}
+		if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 1 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 3 ) {
+			if ( rnd(5) == 0 ) {
+				keisitu = 2
+			}
+		}
+		if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 0 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 3 ) {
+			if ( rnd(5) == 0 ) {
+				keisitu = 1
+			}
+		}
+		if ( keisitu == 0 ) {
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 5 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 6 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 6
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 4 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 6 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 5
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) == 0 | (cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 4 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 6) ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 4
+				}
+			}
+		}
+		if ( keisitu == 0 ) {
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 8 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 9 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 9
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 7 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 9 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 8
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) == 0 | (cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 7 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 9) ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 7
+				}
+			}
+		}
+		if ( keisitu == 0 ) {
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 11 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 12 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 12
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 10 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 12 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 11
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_QUALITY, worker) == 0 | (cdata(CDATA_LIVESTOCK_QUALITY, worker) >= 10 & cdata(CDATA_LIVESTOCK_QUALITY, worker) <= 12) ) {
+				if ( rnd(5) == 0 ) {
+					keisitu = 10
+				}
+			}
+		}
+		keisitu2 = 0
+		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 2 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 3 ) {
+			if ( rnd(5) == 0 ) {
+				keisitu2 = 3
+			}
+		}
+		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 1 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 3 ) {
+			if ( rnd(5) == 0 ) {
+				keisitu2 = 2
+			}
+		}
+		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 0 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 3 ) {
+			if ( rnd(5) == 0 ) {
+				keisitu2 = 1
+			}
+		}
+		if ( keisitu2 == 0 ) {
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 5 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 6 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 6
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 4 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 6 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 5
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) == 0 | (cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 4 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 6) ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 4
+				}
+			}
+		}
+		if ( keisitu2 == 0 ) {
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 8 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 9 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 9
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 7 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 9 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 8
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) == 0 | (cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 7 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 9) ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 7
+				}
+			}
+		}
+		if ( keisitu2 == 0 ) {
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 11 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 12 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 12
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 10 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 12 ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 11
+				}
+			}
+			if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) == 0 | (cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) >= 10 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, worker) <= 12) ) {
+				if ( rnd(5) == 0 ) {
+					keisitu2 = 10
+				}
+			}
+		}
+		flt calcobjlv(cdata(CDATA_LEVEL, worker)), FIX_QUALITY_BAD
+		if ( rnd(2) ) {
+			dbid = cdata(CDATA_ID, worker)
+		}
+		else {
+			dbid = 0
+		}
+		if ( rnd(10) != 0 ) {
+			fltnrace = cdatan(CDATAN_RACE, worker)
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_LITTLE_SISTER ) {
+			dbid = 176
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_STRAY_CAT ) {
+			dbid = 164
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_TOWN_CHILD ) {
+			dbid = 36
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_SHEEPDOG ) {
+			dbid = 10
+		}
+		if ( cdata(CDATA_QUALITY, worker) == FIX_QUALITY_UNIQUE ) {
+			dbid = 323
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_ITZPALT | cdata(CDATA_ID, worker) == CREATURE_ID_THE_ELEMENT ) {
+			dbid = 149
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_YACATECT | cdata(CDATA_ID, worker) == CREATURE_ID_HYPER_YACATECT ) {
+			dbid = 1
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_JURE | cdata(CDATA_ID, worker) == CREATURE_ID_BLESSED_JURE ) {
+			dbid = 347
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_LULWY | cdata(CDATA_ID, worker) == CREATURE_ID_DEVASTATE_LULWY ) {
+			dbid = 337
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_BUILDUP_OPATOS | cdata(CDATA_ID, worker) == CREATURE_ID_OPATOS ) {
+			dbid = 245
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_INSANE_KUMIROMI | cdata(CDATA_ID, worker) == CREATURE_ID_KUMIROMI ) {
+			dbid = 19
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_DEUS_EX_MANINA | cdata(CDATA_ID, worker) == CREATURE_ID_MANI ) {
+			dbid = 171
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_EHEKATL | cdata(CDATA_ID, worker) == CREATURE_ID_GOD_INSIDE_EHEKATL ) {
+			dbid = 164
+		}
+		if ( cdata(CDATA_ID, worker) == CREATURE_ID_MESHERA_PLANT | cdata(CDATA_ID, worker) == CREATURE_ID_MESHERA_ALPHA_THE_DEFORMED_ANGEL ) {
+			dbid = 452
+		}
+		characreate -1, dbid, 4 + rnd(11), 4 + rnd(8)
+		if ( stat != 0 ) {
+			cbitmod CHARA_BIT_LIVESTOCK, rc, TRUE
+			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR)
+			cdata(CDATA_SPRITE_SIZE_MILK, rc) = -5
+			cdata(CDATA_LIVESTOCK_QUALITY, rc) = keisitu
+			cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, rc) = keisitu2
+			livestock++
+		}
+
+*skipBreeder
+		egg = 0
+		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+			wtc = getworker(gdata(GDATA_AREA))
+		}
+		repeat 245
+			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+				continue
+			}
+			if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == FALSE & cnt != wtc ) {
+				continue
+			}
+			if ( cnt != wtc ) {
+				if ( findbuff(cnt, BUFF_DISINFECTION) == (-1) ) {
+					if ( rnd(10000) <= sickp ) {
+						if ( cdata(CDATA_CONDITION_SICK, cnt) < 100 ) {
+							cdata(CDATA_CONDITION_SICK, cnt) += 30
+						}
+					}
+					if ( cdata(CDATA_CONDITION_SICK, cnt) > 0 ) {
+						if ( cdata(CDATA_CONDITION_POISON, cnt) < 100 ) {
+							cdata(CDATA_CONDITION_POISON, cnt) += 30
+						}
+					}
+				}
+				if ( cdata(CDATA_CONDITION_SICK, cnt) > 0 ) {
+					cdata(CDATA_EMO_ICON, cnt) = 8 + 100 * 30
+				}
+			}
+			if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) == 10 ) {
+				break
+			}
+			if ( cnt == 0 ) {
+				continue
+			}
+			x = rnd(11) + 4
+			y = rnd(8) + 4
+			if ( map(x, y, MAP_ITEM_CHIPS) != 0 ) {
+				continue
+			}
+			flt calcobjlv(cdata(CDATA_LEVEL, cnt)), FIX_QUALITY_GOOD
+			p = rnd(5)
+			f = 0
+			if ( rnd(egg + 1) > 2 ) {
+				continue
+			}
+			if ( livestock > 10 ) {
+				if ( rnd(4) == 0 ) {
+					continue
+				}
+			}
+			if ( livestock > 20 ) {
+				if ( rnd(4) == 0 ) {
+					continue
+				}
+			}
+			if ( livestock > 30 ) {
+				if ( rnd(4) == 0 ) {
+					continue
+				}
+			}
+			if ( livestock > 40 ) {
+				if ( rnd(4) == 0 ) {
+					continue
+				}
+			}
+			if ( cdata(CDATA_CONDITION_SICK, cnt) > 0 ) {
+				p = 2
+			}
+			if ( p == 0 ) {
+				if ( ooitama > 1 ) {
+					if ( rnd(ooitama) > rnd(80) ) {
+						flt
+						itemcreate -1, ITEM_ID_EGG, x, y, 0
+						if ( stat ) {
+							inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
+							inv(INV_ITEM_WEIGHT, ci) = limit(cdata(CDATA_WEIGHT, cnt) / 10 * 40, 20, 10000)
+							inv(INV_ITEM_VALUE, ci) = limit((inv(INV_ITEM_WEIGHT, cnt) + 2400) / 4, 600, 3000)
+						}
+					}
+				}
+				if ( ooitama < 1 ) {
+					if ( ooitama + rnd(100) < 0 ) {
+						egg++
+					}
+				}
+				if ( rnd(60) == 0 ) {
+					f = 1
+				}
+				if ( cdata(CDATA_ID, cnt) == CREATURE_ID_CHICKEN ) {
+					if ( rnd(20) == 0 ) {
+						f = 1
+					}
+				}
+				if ( f ) {
+					egg++
+					flt
+					itemcreate -1, ITEM_ID_EGG, x, y, 0
+					if ( stat ) {
+						inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
+						inv(INV_ITEM_WEIGHT, ci) = limit(cdata(CDATA_WEIGHT, cnt) / 10 * 40, 20, 10000)
+						inv(INV_ITEM_VALUE, ci) = limit((inv(INV_ITEM_WEIGHT, cnt) + 2400) / 4, 600, 3000)
+					}
+				}
+				continue
+			}
+			if ( p == 1 ) {
+				if ( ooititi > 1 ) {
+					if ( rnd(ooititi) > rnd(50) ) {
+						flt
+						itemcreate -1, ITEM_ID_BOTTLE_MILK, x, y, 0
+						if ( stat ) {
+							inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
+						}
+					}
+				}
+				if ( ooitama < 1 ) {
+					if ( ooititi + rnd(100) < 0 ) {
+						egg++
+					}
+				}
+				if ( rnd(60) == 0 ) {
+					f = 1
+				}
+				if ( cdatan(CDATAN_RACE, cnt) == "sheep" ) {
+					if ( rnd(20) == 0 ) {
+						f = 1
+					}
+				}
+				if ( cdata(CDATA_ID, cnt) == CREATURE_ID_CATTLE ) {
+					if ( rnd(20) == 0 ) {
+						f = 1
+					}
+				}
+				if ( f ) {
+					egg++
+					flt
+					itemcreate -1, ITEM_ID_BOTTLE_MILK, x, y, 0
+					if ( stat ) {
+						inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
+					}
+				}
+				continue
+			}
+			if ( p == 2 ) {
+				if ( cfg_dust_select == 0 ) {
+					if ( rnd(80) == 0 ) {
+						f = 1
+					}
+				}
+				if ( f ) {
+					flt
+					itemcreate -1, ITEM_ID_SHIT, x, y, 0
+					if ( stat ) {
+						inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
+						inv(INV_ITEM_WEIGHT, ci) = limit(cdata(CDATA_WEIGHT, cnt) / 10 * 150, 30, 15000)
+						inv(INV_ITEM_VALUE, ci) = limit((cdata(CDATA_WEIGHT, cnt) + 3600) / 4, 900, 4500)
+					}
+				}
+				continue
+			}
+			if ( p == 3 ) {
+				if ( rnd(80) == 0 ) {
+					f = 1
+				}
+				if ( f ) {
+					dbid = 222
+					if ( rnd(2) ) {
+						dbid = 45
+					}
+					flt
+					itemcreate -1, dbid, x, y, 0
+				}
+				continue
+			}
+		loop
+	loop
+	return
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
 
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/map_user.hsp ../2.14-borscht/map_user.hsp
--- ../2.13-borscht/map_user.hsp	2022-06-26 12:14:16.959483800 -0700
+++ ../2.14-borscht/map_user.hsp	2022-09-18 12:37:01.785547400 -0700
@@ -1,84 +1,84 @@
 *home_setup
-	if ( gdata(GDATA_HOME_LEVEL) == 0 ) {
-		mdata(MDATA_MAX_INV) = 100
-		gdata(GDATA_HOME_BASE) = 1000
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 1 ) {
-		mdata(MDATA_MAX_INV) = 150
-		gdata(GDATA_HOME_BASE) = 3000
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 2 ) {
-		mdata(MDATA_MAX_INV) = 200
-		gdata(GDATA_HOME_BASE) = 5000
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 3 ) {
-		mdata(MDATA_MAX_INV) = 300
-		gdata(GDATA_HOME_BASE) = 7000
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 4 ) {
-		mdata(MDATA_MAX_INV) = 350
-		gdata(GDATA_HOME_BASE) = 8000
-		mdata(MDATA_TILESET) = MAP_TILESET_SF
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 5 ) {
-		mdata(MDATA_MAX_INV) = 400
-		gdata(GDATA_HOME_BASE) = 10000
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 6 ) {
-		mdata(MDATA_MAX_INV) = 400
-		gdata(GDATA_HOME_BASE) = 15000
+	if ( gHomeLevel == 0 ) {
+		mMaxInv = 100
+		gHomeBase = 1000
+	}
+	if ( gHomeLevel == 1 ) {
+		mMaxInv = 150
+		gHomeBase = 3000
+	}
+	if ( gHomeLevel == 2 ) {
+		mMaxInv = 200
+		gHomeBase = 5000
+	}
+	if ( gHomeLevel == 3 ) {
+		mMaxInv = 300
+		gHomeBase = 7000
+	}
+	if ( gHomeLevel == 4 ) {
+		mMaxInv = 350
+		gHomeBase = 8000
+		mTileSet = MAP_TILESET_SF
+	}
+	if ( gHomeLevel == 5 ) {
+		mMaxInv = 400
+		gHomeBase = 10000
+	}
+	if ( gHomeLevel == 6 ) {
+		mMaxInv = 400
+		gHomeBase = 15000
 	}
 	return
 
 *building_new
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
-		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
-			if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_CROP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_STORAGE_HOUSE | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DISCARDED_RANCH | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DUNGEON ) {
+	if ( iID(ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
+		if ( mType != MAP_TYPE_WORLD ) {
+			if ( areaId(gArea) == AREA_CROP | areaId(gArea) == AREA_MUSEUM | areaId(gArea) == AREA_SHOP | areaId(gArea) == AREA_STORAGE_HOUSE | areaId(gArea) == AREA_RANCH | areaId(gArea) == AREA_DISCARDED_RANCH | areaId(gArea) == AREA_DUNGEON ) {
 				item_separate ci
-				inv(INV_ITEM_PARAM2, ci) = gdata(GDATA_AREA)
-				txt lang("物件No" + inv(INV_ITEM_PARAM2, ci) + "を登録" + adata(ADATA_ARENA_WIN, gdata(GDATA_AREA)) + "した。", "You can only use it in the world map.")
-				adata(ADATA_ARENA_WIN, gdata(GDATA_AREA)) = -1
+				iParam2(ci) = gArea
+				txt lang("物件No" + iParam2(ci) + "を登録" + areaArenaWin(gArea) + "した。", "You can only use it in the world map.")
+				areaArenaWin(gArea) = -1
 				snd SOUNDLIST_ENC
 				gosub *screen_draw
 				goto *pc_turn
 			}
 		}
-		if ( inv(INV_ITEM_PARAM2, ci) == 0 ) {
+		if ( iParam2(ci) == 0 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("移設したい物件内で読むとNoを登録できる。", "You can only use it in the world map.")
 			gosub *screen_draw
 			goto *pc_turn
 		}
 	}
-	if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
+	if ( mType != MAP_TYPE_WORLD ) {
 		txt lang("それはワールドマップでしか使えない。", "You can only use it in the world map.")
 		gosub *screen_draw
 		goto *pc_turn
 	}
-	cell_featread cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
-	if ( feat(FEAT_CELL_PIC) != 0 ) {
+	cell_featread cX(CHARA_PLAYER), cY(CHARA_PLAYER)
+	if ( featPic != 0 ) {
 		txt lang("その場所には建てられない。", "You can't build it here.")
 		gosub *screen_draw
 		goto *pc_turn
 	}
 	area = -1
 	repeat 450 - 300, 300
-		if ( adata(ADATA_ID, cnt) == AREA_NONE ) {
+		if ( areaId(cnt) == AREA_NONE ) {
 			area = cnt
 			break
 		}
 	loop
 	if ( area == (-1) ) {
 		txt lang("もうこれ以上建物は建てられない。", "You can't build a building anymore.")
 		gosub *screen_draw
 		goto *pc_turn
 	}
-	if ( inv(INV_ITEM_ID, ci) != ITEM_ID_DEED_PROPERTY_TRANSFER ) {
+	if ( iID(ci) != ITEM_ID_DEED_PROPERTY_TRANSFER ) {
 		txt lang("本当にこの場所に建設する？ ", "Really build it here? ")
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
+	if ( iID(ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
 		txt lang("本当にこの場所に移設する？ ", "Really move it here? ")
 	}
 	promptl(0, 0) = stryes, "y", "0"
 	promptl(0, 1) = strno, "n", "1"
 	promptmax = 2
@@ -92,261 +92,261 @@
 		spact(SKILL_SPACT_MARKING - STARTING_SKILL_SPACT) = 1
 		txtmore
 		txtef COLOR_YELLOW
 		txt lang("あなたは「" + skillname(SKILL_SPACT_MARKING) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_MARKING) + ".")
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED ) {
-		gdata(GDATA_HOME_LEVEL) = inv(INV_ITEM_PARAM1, ci)
-		inv(INV_ITEM_NUM, ci)--
-		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+	if ( iID(ci) == ITEM_ID_DEED ) {
+		gHomeLevel = iParam1(ci)
+		iNum(ci)--
+		cell_refresh iX(ci), iY(ci)
 		gosub *setHome
 		midbk = mid
 		mid = "" + 7 + "_" + (100 + 1)
 		fmode = 12
 		gosub *game_ctrlFile
 		mid = midbk
 		gosub *world_refresh
 		levelexitby = MAP_EXIT_TELEPORT
-		gdata(GDATA_TELEPORT_AREA) = AREA_HOME
-		gdata(GDATA_TELEPORT_LEVEL) = 1
-		gdata(GDATA_WORLD_X) = adata(ADATA_X, 7)
-		gdata(GDATA_WORLD_Y) = adata(ADATA_Y, 7)
+		gTeleportArea = AREA_HOME
+		gTeleportLevel = 1
+		gWorldX = areaX(7)
+		gWorldY = areaY(7)
 		snd SOUNDLIST_BUILD1
 		txtef COLOR_GREEN
 		txt lang("新しい家を建てた！ ", "You've built a new house!")
 		msg_halt
 		snd SOUNDLIST_EXITMAP1
 		exgauge = 10
 		goto *map_exit
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_HOME_RELOCATION ) {
-		inv(INV_ITEM_NUM, ci)--
-		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+	if ( iID(ci) == ITEM_ID_DEED_HOME_RELOCATION ) {
+		iNum(ci)--
+		cell_refresh iX(ci), iY(ci)
 		doukutu = 100
 		gosub *setHome
 		gosub *world_refresh
 		levelexitby = MAP_EXIT_TELEPORT
-		gdata(GDATA_TELEPORT_AREA) = AREA_HOME
-		gdata(GDATA_TELEPORT_LEVEL) = 1
-		gdata(GDATA_WORLD_X) = adata(ADATA_X, 7)
-		gdata(GDATA_WORLD_Y) = adata(ADATA_Y, 7)
+		gTeleportArea = AREA_HOME
+		gTeleportLevel = 1
+		gWorldX = areaX(7)
+		gWorldY = areaY(7)
 		snd SOUNDLIST_BUILD1
 		txtef COLOR_GREEN
 		txt lang("引っ越しが完了した！ ", "You've move house!")
 		msg_halt
 		snd SOUNDLIST_EXITMAP1
-		if ( gdata(GDATA_HOME_LEVEL) == 0 ) {
+		if ( gHomeLevel == 0 ) {
 			gdata(GDATA_FLAG_HOME_MOVED) = 1
 		}
 		goto *map_exit
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
-		bukken = inv(INV_ITEM_PARAM2, ci)
-		inv(INV_ITEM_NUM, ci)--
-		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-		adata(ADATA_X, bukken) = cdata(CDATA_X, CHARA_PLAYER)
-		adata(ADATA_Y, bukken) = cdata(CDATA_Y, CHARA_PLAYER)
-		adata(ADATA_PARENT, bukken) = gdata(GDATA_WORLD)
+	if ( iID(ci) == ITEM_ID_DEED_PROPERTY_TRANSFER ) {
+		bukken = iParam2(ci)
+		iNum(ci)--
+		cell_refresh iX(ci), iY(ci)
+		areaX(bukken) = cX(CHARA_PLAYER)
+		areaY(bukken) = cY(CHARA_PLAYER)
+		areaParent(bukken) = gWorld
 		gosub *world_refresh
 		levelexitby = MAP_EXIT_TELEPORT
-		gdata(GDATA_TELEPORT_AREA) = bukken
-		gdata(GDATA_TELEPORT_LEVEL) = 1
-		gdata(GDATA_WORLD_X) = adata(ADATA_X, bukken)
-		gdata(GDATA_WORLD_Y) = adata(ADATA_Y, bukken)
+		gTeleportArea = bukken
+		gTeleportLevel = 1
+		gWorldX = areaX(bukken)
+		gWorldY = areaY(bukken)
 		snd SOUNDLIST_BUILD1
 		txtef COLOR_GREEN
 		txt lang("移設が完了した！ ", "You've move property!")
 		msg_halt
-		adata(ADATA_ARENA_WIN, bukken) = 0
+		areaArenaWin(bukken) = 0
 		snd SOUNDLIST_EXITMAP1
 		goto *map_exit
 	}
 	fmode = 13
 	gosub *game_ctrlFile
 	p = area
-	adata(ADATA_X, p) = cdata(CDATA_X, CHARA_PLAYER)
-	adata(ADATA_Y, p) = cdata(CDATA_Y, CHARA_PLAYER)
-	adata(ADATA_TYPE, p) = MAP_TYPE_HOME
-	adata(ADATA_CAN_SAVE, p) = 1
-	adata(ADATA_RESTORE_POS, p) = 0
-	adata(ADATA_TILESET, p) = 3
-	adata(ADATA_TIME_SCALE, p) = 10000
-	adata(ADATA_MIN_LEVEL, p) = 1
-	adata(ADATA_MAX_LEVEL, p) = 1
-	adata(ADATA_TILE_FILE, p) = 1
-	adata(ADATA_START_ON, p) = 8
-	adata(ADATA_PARENT, p) = gdata(GDATA_WORLD)
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_MUSEUM ) {
-		adata(ADATA_ID, p) = AREA_MUSEUM
-		adata(ADATA_ICON, p) = xy2pic(19, 4)
-		adata(ADATA_FIELD, p) = 1
+	areaX(p) = cX(CHARA_PLAYER)
+	areaY(p) = cY(CHARA_PLAYER)
+	areaType(p) = MAP_TYPE_HOME
+	areaRestorePos(p) = 1
+	areaIcon(p) = 0
+	areaTileSet(p) = 3
+	areaMaxLevel(p) = 10000
+	areaMinLevel(p) = 1
+	areaCanSave(p) = 1
+	areaTileFile(p) = 1
+	areaStartOn(p) = 8
+	areaParent(p) = gWorld
+	if ( iID(ci) == ITEM_ID_DEED_MUSEUM ) {
+		areaId(p) = AREA_MUSEUM
+		areaIcon(p) = xy2pic(19, 4)
+		areaField(p) = 1
 		s = lang("博物館", "museum")
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_SHOP ) {
-		adata(ADATA_ID, p) = AREA_SHOP
-		adata(ADATA_ICON, p) = xy2pic(18, 4)
-		adata(ADATA_FIELD, p) = 1
+	if ( iID(ci) == ITEM_ID_DEED_SHOP ) {
+		areaId(p) = AREA_SHOP
+		areaIcon(p) = xy2pic(18, 4)
+		areaField(p) = 1
 		s = lang("店", "shop")
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_FARM ) {
-		adata(ADATA_ID, p) = AREA_CROP
-		adata(ADATA_ICON, p) = xy2pic(20, 4)
-		adata(ADATA_FIELD, p) = 2
+	if ( iID(ci) == ITEM_ID_DEED_FARM ) {
+		areaId(p) = AREA_CROP
+		areaIcon(p) = xy2pic(20, 4)
+		areaField(p) = 2
 		s = lang("畑", "crop")
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_STORAGE_HOUSE ) {
-		adata(ADATA_ID, p) = AREA_STORAGE_HOUSE
-		adata(ADATA_ICON, p) = xy2pic(21, 4)
-		adata(ADATA_FIELD, p) = 1
+	if ( iID(ci) == ITEM_ID_DEED_STORAGE_HOUSE ) {
+		areaId(p) = AREA_STORAGE_HOUSE
+		areaIcon(p) = xy2pic(21, 4)
+		areaField(p) = 1
 		s = lang("倉庫", "storage")
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_RANCH ) {
-		adata(ADATA_ID, p) = AREA_RANCH
-		adata(ADATA_ICON, p) = xy2pic(22, 4)
-		adata(ADATA_FIELD, p) = 2
-		adata(ADATA_RESTORE_POS, p) = 1
+	if ( iID(ci) == ITEM_ID_DEED_RANCH ) {
+		areaId(p) = AREA_RANCH
+		areaIcon(p) = xy2pic(22, 4)
+		areaField(p) = 2
+		areaIcon(p) = 1
 		s = lang("牧場", "ranch")
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_DUNGEON ) {
-		adata(ADATA_ID, p) = AREA_DUNGEON
-		adata(ADATA_ICON, p) = xy2pic(6, 4)
-		adata(ADATA_FIELD, p) = 1
-		adata(ADATA_RESTORE_POS, p) = 1
+	if ( iID(ci) == ITEM_ID_DEED_DUNGEON ) {
+		areaId(p) = AREA_DUNGEON
+		areaIcon(p) = xy2pic(6, 4)
+		areaField(p) = 1
+		areaIcon(p) = 1
 		s = lang("ダンジョン", "dungeon")
 	}
-	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DEED_DISCARDED_RANCH ) {
-		adata(ADATA_ID, p) = AREA_DISCARDED_RANCH
-		adata(ADATA_ICON, p) = xy2pic(10, 4)
-		adata(ADATA_FIELD, p) = 2
-		adata(ADATA_RESTORE_POS, p) = 1
+	if ( iID(ci) == ITEM_ID_DEED_DISCARDED_RANCH ) {
+		areaId(p) = AREA_DISCARDED_RANCH
+		areaIcon(p) = xy2pic(10, 4)
+		areaField(p) = 2
+		areaIcon(p) = 1
 		s = lang("廃モンスター牧場", "discarded ranch")
 	}
 	snd SOUNDLIST_BUILD1
 	txtef COLOR_YELLOW
 	txt lang("あなたは" + s + "を建設した！ ", "You've built a " + s + "!")
 	gosub *world_refresh
-	inv(INV_ITEM_NUM, ci)--
-	cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+	iNum(ci)--
+	cell_refresh iX(ci), iY(ci)
 	goto *turn_end
 	area = -1
 	repeat 450 - 300, 300
-		if ( adata(ADATA_ID, cnt) == AREA_NONE ) {
+		if ( areaId(cnt) == AREA_NONE ) {
 			area = cnt
 			break
 		}
 	loop
 	p = area
-	adata(ADATA_TYPE, p) = MAP_TYPE_HOME
-	adata(ADATA_CAN_SAVE, p) = 1
-	adata(ADATA_RESTORE_POS, p) = 0
-	adata(ADATA_TILESET, p) = 3
-	adata(ADATA_TIME_SCALE, p) = 10000
-	adata(ADATA_MIN_LEVEL, p) = 1
-	adata(ADATA_MAX_LEVEL, p) = 1
-	adata(ADATA_TILE_FILE, p) = 1
-	adata(ADATA_START_ON, p) = 8
-	adata(ADATA_ID, p) = AREA_DUNGEON
-	adata(ADATA_ICON, p) = xy2pic(6, 4)
-	adata(ADATA_FIELD, p) = 1
-	adata(ADATA_RESTORE_POS, p) = 1
+	areaType(p) = MAP_TYPE_HOME
+	areaRestorePos(p) = 1
+	areaIcon(p) = 0
+	areaTileSet(p) = 3
+	areaMaxLevel(p) = 10000
+	areaMinLevel(p) = 1
+	areaCanSave(p) = 1
+	areaTileFile(p) = 1
+	areaStartOn(p) = 8
+	areaId(p) = AREA_DUNGEON
+	areaIcon(p) = xy2pic(6, 4)
+	areaField(p) = 1
+	areaIcon(p) = 1
 	s = lang("ダンジョン", "dungeon")
-	gdata(GDATA_AREA) = area
-	gdata(GDATA_LEVEL) = 1
-	gdata(GDATA_LEVEL_START_ON) = 8
+	gArea = area
+	gLevel = 1
+	gLevelStartOn = 8
 	return
 
 *setHome
 	p = 7
-	adata(ADATA_ICON, p) = xy2pic(11, 4)
-	if ( gdata(GDATA_HOME_LEVEL) == 0 ) {
-		adata(ADATA_ICON, p) = xy2pic(6, 4)
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 4 ) {
-		adata(ADATA_ICON, p) = xy2pic(16, 4)
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 5 ) {
-		adata(ADATA_ICON, p) = xy2pic(12, 4)
-	}
-	if ( gdata(GDATA_HOME_LEVEL) == 6 ) {
-		adata(ADATA_ICON, p) = xy2pic(4, 4)
-	}
-	if ( doukutu == 100 | gdata(GDATA_HOME_LEVEL) != 0 ) {
-		adata(ADATA_X, p) = cdata(CDATA_X, CHARA_PLAYER)
-		adata(ADATA_Y, p) = cdata(CDATA_Y, CHARA_PLAYER)
+	areaIcon(p) = xy2pic(11, 4)
+	if ( gHomeLevel == 0 ) {
+		areaIcon(p) = xy2pic(6, 4)
+	}
+	if ( gHomeLevel == 4 ) {
+		areaIcon(p) = xy2pic(16, 4)
+	}
+	if ( gHomeLevel == 5 ) {
+		areaIcon(p) = xy2pic(12, 4)
+	}
+	if ( gHomeLevel == 6 ) {
+		areaIcon(p) = xy2pic(4, 4)
+	}
+	if ( doukutu == 100 | gHomeLevel != 0 ) {
+		areaX(p) = cX(CHARA_PLAYER)
+		areaY(p) = cY(CHARA_PLAYER)
 		doukutu = 0
 	}
-	adata(ADATA_PARENT, p) = gdata(GDATA_WORLD)
+	areaParent(p) = gWorld
 	return
 
 *com_home
 	txtnew
 	if ( 0 == 0 ) {
-		if ( mdata(MDATA_TYPE) != MAP_TYPE_HOME ) {
+		if ( mType != MAP_TYPE_HOME ) {
 			msgdup++
 			txt lang("ここはあなたの家ではない。", "You can only use it in your home.")
 			gosub *screen_draw
 			goto *pc_turn
 		}
 	}
 	inv_getheader -1
 	p = 0, 0, 0
 	repeat invrange, invhead
 		p(2)++
-		if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
-			if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) != FILTER_FURNITURE ) {
+		if ( iNum(cnt) != 0 ) {
+			if ( refitem(iID(cnt), DBSPEC_TYPE) != FILTER_FURNITURE ) {
 				p++
 			}
 			else {
 				p(1)++
 			}
 		}
 	loop
-	if ( mdata(MDATA_MAX_INV) != 0 ) {
-		p(2) = mdata(MDATA_MAX_INV)
+	if ( mMaxInv != 0 ) {
+		p(2) = mMaxInv
 	}
-	txt lang(mapname(gdata(GDATA_AREA)) + "には" + p + "個のアイテムと" + p(1) + "個の家具がある(アイテム最大" + p(2) + "個) ", "There are " + p + " items and " + p(1) + " furniture in " + mapname(gdata(GDATA_AREA)) + ".(Max: " + p(2) + ") ")
+	txt lang(mapname(gArea) + "には" + p + "個のアイテムと" + p(1) + "個の家具がある(アイテム最大" + p(2) + "個) ", "There are " + p + " items and " + p(1) + " furniture in " + mapname(gArea) + ".(Max: " + p(2) + ") ")
 	txtmore
-	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_GOODS ) {
+	if ( areaId(gArea) == AREA_SHOP ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_GOODS ) {
 			shops = lang("何でも屋", "Goods shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_FOOD ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_FOOD ) {
 			shops = lang("食品店", "Food shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_MAGIC ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_MAGIC ) {
 			shops = lang("魔法店", "Magic shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_BLACKSMITH ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_BLACKSMITH ) {
 			shops = lang("武具店", "Blacksmith")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_INN ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_INN ) {
 			shops = lang("宿屋", "Inn shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_DECORATIVE_ARTS ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_DECORATIVE_ARTS ) {
 			shops = lang("装飾家具店", "Decorative arts shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_JUNK ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_JUNK ) {
 			shops = lang("ジャンク屋", "Junk shop")
 		}
 		txt lang("店タイプ：" + shops + "。", "Shop type : " + shops + ".")
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 0 ) {
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) == 0 ) {
 			txt lang("販売制限なし。", "Shop type : " + shops + ".")
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 1 ) {
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) == 1 ) {
 			txt lang("1日15品限定販売。", "15 items limited sale.")
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 2 ) {
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) == 2 ) {
 			txt lang("1日5品限定販売。", "5 items limited sale")
 		}
-		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
-			txt lang("現在の店主：" + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + " ", "Current shopkeeper is " + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + ".")
+		if ( getworker(gArea) != (-1) ) {
+			txt lang("現在の店主：" + cnName(getworker(gArea)) + " ", "Current shopkeeper is " + cnName(getworker(gArea)) + ".")
 		}
 		else {
 			txt lang("現在店主はいない。", "You haven't assigned a shopkeeper yet.")
 		}
-		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
-			sc = getworker(gdata(GDATA_AREA))
+		if ( getworker(gArea) != (-1) ) {
+			sc = getworker(gArea)
 			p = sdata(156 + STARTING_SKILL_SPACT, sc) \ 1000
 			if ( p >= 400 ) {
 				txt lang("[交渉潜在：Supreme]", "[Trade potential : Supreme]")
 			}
 			if ( p >= 300 & p < 400 ) {
@@ -390,92 +390,92 @@
 				txt lang("[魅力潜在：Hopeless]", "[Charisma potential : Hopeless]")
 			}
 			txt lang("[営業実績：" + cdata(CDATA_SALES_EXP, sc) + "]", "[Sales exp: " + cdata(CDATA_SALES_EXP, sc) + "]")
 		}
 	}
-	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH ) {
-		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
-			txt lang("現在のブリーダーは" + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + "だ。", "Current breeder is " + cdatan(CDATAN_NAME, getworker(gdata(GDATA_AREA))) + ".")
+	if ( areaId(gArea) == AREA_RANCH ) {
+		if ( getworker(gArea) != (-1) ) {
+			txt lang("現在のブリーダーは" + cnName(getworker(gArea)) + "だ。", "Current breeder is " + cnName(getworker(gArea)) + ".")
 		}
 		else {
 			txt lang("現在ブリーダーはいない。", "You haven't assigned a breeder yet.")
 		}
 	}
-	if ( gdata(GDATA_AREA) == AREA_HOME ) {
+	if ( gArea == AREA_HOME ) {
 		p = 0
 		repeat 245 - 57, 57
-			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE | cdata(CDATA_EXIST, cnt) == CHAR_STATE_SPIRIT ) {
-				if ( cdata(CDATA_ROLE, cnt) != ROLE_NONE ) {
+			if ( cExist(cnt) == CHAR_STATE_ALIVE | cExist(cnt) == CHAR_STATE_SPIRIT ) {
+				if ( cRole(cnt) != ROLE_NONE ) {
 					p++
 				}
 			}
 		loop
 		txtmore
-		txt lang("現在" + p + "人の滞在者がいる(最大" + (gdata(GDATA_HOME_LEVEL) + 2) + "人) ", "" + p + " members are staying at your home. (Max: " + (gdata(GDATA_HOME_LEVEL) + 2) + ").")
+		txt lang("現在" + p + "人の滞在者がいる(最大" + (gHomeLevel + 2) + "人) ", "" + p + " members are staying at your home. (Max: " + (gHomeLevel + 2) + ").")
 	}
 	txtnew
 	txt lang("何をする？", "What do you want to do?")
 	p = 0
-	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
-		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+	if ( areaId(gArea) == AREA_SHOP ) {
+		if ( getworker(gArea) != (-1) ) {
 			kunren = 0
-			sc = getworker(gdata(GDATA_AREA))
-			kunren = limit((sdata(SKILL_NORMAL_NEGOTIATION, sc) + sdata(SKILL_ATTR_CHA, sc)) / 100 + 1, 1, 20)
+			sc = getworker(gArea)
+			kunren = limit((sTrade(sc) + sCHR(sc)) / 100 + 1, 1, 20)
 			if ( sorg(SKILL_NORMAL_NEGOTIATION, sc) == 0 ) {
 				kunren = 1000000
 			}
 		}
 		promptl(0, promptmax) = lang("仲間に店主を頼む", "Assign a shopkeeper"), "null", "" + 4
 		promptmax++
-		if ( mdata(MDATA_MAX_INV) < 400 ) {
+		if ( mMaxInv < 400 ) {
 			promptl(0, promptmax) = lang("店を拡張", "Extend") + "(" + calcshopreform() + " GP)", "null", "" + 5
 			promptmax++
 		}
 		promptl(0, promptmax) = lang("店の種類変更", "Change shop type"), "null", "" + 11
 		promptmax++
-		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+		if ( getworker(gArea) != (-1) ) {
 			if ( kunren != 1000000 ) {
 				promptl(0, promptmax) = lang("店主訓練 (ブロンズ硬貨" + kunren + "枚)", "Training of shopkeeper by " + kunren + " bronze coin"), "null", "" + 12
 				promptmax++
 			}
 		}
-		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
+		if ( getworker(gArea) != (-1) ) {
 			promptl(0, promptmax) = lang("営業フィート獲得", "Get shopkeeper feat"), "null", "" + 13
 			promptmax++
 		}
 		promptl(0, promptmax) = lang("1日の販売数を制限", "Limited sales per day"), "null", "" + 14
 		promptmax++
 		promptl(0, promptmax) = lang("バイトを雇う（未実装）", "Hire part time worker (Unimplemented) "), "null", "" + 15
 		promptmax++
 	}
-	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANCH ) {
+	if ( areaId(gArea) == AREA_RANCH ) {
 		promptl(0, promptmax) = lang("ブリーダーを任命する", "Assign a breeder"), "null", "" + 4
 		promptmax++
 		promptl(0, promptmax) = lang("家畜・ブリーダー移動", "Move a livestock"), "null", "" + 3
 		promptmax++
 		promptl(0, promptmax) = lang("餌を撒く（家畜の餌消費）", "Consume livestock feed"), "null", "" + 17
 		promptmax++
 		promptl(0, promptmax) = lang("場内消毒（浄化消毒薬消費）", "Consume disinfectant"), "null", "" + 18
 		promptmax++
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 0 ) {
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) == 0 ) {
 			promptl(0, promptmax) = lang("繁殖防止コード発動", "Activate breeding-prevent code"), "null", "" + 19
 			promptmax++
 		}
-		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) == 0 ) {
+		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea) == 0 ) {
 			promptl(0, promptmax) = lang("生産防止コード発動", "Activate production-prevent code"), "null", "" + 20
 			promptmax++
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) != 0 ) {
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) != 0 ) {
 			promptl(0, promptmax) = lang("繁殖防止コード解除", "Cancel breeding-prevent code"), "null", "" + 21
 			promptmax++
 		}
-		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) != 0 ) {
+		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea) != 0 ) {
 			promptl(0, promptmax) = lang("生産防止コード解除", "Cancel production-prevent code"), "null", "" + 22
 			promptmax++
 		}
 	}
-	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DISCARDED_RANCH ) {
+	if ( areaId(gArea) == AREA_DISCARDED_RANCH ) {
 		promptl(0, promptmax) = lang("ペットを放す", "release ally"), "null", "" + 8
 		promptmax++
 		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
 		promptmax++
 	}
@@ -483,34 +483,34 @@
 		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
 		promptmax++
 	}
 	promptl(0, promptmax) = lang("家の模様替え", "Design"), "null", "" + 0
 	promptmax++
-	if ( gdata(GDATA_AREA) == AREA_HOME ) {
+	if ( gArea == AREA_HOME ) {
 		promptl(0, promptmax) = lang("家の情報", "Home rank"), "null", "" + 2
 		promptmax++
 		promptl(0, promptmax) = lang("仲間の滞在", "Allies in your home"), "null", "" + 4
 		promptmax++
-		if ( gdata(GDATA_LEVEL) == 1 ) {
+		if ( gLevel == 1 ) {
 			promptl(0, promptmax) = lang("使用人を募集する", "Recruit a servant"), "null", "" + 6
 			promptmax++
 		}
 		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
 		promptmax++
 	}
-	if ( gdata(GDATA_AREA) == AREA_MAID_MANSION ) {
+	if ( gArea == AREA_MAID_MANSION ) {
 		promptl(0, promptmax) = lang("滞在者の移動", "Move a stayer"), "null", "" + 3
 		promptmax++
 	}
 	promptl(0, promptmax) = lang("生成される扉変更", "Change door type"), "null", "" + 7
 	promptmax++
 	promptl(0, promptmax) = lang("タイルグループ変更", "Change tile group"), "null", "" + 16
 	promptmax++
 	promptl(0, promptmax) = lang("外装変更", "Change Map Icon"), "null", "" + 9
 	promptmax++
-	if ( gdata(GDATA_AREA) != AREA_HOME ) {
-		if ( gdata(GDATA_AREA) != AREA_MAID_MANSION ) {
+	if ( gArea != AREA_HOME ) {
+		if ( gArea != AREA_MAID_MANSION ) {
 			promptl(0, promptmax) = lang("施設名称変更", "Change Map Name"), "null", "" + 10
 			promptmax++
 		}
 	}
 	promptl(0, promptmax) = lang("お片付け機能", "Collecting function"), "null", "" + 23
@@ -527,50 +527,50 @@
 		_switch_sw++
 	}
 	if ( _switch_val == 0 | _switch_sw ) {
 		_switch_sw = 0
 		homemapmode = 1
-		cxbk = cdata(CDATA_X, CHARA_PLAYER)
-		cybk = cdata(CDATA_Y, CHARA_PLAYER)
+		cxbk = cX(CHARA_PLAYER)
+		cybk = cY(CHARA_PLAYER)
 		gosub *home_setWallTile
 		n = 0
 		txtnew
 		txt lang("マウスの左クリックでタイルの敷設、右クリックでタイルの取得、移動キーでスクリーン移動、決定キーでタイル一覧、キャンセルキーで終了。", "Left click to place the tile, right click to pick the tile under your mouse cursor, movement keys to move current position, hit the enter key to show the list of tiles, hit the cancel key to exit.")
-		tlocinitx = cdata(CDATA_X, CHARA_PLAYER)
-		tlocinity = cdata(CDATA_Y, CHARA_PLAYER)
+		tlocinitx = cX(CHARA_PLAYER)
+		tlocinity = cY(CHARA_PLAYER)
 		tile = 0
 		repeat
 			await
 			homemakewall = 1
 			gosub *findLocation
 			if ( stat == (-1) ) {
 				break
 			}
 			if ( (chipm(CHIPM_ATTRIB, tile) & CHIPM_ATTRIB_CANT_PASS) == 0 ) {
-				map(tlocx, tlocy, MAP_TILE_ID) = tile
-				map(tlocx, tlocy, MAP_TILE_ID_MEMORY) = tile
+				mapId(tlocx, tlocy) = tile
+				mapIdMemory(tlocx, tlocy) = tile
 			}
 			else {
 				efid = SKILL_SPELL_WALL_CREATION
 				gosub *effect
 			}
 			tlocinitx = tlocx
 			tlocinity = tlocy
 		loop
 		homemapmode = 0
-		cdata(CDATA_X, CHARA_PLAYER) = cxbk
-		cdata(CDATA_Y, CHARA_PLAYER) = cybk
+		cX(CHARA_PLAYER) = cxbk
+		cY(CHARA_PLAYER) = cybk
 		dblistmax = 0
 		inv_getheader -1
 		repeat invrange, invhead
-			if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_SHOP ) {
+			if ( areaId(gArea) != AREA_SHOP ) {
 				break
 			}
-			if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+			if ( iNum(cnt) <= 0 ) {
 				continue
 			}
-			if ( chipm(CHIPM_ROLE, map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_TILE_ID)) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
+			if ( chipm(CHIPM_ROLE, mapId(iX(cnt), iY(cnt))) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
 				inv(INV_ITEM_SHOP_SAMPLE, cnt) = 100
 			}
 			else {
 				inv(INV_ITEM_SHOP_SAMPLE, cnt) = 0
 			}
@@ -586,21 +586,21 @@
 		inputlog = ""
 		input_mode = 1
 		gosub *prompt_word
 		if ( inputlog == "" ) {
 			txt lang("名前をつけるのはやめた。", "You changed your mind.")
-			adata(ADATA_FESTIVAL, gdata(GDATA_AREA)) = 0
+			areaFestival(gArea) = 0
 		}
 		else {
 			mdatan(0) = "" + inputlog
-			adata(ADATA_FESTIVAL, gdata(GDATA_AREA)) = 9999
-			txt lang("" + mdatan(0) + "という名前で呼ぶことにした。", "You named " + him(tc) + " " + cdatan(CDATAN_NAME, tc) + ".")
+			areaFestival(gArea) = 9999
+			txt lang("" + mdatan(0) + "という名前で呼ぶことにした。", "You named " + him(tc) + " " + cnName(tc) + ".")
 			gosub *screen_refreshFull
 		}
 		gosub *screen_refresh
 		goto *pc_turn
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 
 
 	if ( _switch_val == 2 | _switch_sw ) {
@@ -628,11 +628,11 @@
 		pos wx + ww / 4, wy + wh / 2
 		grotate BUFFER_BUF, cmbg / 4 \ 4 * 180, cmbg / 4 / 4 \ 2 * 300, 0, x, y
 		gmode 2
 		gosub *house_update
 		s = lang("基本.", "Base"), lang("家具.", "Deco"), lang("家宝.", "Heir"), lang("総合.", "Total")
-		p = gdata(GDATA_HOME_BASE), gdata(GDATA_HOME_FURNITURE), gdata(GDATA_HOME_VALUE)
+		p = gHomeBase, gHomeFurniture, gHomeValue
 		p(3) = (p + p(1) + p(2)) / 3
 		repeat 4
 			x = wx + 45 + cnt / 2 * 190
 			y = wy + 68 + cnt \ 2 * 18
 			font lang(cfg_font1, cfg_font2), 12 + sizefix - en * 2, 0
@@ -653,60 +653,60 @@
 		repeat 10
 			p = list(0, cnt)
 			if ( p == 0 ) {
 				continue
 			}
-			if ( inv(INV_ITEM_PIC, p) / 1000 < 1 ) {
-				p(1) = inv(INV_ITEM_PIC, p) \ 1000
+			if ( iPic(p) / 1000 < 1 ) {
+				p(1) = iPic(p) \ 1000
 			}
-			if ( inv(INV_ITEM_PIC, p) / 1000 >= 1 ) {
-				p(1) = inv(INV_ITEM_PIC, p)
+			if ( iPic(p) / 1000 >= 1 ) {
+				p(1) = iPic(p)
 			}
 			gsel BUFFER_ITEM
 			color 0
 			boxf 0, 960, chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1)) + 960
 			if ( p(1) == 528 ) {
 				gmode 2
 				pos 0, 960
 				gcopy BUFFER_ITEM, 0, 768, inf_tiles, inf_tiles
 				pos 0, 1008
-				gzoom 22, 20, 5, chipc(CHIPC_X, inv(INV_ITEM_COL, p)) + 8, chipc(CHIPC_Y, inv(INV_ITEM_COL, p)) + 4 + (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) > inf_tiles) * 8, chipc(CHIPC_WIDTH, inv(INV_ITEM_COL, p)) - 16, chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) - 8 - (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) > inf_tiles) * 10, 1
+				gzoom 22, 20, 5, chipc(CHIPC_X, iCol(p)) + 8, chipc(CHIPC_Y, iCol(p)) + 4 + (chipc(CHIPC_HEIGHT, iCol(p)) > inf_tiles) * 8, chipc(CHIPC_WIDTH, iCol(p)) - 16, chipc(CHIPC_HEIGHT, iCol(p)) - 8 - (chipc(CHIPC_HEIGHT, iCol(p)) > inf_tiles) * 10, 1
 				pos 6, 974
 				gcopy BUFFER_ITEM, 0, 1008, 22, 20
 				gsel selcur
 			}
 			else {
 				if ( p(1) == 1119 ) {
-					pos 0, 1055 - chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
-					gcopy BUFFER_CHR, chipc(CHIPC_X, inv(INV_ITEM_COL, p)), chipc(CHIPC_Y, inv(INV_ITEM_COL, p)), chipc(CHIPC_WIDTH, inv(INV_ITEM_COL, p)), chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
+					pos 0, 1055 - chipc(CHIPC_HEIGHT, iCol(p))
+					gcopy BUFFER_CHR, chipc(CHIPC_X, iCol(p)), chipc(CHIPC_Y, iCol(p)), chipc(CHIPC_WIDTH, iCol(p)), chipc(CHIPC_HEIGHT, iCol(p))
 					gmode 2
 					gsel selcur
 				}
 				else {
 					if ( p(1) == 1206 ) {
-						pos 0, 1055 - chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
-						gcopy BUFFER_CHR, chipc(CHIPC_X, inv(INV_ITEM_COL, p)), chipc(CHIPC_Y, inv(INV_ITEM_COL, p)), chipc(CHIPC_WIDTH, inv(INV_ITEM_COL, p)), chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
+						pos 0, 1055 - chipc(CHIPC_HEIGHT, iCol(p))
+						gcopy BUFFER_CHR, chipc(CHIPC_X, iCol(p)), chipc(CHIPC_Y, iCol(p)), chipc(CHIPC_WIDTH, iCol(p)), chipc(CHIPC_HEIGHT, iCol(p))
 						gfini chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
 						gfdec2 0, 0, 255
 						gsel selcur
 					}
 					else {
 						if ( p(1) == 531 ) {
-							pos 8, 1058 - chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p))
-							gcopy BUFFER_CHR, chipc(CHIPC_X, inv(INV_ITEM_COL, p)) + 8, chipc(CHIPC_Y, inv(INV_ITEM_COL, p)) + 2, chipc(CHIPC_WIDTH, inv(INV_ITEM_COL, p)) - 16, chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) - 8
+							pos 8, 1058 - chipc(CHIPC_HEIGHT, iCol(p))
+							gcopy BUFFER_CHR, chipc(CHIPC_X, iCol(p)) + 8, chipc(CHIPC_Y, iCol(p)) + 2, chipc(CHIPC_WIDTH, iCol(p)) - 16, chipc(CHIPC_HEIGHT, iCol(p)) - 8
 							gmode 4, , , 150
 							color 0, 0, 0
-							pos 0, 960 + (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) == inf_tiles) * 48
-							gcopy BUFFER_ITEM, 144, 768 + (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) > inf_tiles) * 48, inf_tiles, chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) + (chipc(CHIPC_HEIGHT, inv(INV_ITEM_COL, p)) > inf_tiles) * 48 * 0
+							pos 0, 960 + (chipc(CHIPC_HEIGHT, iCol(p)) == inf_tiles) * 48
+							gcopy BUFFER_ITEM, 144, 768 + (chipc(CHIPC_HEIGHT, iCol(p)) > inf_tiles) * 48, inf_tiles, chipc(CHIPC_HEIGHT, iCol(p)) + (chipc(CHIPC_HEIGHT, iCol(p)) > inf_tiles) * 48 * 0
 							gmode 2
 							gsel selcur
 						}
 						else {
 							pos 0, 960
 							gcopy BUFFER_ITEM, chipi(CHIPI_X, p(1)), chipi(CHIPI_Y, p(1)), chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
 							gfini chipi(CHIPI_WIDTH, p(1)), chipi(CHIPI_HEIGHT, p(1))
-							gfdec2 c_col(0, inv(INV_ITEM_COL, p)), c_col(1, inv(INV_ITEM_COL, p)), c_col(2, inv(INV_ITEM_COL, p))
+							gfdec2 c_col(0, iCol(p)), c_col(1, iCol(p)), c_col(2, iCol(p))
 							gsel selcur
 						}
 					}
 				}
 			}
@@ -750,46 +750,46 @@
 		allyctrl = 0
 		gosub *com_listNpc
 		if ( stat == (-1) ) {
 			goto *com_home_WEND3
 		}
-		if ( cdata(CDATA_RELATION, stat) <= RELATION_ENEMY ) {
+		if ( cRelation(stat) <= RELATION_ENEMY ) {
 			txtnew
 			txtef COLOR_SKY_BLUE
-			txt cdatan(CDATAN_NAME, stat) + lang("「触るな！」", " " + cnvtalk("Don't touch me!"))
+			txt cnName(stat) + lang("「触るな！」", " " + cnvtalk("Don't touch me!"))
 			goto *com_home_WEND3
 		}
 		tchome = stat
 		tc = stat
 		snd SOUNDLIST_OK1
 *com_home_WHILE3
 		if ( 1 == 0 ) {
 			goto *com_home_WEND2
 		}
 		txtnew
-		txt lang(cdatan(CDATAN_NAME, tc) + "をどこに移動させる？", "Where do you want to move " + cdatan(CDATAN_NAME, tc) + "?")
+		txt lang(cnName(tc) + "をどこに移動させる？", "Where do you want to move " + cnName(tc) + "?")
 		gosub *findLocation
 		if ( stat == (-1) ) {
 			goto *com_home_WEND2
 		}
-		if ( chipm(CHIPM_ATTRIB, map(tlocx, tlocy, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS | map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
+		if ( chipm(CHIPM_ATTRIB, mapId(tlocx, tlocy)) & CHIPM_ATTRIB_CANT_PASS | mapChara(tlocx, tlocy) != 0 ) {
 			txt lang("その場所には移動させることができない。", "The location is invalid.")
 			tc = tchome
 			tlochomex = tlocx
 			tlochomey = tlocy
 			goto *com_home_SWEND1
 		}
 		tc = tchome
-		map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_CHARA_INDEX_PLUS_ONE) = 0
-		map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) = tc + 1
-		cdata(CDATA_X, tc) = tlocx
-		cdata(CDATA_X_ORG, tc) = tlocx
-		cdata(CDATA_Y, tc) = tlocy
-		cdata(CDATA_Y_ORG, tc) = tlocy
+		mapChara(cX(tc), cY(tc)) = 0
+		mapChara(tlocx, tlocy) = tc + 1
+		cX(tc) = tlocx
+		cXorg(tc) = tlocx
+		cY(tc) = tlocy
+		cYorg(tc) = tlocy
 		rowactend tc
 		txtnew
-		txt lang(cdatan(CDATAN_NAME, tc) + "を移動させた。", cdatan(CDATAN_NAME, tc) + " " + is(tc) + " moved to the location.")
+		txt lang(cnName(tc) + "を移動させた。", cnName(tc) + " " + is(tc) + " moved to the location.")
 		snd SOUNDLIST_FOOT
 		goto *com_home_WEND2
 *com_home_SWEND1
 		goto *com_home_WHILE3
 *com_home_WEND2
@@ -809,44 +809,44 @@
 			txtnew
 			if ( cdata(CDATA_IN_TAGTEAM, c) != 0 ) {
 				snd SOUNDLIST_FAIL1
 				txtef COLOR_RED
 				txt lang("タッグを解散する必要がある。", "It is need to dissolve the tag.")
-				goto *label_4602
+				goto *label_4609
 			}
-			if ( getworker(gdata(GDATA_AREA), c) == c ) {
+			if ( getworker(gArea, c) == c ) {
 				f = get_freeallyne()
 				if ( f == 0 ) {
 					snd SOUNDLIST_FAIL1
 					txt lang("仲間の最大数に達しているため、連れていけない。", "Your party is already full. You can't invite someone anymore.")
-					goto *label_4602
+					goto *label_4609
 				}
-				if ( gdata(GDATA_AREA) == AREA_HOME ) {
-					cdata(CDATA_AREA, c) = AREA_NONE
-					txt lang(cdatan(CDATAN_NAME, c) + "の滞在を取り消した。", cdatan(CDATAN_NAME, c) + " " + is(c) + " no longer staying at your home.")
+				if ( gArea == AREA_HOME ) {
+					cType(c) = 0
+					txt lang(cnName(c) + "の滞在を取り消した。", cnName(c) + " " + is(c) + " no longer staying at your home.")
 					cdata(CDATA_HOME, c) = 0
 				}
 				else {
-					removeworker gdata(GDATA_AREA)
-					txt lang(cdatan(CDATAN_NAME, c) + "を役目から外した。", "You remove " + cdatan(CDATAN_NAME, c) + " from " + his(c) + " job.")
+					removeworker gArea
+					txt lang(cnName(c) + "を役目から外した。", "You remove " + cnName(c) + " from " + his(c) + " job.")
 				}
 			}
 			else {
-				if ( gdata(GDATA_AREA) == AREA_HOME ) {
-					cdata(CDATA_X_ORG, c) = cdata(CDATA_X, c)
-					cdata(CDATA_Y_ORG, c) = cdata(CDATA_Y, c)
-					cdata(CDATA_HOME, c) = gdata(GDATA_LEVEL)
-					txt lang(cdatan(CDATAN_NAME, c) + "を滞在させた。", cdatan(CDATAN_NAME, c) + " stay" + _s(c) + " at your home now.")
+				if ( gArea == AREA_HOME ) {
+					cXorg(c) = cX(c)
+					cYorg(c) = cY(c)
+					cdata(CDATA_HOME, c) = gLevel
+					txt lang(cnName(c) + "を滞在させた。", cnName(c) + " stay" + _s(c) + " at your home now.")
 				}
 				else {
-					removeworker gdata(GDATA_AREA)
-					txt lang(cdatan(CDATAN_NAME, c) + "を任命した。", cdatan(CDATAN_NAME, c) + " take" + _s(c) + " charge of the job now.")
+					removeworker gArea
+					txt lang(cnName(c) + "を任命した。", cnName(c) + " take" + _s(c) + " charge of the job now.")
 				}
-				cdata(CDATA_AREA, c) = gdata(GDATA_AREA)
+				cType(c) = gArea
 			}
 		}
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 8 | _switch_sw ) {
 		_switch_sw = 0
 		pet = 0
@@ -856,48 +856,48 @@
 			}
 		loop
 		if ( pet >= 150 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("150体までしか放せない。", "You can not let go only 150 in this ranch.")
-			goto *label_4602
+			goto *label_4609
 		}
 		allyctrl = 3
 		gosub *com_ally
 		if ( stat != (-1) ) {
 			c = stat
 			snd SOUNDLIST_OK1
 			txtnew
-			cdata(CDATA_X_ORG, c) = cdata(CDATA_X, c)
-			cdata(CDATA_Y_ORG, c) = cdata(CDATA_Y, c)
+			cXorg(c) = cX(c)
+			cYorg(c) = cY(c)
 			if ( cbit(CHARA_BIT_BODYGUARD, c) != FALSE | cbit(CHARA_BIT_GUARD_TEMP, c) != FALSE ) {
 				snd SOUNDLIST_FAIL1
 				txt lang("護衛対象は放せない。", "You can not let go escort target in this ranch.")
-				goto *label_4602
+				goto *label_4609
 			}
 			cbitmod CHARA_BIT_LIVESTOCK, c, TRUE
-			txt lang(cdatan(CDATAN_NAME, c) + "を放してやった。", cdatan(CDATAN_NAME, c) + " stay" + _s(c) + " at this ranch.")
+			txt lang(cnName(c) + "を放してやった。", cnName(c) + " stay" + _s(c) + " at this ranch.")
 			if ( cbit(CHARA_BIT_PCC, c) == TRUE ) {
 				txtef COLOR_YELLOW
 				txtmore
-				txt lang(cdatan(CDATAN_NAME, c) + "は元々の姿に着替えた。", cdatan(CDATAN_NAME, c) + " changed original cloth.")
+				txt lang(cnName(c) + "は元々の姿に着替えた。", cnName(c) + " changed original cloth.")
 				cbitmod CHARA_BIT_PCC, c, FALSE
 			}
-			if ( cdata(CDATA_EXIST, c) != CHAR_STATE_DEAD ) {
-				if ( cdatan(CDATAN_RACE, c) == "servant" ) {
+			if ( cExist(c) != CHAR_STATE_DEAD ) {
+				if ( cnRace(c) == "servant" ) {
 					gdata(GDATA_ACTIVE_GOD_PETS)++
 				}
 			}
-			cdata(CDATA_AREA, c) = gdata(GDATA_AREA)
+			cType(c) = gArea
 			relocate_chara c, -1
-			cdata(CDATA_RELATION, c) = RELATION_DISLIKE
-			cdata(CDATA_RELATION_ORG, c) = RELATION_DISLIKE
-			cdata(CDATA_ROLE, c) = ROLE_SPECIAL
-			if ( mdata(MDATA_MAX_INV) <= 80 ) {
-				mdata(MDATA_MAX_INV) = 400
+			cRelation(c) = RELATION_DISLIKE
+			cOrgRelation(c) = RELATION_DISLIKE
+			cRole(c) = ROLE_SPECIAL
+			if ( mMaxInv <= 80 ) {
+				mMaxInv = 400
 			}
 		}
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 17 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -919,41 +919,41 @@
 			if ( rtval != 0 ) {
 				gosub *screen_draw
 				goto *pc_turn
 			}
 			txt lang("辺りに餌を撒いた。", name(0) + " sprinkled " + itemname(ci, 1) + ".")
-			inv(INV_ITEM_NUM, ci) -= 1
+			iNum(ci) -= 1
 			gosub *calcBurdenPc
 			snd SOUNDLIST_BUSH1
 			ccbk = cc
 			repeat 245
-				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+				if ( cExist(cnt) != CHAR_STATE_ALIVE ) {
 					continue
 				}
 				if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == FALSE ) {
 					continue
 				}
-				if ( cdata(CDATA_CONDITION_DIM, cnt) > 60 ) {
-					cdata(CDATA_CONDITION_DIM, cnt) = 59
+				if ( cDim(cnt) > 60 ) {
+					cDim(cnt) = 59
 				}
-				cdata(CDATA_CONDITION_SLEEP, cnt) = 0
-				cdata(CDATA_CONDITION_SUFFOCATION, cnt) = 0
-				cdata(CDATA_CONDITION_PARALYZE, cnt) = 0
+				cSleep(cnt) = 0
+				cMochi(cnt) = 0
+				cParalyze(cnt) = 0
 				cc = cnt
 				if ( cnt != 0 ) {
 					tc = CHARA_PLAYER
 					efid = SKILL_SPACT_SHADOW_STEP
 					gosub *effect
 				}
-				modweight cc, limit(10000 - cdata(CDATA_HUNGER, cnt), 1, 5000) / 1000, cdata(CDATA_HUNGER, cc) > 0
-				cdata(CDATA_HUNGER, cnt) = 10000
-				cdata(CDATA_EMO_ICON, cc) = 16 + 100 * 1
+				modweight cc, limit(10000 - cHunger(cnt), 1, 5000) / 1000, cHunger(cc) > 0
+				cHunger(cnt) = 10000
+				cEmoIcon(cc) = 16 + 100 * 1
 				modimp2 cc, 15
 			loop
 		}
 		cc = ccbk
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 18 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -976,30 +976,30 @@
 				gosub *screen_draw
 				goto *pc_turn
 			}
 			txt lang("場内を消毒した。", name(0) + " sprinkled " + itemname(ci, 1) + ".")
 			disip = 40
-			if ( inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_NORMAL ) {
+			if ( iStatus(ci) == ITEM_STATUS_NORMAL ) {
 				disip = 20
 			}
-			if ( inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_CURSED ) {
+			if ( iStatus(ci) == ITEM_STATUS_CURSED ) {
 				disip = 10
 			}
-			if ( inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_DOOMED ) {
+			if ( iStatus(ci) == ITEM_STATUS_DOOMED ) {
 				disip = 5
 			}
-			inv(INV_ITEM_NUM, ci) -= 1
+			iNum(ci) -= 1
 			gosub *calcBurdenPc
 			snd SOUNDLIST_MIZU
 			repeat 245
-				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+				if ( cExist(cnt) != CHAR_STATE_ALIVE ) {
 					continue
 				}
 				if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == FALSE ) {
 					continue
 				}
-				cdata(CDATA_EMO_ICON, cnt) = 6 + 100 * 1
+				cEmoIcon(cnt) = 6 + 100 * 1
 				healcon cnt, CONDITION_POISON, disip
 				healcon cnt, CONDITION_SICK, disip
 				if ( findbuff(cnt, BUFF_DISINFECTION) == (-1) ) {
 					addbuff cnt, BUFF_DISINFECTION, 50, 600
 				}
@@ -1004,51 +1004,51 @@
 					addbuff cnt, BUFF_DISINFECTION, 50, 600
 				}
 				modimp cnt, 15
 			loop
 		}
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 19 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		snd SOUNDLIST_AMMO
 		txtef COLOR_RED
 		txt lang("この牧場では繁殖が行われない。", "This area will prevent breeding.")
-		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 10
-		goto *label_4602
+		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) = 10
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 20 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		snd SOUNDLIST_AMMO
 		txtef COLOR_RED
 		txt lang("この牧場では生産が行われない。", "This area will prevent production.")
-		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = 10
-		goto *label_4602
+		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea) = 10
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 21 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		snd SOUNDLIST_ENC
 		txtef COLOR_GREEN
 		txt lang("繁殖が通常通り行われるようになった。", "This area does not prevent breeding.")
-		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = 0
-		goto *label_4602
+		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) = 0
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 22 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		snd SOUNDLIST_ENC
 		txtef COLOR_GREEN
 		txt lang("生産が通常通り行われるようになった。", "This area does not prevent production.")
-		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = 0
-		goto *label_4602
+		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea) = 0
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 23 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1061,55 +1061,55 @@
 		loop
 		val = promptx, prompty, 200, 1
 		gosub *prompt_key
 		if ( stat == 0 ) {
 			gosub *screen_draw
-			goto *label_4602
+			goto *label_4609
 		}
 		if ( rtval == 1 ) {
 			snd SOUNDLIST_ENC
 			repeat 400, 5080
-				if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+				if ( iNum(cnt) <= 0 ) {
 					continue
 				}
-				if ( inv(INV_ITEM_PROPERTY, cnt) == PROP_NPC | inv(INV_ITEM_PROPERTY, cnt) == PROP_SPECIAL ) {
+				if ( iProperty(cnt) == PROP_NPC | iProperty(cnt) == PROP_SPECIAL ) {
 					continue
 				}
-				bkx = inv(INV_ITEM_X, cnt)
-				bky = inv(INV_ITEM_Y, cnt)
-				inv(INV_ITEM_X, cnt) = cdata(CDATA_X, CHARA_PLAYER)
-				inv(INV_ITEM_Y, cnt) = cdata(CDATA_Y, CHARA_PLAYER)
+				bkx = iX(cnt)
+				bky = iY(cnt)
+				iX(cnt) = cX(CHARA_PLAYER)
+				iY(cnt) = cY(CHARA_PLAYER)
 				cell_refresh bkx, bky
 			loop
-			cell_refresh cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
+			cell_refresh cX(CHARA_PLAYER), cY(CHARA_PLAYER)
 		}
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 5 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
-		if ( cdata(CDATA_GOLD, CHARA_PLAYER) < calcshopreform() ) {
+		if ( cGold(CHARA_PLAYER) < calcshopreform() ) {
 			txt lang("お金が足りない…", "You don't have enough money...")
 		}
 		else {
 			snd SOUNDLIST_PAYGOLD1
-			cdata(CDATA_GOLD, CHARA_PLAYER) -= calcshopreform()
-			mdata(MDATA_MAX_INV) = limit(mdata(MDATA_MAX_INV) + 10, 1, 400)
+			cGold(CHARA_PLAYER) -= calcshopreform()
+			mMaxInv = limit(mMaxInv + 10, 1, 400)
 			txtef COLOR_GREEN
-			txt lang("店を拡張した！これからは" + mdata(MDATA_MAX_INV) + "個のアイテムを陳列できる。", "You extend your shop! You can display max of " + mdata(MDATA_MAX_INV) + " items now!")
+			txt lang("店を拡張した！これからは" + mMaxInv + "個のアイテムを陳列できる。", "You extend your shop! You can display max of " + mMaxInv + " items now!")
 		}
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 11 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
-		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) > gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 ) {
-			txt lang("次に変更できるのは" + cnvdate(adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)), 1) + "だ。", "This Shop will be changeable again at " + cnvdate(adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)), 1) + ".")
+		if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea) > gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12 ) {
+			txt lang("次に変更できるのは" + cnvdate(adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea), 1) + "だ。", "This Shop will be changeable again at " + cnvdate(adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea), 1) + ".")
 			snd SOUNDLIST_FAIL1
-			goto *label_4602
+			goto *label_4609
 		}
 		txtsetshop 8
 		repeat 8
 			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
 			promptmax++
@@ -1115,33 +1115,33 @@
 			promptmax++
 		loop
 		val = promptx, prompty, 350, 0
 		gosub *prompt_key
 		if ( rtval == 0 ) {
-			goto *label_4602
+			goto *label_4609
 		}
-		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + 24 * 15
-		adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) = rtval - 1
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_GOODS ) {
+		adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea) = gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12 + 24 * 15
+		areaShopType(gArea) = rtval - 1
+		if ( areaShopType(gArea) == SHOP_TYPE_GOODS ) {
 			shops = lang("何でも屋", "Goods shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_FOOD ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_FOOD ) {
 			shops = lang("食品店", "Food shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_MAGIC ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_MAGIC ) {
 			shops = lang("魔法店", "Magic shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_BLACKSMITH ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_BLACKSMITH ) {
 			shops = lang("武具店", "Blacksmith")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_INN ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_INN ) {
 			shops = lang("宿屋", "Inn shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_DECORATIVE_ARTS ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_DECORATIVE_ARTS ) {
 			shops = lang("装飾家具店", "Decorative arts shop")
 		}
-		if ( adata(ADATA_SHOP_TYPE, gdata(GDATA_AREA)) == SHOP_TYPE_JUNK ) {
+		if ( areaShopType(gArea) == SHOP_TYPE_JUNK ) {
 			shops = lang("ジャンク屋", "Junk shop")
 		}
 		txtef COLOR_GREEN
 		txt lang("店種類変更：" + shops + "。", "Shop type changed: " + shops + ".")
 		snd SOUNDLIST_BUILD1
@@ -1143,28 +1143,28 @@
 			shops = lang("ジャンク屋", "Junk shop")
 		}
 		txtef COLOR_GREEN
 		txt lang("店種類変更：" + shops + "。", "Shop type changed: " + shops + ".")
 		snd SOUNDLIST_BUILD1
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 12 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		item_find ITEM_ID_BRONZE_COIN, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
 		if ( stat != (-1) ) {
 			ci = stat
-			if ( inv(INV_ITEM_NUM, ci) >= kunren ) {
-				sc = getworker(gdata(GDATA_AREA))
+			if ( iNum(ci) >= kunren ) {
+				sc = getworker(gArea)
 				snd SOUNDLIST_PAYGOLD1
-				inv(INV_ITEM_NUM, ci) -= kunren
+				iNum(ci) -= kunren
 				modgrowth sc, SKILL_NORMAL_NEGOTIATION, 150
 				modgrowth sc, SKILL_ATTR_CHA, 150
 				snd SOUNDLIST_DING3
 				txtef COLOR_SKY_BLUE
-				txt lang(cdatan(CDATAN_NAME, sc) + "は講師を呼び、潜在能力を伸ばした！", cdatan(CDATAN_NAME, sc) + " calls a trainer and develops " + his(sc) + " potential!")
+				txt lang(cnName(sc) + "は講師を呼び、潜在能力を伸ばした！", cnName(sc) + " calls a trainer and develops " + his(sc) + " potential!")
 				goto *turn_end
 			}
 		}
 		txt lang("ブロンズ硬貨が足りない…", "You don't have enough bronze coin...")
 		snd SOUNDLIST_FAIL1
@@ -1166,41 +1166,41 @@
 				goto *turn_end
 			}
 		}
 		txt lang("ブロンズ硬貨が足りない…", "You don't have enough bronze coin...")
 		snd SOUNDLIST_FAIL1
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 13 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
-		sc = getworker(gdata(GDATA_AREA))
+		sc = getworker(gArea)
 		if ( 0 ) {
 			cdata(CDATA_SALES_EXP, sc) = 500
 		}
 		if ( cdata(CDATA_SALES_FEATS, sc) == 0 ) {
 			if ( cdata(CDATA_SALES_EXP, sc) < 120 ) {
-				txt lang("営業実績が120は必要だ…。", cdatan(CDATAN_NAME, sc) + " don't have enough sales exp...")
+				txt lang("営業実績が120は必要だ…。", cnName(sc) + " don't have enough sales exp...")
 				snd SOUNDLIST_FAIL1
-				goto *label_4602
+				goto *label_4609
 			}
 		}
 		if ( cdata(CDATA_SALES_FEATS, sc) == 1 ) {
 			if ( cdata(CDATA_SALES_EXP, sc) < 360 ) {
-				txt lang("営業実績が360は必要だ…。", cdatan(CDATAN_NAME, sc) + " don't have enough sales exp...")
+				txt lang("営業実績が360は必要だ…。", cnName(sc) + " don't have enough sales exp...")
 				snd SOUNDLIST_FAIL1
-				goto *label_4602
+				goto *label_4609
 			}
 		}
 		if ( cdata(CDATA_SALES_FEATS, sc) >= 2 ) {
-			txt lang("これ以上は獲得できない。", cdatan(CDATAN_NAME, sc) + " can't get shopkeeper feat...")
+			txt lang("これ以上は獲得できない。", cnName(sc) + " can't get shopkeeper feat...")
 			snd SOUNDLIST_FAIL1
-			goto *label_4602
+			goto *label_4609
 		}
 		txtef COLOR_GREEN
-		txt lang(cdatan(CDATAN_NAME, sc) + "は営業で得た経験をもとにフィートを獲得できる！それは…", itemname(ci) + " sucked enough blood and ready to grow!")
+		txt lang(cnName(sc) + "は営業で得た経験をもとにフィートを獲得できる！それは…", itemname(ci) + " sucked enough blood and ready to grow!")
 		txtsetshopfeat 6
 		repeat 6
 			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
 			promptmax++
 		loop
@@ -1208,12 +1208,12 @@
 		gosub *prompt_key
 		shopval = rtval
 		txtnew
 		if ( shopval == 0 ) {
 			txtef COLOR_GREEN
-			txt lang(cdatan(CDATAN_NAME, sc) + "はずっこけた。", cdatan(CDATAN_NAME, sc) + " seems dissatisfied.")
-			goto *label_4602
+			txt lang(cnName(sc) + "はずっこけた。", cnName(sc) + " seems dissatisfied.")
+			goto *label_4609
 		}
 		if ( shopval > 0 & shopval <= 5 ) {
 			if ( shopval == 1 ) {
 				bitp = CHARA_BIT_SHOP_ELEGANCE
 			}
@@ -1229,24 +1229,24 @@
 			if ( shopval == 5 ) {
 				bitp = CHARA_BIT_SHOP_BUSINESS_SMILE
 			}
 			if ( cbit(bitp, sc) ) {
 				txtef COLOR_RED
-				txt lang(cdatan(CDATAN_NAME, sc) + "はそのフィートを既に持っている。", cdatan(CDATAN_NAME, sc) + " already has that feat.")
+				txt lang(cnName(sc) + "はそのフィートを既に持っている。", cnName(sc) + " already has that feat.")
 				snd SOUNDLIST_FAIL1
-				goto *label_4602
+				goto *label_4609
 			}
 			cbitmod bitp, sc, TRUE
 			if ( bitp == CHARA_BIT_SHOP_ELEGANCE ) {
 				skillmod SKILL_ATTR_CHA, sc, 30000
 			}
 			cdata(CDATA_SALES_FEATS, sc)++
 			snd SOUNDLIST_PRAY1
 			txtef COLOR_GREEN
-			txt lang(cdatan(CDATAN_NAME, sc) + "はフィートを獲得した。", cdatan(CDATAN_NAME, sc) + " got the new feat!")
+			txt lang(cnName(sc) + "はフィートを獲得した。", cnName(sc) + " got the new feat!")
 		}
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 14 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
@@ -1256,15 +1256,15 @@
 			promptmax++
 		loop
 		val = promptx, prompty, 300, 0
 		gosub *prompt_key
 		if ( rtval == 0 ) {
-			goto *label_4602
+			goto *label_4609
 		}
-		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) = rtval - 1
+		adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) = rtval - 1
 		snd SOUNDLIST_BUILD1
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 15 | _switch_sw ) {
 		_switch_sw = 0
 		snd SOUNDLIST_FAIL1
@@ -1266,31 +1266,31 @@
 		_switch_sw++
 	}
 	if ( _switch_val == 15 | _switch_sw ) {
 		_switch_sw = 0
 		snd SOUNDLIST_FAIL1
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 7 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
-		if ( mdata(MDATA_TILESET) == MAP_TILESET_UNKNOWN ) {
+		if ( mTileSet == MAP_TILESET_UNKNOWN ) {
 			tilep = 9
 		}
-		if ( mdata(MDATA_TILESET) == MAP_TILESET_EASTERN ) {
+		if ( mTileSet == MAP_TILESET_EASTERN ) {
 			tilep = 3
 		}
-		if ( mdata(MDATA_TILESET) == MAP_TILESET_HOME ) {
+		if ( mTileSet == MAP_TILESET_HOME ) {
 			tilep = 8
 		}
-		if ( mdata(MDATA_TILESET) == MAP_TILESET_SF ) {
+		if ( mTileSet == MAP_TILESET_SF ) {
 			tilep = 14
 		}
 		snd SOUNDLIST_BUILD1
-		mdata(MDATA_TILESET) = tilep
-		adata(ADATA_TILESET, gdata(GDATA_AREA)) = tilep
+		mTileSet = tilep
+		areaTileSet(gArea) = tilep
 		if ( tilep == 9 ) {
 			txtef COLOR_GREEN
 			txt lang("和風な扉が生成されるようになった。", "You changed door to Japan type.")
 		}
 		if ( tilep == 3 ) {
@@ -1305,44 +1305,44 @@
 			txtef COLOR_GREEN
 			txt lang("片開きの扉が生成されるようになった。", "You changed door to EW type.")
 		}
 		txtef COLOR_GREEN
 		txt lang("変更を完全に適用するにはマップに入りなおす必要がある。", "You have to enter map again to apply changes.")
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 16 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
-		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) == 0 ) {
+		if ( areaTileFile(gArea) == 0 ) {
 			tilep = 1
 		}
-		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) == 1 ) {
+		if ( areaTileFile(gArea) == 1 ) {
 			tilep = 2
 		}
-		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) == 2 ) {
+		if ( areaTileFile(gArea) == 2 ) {
 			tilep = 3
 		}
-		if ( adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) == 3 ) {
+		if ( areaTileFile(gArea) == 3 ) {
 			tilep = 0
 		}
 		snd SOUNDLIST_BUILD1
-		mdata(MDATA_TILE_FILE) = tilep
-		adata(ADATA_TILE_FILE, gdata(GDATA_AREA)) = tilep
-		if ( mdata(MDATA_TILE_FILE) == 0 ) {
+		mTileFile = tilep
+		areaTileFile(gArea) = tilep
+		if ( mTileFile == 0 ) {
 			txtef COLOR_GREEN
 			txt lang("タイルグループをmap0に変更した。", "You changed tile group map0.")
 		}
-		if ( mdata(MDATA_TILE_FILE) == 1 ) {
+		if ( mTileFile == 1 ) {
 			txtef COLOR_GREEN
 			txt lang("タイルグループをmap1に変更した。", "You changed tile group map1.")
 		}
-		if ( mdata(MDATA_TILE_FILE) == 2 ) {
+		if ( mTileFile == 2 ) {
 			txtef COLOR_GREEN
 			txt lang("タイルグループをmap2に変更した。", "You changed tile group map2.")
 		}
-		if ( mdata(MDATA_TILE_FILE) == 3 ) {
+		if ( mTileFile == 3 ) {
 			txtef COLOR_GREEN
 			txt lang("タイルグループをmap3に変更した。", "You changed tile group map3.")
 		}
 		txtef COLOR_GREEN
 		txt lang("変更を完全に適用するにはマップに入りなおす必要がある。", "You have to enter map again to apply changes.")
@@ -1344,132 +1344,132 @@
 			txtef COLOR_GREEN
 			txt lang("タイルグループをmap3に変更した。", "You changed tile group map3.")
 		}
 		txtef COLOR_GREEN
 		txt lang("変更を完全に適用するにはマップに入りなおす必要がある。", "You have to enter map again to apply changes.")
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 9 | _switch_sw ) {
 		_switch_sw = 0
-		if ( adata(ADATA_ICON, gdata(GDATA_AREA)) < xy2pic(0, 10) | adata(ADATA_ICON, gdata(GDATA_AREA)) > xy2pic(32, 10) ) {
-			adata(ADATA_ICON_ORG, gdata(GDATA_AREA)) = adata(ADATA_ICON, gdata(GDATA_AREA))
+		if ( areaIcon(gArea) < xy2pic(0, 10) | areaIcon(gArea) > xy2pic(32, 10) ) {
+			adata(ADATA_ICON_ORG, gArea) = areaIcon(gArea)
 		}
 		txtef COLOR_YELLOW
 		txt lang("対応する画像の番号は？（1〜33で入力。0を入力するとデフォルトに。）", "Input the number of map_ . (1-33) / If input 0, undo.")
 		val = (windoww - 100) / 2 + inf_screenx, winposy(90), 5, 0, 0
 		inputlog = ""
 		gosub *prompt_word
 		if ( inputlog == "0" ) {
-			if ( adata(ADATA_ICON_ORG, gdata(GDATA_AREA)) != 0 ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = adata(ADATA_ICON_ORG, gdata(GDATA_AREA))
+			if ( adata(ADATA_ICON_ORG, gArea) != 0 ) {
+				areaIcon(gArea) = adata(ADATA_ICON_ORG, gArea)
 				txtef COLOR_GREEN
 				txt lang("元の外装に戻した。", "You put back the original graphic.")
 			}
 			sekaikousin = 100
 		}
 		else {
 			if ( inputlog == "1" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(0, 10)
+				areaIcon(gArea) = xy2pic(0, 10)
 			}
 			if ( inputlog == "2" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(1, 10)
+				areaIcon(gArea) = xy2pic(1, 10)
 			}
 			if ( inputlog == "3" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(2, 10)
+				areaIcon(gArea) = xy2pic(2, 10)
 			}
 			if ( inputlog == "4" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(3, 10)
+				areaIcon(gArea) = xy2pic(3, 10)
 			}
 			if ( inputlog == "5" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(4, 10)
+				areaIcon(gArea) = xy2pic(4, 10)
 			}
 			if ( inputlog == "6" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(5, 10)
+				areaIcon(gArea) = xy2pic(5, 10)
 			}
 			if ( inputlog == "7" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(6, 10)
+				areaIcon(gArea) = xy2pic(6, 10)
 			}
 			if ( inputlog == "8" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(7, 10)
+				areaIcon(gArea) = xy2pic(7, 10)
 			}
 			if ( inputlog == "9" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(8, 10)
+				areaIcon(gArea) = xy2pic(8, 10)
 			}
 			if ( inputlog == "10" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(9, 10)
+				areaIcon(gArea) = xy2pic(9, 10)
 			}
 			if ( inputlog == "11" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(10, 10)
+				areaIcon(gArea) = xy2pic(10, 10)
 			}
 			if ( inputlog == "12" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(11, 10)
+				areaIcon(gArea) = xy2pic(11, 10)
 			}
 			if ( inputlog == "13" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(12, 10)
+				areaIcon(gArea) = xy2pic(12, 10)
 			}
 			if ( inputlog == "14" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(13, 10)
+				areaIcon(gArea) = xy2pic(13, 10)
 			}
 			if ( inputlog == "15" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(14, 10)
+				areaIcon(gArea) = xy2pic(14, 10)
 			}
 			if ( inputlog == "16" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(15, 10)
+				areaIcon(gArea) = xy2pic(15, 10)
 			}
 			if ( inputlog == "17" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(16, 10)
+				areaIcon(gArea) = xy2pic(16, 10)
 			}
 			if ( inputlog == "18" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(17, 10)
+				areaIcon(gArea) = xy2pic(17, 10)
 			}
 			if ( inputlog == "19" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(18, 10)
+				areaIcon(gArea) = xy2pic(18, 10)
 			}
 			if ( inputlog == "20" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(19, 10)
+				areaIcon(gArea) = xy2pic(19, 10)
 			}
 			if ( inputlog == "21" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(20, 10)
+				areaIcon(gArea) = xy2pic(20, 10)
 			}
 			if ( inputlog == "22" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(21, 10)
+				areaIcon(gArea) = xy2pic(21, 10)
 			}
 			if ( inputlog == "23" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(22, 10)
+				areaIcon(gArea) = xy2pic(22, 10)
 			}
 			if ( inputlog == "24" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(23, 10)
+				areaIcon(gArea) = xy2pic(23, 10)
 			}
 			if ( inputlog == "25" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(24, 10)
+				areaIcon(gArea) = xy2pic(24, 10)
 			}
 			if ( inputlog == "26" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(25, 10)
+				areaIcon(gArea) = xy2pic(25, 10)
 			}
 			if ( inputlog == "27" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(26, 10)
+				areaIcon(gArea) = xy2pic(26, 10)
 			}
 			if ( inputlog == "28" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(27, 10)
+				areaIcon(gArea) = xy2pic(27, 10)
 			}
 			if ( inputlog == "29" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(28, 10)
+				areaIcon(gArea) = xy2pic(28, 10)
 			}
 			if ( inputlog == "30" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(29, 10)
+				areaIcon(gArea) = xy2pic(29, 10)
 			}
 			if ( inputlog == "31" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(30, 10)
+				areaIcon(gArea) = xy2pic(30, 10)
 			}
 			if ( inputlog == "32" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(31, 10)
+				areaIcon(gArea) = xy2pic(31, 10)
 			}
 			if ( inputlog == "33" ) {
-				adata(ADATA_ICON, gdata(GDATA_AREA)) = xy2pic(32, 10)
+				areaIcon(gArea) = xy2pic(32, 10)
 			}
-			if ( adata(ADATA_ICON, gdata(GDATA_AREA)) >= xy2pic(0, 10) & adata(ADATA_ICON, gdata(GDATA_AREA)) <= xy2pic(32, 10) ) {
+			if ( areaIcon(gArea) >= xy2pic(0, 10) & areaIcon(gArea) <= xy2pic(32, 10) ) {
 				snd SOUNDLIST_DING2
 				sekaikousin = 100
 			}
 		}
 		goto *pc_turn
@@ -1471,31 +1471,31 @@
 				snd SOUNDLIST_DING2
 				sekaikousin = 100
 			}
 		}
 		goto *pc_turn
-		goto *label_4602
+		goto *label_4609
 		_switch_sw++
 	}
 	if ( _switch_val == 6 | _switch_sw ) {
 		_switch_sw = 0
 		txtnew
 		p = 0
 		repeat 245 - 57, 57
-			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE | cdata(CDATA_EXIST, cnt) == CHAR_STATE_SPIRIT ) {
-				if ( cdata(CDATA_ROLE, cnt) != ROLE_NONE ) {
+			if ( cExist(cnt) == CHAR_STATE_ALIVE | cExist(cnt) == CHAR_STATE_SPIRIT ) {
+				if ( cRole(cnt) != ROLE_NONE ) {
 					p++
 				}
 			}
 		loop
-		if ( p >= gdata(GDATA_HOME_LEVEL) + 2 ) {
+		if ( p >= gHomeLevel + 2 ) {
 			txt lang("家はすでに人であふれかえっている。", "You already have too many guests in your home.")
-			goto *label_4602
+			goto *label_4609
 		}
 		repeat 10
 			if ( 0 == 0 ) {
-				randomize gdata(GDATA_DAY) + cnt
+				randomize gDay + cnt
 			}
 			if ( rnd(2) ) {
 				continue
 			}
 			if ( cnt == 0 ) {
@@ -1504,55 +1504,55 @@
 			else {
 				hire = rnd(length(isethire))
 			}
 			dbid = isethire(hire)
 			if ( 0 == 0 ) {
-				randomize gdata(GDATA_DAY) + cnt
+				randomize gDay + cnt
 			}
 			flt 20
 			characreate -1, dbid, -3, 0
 			if ( stat == 0 ) {
 				continue
 			}
-			cdata(CDATA_EXIST, rc) = CHAR_STATE_TEMP
-			cdata(CDATA_ROLE, rc) = isethirerole(hire)
-			if ( cdata(CDATA_ID, rc) == CREATURE_ID_SHOPKEEPER ) {
+			cExist(rc) = CHAR_STATE_TEMP
+			cRole(rc) = isethirerole(hire)
+			if ( cId(rc) == CREATURE_ID_SHOPKEEPER ) {
 				p = rnd(6)
 				if ( p == 0 ) {
-					cdata(CDATA_ROLE, rc) = ROLE_SHOP_ARMOR
-					cdatan(CDATAN_NAME, rc) = lang("武具店の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of armory")
+					cRole(rc) = ROLE_SHOP_ARMOR
+					cnName(rc) = lang("武具店の" + cnName(rc), cnName(rc) + " of armory")
 				}
 				if ( p == 1 ) {
-					cdata(CDATA_ROLE, rc) = ROLE_SHOP_GENERAL
-					cdatan(CDATAN_NAME, rc) = lang("雑貨屋の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of general store")
+					cRole(rc) = ROLE_SHOP_GENERAL
+					cnName(rc) = lang("雑貨屋の" + cnName(rc), cnName(rc) + " of general store")
 				}
 				if ( p == 2 ) {
-					cdata(CDATA_ROLE, rc) = ROLE_SHOP_MAGIC
-					cdatan(CDATAN_NAME, rc) = lang("魔法店の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of magic store")
+					cRole(rc) = ROLE_SHOP_MAGIC
+					cnName(rc) = lang("魔法店の" + cnName(rc), cnName(rc) + " of magic store")
 				}
 				if ( p == 3 ) {
-					cdata(CDATA_ROLE, rc) = ROLE_SHOP_GOODS
-					cdatan(CDATAN_NAME, rc) = lang("何でも屋の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of goods store")
+					cRole(rc) = ROLE_SHOP_GOODS
+					cnName(rc) = lang("何でも屋の" + cnName(rc), cnName(rc) + " of goods store")
 				}
 				if ( p == 4 ) {
-					cdata(CDATA_ROLE, rc) = ROLE_SHOP_ARMOR
-					cdatan(CDATAN_NAME, rc) = lang("武具店の" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of armory")
+					cRole(rc) = ROLE_SHOP_ARMOR
+					cnName(rc) = lang("武具店の" + cnName(rc), cnName(rc) + " of armory")
 				}
 				if ( p == 5 ) {
-					cdata(CDATA_ROLE, rc) = ROLE_SHOP_BLACKMARKET
-					cdatan(CDATAN_NAME, rc) = lang("ブラックマーケットの" + cdatan(CDATAN_NAME, rc), cdatan(CDATAN_NAME, rc) + " of blackmarket")
+					cRole(rc) = ROLE_SHOP_BLACKMARKET
+					cnName(rc) = lang("ブラックマーケットの" + cnName(rc), cnName(rc) + " of blackmarket")
 				}
 				randomize
-				cdata(CDATA_ROLE_SHOP_LEVEL, rc) = rnd(15) + 1
+				cRoleShopLv(rc) = rnd(15) + 1
 			}
 			cnt2 = cnt
 			repeat 245 - 57, 57
 				if ( cnt == rc ) {
 					continue
 				}
-				if ( cdatan(CDATAN_NAME, cnt) == cdatan(CDATAN_NAME, rc) ) {
-					if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_DEAD ) {
+				if ( cnName(cnt) == cnName(rc) ) {
+					if ( cExist(cnt) != CHAR_STATE_DEAD ) {
 						chara_vanquish rc
 					}
 				}
 			loop
 		loop
@@ -1562,33 +1562,33 @@
 		allyctrl = 1
 		gosub *com_listNpc
 		if ( stat != (-1) ) {
 			tc = stat
 			txtnew
-			if ( cdata(CDATA_GOLD, CHARA_PLAYER) < calchirecost(tc) * 20 ) {
+			if ( cGold(CHARA_PLAYER) < calchirecost(tc) * 20 ) {
 				txt lang("お金が足りない…", "You dont't have enough money...")
 			}
 			else {
 				snd SOUNDLIST_PAYGOLD1
-				cdata(CDATA_GOLD, CHARA_PLAYER) -= calchirecost(tc) * 20
+				cGold(CHARA_PLAYER) -= calchirecost(tc) * 20
 				await 250
-				cdata(CDATA_EXIST, tc) = CHAR_STATE_ALIVE
+				cExist(tc) = CHAR_STATE_ALIVE
 				txtef COLOR_GREEN
-				txt lang(cdatan(CDATAN_NAME, tc) + "を家に迎えた。", "You hire " + cdatan(CDATAN_NAME, tc) + ".")
+				txt lang(cnName(tc) + "を家に迎えた。", "You hire " + cnName(tc) + ".")
 				snd SOUNDLIST_PRAY1
 			}
 		}
 		repeat 245
-			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_TEMP ) {
+			if ( cExist(cnt) == CHAR_STATE_TEMP ) {
 				chara_vanquish cnt
 			}
 		loop
 		calccosthire
-		goto *label_4602
+		goto *label_4609
 	}
 
-*label_4602
+*label_4609
 	tlocinitx = 0
 	tlocinity = 0
 	screenupdate = -1
 	gosub *screen_draw
 	goto *com_home
@@ -1604,20 +1604,20 @@
 		if ( f == 0 ) {
 			continue
 		}
 		f = 1
 		pget cnt \ 33 * 48, cnt / 33 * 48
-		if ( mdata(MDATA_TILE_FILE) != 2 | cnt >= 297 ) {
+		if ( mTileFile != 2 | cnt >= 297 ) {
 			if ( ginfo(16) == 0 ) {
 				if ( ginfo(17) == 0 ) {
 					if ( ginfo(18) == 0 ) {
 						f = 0
 					}
 				}
 			}
 		}
-		if ( mdata(MDATA_TILE_FILE) == 1 & cnt == 267 ) {
+		if ( mTileFile == 1 & cnt == 267 ) {
 			f = 0
 		}
 		if ( chipm(CHIPM_ROLE, cnt) == MAP_CHIP_ROLE_CROP ) {
 			f = 0
 		}
@@ -1629,11 +1629,11 @@
 		}
 		if ( f ) {
 			list(0, p) = cnt
 			p++
 		}
-		if ( mdata(MDATA_TILE_FILE) == 3 ) {
+		if ( mTileFile == 3 ) {
 			if ( chipm(CHIPM_ANIM, cnt) != 0 ) {
 				continue cnt + chipm(CHIPM_ANIM, cnt)
 			}
 		}
 	loop
@@ -1643,19 +1643,19 @@
 
 *shop_turn
 	area = -1
 	midbk = mid
 	repeat 450 - 300, 300
-		if ( adata(ADATA_ID, cnt) == AREA_SHOP ) {
+		if ( areaId(cnt) == AREA_SHOP ) {
 			area = cnt
 			mid = "" + area + "_" + (100 + 1)
 			gosub *shop_turn_main
 		}
 	loop
 	mid = midbk
-	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
-		worker = getworker(gdata(GDATA_AREA))
+	if ( areaId(gArea) == AREA_SHOP ) {
+		worker = getworker(gArea)
 		if ( worker != (-1) ) {
 			gosub *shop_update
 		}
 	}
 	return
@@ -1668,20 +1668,20 @@
 		return
 	}
 	sold = 0
 	income = 0, 0
 	listmax = 0
-	shoplv = 100 - gdata(GDATA_RANK_SHOP) / 100
+	shoplv = 100 - gRankShop / 100
 	customer = 0
 	repeat 3
 		customer += rnd(shoplv / 3 + 5)
 	loop
-	customer = customer * (80 + sdata(SKILL_ATTR_CHA, worker) * 3 / 2) / 100
+	customer = customer * (80 + sCHR(worker) * 3 / 2) / 100
 	if ( customer < 1 ) {
 		customer = 1
 	}
-	if ( gdata(GDATA_AREA) != area ) {
+	if ( gArea != area ) {
 		file = "shoptmp.s2"
 		fmode = 4
 		gosub *game_ctrlFile
 		file = "inv_" + mid + ".s2"
 		fmode = 3
@@ -1689,54 +1689,54 @@
 	}
 	mode = MODELIST_SHOP
 	dblistmax = 0
 	inv_getheader -1
 	repeat invrange, invhead
-		if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+		if ( iNum(cnt) <= 0 ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_SHOP_STRONGBOX ) {
+		if ( iID(cnt) == ITEM_ID_SHOP_STRONGBOX ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_REGISTER ) {
+		if ( iID(cnt) == ITEM_ID_REGISTER ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_YACA_POINT_CARD ) {
+		if ( iID(cnt) == ITEM_ID_YACA_POINT_CARD ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_RED_BOOK ) {
+		if ( iID(cnt) == ITEM_ID_RED_BOOK ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_GOLD_PIECE ) {
+		if ( iID(cnt) == ITEM_ID_GOLD_PIECE ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_SHELTER ) {
+		if ( iID(cnt) == ITEM_ID_SHELTER ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_DEED ) {
+		if ( iID(cnt) == ITEM_ID_DEED ) {
 			continue
 		}
-		if ( inv(INV_ITEM_WEIGHT, cnt) < 0 ) {
+		if ( iWeight(cnt) < 0 ) {
 			continue
 		}
-		if ( inv(INV_ITEM_QUALITY, cnt) >= FIX_QUALITY_UNIQUE ) {
+		if ( iQuality(cnt) >= FIX_QUALITY_UNIQUE ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_ROD_WISHING ) {
+		if ( iID(cnt) == ITEM_ID_ROD_WISHING ) {
 			continue
 		}
 		if ( inv(INV_ITEM_SHOP_SAMPLE, cnt) == 100 ) {
 			continue
 		}
-		if ( area == gdata(GDATA_AREA) ) {
-			if ( chipm(CHIPM_ROLE, map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_TILE_ID)) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
+		if ( area == gArea ) {
+			if ( chipm(CHIPM_ROLE, mapId(iX(cnt), iY(cnt))) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
 				continue
 			}
 		}
-		a = refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE)
-		if ( adata(ADATA_SHOP_TYPE, area) != SHOP_TYPE_DECORATIVE_ARTS ) {
-			if ( a == 60000 & inv(INV_ITEM_ID, cnt) != ITEM_ID_WILD_FLOWER ) {
+		a = refitem(iID(cnt), DBSPEC_TYPE)
+		if ( areaShopType(area) != SHOP_TYPE_DECORATIVE_ARTS ) {
+			if ( a == 60000 & iID(cnt) != ITEM_ID_WILD_FLOWER ) {
 				continue
 			}
 		}
 		dblist(0, dblistmax) = cnt, a
 		dblistmax++
@@ -1747,151 +1747,151 @@
 		}
 		p = rnd(dblistmax)
 		ci = dblist(0, p)
 		a = dblist(1, p)
 		val = calcitemvalue(ci, 2)
-		val = val * int(10 + sqrt(sdata(SKILL_NORMAL_NEGOTIATION, worker) * 200)) / 100 + 10
+		val = val * int(10 + sqrt(sTrade(worker) * 200)) / 100 + 10
 		if ( limitvalue > 0 ) {
 			if ( val > limitvalue ) {
 				val = limitvalue
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_FOOD ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
+		if ( areaShopType(area) == SHOP_TYPE_FOOD ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
 				val = val * 6 / 5
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_MAGIC ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_SCROLL | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_SPELLBOOK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_ROD | inv(INV_ITEM_ID, ci) == ITEM_ID_OHUDA ) {
+		if ( areaShopType(area) == SHOP_TYPE_MAGIC ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) == FILTER_ITEM_SCROLL | refitem(iID(ci), DBSPEC_TYPE) == FILTER_ITEM_SPELLBOOK | refitem(iID(ci), DBSPEC_TYPE) == FILTER_ITEM_ROD | iID(ci) == ITEM_ID_OHUDA ) {
 				val = val * 6 / 5
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_BLACKSMITH ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_WEAPON | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_RANGE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_AMMO | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_HELM | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ARMOR | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_CLOAK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_GIRDLE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_BOOTS | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_GLOVES | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_SHIELD | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ACCESSORY_RING | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ACCESSORY_AMULET ) {
+		if ( areaShopType(area) == SHOP_TYPE_BLACKSMITH ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) == FILTER_WEAPON | refitem(iID(ci), DBSPEC_TYPE) == FILTER_RANGE | refitem(iID(ci), DBSPEC_TYPE) == FILTER_AMMO | refitem(iID(ci), DBSPEC_TYPE) == FILTER_HELM | refitem(iID(ci), DBSPEC_TYPE) == FILTER_ARMOR | refitem(iID(ci), DBSPEC_TYPE) == FILTER_CLOAK | refitem(iID(ci), DBSPEC_TYPE) == FILTER_GIRDLE | refitem(iID(ci), DBSPEC_TYPE) == FILTER_BOOTS | refitem(iID(ci), DBSPEC_TYPE) == FILTER_GLOVES | refitem(iID(ci), DBSPEC_TYPE) == FILTER_SHIELD | refitem(iID(ci), DBSPEC_TYPE) == FILTER_ACCESSORY_RING | refitem(iID(ci), DBSPEC_TYPE) == FILTER_ACCESSORY_AMULET ) {
 				val = val * 6 / 5
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_INN ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_CONTAINER | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_POTION ) {
+		if ( areaShopType(area) == SHOP_TYPE_INN ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) == FILTER_CONTAINER | refitem(iID(ci), DBSPEC_TYPE) == FILTER_ITEM_POTION ) {
 				val = val * 6 / 5
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_DECORATIVE_ARTS ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ENVIRONMENT | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE_WELL | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE_ALTAR ) {
+		if ( areaShopType(area) == SHOP_TYPE_DECORATIVE_ARTS ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) == FILTER_ENVIRONMENT | refitem(iID(ci), DBSPEC_TYPE) == FILTER_FURNITURE | refitem(iID(ci), DBSPEC_TYPE) == FILTER_FURNITURE_WELL | refitem(iID(ci), DBSPEC_TYPE) == FILTER_FURNITURE_ALTAR ) {
 				val = val * 6 / 5
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_JUNK ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_JUNK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_REMAINS | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_TOOL ) {
+		if ( areaShopType(area) == SHOP_TYPE_JUNK ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) == FILTER_JUNK | refitem(iID(ci), DBSPEC_TYPE) == FILTER_REMAINS | refitem(iID(ci), DBSPEC_TYPE) == FILTER_ITEM_TOOL ) {
 				val = val * 6 / 5
 			}
 		}
 		if ( val <= 1 ) {
 			continue
 		}
 		if ( rnd(val) > shoplv * 100 + 500 ) {
 			continue
 		}
-		if ( inv(INV_ITEM_NUM, ci) <= 0 ) {
+		if ( iNum(ci) <= 0 ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_YACA_POINT_CARD ) {
+		if ( iID(ci) == ITEM_ID_YACA_POINT_CARD ) {
 			continue
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_GOODS ) {
+		if ( areaShopType(area) == SHOP_TYPE_GOODS ) {
 			if ( rnd(8) ) {
 				continue
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_FOOD ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_FOOD ) {
+		if ( areaShopType(area) == SHOP_TYPE_FOOD ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) != FILTER_ITEM_FOOD ) {
 				if ( rnd(5) ) {
 					continue
 				}
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_MAGIC ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_SCROLL & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_SPELLBOOK & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_ROD & inv(INV_ITEM_ID, ci) != ITEM_ID_OHUDA ) {
+		if ( areaShopType(area) == SHOP_TYPE_MAGIC ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) != FILTER_ITEM_SCROLL & refitem(iID(ci), DBSPEC_TYPE) != FILTER_ITEM_SPELLBOOK & refitem(iID(ci), DBSPEC_TYPE) != FILTER_ITEM_ROD & iID(ci) != ITEM_ID_OHUDA ) {
 				if ( rnd(5) ) {
 					continue
 				}
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_BLACKSMITH ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_WEAPON & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_RANGE & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_AMMO & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_HELM & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ARMOR & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_CLOAK & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_GIRDLE & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_BOOTS & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_GLOVES & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_SHIELD & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ACCESSORY_RING & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ACCESSORY_AMULET ) {
+		if ( areaShopType(area) == SHOP_TYPE_BLACKSMITH ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) != FILTER_WEAPON & refitem(iID(ci), DBSPEC_TYPE) != FILTER_RANGE & refitem(iID(ci), DBSPEC_TYPE) != FILTER_AMMO & refitem(iID(ci), DBSPEC_TYPE) != FILTER_HELM & refitem(iID(ci), DBSPEC_TYPE) != FILTER_ARMOR & refitem(iID(ci), DBSPEC_TYPE) != FILTER_CLOAK & refitem(iID(ci), DBSPEC_TYPE) != FILTER_GIRDLE & refitem(iID(ci), DBSPEC_TYPE) != FILTER_BOOTS & refitem(iID(ci), DBSPEC_TYPE) != FILTER_GLOVES & refitem(iID(ci), DBSPEC_TYPE) != FILTER_SHIELD & refitem(iID(ci), DBSPEC_TYPE) != FILTER_ACCESSORY_RING & refitem(iID(ci), DBSPEC_TYPE) != FILTER_ACCESSORY_AMULET ) {
 				if ( rnd(5) ) {
 					continue
 				}
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_INN ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_CONTAINER & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_POTION ) {
+		if ( areaShopType(area) == SHOP_TYPE_INN ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) != FILTER_CONTAINER & refitem(iID(ci), DBSPEC_TYPE) != FILTER_ITEM_POTION ) {
 				if ( rnd(5) ) {
 					continue
 				}
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_DECORATIVE_ARTS ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ENVIRONMENT & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_FURNITURE & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_FURNITURE_WELL & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_FURNITURE_ALTAR ) {
+		if ( areaShopType(area) == SHOP_TYPE_DECORATIVE_ARTS ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) != FILTER_ENVIRONMENT & refitem(iID(ci), DBSPEC_TYPE) != FILTER_FURNITURE & refitem(iID(ci), DBSPEC_TYPE) != FILTER_FURNITURE_WELL & refitem(iID(ci), DBSPEC_TYPE) != FILTER_FURNITURE_ALTAR ) {
 				if ( rnd(5) ) {
 					continue
 				}
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) == SHOP_TYPE_JUNK ) {
-			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_JUNK & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_REMAINS & refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_TOOL ) {
+		if ( areaShopType(area) == SHOP_TYPE_JUNK ) {
+			if ( refitem(iID(ci), DBSPEC_TYPE) != FILTER_JUNK & refitem(iID(ci), DBSPEC_TYPE) != FILTER_REMAINS & refitem(iID(ci), DBSPEC_TYPE) != FILTER_ITEM_TOOL ) {
 				if ( rnd(5) ) {
 					continue
 				}
 			}
 		}
-		if ( adata(ADATA_SHOP_TYPE, area) != SHOP_TYPE_GOODS ) {
+		if ( areaShopType(area) != SHOP_TYPE_GOODS ) {
 			if ( rnd(2) ) {
 				continue
 			}
 		}
-		in = rnd(inv(INV_ITEM_NUM, ci)) + 1
+		in = rnd(iNum(ci)) + 1
 		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 1 ) {
 			if ( in + sold > 15 ) {
 				in = 15 - sold
 			}
 		}
 		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 2 ) {
 			if ( in + sold > 5 ) {
 				in = 5 - sold
 			}
 		}
-		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_PRODUCED_BOOK ) {
-			if ( inv(INV_ITEM_PARAM2, ci) == 0 ) {
-				bookfame = (inv(INV_ITEM_PARAM3, ci) + 5) * in
-				cdata(CDATA_FAME, CHARA_PLAYER) += bookfame
+		if ( iID(ci) == ITEM_ID_PRODUCED_BOOK ) {
+			if ( iParam2(ci) == 0 ) {
+				bookfame = (iParam3(ci) + 5) * in
+				cFame(CHARA_PLAYER) += bookfame
 				if ( 0 ) {
 					txtef COLOR_GREEN
 					txt lang("" + bookfame + "の名声値を手に入れた。", "You gain " + bookfame + " fame.")
 				}
 			}
 		}
-		inv(INV_ITEM_NUM, ci) -= in
+		iNum(ci) -= in
 		sold += in
 		val = val * in
 		if ( rnd(4) == 0 ) {
-			list(0, listmax) = refitem(inv(INV_ITEM_ID, ci), DBSPEC_OBJ_LEVEL), inv(INV_ITEM_QUALITY, ci)
+			list(0, listmax) = refitem(iID(ci), DBSPEC_OBJ_LEVEL), iQuality(ci)
 			listn(0, listmax) = str(a), str(val)
 			listmax++
 		}
 		else {
 			income += val
 		}
-		if ( area == gdata(GDATA_AREA) ) {
+		if ( area == gArea ) {
 			repeat 245
-				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+				if ( cExist(cnt) != CHAR_STATE_ALIVE ) {
 					continue
 				}
-				if ( cdata(CDATA_ROW_ACT, cnt) == ACTION_NONE | cdata(CDATA_ACTION_PERIOD, cnt) == 0 ) {
+				if ( cRowAct(cnt) == ACTION_NONE | cActionPeriod(cnt) == 0 ) {
 					continue
 				}
-				if ( cdata(CDATA_ITEM_USING, cnt) == ci ) {
+				if ( cItemUsing(cnt) == ci ) {
 					rowactend cnt
 				}
 			loop
 		}
 		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) == 1 ) {
@@ -1904,11 +1904,11 @@
 				break
 			}
 		}
 	loop
 	mode = MODELIST_MAIN
-	if ( gdata(GDATA_AREA) != area ) {
+	if ( gArea != area ) {
 		file = "inv_" + mid + ".s2"
 		fmode = 4
 		gosub *game_ctrlFile
 	}
 	else {
@@ -1923,11 +1923,11 @@
 		gosub *game_ctrlFile
 	}
 	else {
 		inv_getheader -1
 		repeat invrange, invhead
-			inv(INV_ITEM_NUM, cnt) = 0
+			iNum(cnt) = 0
 		loop
 	}
 	mode = MODELIST_SHOP
 	if ( income != 0 ) {
 		flt
@@ -1945,17 +1945,17 @@
 			itemcreate -1, ITEM_ID_DUMMY, -1, -1, 0
 			if ( stat == 0 ) {
 				f = 0
 				break
 			}
-			if ( inv(INV_ITEM_VALUE, ci) > int(listn(1, cnt2)) * 2 * (3 + eye) / 3 + 300 * eye ) {
-				yaca += inv(INV_ITEM_VALUE, ci) / 1000
+			if ( iValue(ci) > int(listn(1, cnt2)) * 2 * (3 + eye) / 3 + 300 * eye ) {
+				yaca += iValue(ci) / 1000
 				f = 1
 				break
 			}
 			else {
-				inv(INV_ITEM_NUM, ci) = 0
+				iNum(ci) = 0
 				if ( cnt == 3 ) {
 					f = 0
 					break
 				}
 				else {
@@ -1971,20 +1971,20 @@
 			income(1)++
 		}
 	loop
 	eye = 0
 	yaca += income / 1000 + customer / 10
-	if ( gdata(GDATA_MONTH) == 12 ) {
+	if ( gMonth == 12 ) {
 		yaca *= 5
 	}
-	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
-		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
+	if ( areaId(gArea) == AREA_SHOP ) {
+		autosave = 1 * (gArea != AREA_SHOW_HOUSE)
 	}
 	if ( sold == 0 ) {
 		yaca = 0
 		if ( cfg_hideshopresult == 0 ) {
-			txt lang("[店]" + customer + "人が来客したが、" + cdatan(CDATAN_NAME, worker) + "はアイテムを一つも売れなかった。", "[Shop]" + customer + " customers visited your shop but " + cdatan(CDATAN_NAME, worker) + " couldn't sell any item.")
+			txt lang("[店]" + customer + "人が来客したが、" + cnName(worker) + "はアイテムを一つも売れなかった。", "[Shop]" + customer + " customers visited your shop but " + cnName(worker) + " couldn't sell any item.")
 		}
 	}
 	else {
 		if ( cfg_hideshopresult <= 1 ) {
 			if ( gdata(GDATA_FLAG_YACA_POINTS) >= 100000 ) {
@@ -1995,11 +1995,11 @@
 				s += lang("と" + income(1) + "個のアイテム", " and " + income(1) + " items")
 			}
 			snd SOUNDLIST_DING2
 			txtmore
 			txtef COLOR_YELLOW
-			txt lang("[店]" + customer + "人の来客があり、" + cdatan(CDATAN_NAME, worker) + "は" + sold + "個のアイテムを売却した。" + s + "が売り上げとして金庫に保管された。そして" + yaca + "ヤカポイントを獲得した。", "[Shop]" + customer + " customers visited your shop and " + cdatan(CDATAN_NAME, worker) + " sold " + sold + " items. " + cdatan(CDATAN_NAME, worker) + " put " + s + " in the shop strong box. You got " + yaca + " yaca points.")
+			txt lang("[店]" + customer + "人の来客があり、" + cnName(worker) + "は" + sold + "個のアイテムを売却した。" + s + "が売り上げとして金庫に保管された。そして" + yaca + "ヤカポイントを獲得した。", "[Shop]" + customer + " customers visited your shop and " + cnName(worker) + " sold " + sold + " items. " + cnName(worker) + " put " + s + " in the shop strong box. You got " + yaca + " yaca points.")
 		}
 		skillexp SKILL_NORMAL_NEGOTIATION, worker, limit(int(sqrt(income)) * 10, 25, 2000) * (adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), area) + 2) / 2
 		cdata(CDATA_SALES_EXP, worker)++
 		if ( 0 ) {
 			cdata(CDATA_SALES_EXP, worker) += 360
@@ -2007,31 +2007,31 @@
 		gdata(GDATA_FLAG_YACA_POINTS) += yaca
 		if ( gdata(GDATA_FLAG_YACA_POINTS) >= 100000 ) {
 			gdata(GDATA_FLAG_YACA_POINTS) = 100000
 		}
 	}
-	if ( sold > (110 - gdata(GDATA_RANK_SHOP) / 100) / 10 ) {
+	if ( sold > (110 - gRankShop / 100) / 10 ) {
 		modrank 5, 30, 2
 	}
 	if ( cbit(CHARA_BIT_SHOP_SALES_ROUTE, worker) ) {
-		dokuzi = sdata(SKILL_NORMAL_NEGOTIATION, worker) * 5 + sdata(SKILL_NORMAL_NEGOTIATION, worker) * rnd(6)
-		if ( gdata(GDATA_AREA) == AREA_VALM ) {
-			if ( gdata(GDATA_LEVEL) == 3 ) {
+		dokuzi = sTrade(worker) * 5 + sTrade(worker) * rnd(6)
+		if ( gArea == AREA_VALM ) {
+			if ( gLevel == 3 ) {
 				dokuzi = 1
 			}
 		}
 		flt
 		itemcreate -1, ITEM_ID_GOLD_PIECE, -1, -1, dokuzi
 		yaca = dokuzi / 100
-		if ( gdata(GDATA_MONTH) == 12 ) {
+		if ( gMonth == 12 ) {
 			yaca *= 5
 		}
 		if ( gdata(GDATA_FLAG_YACA_POINTS) >= 100000 ) {
 			yaca = 0
 		}
 		txtef COLOR_YELLOW
-		txt lang("[店]" + cdatan(CDATAN_NAME, worker) + "は独自に" + dokuzi + "gold稼ぎ、金庫に保管した。そして" + yaca + "ヤカポイントを獲得した。", "[Shop]" + customer + " customers visited your shop and " + cdatan(CDATAN_NAME, worker) + " sold " + sold + " items. " + cdatan(CDATAN_NAME, worker) + " put " + s + " in the shop strong box. You got " + yaca + " yaca points.")
+		txt lang("[店]" + cnName(worker) + "は独自に" + dokuzi + "gold稼ぎ、金庫に保管した。そして" + yaca + "ヤカポイントを獲得した。", "[Shop]" + customer + " customers visited your shop and " + cnName(worker) + " sold " + sold + " items. " + cnName(worker) + " put " + s + " in the shop strong box. You got " + yaca + " yaca points.")
 		dokuzi = 0
 		gdata(GDATA_FLAG_YACA_POINTS) += yaca
 		if ( gdata(GDATA_FLAG_YACA_POINTS) >= 100000 ) {
 			gdata(GDATA_FLAG_YACA_POINTS) = 100000
 		}
@@ -2044,26 +2044,26 @@
 	fmode = 3
 	gosub *game_ctrlFile
 	return
 
 *shop_update
-	mdata(MDATA_MODERATE_CROWD) = (100 - gdata(GDATA_RANK_SHOP) / 100) / 4 + 1
+	mModerateCrowd = (100 - gRankShop / 100) / 4 + 1
 	inv_getheader -1
-	repeat mdata(MDATA_HEIGHT)
+	repeat mHeight
 		y = cnt
-		repeat mdata(MDATA_WIDTH)
-			map(cnt, y, MAP_ITEM_CHIPS) = 0
-			map(cnt, y, MAP_LIGHT_TYPE) = 0
+		repeat mWidth
+			mapItems(cnt, y) = 0
+			mapLight(cnt, y) = 0
 		loop
 	loop
 	repeat invrange, invhead
-		if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+		if ( iNum(cnt) <= 0 ) {
 			continue
 		}
-		x = inv(INV_ITEM_X, cnt)
-		y = inv(INV_ITEM_Y, cnt)
-		if ( x < 0 | x >= mdata(MDATA_WIDTH) | y < 0 | y >= mdata(MDATA_HEIGHT) ) {
+		x = iX(cnt)
+		y = iY(cnt)
+		if ( x < 0 | x >= mWidth | y < 0 | y >= mHeight ) {
 			continue
 		}
 		cell_refresh x, y
 	loop
 	return
@@ -2071,122 +2071,122 @@
 *museum_value
 	rc = MAX_CHARA_NC
 	fixlv = FIX_QUALITY_GOOD
 	dbmode = DBMODE_SET
 	gosub *db_creature
-	dblist(val, cdata(CDATA_ID, MAX_CHARA_NC))++
+	dblist(val, cId(MAX_CHARA_NC))++
 	if ( fixlv == FIX_QUALITY_UNIQUE ) {
-		rtval = 70 + cdata(CDATA_LEVEL, MAX_CHARA_NC)
+		rtval = 70 + cLevel(MAX_CHARA_NC)
 	}
 	else {
-		rtval = cdata(CDATA_LEVEL, MAX_CHARA_NC) / 10 + 2
-		if ( chipc(CHIPC_HEIGHT, cdata(CDATA_PIC, MAX_CHARA_NC) \ 1000) > inf_tiles ) {
+		rtval = cLevel(MAX_CHARA_NC) / 10 + 2
+		if ( chipc(CHIPC_HEIGHT, cPic(MAX_CHARA_NC) \ 1000) > inf_tiles ) {
 			rtval = rtval / 2 * 3 + 40
 		}
-		p = refchara(cdata(CDATA_ID, MAX_CHARA_NC), DBSPEC_CHARA_RARE)
+		p = refchara(cId(MAX_CHARA_NC), DBSPEC_CHARA_RARE)
 		if ( p < 80 ) {
 			rtval = rtval + 80 - p
 		}
 	}
-	if ( dblist(val, cdata(CDATA_ID, MAX_CHARA_NC)) > 1 ) {
+	if ( dblist(val, cId(MAX_CHARA_NC)) > 1 ) {
 		rtval /= 3
 		if ( rtval > 15 ) {
 			rtval = 15
 		}
 	}
 	return
 
-*museum_unique_level
+*label_4627
 	rtval = 0
 	rc = MAX_CHARA_NC
 	fixlv = FIX_QUALITY_GOOD
 	dbmode = DBMODE_SET
 	gosub *db_creature
-	dblist(val, cdata(CDATA_ID, MAX_CHARA_NC))++
-	if ( fixlv == FIX_QUALITY_UNIQUE | cdata(CDATA_ID, MAX_CHARA_NC) == CREATURE_ID_AILE_THE_ATTENDANT | cdata(CDATA_ID, MAX_CHARA_NC) == CREATURE_ID_LEND_THE_TAKER | cdata(CDATA_ID, MAX_CHARA_NC) == CREATURE_ID_MOYER_THE_CROOKED ) {
-		rtval = cdata(CDATA_LEVEL, MAX_CHARA_NC)
+	dblist(val, cId(MAX_CHARA_NC))++
+	if ( fixlv == FIX_QUALITY_UNIQUE | cId(MAX_CHARA_NC) == CREATURE_ID_AILE_THE_ATTENDANT | cId(MAX_CHARA_NC) == CREATURE_ID_LEND_THE_TAKER | cId(MAX_CHARA_NC) == CREATURE_ID_MOYER_THE_CROOKED ) {
+		rtval = cLevel(MAX_CHARA_NC)
 	}
-	if ( cdata(CDATA_LEVEL, MAX_CHARA_NC) >= gdata(GDATA_DEEPEST_LEVEL) * 2 ) {
+	if ( cLevel(MAX_CHARA_NC) >= gdata(GDATA_DEEPEST_LEVEL) * 2 ) {
 		rtval = 0
 	}
-	if ( dblist(val, cdata(CDATA_ID, MAX_CHARA_NC)) > 1 ) {
+	if ( dblist(val, cId(MAX_CHARA_NC)) > 1 ) {
 		rtval = 0
 	}
 	return
 
 *museum_update
-	rankorg = gdata(GDATA_RANK_MUSEUM)
+	rankorg = gRankMuseum
 	inv_getheader -1
 	rankcur = 0
 	dim dblist, 2, 1499
 	repeat invrange, invhead
-		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
+		if ( iNum(cnt) == 0 ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) != ITEM_ID_FIGURINE & inv(INV_ITEM_ID, cnt) != ITEM_ID_CARD ) {
+		if ( iID(cnt) != ITEM_ID_FIGURINE & iID(cnt) != ITEM_ID_CARD ) {
 			continue
 		}
-		if ( wpeek(map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_ITEM_CHIPS), 0) != inv(INV_ITEM_PIC, cnt) ) {
+		if ( wpeek(mapItems(iX(cnt), iY(cnt)), 0) != iPic(cnt) ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_CARD & inv(INV_ITEM_COL, cnt) == 0 ) {
+		if ( iID(cnt) == ITEM_ID_CARD & iCol(cnt) == 0 ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+		if ( iID(cnt) == ITEM_ID_FIGURINE ) {
 			val = 0
 		}
 		else {
 			val = 1
 		}
-		dbid = inv(INV_ITEM_SUB_NAME, cnt)
+		dbid = iSubName(cnt)
 		gosub *museum_value
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+		if ( iID(cnt) == ITEM_ID_FIGURINE ) {
 			rankcur += rtval
 		}
 		else {
 			rankcur += rtval / 2
 		}
 	loop
 	rankcur = 10000 - int(sqrt(rankcur) * 70)
 	if ( rankcur < 100 ) {
 		rankcur = 100
 	}
-	gdata(GDATA_RANK_MUSEUM) = rankcur
+	gRankMuseum = rankcur
 	if ( rankorg != rankcur ) {
 		if ( rankorg > rankcur ) {
 			txtef COLOR_GREEN
 		}
 		else {
 			txtef COLOR_PURPLE
 		}
 		txtnew
 		txt lang("ランク変動(" + rankn(10, 3) + " " + rankorg / 100 + "位 → " + rankcur / 100 + "位 )《" + ranktitle(3) + "》", "Museum Rank:" + cnvrank(rankorg / 100) + "->" + cnvrank(rankcur / 100) + " Your museum is now known as <" + ranktitle(3) + ">.")
 	}
-	mdata(MDATA_MODERATE_CROWD) = (100 - gdata(GDATA_RANK_MUSEUM) / 100) / 2 + 1
+	mModerateCrowd = (100 - gRankMuseum / 100) / 2 + 1
 	rankorg = gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL)
 	inv_getheader -1
 	gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) = 0
 	dim dblist, 2, 1499
 	repeat invrange, invhead
-		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
+		if ( iNum(cnt) == 0 ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) != ITEM_ID_FIGURINE ) {
+		if ( iID(cnt) != ITEM_ID_FIGURINE ) {
 			continue
 		}
-		if ( wpeek(map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_ITEM_CHIPS), 0) != inv(INV_ITEM_PIC, cnt) ) {
+		if ( wpeek(mapItems(iX(cnt), iY(cnt)), 0) != iPic(cnt) ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+		if ( iID(cnt) == ITEM_ID_FIGURINE ) {
 			val = 0
 		}
 		else {
 			val = 1
 		}
-		dbid = inv(INV_ITEM_SUB_NAME, cnt)
-		gosub *museum_unique_level
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
+		dbid = iSubName(cnt)
+		gosub *label_4627
+		if ( iID(cnt) == ITEM_ID_FIGURINE ) {
 			gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) += rtval
 		}
 	loop
 	if ( rankorg != gdata(GDATA_FLAG_MUSEUM_UNIQUE_LEVEL) ) {
 		nokori = 0
@@ -2262,15 +2262,15 @@
 		txt lang("[次の目標まであと" + nokori + "] ", "/ Next stage:" + nokori + " ")
 	}
 	return
 
 *house_value
-	a = refitem(inv(INV_ITEM_ID, val), DBSPEC_TYPE)
+	a = refitem(iID(val), DBSPEC_TYPE)
 	if ( a == 60000 ) {
-		gdata(GDATA_HOME_FURNITURE) += limit(inv(INV_ITEM_VALUE, val) / 50, 50, 500)
+		gHomeFurniture += limit(iValue(val) / 50, 50, 500)
 	}
-	p = inv(INV_ITEM_VALUE, val)
+	p = iValue(val)
 	repeat 1
 		if ( a == 60000 ) {
 			p /= 20
 			break
 		}
@@ -2293,89 +2293,89 @@
 		loop
 	}
 	return
 
 *house_update
-	if ( gdata(GDATA_LEVEL) != 1 ) {
+	if ( gLevel != 1 ) {
 		return
 	}
-	rankorg = gdata(GDATA_RANK_HOME)
+	rankorg = gRankHome
 	inv_getheader -1
 	rankcur = 0
-	gdata(GDATA_HOME_FURNITURE) = 0
-	gdata(GDATA_HOME_VALUE) = 0
+	gHomeFurniture = 0
+	gHomeValue = 0
 	n = 0
 	repeat 10
 		list(0, cnt) = 0, 0
 	loop
 	repeat invrange, invhead
-		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
+		if ( iNum(cnt) == 0 ) {
 			continue
 		}
-		if ( wpeek(map(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), MAP_ITEM_CHIPS), 0) != inv(INV_ITEM_PIC, cnt) ) {
+		if ( wpeek(mapItems(iX(cnt), iY(cnt)), 0) != iPic(cnt) ) {
 			continue
 		}
 		val = cnt
 		gosub *house_value
 	loop
 	repeat 10
 		if ( list(0, cnt) != 0 ) {
-			gdata(GDATA_HOME_VALUE) += limit(list(1, cnt), 100, 2000)
+			gHomeValue += limit(list(1, cnt), 100, 2000)
 		}
 	loop
-	if ( gdata(GDATA_HOME_FURNITURE) > 10000 ) {
-		gdata(GDATA_HOME_FURNITURE) = 10000
+	if ( gHomeFurniture > 10000 ) {
+		gHomeFurniture = 10000
 	}
-	if ( gdata(GDATA_HOME_VALUE) > 10000 ) {
-		gdata(GDATA_HOME_VALUE) = 10000
+	if ( gHomeValue > 10000 ) {
+		gHomeValue = 10000
 	}
-	rankcur = 10000 - (gdata(GDATA_HOME_BASE) + gdata(GDATA_HOME_FURNITURE) + gdata(GDATA_HOME_VALUE)) / 3
+	rankcur = 10000 - (gHomeBase + gHomeFurniture + gHomeValue) / 3
 	if ( rankcur < 100 ) {
 		rankcur = 100
 	}
-	gdata(GDATA_RANK_HOME) = rankcur
+	gRankHome = rankcur
 	if ( rankorg != rankcur ) {
 		if ( rankorg > rankcur ) {
 			txtef COLOR_GREEN
 		}
 		else {
 			txtef COLOR_PURPLE
 		}
 		txtnew
-		txt lang("家具(" + gdata(GDATA_HOME_FURNITURE) / 100 + "点) 家宝(" + gdata(GDATA_HOME_VALUE) / 100 + "点) ランク変動(" + rankn(10, 4) + " " + rankorg / 100 + "位 → " + rankcur / 100 + "位 )《" + ranktitle(4) + "》", "Furniture Value:" + gdata(GDATA_HOME_FURNITURE) / 100 + " Heirloom Value:" + gdata(GDATA_HOME_VALUE) / 100 + " Home Rank:" + cnvrank(rankorg / 100) + "->" + cnvrank(rankcur / 100) + " Your home is now known as <" + ranktitle(4) + ">.")
+		txt lang("家具(" + gHomeFurniture / 100 + "点) 家宝(" + gHomeValue / 100 + "点) ランク変動(" + rankn(10, 4) + " " + rankorg / 100 + "位 → " + rankcur / 100 + "位 )《" + ranktitle(4) + "》", "Furniture Value:" + gHomeFurniture / 100 + " Heirloom Value:" + gHomeValue / 100 + " Home Rank:" + cnvrank(rankorg / 100) + "->" + cnvrank(rankcur / 100) + " Your home is now known as <" + ranktitle(4) + ">.")
 	}
 	return
 	goto *ranch_update
 
 #defcfunc cbreeder int cbreeder_charid
-	locvar_cbreeder_s = refchara(cdata(CDATA_ID, cbreeder_charid), DBSPEC_CHARA_FILTER, 1)
-	locvar_cbreeder_p = refrace(cdatan(CDATAN_RACE, cbreeder_charid), DBSPEC_RACE_BREEDER)
-	locvar_cbreeder_p = locvar_cbreeder_p * 100 / (100 + cdata(CDATA_LEVEL, cbreeder_charid) * 5)
+	locvar_cbreeder_s = refchara(cId(cbreeder_charid), DBSPEC_CHARA_FILTER, 1)
+	locvar_cbreeder_p = refrace(cnRace(cbreeder_charid), DBSPEC_RACE_BREEDER)
+	locvar_cbreeder_p = locvar_cbreeder_p * 100 / (100 + cLevel(cbreeder_charid) * 5)
 	return locvar_cbreeder_p
 
 *ranch_update
-	worker = getworker(gdata(GDATA_AREA))
+	worker = getworker(gArea)
 	livestock = 0
 	ooitama = 0
 	ooititi = 0
 	sickp = 0
 	inv_getheader -1
 	repeat invrange, invhead
-		if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
-			if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_SHIT ) {
+		if ( iNum(cnt) != 0 ) {
+			if ( iID(cnt) == ITEM_ID_SHIT ) {
 				sicp += 100
 			}
 		}
 	loop
 	repeat 245
-		if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+		if ( cExist(cnt) != CHAR_STATE_ALIVE ) {
 			continue
 		}
 		if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == FALSE ) {
 			continue
 		}
-		if ( cdata(CDATA_CONDITION_SICK, cnt) > 0 ) {
+		if ( cSick(cnt) > 0 ) {
 			sicp += 500
 		}
 		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) >= 7 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) <= 9 ) {
 			ooitama += cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt)
 		}
@@ -2386,24 +2386,24 @@
 			ooititi += cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt)
 		}
 		if ( cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) >= 1 & cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt) <= 3 ) {
 			ooititi -= cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, cnt)
 		}
-		cdata(CDATA_HUNGER, cnt) -= renewmulti * 300
-		if ( cdata(CDATA_HUNGER, cnt) < 4000 ) {
-			cdata(CDATA_HUNGER, cnt) = 4000
+		cHunger(cnt) -= renewmulti * 300
+		if ( cHunger(cnt) < 4000 ) {
+			cHunger(cnt) = 4000
 		}
 		livestock++
 	loop
 	repeat renewmulti
 		if ( worker == (-1) ) {
 			goto *skipBreeder
 		}
-		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gdata(GDATA_AREA)) == 10 ) {
+		if ( adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), gArea) == 10 ) {
 			goto *skipBreeder
 		}
-		if ( cdatan(CDATAN_RACE, worker) == "quickling" ) {
+		if ( cnRace(worker) == "quickling" ) {
 			if ( rnd(10) >= 8 ) {
 				goto *skipBreeder
 			}
 		}
 		if ( rnd(5000) > cbreeder(worker) * 100 / (100 + livestock * 20) - livestock * 2 ) {
@@ -2543,113 +2543,113 @@
 				if ( rnd(5) == 0 ) {
 					keisitu2 = 10
 				}
 			}
 		}
-		flt calcobjlv(cdata(CDATA_LEVEL, worker)), FIX_QUALITY_BAD
+		flt calcobjlv(cLevel(worker)), FIX_QUALITY_BAD
 		if ( rnd(2) ) {
-			dbid = cdata(CDATA_ID, worker)
+			dbid = cId(worker)
 		}
 		else {
 			dbid = 0
 		}
 		if ( rnd(10) != 0 ) {
-			fltnrace = cdatan(CDATAN_RACE, worker)
+			fltnrace = cnRace(worker)
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_LITTLE_SISTER ) {
+		if ( cId(worker) == CREATURE_ID_LITTLE_SISTER ) {
 			dbid = 176
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_STRAY_CAT ) {
+		if ( cId(worker) == CREATURE_ID_STRAY_CAT ) {
 			dbid = 164
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_TOWN_CHILD ) {
+		if ( cId(worker) == CREATURE_ID_TOWN_CHILD ) {
 			dbid = 36
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_SHEEPDOG ) {
+		if ( cId(worker) == CREATURE_ID_SHEEPDOG ) {
 			dbid = 10
 		}
-		if ( cdata(CDATA_QUALITY, worker) == FIX_QUALITY_UNIQUE ) {
+		if ( cQuality(worker) == FIX_QUALITY_UNIQUE ) {
 			dbid = 323
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_ITZPALT | cdata(CDATA_ID, worker) == CREATURE_ID_THE_ELEMENT ) {
+		if ( cId(worker) == CREATURE_ID_ITZPALT | cId(worker) == CREATURE_ID_THE_ELEMENT ) {
 			dbid = 149
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_YACATECT | cdata(CDATA_ID, worker) == CREATURE_ID_HYPER_YACATECT ) {
+		if ( cId(worker) == CREATURE_ID_YACATECT | cId(worker) == CREATURE_ID_HYPER_YACATECT ) {
 			dbid = 1
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_JURE | cdata(CDATA_ID, worker) == CREATURE_ID_BLESSED_JURE ) {
+		if ( cId(worker) == CREATURE_ID_JURE | cId(worker) == CREATURE_ID_BLESSED_JURE ) {
 			dbid = 347
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_LULWY | cdata(CDATA_ID, worker) == CREATURE_ID_DEVASTATE_LULWY ) {
+		if ( cId(worker) == CREATURE_ID_LULWY | cId(worker) == CREATURE_ID_DEVASTATE_LULWY ) {
 			dbid = 337
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_BUILDUP_OPATOS | cdata(CDATA_ID, worker) == CREATURE_ID_OPATOS ) {
+		if ( cId(worker) == CREATURE_ID_BUILDUP_OPATOS | cId(worker) == CREATURE_ID_OPATOS ) {
 			dbid = 245
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_INSANE_KUMIROMI | cdata(CDATA_ID, worker) == CREATURE_ID_KUMIROMI ) {
+		if ( cId(worker) == CREATURE_ID_INSANE_KUMIROMI | cId(worker) == CREATURE_ID_KUMIROMI ) {
 			dbid = 19
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_DEUS_EX_MANINA | cdata(CDATA_ID, worker) == CREATURE_ID_MANI ) {
+		if ( cId(worker) == CREATURE_ID_DEUS_EX_MANINA | cId(worker) == CREATURE_ID_MANI ) {
 			dbid = 171
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_EHEKATL | cdata(CDATA_ID, worker) == CREATURE_ID_GOD_INSIDE_EHEKATL ) {
+		if ( cId(worker) == CREATURE_ID_EHEKATL | cId(worker) == CREATURE_ID_GOD_INSIDE_EHEKATL ) {
 			dbid = 164
 		}
-		if ( cdata(CDATA_ID, worker) == CREATURE_ID_MESHERA_PLANT | cdata(CDATA_ID, worker) == CREATURE_ID_MESHERA_ALPHA_THE_DEFORMED_ANGEL ) {
+		if ( cId(worker) == CREATURE_ID_MESHERA_PLANT | cId(worker) == CREATURE_ID_MESHERA_ALPHA_THE_DEFORMED_ANGEL ) {
 			dbid = 452
 		}
 		characreate -1, dbid, 4 + rnd(11), 4 + rnd(8)
 		if ( stat != 0 ) {
 			cbitmod CHARA_BIT_LIVESTOCK, rc, TRUE
-			cdata(CDATA_AGE, rc) = gdata(GDATA_YEAR)
+			cAge(rc) = gYear
 			cdata(CDATA_SPRITE_SIZE_MILK, rc) = -5
 			cdata(CDATA_LIVESTOCK_QUALITY, rc) = keisitu
 			cdata(CDATA_LIVESTOCK_PRODUCE_QUALITY, rc) = keisitu2
 			livestock++
 		}
 
 *skipBreeder
 		egg = 0
-		if ( getworker(gdata(GDATA_AREA)) != (-1) ) {
-			wtc = getworker(gdata(GDATA_AREA))
+		if ( getworker(gArea) != (-1) ) {
+			wtc = getworker(gArea)
 		}
 		repeat 245
-			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+			if ( cExist(cnt) != CHAR_STATE_ALIVE ) {
 				continue
 			}
 			if ( cbit(CHARA_BIT_LIVESTOCK, cnt) == FALSE & cnt != wtc ) {
 				continue
 			}
 			if ( cnt != wtc ) {
 				if ( findbuff(cnt, BUFF_DISINFECTION) == (-1) ) {
 					if ( rnd(10000) <= sickp ) {
-						if ( cdata(CDATA_CONDITION_SICK, cnt) < 100 ) {
-							cdata(CDATA_CONDITION_SICK, cnt) += 30
+						if ( cSick(cnt) < 100 ) {
+							cSick(cnt) += 30
 						}
 					}
-					if ( cdata(CDATA_CONDITION_SICK, cnt) > 0 ) {
-						if ( cdata(CDATA_CONDITION_POISON, cnt) < 100 ) {
-							cdata(CDATA_CONDITION_POISON, cnt) += 30
+					if ( cSick(cnt) > 0 ) {
+						if ( cPoison(cnt) < 100 ) {
+							cPoison(cnt) += 30
 						}
 					}
 				}
-				if ( cdata(CDATA_CONDITION_SICK, cnt) > 0 ) {
-					cdata(CDATA_EMO_ICON, cnt) = 8 + 100 * 30
+				if ( cSick(cnt) > 0 ) {
+					cEmoIcon(cnt) = 8 + 100 * 30
 				}
 			}
-			if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gdata(GDATA_AREA)) == 10 ) {
+			if ( adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), gArea) == 10 ) {
 				break
 			}
 			if ( cnt == 0 ) {
 				continue
 			}
 			x = rnd(11) + 4
 			y = rnd(8) + 4
-			if ( map(x, y, MAP_ITEM_CHIPS) != 0 ) {
+			if ( mapItems(x, y) != 0 ) {
 				continue
 			}
-			flt calcobjlv(cdata(CDATA_LEVEL, cnt)), FIX_QUALITY_GOOD
+			flt calcobjlv(cLevel(cnt)), FIX_QUALITY_GOOD
 			p = rnd(5)
 			f = 0
 			if ( rnd(egg + 1) > 2 ) {
 				continue
 			}
@@ -2671,22 +2671,22 @@
 			if ( livestock > 40 ) {
 				if ( rnd(4) == 0 ) {
 					continue
 				}
 			}
-			if ( cdata(CDATA_CONDITION_SICK, cnt) > 0 ) {
+			if ( cSick(cnt) > 0 ) {
 				p = 2
 			}
 			if ( p == 0 ) {
 				if ( ooitama > 1 ) {
 					if ( rnd(ooitama) > rnd(80) ) {
 						flt
 						itemcreate -1, ITEM_ID_EGG, x, y, 0
 						if ( stat ) {
-							inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
-							inv(INV_ITEM_WEIGHT, ci) = limit(cdata(CDATA_WEIGHT, cnt) / 10 * 40, 20, 10000)
-							inv(INV_ITEM_VALUE, ci) = limit((inv(INV_ITEM_WEIGHT, cnt) + 2400) / 4, 600, 3000)
+							iSubName(ci) = cId(cnt)
+							iWeight(ci) = limit(cWeight(cnt) / 10 * 40, 20, 10000)
+							iValue(ci) = limit((iWeight(cnt) + 2400) / 4, 600, 3000)
 						}
 					}
 				}
 				if ( ooitama < 1 ) {
 					if ( ooitama + rnd(100) < 0 ) {
@@ -2694,34 +2694,34 @@
 					}
 				}
 				if ( rnd(60) == 0 ) {
 					f = 1
 				}
-				if ( cdata(CDATA_ID, cnt) == CREATURE_ID_CHICKEN ) {
+				if ( cId(cnt) == CREATURE_ID_CHICKEN ) {
 					if ( rnd(20) == 0 ) {
 						f = 1
 					}
 				}
 				if ( f ) {
 					egg++
 					flt
 					itemcreate -1, ITEM_ID_EGG, x, y, 0
 					if ( stat ) {
-						inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
-						inv(INV_ITEM_WEIGHT, ci) = limit(cdata(CDATA_WEIGHT, cnt) / 10 * 40, 20, 10000)
-						inv(INV_ITEM_VALUE, ci) = limit((inv(INV_ITEM_WEIGHT, cnt) + 2400) / 4, 600, 3000)
+						iSubName(ci) = cId(cnt)
+						iWeight(ci) = limit(cWeight(cnt) / 10 * 40, 20, 10000)
+						iValue(ci) = limit((iWeight(cnt) + 2400) / 4, 600, 3000)
 					}
 				}
 				continue
 			}
 			if ( p == 1 ) {
 				if ( ooititi > 1 ) {
 					if ( rnd(ooititi) > rnd(50) ) {
 						flt
 						itemcreate -1, ITEM_ID_BOTTLE_MILK, x, y, 0
 						if ( stat ) {
-							inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
+							iSubName(ci) = cId(cnt)
 						}
 					}
 				}
 				if ( ooitama < 1 ) {
 					if ( ooititi + rnd(100) < 0 ) {
@@ -2729,26 +2729,26 @@
 					}
 				}
 				if ( rnd(60) == 0 ) {
 					f = 1
 				}
-				if ( cdatan(CDATAN_RACE, cnt) == "sheep" ) {
+				if ( cnRace(cnt) == "sheep" ) {
 					if ( rnd(20) == 0 ) {
 						f = 1
 					}
 				}
-				if ( cdata(CDATA_ID, cnt) == CREATURE_ID_CATTLE ) {
+				if ( cId(cnt) == CREATURE_ID_CATTLE ) {
 					if ( rnd(20) == 0 ) {
 						f = 1
 					}
 				}
 				if ( f ) {
 					egg++
 					flt
 					itemcreate -1, ITEM_ID_BOTTLE_MILK, x, y, 0
 					if ( stat ) {
-						inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
+						iSubName(ci) = cId(cnt)
 					}
 				}
 				continue
 			}
 			if ( p == 2 ) {
@@ -2759,13 +2759,13 @@
 				}
 				if ( f ) {
 					flt
 					itemcreate -1, ITEM_ID_SHIT, x, y, 0
 					if ( stat ) {
-						inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, cnt)
-						inv(INV_ITEM_WEIGHT, ci) = limit(cdata(CDATA_WEIGHT, cnt) / 10 * 150, 30, 15000)
-						inv(INV_ITEM_VALUE, ci) = limit((cdata(CDATA_WEIGHT, cnt) + 3600) / 4, 900, 4500)
+						iSubName(ci) = cId(cnt)
+						iWeight(ci) = limit(cWeight(cnt) / 10 * 150, 30, 15000)
+						iValue(ci) = limit((cWeight(cnt) + 3600) / 4, 900, 4500)
 					}
 				}
 				continue
 			}
 			if ( p == 3 ) {
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/module.hsp ../2.14-borscht/module.hsp
--- ../2.13-borscht/module.hsp	2022-06-26 12:14:17.052569600 -0700
+++ ../2.14-borscht/module.hsp	2022-09-18 12:37:01.872627900 -0700
@@ -703,11 +703,11 @@
 	repeat 16
 		if ( cnt == 0 ) {
 			continue
 		}
 		if ( cdata(CDATA_AREA, cnt) == removeworker_arg1 ) {
-			cdata(CDATA_AREA, cnt) = AREA_NONE
+			cdata(CDATA_AREA, cnt) = 0
 		}
 	loop
 	return
 
 #defcfunc calcshopreform
@@ -1909,10 +1909,20 @@
 									gmode 2, 48, 48
 									grotate BUFFER_ITEM, 0, 960, cdata(CDATA_MARK_ITEM_ADJUST_R, CHARA_PLAYER) * 6.54498469498, 24 + cdata(CDATA_MARK_ITEM_ADJUST_W, CHARA_PLAYER) * 2, 24 + cdata(CDATA_PRECIOUS_ALLY, CHARA_PLAYER) * 2
 								}
 							}
 						}
+						if ( cdata(CDATA_SP_EARNED, CHARA_PLAYER) <= (-1000000) & cdata(CDATA_SP_EARNED, CHARA_PLAYER) > (-2000000) ) {
+							pos locvar_cell_draw_px, locvar_cell_draw_py - 5
+							gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
+							gcopy BUFFER_INF, 192 + 48 * 20 + rnd(1) * inf_tiles, 704
+						}
+						if ( cdata(CDATA_SP_EARNED, CHARA_PLAYER) <= (-2000000) ) {
+							pos locvar_cell_draw_px, locvar_cell_draw_py - 5
+							gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
+							gcopy BUFFER_INF, 192 + 48 * 21 + rnd(1) * inf_tiles, 704
+						}
 						if ( gdata(GDATA_FLAG_MAIN) >= 900 & gdata(GDATA_FLAG_MAIN) < 1000 ) {
 							pos locvar_cell_draw_px, locvar_cell_draw_py - 15
 							gmode 5, inf_tiles, inf_tiles, 120 + rnd(100)
 							gcopy BUFFER_INF, 192 + 48 * 11 + rnd(1) * inf_tiles, 704
 						}
@@ -3176,10 +3186,20 @@
 						if ( cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_THE_ELEMENT & cdata(CDATA_PIC, locvar_cell_draw_c) == 496 + 3 * 1000 | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_HYPER_YACATECT & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(0, 15)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_BLESSED_JURE & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(6, 12)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_DEVASTATE_LULWY & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(30, 11)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_BUILDUP_OPATOS & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(3, 13)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_DEUS_EX_MANINA & cdata(CDATA_PIC, locvar_cell_draw_c) == 447 + 5 * 1000) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_GOD_INSIDE_EHEKATL & cdata(CDATA_PIC, locvar_cell_draw_c) == 413 + 7 * 1000) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_YAYAUHQUI_TEZCATLIPOCA & cdata(CDATA_PIC, locvar_cell_draw_c) == 931 + 7 * 1000) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_JALDABAOTH_THE_CHAOS_CHILD & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(21, 28)) ) {
 							pos locvar_cell_draw_dx, locvar_cell_draw_dy - 40
 							gmode 5, inf_tiles, inf_tiles, 100 + rnd(70)
 							gcopy BUFFER_INF, 192 + 48 * 11 + rnd(1) * inf_tiles, 704
 						}
+						if ( cdata(CDATA_SP_EARNED, locvar_cell_draw_c) <= (-1000000) & cdata(CDATA_SP_EARNED, locvar_cell_draw_c) > (-2000000) ) {
+							pos locvar_cell_draw_dx, locvar_cell_draw_dy - 5
+							gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
+							gcopy BUFFER_INF, 192 + 48 * 20 + rnd(1) * inf_tiles, 704
+						}
+						if ( cdata(CDATA_SP_EARNED, locvar_cell_draw_c) <= (-2000000) ) {
+							pos locvar_cell_draw_dx, locvar_cell_draw_dy - 5
+							gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
+							gcopy BUFFER_INF, 192 + 48 * 21 + rnd(1) * inf_tiles, 704
+						}
 					}
 				}
 			}
 			if ( map(locvar_cell_draw_x, locvar_cell_draw_y, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
 				if ( synccheck(map(locvar_cell_draw_x, locvar_cell_draw_y, MAP_CHARA_INDEX_PLUS_ONE) - 1, -1) ) {
@@ -3816,10 +3836,20 @@
 								if ( cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_THE_ELEMENT & cdata(CDATA_PIC, locvar_cell_draw_c) == 496 + 3 * 1000 | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_HYPER_YACATECT & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(0, 15)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_BLESSED_JURE & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(6, 12)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_DEVASTATE_LULWY & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(30, 11)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_BUILDUP_OPATOS & cdata(CDATA_PIC, locvar_cell_draw_c) == xy2pic(3, 13)) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_DEUS_EX_MANINA & cdata(CDATA_PIC, locvar_cell_draw_c) == 447 + 5 * 1000) | (cdata(CDATA_ID, locvar_cell_draw_c) == CREATURE_ID_GOD_INSIDE_EHEKATL & cdata(CDATA_PIC, locvar_cell_draw_c) == 413 + 7 * 1000) ) {
 									pos locvar_cell_draw_dx + cdata(CDATA_IN_TAGTEAM, locvar_cell_draw_c) * 12, locvar_cell_draw_dy - 40
 									gmode 5, inf_tiles, inf_tiles, 100 + rnd(70)
 									gcopy BUFFER_INF, 192 + 48 * 11 + rnd(1) * inf_tiles, 704
 								}
+								if ( cdata(CDATA_SP_EARNED, locvar_cell_draw_c) <= (-1000000) & cdata(CDATA_SP_EARNED, locvar_cell_draw_c) > (-2000000) ) {
+									pos locvar_cell_draw_dx, locvar_cell_draw_dy - 5
+									gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
+									gcopy BUFFER_INF, 192 + 48 * 20 + rnd(1) * inf_tiles, 704
+								}
+								if ( cdata(CDATA_SP_EARNED, locvar_cell_draw_c) <= (-2000000) ) {
+									pos locvar_cell_draw_dx, locvar_cell_draw_dy - 5
+									gmode 4, inf_tiles, inf_tiles, 157 + rnd(3) * 50
+									gcopy BUFFER_INF, 192 + 48 * 21 + rnd(1) * inf_tiles, 704
+								}
 							}
 						}
 					}
 				}
 			}
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/proc.hsp ../2.14-borscht/proc.hsp
--- ../2.13-borscht/proc.hsp	2022-06-26 12:14:17.234737600 -0700
+++ ../2.14-borscht/proc.hsp	2022-09-18 12:37:02.003749200 -0700
@@ -267,11 +267,11 @@
 						return
 					}
 				}
 			}
 			if ( feat(FEAT_CELL_PIC) != tile_trap & cc == CHARA_PLAYER ) {
-				gosub *calcSearch
+				gosub *label_4091
 				if ( stat == 1 ) {
 					refx = movx
 					refy = movy
 					gosub *revealTrap
 					feat(FEAT_CELL_PIC) = tile_trap
@@ -289,11 +289,11 @@
 					else {
 						txt lang("解除に失敗した。", "You fail to disarm the trap.")
 					}
 				}
 			}
-			gosub *calcTrap
+			gosub *label_4092
 			if ( stat == 1 ) {
 				if ( synccheck(cc, -1) ) {
 					txt lang(name(cc) + "は罠を避けた。", name(cc) + " evade" + _s(cc) + " a trap.")
 				}
 				if ( cc == CHARA_PLAYER ) {
@@ -447,11 +447,11 @@
 			}
 		}
 	}
 	return
 
-*perform
+*label_5986
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		cdata(CDATA_ROW_ACT, cc) = ACTION_PERFORM
 		cdata(CDATA_ACTION_PERIOD, cc) = 61
 		if ( ens > 0 ) {
 			cdata(CDATA_ACTION_PERIOD, cc) = 121
@@ -903,11 +903,11 @@
 		return
 	}
 	rowactend cc
 	return
 
-*perform_dance
+*label_5991
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		if ( synccheck(cc, -1) ) {
 			txt lang(name(cc) + "は踊り始めた。", name(cc) + " start" + _s(cc) + " dance.")
 		}
 		cdata(CDATA_ROW_ACT, cc) = ACTION_PERFORM_DANCE
@@ -1335,11 +1335,11 @@
 		}
 	}
 	rowactend cc
 	return
 
-*perform_preach
+*label_5996
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		if ( synccheck(cc, -1) ) {
 			txt lang(name(cc) + "は説法を始めた。", name(cc) + " start" + _s(cc) + " preaching.")
 		}
 		cdata(CDATA_ROW_ACT, cc) = ACTION_PERFORM_PREACH
@@ -1649,19 +1649,19 @@
 			}
 		loop
 	}
 	return
 
-*skill_charge
+*label_5999
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		cdata(CDATA_ROW_ACT, cc) = ACTION_CHARGE
 		cdata(CDATA_ACTION_PERIOD, cc) = 10
 		if ( synccheck(cc, -1) ) {
 			txt lang(name(cc) + "は力をためはじめた。", name(cc) + " began power charge.")
 		}
 		customtalk cc, DBMODE_FLAVOR_CHARGE_S
-		gosub *convert_word
+		gosub *label_0416
 		if ( cc < MAX_CHARA_FOLLOWER ) {
 			charp = 0
 			repeat 16 - 1, 1
 				if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
 					continue
@@ -1679,11 +1679,11 @@
 					continue
 				}
 				charp++
 				tc = cnt
 				customtalk tc, DBMODE_FLAVOR_CHARGE
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						txt "「ここは任せて！」", "「時間は稼ぐよ！」", "「チャージの邪魔などさせるものか」", "「急いでね？」"
 					}
 				}
@@ -1721,11 +1721,11 @@
 		addbuff cc, BUFF_CHARGE, 400, 3
 	}
 	rowactend cc
 	return
 
-*skill_persuasion
+*label_6001
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		powsel = 0
 		if ( gdata(GDATA_FLAG_MAIN) < 350 ) {
 			if ( cdata(CDATA_LEVEL, cc) >= 130 ) {
 				powsel = 100
@@ -1761,11 +1761,11 @@
 		if ( cc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) == 0 ) {
 				powsel = 0
 			}
 		}
-		gosub *findTarget
+		gosub *label_5740
 		if ( stat == 0 ) {
 			powsel = 0
 		}
 		else {
 			tc = cdata(CDATA_TARGET, cc)
@@ -1823,11 +1823,11 @@
 					}
 				}
 			}
 		loop
 		customtalk cc, DBMODE_FLAVOR_BTALK
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			txt lang(name(cc) + "は説得を始めた。", name(cc) + " start persuasion.")
 		}
 		if ( daihyou >= 0 ) {
 			if ( ninzuu == 1 ) {
@@ -1934,11 +1934,11 @@
 	}
 	txt lang(name(cc) + "は一息ついた。", name(cc) + " was a little break.")
 	rowactend cc
 	return
 
-*skill_peculiar_joke
+*label_6004
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		powsel = 0
 		if ( gdata(GDATA_FLAG_MAIN) < 350 ) {
 			if ( cdata(CDATA_LEVEL, cc) >= 130 ) {
 				powsel = 100
@@ -1974,11 +1974,11 @@
 		if ( cc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) == 0 ) {
 				powsel = 0
 			}
 		}
-		gosub *findTarget
+		gosub *label_5740
 		if ( stat == 0 ) {
 			powsel = 0
 		}
 		else {
 			tc = cdata(CDATA_TARGET, cc)
@@ -2036,11 +2036,11 @@
 					}
 				}
 			}
 		loop
 		customtalk cc, DBMODE_FLAVOR_BTALK
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			txt lang(name(cc) + "は全力で笑わせにかかった。", name(cc) + " start peculiar joke.")
 		}
 		if ( daihyou >= 0 ) {
 			if ( ninzuu == 1 ) {
@@ -2138,11 +2138,11 @@
 	}
 	txt lang(name(cc) + "は一息ついた。", name(cc) + " was a little break.")
 	rowactend cc
 	return
 
-*skill_blended_lie
+*label_6007
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		powsel = 0
 		if ( gdata(GDATA_FLAG_MAIN) < 350 ) {
 			if ( cdata(CDATA_LEVEL, cc) >= 130 ) {
 				powsel = 100
@@ -2178,11 +2178,11 @@
 		if ( cc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) == 0 ) {
 				powsel = 0
 			}
 		}
-		gosub *findTarget
+		gosub *label_5740
 		if ( stat == 0 ) {
 			powsel = 0
 		}
 		else {
 			tc = cdata(CDATA_TARGET, cc)
@@ -2240,11 +2240,11 @@
 					}
 				}
 			}
 		loop
 		customtalk cc, DBMODE_FLAVOR_BTALK
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			txt lang(name(cc) + "は嘘を交えて話し始めた。", name(cc) + " start to talk with lie.")
 		}
 		if ( daihyou >= 0 ) {
 			if ( ninzuu == 1 ) {
@@ -2366,11 +2366,11 @@
 	}
 	txt lang(name(cc) + "は一息ついた。", name(cc) + " was a little break.")
 	rowactend cc
 	return
 
-*skill_intimidation
+*label_6010
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		powsel = 0
 		if ( gdata(GDATA_FLAG_MAIN) < 350 ) {
 			if ( cdata(CDATA_LEVEL, cc) >= 130 ) {
 				powsel = 100
@@ -2406,11 +2406,11 @@
 		if ( cc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) == 0 ) {
 				powsel = 0
 			}
 		}
-		gosub *findTarget
+		gosub *label_5740
 		if ( stat == 0 ) {
 			powsel = 0
 		}
 		else {
 			tc = cdata(CDATA_TARGET, cc)
@@ -2468,11 +2468,11 @@
 					}
 				}
 			}
 		loop
 		customtalk cc, DBMODE_FLAVOR_BTALK
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			txt lang(name(cc) + "は脅迫を始めた。", name(cc) + " began start intimidation.")
 		}
 		if ( daihyou >= 0 ) {
 			if ( ninzuu == 1 ) {
@@ -2594,11 +2594,11 @@
 	}
 	txt lang(name(cc) + "は一息ついた。", name(cc) + " was a little break.")
 	rowactend cc
 	return
 
-*skill_mysterious_song
+*label_6013
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		powsel = 0
 		if ( gdata(GDATA_FLAG_MAIN) < 350 ) {
 			if ( cdata(CDATA_LEVEL, cc) >= 130 ) {
 				powsel = 100
@@ -2634,11 +2634,11 @@
 		if ( cc == CHARA_PLAYER ) {
 			if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) == 0 ) {
 				powsel = 0
 			}
 		}
-		gosub *findTarget
+		gosub *label_5740
 		if ( stat == 0 ) {
 			powsel = 0
 		}
 		else {
 			tc = cdata(CDATA_TARGET, cc)
@@ -2696,11 +2696,11 @@
 					}
 				}
 			}
 		loop
 		customtalk cc, DBMODE_FLAVOR_BTALK
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			txt lang(name(cc) + "は魔力を込めて歌い始めた。", name(cc) + " start the song mixed spell.")
 		}
 		if ( daihyou >= 0 ) {
 			if ( ninzuu == 1 ) {
@@ -2803,11 +2803,11 @@
 	}
 	txt lang(name(cc) + "は一息ついた。", name(cc) + " was a little break.")
 	rowactend cc
 	return
 
-*eat_meal
+*label_6016
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		cdata(CDATA_ROW_ACT, cc) = ACTION_MEAL
 		cdata(CDATA_ACTION_PERIOD, cc) = 20
 		cdata(CDATA_EMO_ICON, cc) = 6 + 100 * 3
 		if ( synccheck(cc, -1) ) {
@@ -2915,11 +2915,11 @@
 	}
 	txt lang(name(cc) + "は一息ついた。", name(cc) + " was a little break.")
 	rowactend cc
 	return
 
-*eat_meal_xmas_cake
+*label_6018
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		cdata(CDATA_ROW_ACT, cc) = ACTION_XMAS_CAKE
 		cdata(CDATA_ACTION_PERIOD, cc) = 20
 		cdata(CDATA_EMO_ICON, cc) = 6 + 100 * 3
 		if ( synccheck(cc, -1) ) {
@@ -2947,11 +2947,11 @@
 	}
 	chara_anorexia cc
 	rowactend cc
 	return
 
-*sexsex
+*label_6019
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		cdata(CDATA_ROW_ACT, cc) = ACTION_SEX
 		cdata(CDATA_ACTION_PERIOD, cc) = 25 + rnd(10)
 		cdata(CDATA_ROW_ACT_TC, cc) = tc
 		cdata(CDATA_ROW_ACT, tc) = ACTION_SEX, cdata(CDATA_ACTION_PERIOD, cc) * 2
@@ -3036,10 +3036,12 @@
 	loop
 	sexvalue = sdata(SKILL_ATTR_CHA, cc) * (50 + rnd(50)) + 100
 	if ( cc == CHARA_PLAYER | tc == CHARA_PLAYER ) {
 		gdata(GDATA_FLAG_PROSTITUTION_COUNTER)++
 	}
+	gain_iden tc, cc, 10
+	gain_iden cc, tc, 10
 	if ( synccheck(cc, -1) ) {
 		txtef COLOR_SKY_BLUE
 		if ( jp ) {
 			txt "「よかった" + _yo(3) + "」", "「す、すごい" + _yo(3) + "」", "「も、もうだめ" + _da(3) + "」", "「は、激しかった" + _yo(3) + "」", "「か、完敗" + _da(3) + "」"
 		}
@@ -3087,11 +3089,11 @@
 	}
 	rowactend cc
 	rowactend tc
 	return
 
-*skill_tuin_der_lusten
+*label_6021
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
 		cdata(CDATA_ROW_ACT, cc) = ACTION_TUIN_DER_LUSTEN
 		cdata(CDATA_ACTION_PERIOD, cc) = limit(sdata(SKILL_ATTR_SPD, cc) / 10, 10, 50)
 		cdata(CDATA_ROW_ACT_TC, cc) = tc
 		cdata(CDATA_ROW_ACT, tc) = ACTION_TUIN_DER_LUSTEN
@@ -3204,11 +3206,11 @@
 	}
 	rowactend cc
 	rowactend tc
 	return
 
-*generalAct
+*label_6023
 	if ( cc != CHARA_PLAYER ) {
 		rowactend cc
 		return
 	}
 	if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
@@ -3624,11 +3626,11 @@
 		}
 		else {
 			item_stack CHARA_PLAYER, ti, 1
 			snd 14 + rnd(2)
 		}
-		gosub *calcBurdenPc
+		gosub *label_4102
 		skillexp SKILL_ACTIVE_PICKPOCKET, CHARA_PLAYER, limit(inv(INV_ITEM_WEIGHT, ti) / 25, 0, 450) + 50
 		gdata(GDATA_FLAG_STOLEN_GOODS)++
 		if ( cdata(CDATA_KARMA, CHARA_PLAYER) >= (-30) ) {
 			if ( rnd(3) == 0 ) {
 				txtmore
@@ -3688,11 +3690,11 @@
 		opatra = 0
 	}
 	rowactend cc
 	return
 
-*sleep_draw
+*label_6026
 	redraw 0
 	pos 0, 0
 	gcopy BUFFER_BUF, 0, 0, windoww, windowh - inf_verh
 	gmode 2
 	gosub *screen_drawStatus
@@ -3728,11 +3730,11 @@
 	music = MUSICLIST_MCCODA
 	gosub *music_play
 	msg_halt
 	repeat 20
 		gmode 4, , , cnt * 10
-		gosub *sleep_draw
+		gosub *label_6026
 		await 200
 	loop
 	gmode 2
 	cc = CHARA_PLAYER
 	repeat 245
@@ -3765,11 +3767,11 @@
 			cure_anorexia tc
 			cdata(CDATA_VOMIT, tc) = 0
 		}
 		healsan tc, 10
 		if ( cbit(CHARA_BIT_LAY_HANDS, tc) | cdata(CDATA_ID, tc) == CREATURE_ID_GOOSE | cdata(CDATA_ID, tc) == CREATURE_ID_CUTE_FAIRY ) {
-			cbitmod CHARA_BIT_EXCLUSIVE_SKILL_CHARGE, tc, TRUE
+			cbitmod (974 /*!!!@[CHARA_BIT_EXCLUSIVE_SKILL_CHARGE @@@ CHARA_BIT_LAY_HAND_CHARGE]@!!! */), tc, TRUE
 		}
 	loop
 	cdata(CDATA_EVOCHAT_POINTS, CHARA_PLAYER) = 10
 	mode = MODELIST_TXT_ADV
 	timeslept = 7 + rnd(5)
@@ -3780,19 +3782,19 @@
 			timeslept = 8
 		}
 	}
 	repeat timeslept
 		gdata(GDATA_HOUR)++
-		gosub *advance_hour
+		gosub *label_9228
 		if ( mode != MODELIST_TXT_ADV ) {
 			gosub *sleep_draw_init
 			mode = MODELIST_TXT_ADV
 		}
 		gdata(GDATA_SLEEP) = 0
 		gdata(GDATA_MIN) = 0
 		cc = CHARA_PLAYER
-		gosub *sleep_draw
+		gosub *label_6026
 		await 500
 	loop
 	if ( cdata(CDATA_GOLD, CHARA_PLAYER) < 500 ) {
 		if ( spact(SKILL_SPACT_SERIOUS_BEGGING - STARTING_SKILL_SPACT) == 0 ) {
 			spact(SKILL_SPACT_SERIOUS_BEGGING - STARTING_SKILL_SPACT) = 1
@@ -3820,13 +3822,15 @@
 			listn(0, listmax) = lang("ふぅ", "Sweet.")
 			listmax++
 			cbitmod CHARA_BIT_MAKE_GENE, tc, FALSE
 			gosub *re_select
 			gosub *generate_gene
+			gain_iden tc, 0, 20
+			gain_iden 0, tc, 20
 		}
 	}
-	gosub *sleep_draw
+	gosub *label_6026
 	gdata(GDATA_SLEEP_GENE) = 0
 	mode = MODELIST_MAIN
 	wake_up
 	cdata(CDATA_HUNGER, cc) -= 1500 / (trait(TRAIT_RACE_SLOW_DIGESTION) + 1)
 	cdata(CDATA_THIRST, cc) -= 1500 / 2
@@ -4420,11 +4424,11 @@
 		gdata(GDATA_DOJO_TURNS) += 1
 	}
 	rowactend cc
 	return
 
-*choose_fish
+*label_6049
 	if ( rowactre != 0 ) {
 		return
 	}
 	turi = cdata(CDATA_ITEM_USING, CHARA_PLAYER)
 	basyo = 0
@@ -4519,11 +4523,11 @@
 			}
 		}
 		if ( gdata(GDATA_USING_SUPER_LURE) == 1 ) {
 			snd SOUNDLIST_WATER2
 			snd SOUNDLIST_FISH_GET
-			gosub *choose_fish
+			gosub *label_6049
 			gosub *get_fish
 			rowactend cc
 			cdata(CDATA_SP, cc) -= 15
 			if ( rnd(10) == 0 ) {
 				gosub *expFishing
@@ -4541,11 +4545,11 @@
 			txt lang("釣りを切り上げた。", "You stop fishing...")
 			rowactend cc
 		}
 		if ( rnd(3) == 0 ) {
 			fishstat = 1
-			gosub *choose_fish
+			gosub *label_6049
 		}
 		if ( fishstat == 1 ) {
 			if ( rnd(2) == 0 ) {
 				repeat 4 + rnd(4)
 					redraw 0
@@ -4975,11 +4979,11 @@
 				}
 			}
 			if ( map(refx, refy, MAP_FEATS_ON_TILE) != 0 ) {
 				cell_featread refx, refy
 				if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_HIDDEN_PATH ) {
-					gosub *revealHiddenPath
+					gosub *label_6413
 				}
 			}
 			map(refx, refy, MAP_TILE_ID) = tile_tunnel
 			if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
 				dblistmax = 0
@@ -5114,11 +5118,11 @@
 	if ( ci >= 5080 ) {
 		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 	}
 	else {
 		if ( cc == CHARA_PLAYER ) {
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 	}
 	if ( cc == CHARA_PLAYER ) {
 		gosub *eat_finish
 	}
@@ -5259,11 +5263,11 @@
 				inv(INV_ITEM_NUM, ci)--
 				if ( ci >= 5080 ) {
 					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 				}
 				else {
-					gosub *calcBurdenPc
+					gosub *label_4102
 				}
 				if ( synccheck(cc, -1) ) {
 					txt lang(itemname(ci, 1) + "は塵となって崩れ落ちた。", itemname(ci, 1) + " falls apart.")
 				}
 			}
@@ -5369,11 +5373,11 @@
 		snd SOUNDLIST_BOOK1
 		txt lang("すくつの探索を許可する、という内容の文面が形式的に書いてある。", "According to the card, you are permitted to explore the void now.")
 		return 1
 	}
 	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SKILLBOOK ) {
-		gosub *com_train
+		gosub *label_5761
 		if ( stat == 1 ) {
 			return 1
 		}
 		else {
 			return 0
@@ -5665,12 +5669,12 @@
 				snd SOUNDLIST_CURSE2
 				rc = cnt
 				gosub *resurrect
 				cxinit = cdata(CDATA_X, cc)
 				cyinit = cdata(CDATA_Y, cc)
-				gosub *place_chara
-				cdata(CDATA_AREA, rc) = AREA_NONE
+				gosub *label_4125
+				cdata(CDATA_AREA, rc) = 0
 				txtef COLOR_YELLOW
 				txt cnven(cdatan(CDATAN_NAME, rc)) + lang("は復活した！", " " + have(rc) + " been resurrected!")
 				txtvalid = 0
 				txt lang("「苦しい…」", cnvtalk("Painful..."))
 				cdata(CDATA_CAN_REVIVE, rc)--
@@ -6168,11 +6172,11 @@
 		if ( ci >= 5080 ) {
 			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		}
 		else {
 			if ( tc == CHARA_PLAYER ) {
-				gosub *calcBurdenPc
+				gosub *label_4102
 			}
 		}
 		cdata(CDATA_THIRST, tc) += 2000
 		cdata(CDATA_HUNGER, tc) += 150
 	}
@@ -6432,11 +6436,11 @@
 		inv(INV_ITEM_NUM, ci)--
 		if ( ci >= 5080 ) {
 			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
 		}
 		else {
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		skillexp SKILL_NORMAL_LITERACY, cc, 25, 2
 	}
 	gosub *effect
 	if ( cc == CHARA_PLAYER ) {
@@ -6660,11 +6664,11 @@
 	}
 	return 1
 
 *effect_selectTg
 	noeffect = 0
-	if ( efid > MAX_SKILL ) {
+	if ( efid > 846 ) {
 		tc = cc
 		return 1
 	}
 	tg = sdataref(SKILL_DATAREF_TG, efid) / 1000 * 1000
 	if ( efsource == 1 ) {
@@ -6809,11 +6813,11 @@
 				}
 				tlocx = tglocx
 				tlocy = tglocy
 			}
 			else {
-				gosub *findLocation
+				gosub *label_5349
 				if ( stat != 1 ) {
 					if ( stat == 0 ) {
 						txt lang("その場所は見えない。", "You can't see the location.")
 						gosub *screen_draw
 					}
@@ -6847,11 +6851,11 @@
 		tlocy = cdata(CDATA_Y, cc)
 		return 1
 	}
 	if ( tg == 2000 | tg == 6000 | tg == 9000 ) {
 		if ( cc == CHARA_PLAYER ) {
-			gosub *findTarget
+			gosub *label_5740
 			if ( stat == 0 ) {
 				obvious = 0
 				return 0
 			}
 			tc = cdata(CDATA_TARGET, CHARA_PLAYER)
@@ -6913,11 +6917,11 @@
 
 
 
 
 	if ( efid >= SKILL_ACTIVE_PICKPOCKET ) {
-		if ( efid < MAX_SKILL ) {
+		if ( efid < 846 ) {
 			f = 0
 			if ( sdataref(SKILL_DATAREF_TYPE, efid) / 1000 == 1 ) {
 				f = 1
 				p = sdataref(SKILL_DATAREF_TYPE, efid) \ 1000
 				if ( bdataref(BDATAREF_BUFF_TYPE, p) == BUFF_TYPE_HEX ) {
@@ -7022,11 +7026,11 @@
 			}
 			if ( _switch_val == 10 | _switch_sw ) {
 				_switch_sw = 0
 				if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 					tc = cdata(CDATA_TARGET, cc)
-					gosub *act_melee
+					gosub *label_6394
 					goto *effect_SWEND1
 				}
 				if ( efid == SKILL_SPACT_DISTANT_ATTACK ) {
 					gdata(GDATA_TEMPORARY_FLAGS) = 200
 					animeid = ANIMATION_DISTANT_ATK
@@ -7035,11 +7039,11 @@
 				else {
 					animeid = ANIMATION_SPORE
 					gosub *anime
 				}
 				gdata(GDATA_TEMPORARY_FLAGS) = 0
-				gosub *act_melee
+				gosub *label_6394
 				goto *effect_SWEND1
 				_switch_sw++
 			}
 			if ( _switch_val == 1 | _switch_sw ) {
 				_switch_sw = 0
@@ -7054,11 +7058,11 @@
 				tcbbk = -1
 				if ( gdata(GDATA_TEMPORARY_FLAGS) == 0 ) {
 					if ( findbuff(cc, BUFF_CHARGE) != (-1) ) {
 						if ( cc != CHARA_PLAYER | cdata(CDATA_RELATION, tc) == RELATION_ENEMY ) {
 							customtalk cc, DBMODE_FLAVOR_CHARGE_A
-							gosub *convert_word
+							gosub *label_0416
 							if ( synccheck(cc, -1) ) {
 								txtef COLOR_RED
 								txt lang(name(cc) + "の完全詠唱魔法が炸裂した。", name(cc) + " blast magic by full power.")
 								txtmore
 							}
@@ -7279,11 +7283,11 @@
 					if ( efid != SKILL_SPELL_HEALING_RAIN ) {
 						if ( efid != SKILL_SPACT_SUICIDE_ATTACK ) {
 							if ( findbuff(cc, BUFF_CHARGE) != (-1) ) {
 								if ( cc != CHARA_PLAYER | cdata(CDATA_RELATION, tc) == RELATION_ENEMY ) {
 									customtalk cc, DBMODE_FLAVOR_CHARGE_A
-									gosub *convert_word
+									gosub *label_0416
 									if ( synccheck(cc, -1) ) {
 										txtef COLOR_RED
 										txt lang(name(cc) + "の完全詠唱魔法が炸裂した。", name(cc) + " blast magic by full power.")
 										txtmore
 									}
@@ -7699,11 +7703,11 @@
 						loop
 						r1 = cc
 						gosub *charaRefresh
 						snd SOUNDLIST_BOLT1
 						customtalk cc, DBMODE_FLAVOR_CHARGE_A
-						gosub *convert_word
+						gosub *label_0416
 						if ( synccheck(cc, -1) ) {
 							txtef COLOR_RED
 							txt lang(name(cc) + "の完全詠唱魔法が炸裂した。", name(cc) + " blast magic by full power.")
 							txtmore
 						}
@@ -7838,11 +7842,11 @@
 			}
 			if ( _switch_val == 6 | _switch_sw ) {
 				_switch_sw = 0
 				if ( efid == SKILL_SPACT_VORACITY_FANG ) {
 					if ( cdata(CDATA_HUNGER, cc) >= 10000 ) {
-						gosub *act_melee
+						gosub *label_6394
 						goto *effect_SWEND1
 					}
 				}
 				if ( cbit(CHARA_BIT_BLUE_SPIRIT, cc) ) {
 					if ( efid != SKILL_SPACT_VORACITY_FANG & efid != SKILL_SPACT_DRAIN_BLOOD ) {
@@ -7911,10 +7915,11 @@
 						}
 						else {
 							txt lang(name(cc) + "に身体を食いちぎられた。", name(cc) + " bite" + _s(cc) + " off " + name(tc) + your(tc) + " flesh.")
 						}
 					}
+					gain_iden tc, cc, 7
 				}
 				if ( efid == SKILL_SPACT_MEMORY_POISON ) {
 					snd SOUNDLIST_EAT1
 					if ( synccheck(cc, -1) ) {
 						if ( tc >= MAX_CHARA_FOLLOWER ) {
@@ -7948,10 +7953,11 @@
 								}
 								else {
 									txt lang(name(cc) + "に血を吸われた。", name(cc) + " suck" + _s(cc) + " " + name(tc) + your(tc) + " blood.")
 								}
 							}
+							gain_iden tc, cc, 5
 						}
 						else {
 							if ( synccheck(cc, -1) ) {
 								if ( tc >= MAX_CHARA_FOLLOWER ) {
 									gdata(GDATA_DMG_TYPE) = 2
@@ -7975,11 +7981,11 @@
 						dmgspt tc, rnd(6) + 5
 					}
 					refreshspeed tc
 					if ( cc == CHARA_PLAYER & tc < MAX_CHARA_FOLLOWER & (cdata(CDATA_IMPRESSION, tc) >= 150 | cdata(CDATA_MASTER_SERVANT, tc) >= 150) ) {
 						customtalk tc, DBMODE_FLAVOR_DRAIN
-						gosub *convert_word
+						gosub *label_0416
 						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 							if ( jp ) {
 								txt name(tc) + "は大人しく血を吸われている。", "「どうぞ…」", "「美味しい？」"
 							}
 						}
@@ -8351,23 +8357,11 @@
 								cbitmod CHARA_BIT_SUMMONED, rc, TRUE
 							}
 						}
 						if ( 0 ) {
 							flt
-							characreate -1, CREATURE_ID_HELRAUNE, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
-							flt
-							characreate -1, CREATURE_ID_KING_HOGWEEDER, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
-							flt
-							characreate -1, CREATURE_ID_HOGWEEDER, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
-							flt
-							characreate -1, CREATURE_ID_ALRAUNE, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
-							flt
-							characreate -1, CREATURE_ID_KUSOSUGI, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
-							flt
-							characreate -1, CREATURE_ID_HINOCCHIO, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
-							flt
-							characreate -1, CREATURE_ID_SIST_THE_OLDER_SISTER, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
+							characreate -1, CREATURE_ID_BOYCIANA, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
 						}
 					}
 					if ( efid != SKILL_SPACT_SUMMON_SISTER ) {
 						if ( cdata(CDATA_ID, rc) == cdata(CDATA_ID, cc) ) {
 							if ( cdata(CDATA_ID, cc) != CREATURE_ID_POWERFUL_GREAT_WYRM ) {
@@ -8420,11 +8414,11 @@
 				}
 				if ( efid == SKILL_SPACT_SHADOW_STEP ) {
 					if ( cdata(CDATA_RELATION, cc) != RELATION_ALLY | tc != CHARA_PLAYER ) {
 						if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 							tc = cdata(CDATA_TARGET, cc)
-							gosub *act_melee
+							gosub *label_6394
 							goto *effect_SWEND1
 						}
 					}
 				}
 				tcprev = tc
@@ -8548,11 +8542,11 @@
 							txt lang("魔法の力がテレポートを防いだ。", "Magical field prevents teleportation.")
 						}
 						goto *effect_SWEND1
 					}
 					if ( cbit(CHARA_BIT_SUMMONED, cc) == TRUE ) {
-						gosub *act_melee
+						gosub *label_6394
 						goto *effect_SWEND1
 					}
 					if ( cbit(CHARA_BIT_SANDBAG, tc) == TRUE ) {
 						txt lang(name(cc) + "は悪戦苦闘している。縄がきつくて財布が抜き取れないようだ。", name(cc) + " is struggling. The purse seems not pulled off because there is a tight rope.")
 						goto *effect_SWEND1
@@ -8661,11 +8655,11 @@
 							}
 							if ( zero2 != 200 ) {
 								animeid = ANIMATION_ATTACK
 								gosub *anime
 								shadow = 100
-								gosub *act_melee
+								gosub *label_6394
 							}
 							shadow = 0
 							break
 						}
 						else {
@@ -8803,11 +8797,11 @@
 				else {
 					valn = lang("", "breath")
 				}
 				if ( findbuff(cc, BUFF_CHARGE) != (-1) & (cc != CHARA_PLAYER | cdata(CDATA_RELATION, tc) == RELATION_ENEMY) ) {
 					customtalk cc, DBMODE_FLAVOR_CHARGE_A
-					gosub *convert_word
+					gosub *label_0416
 					if ( synccheck(cc, -1) ) {
 						txtef COLOR_RED
 						txt lang(name(cc) + "は最大出力の" + valn + "を繰り出した。", name(cc) + " blast" + _s(cc) + " " + valn + " by full power.")
 					}
 				}
@@ -9315,11 +9309,11 @@
 				}
 				else {
 					txtef COLOR_SKY_BLUE
 					txt lang("「うまー」", cnvtalk("Yummy!"))
 				}
-				if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) <= (-1) & cdata(CDATA_HUNGER, tc) < 8000 ) {
+				if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) <= (-1) & cdata(CDATA_HUNGER, tc) < 8000 & cbit(1034, tc) != TRUE ) {
 					txtef COLOR_SKY_BLUE
 					txt lang(name(tc) + "はすくすくと成長した。", name(tc) + " grew quickly.")
 					if ( efstatus >= 0 ) {
 						cdata(CDATA_SPRITE_SIZE_MILK, tc)++
 						if ( cbit(CHARA_BIT_LIVESTOCK, tc) == TRUE ) {
@@ -9391,11 +9385,11 @@
 		}
 		else {
 			txtef COLOR_SKY_BLUE
 			txt lang("「うまいっ！！」", cnvtalk("Very yummy!"))
 		}
-		gosub *effect_elixer
+		gosub *label_6338
 		r1 = tc
 		gosub *charaRefresh
 		if ( synccheck(tc, -1) ) {
 			txtmore
 			txtef COLOR_PURPLE
@@ -9488,21 +9482,21 @@
 			snd SOUNDLIST_ATK_MIND
 			meadmap = 1
 			homemapmode = 1
 			cxbk = cdata(CDATA_X, CHARA_PLAYER)
 			cybk = cdata(CDATA_Y, CHARA_PLAYER)
-			gosub *home_setWallTile
+			gosub *label_4610
 			n = 0
 			txtnew
 			txt lang("移動キーで幽体を移動、キャンセルキーで幽体離脱終了。", "Movement keys to move current position, hit the cancel key to exit.")
 			tlocinitx = cdata(CDATA_X, CHARA_PLAYER)
 			tlocinity = cdata(CDATA_Y, CHARA_PLAYER)
 			tile = 0
 			repeat
 				await
 				homemakewall = 1
-				gosub *findLocation
+				gosub *label_5349
 				if ( stat == (-1) ) {
 					break
 				}
 				tlocinitx = tlocx
 				tlocinity = tlocy
@@ -9635,10 +9629,13 @@
 	if ( _switch_val == 1170 | _switch_sw ) {
 		_switch_sw = 0
 		if ( synccheck(tc, -1) ) {
 			txt lang("「げふぅ」", "*Ughu*")
 		}
+		flt
+		itemcreate -1, 1263, cdata(CDATA_X, tc), cdata(CDATA_Y, tc), 0
+		inv(INV_ITEM_COL, ci) = 3
 		healsp tc, 15
 		sickifcursed efstatus, tc, 1
 		if ( rnd(2) == 0 ) {
 			inv_find ITEM_ID_BIO_BATTERY, tc
 			if ( stat == (-1) ) {
@@ -9657,10 +9654,13 @@
 			}
 			else {
 				txt lang(" *ごくっ* ", "*quaff*")
 			}
 		}
+		flt
+		itemcreate -1, 1263, cdata(CDATA_X, tc), cdata(CDATA_Y, tc), 0
+		inv(INV_ITEM_COL, ci) = 19
 		skillexp SKILL_NORMAL_HEALING, tc, 200
 		sickifcursed efstatus, tc, 1
 		goto *effect_end
 		_switch_sw++
 	}
@@ -9669,10 +9669,13 @@
 		if ( synccheck(tc, -1) ) {
 			txt lang("*シュワワ* 刺激的！", "*quaff* Juicy!")
 			txtvalid = 0
 			txt lang(name(tc) + "のスタミナが少し回復した。", name(tc) + " restore" + _s(tc) + " some stamina.")
 		}
+		flt
+		itemcreate -1, 1262, cdata(CDATA_X, tc), cdata(CDATA_Y, tc), 0
+		inv(INV_ITEM_PIC, ci) += rnd(3)
 		healsp tc, 25
 		sickifcursed efstatus, tc, 1
 		goto *effect_end
 		_switch_sw++
 	}
@@ -9785,11 +9788,11 @@
 				if ( cdata(CDATA_RIDING, gdata(GDATA_RIDER)) == 1 ) {
 					txt lang(name(gdata(GDATA_RIDER)) + "はあなたから降りた。", name(gdata(GDATA_RIDER)) + " dismount from you.")
 				}
 				if ( cdata(CDATA_RIDING, gdata(GDATA_RIDER)) == 0 ) {
 					customtalk gdata(GDATA_RIDER), DBMODE_FLAVOR_RIDE_OFF
-					gosub *convert_word
+					gosub *label_0416
 					if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 						txtef COLOR_SKY_BLUE
 						if ( jp ) {
 							txt name(gdata(GDATA_RIDER)) + "「ふぅ」", name(gdata(GDATA_RIDER)) + "「乗り心地はよかった？」", name(gdata(GDATA_RIDER)) + "「疲れた…」", name(gdata(GDATA_RIDER)) + "「またいつでも乗ってね♪」"
 						}
@@ -9798,11 +9801,11 @@
 						}
 					}
 				}
 				if ( cdata(CDATA_RIDING, gdata(GDATA_RIDER)) == 1 ) {
 					customtalk gdata(GDATA_RIDER), DBMODE_FLAVOR_RIDE_OFF_PC
-					gosub *convert_word
+					gosub *label_0416
 					if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 						txtef COLOR_SKY_BLUE
 						if ( jp ) {
 							txt name(gdata(GDATA_RIDER)) + "「よいしょ」", name(gdata(GDATA_RIDER)) + "「乗り心地よかった！」", name(gdata(GDATA_RIDER)) + "「疲れた？」", name(gdata(GDATA_RIDER)) + "「また乗りたいな♪」"
 						}
@@ -9834,11 +9837,11 @@
 			if ( gdata(GDATA_RIDER) == 0 ) {
 				txt lang(name(cc) + "は自分に乗ろうとした。", "You try to ride yourself.")
 			}
 			goto *effect_end
 		}
-		if ( cdata(CDATA_AREA, tc) != AREA_NONE ) {
+		if ( cdata(CDATA_AREA, tc) != 0 ) {
 			txt lang("その仲間はこの場所に滞在中だ。", "The ally currently stays in this area.")
 			goto *effect_end
 		}
 		if ( gdata(GDATA_RIDER) != 0 ) {
 			if ( cdata(CDATA_RIDING, gdata(GDATA_RIDER)) == 0 ) {
@@ -9868,11 +9871,11 @@
 			if ( rtval == 2 ) {
 				cdata(CDATA_RIDING, tc) = 1
 			}
 			if ( cdata(CDATA_RIDING, tc) == 0 ) {
 				customtalk tc, DBMODE_FLAVOR_RIDE_ON
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					txtef COLOR_SKY_BLUE
 					if ( jp ) {
 						txt name(tc) + "「うぐぅ」", name(tc) + "「ダイエットしてよ…」", name(tc) + "「いくよ！」", name(tc) + "「やさしくしてね♪」"
 					}
@@ -9881,11 +9884,11 @@
 					}
 				}
 			}
 			if ( cdata(CDATA_RIDING, tc) == 1 ) {
 				customtalk tc, DBMODE_FLAVOR_RIDE_ON_PC
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					txtef COLOR_SKY_BLUE
 					if ( jp ) {
 						txt name(tc) + "「" + cdatan(CDATAN_AKA, CHARA_PLAYER) + "、" + cdatan(CDATAN_NAME, CHARA_PLAYER) + "にライド！」", name(tc) + "「重くない？」", name(tc) + "「あんまり揺らさないでね」", name(tc) + "「レッツゴー♪」"
 					}
@@ -9938,11 +9941,11 @@
 					goto *effect_end
 				}
 			}
 			dmgsp CHARA_PLAYER, rnd(sdataref(SKILL_DATAREF_COST, efid) / 2 + 1) + sdataref(SKILL_DATAREF_COST, efid) / 2 + 1
 		}
-		gosub *perform
+		gosub *label_5986
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 184 | _switch_sw ) {
 		_switch_sw = 0
@@ -10165,11 +10168,11 @@
 	}
 	if ( _switch_val == 1120 | _switch_sw ) {
 		_switch_sw = 0
 		txtef COLOR_YELLOW
 		txt lang(name(tc) + "は黄金の輝きに包まれた！", "A golden aura wraps " + name(tc) + "!")
-		gosub *effect_elixer
+		gosub *label_6338
 		animeid = ANIMATION_HEAL
 		gosub *anime
 		goto *effect_end
 		_switch_sw++
 	}
@@ -10460,11 +10463,11 @@
 			loop
 			obvious = 0
 			goto *effect_end
 		}
 		allyctrl = 2
-		gosub *com_listNpc
+		gosub *label_5444
 		if ( stat == (-1) ) {
 			txt lang("何もおきない… ", "Nothing happens...")
 			obvious = 0
 			goto *effect_end
 		}
@@ -10480,12 +10483,12 @@
 		}
 		rc = stat
 		gosub *resurrect
 		cxinit = cdata(CDATA_X, cc)
 		cyinit = cdata(CDATA_Y, cc)
-		gosub *place_chara
-		cdata(CDATA_AREA, rc) = AREA_NONE
+		gosub *label_4125
+		cdata(CDATA_AREA, rc) = 0
 		txtef COLOR_YELLOW
 		txt cnven(cdatan(CDATAN_NAME, rc)) + lang("は復活した！", " " + have(rc) + " been resurrected!")
 		txtvalid = 0
 		txt lang("「ありがとう！」", cnvtalk("Thanks!"))
 		cdata(CDATA_CAN_REVIVE, rc)--
@@ -10680,19 +10683,19 @@
 				goto *effect_end
 			}
 			cdata(CDATA_LEVEL, tc)--
 			cdata(CDATA_EXP, tc) = 0
 			r1 = tc
-			gosub *calcExpToNextLevel
+			gosub *label_3991
 			txtef COLOR_PURPLE
 			txt lang(name(tc) + "のレベルが下がった…", name(tc) + " lose" + _s(tc) + " a level...")
 		}
 		else {
 			cdata(CDATA_EXP, tc) = cdata(CDATA_EXP_TO_NEXT_LVL, tc)
 			r1 = tc
 			r2 = 0
-			gosub *calcLevelUp
+			gosub *label_3967
 			if ( cbit(CHARA_BIT_LIVESTOCK, r1) != TRUE ) {
 				if ( synccheck(tc, -1) ) {
 					snd SOUNDLIST_DING1
 				}
 			}
@@ -11008,11 +11011,11 @@
 		if ( efid == SKILL_SPELL_SENSE_OBJECT ) {
 			gdata(GDATA_SENSE_OBJECT) = 10
 		}
 		animeload 10, tc
 		redraw 0
-		gosub *screen_raderRefresh
+		gosub *label_3797
 		if ( efid == SKILL_SPELL_SENSE_OBJECT ) {
 			if ( efstatus > (-1) ) {
 				repeat 13
 					y = cdata(CDATA_Y, tc) + cnt - 5
 					if ( y < 0 | y >= mdata(MDATA_HEIGHT) ) {
@@ -11033,11 +11036,11 @@
 										gosub *revealTrap
 										txt lang("罠を感知した。", "You discover a trap.")
 									}
 								}
 								if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_HIDDEN_PATH ) {
-									gosub *revealHiddenPath
+									gosub *label_6413
 									txt lang("隠れた通路を感知した。", "You discover a hidden path.")
 								}
 							}
 							if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SMALL_MEDAL ) {
 								if ( gdata(GDATA_AREA) != AREA_SHOW_HOUSE ) {
@@ -11342,11 +11345,11 @@
 			gosub *com_inventory
 			if ( stat != 1 ) {
 				goto *effect_end
 			}
 			inv(INV_ITEM_NUM, ci) -= 10
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		repeat 10
 			snd SOUNDLIST_BOOK1
 			await 100
 		loop
@@ -11411,11 +11414,11 @@
 			gosub *com_inventory
 			if ( stat != 1 ) {
 				goto *effect_end
 			}
 			inv(INV_ITEM_NUM, ci) -= 20
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		snd SOUNDLIST_BOOK1
 		waitbk = cfg_animewait
 		if ( cfg_animewait > 0 ) {
 			cfg_animewait = 50
@@ -11455,11 +11458,11 @@
 	if ( _switch_val == 780 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cdata(CDATA_POWER_GAUGE, cc) < 25 ) {
 			if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 				tc = cdata(CDATA_TARGET, cc)
-				gosub *act_melee
+				gosub *label_6394
 				goto *effect_end
 			}
 			gosub *FindRangeWeapon
 			if ( stat == 1 ) {
 				if ( ammo == (-1) ) {
@@ -11491,11 +11494,11 @@
 		_switch_sw = 0
 		txt lang(name(cc) + "は核砲弾を放った。", name(cc) + " shot the nuclear artillery.")
 		if ( cdata(CDATA_POWER_GAUGE, cc) < 25 ) {
 			if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 				tc = cdata(CDATA_TARGET, cc)
-				gosub *act_melee
+				gosub *label_6394
 				goto *effect_end
 			}
 			gosub *FindRangeWeapon
 			if ( stat == 1 ) {
 				if ( ammo == (-1) ) {
@@ -11565,11 +11568,11 @@
 	}
 	if ( _switch_val == 717 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		if ( cdata(CDATA_POWER_GAUGE, cc) < 100 ) {
 			txt lang("何もおきない… ", "Nothing happens...")
 			goto *effect_end
@@ -11666,11 +11669,11 @@
 			weap = sdata(SKILL_WEAPON_THROWING, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		snd SOUNDLIST_BOLT1
 		animeload 29, cc
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は武器に強烈な回転をかけて投げつけた！", name(cc) + "threw the weapon with a strong spin!")
 		if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 1000) > rnd(4000) ) {
@@ -11770,11 +11773,11 @@
 			weap = sdata(SKILL_WEAPON_SCYTHE, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は鎌で大きく薙ぎ払った！", name(cc) + " swept away with the sickle!")
 		if ( cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 7 ) {
 			if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
 				if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 1000) > rnd(2000) ) {
@@ -11844,11 +11847,11 @@
 			weap = sdata(SKILL_WEAPON_LONGSWORD, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は目にもとまらぬ速さで" + name(tc) + "を斬りつけた！", name(cc) + " slashed at an unbelievable speed!")
 		snd SOUNDLIST_THROW1
 		if ( cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 1 | cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 101 | cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 1001 ) {
 			if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
@@ -11931,11 +11934,11 @@
 			weap = sdata(SKILL_WEAPON_SHORTSWORD, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は武器を逆手で振り上げると" + name(tc) + "に勢いよく突き刺した！", name(cc) + " swung the weapon upside down and stabbed it vigorously!")
 		snd SOUNDLIST_THROW1
 		if ( cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 2 ) {
 			if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
@@ -12008,11 +12011,11 @@
 			weap = sdata(SKILL_WEAPON_AXE, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は重さを乗せた斬撃を" + name(tc) + "に叩き込んだ！", name(cc) + " slammed a heavy slash!")
 		if ( cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 3 | cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 103 ) {
 			if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
 				if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 1000) > rnd(2000) ) {
@@ -12090,11 +12093,11 @@
 			weap = sdata(SKILL_WEAPON_BOW, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は矢を束ねて上空へ放った！", name(cc) + " bundled arrows and fired them into the sky!")
 		repeat 8
 			snd SOUNDLIST_BOW1
 			await 50
@@ -12207,11 +12210,11 @@
 			weap = sdata(SKILL_WEAPON_CROSSBOW, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は矢を束ねて" + name(tc) + "の頭部へ放った！", name(cc) + " bundled the arrows and fired them at the enemy's head!")
 		snd SOUNDLIST_BOLT1
 		animeload 62, tc
 		snd SOUNDLIST_STAB
@@ -12289,11 +12292,11 @@
 			weap = sdata(SKILL_WEAPON_FIREARM, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は反動に備えながら" + name(tc) + "へ発砲した！", name(cc) + " fired in preparation for recoil!")
 		snd SOUNDLIST_GUNSHOT3
 		if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 1000) > rnd(4000) ) {
 			if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
@@ -12361,11 +12364,11 @@
 			weap = sdata(SKILL_WEAPON_FIREARM, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は正確無比に" + name(tc) + "へ弾丸を放った！", name(cc) + " fired bullets very accurately!")
 		snd SOUNDLIST_GUNSHOT1
 		await 300
 		snd SOUNDLIST_GUNSHOT1
@@ -12429,11 +12432,11 @@
 		txtef COLOR_YELLOW
 		txt lang("*" + skillname(efid) + "*　", "*" + skillname(efid) + "* ")
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		ele = SKILL_RES_FIRE
 		repeat 61 - 50, 50
 			if ( sdata(cnt, cc) >= sdata(ele, cc) ) {
 				ele = cnt
 			}
@@ -12843,11 +12846,11 @@
 			weap = sdata(SKILL_WEAPON_BLUNT, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は力任せの豪快な一撃を" + name(tc) + "に叩き込んだ！", name(cc) + " hit a brilliant blow with brute force!")
 		snd SOUNDLIST_THROW1
 		if ( cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 4 ) {
 			if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
@@ -12918,11 +12921,11 @@
 			weap = sdata(SKILL_WEAPON_POLEARM, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は一点に狙いを定め" + name(tc) + "を突き刺した！", name(cc) + " aimed at one point and stabbed the enemy!")
 		if ( cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 5 | cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 105 ) {
 			if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
 				if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 1000) > rnd(2000) ) {
@@ -13000,11 +13003,11 @@
 			weap = sdata(SKILL_WEAPON_MARTIAL_ARTS, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は" + name(tc) + "に怒涛の連続攻撃を仕掛けた！", name(cc) + " made a tremendous continuous attack!")
 		if ( cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 6 ) {
 			if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
 				if ( rnd(sdata(SKILL_NORMAL_GREATER_EVASION, tc) + 1000) > rnd(2000) ) {
@@ -13085,11 +13088,11 @@
 				weap = sdata(SKILL_NORMAL_SHIELD, cc)
 			}
 			snd SOUNDLIST_ENC
 			animeload 40, cc
 			customtalk cc, DBMODE_FLAVOR_SPECIAL
-			gosub *convert_word
+			gosub *label_0416
 			if ( synccheck(cc, -1) ) {
 				txt lang(name(cc) + "は盾で" + name(tc) + "を殴りつけた。", name(cc) + " bash" + _s(cc) + " " + name(tc) + " with " + his(cc) + " shield.")
 			}
 			if ( cdata(CDATA_ATTACK_STYLE, tc) & 1 & cdata(CDATA_SHIELD_STYLE_TYPE, tc) == 1 & cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
 				txtef COLOR_RED
@@ -13149,11 +13152,11 @@
 			weap = sdata(SKILL_WEAPON_MARTIAL_ARTS, cc)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は闘志を極限にまで高め" + name(tc) + "に打ち込んだ！", name(cc) + " attacked with the ultimate fighting spirit!")
 		if ( exgauge != 100 ) {
 			if ( cdata(CDATA_WEAPON_STYLE_TYPE, tc) == 0 ) {
 				if ( cdata(CDATA_SHIELD_STYLE_TYPE, tc) == 0 ) {
@@ -13321,11 +13324,11 @@
 		if ( gdata(GDATA_RETURN) != 0 ) {
 			txt lang("脱出を中止した。", "The air around you gradually loses power.")
 			gdata(GDATA_RETURN) = 0
 		}
 		else {
-			gosub *check_return
+			gosub *label_5756
 			if ( stat == 1 ) {
 				txt lang("依頼請負中の脱出は法律で禁止されている。それでも脱出する？", "Returning while taking a quest if forbidden. Are you sure you want to return?")
 				promptl(0, 0) = stryes, "y", "0"
 				promptl(0, 1) = strno, "n", "1"
 				promptmax = 2
@@ -14309,10 +14312,13 @@
 			gdata(GDATA_CARGO_LIMIT) -= 100 * 1000
 		}
 		snd SOUNDLIST_DING1
 		gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) = inv(INV_ITEM_PARAM1, ci)
 		gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_PIC) = gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) + inv(INV_ITEM_COL, ci) * 1000
+		if ( gdata(250 + 442) < gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) ) {
+			gdata(250 + 442) = gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND)
+		}
 		txtef COLOR_YELLOW
 		txt lang("あなたは乗り物をさっそく郊外に呼んだ。", "You called the world-vehicle out to the suburbs.")
 		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 1 ) {
 			gdata(GDATA_CARGO_LIMIT) += 10 * 1000
 		}
@@ -14323,15 +14329,11 @@
 			gdata(GDATA_CARGO_LIMIT) += 30 * 1000
 		}
 		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 4 ) {
 			gdata(GDATA_CARGO_LIMIT) += 100 * 1000
 		}
-		inv(INV_ITEM_NUM, ci)--
-		if ( ci >= 5080 ) {
-			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
-		}
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 1124 | _switch_sw ) {
 		_switch_sw = 0
@@ -14444,11 +14446,11 @@
 			}
 			else {
 				if ( rnd(limit(sdata(SKILL_NORMAL_MAGIC_CAPACITY, CHARA_PLAYER), 0, 198) + 2) == 0 ) {
 					txt lang(itemname(ci) + "は破裂した。", itemname(ci) + " explode" + _s2(inv(INV_ITEM_NUM, ci)) + ".")
 					inv(INV_ITEM_NUM, ci)--
-					gosub *calcBurdenPc
+					gosub *label_4102
 					goto *effect_end
 				}
 				txt lang(itemname(ci) + "への充填は失敗した。", "You fail to recharge " + itemname(ci) + ".")
 			}
 		}
@@ -14507,11 +14509,11 @@
 				p = p * inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci)
 				gdata(GDATA_ABSORB_CHARGE) += p
 			}
 			txt lang(itemname(ci) + "を破壊して" + p + "の魔力を抽出した(計" + gdata(GDATA_ABSORB_CHARGE) + ")", "You destroy " + itemname(ci) + " and extract " + p + " recharge powers. (Total:" + gdata(GDATA_ABSORB_CHARGE) + ")")
 			inv(INV_ITEM_NUM, ci) = 0
-			gosub *calcBurdenPc
+			gosub *label_4102
 			skillexp SKILL_NORMAL_MAGIC_CAPACITY, CHARA_PLAYER, 100
 		}
 		goto *effect_end
 		_switch_sw++
 	}
@@ -14574,11 +14576,11 @@
 			}
 			else {
 				inv(INV_ITEM_WEIGHT, ci) = inv(INV_ITEM_WEIGHT, ci) * 150 / 100 + 1000
 				txt lang("" + itemname(ci, 1) + "はずしりと重くなった。", itemname(ci, 1) + " becomes heavy.")
 			}
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		else {
 			txt lang("何もおきない… ", "Nothing happens...")
 			obvious = 0
 		}
@@ -14638,11 +14640,11 @@
 				else {
 					break
 				}
 			loop
 			txt lang("それは" + itemname(ci, 1) + "に変容した。", "It is metamorphosed into " + itemname(ci, 1) + ".")
-			gosub *calcBurdenPc
+			gosub *label_4102
 		}
 		else {
 			txt lang("何もおきない… ", "Nothing happens...")
 			obvious = 0
 		}
@@ -14758,11 +14760,11 @@
 		_switch_sw = 0
 		if ( cdata(CDATA_GOLD, cc) < 2000 ) {
 			goto *effect_end
 		}
 		repeat 10
-			gosub *com_findTarget
+			gosub *label_5748
 			if ( listmax == 0 ) {
 				break
 			}
 			tc = list(0, rnd(listmax))
 			if ( cc == CHARA_PLAYER | cdata(CDATA_RELATION, cc) >= RELATION_NEUTRAL ) {
@@ -14851,11 +14853,11 @@
 	}
 	if ( _switch_val == 631 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		txtef COLOR_BLUE
 		txt lang("スウォーム！", "Swarm!")
 		repeat 245
@@ -14891,20 +14893,20 @@
 			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
 				continue
 			}
 			animeid = ANIMATION_ATTACK
 			gosub *anime
-			gosub *act_melee
+			gosub *label_6394
 		loop
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 738 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		txtef COLOR_BLUE
 		txt lang("ストラックアウト！", "Struck Out!")
 		tcbk = tc
@@ -15713,11 +15715,11 @@
 						snd SOUNDLIST_CRUSH1
 						txtef COLOR_GREEN
 						txt lang("錠の破壊に成功した！", "You fail to unlock it.")
 						ri = ci
 						cc = CHARA_PLAYER
-						gosub *open_chest
+						gosub *label_6382
 						breakstr = 0
 						skillexp SKILL_ATTR_STR, CHARA_PLAYER, 50
 						skillexp SKILL_NORMAL_LOCK_PICKING, CHARA_PLAYER, 40 + inv(INV_ITEM_PARAM2, ci) / 3
 						repeat 16 - 1, 1
 							if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
@@ -15808,11 +15810,11 @@
 					gdata(GDATA_FLAG_TOTAL_POTION_PLUGS)++
 				}
 			}
 			inv(INV_ITEM_NUM, ci)--
 			if ( cc == CHARA_PLAYER ) {
-				gosub *calcBurdenPc
+				gosub *label_4102
 			}
 			waitbk = cfg_animewait
 			if ( cfg_animewait > 0 ) {
 				cfg_animewait = 0
 			}
@@ -15887,11 +15889,11 @@
 			snd SOUNDLIST_ATK_ELEC
 			txtef COLOR_BLUE
 			txt lang(itemname(ci) + "が高速で射出された。", itemname(ci) + " was launched at high speed.")
 			inv(INV_ITEM_NUM, ci)--
 			if ( cc == CHARA_PLAYER ) {
-				gosub *calcBurdenPc
+				gosub *label_4102
 			}
 			waitbk = cfg_animewait
 			if ( cfg_animewait > 0 ) {
 				cfg_animewait = 1
 			}
@@ -15951,11 +15953,11 @@
 					gdata(GDATA_FLAG_TOTAL_POTION_PLUGS)++
 				}
 			}
 			inv(INV_ITEM_NUM, ci)--
 			if ( cc == CHARA_PLAYER ) {
-				gosub *calcBurdenPc
+				gosub *label_4102
 			}
 			waitbk = cfg_animewait
 			if ( cfg_animewait > 0 ) {
 				cfg_animewait = 0
 			}
@@ -16046,11 +16048,11 @@
 	}
 	if ( _switch_val == 700 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		gosub *FindRangeWeapon
 		if ( stat == 1 ) {
 			if ( ammo == (-1) ) {
@@ -16177,11 +16179,11 @@
 					continue
 				}
 				tc = tcbk
 				if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 					extraattack = 0
-					gosub *act_melee
+					gosub *label_6394
 					if ( cc != CHARA_PLAYER ) {
 						snd SOUNDLIST_ATK_FIRE
 					}
 					attackvar = 0
 					ammoproc = ENCHANT_AMMO_NONE
@@ -16266,11 +16268,11 @@
 			}
 			if ( cdata(CDATA_CONDITION_SLEEP, tc) != 0 | cdata(CDATA_CONDITION_DIM, cc) >= 60 | cdata(CDATA_CONDITION_PARALYZE, tc) != 0 | cdata(CDATA_CONDITION_SUFFOCATION, tc) != 0 | cdata(CDATA_CONDITION_BRAINWASH, tc) != 0 ) {
 				continue
 			}
 			customtalk tc, DBMODE_FLAVOR_MULTIPLE
-			gosub *convert_word
+			gosub *label_0416
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( jp ) {
 					txt cdatan(CDATAN_NAME, tc) + "は" + cdatan(CDATAN_NAME, cc) + "に重ねて詠唱した。"
 				}
 			}
@@ -16314,11 +16316,11 @@
 	}
 	if ( _switch_val == 697 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		waitbk = cfg_animewait
 		attackbk = cfg_attackanime
 		if ( cfg_animewait > 0 ) {
@@ -16334,20 +16336,20 @@
 			}
 			extraattack = 0
 			animeid = ANIMATION_NORMAL_ATTACK
 			gosub *anime
 			snd SOUNDLIST_ATK2
-			gosub *act_melee
+			gosub *label_6394
 		loop
 		if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
 			snd SOUNDLIST_BOLT1
 		}
 		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
 			animeid = ANIMATION_NORMAL_ATTACK
 			gosub *anime
 			snd SOUNDLIST_BOLT1
-			gosub *act_melee
+			gosub *label_6394
 		}
 		cfg_animewait = waitbk
 		cfg_attackanime = attackbk
 		gdata(GDATA_TEMPORARY_FLAGS2) = 0
 		goto *effect_end
@@ -16430,11 +16432,11 @@
 			if ( cdata(CDATA_IMPRESSION, tc) < 100 ) {
 				continue
 			}
 			snd SOUNDLIST_OFFER2
 			customtalk tc, DBMODE_FLAVOR_KIZUNA
-			gosub *convert_word
+			gosub *label_0416
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( jp ) {
 					txt "「まだ戦える！」", "「勝負はこれから！」", "「心を一つに…！」", "「絆パワー！」"
 				}
 			}
@@ -17114,11 +17116,11 @@
 	if ( _switch_val == 686 | _switch_sw ) {
 		_switch_sw = 0
 		snd SOUNDLIST_OFFER2
 		animeload 32, tc
 		cc = tc
-		gosub *skill_charge
+		gosub *label_5999
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 828 | _switch_sw ) {
 		_switch_sw = 0
@@ -17402,11 +17404,11 @@
 				if ( cdata(CDATA_ROW_ACT, rc) != ACTION_NONE ) {
 					rowactend rc
 				}
 				map(cdata(CDATA_X, rc), cdata(CDATA_Y, rc), MAP_CHARA_INDEX_PLUS_ONE) = 0
 				cdata(CDATA_EXIST, rc) = CHAR_STATE_ALLY_WAIT
-				cdata(CDATA_AREA, rc) = AREA_NONE
+				cdata(CDATA_AREA, rc) = 0
 				if ( cdata(CDATA_IN_TAGTEAM, rc) == (-1) ) {
 					ttc = cdata(CDATA_TAGTEAM_PARTNER, rc)
 					cell_setchara ttc, cdata(CDATA_X, rc), cdata(CDATA_Y, rc)
 					tag_end rc
 				}
@@ -17437,27 +17439,65 @@
 			txt cnven(cdatan(CDATAN_NAME, rc)) + lang("を呼び出した。", " " + have(rc) + " appeared out of nowhere.")
 			cdata(CDATA_EXIST, rc) = CHAR_STATE_ALIVE
 			cdata(CDATA_RELATION, rc) = cdata(CDATA_RELATION_ORG, rc)
 			cxinit = cdata(CDATA_X, CHARA_PLAYER)
 			cyinit = cdata(CDATA_Y, CHARA_PLAYER)
-			gosub *place_chara
-			cdata(CDATA_AREA, rc) = AREA_NONE
+			gosub *label_4125
+			cdata(CDATA_AREA, rc) = 0
 		}
 		gosub *screen_draw
 		return 0
 		goto *effect_end
 		_switch_sw++
 	}
+	if ( _switch_val == 843 | _switch_sw ) {
+		_switch_sw = 0
+		if ( cc == CHARA_PLAYER ) {
+			txtnew
+			txt lang("まずは輸血元を選ぶ必要がある。", "Choose a blood transfusion source.")
+			txtmore
+			rcbk = rc
+			rc = -1
+			allyctrl = 5
+			gosub *label_5444
+			if ( stat == (-1) ) {
+				rc = rcbk
+				goto *effect_end
+			}
+			rc = stat
+			txtnew
+			txt lang("輸血先を選ぶ必要がある。", "Choose a blood transfusion destination.")
+			txtmore
+			allyctrl = 5
+			gosub *label_5444
+			if ( stat == (-1) ) {
+				goto *effect_end
+			}
+			tc = stat
+			snd SOUNDLIST_HEART1
+			txt lang(name(cc) + "は" + name(rc) + "から" + name(tc) + "へ輸血した。", name(cc) + " transfused blood from " + name(rc) + " to " + name(tc) + ".")
+			bleedbk = cdata(CDATA_CONDITION_BLEED, rc)
+			dmgcon rc, CONDITION_BLEED, sdata(SKILL_NORMAL_GENE_ENGINEER, cc) / 2 + 1
+			hostileaction cc, rc
+			bleed = cdata(CDATA_CONDITION_BLEED, rc) - bleedbk
+			healcon tc, CONDITION_BLEED, bleed
+			gain_iden rc, tc, 5
+			screenupdate = -1
+			gosub *screen_draw
+		}
+		goto *effect_end
+		_switch_sw++
+	}
 	if ( _switch_val == 767 | _switch_sw ) {
 		_switch_sw = 0
-		gosub *perform_dance
+		gosub *label_5991
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 713 | _switch_sw ) {
 		_switch_sw = 0
-		gosub *perform_preach
+		gosub *label_5996
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 830 | _switch_sw ) {
 		_switch_sw = 0
@@ -17513,23 +17553,23 @@
 	}
 	if ( _switch_val == 685 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		bakuretu = 100
-		gosub *act_melee
+		gosub *label_6394
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 760 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		if ( cdata(CDATA_POWER_GAUGE, cc) >= 25 ) {
 			snd SOUNDLIST_ATK_FIRE
 			animeload 20, cc
@@ -17546,11 +17586,11 @@
 	}
 	if ( _switch_val == 737 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		bakuretu = 200
 		efid = SKILL_SPACT_SHADOW_STEP
 		gosub *effect
@@ -17559,23 +17599,23 @@
 	}
 	if ( _switch_val == 742 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		bakuretu = 300
-		gosub *act_melee
+		gosub *label_6394
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 745 | _switch_sw ) {
 		_switch_sw = 0
 		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 			tc = cdata(CDATA_TARGET, cc)
-			gosub *act_melee
+			gosub *label_6394
 			goto *effect_end
 		}
 		if ( tc == cc ) {
 			txt lang("それは無理だ。", "It's impossible.")
 			return
@@ -17583,11 +17623,11 @@
 		if ( cdata(CDATA_HP, tc) < cdata(CDATA_MAX_HP, tc) / 20 | cdata(CDATA_HP, tc) == 0 ) {
 			txt lang("これ以上やると死んでしまう…。", "If you attack any more, opponent will die ....")
 			return
 		}
 		gdata(GDATA_TEMPORARY_FLAGS2) = 888
-		gosub *act_melee
+		gosub *label_6394
 		gdata(GDATA_TEMPORARY_FLAGS2) = 0
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 766 | _switch_sw ) {
@@ -17985,11 +18025,11 @@
 			txt lang(name(cc) + "は挑発を行った。", name(cc) + " provoke enemy.")
 		}
 		txtmore
 		txtef COLOR_SKY_BLUE
 		customtalk cc, DBMODE_FLAVOR_INSULT
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			if ( jp ) {
 				if ( cdata(CDATA_SEX, cc) == 0 ) {
 					txt "「命をかけてかかってこい」", "「お前の全てを否定してやる」", "「捕まえてみな」", "「遊ぼうか」", "「覚悟はいいか？」", "「無理をするな。結果はどうせ一緒だ」", "「そう粋がるなよ」"
 				}
@@ -18088,13 +18128,13 @@
 			if ( rtval == 0 ) {
 				return 0
 			}
 			if ( rtval == 4 ) {
 				if ( cdata(CDATA_TARGET, CHARA_PLAYER) == 0 ) {
-					gosub *findTarget
+					gosub *label_5740
 				}
-				gosub *com_findTarget
+				gosub *label_5748
 				if ( listmax == 0 ) {
 					txt lang("視界内にターゲットは存在しない。", "You look around and find nothing.")
 					return 0
 				}
 			}
@@ -18506,11 +18546,11 @@
 			if ( 0 ) {
 				txt lang("力が" + over + "足…。", "Force is not enough...")
 			}
 			cdata(CDATA_POWER_GAUGE, ovtc) = 0
 			customtalk ovtc, DBMODE_FLAVOR_SPECIAL
-			gosub *convert_word
+			gosub *label_0416
 		loop
 		cfg_animewait = waitbk
 		if ( over == 0 ) {
 			txt lang("力が足りない…。", "Force is not enough...")
 			goto *effect_end
@@ -18533,11 +18573,11 @@
 			over += overs * sqrt(overs) * 5 + rnd(overs + 1)
 		}
 		animeload 68, cc
 		snd SOUNDLIST_BREATH1
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		animeid = ANIMATION_UNISON_IMPACT1
 		anic = tc
 		gosub *anime
 		snd SOUNDLIST_ENC
 		snd SOUNDLIST_PUNISH1
@@ -18801,11 +18841,11 @@
 		if ( axeitem == 0 ) {
 			txt lang("伐採するための道具を持っていない。", "You have no item to cut tree.")
 			goto *effect_end
 		}
 		gdata(GDATA_ROW_ACT) = ACTION_CUT_TREE
-		gosub *generalAct
+		gosub *label_6023
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 816 | _switch_sw ) {
 		_switch_sw = 0
@@ -18865,31 +18905,31 @@
 			goto *effect_end
 		}
 		if ( efid == SKILL_SPACT_PERSUASION ) {
 			snd SOUNDLIST_CHAT
 			animeload 73, cc
-			gosub *skill_persuasion
+			gosub *label_6001
 		}
 		if ( efid == SKILL_SPACT_PECULIAR_JOKE ) {
 			snd SOUNDLIST_CHAT
 			animeload 73, cc
-			gosub *skill_peculiar_joke
+			gosub *label_6004
 		}
 		if ( efid == SKILL_SPACT_BLENDED_LIE ) {
 			snd SOUNDLIST_CHAT
 			animeload 73, cc
-			gosub *skill_blended_lie
+			gosub *label_6007
 		}
 		if ( efid == SKILL_SPACT_INTIMIDATION ) {
 			snd SOUNDLIST_CHAT
 			animeload 73, cc
-			gosub *skill_intimidation
+			gosub *label_6010
 		}
 		if ( efid == SKILL_SPACT_MYSTERIOUS_SONG ) {
 			snd SOUNDLIST_OFFER2
 			animeload 24, cc
-			gosub *skill_mysterious_song
+			gosub *label_6013
 		}
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 701 | _switch_sw ) {
@@ -19030,11 +19070,11 @@
 				goto *effect_end
 			}
 			if ( cdata(CDATA_IMPRESSION, tc) >= 200 ) {
 				cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
 				customtalk tc, DBMODE_FLAVOR_NADE
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SPACE_HORNED_OWL ) {
 							txtef COLOR_YELLOW
 							txt "「ファー…ブルスコ…ファー…ブルスコ…」"
@@ -19087,11 +19127,11 @@
 			goto *effect_end
 		}
 		if ( rnd(sdata(SKILL_ATTR_CHA, cc) + cdata(CDATA_IMPRESSION, tc)) >= rnd(sdata(SKILL_ATTR_WIL, tc)) ) {
 			dmgcon tc, CONDITION_BLEED, 75
 			customtalk tc, DBMODE_FLAVOR_FAWN_ON
-			gosub *convert_word
+			gosub *label_0416
 			if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 				if ( jp ) {
 					txtef COLOR_YELLOW
 					txt name(tc) + "は静かに悶えている！", "「そ、そんな目で見ないで" + _kure(3) + "！」", "*キュン♪1*"
 				}
@@ -19695,11 +19735,11 @@
 						txtef COLOR_BLUE
 						txt lang(name(tc) + "は必死に抵抗したが、あなたの力は強かった。", name(cc) + " squeesed " + _s(cc) + " " + name(tc) + ".")
 						modkarma 0, -20
 						if ( jp ) {
 							customtalk tc, DBMODE_FLAVOR_INSULT
-							gosub *convert_word
+							gosub *label_0416
 							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 								txt name(tc) + "はあきらめが悪く、まだジタバタしている…。", "「こんなのってない" + _yo(3) + "！」", "「どうしてこうなった…」", "「こんなことするなんて、見損なった" + _yo(3) + "！」", "「この犯罪者！」"
 							}
 						}
 						soine = 1000
@@ -19709,11 +19749,11 @@
 						txtef COLOR_GREEN
 						txt lang(name(tc) + "は形だけの抵抗しか見せなかった。", name(cc) + " squeesed " + _s(cc) + " " + name(tc) + ".")
 						cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
 						if ( jp ) {
 							customtalk tc, DBMODE_FLAVOR_HUG
-							gosub *convert_word
+							gosub *label_0416
 							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 								txt name(tc) + "はふっと力を抜くと、身体をあなたに預けた。", "「あーれー」", "「まったく、甘えん坊さん" + _dana(3) + "」"
 							}
 						}
 					}
@@ -19721,11 +19761,11 @@
 						soine = 2000
 						txtef COLOR_GREEN
 						txt lang(name(tc) + "は抱擁を振りほどくと、あなたをベッドへ押さえつけた。", name(cc) + " squeesed " + _s(cc) + " " + name(tc) + ".")
 						if ( jp ) {
 							customtalk cc, DBMODE_FLAVOR_INSULT2
-							gosub *convert_word
+							gosub *label_0416
 							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 								txt name(tc) + "はあなたを見下ろして冷笑を浮かべた。", "「おっと、こんなところに抱き枕が」", "「覚悟はできている" + _kana(3) + "？」"
 							}
 						}
 					}
@@ -19787,11 +19827,11 @@
 				cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
 				if ( cdata(CDATA_CONDITION_BRAINWASH, tc) > 1 ) {
 					cdata(CDATA_CONDITION_BRAINWASH, tc) = 1
 				}
 				customtalk tc, DBMODE_FLAVOR_HUG
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						txt name(tc) + "は無言で抱きしめ返してきた。", "「あたたかい…」", "「幸せな気分" + _dana(3) + "」"
 					}
 				}
@@ -19851,11 +19891,11 @@
 				cdata(CDATA_EMO_ICON, tc) = 17 + 100 * 3
 				if ( cdata(CDATA_CONDITION_BRAINWASH, tc) > 1 ) {
 					cdata(CDATA_CONDITION_BRAINWASH, tc) = 1
 				}
 				customtalk tc, DBMODE_FLAVOR_KISS
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						txt "「大好き♪1」", "「んっ…♪」", "「もっと…して」", "「キスだけじゃいや…」"
 					}
 				}
@@ -19970,11 +20010,11 @@
 			goto *effect_end
 		}
 		if ( cdata(CDATA_EXIST, cdata(CDATA_TARGET, tc)) == CHAR_STATE_ALIVE ) {
 			if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
 				tc = cdata(CDATA_TARGET, cc)
-				gosub *act_melee
+				gosub *label_6394
 				goto *effect_end
 			}
 		}
 		if ( cdata(CDATA_EXIST, cdata(CDATA_TARGET, tc)) == CHAR_STATE_ALIVE & dist(cdata(CDATA_X, cdata(CDATA_TARGET, tc)), cdata(CDATA_Y, cdata(CDATA_TARGET, tc)), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) > 1 ) {
 			tc = cdata(CDATA_TARGET, tc)
@@ -20937,11 +20977,11 @@
 			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
 				continue
 			}
 			cc = tc
 			tc = ccbk
-			gosub *skill_tuin_der_lusten
+			gosub *label_6021
 			cc = ccbk
 		loop
 		goto *effect_end
 		_switch_sw++
 	}
@@ -20951,11 +20991,11 @@
 		if ( stat != (-1) | cc != CHARA_PLAYER ) {
 			if ( cc == CHARA_PLAYER ) {
 				inv(INV_ITEM_NUM, stat)--
 			}
 			if ( cc == CHARA_PLAYER ) {
-				gosub *calcBurdenPc
+				gosub *label_4102
 			}
 			if ( synccheck(cc, -1) ) {
 				animeid = ANIMATION_AROMAGEDDON
 				gosub *anime
 			}
@@ -21273,12 +21313,12 @@
 					card(0, cnt)++
 				loop
 				cdata(CDATA_PIETY, CHARA_PLAYER) = sdata(SKILL_NORMAL_FAITH, CHARA_PLAYER) * 100
 				gdata(GDATA_RANK_HOME) = 100
 				gdata(GDATA_WORLD_RENEW) = TRUE
-				gdata(GDATA_YEAR) += 20
-				gosub *advance_hour
+				gdata(GDATA_MONTH) = 11
+				gosub *label_9228
 				gdata(GDATA_GUEST) = 2
 				gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) += 95
 				cdata(CDATA_SKILLPOINT, CHARA_PLAYER) += 95
 				gdata(GDATA_FLAG_DESTINY_LETTERS) = 7
 				repeat 16
@@ -21688,10 +21728,82 @@
 		cdata(CDATA_CONDITION_ANGRY, tc) += 3
 		cdata(CDATA_CONDITION_WET, tc) += 3
 		goto *effect_end
 		_switch_sw++
 	}
+	if ( _switch_val == 844 | _switch_sw ) {
+		_switch_sw = 0
+		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
+			goto *effect_end
+		}
+		snd SOUNDLIST_ATK_ELEC
+		animeload 18, tc
+		if ( cdata(CDATA_RELATION, tc) == RELATION_ENEMY | cdata(CDATA_RELATION, cc) == RELATION_ENEMY ) {
+			txt lang(name(cc) + "は" + name(tc) + "に強烈な電気ショックを加えた！「ぎゃっ！？」", name(cc) + " gave " + name(tc) + " strong electric shocks.")
+			snd SOUNDLIST_HEART1
+			dmghp tc, (sdata(SKILL_ATTR_DEX, cc) / 5 + 4) * ((sdata(SKILL_NORMAL_GENE_ENGINEER, cc) + 1) / 5 + 3) + rnd(sdata(SKILL_NORMAL_GENE_ENGINEER, cc) * 2 + 5) + 1, cc, SKILL_RES_LIGHTNING, 1000 + sdata(SKILL_NORMAL_GENE_ENGINEER, cc)
+			dmghp tc, (sdata(SKILL_ATTR_DEX, cc) / 5 + 4) * ((sdata(SKILL_NORMAL_GENE_ENGINEER, cc) + 1) / 5 + 3) + rnd(sdata(SKILL_NORMAL_GENE_ENGINEER, cc) * 2 + 5) + 1, cc, SKILL_RES_LIGHTNING, 1000 + sdata(SKILL_NORMAL_GENE_ENGINEER, cc)
+			dmghp tc, (sdata(SKILL_ATTR_DEX, cc) / 5 + 4) * ((sdata(SKILL_NORMAL_GENE_ENGINEER, cc) + 1) / 5 + 3) + rnd(sdata(SKILL_NORMAL_GENE_ENGINEER, cc) * 2 + 5) + 1, cc, SKILL_RES_LIGHTNING, 1000 + sdata(SKILL_NORMAL_GENE_ENGINEER, cc)
+			dmghp tc, (sdata(SKILL_ATTR_DEX, cc) / 5 + 4) * ((sdata(SKILL_NORMAL_GENE_ENGINEER, cc) + 1) / 5 + 3) + rnd(sdata(SKILL_NORMAL_GENE_ENGINEER, cc) * 2 + 5) + 1, cc, SKILL_RES_LIGHTNING, 1000 + sdata(SKILL_NORMAL_GENE_ENGINEER, cc)
+			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
+				skillexp SKILL_NORMAL_GENE_ENGINEER, cc, 40
+			}
+			goto *effect_end
+		}
+		else {
+			txt lang(name(cc) + "は" + name(tc) + "の胸に電気ショックを加えた。「ぐはぁ！？」", name(cc) + " gave " + name(tc) + " electric shocks.")
+			if ( cc == CHARA_PLAYER ) {
+				if ( tc != CHARA_PLAYER ) {
+					modkarma cc, -1
+				}
+			}
+			if ( cdata(CDATA_CONDITION_SUFFOCATION, tc) > 0 ) {
+				cdata(CDATA_CONDITION_SUFFOCATION, tc) = cdata(CDATA_CONDITION_SUFFOCATION, tc) / 2
+			}
+			if ( cdata(CDATA_CONDITION_DIM, tc) > 60 ) {
+				cdata(CDATA_CONDITION_DIM, tc) = 59
+			}
+			if ( cdata(CDATA_CONDITION_SLEEP, tc) > 0 ) {
+				cdata(CDATA_CONDITION_SLEEP, tc) = 0
+			}
+			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
+				skillexp SKILL_NORMAL_GENE_ENGINEER, cc, 40
+			}
+		}
+		goto *effect_end
+		_switch_sw++
+	}
+	if ( _switch_val == 845 | _switch_sw ) {
+		_switch_sw = 0
+		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
+			goto *effect_end
+		}
+		snd SOUNDLIST_CARD1
+		await 50
+		snd SOUNDLIST_CARD1
+		if ( cdata(CDATA_RELATION, tc) == RELATION_ENEMY | cdata(CDATA_RELATION, cc) == RELATION_ENEMY ) {
+			txt lang(name(cc) + "は" + name(tc) + "の身体を素早く縫いつけた！", name(cc) + " sewed " + name(tc) + " up quickly!")
+			if ( cdata(CDATA_CONDITION_BIND, tc) < 10 ) {
+				cdata(CDATA_CONDITION_BIND, tc) = 10
+			}
+			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
+				skillexp SKILL_NORMAL_TAILORING, cc, 40
+			}
+			goto *effect_end
+		}
+		else {
+			txt lang(name(cc) + "は" + name(tc) + "の身体を素早く縫合した！", name(cc) + " sewed " + name(tc) + " up quickly!")
+			if ( cdata(CDATA_CONDITION_BLEED, tc) > 0 ) {
+				cdata(CDATA_CONDITION_BLEED, tc) = cdata(CDATA_CONDITION_BLEED, tc) / 2
+			}
+			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
+				skillexp SKILL_NORMAL_TAILORING, cc, 40
+			}
+		}
+		goto *effect_end
+		_switch_sw++
+	}
 	if ( _switch_val == 769 | _switch_sw ) {
 		_switch_sw = 0
 		if ( tc == cc | (cc != CHARA_PLAYER & dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) > 1) ) {
 			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
 				goto *effect_end
@@ -22073,11 +22185,11 @@
 			weap = limit((sdata(SKILL_ATTR_CON, cc) + sqrt(gdata(GDATA_LEVEL) + 1) * 2) / 2, 1, 2000)
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		inv_getheader cc
 		eqlv = 1
 		eqbui = 0
 		repeat invrange, invhead
 			if ( inv(INV_ITEM_NUM, cnt) == 0 | inv(INV_ITEM_EQUIP, cnt) == 0 ) {
@@ -22541,11 +22653,11 @@
 			if ( synccheck(tc, -1) ) {
 				txt lang(name(cc) + "は" + name(tc) + "を罵倒した。", name(cc) + " insult" + _s(cc) + " " + name(tc) + ".")
 				txtmore
 				txtef COLOR_SKY_BLUE
 				customtalk cc, DBMODE_FLAVOR_INSULT
-				gosub *convert_word
+				gosub *label_0416
 				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 					if ( jp ) {
 						if ( cdata(CDATA_SEX, cc) == 0 ) {
 							txt "「すっこんでろ雑魚め」", "「オマエ程度が戦うだと？」", "「すぐに殺してやるよ」", "「消えろザコめ」", "「このかたつむり野郎」", "「こんなヤツに本気を出してやる価値はあるのか…？」", "「マッハでミンチにしてやるよ」", "「まったく…度し難いな」"
 						}
@@ -22899,11 +23011,11 @@
 			weap = sdata(SKILL_ATTR_MAG, cc) / 2
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "の眼から眩い光が放たれた！", name(cc) + " shot a dazzling light from the eye.")
 		snd SOUNDLIST_CRUSH2
 		snd SOUNDLIST_ATK_ICE
 		snd SOUNDLIST_ATK_ICE
@@ -22965,11 +23077,11 @@
 			cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) = 0
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		if ( cdata(CDATA_ID, cc) == CREATURE_ID_MAILE_THE_MARIONETTE_SHAMAN ) {
 			txtef COLOR_YELLOW
 			txt lang("「くっ…やはり合意がないと充分な力が出ませんね」", "Maile seems not to have enough power.")
 		}
 		else {
@@ -23015,11 +23127,11 @@
 			cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) = 0
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		snd SOUNDLIST_WAVE
 		animeload 23, tc
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "の声が" + name(tc) + "の心に響く！", "Voice of " + name(cc) + " echoes in mind of " + name(tc) + "!")
 		inv_getheader cc
@@ -23104,11 +23216,11 @@
 			snd SOUNDLIST_ATK_MIND
 		}
 		snd SOUNDLIST_ENC
 		animeload 40, cc
 		customtalk cc, DBMODE_FLAVOR_SPECIAL
-		gosub *convert_word
+		gosub *label_0416
 		snd SOUNDLIST_BOLT1
 		animeload 59, tc
 		txtef COLOR_GREEN
 		txt lang(name(cc) + "は" + name(tc) + "に激しい閃光を叩きつけた！", name(cc) + " slammed the dazzling light to " + name(tc) + "!")
 		inv_getheader cc
@@ -23174,10 +23286,12 @@
 		}
 		juice = 1
 		if ( tc != CHARA_PLAYER ) {
 			juice = 15
 		}
+		flt
+		itemcreate -1, 1263, cdata(CDATA_X, tc), cdata(CDATA_Y, tc), 0
 		if ( inv(INV_ITEM_PARAM1, ci) / 1000 == 2 ) {
 			if ( ibit(ITEM_BIT_HERBED_IN, ci) != TRUE ) {
 				skillexp SKILL_ATTR_WIL, tc, 50 * juice
 				skillexp SKILL_ATTR_LER, tc, 50 * juice
 			}
@@ -23328,11 +23442,11 @@
 			}
 		}
 		else {
 			gosub *insta_eat
 		}
-		gosub *calcBurdenPc
+		gosub *label_4102
 		goto *effect_end
 		_switch_sw++
 	}
 	if ( _switch_val == 464 | _switch_sw ) {
 		_switch_sw = 0
@@ -23452,13 +23566,13 @@
 		healcon tc(cnt), CONDITION_BLEED, 20
 		healsan tc(cnt), 1
 	loop
 	return
 
-*label_6324
+*label_6333
 	allyctrl = 4
-	gosub *com_listNpc
+	gosub *label_5444
 	txt lang("誰を指導しようか。", "Who will you lead?")
 	if ( p != (-1) ) {
 		tc = p
 		dx = cdata(CDATA_X, tc)
 		dy = cdata(CDATA_Y, tc)
@@ -23463,29 +23577,29 @@
 		dx = cdata(CDATA_X, tc)
 		dy = cdata(CDATA_Y, tc)
 		if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("範囲外だ。", "Out of range.")
-			goto *label_6324
+			goto *label_6333
 		}
 		if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("範囲外だ。", "Out of range.")
-			goto *label_6324
+			goto *label_6333
 		}
 		if ( cdata(CDATA_DRAIN_HP, tc) >= 100 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("手遅れだ。", "It's too late to lead.")
-			goto *label_6324
+			goto *label_6333
 		}
 		if ( cdata(CDATA_DRAIN_HP, tc) <= 0 ) {
 			snd SOUNDLIST_FAIL1
 			txt lang("指導の必要はなさそうだ。", "There seems to be no need for leading.")
-			goto *label_6324
+			goto *label_6333
 		}
 		customtalk tc, DBMODE_FLAVOR_LEADING
-		gosub *convert_word
+		gosub *label_0416
 		if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
 			txtef COLOR_SKY_BLUE
 			if ( jp ) {
 				txt name(tc) + "「了解！」", name(tc) + "「気をつける" + _yo(3) + "」", name(tc) + "「なるほど…」", name(tc) + "「ＯＫ」"
 			}
@@ -23548,10 +23662,24 @@
 			}
 			else {
 				return
 			}
 		}
+		if ( cbit(1034, tc) == TRUE ) {
+			if ( cdata(CDATA_SPRITE_SIZE_MILK, tc) == (-1) ) {
+				if ( rnd(2) == 0 ) {
+					snd SOUNDLIST_FAIL1
+					if ( jp ) {
+						txt cdatan(CDATAN_NAME, tc) + "「指図しないで" + _kure(3) + "」", cdatan(CDATAN_NAME, tc) + "「今やろうと思っていたのにやる気がなくなった" + _yo(3) + "」"
+					}
+					if ( en ) {
+						txt cdatan(CDATAN_NAME, tc) + " " + cnvtalk("Please don't give instructions!"), cdatan(CDATAN_NAME, tc) + " " + cnvtalk("I thought I would do it now, but I've lost my motivation!")
+					}
+					goto *effect_directive
+				}
+			}
+		}
 		if ( rtval == 0 ) {
 			goto *effect_directive
 		}
 		if ( rtval == 1 ) {
 			cdata(CDATA_DIRECTIVE_MODE, tc) = DIRECTIVE_MODE_OFFENSIVE
@@ -23624,19 +23752,19 @@
 				if ( rtval == 10 ) {
 					amp = ENCHANT_AMMO_RAPID
 				}
 				change = 0
 				repeat 15
-					if ( inv(40 + cnt * 2, ci) == 0 ) {
+					if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) == 0 ) {
 						break
 					}
-					enc = inv(40 + cnt * 2, ci)
+					enc = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci)
 					i = enc / 10000
 					if ( i != 0 ) {
 						enc = enc \ 10000
 						if ( i == 9 ) {
-							if ( inv(40 + cnt * 2, ci) \ 10000 == amp ) {
+							if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, ci) \ 10000 == amp ) {
 								inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = cnt
 								change = 1
 								break
 							}
 						}
@@ -23647,11 +23775,11 @@
 					txt lang(cdatan(CDATAN_NAME, tc) + "の矢弾はその切替に対応していない。", itemname(ci) + " isn't capable of that ammos.")
 					goto *effect_directive
 				}
 				snd SOUNDLIST_AMMO
 				change = 0
-				i = inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) \ 1000, inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) / 1000
+				i = inv(STARTING_INV_ITEM_ENCHANT + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) \ 1000, inv(STARTING_INV_ITEM_ENCHANT + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) / 1000
 				s = ammoname(amp), "" + i + "/" + i(1)
 				s = s + ":" + s(1)
 				txtef COLOR_GREEN
 				txt lang(cdatan(CDATAN_NAME, tc) + "は" + s + "に切り替えた。", "Current Ammo Type")
 			}
@@ -23662,11 +23790,11 @@
 		signal = 0
 		return 0
 	}
 	return
 
-*effect_elixer
+*label_6338
 	cdata(CDATA_CONDITION_MPOISON, tc) = 0
 	cdata(CDATA_CONDITION_POISON, tc) = 0
 	cdata(CDATA_CONDITION_SLEEP, tc) = 0
 	cdata(CDATA_CONDITION_CONFUSE, tc) = 0
 	cdata(CDATA_CONDITION_BLIND, tc) = 0
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/quest.hsp ../2.14-borscht/quest.hsp
--- ../2.13-borscht/quest.hsp	2022-06-26 12:14:17.400890800 -0700
+++ ../2.14-borscht/quest.hsp	2022-09-18 12:37:02.126863100 -0700
@@ -1,580 +1,580 @@
 *client_update
 	repeat 245 - 57, 57
-		if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_DEAD ) {
+		if ( cExist(cnt) == CHAR_STATE_DEAD ) {
 			continue
 		}
-		if ( cdata(CDATA_ROLE, cnt) == ROLE_NONE ) {
+		if ( cRole(cnt) == ROLE_NONE ) {
 			continue
 		}
-		if ( cdata(CDATA_QUALITY, cnt) == FIX_QUALITY_UNIQUE ) {
+		if ( cQuality(cnt) == FIX_QUALITY_UNIQUE ) {
 			continue
 		}
-		if ( cdata(CDATA_ROLE, cnt) == ROLE_SPECIAL ) {
+		if ( cRole(cnt) == ROLE_SPECIAL ) {
 			continue
 		}
-		if ( cdata(CDATA_RELATION, cnt) == RELATION_DISLIKE ) {
+		if ( cRelation(cnt) == RELATION_DISLIKE ) {
 			continue
 		}
 		if ( cnt == 0 ) {
 			continue
 		}
 		i = -1
 		repeat 500
-			if ( qdata(QDATA_CLIENT, cnt) == 0 ) {
+			if ( qClient(cnt) == 0 ) {
 				i = cnt
 				break
 			}
 		loop
 		cnt2 = cnt
 		repeat 500
-			if ( qdata(QDATA_CLIENT, cnt) == cnt2 ) {
-				if ( qdata(QDATA_MAP, cnt) == gdata(GDATA_AREA) ) {
+			if ( qClient(cnt) == cnt2 ) {
+				if ( qMap(cnt) == gArea ) {
 					i = -1
 					break
 				}
 			}
 		loop
 		if ( i == (-1) ) {
 			break
 		}
-		qdata(QDATA_CLIENT, i) = cnt
-		qdata(QDATA_MAP, i) = gdata(GDATA_AREA)
-		qname(i) = cdatan(CDATAN_NAME, cnt)
-		cdata(CDATA_QUEST_NPC, cnt) = i + 1
-		if ( gdata(GDATA_CLIENT) <= i ) {
-			gdata(GDATA_CLIENT) = i + 1
+		qClient(i) = cnt
+		qMap(i) = gArea
+		qname(i) = cnName(cnt)
+		cQuestNpc(cnt) = i + 1
+		if ( gClient <= i ) {
+			gClient = i + 1
 		}
 	loop
 	return
 
 *quest_reward
-	qdata(QDATA_REWARD, rq) = ((qdata(QDATA_LEVEL, rq) + 3) * 100 + rnd(qdata(QDATA_LEVEL, rq) * 30 + 200) + 400) * rewardfix / 100
-	qdata(QDATA_REWARD, rq) = qdata(QDATA_REWARD, rq) * 100 / (100 + qdata(QDATA_LEVEL, rq) * 2 / 3)
-	if ( qdata(QDATA_TYPE, rq) == QUEST_SUBTYPE_SUPPLY | qdata(QDATA_TYPE, rq) == QUEST_SUBTYPE_DELIVER ) {
+	qReward(rq) = ((qLevel(rq) + 3) * 100 + rnd(qLevel(rq) * 30 + 200) + 400) * rewardfix / 100
+	qReward(rq) = qReward(rq) * 100 / (100 + qLevel(rq) * 2 / 3)
+	if ( qType(rq) == QUEST_SUBTYPE_SUPPLY | qType(rq) == QUEST_SUBTYPE_DELIVER ) {
 		return
 	}
-	if ( gdata(GDATA_DEEPEST_LEVEL) / 2 >= qdata(QDATA_LEVEL, rq) ) {
+	if ( gdata(GDATA_DEEPEST_LEVEL) / 2 >= qLevel(rq) ) {
 	}
 	else {
-		qdata(QDATA_REWARD, rq) = qdata(QDATA_REWARD, rq) * (100 + limit((qdata(QDATA_LEVEL, rq) - gdata(GDATA_DEEPEST_LEVEL) / 2) / 5 * 25, 50, 200)) / 100
+		qReward(rq) = qReward(rq) * (100 + limit((qLevel(rq) - gdata(GDATA_DEEPEST_LEVEL) / 2) / 5 * 25, 50, 200)) / 100
 	}
 	return
 
 *quest_update
-	repeat gdata(GDATA_CLIENT)
-		if ( qdata(QDATA_CLIENT, cnt) == (-1) ) {
+	repeat gClient
+		if ( qClient(cnt) == (-1) ) {
 			continue
 		}
-		if ( qdata(QDATA_CLIENT, cnt) == 0 ) {
+		if ( qClient(cnt) == 0 ) {
 			continue
 		}
-		if ( qdata(QDATA_MAP, cnt) != gdata(GDATA_AREA) ) {
+		if ( qMap(cnt) != gArea ) {
 			continue
 		}
-		rc = qdata(QDATA_CLIENT, cnt)
-		if ( cdata(CDATA_RELATION_ORG, rc) != RELATION_NEUTRAL ) {
-			qdata(QDATA_CLIENT, cnt) = 0
+		rc = qClient(cnt)
+		if ( cOrgRelation(rc) != RELATION_NEUTRAL ) {
+			qClient(cnt) = 0
 			rq = cnt
 			gosub *quest_create
 		}
-		if ( cdata(CDATA_ROLE, rc) == ROLE_NONE ) {
+		if ( cRole(rc) == ROLE_NONE ) {
 			continue
 		}
-		if ( cdata(CDATA_QUALITY, rc) == FIX_QUALITY_UNIQUE ) {
+		if ( cQuality(rc) == FIX_QUALITY_UNIQUE ) {
 			continue
 		}
-		if ( cdata(CDATA_ROLE, rc) == ROLE_SPECIAL ) {
+		if ( cRole(rc) == ROLE_SPECIAL ) {
 			continue
 		}
-		if ( cdata(CDATA_ID, rc) == CREATURE_ID_ORPHE_THE_CHAOS_CHILD ) {
+		if ( cId(rc) == CREATURE_ID_ORPHE_THE_CHAOS_CHILD ) {
 			continue
 		}
 		if ( rc == CHARA_PLAYER ) {
 			continue
 		}
-		if ( qdata(QDATA_STATE, cnt) == QUEST_STATE_NONE ) {
-			if ( qdata(QDATA_RENEW, cnt) < gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 | adata(ADATA_QUEST_RENEW, gdata(GDATA_AREA)) != 4 ) {
+		if ( qStatus(cnt) == QUEST_STATE_NONE ) {
+			if ( qRenew(cnt) < gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12 | adata(ADATA_QUEST_RENEW, gArea) != 4 ) {
 				rq = cnt
 				gosub *quest_create
 				gosub *quest_reward
 			}
 		}
 	loop
-	adata(ADATA_QUEST_RENEW, gdata(GDATA_AREA)) = 4
+	adata(ADATA_QUEST_RENEW, gArea) = 4
 	return
-	repeat gdata(GDATA_CLIENT)
-		if ( qdata(QDATA_CLIENT, cnt) == 0 ) {
+	repeat gClient
+		if ( qClient(cnt) == 0 ) {
 			continue
 		}
-		if ( qdata(QDATA_MAP, cnt) != gdata(GDATA_AREA) ) {
+		if ( qMap(cnt) != gArea ) {
 			continue
 		}
-		rc = qdata(QDATA_CLIENT, cnt)
-		if ( qdata(QDATA_STATE, cnt) == QUEST_STATE_NONE ) {
+		rc = qClient(cnt)
+		if ( qStatus(cnt) == QUEST_STATE_NONE ) {
 			rq = cnt
 			gosub *quest_create
 			gosub *quest_reward
 		}
 	loop
 	return
 
 *quest_create
-	qdata(QDATA_EXIST, rq) = QUEST_TYPE_NONE
-	qdata(QDATA_TYPE, rq) = QUEST_TYPE_NONE
-	qdata(QDATA_STATE, rq) = QUEST_STATE_NONE
-	qdata(QDATA_RENEW, rq) = rnd(3 + 1) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
-	qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+	qExist(rq) = QUEST_TYPE_NONE
+	qType(rq) = QUEST_TYPE_NONE
+	qStatus(rq) = QUEST_STATE_NONE
+	qRenew(rq) = rnd(3 + 1) * 24 + (gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12)
+	qRewardItem(rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
 	if ( rnd(3) == 0 ) {
 		return
 	}
-	if ( qdata(QDATA_CLIENT, rq) == 0 ) {
+	if ( qClient(rq) == 0 ) {
 		return
 	}
-	if ( rnd(14) == 0 & gdata(GDATA_AREA) != AREA_RUST_PLAZA ) {
+	if ( rnd(14) == 0 & gArea != AREA_RUST_PLAZA ) {
 		i = -1
 		repeat 300
 			n = rnd(245 - 57) + 57
-			if ( n == qdata(QDATA_CLIENT, rq) ) {
+			if ( n == qClient(rq) ) {
 				continue
 			}
-			if ( cdata(CDATA_EXIST, n) != CHAR_STATE_ALIVE ) {
+			if ( cExist(n) != CHAR_STATE_ALIVE ) {
 				continue
 			}
-			if ( cdata(CDATA_RELATION, n) != RELATION_NEUTRAL | (cdata(CDATA_ROLE, n) != ROLE_CITIZEN & cdata(CDATA_ROLE, n) != ROLE_GUARD) ) {
+			if ( cRelation(n) != RELATION_NEUTRAL | (cRole(n) != ROLE_CITIZEN & cRole(n) != ROLE_GUARD) ) {
 				continue
 			}
 			flt 40, FIX_QUALITY_GOOD
 			flttypemajor = fsetcollect(rnd(length(fsetcollect)))
 			itemcreate n, ITEM_ID_DUMMY, -1, -1, 0
 			if ( stat != 0 ) {
 				inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = rq
-				i = n, inv(INV_ITEM_ID, ci)
+				i = n, iID(ci)
 				ibitmod ITEM_BIT_DROP, ci, TRUE
 				break
 			}
 			else {
 				i = -1
 				break
 			}
 		loop
 		if ( i != (-1) ) {
 			qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq) = i
-			qdata(QDATA_DEST_ITEM, rq) = i(1)
-			qdata(QDATA_MAP, rq) = gdata(GDATA_AREA)
+			qDestItem(rq) = i(1)
+			qMap(rq) = gArea
 			rewardfix = 60
-			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
-			qdata(QDATA_EXIST, rq) = QUEST_TYPE_COLLECT
-			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_SUPPLY
-			qdata(QDATA_VAR, rq) = 0
-			qdata(QDATA_DEADLINE, rq) = rnd(3) + 2
-			qdata(QDATA_LEVEL, rq) = cdata(CDATA_LEVEL, i) / 3
+			qRewardItem(rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qExist(rq) = QUEST_TYPE_COLLECT
+			qType(rq) = QUEST_SUBTYPE_SUPPLY
+			qVar(rq) = 0
+			qDeadline(rq) = rnd(3) + 2
+			qLevel(rq) = cLevel(i) / 3
 		}
 		return
 	}
-	if ( cdata(CDATA_FAME, CHARA_PLAYER) >= 30000 ) {
+	if ( cFame(CHARA_PLAYER) >= 30000 ) {
 		if ( rnd(13) == 0 ) {
-			qdata(QDATA_LEVEL, rq) = rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cdata(CDATA_FAME, CHARA_PLAYER) / 2500 + 1)
-			qdata(QDATA_LEVEL, rq) = roundmargin(qdata(QDATA_LEVEL, rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
-			minlevel = limit(qdata(QDATA_LEVEL, rq) / 7, 5, 30)
+			qLevel(rq) = rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cFame(CHARA_PLAYER) / 2500 + 1)
+			qLevel(rq) = roundmargin(qLevel(rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
+			minlevel = limit(qLevel(rq) / 7, 5, 30)
 			repeat 50
-				flt qdata(QDATA_LEVEL, rq), FIX_QUALITY_GOOD
+				flt qLevel(rq), FIX_QUALITY_GOOD
 				characreate MAX_CHARA_NC, CREATURE_ID_BUG, -3, 0
 				if ( cmshade ) {
 					continue
 				}
-				if ( cdata(CDATA_LEVEL, rc) < minlevel ) {
+				if ( cLevel(rc) < minlevel ) {
 					continue
 				}
 				break
 			loop
-			qdata(QDATA_PARAM1, rq) = cdata(CDATA_ID, MAX_CHARA_NC)
-			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
-			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
-			qdata(QDATA_EXIST, rq) = QUEST_TYPE_HUNTEX
-			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_ELIMINATE
-			qdata(QDATA_VAR, rq) = 0
-			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
-			qdata(QDATA_DEADLINE, rq) = -1
+			qParam1(rq) = cId(MAX_CHARA_NC)
+			qRenew(rq) = (rnd(6) + 2) * 24 + (gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12)
+			qRewardItem(rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qExist(rq) = QUEST_TYPE_HUNTEX
+			qType(rq) = QUEST_SUBTYPE_ELIMINATE
+			qVar(rq) = 0
+			qRewardItem(rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qDeadline(rq) = -1
 			rewardfix = 140
 			return
 		}
 	}
-	if ( cdata(CDATA_FAME, CHARA_PLAYER) >= 50000 ) {
+	if ( cFame(CHARA_PLAYER) >= 50000 ) {
 		if ( rnd(20) == 0 ) {
-			qdata(QDATA_LEVEL, rq) = rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cdata(CDATA_FAME, CHARA_PLAYER) / 2500 + 1)
-			qdata(QDATA_LEVEL, rq) = roundmargin(qdata(QDATA_LEVEL, rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
-			minlevel = limit(qdata(QDATA_LEVEL, rq) / 4, 5, 30)
+			qLevel(rq) = rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cFame(CHARA_PLAYER) / 2500 + 1)
+			qLevel(rq) = roundmargin(qLevel(rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
+			minlevel = limit(qLevel(rq) / 4, 5, 30)
 			repeat 50
-				flt qdata(QDATA_LEVEL, rq), FIX_QUALITY_GOOD
+				flt qLevel(rq), FIX_QUALITY_GOOD
 				characreate MAX_CHARA_NC, CREATURE_ID_BUG, -3, 0
 				if ( cmshade ) {
 					continue
 				}
-				if ( cdata(CDATA_LEVEL, rc) < minlevel ) {
+				if ( cLevel(rc) < minlevel ) {
 					continue
 				}
 				break
 			loop
-			qdata(QDATA_PARAM1, rq) = cdata(CDATA_ID, MAX_CHARA_NC)
-			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
-			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
-			qdata(QDATA_EXIST, rq) = QUEST_TYPE_CONQUER
-			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_CONQUER
-			qdata(QDATA_VAR, rq) = 0
-			qdata(QDATA_REWARD_ITEM, rq) = (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */)
-			qdata(QDATA_DEADLINE, rq) = -1
+			qParam1(rq) = cId(MAX_CHARA_NC)
+			qRenew(rq) = (rnd(6) + 2) * 24 + (gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12)
+			qRewardItem(rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qExist(rq) = QUEST_TYPE_CONQUER
+			qType(rq) = QUEST_SUBTYPE_CONQUER
+			qVar(rq) = 0
+			qRewardItem(rq) = (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */)
+			qDeadline(rq) = -1
 			rewardfix = 175
 			return
 		}
 	}
-	if ( rnd(11) == 0 & gdata(GDATA_AREA) != AREA_RUST_PLAZA & gdata(GDATA_AREA) != AREA_OL_DRAN ) {
-		qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
-		qdata(QDATA_EXIST, rq) = QUEST_TYPE_ESCORT
-		qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_GUARD
-		qdata(QDATA_VAR, rq) = rnd(3)
+	if ( rnd(11) == 0 & gArea != AREA_RUST_PLAZA & gArea != AREA_OL_DRAN ) {
+		qRenew(rq) = (rnd(6) + 2) * 24 + (gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12)
+		qExist(rq) = QUEST_TYPE_ESCORT
+		qType(rq) = QUEST_SUBTYPE_GUARD
+		qVar(rq) = rnd(3)
 		qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq) = 0
-		qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
-		if ( gdata(GDATA_AREA) == AREA_EIREL | gdata(GDATA_AREA) == AREA_MELKAWN | gdata(GDATA_AREA) == AREA_KURUALM | gdata(GDATA_AREA) == AREA_VALM | gdata(GDATA_AREA) == AREA_MELUGAS | gdata(GDATA_AREA) == AREA_ARCBELC | gdata(GDATA_AREA) == AREA_LUDUS ) {
+		qRewardItem(rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+		if ( gArea == AREA_EIREL | gArea == AREA_MELKAWN | gArea == AREA_KURUALM | gArea == AREA_VALM | gArea == AREA_MELUGAS | gArea == AREA_ARCBELC | gArea == AREA_LUDUS ) {
 			repeat
-				qdata(QDATA_PARAM1, rq) = asettowns(rnd(length(asettowns)))
-				if ( qdata(QDATA_PARAM1, rq) != gdata(GDATA_AREA) ) {
+				qParam1(rq) = asettowns(rnd(length(asettowns)))
+				if ( qParam1(rq) != gArea ) {
 					break
 				}
 			loop
 		}
-		if ( gdata(GDATA_AREA) == AREA_VERNIS | gdata(GDATA_AREA) == AREA_YOWYN | gdata(GDATA_AREA) == AREA_PALMIA | gdata(GDATA_AREA) == AREA_DERPHY | gdata(GDATA_AREA) == AREA_PORT_KAPUL | gdata(GDATA_AREA) == AREA_LUMIEST | gdata(GDATA_AREA) == AREA_NOYEL ) {
+		if ( gArea == AREA_VERNIS | gArea == AREA_YOWYN | gArea == AREA_PALMIA | gArea == AREA_DERPHY | gArea == AREA_PORT_KAPUL | gArea == AREA_LUMIEST | gArea == AREA_NOYEL ) {
 			repeat
-				qdata(QDATA_PARAM1, rq) = asettownn(rnd(length(asettownn)))
-				if ( qdata(QDATA_PARAM1, rq) != gdata(GDATA_AREA) ) {
+				qParam1(rq) = asettownn(rnd(length(asettownn)))
+				if ( qParam1(rq) != gArea ) {
 					break
 				}
 			loop
 		}
-		p = qdata(QDATA_PARAM1, rq)
-		if ( qdata(QDATA_VAR, rq) == 0 ) {
-			rewardfix = 140 + dist(adata(ADATA_X, gdata(GDATA_AREA)), adata(ADATA_Y, gdata(GDATA_AREA)), adata(ADATA_X, p), adata(ADATA_Y, p)) * 2
-			qdata(QDATA_DEADLINE, rq) = rnd(8) + 6
-			qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cdata(CDATA_FAME, CHARA_PLAYER) / 500 + 1) + 1, 1, 80)
-		}
-		if ( qdata(QDATA_VAR, rq) == 1 ) {
-			rewardfix = 130 + dist(adata(ADATA_X, gdata(GDATA_AREA)), adata(ADATA_Y, gdata(GDATA_AREA)), adata(ADATA_X, p), adata(ADATA_Y, p)) * 2
-			qdata(QDATA_DEADLINE, rq) = rnd(5) + 2
-			qdata(QDATA_LEVEL, rq) = limit(rewardfix / 10 + 1, 1, 40)
-		}
-		if ( qdata(QDATA_VAR, rq) == 2 ) {
-			rewardfix = 80 + dist(adata(ADATA_X, gdata(GDATA_AREA)), adata(ADATA_Y, gdata(GDATA_AREA)), adata(ADATA_X, p), adata(ADATA_Y, p)) * 2
-			qdata(QDATA_DEADLINE, rq) = rnd(8) + 6
-			qdata(QDATA_LEVEL, rq) = limit(rewardfix / 20 + 1, 1, 40)
+		p = qParam1(rq)
+		if ( qVar(rq) == 0 ) {
+			rewardfix = 140 + dist(areaX(gArea), areaY(gArea), areaX(p), areaY(p)) * 2
+			qDeadline(rq) = rnd(8) + 6
+			qLevel(rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cFame(CHARA_PLAYER) / 500 + 1) + 1, 1, 80)
+		}
+		if ( qVar(rq) == 1 ) {
+			rewardfix = 130 + dist(areaX(gArea), areaY(gArea), areaX(p), areaY(p)) * 2
+			qDeadline(rq) = rnd(5) + 2
+			qLevel(rq) = limit(rewardfix / 10 + 1, 1, 40)
+		}
+		if ( qVar(rq) == 2 ) {
+			rewardfix = 80 + dist(areaX(gArea), areaY(gArea), areaX(p), areaY(p)) * 2
+			qDeadline(rq) = rnd(8) + 6
+			qLevel(rq) = limit(rewardfix / 20 + 1, 1, 40)
 		}
-		if ( qdata(QDATA_PARAM1, rq) == 33 | gdata(GDATA_AREA) == AREA_NOYEL ) {
+		if ( qParam1(rq) == 33 | gArea == AREA_NOYEL ) {
 			rewardfix = rewardfix * 180 / 100
 		}
-		if ( qdata(QDATA_PARAM1, rq) == 57 | gdata(GDATA_AREA) == AREA_LUDUS ) {
+		if ( qParam1(rq) == 57 | gArea == AREA_LUDUS ) {
 			rewardfix = rewardfix * 120 / 100
 		}
 		return
 	}
-	if ( rnd(35) == 0 | (gdata(GDATA_AREA) == AREA_DERPHY & rnd(8) == 0) | (gdata(GDATA_AREA) == AREA_LUDUS & rnd(12) == 0) ) {
-		if ( gdata(GDATA_AREA) != AREA_RUST_PLAZA & gdata(GDATA_AREA) != AREA_OL_DRAN ) {
-			qdata(QDATA_LEVEL, rq) = limit(rnd(sdata(SKILL_NORMAL_DETECTION, CHARA_PLAYER) + sdata(SKILL_ATTR_PER, CHARA_PLAYER) / 30 + 5), int(sqrt(sdata(SKILL_NORMAL_DETECTION, CHARA_PLAYER)) + 1) / 2 + 5, cdata(CDATA_FAME, CHARA_PLAYER) / 2000 + 5)
-			if ( qdata(QDATA_LEVEL, rq) > 66 ) {
-				qdata(QDATA_LEVEL, rq) = 66
-			}
-			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
-			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
-			qdata(QDATA_EXIST, rq) = QUEST_TYPE_MINEFIELD
-			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_TRAP
-			if ( cdata(CDATA_FAME, CHARA_PLAYER) >= 15000 ) {
-				qdata(QDATA_VAR, rq) = rnd(2)
+	if ( rnd(35) == 0 | (gArea == AREA_DERPHY & rnd(8) == 0) | (gArea == AREA_LUDUS & rnd(12) == 0) ) {
+		if ( gArea != AREA_RUST_PLAZA & gArea != AREA_OL_DRAN ) {
+			qLevel(rq) = limit(rnd(sDetection(CHARA_PLAYER) + sPER(CHARA_PLAYER) / 30 + 5), int(sqrt(sDetection(CHARA_PLAYER)) + 1) / 2 + 5, cFame(CHARA_PLAYER) / 2000 + 5)
+			if ( qLevel(rq) > 66 ) {
+				qLevel(rq) = 66
+			}
+			qRenew(rq) = (rnd(6) + 2) * 24 + (gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12)
+			qRewardItem(rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qExist(rq) = QUEST_TYPE_MINEFIELD
+			qType(rq) = QUEST_SUBTYPE_TRAP
+			if ( cFame(CHARA_PLAYER) >= 15000 ) {
+				qVar(rq) = rnd(2)
 			}
 			else {
-				qdata(QDATA_VAR, rq) = 0
+				qVar(rq) = 0
 			}
-			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
-			qdata(QDATA_PARAM1, rq) = qdata(QDATA_LEVEL, rq) + rnd(5)
-			qdata(QDATA_PARAM2, rq) = 0
-			qdata(QDATA_DEADLINE, rq) = -1
+			qRewardItem(rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qParam1(rq) = qLevel(rq) + rnd(5)
+			qParam2(rq) = 0
+			qDeadline(rq) = -1
 			rewardfix = 0
 			return
 		}
 	}
-	if ( rnd(23) == 0 | (gdata(GDATA_AREA) == AREA_PALMIA & rnd(8) == 0) | (gdata(GDATA_AREA) == AREA_ARCBELC & rnd(2) == 0) ) {
-		if ( gdata(GDATA_AREA) != AREA_RUST_PLAZA & gdata(GDATA_AREA) != AREA_OL_DRAN ) {
-			qdata(QDATA_LEVEL, rq) = limit(rnd(sdata(SKILL_NORMAL_PERFORMER, CHARA_PLAYER) + sdata(SKILL_ATTR_CHA, CHARA_PLAYER) / 10 + 10), int(1.5 * sqrt(sdata(SKILL_NORMAL_PERFORMER, CHARA_PLAYER))) + 10, cdata(CDATA_FAME, CHARA_PLAYER) / 1000 + 10)
-			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
-			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
-			qdata(QDATA_EXIST, rq) = QUEST_TYPE_PARTY
-			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_PERFORM
-			qdata(QDATA_VAR, rq) = 0
-			qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
-			qdata(QDATA_PARAM1, rq) = qdata(QDATA_LEVEL, rq) * 10 + rnd(50)
-			qdata(QDATA_PARAM2, rq) = 0
-			qdata(QDATA_DEADLINE, rq) = -1
+	if ( rnd(23) == 0 | (gArea == AREA_PALMIA & rnd(8) == 0) | (gArea == AREA_ARCBELC & rnd(2) == 0) ) {
+		if ( gArea != AREA_RUST_PLAZA & gArea != AREA_OL_DRAN ) {
+			qLevel(rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) + sCHR(CHARA_PLAYER) / 10 + 10), int(1.5 * sqrt(gdata(GDATA_DEEPEST_LEVEL) + 4)) + 10, cFame(CHARA_PLAYER) / 1000 + 10)
+			qRenew(rq) = (rnd(6) + 2) * 24 + (gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12)
+			qRewardItem(rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qExist(rq) = QUEST_TYPE_PARTY
+			qType(rq) = QUEST_SUBTYPE_PERFORM
+			qVar(rq) = 0
+			qRewardItem(rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+			qParam1(rq) = qLevel(rq) * 10 + rnd(50)
+			qParam2(rq) = 0
+			qDeadline(rq) = -1
 			rewardfix = 0
 			return
 		}
 	}
-	if ( rnd(30) == 0 | (gdata(GDATA_AREA) == AREA_YOWYN & rnd(2) == 0) | (gdata(GDATA_AREA) == AREA_LUDUS & rnd(8) == 0) | (gdata(GDATA_AREA) == AREA_RUST_PLAZA & rnd(2) == 0) ) {
-		if ( gdata(GDATA_AREA) != AREA_OL_DRAN ) {
-			qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 3 + 2), 2, 50)
-			qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
-			qdata(QDATA_EXIST, rq) = QUEST_TYPE_HARVEST
-			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_CARRY
-			qdata(QDATA_VAR, rq) = 0
-			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
-			qdata(QDATA_DEADLINE, rq) = -1
-			qdata(QDATA_PARAM1, rq) = 15000 + qdata(QDATA_LEVEL, rq) * 2500
-			qdata(QDATA_PARAM2, rq) = 0
-			rewardfix = 60 + qdata(QDATA_LEVEL, rq) * 2
+	if ( rnd(30) == 0 | (gArea == AREA_YOWYN & rnd(2) == 0) | (gArea == AREA_LUDUS & rnd(8) == 0) | (gArea == AREA_RUST_PLAZA & rnd(2) == 0) ) {
+		if ( gArea != AREA_OL_DRAN ) {
+			qLevel(rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 3 + 2), 2, 50)
+			qRenew(rq) = (rnd(6) + 2) * 24 + (gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12)
+			qExist(rq) = QUEST_TYPE_HARVEST
+			qType(rq) = QUEST_SUBTYPE_CARRY
+			qVar(rq) = 0
+			qRewardItem(rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qDeadline(rq) = -1
+			qParam1(rq) = 15000 + qLevel(rq) * 2500
+			qParam2(rq) = 0
+			rewardfix = 60 + qLevel(rq) * 2
 			return
 		}
 	}
 	if ( rnd(8) == 0 ) {
-		qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cdata(CDATA_FAME, CHARA_PLAYER) / 500 + 1) + 1, 1, 80)
-		qdata(QDATA_LEVEL, rq) = roundmargin(qdata(QDATA_LEVEL, rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
-		qdata(QDATA_RENEW, rq) = (rnd(6) + 2) * 24 + (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
-		qdata(QDATA_REWARD_ITEM, rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
-		qdata(QDATA_EXIST, rq) = QUEST_TYPE_HUNT
-		qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_ELIMINATE
-		qdata(QDATA_VAR, rq) = 0
-		qdata(QDATA_REWARD_ITEM, rq) = (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */)
-		qdata(QDATA_DEADLINE, rq) = -1
+		qLevel(rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 10) + rnd(cFame(CHARA_PLAYER) / 500 + 1) + 1, 1, 80)
+		qLevel(rq) = roundmargin(qLevel(rq), gdata(GDATA_DEEPEST_LEVEL) / 2)
+		qRenew(rq) = (rnd(6) + 2) * 24 + (gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12)
+		qRewardItem(rq) = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */)
+		qExist(rq) = QUEST_TYPE_HUNT
+		qType(rq) = QUEST_SUBTYPE_ELIMINATE
+		qVar(rq) = 0
+		qRewardItem(rq) = (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */)
+		qDeadline(rq) = -1
 		rewardfix = 135
 		return
 	}
-	if ( rnd(6) == 0 | gdata(GDATA_AREA) == AREA_RUST_PLAZA ) {
-		if ( gdata(GDATA_AREA) != AREA_OL_DRAN ) {
-			qdata(QDATA_EXIST, rq) = QUEST_TYPE_COOK
-			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_SUPPLY
-			qdata(QDATA_DEADLINE, rq) = rnd(6) + 2
-			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
-			qdata(QDATA_PARAM1, rq) = rnd(9 - 1) + 1
-			if ( qdata(QDATA_PARAM1, rq) == 4 ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ITEM_POTION
-			}
-			if ( qdata(QDATA_PARAM1, rq) == 6 ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_AMMO
-			}
-			if ( qdata(QDATA_PARAM1, rq) == 1 ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_AMMO
-			}
-			if ( qdata(QDATA_PARAM1, rq) == 5 ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ITEM_POTION
-			}
-			if ( qdata(QDATA_PARAM1, rq) == 7 ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ORE
-			}
-			if ( qdata(QDATA_PARAM1, rq) == 2 ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ITEM_ROD
-			}
-			if ( qdata(QDATA_PARAM1, rq) == 3 ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ITEM_SCROLL
-			}
-			qdata(QDATA_PARAM2, rq) = rnd(10 - 3) + 3
-			qdata(QDATA_LEVEL, rq) = qdata(QDATA_PARAM2, rq) * 3
-			rewardfix = 60 + qdata(QDATA_LEVEL, rq)
+	if ( rnd(6) == 0 | gArea == AREA_RUST_PLAZA ) {
+		if ( gArea != AREA_OL_DRAN ) {
+			qExist(rq) = QUEST_TYPE_COOK
+			qType(rq) = QUEST_SUBTYPE_SUPPLY
+			qDeadline(rq) = rnd(6) + 2
+			qRewardItem(rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qParam1(rq) = rnd(9 - 1) + 1
+			if ( qParam1(rq) == 4 ) {
+				qRewardItem(rq) = FILTER_ITEM_POTION
+			}
+			if ( qParam1(rq) == 6 ) {
+				qRewardItem(rq) = FILTER_AMMO
+			}
+			if ( qParam1(rq) == 1 ) {
+				qRewardItem(rq) = FILTER_AMMO
+			}
+			if ( qParam1(rq) == 5 ) {
+				qRewardItem(rq) = FILTER_ITEM_POTION
+			}
+			if ( qParam1(rq) == 7 ) {
+				qRewardItem(rq) = FILTER_ORE
+			}
+			if ( qParam1(rq) == 2 ) {
+				qRewardItem(rq) = FILTER_ITEM_ROD
+			}
+			if ( qParam1(rq) == 3 ) {
+				qRewardItem(rq) = FILTER_ITEM_SCROLL
+			}
+			qParam2(rq) = rnd(10 - 3) + 3
+			qLevel(rq) = qParam2(rq) * 3
+			rewardfix = 60 + qLevel(rq)
 			return
 		}
 	}
-	if ( rnd(5) == 0 | gdata(GDATA_AREA) == AREA_OL_DRAN ) {
-		qdata(QDATA_EXIST, rq) = QUEST_TYPE_SUPPLY
-		qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_SUPPLY
-		qdata(QDATA_DEADLINE, rq) = rnd(6) + 2
+	if ( rnd(5) == 0 | gArea == AREA_OL_DRAN ) {
+		qExist(rq) = QUEST_TYPE_SUPPLY
+		qType(rq) = QUEST_SUBTYPE_SUPPLY
+		qDeadline(rq) = rnd(6) + 2
 		flt
 		dbmode = DBMODE_FIND
 		flttypemajor = fsetsupply(rnd(length(fsetsupply)))
 		gosub *db_item
-		qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
-		qdata(QDATA_DEST_ITEM, rq) = dbid
-		qdata(QDATA_LEVEL, rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 5) + 1, 1, 30)
-		rewardfix = 65 + qdata(QDATA_LEVEL, rq)
+		qRewardItem(rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+		qDestItem(rq) = dbid
+		qLevel(rq) = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) / 2 + 5) + 1, 1, 30)
+		rewardfix = 65 + qLevel(rq)
 		return
 	}
-	if ( rnd(6) == 0 | (gdata(GDATA_AREA) == AREA_KURUALM & rnd(2) == 0) ) {
+	if ( rnd(6) == 0 | (gArea == AREA_KURUALM & rnd(2) == 0) ) {
 		i = -1
-		repeat gdata(GDATA_CLIENT)
-			p = rnd(gdata(GDATA_CLIENT))
-			repeat gdata(GDATA_CLIENT)
-				if ( qdata(QDATA_EXIST, cnt) == QUEST_TYPE_DELIVER ) {
+		repeat gClient
+			p = rnd(gClient)
+			repeat gClient
+				if ( qExist(cnt) == QUEST_TYPE_DELIVER ) {
 					if ( qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), cnt) == p ) {
 						p = -1
 						break
 					}
 				}
 			loop
 			if ( p == (-1) ) {
 				continue
 			}
-			if ( gdata(GDATA_AREA) == AREA_EIREL | gdata(GDATA_AREA) == AREA_MELKAWN | gdata(GDATA_AREA) == AREA_KURUALM | gdata(GDATA_AREA) == AREA_VALM | gdata(GDATA_AREA) == AREA_MELUGAS | gdata(GDATA_AREA) == AREA_ARCBELC | gdata(GDATA_AREA) == AREA_LUDUS ) {
-				if ( qdata(QDATA_MAP, p) != 50 & qdata(QDATA_MAP, p) != 52 & qdata(QDATA_MAP, p) != 53 & qdata(QDATA_MAP, p) != 54 & qdata(QDATA_MAP, p) != 55 & qdata(QDATA_MAP, p) != 56 & qdata(QDATA_MAP, p) != 57 ) {
+			if ( gArea == AREA_EIREL | gArea == AREA_MELKAWN | gArea == AREA_KURUALM | gArea == AREA_VALM | gArea == AREA_MELUGAS | gArea == AREA_ARCBELC | gArea == AREA_LUDUS ) {
+				if ( qMap(p) != 50 & qMap(p) != 52 & qMap(p) != 53 & qMap(p) != 54 & qMap(p) != 55 & qMap(p) != 56 & qMap(p) != 57 ) {
 					continue
 				}
 			}
-			if ( gdata(GDATA_AREA) == AREA_VERNIS | gdata(GDATA_AREA) == AREA_YOWYN | gdata(GDATA_AREA) == AREA_PALMIA | gdata(GDATA_AREA) == AREA_DERPHY | gdata(GDATA_AREA) == AREA_PORT_KAPUL | gdata(GDATA_AREA) == AREA_LUMIEST | gdata(GDATA_AREA) == AREA_NOYEL ) {
-				if ( qdata(QDATA_MAP, p) != 5 & qdata(QDATA_MAP, p) != 12 & qdata(QDATA_MAP, p) != 15 & qdata(QDATA_MAP, p) != 14 & qdata(QDATA_MAP, p) != 11 & qdata(QDATA_MAP, p) != 36 & qdata(QDATA_MAP, p) != 33 ) {
+			if ( gArea == AREA_VERNIS | gArea == AREA_YOWYN | gArea == AREA_PALMIA | gArea == AREA_DERPHY | gArea == AREA_PORT_KAPUL | gArea == AREA_LUMIEST | gArea == AREA_NOYEL ) {
+				if ( qMap(p) != 5 & qMap(p) != 12 & qMap(p) != 15 & qMap(p) != 14 & qMap(p) != 11 & qMap(p) != 36 & qMap(p) != 33 ) {
 					continue
 				}
 			}
-			if ( qdata(QDATA_CLIENT, p) != 0 ) {
-				if ( qdata(QDATA_MAP, p) != gdata(GDATA_AREA) ) {
+			if ( qClient(p) != 0 ) {
+				if ( qMap(p) != gArea ) {
 					i = p
 					break
 				}
 			}
 		loop
 		if ( i != (-1) ) {
-			p = qdata(QDATA_MAP, i)
-			rewardfix = 70 + dist(adata(ADATA_X, gdata(GDATA_AREA)), adata(ADATA_Y, gdata(GDATA_AREA)), adata(ADATA_X, p), adata(ADATA_Y, p)) * 2
-			if ( p == 33 | gdata(GDATA_AREA) == AREA_NOYEL ) {
+			p = qMap(i)
+			rewardfix = 70 + dist(areaX(gArea), areaY(gArea), areaX(p), areaY(p)) * 2
+			if ( p == 33 | gArea == AREA_NOYEL ) {
 				rewardfix = rewardfix * 175 / 100
 			}
 			qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq) = i
 			flt
 			dbmode = DBMODE_FIND
 			flttypemajor = fsetdeliver(rnd(length(fsetdeliver)))
 			gosub *db_item
-			qdata(QDATA_PARAM1, rq) = flttypemajor
-			qdata(QDATA_REWARD_ITEM, rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
+			qParam1(rq) = flttypemajor
+			qRewardItem(rq) = (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */)
 			if ( flttypemajor == FILTER_ITEM_SPELLBOOK ) {
-				qdata(QDATA_REWARD_ITEM, rq) = (2 /*!!!@[FILTER_RACE_ORC @@@ QUEST_REWARD_MAGIC]@!!! */)
+				qRewardItem(rq) = (2 /*!!!@[FILTER_RACE_ORC @@@ QUEST_REWARD_MAGIC]@!!! */)
 			}
 			if ( flttypemajor == FILTER_ORE ) {
-				qdata(QDATA_REWARD_ITEM, rq) = (3 /*!!!@[FILTER_RACE_SLIME @@@ QUEST_REWARD_ARMOR]@!!! */)
+				qRewardItem(rq) = (3 /*!!!@[FILTER_RACE_SLIME @@@ QUEST_REWARD_ARMOR]@!!! */)
 			}
 			if ( flttypemajor == FILTER_JUNK ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_ORE
+				qRewardItem(rq) = FILTER_ORE
 			}
 			if ( flttypemajor == FILTER_FURNITURE ) {
-				qdata(QDATA_REWARD_ITEM, rq) = FILTER_FURNITURE
+				qRewardItem(rq) = FILTER_FURNITURE
 			}
-			qdata(QDATA_DEST_ITEM, rq) = dbid
-			qdata(QDATA_EXIST, rq) = QUEST_TYPE_DELIVER
-			qdata(QDATA_TYPE, rq) = QUEST_SUBTYPE_DELIVER
-			qdata(QDATA_VAR, rq) = 0
-			qdata(QDATA_DEADLINE, rq) = rnd(12) + 3
-			qdata(QDATA_LEVEL, rq) = limit(rewardfix / 20 + 1, 1, 25)
+			qDestItem(rq) = dbid
+			qExist(rq) = QUEST_TYPE_DELIVER
+			qType(rq) = QUEST_SUBTYPE_DELIVER
+			qVar(rq) = 0
+			qDeadline(rq) = rnd(12) + 3
+			qLevel(rq) = limit(rewardfix / 20 + 1, 1, 25)
 		}
 		return
 	}
 	return 1
 
 *quest_check
-	repeat gdata(GDATA_CLIENT)
-		if ( qdata(QDATA_EXIST, cnt) == QUEST_TYPE_NONE ) {
+	repeat gClient
+		if ( qExist(cnt) == QUEST_TYPE_NONE ) {
 			continue
 		}
-		if ( qdata(QDATA_STATE, cnt) != QUEST_STATE_ONGOING ) {
+		if ( qStatus(cnt) != QUEST_STATE_ONGOING ) {
 			continue
 		}
-		if ( qdata(QDATA_DEADLINE, cnt) < 0 ) {
+		if ( qDeadline(cnt) < 0 ) {
 			continue
 		}
 		rq = cnt
-		qdata(QDATA_DEADLINE, rq)--
-		if ( qdata(QDATA_DEADLINE, rq) == 0 ) {
-			val = qdata(QDATA_EXIST, rq)
+		qDeadline(rq)--
+		if ( qDeadline(rq) == 0 ) {
+			val = qExist(rq)
 			gosub *quest_fail
 		}
 	loop
 	return
 
 *quest_exit
-	if ( gdata(GDATA_QUEST) == QUEST_TYPE_HARVEST ) {
+	if ( gQuest == QUEST_TYPE_HARVEST ) {
 		inv_getheader 0
 		repeat invrange, invhead
-			if ( inv(INV_ITEM_PROPERTY, cnt) == PROP_QUEST ) {
-				inv(INV_ITEM_NUM, cnt) = 0
+			if ( iProperty(cnt) == PROP_QUEST ) {
+				iNum(cnt) = 0
 			}
 		loop
 		gosub *calcBurdenPc
 	}
-	if ( gdata(GDATA_QUEST_STATE) != QUEST_STATE_SUCCESS ) {
-		if ( gdata(GDATA_QUEST) >= STARTING_QUEST_TYPE ) {
-			rq = gdata(GDATA_QUEST_REF)
-		}
-		if ( gdata(GDATA_QUEST) == QUEST_TYPE_ESCORT ) {
-			if ( qdata(QDATA_STATE, rq) == QUEST_STATE_NONE ) {
-				gdata(GDATA_QUEST) = QUEST_TYPE_NONE, 0, 0, 0
+	if ( gQuestStatus != QUEST_STATE_SUCCESS ) {
+		if ( gQuest >= STARTING_QUEST_TYPE ) {
+			rq = gQuestRef
+		}
+		if ( gQuest == QUEST_TYPE_ESCORT ) {
+			if ( qStatus(rq) == QUEST_STATE_NONE ) {
+				gQuest = QUEST_TYPE_NONE, 0, 0, 0
 				return
 			}
 			else {
 				txtmore
 				txt lang("あなたはクライアントを置き去りにした。", "You left your client.")
 			}
 		}
-		val = gdata(GDATA_QUEST)
+		val = gQuest
 		gosub *quest_fail
 		msg_halt
 	}
-	gdata(GDATA_QUEST) = QUEST_TYPE_NONE, 0, 0, 0
+	gQuest = QUEST_TYPE_NONE, 0, 0, 0
 	return
 
 *quest_death
 	rc = CHARA_PLAYER
 	gosub *chara_respawn
 	skillexp SKILL_ATTR_CHA, CHARA_PLAYER, -500
 	skillexp SKILL_ATTR_WIL, CHARA_PLAYER, -500
 	levelexitby = MAP_EXIT_NORMAL
-	gdata(GDATA_LEVEL) = 0
+	gLevel = 0
 	goto *map_exit
 
 *quest_fail
 	if ( val == 1 ) {
 		txt lang("あなたは敗北した。", "You were defeated.")
 		modrank 0, -100
 	}
 	if ( val >= 1000 ) {
 		txt lang(qname(rq) + "から受けた依頼は失敗に終わった。", "You have failed the quest taken from " + qname(rq) + ".")
 		gdata(GDATA_FLAG_JOBS_FAILED)++
-		if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_DELIVER ) {
-			qdata(QDATA_QUEST_TARGET, qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq))--
+		if ( qExist(rq) == QUEST_TYPE_DELIVER ) {
+			qQuestTarget(qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq))--
 			txtmore
 			txtef COLOR_PURPLE
 			txt lang("あなたは重大な罪を犯した!", "You comit a serious crime!")
 			modkarma 0, -20
 		}
-		if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_ESCORT ) {
+		if ( qExist(rq) == QUEST_TYPE_ESCORT ) {
 			txtmore
 			txtef COLOR_PURPLE
 			txt lang("あなたは護衛の任務を果たせなかった。", "You have failed to protect the client.")
 			repeat 16
 				if ( cnt != 0 ) {
 					if ( cbit(CHARA_BIT_BODYGUARD, cnt) == TRUE ) {
-						if ( qdata(QDATA_PARAM2, rq) == cdata(CDATA_ID, cnt) ) {
+						if ( qParam2(rq) == cId(cnt) ) {
 							tc = cnt
 							cbitmod CHARA_BIT_BODYGUARD, cnt, FALSE
-							if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
-								if ( qdata(QDATA_VAR, rq) == 0 ) {
+							if ( cExist(tc) == CHAR_STATE_ALIVE ) {
+								if ( qVar(rq) == 0 ) {
 									s = lang("「おい、暗殺者が私の後ろにいるぞ」", cnvtalk("Hey, the assassins are killing me."))
 									p = -11
 								}
-								if ( qdata(QDATA_VAR, rq) == 1 ) {
+								if ( qVar(rq) == 1 ) {
 									s = lang("「毒が、毒がー！」", cnvtalk("Poison! P-P-Poison in my vein!!"))
 									p = -4
 								}
-								if ( qdata(QDATA_VAR, rq) == 2 ) {
+								if ( qVar(rq) == 2 ) {
 									s = lang("「時間切れだ。こうなったら…」" + name(tc) + "は火をかぶった。", cnvtalk("I missed the deadline. I don't have a right to live anymore.") + " " + name(tc) + " pours a bottole of molotov cocktail over " + him(tc) + "self.")
-									addmef cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 25, efp, CHARA_PLAYER
-									mapitem_fire cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
+									addmef cX(CHARA_PLAYER), cY(CHARA_PLAYER), MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 25, efp, CHARA_PLAYER
+									mapitem_fire cX(tc), cY(tc)
 									p = -9
 								}
 								txtef COLOR_SKY_BLUE
 								txtmore
 								txt s
 								dmghp tc, 999999, p
 							}
-							cdata(CDATA_EXIST, tc) = CHAR_STATE_DEAD
+							cExist(tc) = CHAR_STATE_DEAD
 							break
 						}
 					}
 				}
 			loop
 			modkarma 0, -10
 		}
-		qdata(QDATA_EXIST, rq) = QUEST_TYPE_NONE
-		qdata(QDATA_STATE, rq) = QUEST_STATE_NONE
+		qExist(rq) = QUEST_TYPE_NONE
+		qStatus(rq) = QUEST_STATE_NONE
 	}
 	decfame CHARA_PLAYER, 40
 	p = stat
 	txtmore
 	txtef COLOR_RED
@@ -587,59 +587,59 @@
 			cdata(CDATA_DIRECTIVE_MODE, cnt) = cdata(CDATA_DIRECTIVE_MODE_ORG, cnt)
 		}
 		if ( followerin(cnt) == 0 ) {
 			continue
 		}
-		if ( cdata(CDATA_HP, cnt) < cdata(CDATA_MAX_HP, cnt) / 2 ) {
-			cdata(CDATA_HP, cnt) = cdata(CDATA_MAX_HP, cnt) / 2
+		if ( cHP(cnt) < cMHP(cnt) / 2 ) {
+			cHP(cnt) = cMHP(cnt) / 2
 		}
-		cdata(CDATA_FAME, cnt) += calcfame(cnt, (220 - gdata(GDATA_RANK_PET_ARENA) / 50) * (50 + limit(adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)), 0, 50)) / 100 + 2) * 2
+		cFame(cnt) += calcfame(cnt, (220 - gRankPetArena / 50) * (50 + limit(areaPetArenaWin(gReturnArea), 0, 50)) / 100 + 2) * 2
 	loop
 	snd SOUNDLIST_CHEER
 	if ( petarenawin == 1 ) {
 		txtef COLOR_GREEN
 		txt lang("あなたのチームは勝利した！", "Your team is victorious!")
 		txtef COLOR_GREEN
 		txtmore
-		txt lang("" + gdata(GDATA_QUEST_FAME) + "の名声値を手に入れた。", "You gain " + gdata(GDATA_QUEST_FAME) + " fame.")
+		txt lang("" + gQuestFame + "の名声値を手に入れた。", "You gain " + gQuestFame + " fame.")
 		if ( arenaimport == 1 ) {
-			gdata(GDATA_EX_BATTLE_WIN)++
-			if ( enemylv > gdata(GDATA_EX_BATTLE_MAX_LVL) ) {
-				txt lang("EXバトルの撃破相手LVの記録を更新した(Lv" + gdata(GDATA_EX_BATTLE_MAX_LVL) + " → " + enemylv + " )", "You've made a new record. (Lv" + gdata(GDATA_EX_BATTLE_MAX_LVL) + " to " + enemylv + " )")
-				gdata(GDATA_EX_BATTLE_MAX_LVL) = enemylv
+			gExBattleWin++
+			if ( enemylv > gExBattleMaxLv ) {
+				txt lang("EXバトルの撃破相手LVの記録を更新した(Lv" + gExBattleMaxLv + " → " + enemylv + " )", "You've made a new record. (Lv" + gExBattleMaxLv + " to " + enemylv + " )")
+				gExBattleMaxLv = enemylv
 			}
 		}
 		else {
-			cdata(CDATA_FAME, CHARA_PLAYER) += gdata(GDATA_QUEST_FAME)
+			cFame(CHARA_PLAYER) += gQuestFame
 			modrank 1, 100, 2
-			adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA))++
+			areaPetArenaWin(gReturnArea)++
 			gdata(GDATA_FLAG_HIGHEST_PET_ARENA_STREAK)++
-			if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 100 == 0 ) {
+			if ( areaPetArenaWin(gReturnArea) \ 100 == 0 ) {
 				snd SOUNDLIST_DING3
-				txt lang("なんと…" + adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) + "勝を達成した！追加で30000の名声値を手に入れた。", "You gain 30000 fame!!")
+				txt lang("なんと…" + areaPetArenaWin(gReturnArea) + "勝を達成した！追加で30000の名声値を手に入れた。", "You gain 30000 fame!!")
 				await 2000
-				cdata(CDATA_FAME, CHARA_PLAYER) += 30000
+				cFame(CHARA_PLAYER) += 30000
 				prenshyou = 100
 			}
 			else {
-				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 3 == 0 ) {
+				if ( areaPetArenaWin(gReturnArea) \ 3 == 0 ) {
 					prenshyou = 3
 				}
-				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 10 == 0 ) {
+				if ( areaPetArenaWin(gReturnArea) \ 10 == 0 ) {
 					prenshyou = 10
 				}
-				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 30 == 0 ) {
+				if ( areaPetArenaWin(gReturnArea) \ 30 == 0 ) {
 					prenshyou = 30
 				}
-				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 50 == 0 ) {
+				if ( areaPetArenaWin(gReturnArea) \ 50 == 0 ) {
 					prenshyou = 50
 				}
-				if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 20 == 0 ) {
+				if ( areaPetArenaWin(gReturnArea) \ 20 == 0 ) {
 					matgetmain MATERIAL_500_YEN_COIN, 1
 				}
 				else {
-					if ( adata(ADATA_PET_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 5 == 0 ) {
+					if ( areaPetArenaWin(gReturnArea) \ 5 == 0 ) {
 						matgetmain MATERIAL_100_YEN_COIN, 1
 					}
 				}
 			}
 		}
@@ -660,212 +660,212 @@
 
 *quest_eliminate
 	music = MUSICLIST_MCFANFARE
 	musicloop = 1
 	gosub *music_play
-	gdata(GDATA_QUEST_STATE) = QUEST_STATE_SUCCESS
-	if ( gdata(GDATA_QUEST) == QUEST_SUBTYPE_ELIMINATE ) {
+	gQuestStatus = QUEST_STATE_SUCCESS
+	if ( gQuest == QUEST_SUBTYPE_ELIMINATE ) {
 		snd SOUNDLIST_CHEER
 		txtef COLOR_GREEN
 		txt lang("あなたは勝利した！", "You are victorious!")
 		txtef COLOR_GREEN
 		txtmore
-		txt lang("" + gdata(GDATA_QUEST_FAME) + "の名声値を手に入れた。", "You gain " + gdata(GDATA_QUEST_FAME) + " fame.")
+		txt lang("" + gQuestFame + "の名声値を手に入れた。", "You gain " + gQuestFame + " fame.")
 		modrank 0, 100, 2
-		cdata(CDATA_FAME, CHARA_PLAYER) += gdata(GDATA_QUEST_FAME)
+		cFame(CHARA_PLAYER) += gQuestFame
 		txt lang("外への階段が現れた。", "Stairs appear.")
-		map_placeupstairs mdata(MDATA_WIDTH) / 2, mdata(MDATA_HEIGHT) / 2
-		adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA))++
+		map_placeupstairs mWidth / 2, mHeight / 2
+		areaArenaWin(gReturnArea)++
 		gdata(GDATA_FLAG_HIGHEST_ARENA_STREAK)++
-		if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 100 == 0 ) {
+		if ( areaArenaWin(gReturnArea) \ 100 == 0 ) {
 			snd SOUNDLIST_DING3
 			snd SOUNDLIST_DING1
-			txt lang("なんと…" + adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) + "勝を達成した！追加で30000の名声値を手に入れた。", "You gain 30000 fame!!")
-			cdata(CDATA_FAME, CHARA_PLAYER) += 30000
+			txt lang("なんと…" + areaArenaWin(gReturnArea) + "勝を達成した！追加で30000の名声値を手に入れた。", "You gain 30000 fame!!")
+			cFame(CHARA_PLAYER) += 30000
 			renshyou = 100
 		}
 		else {
-			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 3 == 0 ) {
+			if ( areaArenaWin(gReturnArea) \ 3 == 0 ) {
 				renshyou = 3
 			}
-			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 10 == 0 ) {
+			if ( areaArenaWin(gReturnArea) \ 10 == 0 ) {
 				renshyou = 10
 			}
-			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 30 == 0 ) {
+			if ( areaArenaWin(gReturnArea) \ 30 == 0 ) {
 				renshyou = 30
 			}
-			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 50 == 0 ) {
+			if ( areaArenaWin(gReturnArea) \ 50 == 0 ) {
 				renshyou = 50
 			}
-			if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 20 == 0 ) {
+			if ( areaArenaWin(gReturnArea) \ 20 == 0 ) {
 				matgetmain MATERIAL_500_YEN_COIN, 1
 			}
 			else {
-				if ( adata(ADATA_ARENA_WIN, gdata(GDATA_RETURN_AREA)) \ 5 == 0 ) {
+				if ( areaArenaWin(gReturnArea) \ 5 == 0 ) {
 					matgetmain MATERIAL_100_YEN_COIN, 1
 				}
 			}
 		}
 	}
-	if ( gdata(GDATA_QUEST) == QUEST_TYPE_HUNT | gdata(GDATA_QUEST) == QUEST_TYPE_HUNTEX ) {
-		qdata(QDATA_STATE, gdata(GDATA_QUEST_REF)) = QUEST_STATE_SUCCESS
+	if ( gQuest == QUEST_TYPE_HUNT | gQuest == QUEST_TYPE_HUNTEX ) {
+		qStatus(gQuestRef) = QUEST_STATE_SUCCESS
 		txtef COLOR_GREEN
 		txt lang("エリアを制圧した！", "The area is secured!")
 	}
-	if ( gdata(GDATA_QUEST) == QUEST_TYPE_ESCORT ) {
+	if ( gQuest == QUEST_TYPE_ESCORT ) {
 		txtef COLOR_GREEN
 		txt lang("エリアを制圧した！", "The area is secured!")
 	}
-	if ( gdata(GDATA_QUEST) == QUEST_TYPE_THIEVES ) {
+	if ( gQuest == QUEST_TYPE_THIEVES ) {
 		txtef COLOR_GREEN
 		txt lang("盗賊団を返り討ちにした！", "The area is secured!")
 		gdata(GDATA_FLAG_BANDITS_KILLED)++
 	}
-	if ( gdata(GDATA_QUEST) == QUEST_TYPE_CONQUER ) {
-		gdata(GDATA_TIME_LIMIT) = 0
-		qdata(QDATA_STATE, gdata(GDATA_QUEST_REF)) = QUEST_STATE_SUCCESS
+	if ( gQuest == QUEST_TYPE_CONQUER ) {
+		gTimelimit = 0
+		qStatus(gQuestRef) = QUEST_STATE_SUCCESS
 		txtef COLOR_GREEN
 		txt lang("討伐に成功した！", "You successfully slay the target.")
 	}
 	return
 
-*quest_success
+*label_8955
 	snd SOUNDLIST_COMPLETE1
-	p = qdata(QDATA_REWARD, rq)
-	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_HARVEST ) {
-		if ( qdata(QDATA_PARAM1, rq) != 0 ) {
-			if ( qdata(QDATA_PARAM1, rq) * 125 / 100 < qdata(QDATA_PARAM2, rq) ) {
-				p = limit(p * qdata(QDATA_PARAM2, rq) / qdata(QDATA_PARAM1, rq), p, p * 3)
+	p = qReward(rq)
+	if ( qExist(rq) == QUEST_TYPE_HARVEST ) {
+		if ( qParam1(rq) != 0 ) {
+			if ( qParam1(rq) * 125 / 100 < qParam2(rq) ) {
+				p = limit(p * qParam2(rq) / qParam1(rq), p, p * 3)
 			}
 		}
 	}
 	if ( p != 0 ) {
 		flt
-		itemcreate -1, ITEM_ID_GOLD_PIECE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), p
+		itemcreate -1, ITEM_ID_GOLD_PIECE, cX(CHARA_PLAYER), cY(CHARA_PLAYER), p
 	}
-	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_PARTY ) {
+	if ( qExist(rq) == QUEST_TYPE_PARTY ) {
 		p = 1
 	}
 	else {
-		p = limit(rnd(1 + cdata(CDATA_FAME, CHARA_PLAYER) / EXT_EQUIP_SLOTS), 1, 3)
+		p = limit(rnd(1 + cFame(CHARA_PLAYER) / EXT_EQUIP_SLOTS), 1, 3)
 	}
-	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_CONQUER | qdata(QDATA_EXIST, rq) == QUEST_TYPE_HUNTEX ) {
-		p = limit(rnd(2 + cdata(CDATA_FAME, CHARA_PLAYER) / 20000), 2, 6)
+	if ( qExist(rq) == QUEST_TYPE_CONQUER | qExist(rq) == QUEST_TYPE_HUNTEX ) {
+		p = limit(rnd(2 + cFame(CHARA_PLAYER) / 20000), 2, 6)
 	}
 	flt
-	itemcreate -1, ITEM_ID_PLATINUM_COIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), p
-	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_PARTY ) {
-		if ( qdata(QDATA_PARAM1, rq) * 150 / 100 < qdata(QDATA_PARAM2, rq) ) {
+	itemcreate -1, ITEM_ID_PLATINUM_COIN, cX(CHARA_PLAYER), cY(CHARA_PLAYER), p
+	if ( qExist(rq) == QUEST_TYPE_PARTY ) {
+		if ( qParam1(rq) * 150 / 100 < qParam2(rq) ) {
 			flt
-			itemcreate -1, ITEM_ID_MUSIC_TICKET, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1 + qdata(QDATA_PARAM2, rq) / 10
+			itemcreate -1, ITEM_ID_MUSIC_TICKET, cX(CHARA_PLAYER), cY(CHARA_PLAYER), 1 + qParam2(rq) / 10
 		}
 	}
-	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_MINEFIELD ) {
+	if ( qExist(rq) == QUEST_TYPE_MINEFIELD ) {
 		flt
-		itemcreate -1, ITEM_ID_DEVIL_FRAGMENT, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), limit(1 + qdata(QDATA_PARAM2, rq) / 5, 1, 30)
-		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
-		if ( qdata(QDATA_PARAM1, rq) * 125 / 100 <= qdata(QDATA_PARAM2, rq) | qdata(QDATA_VAR, rq) == 1 ) {
+		itemcreate -1, ITEM_ID_DEVIL_FRAGMENT, cX(CHARA_PLAYER), cY(CHARA_PLAYER), limit(1 + qParam2(rq) / 5, 1, 30)
+		iStatus(ci) = ITEM_STATUS_NORMAL
+		if ( qParam1(rq) * 125 / 100 <= qParam2(rq) | qVar(rq) == 1 ) {
 			flt
-			itemcreate -1, ITEM_ID_BRONZE_COIN, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 1
+			itemcreate -1, ITEM_ID_BRONZE_COIN, cX(cc), cY(cc), 1
 		}
 	}
-	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_HARVEST ) {
-		if ( qdata(QDATA_PARAM1, rq) * 125 / 100 < qdata(QDATA_PARAM2, rq) ) {
+	if ( qExist(rq) == QUEST_TYPE_HARVEST ) {
+		if ( qParam1(rq) * 125 / 100 < qParam2(rq) ) {
 			flt
-			itemcreate -1, ITEM_ID_BRONZE_COIN, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 1
+			itemcreate -1, ITEM_ID_BRONZE_COIN, cX(cc), cY(cc), 1
 		}
-		seedp = rnd(limit(sdata(SKILL_NORMAL_GARDENING, CHARA_PLAYER) / 2, 0, 30) + 80)
+		seedp = rnd(limit(sGardening(CHARA_PLAYER) / 2, 0, 30) + 80)
 		if ( seedp >= 90 ) {
 			if ( rnd(2) == 0 ) {
-				itemcreate -1, ITEM_ID_HERB_SEED, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 3
+				itemcreate -1, ITEM_ID_HERB_SEED, cX(CHARA_PLAYER), cY(CHARA_PLAYER), 3
 			}
 			else {
-				itemcreate -1, ITEM_ID_HERB_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 2
+				itemcreate -1, ITEM_ID_HERB_SEED, cX(cc), cY(cc), 2
 			}
 		}
 		if ( seedp >= 70 & seedp < 90 ) {
 			if ( rnd(2) == 0 ) {
-				itemcreate -1, ITEM_ID_UNKNOWN_SEED, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 3
+				itemcreate -1, ITEM_ID_UNKNOWN_SEED, cX(CHARA_PLAYER), cY(CHARA_PLAYER), 3
 			}
 			else {
-				itemcreate -1, ITEM_ID_MAGICAL_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 4
+				itemcreate -1, ITEM_ID_MAGICAL_SEED, cX(cc), cY(cc), 4
 			}
 		}
 		if ( seedp >= 50 & seedp < 70 ) {
-			itemcreate -1, ITEM_ID_GEM_SEED, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 4
+			itemcreate -1, ITEM_ID_GEM_SEED, cX(CHARA_PLAYER), cY(CHARA_PLAYER), 4
 		}
 		if ( seedp >= 0 & seedp < 50 ) {
 			if ( rnd(2) == 0 ) {
-				itemcreate -1, ITEM_ID_FRUIT_SEED, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 5
+				itemcreate -1, ITEM_ID_FRUIT_SEED, cX(CHARA_PLAYER), cY(CHARA_PLAYER), 5
 			}
 			else {
-				itemcreate -1, ITEM_ID_VEGETABLE_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 5
+				itemcreate -1, ITEM_ID_VEGETABLE_SEED, cX(cc), cY(cc), 5
 			}
 		}
 	}
-	if ( qdata(QDATA_REWARD_ITEM, rq) != (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */) ) {
+	if ( qRewardItem(rq) != (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING @@@ QUEST_REWARD_NONE]@!!! */) ) {
 		p = rnd(rnd(4) + 1) + 1
-		if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_CONQUER | qdata(QDATA_EXIST, rq) == QUEST_TYPE_HUNTEX ) {
+		if ( qExist(rq) == QUEST_TYPE_CONQUER | qExist(rq) == QUEST_TYPE_HUNTEX ) {
 			p += 2
 		}
 		repeat p
 			fixlv = FIX_QUALITY_GOOD
 			if ( rnd(2) ) {
 				fixlv = FIX_QUALITY_GREAT
 				if ( rnd(12) == 0 ) {
 					fixlv = FIX_QUALITY_MIRACLE
 				}
 			}
-			flt (qdata(QDATA_LEVEL, rq) + gdata(GDATA_DEEPEST_LEVEL) / 2) / 2 + 1, calcfixlv(fixlv)
-			if ( qdata(QDATA_REWARD_ITEM, rq) < FILTER_WEAPON ) {
-				if ( qdata(QDATA_REWARD_ITEM, rq) == (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */) ) {
+			flt (qLevel(rq) + gdata(GDATA_DEEPEST_LEVEL) / 2) / 2 + 1, calcfixlv(fixlv)
+			if ( qRewardItem(rq) < FILTER_WEAPON ) {
+				if ( qRewardItem(rq) == (1 /*!!!@[FILTER_RACE_GOBLIN @@@ QUEST_REWARD_WEAR]@!!! */) ) {
 					flttypemajor = fsetwear(rnd(length(fsetwear)))
 				}
-				if ( qdata(QDATA_REWARD_ITEM, rq) == (2 /*!!!@[FILTER_RACE_ORC @@@ QUEST_REWARD_MAGIC]@!!! */) ) {
+				if ( qRewardItem(rq) == (2 /*!!!@[FILTER_RACE_ORC @@@ QUEST_REWARD_MAGIC]@!!! */) ) {
 					flttypemajor = fsetmagic(rnd(length(fsetmagic)))
 				}
-				if ( qdata(QDATA_REWARD_ITEM, rq) == (3 /*!!!@[FILTER_RACE_SLIME @@@ QUEST_REWARD_ARMOR]@!!! */) ) {
+				if ( qRewardItem(rq) == (3 /*!!!@[FILTER_RACE_SLIME @@@ QUEST_REWARD_ARMOR]@!!! */) ) {
 					flttypemajor = fsetarmor(rnd(length(fsetarmor)))
 				}
-				if ( qdata(QDATA_REWARD_ITEM, rq) == (4 /*!!!@[FILTER_RACE_ELEA @@@ QUEST_REWARD_WEAPON]@!!! */) ) {
+				if ( qRewardItem(rq) == (4 /*!!!@[FILTER_RACE_ELEA @@@ QUEST_REWARD_WEAPON]@!!! */) ) {
 					flttypemajor = fsetweapon(rnd(length(fsetweapon)))
 				}
-				if ( qdata(QDATA_REWARD_ITEM, rq) == (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */) ) {
+				if ( qRewardItem(rq) == (5 /*!!!@[FILTER_RACE_KOBOLT @@@ QUEST_REWARD_SUPPLY]@!!! */) ) {
 					flttypemajor = fsetrewardsupply(rnd(length(fsetrewardsupply)))
 				}
 			}
 			else {
-				flttypemajor = qdata(QDATA_REWARD_ITEM, rq)
+				flttypemajor = qRewardItem(rq)
 			}
-			itemcreate -1, ITEM_ID_DUMMY, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
+			itemcreate -1, ITEM_ID_DUMMY, cX(CHARA_PLAYER), cY(CHARA_PLAYER), 0
 		loop
 	}
 	modkarma 0, 1
-	gdata(GDATA_QUEST_FAME) = calcfame(CHARA_PLAYER, qdata(QDATA_LEVEL, rq) * 3 + 10)
+	gQuestFame = calcfame(CHARA_PLAYER, qLevel(rq) * 3 + 10)
 	txtef COLOR_GREEN
 	txt lang(qname(rq) + "から受けた依頼を完了した。", "You have completed the quest taken from " + qname(rq) + ".")
 	if ( gdata(GDATA_FLAG_ZISILION_SIDEQUEST) == 100 ) {
 		gdata(GDATA_FLAG_ZISILION_SIDEQUEST) = 300
 	}
-	hatugen = limit(sqrt(qdata(QDATA_LEVEL, rq) + 1), 3, 10) * 10
+	hatugen = limit(sqrt(qLevel(rq) + 1), 3, 10) * 10
 	mdata(MDATA_CITY_AUTHORITY) += hatugen
 	if ( mdata(MDATA_CITY_ETHER_CORRUPTION) != 0 ) {
 		txtef COLOR_GREEN
 		txt lang("発言力を" + hatugen + "獲得（現在" + mdata(MDATA_CITY_AUTHORITY) + "）、", "You get " + hatugen + " praise.")
 	}
 	gdata(GDATA_FLAG_JOBS_COMPLETED)++
 	txtef COLOR_GREEN
 	txtmore
-	txt lang("" + gdata(GDATA_QUEST_FAME) + "の名声値を手に入れた。", "You gain " + gdata(GDATA_QUEST_FAME) + " fame.")
-	cdata(CDATA_FAME, CHARA_PLAYER) += gdata(GDATA_QUEST_FAME)
+	txt lang("" + gQuestFame + "の名声値を手に入れた。", "You gain " + gQuestFame + " fame.")
+	cFame(CHARA_PLAYER) += gQuestFame
 	txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
-	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_DELIVER ) {
-		qdata(QDATA_QUEST_TARGET, qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq))--
+	if ( qExist(rq) == QUEST_TYPE_DELIVER ) {
+		qQuestTarget(qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq))--
 	}
-	qdata(QDATA_EXIST, rq) = QUEST_TYPE_NONE
-	qdata(QDATA_STATE, rq) = QUEST_STATE_NONE
-	autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
+	qExist(rq) = QUEST_TYPE_NONE
+	qStatus(rq) = QUEST_STATE_NONE
+	autosave = 1 * (gArea != AREA_SHOW_HOUSE)
 	return
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/scene.hsp ../2.14-borscht/scene.hsp
--- ../2.13-borscht/scene.hsp	2022-06-26 12:14:17.415905200 -0700
+++ ../2.14-borscht/scene.hsp	2022-09-18 12:37:02.139875000 -0700
@@ -17,11 +17,11 @@
 	notesel buff
 	noteload lang("scene1.hsp", "scene2.hsp")
 	s = "{" + sceneid + "}"
 	scidx = instr(buff, 0, s)
 	if ( scidx == (-1) ) {
-		goto *scene_end
+		goto *label_8967
 	}
 	scidx += strlen(s)
 
 *scene_loop
 	procid = (procid + 1) \ 4
@@ -30,11 +30,11 @@
 	stick a, 128
 	if ( a == 128 ) {
 		scene_cut = 1
 	}
 	if ( scene_cut == 1 ) {
-		goto *scene_end
+		goto *label_8967
 	}
 	notesel buff
 	noteload lang("scene1.hsp", "scene2.hsp")
 	cs = 0
 	key_list = key_enter
@@ -46,15 +46,15 @@
 	if ( 1 == 0 ) {
 		goto *scene_loop_WEND1
 	}
 	p(1) = instr(buff, scidx, "{") + scidx
 	if ( p(1) == (-1) ) {
-		goto *scene_end
+		goto *label_8967
 	}
 	p(2) = instr(buff, scidx, "}") + scidx + 1
 	if ( p(2) == (-1) ) {
-		goto *scene_end
+		goto *label_8967
 	}
 	if ( scidxtop != 0 ) {
 		scidx = p(1)
 		goto *scene_loop_WEND1
 	}
@@ -96,11 +96,11 @@
 		val = 2
 		goto *scene_loop_WHILE1_CONTINUE
 	}
 	if ( s == "{end}" ) {
 		await 1000
-		goto *scene_end
+		goto *label_8967
 	}
 	p(3) = instr(buff, scidx, "\"") + scidx + 1
 	p(4) = instr(buff, p(3), "\"") + p(3)
 	s(1) = strmid(buff, p(3), p(4) - p(3))
 	scidx = p(4) + 1
@@ -475,11 +475,11 @@
 	color 5, 5, 5
 	boxf 0, 0, windoww, y1
 	boxf 0, y2, windoww, windowh
 	goto *scene_loop
 
-*scene_end
+*label_8967
 	procid = (procid + 1) \ 4
 	proclist(procid) = "Scene:Exit" + " ct:" + ct
 	gsel BUFFER_BUF
 	color 0, 0, 0
 	boxf
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/screen.hsp ../2.14-borscht/screen.hsp
--- ../2.13-borscht/screen.hsp	2022-06-26 12:14:17.490973900 -0700
+++ ../2.14-borscht/screen.hsp	2022-09-18 12:37:02.212942400 -0700
@@ -128,11 +128,11 @@
 		mes cnven(mdatan(0))
 	}
 	pos inf_raderw + 114, inf_bary + 3 + vfix - en
 	mes maplevel()
 
-*screen_raderRefresh
+*label_3797
 	repeat mdata(MDATA_HEIGHT)
 		sy = cnt
 		repeat mdata(MDATA_WIDTH)
 			sx = cnt
 			if ( map(sx, sy, MAP_TILE_ID_MEMORY) == map(sx, sy, MAP_TILE_ID) ) {
@@ -149,12 +149,12 @@
 		gosub *screen_txtAdv
 	}
 	else {
 		sxfix = 0
 		syfix = 0
-		gosub *screen_setPos
-		gosub *los
+		gosub *label_3908
+		gosub *label_3912
 		gosub *los_draw
 	}
 	screendrawhack = 10
 	gosub *screen_drawStatus
 	if ( autoturn == 1 ) {
@@ -920,11 +920,11 @@
 		sy -= 20
 	}
 	color 0
 	if ( navi == (-1) ) {
 		navi = 0
-		gosub *screen_raderRefresh
+		gosub *label_3797
 	}
 	if ( navi != 0 ) {
 		cdata(CDATA_CAN_REVIVE, CHARA_PLAYER) = 0
 		gsel BUFFER_BUF
 		pos 0, 200
@@ -933,11 +933,11 @@
 		pos (windoww - 600) / 2 + inf_screenx, windowh - 133 - 5
 		gcopy BUFFER_BUF, 0, 200, 600, 51
 		font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
 		color 50, 50, 50
 		valn = "" + navis
-		gosub *guide_talk
+		gosub *label_0425
 		talk_conv buffg, 68 - en * 10
 		buffg += "\n"
 		pos (windoww - 600) / 2 + inf_screenx + 80, windowh - 133
 		mes "" + buffg
 		if ( cdata(CDATA_CAN_REVIVE, CHARA_PLAYER) == 0 ) {
@@ -1103,11 +1103,11 @@
 		}
 	}
 	if ( 0 ) {
 		paraa = tlocx
 		parab = tlocy
-		parac = gdata(GDATA_FLAG_COLLECTED_WISHES)
+		parac = gdata(GDATA_SLEEP_EXP)
 		if ( jp ) {
 			pos inf_clockw + 380, inf_clocky + 37
 			color 0, 0, 0
 			bmes "確認" + paraa + "、" + parab + "、" + parac + "。", 235, 235, 235
 		}
@@ -7075,11 +7075,11 @@
 *anime_SWEND1
 	gmode 2
 	anicol = 0
 	return
 
-*screen_setPos
+*label_3908
 	if ( scposval == 0 ) {
 		if ( scroll ) {
 			sx = cdata(CDATA_X_NEW, CHARA_PLAYER) - scx, cdata(CDATA_X_NEW, CHARA_PLAYER)
 			sy = cdata(CDATA_Y_NEW, CHARA_PLAYER) - scy, cdata(CDATA_Y_NEW, CHARA_PLAYER)
 		}
@@ -7126,11 +7126,11 @@
 	if ( scx < 0 ) {
 		scx = 0
 	}
 	return
 	gmode 2, inf_tiles, inf_tiles
-	gosub *screen_setPos
+	gosub *label_3908
 	repeat inf_screenh
 		sy = cnt + scy
 		if ( sy < 0 | sy >= mdata(MDATA_HEIGHT) ) {
 			continue
 		}
@@ -7142,11 +7142,11 @@
 			cell_show sx, sy
 		loop
 	loop
 	return
 
-*los
+*label_3912
 	memset slight, 0, (inf_screenw + 4) * (inf_screenh + 4) * 4
 	msync++
 	sy(2) = cdata(CDATA_Y, CHARA_PLAYER) - 17 / 2, cdata(CDATA_Y, CHARA_PLAYER) + 17 / 2, 17 / 2 - cdata(CDATA_Y, CHARA_PLAYER)
 	sx(3) = cdata(CDATA_X, CHARA_PLAYER) - 17 / 2
 	if ( cfg_scroll ) {
@@ -7189,11 +7189,11 @@
 				slight(lx - 1, ly + 1) += 128
 				lx++
 				continue
 			}
 			if ( gdata(GDATA_AREA) == AREA_PET_ARENA ) {
-				goto *los_jump
+				goto *label_3914
 			}
 			if ( cdata(CDATA_CONDITION_BLIND, CHARA_PLAYER) != 0 ) {
 				if ( sx != cdata(CDATA_X, CHARA_PLAYER) | sy != cdata(CDATA_Y, CHARA_PLAYER) ) {
 					goto *los_jump2
 				}
@@ -7203,11 +7203,11 @@
 				if ( sy < sy(3) ) {
 					sx(2) = fovlist(0, sy + sy(4)) + sx(3)
 					if ( sx >= sx(2) ) {
 						if ( sx < fovlist(1, sy + sy(4)) + sx(3) ) {
 							if ( fov_los(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), sx, sy) ) {
-*los_jump
+*label_3914
 								mapsync(sx, sy) = msync
 								if ( map(sx, sy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
 									cdata(CDATA_SYNC, map(sx, sy, MAP_CHARA_INDEX_PLUS_ONE) - 1) = msync
 								}
 								if ( map(sx, sy, MAP_TILE_ID_MEMORY) != map(sx, sy, MAP_TILE_ID) ) {
@@ -7571,11 +7571,11 @@
 		}
 	}
 	scxbk2 = scx
 	scybk2 = scy
 	scroll = 1
-	gosub *screen_setPos
+	gosub *label_3908
 	scroll = 0
 	scxbk = scx
 	scybk = scy
 	scx = scxbk2
 	scy = scybk2
@@ -7893,17 +7893,17 @@
 		else {
 			return lang("(軽装備)", "(Light)")
 		}
 	}
 
-*label_3953
-	goto *calcBodyFix
+*label_3960
+	goto *label_3962
 
 #defcfunc calcexpalive int calcexpalive_arg1
 	return calcexpalive_arg1 * 100
 
-*calcBodyFix
+*label_3962
 	cdata(CDATA_BODY_SPEED_FIX, r1) = 0
 	repeat 30, 100
 		if ( cdata(cnt, r1) != 0 ) {
 			cdata(CDATA_BODY_SPEED_FIX, r1)++
 		}
@@ -8001,14 +8001,14 @@
 				break
 			}
 		}
 		break
 	loop
-	gosub *calcBodyFix
+	gosub *label_3962
 	return
 
-*calcLevelUp
+*label_3967
 	cdata(CDATA_EXP, r1) -= cdata(CDATA_EXP_TO_NEXT_LVL, r1)
 	if ( cdata(CDATA_EXP, r1) < 0 ) {
 		cdata(CDATA_EXP, r1) = 0
 	}
 	if ( cbit(CHARA_BIT_LIVESTOCK, r1) != TRUE ) {
@@ -8074,11 +8074,10 @@
 					txtef COLOR_RED
 					txt lang("注意！スキルボーナスは100以上あると新たに獲得できない。", "Caution! While the skill bonus is 100 or more, you cannot get new.")
 				}
 			}
 		}
-		cdata(CDATA_SP_EARNED, r1) += p
 		if ( cdatan(CDATAN_RACE, r1) == "mutant" | (r1 == 0 & trait(TRAIT_NORMAL_OTHER_MUTANT) == 1) ) {
 			if ( cdata(CDATA_LEVEL, r1) < 37 ) {
 				if ( cdata(CDATA_LEVEL, r1) \ 3 == 0 ) {
 					if ( cdata(CDATA_LEVEL_ORG, r1) < cdata(CDATA_LEVEL, r1) ) {
 						gosub *calcBodyGain
@@ -8090,11 +8089,11 @@
 			cdata(CDATA_LEVEL_ORG, r1) = cdata(CDATA_LEVEL, r1)
 		}
 		if ( r1 >= 16 ) {
 			gosub *calcPowerUp
 		}
-		gosub *calcExpToNextLevel
+		gosub *label_3991
 		gosub *charaRefresh
 	}
 	return
 
 *calcGodRecruitingPenalty
@@ -8183,11 +8182,11 @@
 	repeat length(mainskill)
 		sdata(mainskill(cnt) + STARTING_SKILL_SPACT, r1) = limit(sdata(mainskill(cnt) + STARTING_SKILL_SPACT, r1) + 1000000 * rnd(3), 1, 2000 * 1000000)
 	loop
 	return
 
-*calcExpToNextLevel
+*label_3991
 	cdata(CDATA_EXP_TO_NEXT_LVL, r1) = limit(cdata(CDATA_LEVEL, r1), 1, 200) * (limit(cdata(CDATA_LEVEL, r1), 1, 200) + 1) * (limit(cdata(CDATA_LEVEL, r1), 1, 200) + 2) * (limit(cdata(CDATA_LEVEL, r1), 1, 200) + 3) + 3000
 	if ( cdata(CDATA_EXP_TO_NEXT_LVL, r1) > 100000000 | cdata(CDATA_EXP_TO_NEXT_LVL, r1) < 0 ) {
 		cdata(CDATA_EXP_TO_NEXT_LVL, r1) = 100000000
 	}
 	return
@@ -8208,11 +8207,11 @@
 
 *expOpenLock
 	skillexp SKILL_NORMAL_LOCK_PICKING, r1, 100
 	return
 
-*expDetection
+*label_3996
 	skillexp SKILL_NORMAL_DETECTION, cc, gdata(GDATA_LEVEL) * 2 + 20
 	return
 
 *expCasting
 	if ( tc != (-1) ) {
@@ -8229,11 +8228,11 @@
 	}
 	return
 	skillexp SKILL_NORMAL_FAITH, CHARA_PLAYER, r1, 6, 1000
 	return
 
-*expMagicCapacity
+*label_3999
 	skillexp SKILL_NORMAL_MAGIC_CAPACITY, r1, limit(abs(cdata(CDATA_MP, r1)) * 400 / (cdata(CDATA_MAX_MP, r1) + 1), 1, 400)
 	return
 
 *expRegen
 	if ( cdata(CDATA_HP, r1) != cdata(CDATA_MAX_HP, r1) ) {
@@ -8583,14 +8582,14 @@
 		}
 	}
 	encharge = 0
 	if ( findbuff(cc, BUFF_CHARGE) != (-1) ) {
 		repeat 15
-			if ( inv(40 + cnt * 2, cw) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw) == 0 ) {
 				break
 			}
-			if ( inv(40 + cnt * 2, cw) == 71 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, cw) == 71 ) {
 				encharge = 100
 				break
 			}
 		loop
 		if ( encharge == 100 ) {
@@ -9262,11 +9261,11 @@
 			r1 = cc
 			gosub *charaRefresh
 			snd SOUNDLIST_BOLT1
 			if ( cc != CHARA_PLAYER ) {
 				customtalk cc, DBMODE_FLAVOR_CHARGE_A
-				gosub *convert_word
+				gosub *label_0416
 			}
 			if ( synccheck(cc, -1) ) {
 				txtef COLOR_RED
 				txt lang(name(cc) + "の渾身の一撃が炸裂した。", name(cc) + " attacked by full power.")
 				txtmore
@@ -9463,11 +9462,11 @@
 	}
 	repeat 600
 		sdata(cnt, r1) = sdata(cnt + STARTING_SKILL_SPACT, r1) / 1000000
 	loop
 	if ( cdata(CDATA_RACE_ID, r1) == 0 ) {
-		gosub *raceID_fix
+		gosub *label_6750
 	}
 	if ( r1 == 0 ) {
 		memset cdata(STARTING_CDATA_CHARA_BIT, r1), 0, 30 * 4
 		if ( trait(TRAIT_RACE_WEAK) != 0 ) {
 			repeat 30, 100
@@ -9686,31 +9685,31 @@
 			if ( r1 == 0 ) {
 				gdata(GDATA_ETHER_SPEED) += 5
 			}
 		}
 		repeat 15
-			if ( inv(40 + cnt * 2, rp) == 0 ) {
+			if ( inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, rp) == 0 ) {
 				break
 			}
-			rp2 = inv(40 + cnt * 2, rp)
+			rp2 = inv(STARTING_INV_ITEM_ENCHANT + cnt * 2, rp)
 			if ( rp2 >= 10000 ) {
 				rp3 = rp2 \ 10000
 				rp2 = rp2 / 10000
 				if ( rp2 == 1 ) {
-					sdata(rp3, r1) += inv(40 + cnt * 2 + 1, rp) / 50 + 1
+					sdata(rp3, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 50 + 1
 					continue
 				}
 				if ( rp2 == 2 ) {
-					sdata(rp3, r1) += inv(40 + cnt * 2 + 1, rp) / 2
+					sdata(rp3, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 2
 					if ( sdata(rp3, r1) < 0 ) {
 						sdata(rp3, r1) = 1
 					}
 					continue
 				}
 				if ( rp2 == 3 ) {
 					if ( sorg(rp3, r1) != 0 ) {
-						sdata(rp3, r1) += inv(40 + cnt * 2 + 1, rp) / 50 + 1
+						sdata(rp3, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 50 + 1
 						if ( sdata(rp3, r1) < 1 ) {
 							sdata(rp3, r1) = 1
 						}
 					}
 					continue
@@ -9728,13 +9727,13 @@
 						gdata(GDATA_GOD_DETECT) = 1
 						continue
 					}
 				}
 				if ( rp2 == 29 ) {
-					sdata(SKILL_ATTR_SPD, r1) += inv(40 + cnt * 2 + 1, rp) / 50 + 1
+					sdata(SKILL_ATTR_SPD, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 50 + 1
 					if ( r1 == 0 ) {
-						gdata(GDATA_TRAVEL_SPEED) += inv(40 + cnt * 2 + 1, rp) / 8
+						gdata(GDATA_TRAVEL_SPEED) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 8
 						continue
 					}
 				}
 				if ( rp2 == 32 ) {
 					cbitmod CHARA_BIT_FLOAT, r1, TRUE
@@ -9783,63 +9782,63 @@
 				if ( rp2 == 55 ) {
 					cbitmod CHARA_BIT_CURE_BLEEDING, r1, TRUE
 					continue
 				}
 				if ( rp2 == 52 ) {
-					cdata(CDATA_RES_DAMAGE, r1) += inv(40 + cnt * 2 + 1, rp) / 40 + 5
+					cdata(CDATA_RES_DAMAGE, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 40 + 5
 					continue
 				}
 				if ( rp2 == 53 ) {
-					cdata(CDATA_IMMUNE_DAMAGE, r1) += inv(40 + cnt * 2 + 1, rp) / 60 + 3
+					cdata(CDATA_IMMUNE_DAMAGE, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 60 + 3
 					continue
 				}
 				if ( rp2 == 54 ) {
-					cdata(CDATA_REFLECT_DAMAGE, r1) += inv(40 + cnt * 2 + 1, rp) / 5
+					cdata(CDATA_REFLECT_DAMAGE, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 5
 					continue
 				}
 				if ( rp2 == 44 ) {
-					cdata(CDATA_CRIT_CHANCE, r1) += inv(40 + cnt * 2 + 1, rp) / 50
+					cdata(CDATA_CRIT_CHANCE, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 50
 					continue
 				}
 				if ( rp2 == 64 ) {
-					cdata(CDATA_DEC_ENEMY_CRIT_CHANCE, r1) += inv(40 + cnt * 2 + 1, rp) / 50
+					cdata(CDATA_DEC_ENEMY_CRIT_CHANCE, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 50
 					continue
 				}
 				if ( rp2 == 39 ) {
-					cdata(CDATA_PIERCING_CHANCE, r1) += inv(40 + cnt * 2 + 1, rp) / 50
+					cdata(CDATA_PIERCING_CHANCE, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 50
 					continue
 				}
 				if ( rp2 == 34 ) {
-					cdata(CDATA_ENHANCE_SPELL, r1) += inv(40 + cnt * 2 + 1, rp)
+					cdata(CDATA_ENHANCE_SPELL, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp)
 					continue
 				}
 				if ( rp2 == 68 ) {
-					cdata(CDATA_ENHANCE_BREATH, r1) += inv(40 + cnt * 2 + 1, rp)
+					cdata(CDATA_ENHANCE_BREATH, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp)
 					continue
 				}
 				if ( rp2 == 69 ) {
-					cdata(CDATA_ROCK_THROWING, r1) += inv(40 + cnt * 2 + 1, rp)
+					cdata(CDATA_ROCK_THROWING, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp)
 					continue
 				}
 				if ( rp2 == 50 ) {
-					cdata(CDATA_EXTRA_MELEE, r1) += inv(40 + cnt * 2 + 1, rp) / 15
+					cdata(CDATA_EXTRA_MELEE, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 15
 					continue
 				}
 				if ( rp2 == 51 ) {
-					cdata(CDATA_EXTRA_SHOOT, r1) += inv(40 + cnt * 2 + 1, rp) / 15
+					cdata(CDATA_EXTRA_SHOOT, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 15
 					continue
 				}
 				if ( rp2 == 65 | rp2 == 66 ) {
 					cdata(CDATA_EXTRA_ATTACKS, r1)++
 					continue
 				}
 				if ( rp2 == 62 ) {
-					cdata(CDATA_REFLECT_MAGIC, r1) += inv(40 + cnt * 2 + 1, rp) / 5
+					cdata(CDATA_REFLECT_MAGIC, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 5
 					continue
 				}
 				if ( rp2 == 63 ) {
-					cdata(CDATA_REMOTE_BLOW, r1) += inv(40 + cnt * 2 + 1, rp) / 2
+					cdata(CDATA_REMOTE_BLOW, r1) += inv(STARTING_INV_ITEM_ENCHANT + cnt * 2 + 1, rp) / 2
 					continue
 				}
 				if ( rp2 == 21 | rp2 == 45 | rp2 == 46 | rp2 == 47 | rp2 == 72 ) {
 					cbitmod CHARA_BIT_RES_CURSE, r1, TRUE
 					continue
@@ -9903,11 +9902,11 @@
 		if ( sdata(10 + cnt, r1) < 1 ) {
 			sdata(10 + cnt, r1) = 1
 		}
 	loop
 	if ( r1 == 0 ) {
-		gosub *god_effect
+		gosub *label_5210
 		traitmode = 1
 		repeat 228
 			if ( trait(cnt) != 0 ) {
 				tid = cnt
 				gosub *trait_ref
@@ -10014,16 +10013,16 @@
 	}
 	if ( cdata(CDATA_CRIT_CHANCE, r1) > 30 ) {
 		cdata(CDATA_ATTACK, r1) += (cdata(CDATA_CRIT_CHANCE, r1) - 30) * 2
 		cdata(CDATA_CRIT_CHANCE, r1) = 30
 	}
-	gosub *calcBurdenPc
+	gosub *label_4102
 	refreshspeed r1
 	cbitmod CHARA_BIT_REFRESH, r1, FALSE
 	chararefreshhack = FALSE
 	return
-	goto *label_4063
+	goto *label_4070
 
 
 
 
 
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/system.hsp ../2.14-borscht/system.hsp
--- ../2.13-borscht/system.hsp	2022-06-26 12:14:17.515997100 -0700
+++ ../2.14-borscht/system.hsp	2022-09-18 12:37:02.233961700 -0700
@@ -1,57 +1,57 @@
 *gene_itemfix
 	inv_getheader -1
 	repeat invrange, invhead
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_CARD | inv(INV_ITEM_ID, cnt) == ITEM_ID_FIGURINE ) {
-			inv(INV_ITEM_NUM, cnt) = 0
+		if ( iID(cnt) == ITEM_ID_CARD | iID(cnt) == ITEM_ID_FIGURINE ) {
+			iNum(cnt) = 0
 		}
 	loop
 	return
 
 *fixOnMapEnter
 	procid = (procid + 1) \ 4
 	proclist(procid) = "fixOnMapEnter" + " ct:" + ct
 	repeat 245
-		if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
-			if ( cdata(CDATA_X, cnt) < 0 | cdata(CDATA_X, cnt) >= mdata(MDATA_WIDTH) | cdata(CDATA_Y, cnt) < 0 | cdata(CDATA_Y, cnt) >= mdata(MDATA_HEIGHT) ) {
-				cdata(CDATA_X, cnt) = 0
-				cdata(CDATA_Y, cnt) = 0
+		if ( cExist(cnt) == CHAR_STATE_ALIVE ) {
+			if ( cX(cnt) < 0 | cX(cnt) >= mWidth | cY(cnt) < 0 | cY(cnt) >= mHeight ) {
+				cX(cnt) = 0
+				cY(cnt) = 0
 			}
 		}
 	loop
-	if ( mdata(MDATA_TYPE) != MAP_TYPE_HOME ) {
-		if ( mdata(MDATA_MAX_INV) != 0 ) {
-			mdata(MDATA_MAX_INV) = 0
+	if ( mType != MAP_TYPE_HOME ) {
+		if ( mMaxInv != 0 ) {
+			mMaxInv = 0
 		}
 	}
-	if ( gdata(GDATA_AREA) == AREA_HOME ) {
+	if ( gArea == AREA_HOME ) {
 		if ( gdata(GDATA_FLAG_INVITED_GOD) != 0 ) {
 			evadd EVENT_SPAWN_EVENT_NPCS
 		}
-		adata(ADATA_MIN_LEVEL, gdata(GDATA_AREA)) = 0
-		adata(ADATA_MAX_LEVEL, gdata(GDATA_AREA)) = 10
-		adata(ADATA_RESTORE_POS, gdata(GDATA_AREA)) = 1
-		mdata(MDATA_RESTORE_POS) = 1
+		areaMinLevel(gArea) = 0
+		areaCanSave(gArea) = 10
+		areaIcon(gArea) = 1
+		mRestorePos = 1
 		if ( gdata(GDATA_TEMPORARY_FLAGS2) == 0 ) {
 			evadd EVENT_WELCOME
 		}
 		calccosthire
 	}
 	gdata(GDATA_TEMPORARY_FLAGS2) = 0
 	return
 
 *fixSave
-	if ( gdata(GDATA_VERSION) != int(double("6.13") * 1000) ) {
-		dialog lang("Ver." + gdata(GDATA_VERSION) + "のセーブデータをアップデートします。", "Updating your save data from Ver." + gdata(GDATA_VERSION) + " now.")
+	if ( gVersion != int(double("6.14") * 1000) ) {
+		dialog lang("Ver." + gVersion + "のセーブデータをアップデートします。", "Updating your save data from Ver." + gVersion + " now.")
 	}
-	if ( gdata(GDATA_HEIR_DEED) < 0 ) {
-		gdata(GDATA_HEIR_DEED) = 1
+	if ( gHeirDeed < 0 ) {
+		gHeirDeed = 1
 	}
-	if ( gdata(GDATA_TRAVEL_TIME) == 0 ) {
-		gdata(GDATA_TRAVEL_TIME) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
+	if ( gTravelTime == 0 ) {
+		gTravelTime = gHour + gDay * 24 + gMonth * 24 * 30 + gYear * 24 * 30 * 12
 	}
-	if ( gdata(GDATA_VERSION) == 940 ) {
+	if ( gVersion == 940 ) {
 		if ( gdata(STARTING_GDATA_RANK + 4) != 0 ) {
 			gdata(STARTING_GDATA_RANK + 2) = gdata(STARTING_GDATA_RANK + 4)
 		}
 	}
 	repeat 20
@@ -59,134 +59,134 @@
 			gdata(STARTING_GDATA_RANK + cnt) = 10000
 		}
 	loop
 	itemmemory(2, ITEM_ID_SPELLBOOK_WISHING) = 0
 	itemmemory(2, ITEM_ID_SPELLBOOK_HARVEST) = 0
-	if ( gdata(GDATA_VERSION) < 950 ) {
+	if ( gVersion < 950 ) {
 		itemcreate CHARA_PLAYER, ITEM_ID_PLAYBACK_DISC, -1, -1, 0
 		itemcreate CHARA_PLAYER, ITEM_ID_FREEZER, -1, -1, 0
 		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 6
 	}
-	if ( gdata(GDATA_VERSION) < 952 ) {
-		gdata(GDATA_WORLD_RENEW) = TRUE
+	if ( gVersion < 952 ) {
+		gWorldRenew = TRUE
 	}
-	if ( gdata(GDATA_VERSION) < 954 ) {
+	if ( gVersion < 954 ) {
 		repeat 16
-			if ( cnt == 0 | cdata(CDATA_EXIST, cnt) == CHAR_STATE_DEAD ) {
+			if ( cnt == 0 | cExist(cnt) == CHAR_STATE_DEAD ) {
 				continue
 			}
 			inv_getheader cnt
 			cnt2 = cnt
 			repeat invrange, invhead
-				if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
-					if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_GOLD_PIECE ) {
-						inv(INV_ITEM_WEIGHT, cnt) = 0
+				if ( iNum(cnt) != 0 ) {
+					if ( iID(cnt) == ITEM_ID_GOLD_PIECE ) {
+						iWeight(cnt) = 0
 					}
 					item_stack cnt2, cnt
 				}
 			loop
 		loop
-		gdata(GDATA_LIGHT) = 90
+		gLight = 90
 	}
-	if ( gdata(GDATA_VERSION) < 960 ) {
-		gdata(GDATA_FLAG_HOLY_WELL) = 2
+	if ( gVersion < 960 ) {
+		flagHolyWell = 2
 	}
-	if ( gdata(GDATA_VERSION) < 973 ) {
-		gdata(GDATA_CORRUPTION) = 0
+	if ( gVersion < 973 ) {
+		gCorrupt = 0
 		repeat 228
 			if ( trait(cnt) != 0 ) {
 				if ( cnt > 37 ) {
 					trait(cnt) = 0
 				}
 			}
 		loop
 		gosub *cm_putTrait
 	}
-	if ( gdata(GDATA_VERSION) < 975 ) {
+	if ( gVersion < 975 ) {
 		file = exedir + "tmp\\"
 		existwrapper file + "mdata_5_103.s2"
 		if ( strsize != (-1) ) {
 			deletewrapper file + "mdata_5_103.s2"
 		}
-		if ( gdata(GDATA_AREA) == AREA_VERNIS ) {
+		if ( gArea == AREA_VERNIS ) {
 			dialog "マップをアップデートするため、一度ヴェルニースに出入りしてください。"
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 1010 ) {
-		gdata(GDATA_SISTER_KILLED) = 0
+	if ( gVersion < 1010 ) {
+		gSisterKilled = 0
 	}
-	if ( gdata(GDATA_VERSION) < 1060 ) {
+	if ( gVersion < 1060 ) {
 		repeat 57
-			cdata(CDATA_RELATION_ORG, cnt) = RELATION_ALLY
+			cOrgRelation(cnt) = RELATION_ALLY
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 1070 ) {
+	if ( gVersion < 1070 ) {
 		repeat 57
-			cdata(CDATA_LEVEL_ORG, cnt) = cdata(CDATA_LEVEL, cnt)
+			cLevelOrg(cnt) = cLevel(cnt)
 			if ( cnt >= 16 ) {
-				cdata(CDATA_RELATION, cnt) = RELATION_NEUTRAL
-				cdata(CDATA_RELATION_ORG, cnt) = RELATION_NEUTRAL
+				cRelation(cnt) = RELATION_NEUTRAL
+				cOrgRelation(cnt) = RELATION_NEUTRAL
 			}
 			else {
-				cdata(CDATA_RELATION, cnt) = RELATION_ALLY
-				cdata(CDATA_RELATION_ORG, cnt) = RELATION_ALLY
+				cRelation(cnt) = RELATION_ALLY
+				cOrgRelation(cnt) = RELATION_ALLY
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 1100 ) {
-		gdata(GDATA_WELL_WISH) = 0
+	if ( gVersion < 1100 ) {
+		gWellWish = 0
 		gosub *cm_putTrait
 	}
-	if ( gdata(GDATA_VERSION) < 1110 ) {
-		gdata(GDATA_GUEST) = 0
-		gdata(GDATA_WORLD_RENEW) = TRUE
+	if ( gVersion < 1110 ) {
+		gGuest = 0
+		gWorldRenew = TRUE
 		repeat 57
-			if ( cdata(CDATA_ROLE, cnt) == ROLE_ADVENTURER ) {
-				cdata(CDATA_AI_INT, cnt) = 100
+			if ( cRole(cnt) == ROLE_ADVENTURER ) {
+				cAiInt(cnt) = 100
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 1111 ) {
-		gdata(GDATA_WORLD_RENEW) = TRUE
+	if ( gVersion < 1111 ) {
+		gWorldRenew = TRUE
 		dialog lang("ユーザー物件の情報をアップデートするため、ゲーム開始後一度ワールドマップに出てください。", "Please exit the current area and enter the world map once to update game data.")
 	}
-	if ( gdata(GDATA_VERSION) < 1130 ) {
+	if ( gVersion < 1130 ) {
 		cfg_net = 1
 		valn = "net.", "1"
 		gosub *cfg_write
 		cfg_netwish = 1
 		valn = "netWish.", "1"
 		gosub *cfg_write
 		cfg_netchat = 0
 		valn = "netChat.", "0"
 		gosub *cfg_write
 	}
-	if ( gdata(GDATA_VERSION) < 1140 ) {
+	if ( gVersion < 1140 ) {
 		cfg_exanime = 1
 		valn = "exAnime.", "1"
 		gosub *cfg_write
-		gdata(GDATA_WORLD_RENEW) = TRUE
+		gWorldRenew = TRUE
 		gosub *mapReset
 	}
-	if ( gdata(GDATA_VERSION) < 1150 ) {
-		if ( gdata(GDATA_PLAY_TIME) < 0 ) {
-			gdata(GDATA_PLAY_TIME) = 600 * 60 * 60
+	if ( gVersion < 1150 ) {
+		if ( gPlayTime < 0 ) {
+			gPlayTime = 600 * 60 * 60
 		}
 		else {
-			gdata(GDATA_PLAY_TIME) /= 1000
+			gPlayTime /= 1000
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 1170 ) {
+	if ( gVersion < 1170 ) {
 		if ( 0 == 0 ) {
-			if ( adata(ADATA_TYPE, gdata(GDATA_AREA)) != MAP_TYPE_TOWN ) {
+			if ( areaType(gArea) != MAP_TYPE_TOWN ) {
 				dialog lang("アップデートを行うには、街中でセーブしたセーブデータが必要です。", "To update your game, please save your game in a town in the previous version then retry.")
 				goto *exit_game
 			}
 		}
 		dialog lang("次のプロセスの完了までには、しばらく時間がかかることがあります。", "The next updating process may take a while to complete.")
-		memcpy adata(ADATA_TYPE, 300), adata(ADATA_TYPE, 100), 40 * (150 - 100) * 4
-		memcpy adata(ADATA_TYPE, 450), adata(ADATA_TYPE, 150), 40 * (200 - 150) * 4
+		memcpy areaType(300), areaType(100), 40 * (150 - 100) * 4
+		memcpy areaType(450), areaType(150), 40 * (200 - 150) * 4
 		repeat 200 - 100, 100
 			p = cnt
 			sdim file_cnv
 			repeat 40
 				adata(cnt, p) = 0
@@ -213,25 +213,25 @@
 					fileadd file, 1
 				loop
 			}
 		loop
 		repeat 500
-			if ( adata(ADATA_ID, cnt) != AREA_NONE ) {
-				if ( adata(ADATA_PARENT, cnt) == AREA_NONE ) {
-					adata(ADATA_PARENT, cnt) = AREA_NORTH_TYRIS
+			if ( areaId(cnt) != AREA_NONE ) {
+				if ( areaParent(cnt) == AREA_NONE ) {
+					areaParent(cnt) = AREA_NORTH_TYRIS
 				}
 			}
 		loop
-		gdata(GDATA_WORLD) = AREA_NORTH_TYRIS
+		gWorld = AREA_NORTH_TYRIS
 	}
-	if ( gdata(GDATA_VERSION) < 2130 ) {
-		if ( gdata(GDATA_QUEST) == QUEST_TYPE_THIEVES ) {
-			gdata(GDATA_QUEST) = QUEST_TYPE_NONE
+	if ( gVersion < 2130 ) {
+		if ( gQuest == QUEST_TYPE_THIEVES ) {
+			gQuest = QUEST_TYPE_NONE
 			dialog lang("盗賊団フラグ抹消。", "Death bug is corrected.")
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 2160 ) {
+	if ( gVersion < 2160 ) {
 		repeat 57
 			aphantei = 0
 			if ( cbit(CHARA_BIT_AWAKE_DIM_ATTACKER, cnt) ) {
 				aphantei += 1
 			}
@@ -268,27 +268,27 @@
 				cdata(CDATA_AP_CURRENT, cnt) += 3300
 			}
 			aphantei = 0
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 2180 ) {
+	if ( gVersion < 2180 ) {
 		repeat 57
-			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_GALACTICA_PHANTOM | cdata(CDATA_ID, cnt) == CREATURE_ID_SHADOW | cdata(CDATA_ID, cnt) == CREATURE_ID_VOL_PHANTOM | cdata(CDATA_ID, cnt) == CREATURE_ID_LESSER_PHANTOM ) {
-				cdatan(CDATAN_RACE, cnt) = "ghost"
+			if ( cId(cnt) == CREATURE_ID_GALACTICA_PHANTOM | cId(cnt) == CREATURE_ID_SHADOW | cId(cnt) == CREATURE_ID_VOL_PHANTOM | cId(cnt) == CREATURE_ID_LESSER_PHANTOM ) {
+				cnRace(cnt) = "ghost"
 			}
-			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_HELL_CRAB | cdata(CDATA_ID, cnt) == CREATURE_ID_FIRE_CRAB ) {
-				cdatan(CDATAN_RACE, cnt) = "shell"
+			if ( cId(cnt) == CREATURE_ID_HELL_CRAB | cId(cnt) == CREATURE_ID_FIRE_CRAB ) {
+				cnRace(cnt) = "shell"
 			}
-			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_BOMB_THROWER | cdata(CDATA_ID, cnt) == CREATURE_ID_MAD_SCIENTIST | cdata(CDATA_ID, cnt) == CREATURE_ID_WHOM_DWELL_IN_THE_VANITY | cdata(CDATA_ID, cnt) == CREATURE_ID_LOYTER_THE_CRIMSON_OF_ZANAN | cdata(CDATA_ID, cnt) == CREATURE_ID_NOBLE | cdata(CDATA_ID, cnt) == CREATURE_ID_GANGSTER | cdata(CDATA_ID, cnt) == CREATURE_ID_ROCK_THROWER | cdata(CDATA_ID, cnt) == CREATURE_ID_PUBLIC_PERFORMER | cdata(CDATA_ID, cnt) == CREATURE_ID_NURSE | cdata(CDATA_ID, cnt) == CREATURE_ID_RICH_PERSON | cdata(CDATA_ID, cnt) == CREATURE_ID_NOBLE_CHILD ) {
-				cdatan(CDATAN_RACE, cnt) = "zanan"
+			if ( cId(cnt) == CREATURE_ID_BOMB_THROWER | cId(cnt) == CREATURE_ID_MAD_SCIENTIST | cId(cnt) == CREATURE_ID_WHOM_DWELL_IN_THE_VANITY | cId(cnt) == CREATURE_ID_LOYTER_THE_CRIMSON_OF_ZANAN | cId(cnt) == CREATURE_ID_NOBLE | cId(cnt) == CREATURE_ID_GANGSTER | cId(cnt) == CREATURE_ID_ROCK_THROWER | cId(cnt) == CREATURE_ID_PUBLIC_PERFORMER | cId(cnt) == CREATURE_ID_NURSE | cId(cnt) == CREATURE_ID_RICH_PERSON | cId(cnt) == CREATURE_ID_NOBLE_CHILD ) {
+				cnRace(cnt) = "zanan"
 			}
-			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_PART_TIME_WORKER2 | cdata(CDATA_ID, cnt) == CREATURE_ID_TRAVELER | cdata(CDATA_ID, cnt) == CREATURE_ID_SWIMMER | cdata(CDATA_ID, cnt) == CREATURE_ID_KARAM_THE_LONELY_WOLF_OF_KARUNE | cdata(CDATA_ID, cnt) == CREATURE_ID_MERCENARY | cdata(CDATA_ID, cnt) == CREATURE_ID_FARMER | cdata(CDATA_ID, cnt) == CREATURE_ID_MINER | cdata(CDATA_ID, cnt) == CREATURE_ID_PART_TIME_WORKER | cdata(CDATA_ID, cnt) == CREATURE_ID_PRISONER ) {
-				cdatan(CDATAN_RACE, cnt) = "karune"
+			if ( cId(cnt) == CREATURE_ID_PART_TIME_WORKER2 | cId(cnt) == CREATURE_ID_TRAVELER | cId(cnt) == CREATURE_ID_SWIMMER | cId(cnt) == CREATURE_ID_KARAM_THE_LONELY_WOLF_OF_KARUNE | cId(cnt) == CREATURE_ID_MERCENARY | cId(cnt) == CREATURE_ID_FARMER | cId(cnt) == CREATURE_ID_MINER | cId(cnt) == CREATURE_ID_PART_TIME_WORKER | cId(cnt) == CREATURE_ID_PRISONER ) {
+				cnRace(cnt) = "karune"
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) == 2170 ) {
+	if ( gVersion == 2170 ) {
 		repeat 57
 			if ( cnt == 0 ) {
 				continue
 			}
 			if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_EVASION, cnt) == TRUE ) {
@@ -370,166 +370,166 @@
 			if ( cdata(CDATA_AP_CURRENT, cnt) > 8000 ) {
 				cdata(CDATA_AP_CURRENT, cnt) = 7000 + rnd(500)
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) == 2180 ) {
+	if ( gVersion == 2180 ) {
 		dialog lang("アップデートを行うには、1.1555以外のセーブデータが必要です。", "To update your game, please save not 1.1555 version then retry.")
 		goto *exit_game
 	}
-	if ( gdata(GDATA_VERSION) < 2210 ) {
+	if ( gVersion < 2210 ) {
 		repeat 5480
-			inv(INV_ITEM_PARAM4, cnt) = 0
+			iParam4(cnt) = 0
 		loop
 	}
-	if ( gdata(GDATA_VERSION) == 2220 ) {
+	if ( gVersion == 2220 ) {
 		dialog lang("1.18fix以外のセーブデータは使えません。", "To update your game, please save not 1.18fix version then retry.")
 		goto *exit_game
 	}
-	if ( gdata(GDATA_VERSION) < 2260 ) {
+	if ( gVersion < 2260 ) {
 		repeat 57
 			if ( cnt == 0 ) {
 				continue
 			}
 			if ( cdata(CDATA_DIRECTIVE_MODE, cnt) > DIRECTIVE_MODE_OFFENSIVE ) {
 				cdata(CDATA_DIRECTIVE_MODE, cnt) = DIRECTIVE_MODE_DEFENSIVE
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 2280 ) {
+	if ( gVersion < 2280 ) {
 		repeat 57
 			if ( cnt == 0 ) {
 				continue
 			}
-			if ( cdata(CDATA_SEX, cnt) == 0 ) {
+			if ( cSex(cnt) == 0 ) {
 				cdata(CDATA_TONE_SEX, cnt) = 1
 			}
 			else {
 				cdata(CDATA_TONE_SEX, cnt) = 2
 			}
 		loop
 		repeat 5480
 			saiseiseimode = 0
 			ci = cnt
-			if ( inv(INV_ITEM_ATTACK, ci) == 0 & inv(INV_ITEM_DAMAGE, ci) == 0 & inv(INV_ITEM_DV, ci) == 0 & inv(INV_ITEM_PV, ci) == 0 ) {
+			if ( iAtk(ci) == 0 & iDmg(ci) == 0 & iDV(ci) == 0 & iPV(ci) == 0 ) {
 				continue
 			}
-			oldcol = inv(INV_ITEM_COL, ci)
-			oldweight = inv(INV_ITEM_WEIGHT, ci)
+			oldcol = iCol(ci)
+			oldweight = iWeight(ci)
 			if ( inv(INV_ITEM_CHARA_PIC, ci) != xy2pic(0, 0) ) {
-				inv(INV_ITEM_PV, ci) = inv(INV_ITEM_CHARA_PIC, ci)
+				iPV(ci) = inv(INV_ITEM_CHARA_PIC, ci)
 			}
 			if ( inv(INV_ITEM_NEED_SLEEP, ci) != 0 ) {
-				inv(INV_ITEM_DV, ci) = inv(INV_ITEM_NEED_SLEEP, ci)
+				iDV(ci) = inv(INV_ITEM_NEED_SLEEP, ci)
 			}
 			if ( inv(INV_ITEM_AMUR_CAGE, ci) != 0 ) {
-				inv(INV_ITEM_DAMAGE, ci) = inv(INV_ITEM_AMUR_CAGE, ci)
+				iDmg(ci) = inv(INV_ITEM_AMUR_CAGE, ci)
 			}
 			if ( inv(INV_ITEM_SHOP_SAMPLE, ci) != 0 ) {
-				inv(INV_ITEM_ATTACK, ci) = inv(INV_ITEM_SHOP_SAMPLE, ci)
+				iAtk(ci) = inv(INV_ITEM_SHOP_SAMPLE, ci)
 			}
-			if ( inv(INV_ITEM_QUALITY, ci) == FIX_QUALITY_UNIQUE ) {
+			if ( iQuality(ci) == FIX_QUALITY_UNIQUE ) {
 				saiseiseimode = 50
 			}
 			else {
 				saiseiseimode = 100
 			}
-			fixmaterial = inv(INV_ITEM_MATERIAL, ci)
+			fixmaterial = iMaterial(ci)
 			gosub *remake_material
-			inv(INV_ITEM_WEIGHT, ci) = oldweight
-			inv(INV_ITEM_COL, ci) = oldcol
+			iWeight(ci) = oldweight
+			iCol(ci) = oldcol
 			if ( ci >= 5080 ) {
-				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
+				cell_refresh iX(ci), iY(ci)
 			}
 		loop
 		saiseiseimode = 0
 	}
-	if ( gdata(GDATA_VERSION) < 2300 ) {
+	if ( gVersion < 2300 ) {
 		gdata(GDATA_FLAG_PROSTITUTION_COUNTER) = 0
 	}
-	if ( gdata(GDATA_VERSION) < 2310 ) {
+	if ( gVersion < 2310 ) {
 		gdata(GDATA_FLAG_HIGHEST_NORMAL_DAMAGE) = 0
 	}
-	if ( gdata(GDATA_VERSION) == 2310 ) {
+	if ( gVersion == 2310 ) {
 		dialog lang("アップデートを行うには、1.25以外のセーブデータが必要です。", "To update your game, please save not 1.25 version then retry.")
 		goto *exit_game
 	}
-	if ( gdata(GDATA_VERSION) <= 2390 ) {
+	if ( gVersion <= 2390 ) {
 		repeat 5
 			p = gdata(GDATA_QUEST_POOL + cnt)
-			qdata(QDATA_EXIST, p) = QUEST_TYPE_NONE
-			qdata(QDATA_STATE, p) = QUEST_STATE_NONE
+			qExist(p) = QUEST_TYPE_NONE
+			qStatus(p) = QUEST_STATE_NONE
 		loop
 		repeat 16
 			cdata(CDATA_ALLIED, cnt) = 100
 			if ( cnt != 0 ) {
 				if ( cbit(CHARA_BIT_BODYGUARD, cnt) == TRUE ) {
-					if ( qdata(QDATA_PARAM2, rq) == cdata(CDATA_ID, cnt) ) {
+					if ( qParam2(rq) == cId(cnt) ) {
 						tc = cnt
 						cbitmod CHARA_BIT_BODYGUARD, cnt, FALSE
-						if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
+						if ( cExist(tc) == CHAR_STATE_ALIVE ) {
 							s = lang("「おい、暗殺者が私の後ろにいるぞ」", cnvtalk("Hey, the assassins are killing me."))
 							p = -11
 							txtef COLOR_SKY_BLUE
 							txtmore
 							txt s
 							dmghp tc, 999999, p
 						}
-						cdata(CDATA_EXIST, tc) = CHAR_STATE_DEAD
+						cExist(tc) = CHAR_STATE_DEAD
 						break
 					}
 				}
 			}
 		loop
 		repeat 500
-			qdata(QDATA_CLIENT, cnt) = 0
-			qdata(QDATA_MAP, cnt) = 0
-			gdata(GDATA_CLIENT) = 0
+			qClient(cnt) = 0
+			qMap(cnt) = 0
+			gClient = 0
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 2430 ) {
+	if ( gVersion < 2430 ) {
 		repeat 245
 			cdata(CDATA_CAN_REVIVE, cnt) = 1
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 2440 ) {
+	if ( gVersion < 2440 ) {
 		gdata(GDATA_FLAG_HIGHEST_NORMAL_DAMAGE) = 0
 	}
-	if ( gdata(GDATA_VERSION) < 2480 ) {
+	if ( gVersion < 2480 ) {
 		repeat 245
 			tc = cnt
-			if ( cdata(CDATA_ID, tc) == CREATURE_ID_WASP | cdata(CDATA_ID, tc) == CREATURE_ID_RED_WASP | cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_HORNET ) {
+			if ( cId(tc) == CREATURE_ID_WASP | cId(tc) == CREATURE_ID_RED_WASP | cId(tc) == CREATURE_ID_BLACK_HORNET ) {
 				if ( cdata(CDATA_EVOLUTION_STAGE, tc) != 0 ) {
 					resistmod tc, SKILL_RES_MAGIC, 50 * 10
 				}
 			}
-			if ( cdata(CDATA_ID, tc) == CREATURE_ID_RAT ) {
+			if ( cId(tc) == CREATURE_ID_RAT ) {
 				if ( cdata(CDATA_EVOLUTION_STAGE, tc) != 0 ) {
 					resistmod tc, SKILL_RES_FIRE, 50 * 10
 				}
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) == 2500 ) {
+	if ( gVersion == 2500 ) {
 		dialog lang("1.38のセーブデータはアップデートできません。", "To update your game, please save not 1.38 version then retry.")
 		goto *exit_game
 	}
-	if ( gdata(GDATA_VERSION) < 2510 ) {
+	if ( gVersion < 2510 ) {
 		repeat 57
 			if ( cdata(CDATA_AP_CURRENT, cnt) > 2000 ) {
 				cdata(CDATA_AP_CURRENT, cnt) = 2000
 			}
 			cdata(CDATA_INIT_LIFEMANA, cnt) = limit(sorg(SKILL_ATTR_LIFE, cnt), 50, 200) * 2 + limit(sorg(SKILL_ATTR_MANA, cnt), 50, 200) / 2
 			if ( cnt != 0 ) {
-				cdata(CDATA_SKILLPOINT, cnt) = 0
+				cSkillPoint(cnt) = 0
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 2530 ) {
+	if ( gVersion < 2530 ) {
 		kamen = 100
 	}
-	if ( gdata(GDATA_VERSION) < 2540 ) {
+	if ( gVersion < 2540 ) {
 		if ( spact(SKILL_SPACT_GAUGE_RELEASE - STARTING_SKILL_SPACT) == 0 ) {
 			spact(SKILL_SPACT_GAUGE_RELEASE - STARTING_SKILL_SPACT) = 1
 			txtmore
 			txtef COLOR_YELLOW
 			txt lang("あなたは「" + skillname(SKILL_SPACT_GAUGE_RELEASE) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_GAUGE_RELEASE) + ".")
@@ -537,15 +537,15 @@
 		repeat 57
 			if ( cbit(CHARA_BIT_AWAKE_NEAR_DEATH_DAMAGE, cnt) ) {
 				cdata(CDATA_AP_CURRENT, cnt) += 500
 			}
 		loop
-		if ( gdata(GDATA_DEEPEST_LEVEL) > gdata(GDATA_FLAG_MAIN) / 4 + 1 ) {
-			gdata(GDATA_DEEPEST_LEVEL) = gdata(GDATA_FLAG_MAIN) / 4 + 1
+		if ( gdata(GDATA_DEEPEST_LEVEL) > flagMain / 4 + 1 ) {
+			gdata(GDATA_DEEPEST_LEVEL) = flagMain / 4 + 1
 		}
 	}
-	if ( gdata(GDATA_VERSION) <= 2550 & gdata(GDATA_VERSION) >= 2540 ) {
+	if ( gVersion <= 2550 & gVersion >= 2540 ) {
 		repeat 57
 			if ( cdata(CDATA_ALLIED, cnt) == 0 ) {
 				continue
 			}
 			tc = cnt
@@ -556,222 +556,222 @@
 				p = cdata(cnt, tc) \ EXT_EQUIP_SLOTS
 				if ( p == 0 ) {
 					continue
 				}
 				p--
-				inv(INV_ITEM_EQUIP, p) = 0
+				iEquip(p) = 0
 				cdata(cnt, tc) = cdata(cnt, tc) / EXT_EQUIP_SLOTS * 10000
 			loop
 			cdata(CDATA_EQUIP_SLOT_21, tc) = 0
 			cdata(CDATA_EQUIP_SLOT_22, tc) = 0
 			cdata(CDATA_EQUIP_SLOT_23, tc) = 0
 			r1 = tc
 			gosub *charaRefresh
 		loop
 		tuikabui = 100
 	}
-	if ( gdata(GDATA_VERSION) <= 2570 & gdata(GDATA_VERSION) >= 2540 ) {
+	if ( gVersion <= 2570 & gVersion >= 2540 ) {
 		repeat 30, 100
 			if ( cnt != 120 & cnt != 121 & cnt != 122 ) {
 				continue
 			}
 			p = cdata(cnt, CHARA_PLAYER) \ EXT_EQUIP_SLOTS
 			if ( p == 0 ) {
 				continue
 			}
 			p--
-			inv(INV_ITEM_EQUIP, p) = 0
+			iEquip(p) = 0
 			cdata(cnt, CHARA_PLAYER) = cdata(cnt, CHARA_PLAYER) / EXT_EQUIP_SLOTS * 10000
 		loop
 		cdata(CDATA_EQUIP_SLOT_21, CHARA_PLAYER) = 0
 		cdata(CDATA_EQUIP_SLOT_22, CHARA_PLAYER) = 0
 		cdata(CDATA_EQUIP_SLOT_23, CHARA_PLAYER) = 0
 		r1 = 0
 		gosub *charaRefresh
 		tuikabui = 100
 	}
-	if ( gdata(GDATA_VERSION) < 2620 ) {
+	if ( gVersion < 2620 ) {
 		kamen = 1000
 	}
-	if ( gdata(GDATA_VERSION) < 2670 ) {
+	if ( gVersion < 2670 ) {
 		gdata(GDATA_FLAG_SUB_THE_TRUE_APPEARANCE) = 0
 	}
-	if ( gdata(GDATA_VERSION) == 2710 ) {
+	if ( gVersion == 2710 ) {
 		if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) == 1002 ) {
 			gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) = 1003
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 2730 ) {
+	if ( gVersion < 2730 ) {
 		kamen2 = 100
 	}
-	if ( gdata(GDATA_VERSION) < 2750 ) {
-		gdata(GDATA_WORLD_RENEW) = TRUE
+	if ( gVersion < 2750 ) {
+		gWorldRenew = TRUE
 	}
-	if ( gdata(GDATA_VERSION) < 2760 ) {
-		adata(ADATA_ECONOMY, 85) = 0
-		adata(ADATA_ECONOMY, 79) = 0
-		adata(ADATA_ECONOMY, 75) = 0
-		adata(ADATA_ECONOMY, 74) = 0
-		adata(ADATA_ECONOMY, 73) = 0
-		adata(ADATA_ECONOMY, 72) = 0
-		adata(ADATA_ECONOMY, 71) = 0
-		adata(ADATA_ECONOMY, 80) = 0
-		adata(ADATA_ECONOMY, 81) = 0
-		adata(ADATA_ECONOMY, 80) = 0
+	if ( gVersion < 2760 ) {
+		areaEconomy(85) = 0
+		areaEconomy(79) = 0
+		areaEconomy(75) = 0
+		areaEconomy(74) = 0
+		areaEconomy(73) = 0
+		areaEconomy(72) = 0
+		areaEconomy(71) = 0
+		areaEconomy(80) = 0
+		areaEconomy(81) = 0
+		areaEconomy(80) = 0
 	}
-	if ( gdata(GDATA_VERSION) < 2880 ) {
+	if ( gVersion < 2880 ) {
 		gdata(GDATA_FLAG_BIRTHDAY_CURRENT_YEAR) = int(gettime(0))
 	}
-	if ( gdata(GDATA_VERSION) < 2990 ) {
+	if ( gVersion < 2990 ) {
 		if ( int(gettime(1)) == 12 ) {
 			if ( int(gettime(3)) <= 25 ) {
 				kamen3 = 100
 			}
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 3050 ) {
+	if ( gVersion < 3050 ) {
 		repeat 57
 			if ( cnt == 0 ) {
 				cdata(CDATA_THIRST, cnt) = 9000
 			}
 			else {
 				cdata(CDATA_THIRST, cnt) = 10000 - 1000 + rnd(4000)
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 3060 ) {
+	if ( gVersion < 3060 ) {
 		repeat 450 - 300, 300
-			if ( adata(ADATA_ID, cnt) != AREA_SHOP ) {
+			if ( areaId(cnt) != AREA_SHOP ) {
 				continue
 			}
 			adata((37 /*!!!@[ADATA_RANCH_BREED_RESTRICTION @@@ ADATA_SHOP_SALE_RESTRICTION]@!!! */), cnt) = 0
 			adata((39 /*!!!@[ADATA_RANCH_PRODUCE_RESTRICTION @@@ ADATA_SHOP_TYPE_CHANGE_COOLDOWN]@!!! */), cnt) = 0
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 3080 ) {
+	if ( gVersion < 3080 ) {
 		if ( gdata(GDATA_FLAG_GAME_MODE) == 5 ) {
 			kamen4 = 100
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 3120 ) {
+	if ( gVersion < 3120 ) {
 		repeat 40 - 1, 16
-			if ( cdata(CDATA_HIRE_DATE, cnt) != 0 ) {
-				cdata(CDATA_AREA, cnt) = gdata(GDATA_AREA)
-				cdata(CDATA_EXIST, cnt) = CHAR_STATE_ALIVE
+			if ( cHireDate(cnt) != 0 ) {
+				cType(cnt) = gArea
+				cExist(cnt) = CHAR_STATE_ALIVE
 			}
 		loop
 	}
-	if ( gdata(GDATA_VERSION) < 3140 ) {
-		if ( gdata(GDATA_DAY) > 31 ) {
-			gdata(GDATA_DAY) = 30
+	if ( gVersion < 3140 ) {
+		if ( gDay > 31 ) {
+			gDay = 30
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 3170 ) {
+	if ( gVersion < 3170 ) {
 		kamen5 = 100
 	}
-	if ( gdata(GDATA_VERSION) < 3180 ) {
+	if ( gVersion < 3180 ) {
 		kamen6 = 100
 	}
-	if ( gdata(GDATA_VERSION) < 3930 ) {
+	if ( gVersion < 3930 ) {
 		repeat 245
 			cdata(CDATA_CUSTOM_TALK_LINE, cnt) = 0
 		loop
-		gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) = cdata(CDATA_LEVEL, CHARA_PLAYER) * 5
+		gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) = cLevel(CHARA_PLAYER) * 5
 		if ( gdata(GDATA_FLAG_GAME_MODE) == 5 ) {
 			gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) += 10000
 		}
 		txt lang("あなたはスペルボーナスを獲得した。", "You gain spellbonus points.")
 	}
-	if ( gdata(GDATA_VERSION) < 3990 ) {
+	if ( gVersion < 3990 ) {
 		repeat 245
 			if ( cdata(CDATA_EVOLUTION_STAGE, cnt) != 1 ) {
 				continue
 			}
-			if ( cdata(CDATA_ID, cnt) == CREATURE_ID_FLOATING_EYE | cdata(CDATA_ID, cnt) == CREATURE_ID_CHAOS_EYE | cdata(CDATA_ID, cnt) == CREATURE_ID_MAD_GAZE | cdata(CDATA_ID, cnt) == CREATURE_ID_DEATH_GAZE | cdata(CDATA_ID, cnt) == CREATURE_ID_DEFORMED_EYE | cdata(CDATA_ID, cnt) == CREATURE_ID_IMPURE_EYE ) {
+			if ( cId(cnt) == CREATURE_ID_FLOATING_EYE | cId(cnt) == CREATURE_ID_CHAOS_EYE | cId(cnt) == CREATURE_ID_MAD_GAZE | cId(cnt) == CREATURE_ID_DEATH_GAZE | cId(cnt) == CREATURE_ID_DEFORMED_EYE | cId(cnt) == CREATURE_ID_IMPURE_EYE ) {
 				cdata(CDATA_CHARA_PIC, cnt) = xy2pic(1, 0)
 				txt lang("目系進化体グラフィック修正。", "The graphic of the eye evolution character have been corrected.")
 			}
 		loop
-		gdata(GDATA_CARGO_LIMIT) = gdata(GDATA_CARGO_LIMIT) / 10000 * 10000
+		gCargoLimit = gCargoLimit / 10000 * 10000
 		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 1 ) {
-			gdata(GDATA_CARGO_LIMIT) += 10 * 1000
+			gCargoLimit += 10 * 1000
 		}
 		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 2 ) {
-			gdata(GDATA_CARGO_LIMIT) += 20 * 1000
+			gCargoLimit += 20 * 1000
 		}
 		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 3 ) {
-			gdata(GDATA_CARGO_LIMIT) += 30 * 1000
+			gCargoLimit += 30 * 1000
 		}
 		if ( gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND) == 4 ) {
-			gdata(GDATA_CARGO_LIMIT) += 100 * 1000
+			gCargoLimit += 100 * 1000
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 5980 ) {
-		gdata(GDATA_FLAG_PC_SKILL_BONUS_OBTAINED) = cdata(CDATA_SKILLPOINT, CHARA_PLAYER)
+	if ( gVersion < 5980 ) {
+		gdata(GDATA_FLAG_PC_SKILL_BONUS_OBTAINED) = cSkillPoint(CHARA_PLAYER)
 		gdata(GDATA_FLAG_SPELL_BONUS_OBTAINED) = gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS)
-		if ( gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) >= 100 | cdata(CDATA_SKILLPOINT, CHARA_PLAYER) >= 100 | cdata(CDATA_PLATINUM, CHARA_PLAYER) >= 100 ) {
+		if ( gdata(GDATA_FLAG_SCROLL_OF_WITCHCRAFT_TOTAL_SPELL_BONUS) >= 100 | cSkillPoint(CHARA_PLAYER) >= 100 | cPlat(CHARA_PLAYER) >= 100 ) {
 			if ( gdata(GDATA_FLAG_GAME_MODE) != 2 & gdata(GDATA_FLAG_GAME_MODE) != 5 ) {
 				dialog lang("注意！スペルボーナス、スキルボーナス、プラチナ硬貨は100以上所持していると新たに獲得できない。", "Caution! While the spell bonus is 100 or more, you cannot get new.")
 			}
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 6020 ) {
+	if ( gVersion < 6020 ) {
 		gdata(GDATA_FLAG_SUB_MISSION_FROM_GARZIEM) = 0
 	}
-	if ( gdata(GDATA_VERSION) < 6050 ) {
-		if ( gdata(GDATA_FLAG_MAIN) >= 180 ) {
+	if ( gVersion < 6050 ) {
+		if ( flagMain >= 180 ) {
 			kamen7 = 100
 		}
-		if ( gdata(GDATA_FLAG_MAIN) >= 340 ) {
+		if ( flagMain >= 340 ) {
 			kamen8 = 100
 		}
-		if ( gdata(GDATA_FLAG_MAIN) >= 680 ) {
+		if ( flagMain >= 680 ) {
 			kamen9 = 100
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 6060 ) {
+	if ( gVersion < 6060 ) {
 		if ( gdata(GDATA_FLAG_SUB_AMURDAD) >= 10 ) {
 			gdata(GDATA_FLAG_SUB_AMURDAD) = 0
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "slime" ) {
-			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 200
+		if ( cnRace(CHARA_PLAYER) == "slime" ) {
+			cPvFix(CHARA_PLAYER) = 200
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "sheep" ) {
-			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 120
+		if ( cnRace(CHARA_PLAYER) == "sheep" ) {
+			cPvFix(CHARA_PLAYER) = 120
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "zombie" ) {
-			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 150
+		if ( cnRace(CHARA_PLAYER) == "zombie" ) {
+			cPvFix(CHARA_PLAYER) = 150
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "ent" ) {
-			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 140
+		if ( cnRace(CHARA_PLAYER) == "ent" ) {
+			cPvFix(CHARA_PLAYER) = 140
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "armor" ) {
-			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 200
+		if ( cnRace(CHARA_PLAYER) == "armor" ) {
+			cPvFix(CHARA_PLAYER) = 200
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "skeleton" ) {
-			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 120
+		if ( cnRace(CHARA_PLAYER) == "skeleton" ) {
+			cPvFix(CHARA_PLAYER) = 120
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "wisp" ) {
-			cdata(CDATA_PV_FIX, CHARA_PLAYER) = 150
+		if ( cnRace(CHARA_PLAYER) == "wisp" ) {
+			cPvFix(CHARA_PLAYER) = 150
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "rabbit" ) {
-			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 120
+		if ( cnRace(CHARA_PLAYER) == "rabbit" ) {
+			cDvFix(CHARA_PLAYER) = 120
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "cat" ) {
-			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 200
+		if ( cnRace(CHARA_PLAYER) == "cat" ) {
+			cDvFix(CHARA_PLAYER) = 200
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "dog" ) {
-			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 200
+		if ( cnRace(CHARA_PLAYER) == "dog" ) {
+			cDvFix(CHARA_PLAYER) = 200
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "rat" ) {
-			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 250
+		if ( cnRace(CHARA_PLAYER) == "rat" ) {
+			cDvFix(CHARA_PLAYER) = 250
 		}
-		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "catsister" ) {
-			cdata(CDATA_DV_FIX, CHARA_PLAYER) = 200
+		if ( cnRace(CHARA_PLAYER) == "catsister" ) {
+			cDvFix(CHARA_PLAYER) = 200
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 6070 ) {
+	if ( gVersion < 6070 ) {
 		if ( trait(TRAIT_NORMAL_SKILL_CASTING) != 0 ) {
 			if ( spact(SKILL_SPACT_MAGNECOAT - STARTING_SKILL_SPACT) == 0 ) {
 				spact(SKILL_SPACT_MAGNECOAT - STARTING_SKILL_SPACT) = 1
 				txtmore
 				txtef COLOR_YELLOW
@@ -790,43 +790,57 @@
 			cdata(CDATA_CHARA_PIC, cnt) = xy2pic(1, 0)
 		}
 		if ( cnt == 0 ) {
 			continue
 		}
-		if ( gdata(GDATA_AREA) == AREA_ARENA ) {
+		if ( gArea == AREA_ARENA ) {
 			continue
 		}
-		if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_SUSPEND ) {
+		if ( cExist(cnt) != CHAR_STATE_SUSPEND ) {
 			continue
 		}
 		if ( cdata(CDATA_IN_TAGTEAM, cnt) != 0 ) {
-			map(cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt), MAP_CHARA_INDEX_PLUS_ONE) = 0
-			cdata(CDATA_EXIST, cdata(CDATA_TAGTEAM_PARTNER, cnt)) = CHAR_STATE_SUSPEND
+			mapChara(cX(cnt), cY(cnt)) = 0
+			cExist(cdata(CDATA_TAGTEAM_PARTNER, cnt)) = CHAR_STATE_SUSPEND
 			hagureta = 100
 		}
 	loop
-	if ( gdata(GDATA_VERSION) < 6090 ) {
+	if ( gVersion < 6090 ) {
 		if ( trait(TRAIT_NORMAL_STAT_SPD) != 0 ) {
 			cdata(CDATA_MATERIAL2_COUNTER, CHARA_PLAYER) = 1
 		}
 	}
-	if ( gdata(GDATA_VERSION) < 6100 ) {
+	if ( gVersion < 6100 ) {
 		gdata(GDATA_FLAG_ABYSS_POWER) = gdata(GDATA_FLAG_ABYSS_POWER) * 20
 		if ( gdata(GDATA_FLAG_ABYSS_POWER) > 100000 ) {
 			gdata(GDATA_FLAG_ABYSS_POWER) = 100000
 		}
 	}
-	if ( gdata(GDATA_VERSION) != int(double("6.13") * 1000) ) {
-		gdata(GDATA_WORLD_RENEW) = TRUE
+	if ( gVersion < 6140 ) {
+		gdata(250 + 442) = gdata(GDATA_FLAG_WORLD_MAP_VEHICLE_KIND)
+		repeat 245
+			cSPearned(cnt) = 0
+			if ( cdata(CDATA_TAMER_WHIP_PICKUP, cnt) != 0 ) {
+				cdata(CDATA_TAMER_WHIP_PICKUP, cnt) = 0
+				cbitmod 1032, cnt, TRUE
+			}
+			if ( cdata(CDATA_TAMER_WHIP_EAT, cnt) != 0 ) {
+				cdata(CDATA_TAMER_WHIP_EAT, cnt) = 0
+				cbitmod 1033, cnt, TRUE
+			}
+		loop
+	}
+	if ( gVersion != int(double("6.14") * 1000) ) {
+		gWorldRenew = TRUE
 	}
 	del_chara 56
-	if ( gdata(GDATA_VERSION) > int(double("6.13") * 1000) ) {
+	if ( gVersion > int(double("6.14") * 1000) ) {
 		dialog "invalid version"
 		goto *exit_game
 	}
-	if ( gdata(GDATA_PLAY_TIME) < 0 ) {
-		gdata(GDATA_PLAY_TIME) = 0
+	if ( gPlayTime < 0 ) {
+		gPlayTime = 0
 	}
 	if ( gdata(GDATA_FLAG_GAME_MODE) == 3 ) {
 		if ( gdata(GDATA_GAMEMODE_PENALTY) == 4 ) {
 			dialog lang("その冒険者は蘇らない…。", "The adventurer is not revived again...")
 			goto *exit_game
@@ -862,30 +876,30 @@
 		if ( gdata(GDATA_GAMEMODE_PENALTY) == 0 ) {
 			dialog lang("Escキーでセーブ後自動終了せずに、強制終了したセーブデータにはペナルティが与えられます。", "It is a nosave penalty.")
 			modkarma 0, -100
 			skillmod SKILL_ATTR_LIFE, CHARA_PLAYER, -5000
 			skillmod SKILL_ATTR_MANA, CHARA_PLAYER, -5000
-			cdata(CDATA_GOLD, CHARA_PLAYER) = cdata(CDATA_GOLD, CHARA_PLAYER) / 2
-			cdata(CDATA_PLATINUM, CHARA_PLAYER) = cdata(CDATA_PLATINUM, CHARA_PLAYER) / 2
+			cGold(CHARA_PLAYER) = cGold(CHARA_PLAYER) / 2
+			cPlat(CHARA_PLAYER) = cPlat(CHARA_PLAYER) / 2
 			addbuff CHARA_PLAYER, BUFF_PUNISHMENT, 100000, 100
 		}
 		if ( gdata(GDATA_GAMEMODE_PENALTY) == 1 ) {
 			gdata(GDATA_GAMEMODE_PENALTY) = 0
 			snd SOUNDLIST_ENC
 		}
 	}
-	gdata(GDATA_VERSION) = int(double("6.13") * 1000)
+	gVersion = int(double("6.14") * 1000)
 	cbitmod CHARA_BIT_PCC, CHARA_PLAYER, TRUE
 	gdata(GDATA_SPEEDSUM_RESET) = 1
 	gosub *initial_recipe
 	return
 
 *mapReset
-	gdata(GDATA_MAP_VERSION)++
+	gMapVersion++
 	dim qdata, 20, 500
 	sdim qname, 40, 500
-	gdata(GDATA_CLIENT) = 0
+	gClient = 0
 	gosub *setArea
 	return
 
 *apply_gene
 	file = "shop" + 3 + ".s2"
@@ -907,13 +921,13 @@
 	else {
 		if ( ibigin > 40 ) {
 			ibigin = 40
 		}
 	}
-	cdata(CDATA_GOLD, CHARA_PLAYER) += goldbigin
-	cdata(CDATA_PLATINUM, CHARA_PLAYER) += pbigin
-	cdata(CDATA_SKILLPOINT, CHARA_PLAYER) += ibigin
+	cGold(CHARA_PLAYER) += goldbigin
+	cPlat(CHARA_PLAYER) += pbigin
+	cSkillPoint(CHARA_PLAYER) += ibigin
 	repeat 400
 		mat(cnt) = mat(cnt) / 3
 	loop
 	return
 
@@ -930,13 +944,13 @@
 		}
 		if ( cnt >= 100 & cnt < 400 ) {
 			ibigin += sorg(cnt, CHARA_PLAYER)
 		}
 	loop
-	goldbigin += limit(cdata(CDATA_GOLD, CHARA_PLAYER) / 100, 1000, 100000)
+	goldbigin += limit(cGold(CHARA_PLAYER) / 100, 1000, 100000)
 	repeat 245
-		cdata(CDATA_EXIST, cnt) = CHAR_STATE_DEAD
+		cExist(cnt) = CHAR_STATE_DEAD
 	loop
 	repeat 1200
 		sdata(cnt, MAX_CHARA_NC) = sdata(cnt, CHARA_PLAYER)
 		sdata(cnt, CHARA_PLAYER) = 0
 	loop
@@ -944,44 +958,44 @@
 		cdata(cnt, MAX_CHARA_NC) = cdata(cnt, CHARA_PLAYER)
 		cdata(cnt, CHARA_PLAYER) = 0
 	loop
 	inv_getheader -1
 	repeat invrange, invhead
-		inv(INV_ITEM_NUM, cnt) = 0
+		iNum(cnt) = 0
 	loop
 	inv_getheader 0
 	repeat invrange, invhead
-		if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
+		if ( iNum(cnt) == 0 ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_SECRET_EXP_LOMIAS ) {
+		if ( iID(cnt) == ITEM_ID_SECRET_EXP_LOMIAS ) {
 			lomiaseaster = 1
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_DEED_HEIRSHIP | refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE_MINOR) == FILTER_ITEM_DEED ) {
+		if ( iID(cnt) == ITEM_ID_DEED_HEIRSHIP | refitem(iID(cnt), DBSPEC_TYPE_MINOR) == FILTER_ITEM_DEED ) {
 			continue
 		}
-		if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_KITTY_BANK ) {
+		if ( iID(cnt) == ITEM_ID_KITTY_BANK ) {
 			continue
 		}
-		if ( inv(INV_ITEM_QUALITY, cnt) == FIX_QUALITY_UNIQUE ) {
+		if ( iQuality(cnt) == FIX_QUALITY_UNIQUE ) {
 			continue
 		}
 		if ( ibit(ITEM_BIT_PRECIOUS, cnt) ) {
 			continue
 		}
-		if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) == FILTER_AMMO ) {
+		if ( refitem(iID(cnt), DBSPEC_TYPE) == FILTER_AMMO ) {
 			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), cnt) = -1
 		}
-		inv(INV_ITEM_EQUIP, cnt) = 0
+		iEquip(cnt) = 0
 		item_copy cnt, inv_getfreeid(-1)
 	loop
 	gdata(GDATA_FLAG_END_TAGTEAM) = 1000
 	repeat 245
 		del_chara cnt
 	loop
 	gdata(GDATA_FLAG_END_TAGTEAM) = 0
-	gdata(GDATA_PLAY_TIME) = genetemp(GDATA_PLAY_TIME)
+	gPlayTime = genetemp(GDATA_PLAY_TIME)
 	return
 
 *generate_gene
 	fmode = 14
 	gosub *game_ctrlFile
@@ -1113,28 +1127,28 @@
 	loop
 	return
 
 *set_userNpc
 	if ( initunid ) {
-		cdata(CDATA_USERNPC_ID, rc) = initunid - 1
+		cUNID(rc) = initunid - 1
 		initunid = 0
 	}
-	cun = cdata(CDATA_USERNPC_ID, rc)
-	cdata(CDATA_ID, rc) = CREATURE_ID_USER
+	cun = cUNID(rc)
+	cId(rc) = CREATURE_ID_USER
 	if ( initlv != 0 ) {
-		cdata(CDATA_LEVEL, rc) = initlv
+		cLevel(rc) = initlv
 	}
 	else {
-		cdata(CDATA_LEVEL, rc) = limit(userdata(2, cun), 1, 350)
+		cLevel(rc) = limit(userdata(2, cun), 1, 350)
 	}
-	if ( cdata(CDATA_LEVEL, rc) > gdata(GDATA_DEEPEST_LEVEL) * 2 ) {
-		cdata(CDATA_LEVEL, rc) = limit(gdata(GDATA_DEEPEST_LEVEL) * 2, 1, 350)
+	if ( cLevel(rc) > gdata(GDATA_DEEPEST_LEVEL) * 2 ) {
+		cLevel(rc) = limit(gdata(GDATA_DEEPEST_LEVEL) * 2, 1, 350)
 	}
-	cdata(CDATA_PORTRAIT, rc) = -1
+	cPortrait(rc) = -1
 	creaturepack = FILTER_NOTHING
-	cdata(CDATA_ACT_INDEX, rc) = 55
-	cdata(CDATA_AI_SUB, rc) = unaiactsubfreq(cun)
+	cActIndex(rc) = 55
+	cAiSub(rc) = unaiactsubfreq(cun)
 	repeat 5
 		cdata(STARTING_CDATA_ACT_MAIN + cnt, rc) = userdata(15 + cnt, cun)
 		cdata(STARTING_CDATA_ACT_SUB + cnt, rc) = userdata(20 + cnt, cun)
 	loop
 	if ( userdatan(5, cun) != "" ) {
@@ -1145,39 +1159,39 @@
 				break
 			}
 			sdata(int(unres(cnt * 2)), rc) += int(unres(cnt * 2 + 1)) * 50
 		loop
 	}
-	cdata(CDATA_TXT, rc) = 1
-	cdata(CDATA_ALIGNMENT, rc) = -10000
-	cdatan(CDATAN_NAME, rc) = userdatan(1, cun)
-	cdatan(CDATAN_USER_NPC_TAG, rc) = userdatan(0, cun)
-	cdata(CDATA_RELATION, rc) = limit(userdata(4, cun), -3, 10)
-	cdata(CDATA_AI_CALM, rc) = limit(userdata(7, cun), 1, 4)
-	cdata(CDATA_AI_MOVE_FREQ, rc) = limit(userdata(8, cun), 0, 100)
-	cdata(CDATA_AI_DISTANCE, rc) = limit(userdata(9, cun), 1, 100)
+	cTxt(rc) = 1
+	cAlignment(rc) = -10000
+	cnName(rc) = userdatan(1, cun)
+	cnUNTAG(rc) = userdatan(0, cun)
+	cRelation(rc) = limit(userdata(4, cun), -3, 10)
+	cAiCalm(rc) = limit(userdata(7, cun), 1, 4)
+	cAiMoveFreq(rc) = limit(userdata(8, cun), 0, 100)
+	cAiDistance(rc) = limit(userdata(9, cun), 1, 100)
 	if ( userdata(11, cun) ) {
 		cdata(CDATA_ELEMENT, rc) = limit(userdata(11, cun), SKILL_RES_FIRE * 100000, MAX_SKILL_RESDMG * 100000)
 	}
-	cdata(CDATA_ACT_HEAL, rc) = userdata(10, cun)
+	cActHeal(rc) = userdata(10, cun)
 	dbidn = userdatan(2, cun)
 	dbmode = DBMODE_SET
 	gosub *db_race
 	dbidn = userdatan(3, cun)
 	dbmode = DBMODE_SET
 	gosub *db_class
-	cdata(CDATA_SEX, rc) = userdata(3, cun)
+	cSex(rc) = userdata(3, cun)
 	if ( userdata(3, cun) != 0 ) {
 		if ( userdata(3, cun) != 1 ) {
-			cdata(CDATA_SEX, rc) = rnd(2)
+			cSex(rc) = rnd(2)
 		}
 	}
 	if ( userdata(5, cun) ) {
 		fixlv = limit(userdata(5, cun), 0, 6)
 	}
 	cspecialeq = 0
-	cdata(CDATA_RELATION_ORG, rc) = cdata(CDATA_RELATION, rc)
+	cOrgRelation(rc) = cRelation(rc)
 	fixaiact rc
 	setunid rc, cun
 	return
 
 *userNpc_update
@@ -1191,11 +1205,11 @@
 	}
 	dim userdata, 70, usernpcmax + 1
 	sdim userdatan, 40, 15, usernpcmax + 1
 	sdim usertxt, 80 * 100, usernpcmax + 1
 	sdim untaglist
-	gdata(GDATA_USERNPC_COUNT) = 0
+	unCount = 0
 	buffer BUFFER_CHR, 33 * 48, (34 + (usernpcmax / 33 + 1) * 2) * 48
 	pos 0, 0
 	picload exedir + "\\graphic\\character" + devfile + ".bmp", 1
 	gmode 0
 	fread = 1
@@ -1262,11 +1276,11 @@
 			}
 			continue
 		}
 		untaglist += "/" + userdatan(0, tg) + "/"
 		if ( instr(s, 0, "_tmp_") != (-1) ) {
-			gdata(GDATA_USERNPC_COUNT)++
+			unCount++
 		}
 		procid = (procid + 1) \ 4
 		proclist(procid) = "userNpc_update:set info" + " ct:" + ct
 		userdatan(2, tg) = getnpctxt("race.", "slime")
 		userdatan(3, tg) = getnpctxt("class.", "tourist")
@@ -1381,22 +1395,22 @@
 	loop
 	gsel BUFFER_SCREEN
 	return
 	inv_getheader rc
 	repeat invrange, invhead
-		inv(INV_ITEM_EQUIP, cnt) = 0
+		iEquip(cnt) = 0
 	loop
 	repeat 30, 100
 		cdata(cnt, rc) = cdata(cnt, rc) / EXT_EQUIP_SLOTS * 10000
 	loop
 	gosub *chara_equipFull
-	cdata(CDATA_AI_ITEM, rc) = 0
+	cAiItem(rc) = 0
 	rowactend rc
 	cbitmod CHARA_BIT_PCC, rc, FALSE
 	cbitmod CHARA_BIT_LEASHED, rc, FALSE
-	cdata(CDATA_HP, rc) = cdata(CDATA_MAX_HP, rc)
-	cdata(CDATA_MP, rc) = cdata(CDATA_MAX_MP, rc)
+	cHP(rc) = cMHP(rc)
+	cMP(rc) = cMMP(rc)
 	cbitmod CHARA_BIT_LIVESTOCK, rc, FALSE
 	return
 
 *user_npc
 	fread = 0
@@ -1497,25 +1511,25 @@
 	zipend2
 	q = s
 	gosub *userNpc_update
 	initunid = findunid(q)
 	txt lang("カスタムNPCを作成した！", "A custom NPC has been successfully generated!")
-	if ( cdata(CDATA_X, CHARA_PLAYER) > 1 ) {
-		sux = cdata(CDATA_X, CHARA_PLAYER) - 1
+	if ( cX(CHARA_PLAYER) > 1 ) {
+		sux = cX(CHARA_PLAYER) - 1
 	}
 	flt
-	characreate -1, CREATURE_ID_USER, sux, cdata(CDATA_Y, CHARA_PLAYER)
+	characreate -1, CREATURE_ID_USER, sux, cY(CHARA_PLAYER)
 	repeat 245
-		if ( cdata(CDATA_ID, cnt) == CREATURE_ID_USER ) {
+		if ( cId(cnt) == CREATURE_ID_USER ) {
 			getunid cnt
 		}
 	loop
 	if ( dbg_usernpc ) {
-		cdata(CDATA_RELATION, rc) = RELATION_NEUTRAL
+		cRelation(rc) = RELATION_NEUTRAL
 	}
 	else {
-		cdata(CDATA_RELATION, rc) = RELATION_ENEMY
+		cRelation(rc) = RELATION_ENEMY
 		txt lang(name(rc) + "は興奮して襲い掛かってきた。", name(rc) + " is excited and attacks you.")
 	}
 	folder = exedir + "user\\"
 	gosub *del_userTemp
 	return
@@ -1523,11 +1537,11 @@
 *game_ctrlFile
 	notesel filemod
 	if ( timeGetTime() / 1000 - time_begin < 0 ) {
 		time_begin = timeGetTime() / 1000
 	}
-	gdata(GDATA_PLAY_TIME) = gdata(GDATA_PLAY_TIME) + timeGetTime() / 1000 - time_begin
+	gPlayTime = gPlayTime + timeGetTime() / 1000 - time_begin
 	time_begin = timeGetTime() / 1000
 	if ( fmode == 8 | fmode == 7 ) {
 		procid = (procid + 1) \ 4
 		proclist(procid) = "ctrlFile:game" + fread + " ct:" + ct
 		folder = exedir + "save\\" + playerid + "\\"
@@ -1536,11 +1550,11 @@
 		}
 		if ( fmode == 7 ) {
 			fread = 1
 		}
 		if ( fmode == 8 ) {
-			playerheader = "" + cdatan(CDATAN_NAME, CHARA_PLAYER) + " Lv:" + cdata(CDATA_LEVEL, CHARA_PLAYER) + " " + mdatan(0)
+			playerheader = "" + cnName(CHARA_PLAYER) + " Lv:" + cLevel(CHARA_PLAYER) + " " + mdatan(0)
 			bsave folder + "header.txt", playerheader
 		}
 		repeat 16
 			procid = (procid + 1) \ 4
 			proclist(procid) = "ctrlFile:game" + fread + ":" + cnt + " ct:" + ct
@@ -1607,11 +1621,11 @@
 			}
 			if ( cnt == 15 ) {
 				file += "spells.s1"
 				fsize = 800
 			}
-			if ( cnt != 14 | gdata(GDATA_VERSION) >= 1200 ) {
+			if ( cnt != 14 | gVersion >= 1200 ) {
 				if ( fread == 1 ) {
 					exist file
 					if ( strsize == (-1) ) {
 						if ( cnt != 15 ) {
 							dialog lang("セーブファイル：" + file + "が存在しません。ファイル移植ミスの可能性があるので該当フォルダ内を確認してください。", "Save file: " + file + " does not exist. Please check the appropriate folder.")
@@ -1629,11 +1643,11 @@
 				}
 			}
 			if ( fread == 0 ) {
 				zOpen hgz, file, 1, 3
 			}
-			if ( cnt != 14 | gdata(GDATA_VERSION) >= 1200 ) {
+			if ( cnt != 14 | gVersion >= 1200 ) {
 				if ( fread == 1 ) {
 					zOpen hgz, file, 0
 					if ( stat != 0 ) {
 						if ( cnt != 15 ) {
 							dialog lang("セーブファイル：" + file + "が読み込めませんでした。該当のファイルが破損している可能性があります。", "Save file: " + file + " could not be read. There is a possibility that the file in question is corrupted.")
@@ -1762,11 +1776,11 @@
 			if ( cnt == 14 ) {
 				if ( fread == 0 ) {
 					zWrite recipememory, hgz, fsize
 				}
 				if ( fread == 1 ) {
-					if ( gdata(GDATA_VERSION) >= 1200 ) {
+					if ( gVersion >= 1200 ) {
 						zRead recipememory, hgz, fsize
 					}
 				}
 			}
 			if ( cnt == 15 ) {
@@ -1847,11 +1861,11 @@
 		if ( fmode == 15 ) {
 			fread = 1
 			folder = exedir + "save\\" + geneuse + "\\"
 		}
 		if ( fmode == 14 ) {
-			playerheader = "" + cdatan(CDATAN_NAME, CHARA_PLAYER) + "(Lv" + cdata(CDATA_LEVEL, CHARA_PLAYER) + ")の遺伝子"
+			playerheader = "" + cnName(CHARA_PLAYER) + "(Lv" + cLevel(CHARA_PLAYER) + ")の遺伝子"
 			file = folder + "gene_header.txt"
 			bsave file, playerheader
 			fileadd file
 		}
 		repeat 9
@@ -1990,16 +2004,16 @@
 				file += "mdata_" + mid + ".s2"
 				fsize = 400
 			}
 			if ( cnt == 1 ) {
 				if ( fread == 1 ) {
-					dim map, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT), 10
-					dim mapsync, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT)
+					dim map, mWidth, mHeight, 10
+					dim mapsync, mWidth, mHeight
 					dim mef, 9, 200
 				}
 				file += "map_" + mid + ".s2"
-				fsize = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) * 10 * 4
+				fsize = mWidth * mHeight * 10 * 4
 			}
 			if ( cnt == 2 ) {
 				file += "cdata_" + mid + ".s2"
 				fsize = 376000
 			}
@@ -2007,18 +2021,18 @@
 				file += "sdata_" + mid + ".s2"
 				fsize = 902400
 			}
 			if ( cnt == 4 ) {
 				if ( fread ) {
-					if ( mdata(MDATA_VERSION_FIX1) == 0 ) {
-						repeat mdata(MDATA_HEIGHT)
+					if ( mVersionFix1 == 0 ) {
+						repeat mHeight
 							cnt2 = cnt
-							repeat mdata(MDATA_WIDTH)
-								map(cnt, cnt2, MAP_MEF_INDEX_PLUS_ONE) = 0
+							repeat mWidth
+								mapMef(cnt, cnt2) = 0
 							loop
 						loop
-						mdata(MDATA_VERSION_FIX1) = 1
+						mVersionFix1 = 1
 						continue
 					}
 				}
 				file += "mef_" + mid + ".s2"
 				fsize = 7200
@@ -2046,14 +2060,14 @@
 					zRead map, hgz, fsize
 				}
 			}
 			if ( cnt == 2 ) {
 				if ( fread == 0 ) {
-					zWrite cdata(CDATA_EXIST, MAX_CHARA_SAVE), hgz, fsize
+					zWrite cExist(MAX_CHARA_SAVE), hgz, fsize
 				}
 				if ( fread == 1 ) {
-					zRead cdata(CDATA_EXIST, MAX_CHARA_SAVE), hgz, fsize
+					zRead cExist(MAX_CHARA_SAVE), hgz, fsize
 				}
 			}
 			if ( cnt == 3 ) {
 				if ( fread == 0 ) {
 					zWrite sdata(SKILL_NONE, MAX_CHARA_SAVE), hgz, fsize
@@ -2095,16 +2109,16 @@
 				file += "m1_" + id + ".t"
 				fsize = 400
 			}
 			if ( cnt == 1 ) {
 				if ( fread == 1 ) {
-					dim map, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT), 10
-					dim mapsync, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT)
+					dim map, mWidth, mHeight, 10
+					dim mapsync, mWidth, mHeight
 					dim mef, 9, 200
 				}
 				file += "m2_" + id + ".t"
-				fsize = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) * 10 * 4
+				fsize = mWidth * mHeight * 10 * 4
 			}
 			if ( cnt == 2 ) {
 				file += "m3_" + id + ".t"
 				fsize = 1164800
 			}
@@ -2130,14 +2144,14 @@
 					zRead map, hgz, fsize
 				}
 			}
 			if ( cnt == 2 ) {
 				if ( fread == 0 ) {
-					zWrite inv(INV_ITEM_NUM, 1320), hgz, fsize
+					zWrite iNum(1320), hgz, fsize
 				}
 				if ( fread == 1 ) {
-					zRead inv(INV_ITEM_NUM, 1320), hgz, fsize
+					zRead iNum(1320), hgz, fsize
 				}
 			}
 			zClose hgz
 		loop
 		file = folder + "m4_" + id + ".t"
@@ -2162,11 +2176,11 @@
 		if ( fmode == 21 ) {
 			fread = 1
 			tg = 0
 		}
 		enemyteam = -1
-		gdata(GDATA_USERNPC_COUNT) = 0
+		unCount = 0
 		sdim untaglist
 		repeat 245
 			if ( fread == 0 ) {
 				if ( list(0, cnt) == 0 ) {
 					continue
@@ -2178,11 +2192,11 @@
 				if ( strsize == (-1) ) {
 					break
 				}
 				tg = 0
 				repeat 245 - 57, 57
-					if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_DEAD ) {
+					if ( cExist(cnt) == CHAR_STATE_DEAD ) {
 						tg = cnt
 						break
 					}
 				loop
 				if ( tg == 0 ) {
@@ -2210,14 +2224,14 @@
 				if ( fread == 1 ) {
 					zOpen hgz, file, 0
 				}
 				if ( cnt == 0 ) {
 					if ( fread == 0 ) {
-						zWrite cdata(CDATA_EXIST, tg), hgz, fsize
+						zWrite cExist(tg), hgz, fsize
 					}
 					if ( fread == 1 ) {
-						zRead cdata(CDATA_EXIST, tg), hgz, fsize
+						zRead cExist(tg), hgz, fsize
 					}
 				}
 				if ( cnt == 1 ) {
 					if ( fread == 0 ) {
 						zWrite sdata(SKILL_NONE, tg), hgz, fsize
@@ -2226,14 +2240,14 @@
 						zRead sdata(SKILL_NONE, tg), hgz, fsize
 					}
 				}
 				if ( cnt == 2 ) {
 					if ( fread == 0 ) {
-						zWrite inv(INV_ITEM_NUM, invhead), hgz, fsize
+						zWrite iNum(invhead), hgz, fsize
 					}
 					if ( fread == 1 ) {
-						zRead inv(INV_ITEM_NUM, invhead), hgz, fsize
+						zRead iNum(invhead), hgz, fsize
 					}
 				}
 				zClose hgz
 			loop
 			file = folder + "c4_" + id + ".t"
@@ -2243,67 +2257,67 @@
 			if ( fread == 0 ) {
 				zipadd "c1_" + id + ".t"
 				zipadd "c2_" + id + ".t"
 				zipadd "c3_" + id + ".t"
 				zipadd "c4_" + id + ".t"
-				if ( cdata(CDATA_ID, tg) == CREATURE_ID_USER ) {
-					exist folder + userdatan(6, cdata(CDATA_USERNPC_ID, tg))
+				if ( cId(tg) == CREATURE_ID_USER ) {
+					exist folder + userdatan(6, cUNID(tg))
 					if ( strsize != (-1) ) {
-						if ( cdata(CDATA_USERNPC_ID, tg) != usernpcmax ) {
-							if ( instr(untaglist, 0, "/" + userdatan(0, cdata(CDATA_USERNPC_ID, tg)) + "/") == (-1) ) {
-								if ( gdata(GDATA_USERNPC_COUNT) < 10 ) {
-									bcopy folder + userdatan(6, cdata(CDATA_USERNPC_ID, tg)), folder + "_tmp_" + gdata(GDATA_USERNPC_COUNT) + ".npc"
-									zipadd "_tmp_" + gdata(GDATA_USERNPC_COUNT) + ".npc"
-									untaglist += "/" + userdatan(0, cdata(CDATA_USERNPC_ID, tg)) + "/"
-									gdata(GDATA_USERNPC_COUNT)++
+						if ( cUNID(tg) != usernpcmax ) {
+							if ( instr(untaglist, 0, "/" + userdatan(0, cUNID(tg)) + "/") == (-1) ) {
+								if ( unCount < 10 ) {
+									bcopy folder + userdatan(6, cUNID(tg)), folder + "_tmp_" + unCount + ".npc"
+									zipadd "_tmp_" + unCount + ".npc"
+									untaglist += "/" + userdatan(0, cUNID(tg)) + "/"
+									unCount++
 								}
 							}
 						}
 					}
 				}
 			}
 			else {
 				inv_getheader tg
 				repeat invrange, invhead
-					inv(INV_ITEM_EQUIP, cnt) = 0
+					iEquip(cnt) = 0
 				loop
 				repeat 30, 100
 					cdata(cnt, tg) = cdata(cnt, tg) / EXT_EQUIP_SLOTS * 10000
 				loop
 				rc = tg
 				gosub *chara_equipFull
-				cdata(CDATA_AI_ITEM, rc) = 0
+				cAiItem(rc) = 0
 				rowactend rc
 				cbitmod CHARA_BIT_PCC, rc, FALSE
 				cbitmod CHARA_BIT_LEASHED, rc, FALSE
-				cdata(CDATA_HP, rc) = cdata(CDATA_MAX_HP, rc)
-				cdata(CDATA_MP, rc) = cdata(CDATA_MAX_MP, rc)
+				cHP(rc) = cMHP(rc)
+				cMP(rc) = cMMP(rc)
 				cbitmod CHARA_BIT_LIVESTOCK, rc, FALSE
 				cbitmod CHARA_BIT_MSG_FILE, rc, FALSE
 				if ( importmode == 0 ) {
-					cdata(CDATA_ROLE, tg) = ROLE_USER
-					cdata(CDATA_GOLD, tg) = 0
-					if ( cdata(CDATA_RELATION, tg) >= RELATION_ALLY ) {
+					cRole(tg) = ROLE_USER
+					cGold(tg) = 0
+					if ( cRelation(tg) >= RELATION_ALLY ) {
 						if ( userrelation == 0 ) {
-							cdata(CDATA_RELATION, tg) = RELATION_NEUTRAL
-							cdata(CDATA_RELATION_ORG, tg) = RELATION_NEUTRAL
+							cRelation(tg) = RELATION_NEUTRAL
+							cOrgRelation(tg) = RELATION_NEUTRAL
 						}
 						else {
-							cdata(CDATA_RELATION, tg) = RELATION_ENEMY
-							cdata(CDATA_RELATION_ORG, tg) = RELATION_ENEMY
+							cRelation(tg) = RELATION_ENEMY
+							cOrgRelation(tg) = RELATION_ENEMY
 						}
 					}
-					cxinit = cdata(CDATA_X, tg)
-					cyinit = cdata(CDATA_Y, tg)
+					cxinit = cX(tg)
+					cyinit = cY(tg)
 					gosub *place_chara
 				}
 				if ( importmode == 1 ) {
 					if ( enemyteam == (-1) ) {
 						enemyteam = rc
 					}
-					cdata(CDATA_RELATION, rc) = RELATION_ENEMY
-					cdata(CDATA_RELATION_ORG, rc) = RELATION_ENEMY
+					cRelation(rc) = RELATION_ENEMY
+					cOrgRelation(rc) = RELATION_ENEMY
 					map_placearena rc, 1
 				}
 			}
 			id++
 		loop
@@ -2313,11 +2327,11 @@
 		proclist(procid) = "ctrlFile" + fmode + " ct:" + ct
 		dim cmapdata, 5, 400
 		repeat 2
 			if ( cnt == 0 ) {
 				file = fmapfile + ".map"
-				fsize = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) * 3 * 4
+				fsize = mWidth * mHeight * 3 * 4
 			}
 			if ( cnt == 1 ) {
 				file = fmapfile + ".obj"
 				fsize = 8000
 			}
@@ -2350,16 +2364,16 @@
 				file = fmapfile + ".idx"
 				fsize = 400
 			}
 			if ( cnt == 1 ) {
 				if ( fread == 1 ) {
-					dim map, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT), 10
-					dim mapsync, mdata(MDATA_WIDTH), mdata(MDATA_HEIGHT)
+					dim map, mWidth, mHeight, 10
+					dim mapsync, mWidth, mHeight
 					dim mef, 9, 200
 				}
 				file = fmapfile + ".map"
-				fsize = mdata(MDATA_WIDTH) * mdata(MDATA_HEIGHT) * 10 * 4
+				fsize = mWidth * mHeight * 10 * 4
 			}
 			if ( cnt == 2 ) {
 				file = fmapfile + ".obj"
 				fsize = 8000
 			}
@@ -2423,14 +2437,14 @@
 		}
 		if ( fread == 1 ) {
 			zopenwrapper hgz, file, 0
 		}
 		if ( fread == 0 ) {
-			zWrite inv(INV_ITEM_NUM, 1320), hgz, fsize
+			zWrite iNum(1320), hgz, fsize
 		}
 		if ( fread == 1 ) {
-			zRead inv(INV_ITEM_NUM, 1320), hgz, fsize
+			zRead iNum(1320), hgz, fsize
 		}
 		zClose hgz
 	}
 	if ( fmode == 23 | fmode == 24 ) {
 		procid = (procid + 1) \ 4
@@ -2488,14 +2502,14 @@
 			if ( fread == 1 ) {
 				zopenwrapper hgz, file, 0
 			}
 			if ( cnt == 0 ) {
 				if ( fread == 0 ) {
-					zWrite cdata(CDATA_EXIST, MAX_CHARA_SAVE), hgz, fsize
+					zWrite cExist(MAX_CHARA_SAVE), hgz, fsize
 				}
 				if ( fread == 1 ) {
-					zRead cdata(CDATA_EXIST, MAX_CHARA_SAVE), hgz, fsize
+					zRead cExist(MAX_CHARA_SAVE), hgz, fsize
 				}
 			}
 			if ( cnt == 1 ) {
 				if ( fread == 0 ) {
 					zWrite sdata(SKILL_NONE, MAX_CHARA_SAVE), hgz, fsize
@@ -2604,11 +2618,11 @@
 		headtemp = "[＋製]【" + usertitle + "】\n"
 	}
 	else {
 		headtemp = "[＋製]【" + mdatan(0) + "】\n"
 	}
-	headtemp += "" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "\n"
+	headtemp += "" + cnAka(CHARA_PLAYER) + cnName(CHARA_PLAYER) + "\n"
 	headtemp += "\n"
 	headtemp += "\n"
 	headtemp += "" + 100002 + "\n"
 	headtemp += "[＋製]" + usermsg + "\n"
 	headtemp += "" + userrelation + "\n"
@@ -2617,12 +2631,12 @@
 	gosub *game_ctrlFile
 	repeat 245
 		list(0, cnt) = 0
 		if ( cnt != 0 ) {
 			if ( cdata(CDATA_IN_TAGTEAM, cnt) != 1 ) {
-				if ( cdata(CDATA_ROLE, cnt) != ROLE_ADVENTURER ) {
-					if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
+				if ( cRole(cnt) != ROLE_ADVENTURER ) {
+					if ( cExist(cnt) == CHAR_STATE_ALIVE ) {
 						if ( cbit(CHARA_BIT_RIDE, cnt) == FALSE ) {
 							list(0, cnt) = 1
 						}
 					}
 				}
@@ -2638,12 +2652,12 @@
 *export_chara
 	sdim headtemp, 1024
 	id = 0
 	lensum = 1024
 	sdim filebuff, lensum
-	headtemp = "【" + gdatan(GDATAN_TEAM1) + "】(" + n + "体) Lv" + lv + "\n"
-	headtemp += "" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "\n"
+	headtemp = "【" + gnTeam1 + "】(" + n + "体) Lv" + lv + "\n"
+	headtemp += "" + cnAka(CHARA_PLAYER) + cnName(CHARA_PLAYER) + "\n"
 	headtemp += "\n"
 	headtemp += "\n"
 	headtemp += "" + 100002 + "\n"
 	headtemp += "" + n + "\n"
 	headtemp += "" + lv + "\n"
@@ -2679,26 +2693,26 @@
 	repeat stat
 		noteget file, cnt
 		delete exedir + "user\\" + file
 	loop
 	return
-	arenaop = 1, 2, (100 - gdata(GDATA_RANK_PET_ARENA) / 100) / 2 + 1
+	arenaop = 1, 2, (100 - gRankPetArena / 100) / 2 + 1
 	arenaop(1) = rnd(9 - 1) + 2
 	dim followerexist, 16
 	repeat 16
-		followerexist(cnt) = cdata(CDATA_EXIST, cnt)
-		if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
+		followerexist(cnt) = cExist(cnt)
+		if ( cExist(cnt) == CHAR_STATE_ALIVE ) {
 			followerin(cnt) = 1
 		}
 		else {
 			followerin(cnt) = 0
 		}
 	loop
-	gdata(GDATA_QUEST) = QUEST_SUBTYPE_DELIVER, 0, 0, 1
-	gdata(GDATA_RETURN_AREA) = gdata(GDATA_AREA), gdata(GDATA_LEVEL), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
-	gdata(GDATA_TELEPORT_AREA) = AREA_PET_ARENA
-	gdata(GDATA_TELEPORT_LEVEL) = 1
+	gQuest = QUEST_SUBTYPE_DELIVER, 0, 0, 1
+	gReturnArea = gArea, gLevel, cX(CHARA_PLAYER), cY(CHARA_PLAYER)
+	gTeleportArea = AREA_PET_ARENA
+	gTeleportLevel = 1
 	levelexitby = MAP_EXIT_TELEPORT
 	arenaimport = 1
 	goto *map_exit
 
 *game_load
@@ -2717,12 +2731,12 @@
 	repeat 16
 		if ( cbit(CHARA_BIT_PCC, cnt) == TRUE | cnt == 0 ) {
 			create_pcpic cnt, 1
 		}
 	loop
-	if ( gdata(GDATA_WIZARD) == 1 ) {
-		cdatan(CDATAN_AKA, CHARA_PLAYER) = "*Debug*"
+	if ( gWizard == 1 ) {
+		cnAka(CHARA_PLAYER) = "*Debug*"
 	}
 	refreshspeed 0
 	time_begin = timeGetTime() / 1000
 	return
 	procid = (procid + 1) \ 4
@@ -2741,21 +2755,21 @@
 	if ( save_f == 0 ) {
 		mkdir file
 	}
 	else {
 	}
-	diaryhead = "<HTML><TITLE>" + cdatan(CDATAN_AKA, CHARA_PLAYER) + cdatan(CDATAN_NAME, CHARA_PLAYER) + "の冒険日誌</TITLE>"
+	diaryhead = "<HTML><TITLE>" + cnAka(CHARA_PLAYER) + cnName(CHARA_PLAYER) + "の冒険日誌</TITLE>"
 	diarystat = ""
 	diarylog = ""
 	diaryfoot = "</HTML>"
 	buff = diaryhead + diarystat + diarylog + diaryfoot
 	notesel buff
 	notesave exedir + "save\\" + playerid + "_html\\diary.html"
 	return
 
 *game_save
-	if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE | (gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179) | (gdata(GDATA_AREA) == AREA_AMUR_CAGE & gdata(GDATA_LEVEL) >= 10) ) {
+	if ( gArea == AREA_SHOW_HOUSE | (gArea == AREA_CHAOS_CRADLE & gLevel == 179) | (gArea == AREA_AMUR_CAGE & gLevel >= 10) ) {
 		txtef COLOR_RED
 		txt lang("ここではセーブされない。", "The game is not saved in this map.")
 		gosub *screen_draw
 		return
 	}
@@ -2808,13 +2822,13 @@
 	filemod = ""
 	return
 
 *extract_map
 	snd SOUNDLIST_EXITMAP1
-	gdata(GDATA_RETURN_AREA) = gdata(GDATA_AREA), gdata(GDATA_LEVEL), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
-	gdata(GDATA_TELEPORT_AREA) = AREA_SHOW_HOUSE
-	gdata(GDATA_TELEPORT_LEVEL) = 1
+	gReturnArea = gArea, gLevel, cX(CHARA_PLAYER), cY(CHARA_PLAYER)
+	gTeleportArea = AREA_SHOW_HOUSE
+	gTeleportLevel = 1
 	levelexitby = MAP_EXIT_TELEPORT
 	goto *map_exit
 
 *game_title
 	if ( cfg_titledialog ) {
@@ -3209,15 +3223,15 @@
 	goto *game_title_selectGen_WHILE1
 
 *define_los
 	dim fovlist, 2, 17
 	dim fovmap, 17 * 2 + 4, 17 * 2
-	if ( cdata(CDATA_FOV, CHARA_PLAYER) < 1 ) {
-		cdata(CDATA_FOV, CHARA_PLAYER) = 1
+	if ( cFov(CHARA_PLAYER) < 1 ) {
+		cFov(CHARA_PLAYER) = 1
 	}
-	if ( cdata(CDATA_FOV, CHARA_PLAYER) >= 17 ) {
-		cdata(CDATA_FOV, CHARA_PLAYER) = 17 - 1
+	if ( cFov(CHARA_PLAYER) >= 17 ) {
+		cFov(CHARA_PLAYER) = 17 - 1
 	}
 	repeat 17
 		y = cnt
 		repeat 17
 			x = cnt
@@ -3338,11 +3352,11 @@
 		pos x, y
 		mesbox inputlog, 600, 0, 5, val(2) * (1 + en)
 		pos x + 4, y + 4
 		gfini dx - 1, 35
 		gfdec 60, 60, 60
-		aplsel "ElonaPlus 2.13"
+		aplsel "ElonaPlus 2.14"
 		if ( stat == 1 ) {
 			dialog "Failed to get WINDOW ID", 1
 			clrobj 1
 			cfg_msg_box = 0
 			goto *prompt_word
@@ -3454,12 +3468,12 @@
 
 *prompt_direction
 	snd SOUNDLIST_POP2
 	redraw 0
 	gsel BUFFER_BUF
-	x = (cdata(CDATA_X, CHARA_PLAYER) - scx) * inf_tiles + inf_screenx - 48
-	y = (cdata(CDATA_Y, CHARA_PLAYER) - scy) * inf_tiles + inf_screeny - 48
+	x = (cX(CHARA_PLAYER) - scx) * inf_tiles + inf_screenx - 48
+	y = (cY(CHARA_PLAYER) - scy) * inf_tiles + inf_screeny - 48
 	gmode 0
 	pos 0, 0
 	gcopy BUFFER_SCREEN, x, y, 48 * 3, 48 * 3
 	gsel BUFFER_SCREEN
 	t = 0
@@ -3469,12 +3483,12 @@
 		goto *prompt_key
 	}
 	t++
 	gmode 4, 28, 28, 200 - t / 2 \ 20 * (t / 2 \ 20)
 	color 0, 0, 0
-	x = (cdata(CDATA_X, CHARA_PLAYER) - scx) * inf_tiles + inf_screenx + 24
-	y = (cdata(CDATA_Y, CHARA_PLAYER) - scy) * inf_tiles + inf_screeny + 24
+	x = (cX(CHARA_PLAYER) - scx) * inf_tiles + inf_screenx + 24
+	y = (cY(CHARA_PLAYER) - scy) * inf_tiles + inf_screeny + 24
 	if ( key_alt == 0 ) {
 		pos x, y - 48
 		grotate BUFFER_INF, 212, 432, 0, 28, 28
 		pos x, y + 48
 		grotate BUFFER_INF, 212, 432, 1.0 * 3.14, 28, 28
@@ -3497,12 +3511,12 @@
 	pos x - 48 - 24, y - 48 - 24
 	gcopy BUFFER_BUF, 0, 0, 48 * 3, 48 * 3
 	gmode 2
 	await 30
 	key_check 1
-	x = cdata(CDATA_X, CHARA_PLAYER)
-	y = cdata(CDATA_Y, CHARA_PLAYER)
+	x = cX(CHARA_PLAYER)
+	y = cY(CHARA_PLAYER)
 	if ( key == key_alter ) {
 		goto *prompt_direction_WHILE1_CONTINUE
 	}
 	if ( key == key_wait | key == key_enter ) {
 		tlocx = x
@@ -3557,17 +3571,17 @@
 	if ( key == key_southeast ) {
 		x += 1
 		y += 1
 	}
 	if ( key != "" ) {
-		if ( x < 0 | y < 0 | x >= mdata(MDATA_WIDTH) | y >= mdata(MDATA_HEIGHT) ) {
-			x = cdata(CDATA_X, CHARA_PLAYER)
-			y = cdata(CDATA_Y, CHARA_PLAYER)
+		if ( x < 0 | y < 0 | x >= mWidth | y >= mHeight ) {
+			x = cX(CHARA_PLAYER)
+			y = cY(CHARA_PLAYER)
 			keyhalt = 1
 			return 0
 		}
-		if ( x == cdata(CDATA_X, CHARA_PLAYER) & y == cdata(CDATA_Y, CHARA_PLAYER) ) {
+		if ( x == cX(CHARA_PLAYER) & y == cY(CHARA_PLAYER) ) {
 			return 0
 		}
 		tlocx = x
 		tlocy = y
 		keyhalt = 1
@@ -3701,11 +3715,11 @@
 
 *game_debug
 	notesel dbm
 	buff = ""
 	if ( dbm == "" ) {
-		noteadd "ElonaPlus 2.13" + " v" + "6.13" + " Debug Console    Type \"?\" for help. Hit ESC to exit."
+		noteadd "ElonaPlus 2.14" + " v" + "6.14" + " Debug Console    Type \"?\" for help. Hit ESC to exit."
 		noteadd ""
 	}
 	font lang(cfg_font1, cfg_font2), 14 - en * 2, 0
 	objmode 2
 	pos 0, 24
@@ -3771,11 +3785,11 @@
 		noteadd "\tmapinfo\t\tShows map info."
 		goto *console_write
 	}
 	if ( int(buff) == 1 ) {
 		repeat 245
-			noteadd "" + cnt + "\t" + cdatan(CDATAN_NAME, cnt) + "\tExist:" + cdata(CDATA_EXIST, cnt) + "\tRespawn:" + cdata(CDATA_RESPAWN, cnt) + "\tRole:" + cdata(CDATA_ROLE, cnt)
+			noteadd "" + cnt + "\t" + cnName(cnt) + "\tExist:" + cExist(cnt) + "\tRespawn:" + cRespawn(cnt) + "\tRole:" + cRole(cnt)
 		loop
 		goto *console_write
 	}
 	if ( int(buff) == 2 ) {
 		repeat 30
@@ -3896,47 +3910,47 @@
 		gosub *mapReset
 		noteadd "Done."
 		goto *console_write
 	}
 	if ( instr(buff, 0, "exitroom") != (-1) ) {
-		if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
+		if ( gArea == AREA_SHOW_HOUSE ) {
 			dbg_exitshowroom = 1
 			noteadd "Done."
 		}
 		else {
 			noteadd "Wrong map."
 		}
 		goto *console_write
 	}
 	if ( instr(buff, 0, "removequest") != (-1) ) {
-		repeat gdata(GDATA_CLIENT)
-			if ( qdata(QDATA_STATE, cnt) != QUEST_STATE_NONE ) {
-				if ( qdata(QDATA_DEADLINE, cnt) == (-1) ) {
-					qdata(QDATA_STATE, cnt) = QUEST_STATE_NONE
+		repeat gClient
+			if ( qStatus(cnt) != QUEST_STATE_NONE ) {
+				if ( qDeadline(cnt) == (-1) ) {
+					qStatus(cnt) = QUEST_STATE_NONE
 				}
 			}
 		loop
 		noteadd "Done."
 		goto *console_write
 	}
 	if ( instr(buff, 0, "fixmap") != (-1) ) {
 		repeat 245
-			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
+			if ( cExist(cnt) != CHAR_STATE_ALIVE ) {
 				continue
 			}
-			if ( cdata(CDATA_X, cnt) < 0 | cdata(CDATA_X, cnt) >= mdata(MDATA_WIDTH) | cdata(CDATA_Y, cnt) < 0 | cdata(CDATA_Y, cnt) >= mdata(MDATA_HEIGHT) ) {
-				cdata(CDATA_X, cnt) = 0
-				cdata(CDATA_Y, cnt) = 0
+			if ( cX(cnt) < 0 | cX(cnt) >= mWidth | cY(cnt) < 0 | cY(cnt) >= mHeight ) {
+				cX(cnt) = 0
+				cY(cnt) = 0
 			}
 		loop
 		repeat 400, 5080
-			if ( inv(INV_ITEM_NUM, cnt) <= 0 ) {
+			if ( iNum(cnt) <= 0 ) {
 				continue
 			}
-			if ( inv(INV_ITEM_X, cnt) < 0 | inv(INV_ITEM_X, cnt) >= mdata(MDATA_WIDTH) | inv(INV_ITEM_Y, cnt) < 0 | inv(INV_ITEM_Y, cnt) >= mdata(MDATA_HEIGHT) ) {
-				inv(INV_ITEM_X, cnt) = 0
-				inv(INV_ITEM_Y, cnt) = 0
+			if ( iX(cnt) < 0 | iX(cnt) >= mWidth | iY(cnt) < 0 | iY(cnt) >= mHeight ) {
+				iX(cnt) = 0
+				iY(cnt) = 0
 			}
 		loop
 		cell_refresh 0, 0
 		noteadd "Done."
 		goto *console_write
@@ -3962,39 +3976,39 @@
 		repeat 57
 			rc = cnt
 			inv_getheader rc
 			repeat invrange, invhead
 				cnt2 = cnt
-				if ( inv(INV_ITEM_ID, cnt) >= MAX_ITEM_DBID | inv(INV_ITEM_ID, cnt) <= ITEM_ID_DUMMY | inv(INV_ITEM_NUM, cnt) <= 0 ) {
+				if ( iID(cnt) >= MAX_ITEM_DBID | iID(cnt) <= ITEM_ID_DUMMY | iNum(cnt) <= 0 ) {
 					repeat 70
 						inv(cnt, cnt2) = 0
 					loop
 				}
-				if ( inv(INV_ITEM_EQUIP, cnt) != 0 ) {
-					inv(INV_ITEM_EQUIP, cnt) = 0
+				if ( iEquip(cnt) != 0 ) {
+					iEquip(cnt) = 0
 				}
 			loop
 			repeat 30, 100
 				cdata(cnt, rc) = cdata(cnt, rc) / EXT_EQUIP_SLOTS * 10000
 			loop
 			if ( cnt >= 16 ) {
-				cdata(CDATA_EXIST, cnt) = CHAR_STATE_ADV_DEAD
+				cExist(cnt) = CHAR_STATE_ADV_DEAD
 				gosub *adv_generate
 			}
 		loop
 		noteadd "Done."
 		goto *console_write
 	}
 	if ( instr(buff, 0, "client") != (-1) ) {
 		dim mapclient, 1000
 		repeat 500
-			if ( qdata(QDATA_CLIENT, cnt) == 0 ) {
+			if ( qClient(cnt) == 0 ) {
 				i = cnt
 				continue
 			}
-			noteadd "id:" + cnt + " name:" + qname(cnt) + " map:" + mapname(qdata(QDATA_MAP, cnt))
-			mapclient(qdata(QDATA_MAP, cnt))++
+			noteadd "id:" + cnt + " name:" + qname(cnt) + " map:" + mapname(qMap(cnt))
+			mapclient(qMap(cnt))++
 		loop
 		repeat 1000
 			if ( mapclient(cnt) != 0 ) {
 				noteadd "" + mapname(cnt) + ":" + mapclient(cnt), 1
 			}
@@ -4004,103 +4018,103 @@
 	if ( instr(buff, 0, "108fix") != (-1) ) {
 		repeat 245
 			if ( cnt < 57 ) {
 				continue
 			}
-			if ( cdata(CDATA_EXIST, cnt) == CHAR_STATE_ALIVE ) {
-				cdata(CDATA_RELATION, cnt) = RELATION_ENEMY
-				cdata(CDATA_RELATION_ORG, cnt) = RELATION_ENEMY
+			if ( cExist(cnt) == CHAR_STATE_ALIVE ) {
+				cRelation(cnt) = RELATION_ENEMY
+				cOrgRelation(cnt) = RELATION_ENEMY
 			}
 		loop
 		noteadd "Done."
 		goto *console_write
 	}
 	if ( instr(buff, 0, "test") != (-1) ) {
 		repeat 500
-			noteadd "" + cnt + ":" + mapname(cnt) + "/" + adata(ADATA_ID, cnt)
+			noteadd "" + cnt + ":" + mapname(cnt) + "/" + areaId(cnt)
 		loop
 		noteadd "Done."
 		goto *console_write
 	}
 	if ( instr(buff, 0, "mapinfo") != (-1) ) {
-		noteadd "gArea\t\t:" + gdata(GDATA_AREA)
-		noteadd "gLevel\t\t:" + gdata(GDATA_LEVEL)
+		noteadd "gArea\t\t:" + gArea
+		noteadd "gLevel\t\t:" + gLevel
 		noteadd "file\t\t:" + "mdata_" + mid + ".s2"
-		noteadd "pc x/y\t\t:" + cdata(CDATA_X, CHARA_PLAYER) + "/" + cdata(CDATA_Y, CHARA_PLAYER)
-		noteadd "map max w/h\t:" + mdata(MDATA_WIDTH) + "/" + mdata(MDATA_HEIGHT)
+		noteadd "pc x/y\t\t:" + cX(CHARA_PLAYER) + "/" + cY(CHARA_PLAYER)
+		noteadd "map max w/h\t:" + mWidth + "/" + mHeight
 		noteadd "Done."
 		goto *console_write
 	}
 	if ( instr(buff, 0, "quest") != (-1) ) {
-		noteadd "gQuest:" + gdata(GDATA_QUEST) + " gQuestRef:" + gdata(GDATA_QUEST_REF) + " gQuestStatus:" + gdata(GDATA_QUEST_STATE) + " rq:" + rq
+		noteadd "gQuest:" + gQuest + " gQuestRef:" + gQuestRef + " gQuestStatus:" + gQuestStatus + " rq:" + rq
 		repeat 5
 			p = gdata(GDATA_QUEST_POOL + cnt)
-			noteadd "quest" + cnt + " " + p + " exist" + qdata(QDATA_EXIST, p) + " status" + qdata(QDATA_STATE, p) + " var" + qdata(QDATA_VAR, p) + " encount" + qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), p)
+			noteadd "quest" + cnt + " " + p + " exist" + qExist(p) + " status" + qStatus(p) + " var" + qVar(p) + " encount" + qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), p)
 		loop
-		repeat gdata(GDATA_CLIENT)
-			noteadd "" + cnt + " " + qdata(QDATA_CLIENT, cnt) + "/" + qdata(QDATA_MAP, cnt)
+		repeat gClient
+			noteadd "" + cnt + " " + qClient(cnt) + "/" + qMap(cnt)
 		loop
 		goto *console_write
 	}
 	if ( instr(buff, 0, "wizard") != (-1) ) {
-		gdata(GDATA_WIZARD) = 1
-		cdatan(CDATAN_AKA, CHARA_PLAYER) = "*Debug*"
+		gWizard = 1
+		cnAka(CHARA_PLAYER) = "*Debug*"
 		noteadd "Wizard mode activated."
 		goto *console_write
 	}
-	if ( gdata(GDATA_WIZARD) | 0 ) {
+	if ( gWizard | 0 ) {
 		if ( instr(buff, 0, "gain_spell") != (-1) ) {
 			repeat 492 - 400, 400
-				skillgain CHARA_PLAYER, cnt, cdata(CDATA_LEVEL, r1), 100 * 100
+				skillgain CHARA_PLAYER, cnt, cLevel(r1), 100 * 100
 			loop
 			noteadd "Done."
 			goto *console_write
 		}
 		if ( instr(buff, 0, "gain_spact") != (-1) ) {
-			repeat 843 - 600
+			repeat 846 - 600
 				spact(cnt + STARTING_SKILL_SPACT - STARTING_SKILL_SPACT) = 1
 			loop
 			noteadd "Done."
 			goto *console_write
 		}
 		if ( instr(buff, 0, "allinv") != (-1) ) {
 			repeat 5480
 				if ( cnt < 5080 ) {
 					if ( cnt >= 200 ) {
 						if ( (cnt - 200) \ 20 == 0 ) {
-							noteadd "-----------" + cdatan(CDATAN_NAME, (cnt - 200) / 20 + 1)
+							noteadd "-----------" + cnName((cnt - 200) / 20 + 1)
 						}
 					}
 				}
 				if ( cnt == 5080 ) {
 					noteadd "-----------------------MAP INV"
 				}
-				noteadd "" + cnt + "\t" + inv(INV_ITEM_NUM, cnt) + "\t" + itemname(cnt) + " it:" + inv(INV_ITEM_TURN, cnt)
+				noteadd "" + cnt + "\t" + iNum(cnt) + "\t" + itemname(cnt) + " it:" + iTurn(cnt)
 			loop
 			goto *console_write
 		}
 		if ( instr(buff, 0, "mapinv") != (-1) ) {
 			repeat 5480 - 5080
 				if ( cnt == 5080 ) {
 					noteadd "-----------------------MAP INV"
 				}
-				if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
-					noteadd "" + cnt + "\t" + inv(INV_ITEM_NUM, cnt) + "\t" + itemname(cnt) + " it:" + inv(INV_ITEM_TURN, cnt)
+				if ( iNum(cnt) != 0 ) {
+					noteadd "" + cnt + "\t" + iNum(cnt) + "\t" + itemname(cnt) + " it:" + iTurn(cnt)
 				}
 			loop
 			goto *console_write
 		}
 		if ( instr(buff, 0, "gain_exp") != (-1) ) {
-			cdata(CDATA_EXP, CHARA_PLAYER) += 1000000000
+			cExp(CHARA_PLAYER) += 1000000000
 			r1 = 0
 			r2 = 0
 			gosub *calcLevelUp
 			noteadd "Done."
 			goto *console_write
 		}
 		if ( instr(buff, 0, "gain_fame") != (-1) ) {
-			cdata(CDATA_FAME, CHARA_PLAYER) += 10000
+			cFame(CHARA_PLAYER) += 10000
 			noteadd "Done."
 			goto *console_write
 		}
 	}
 	noteadd "Unknown command. Type \"?\" for help. Hit ESC to exit."
@@ -4112,11 +4126,11 @@
 	objprm 1, dbm
 	objprm 2, ""
 	return
 
 *mutexobj
-	CreateMutexA 0, 0, "ElonaPlus 2.13"
+	CreateMutexA 0, 0, "ElonaPlus 2.14"
 	mutex_handle = stat
 	func_3
 	if ( stat == 183 ) {
 		dialog lang("二重起動のため終了します。", "The program is already running."), 1
 		end
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/tcg.hsp ../2.14-borscht/tcg.hsp
--- ../2.13-borscht/tcg.hsp	2022-06-26 12:14:17.553031000 -0700
+++ ../2.14-borscht/tcg.hsp	2022-09-18 12:37:02.268994000 -0700
@@ -1014,18 +1014,18 @@
 	}
 	if ( locvar_actionproc__switch_val == locvar_actionproc_cdsummonrace | locvar_actionproc__switch_sw ) {
 		locvar_actionproc__switch_sw = 0
 		locvar_actionproc_deckmode = 1
 		locvar_actionproc_deckrefn = locvar_create_card_cardn(0, locvar_actionproc_ac)
-		gosub *select_deck
+		gosub *label_5103
 		goto *actionproc_SWEND1
 		locvar_actionproc__switch_sw++
 	}
 	if ( locvar_actionproc__switch_val == locvar_actionproc_cdsummon | locvar_actionproc__switch_sw ) {
 		locvar_actionproc__switch_sw = 0
 		locvar_actionproc_deckmode = 2
-		gosub *select_deck
+		gosub *label_5103
 		goto *actionproc_SWEND1
 	}
 
 *actionproc_SWEND1
 	if ( locvar_cdbit_card(9, locvar_actionproc_ac) == 20 ) {
@@ -1313,11 +1313,11 @@
 		}
 		locvar_tcgdeck_decksizebk = gdata(GDATA_DECK_SIZE + curdeck)
 		snd SOUNDLIST_WEAR
 		calcdecksize
 		locvar_actionproc_deckmode = 0, locvar_tcgdeck_rtval
-		gosub *select_deck
+		gosub *label_5103
 		goto *tcgDeck_loop
 	}
 	return
 
 #deffunc tcgmain
@@ -1784,11 +1784,11 @@
 		locvar_cslinedown_page = locvar_tcgdrawcard_dsc / 8
 	}
 	locvar_cslinedown_page = locvar_cslinedown_page - locvar_cslinedown_page \ 3
 	return
 
-*select_deck
+*label_5103
 	gsel BUFFER_BUF
 	pos 0, 0
 	picload exedir + "graphic\\bg_card.bmp", 1
 	gsel BUFFER_SCREEN
 	dim locvar_tcgdrawcard_dlist, 2, 400
@@ -2232,11 +2232,11 @@
 		}
 		getkey locvar_dbghit_a, 113
 		if ( locvar_dbghit_a ) {
 			locvar_actionproc_deckmode = 0
 			locvar_actionproc_deckrefn = "slime"
-			gosub *select_deck
+			gosub *label_5103
 		}
 	}
 
 *card_player_WHILE1_CONTINUE
 	goto *card_player_WHILE1
diff -U5 --recursive -x 'db_creature*' -x 'db_item*' '-I\*label_' ../2.13-borscht/txtadv.hsp ../2.14-borscht/txtadv.hsp
--- ../2.13-borscht/txtadv.hsp	2022-06-26 12:14:17.581056900 -0700
+++ ../2.14-borscht/txtadv.hsp	2022-09-18 12:37:02.291014400 -0700
@@ -316,11 +316,11 @@
 	cs = 0
 	return
 
 *com_txtAdvQuit
 	mtilefilecur = -1
-	gosub *map_prepareTile
+	gosub *label_4912
 	f = 0
 	inv_getheader -1
 	repeat invrange, invhead
 		if ( inv(INV_ITEM_NUM, cnt) != 0 ) {
 			f = 1
@@ -1096,11 +1096,11 @@
 		txtadvscreenupdate = 1
 		gosub *com_txtadv_loop
 		winrow = 0
 	}
 	goto *adv_casinoBlackJack
-	goto *set_npcGod
+	goto *label_5207
 
 
 
 
 
